[{"CVE_ID":"CVE-2017-10911","CWE_ID":"200","category":"security","commit_id":"089bc0143f489bd3a4578bdff5f4ca68fb26f341","commit_message":"From 089bc0143f489bd3a4578bdff5f4ca68fb26f341 Mon Sep 17 00:00:00 2001\nFrom: Jan Beulich <jbeulich@suse.com>\nDate: Tue, 13 Jun 2017 16:28:27 -0400\nSubject: [PATCH] xen-blkback: don't leak stack data via response ring\n\nRather than constructing a local structure instance on the stack, fill\nthe fields directly on the shared ring, just like other backends do.\nBuild on the fact that all response structure flavors are actually\nidentical (the old code did make this assumption too).\n\nThis is XSA-216.\n\nCc: stable@vger.kernel.org\n\nSigned-off-by: Jan Beulich <jbeulich@suse.com>\nReviewed-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>\nSigned-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>\n---\n drivers\/block\/xen-blkback\/blkback.c | 23 ++++++++++++-----------\n drivers\/block\/xen-blkback\/common.h  | 25 +++++--------------------\n 2 files changed, 17 insertions(+), 31 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/block\/xen-blkback\/blkback.c b\/drivers\/block\/xen-blkback\/blkback.c\nindex 6b14c509f3c7b..0e824091a12fa 100644\n--- a\/drivers\/block\/xen-blkback\/blkback.c\n+++ b\/drivers\/block\/xen-blkback\/blkback.c\n@@ -1433,34 +1433,35 @@ static int dispatch_rw_block_io(struct xen_blkif_ring *ring,\n static void make_response(struct xen_blkif_ring *ring, u64 id,\n \t\t\t  unsigned short op, int st)\n {\n-\tstruct blkif_response  resp;\n+\tstruct blkif_response *resp;\n \tunsigned long     flags;\n \tunion blkif_back_rings *blk_rings;\n \tint notify;\n \n-\tresp.id        = id;\n-\tresp.operation = op;\n-\tresp.status    = st;\n-\n \tspin_lock_irqsave(&ring->blk_ring_lock, flags);\n \tblk_rings = &ring->blk_rings;\n \t\/* Place on the response ring for the relevant domain. *\/\n \tswitch (ring->blkif->blk_protocol) {\n \tcase BLKIF_PROTOCOL_NATIVE:\n-\t\tmemcpy(RING_GET_RESPONSE(&blk_rings->native, blk_rings->native.rsp_prod_pvt),\n-\t\t       &resp, sizeof(resp));\n+\t\tresp = RING_GET_RESPONSE(&blk_rings->native,\n+\t\t\t\t\t blk_rings->native.rsp_prod_pvt);\n \t\tbreak;\n \tcase BLKIF_PROTOCOL_X86_32:\n-\t\tmemcpy(RING_GET_RESPONSE(&blk_rings->x86_32, blk_rings->x86_32.rsp_prod_pvt),\n-\t\t       &resp, sizeof(resp));\n+\t\tresp = RING_GET_RESPONSE(&blk_rings->x86_32,\n+\t\t\t\t\t blk_rings->x86_32.rsp_prod_pvt);\n \t\tbreak;\n \tcase BLKIF_PROTOCOL_X86_64:\n-\t\tmemcpy(RING_GET_RESPONSE(&blk_rings->x86_64, blk_rings->x86_64.rsp_prod_pvt),\n-\t\t       &resp, sizeof(resp));\n+\t\tresp = RING_GET_RESPONSE(&blk_rings->x86_64,\n+\t\t\t\t\t blk_rings->x86_64.rsp_prod_pvt);\n \t\tbreak;\n \tdefault:\n \t\tBUG();\n \t}\n+\n+\tresp->id        = id;\n+\tresp->operation = op;\n+\tresp->status    = st;\n+\n \tblk_rings->common.rsp_prod_pvt++;\n \tRING_PUSH_RESPONSES_AND_CHECK_NOTIFY(&blk_rings->common, notify);\n \tspin_unlock_irqrestore(&ring->blk_ring_lock, flags);\ndiff --git a\/drivers\/block\/xen-blkback\/common.h b\/drivers\/block\/xen-blkback\/common.h\nindex 638597b17a38c..ecb35fe8ca8db 100644\n--- a\/drivers\/block\/xen-blkback\/common.h\n+++ b\/drivers\/block\/xen-blkback\/common.h\n@@ -75,9 +75,8 @@ extern unsigned int xenblk_max_queues;\n struct blkif_common_request {\n \tchar dummy;\n };\n-struct blkif_common_response {\n-\tchar dummy;\n-};\n+\n+\/* i386 protocol version *\/\n \n struct blkif_x86_32_request_rw {\n \tuint8_t        nr_segments;  \/* number of segments                   *\/\n@@ -129,14 +128,6 @@ struct blkif_x86_32_request {\n \t} u;\n } __attribute__((__packed__));\n \n-\/* i386 protocol version *\/\n-#pragma pack(push, 4)\n-struct blkif_x86_32_response {\n-\tuint64_t        id;              \/* copied from request *\/\n-\tuint8_t         operation;       \/* copied from request *\/\n-\tint16_t         status;          \/* BLKIF_RSP_???       *\/\n-};\n-#pragma pack(pop)\n \/* x86_64 protocol version *\/\n \n struct blkif_x86_64_request_rw {\n@@ -193,18 +184,12 @@ struct blkif_x86_64_request {\n \t} u;\n } __attribute__((__packed__));\n \n-struct blkif_x86_64_response {\n-\tuint64_t       __attribute__((__aligned__(8))) id;\n-\tuint8_t         operation;       \/* copied from request *\/\n-\tint16_t         status;          \/* BLKIF_RSP_???       *\/\n-};\n-\n DEFINE_RING_TYPES(blkif_common, struct blkif_common_request,\n-\t\t  struct blkif_common_response);\n+\t\t  struct blkif_response);\n DEFINE_RING_TYPES(blkif_x86_32, struct blkif_x86_32_request,\n-\t\t  struct blkif_x86_32_response);\n+\t\t  struct blkif_response __packed);\n DEFINE_RING_TYPES(blkif_x86_64, struct blkif_x86_64_request,\n-\t\t  struct blkif_x86_64_response);\n+\t\t  struct blkif_response);\n \n union blkif_back_rings {\n \tstruct blkif_back_ring        native;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-9231","CWE_ID":"200","category":"security","commit_id":"33ccaf61e34ef32ffc9d6b2be5dd218f6bb55f51","commit_message":"From 33ccaf61e34ef32ffc9d6b2be5dd218f6bb55f51 Mon Sep 17 00:00:00 2001\nFrom: George Nachman <gnachman@gmail.com>\nDate: Wed, 20 Sep 2017 10:05:38 -0700\nSubject: [PATCH] Fist swipe at removing DNS code\n\n---\n iTerm2.xcodeproj\/project.pbxproj     |  10 ---\n sources\/AsyncHostLookupController.h  |  25 ------\n sources\/AsyncHostLookupController.m  | 119 ---------------------------\n sources\/PTYTextView.m                |  66 +--------------\n sources\/iTermAdvancedSettingsModel.h |   1 -\n sources\/iTermAdvancedSettingsModel.m |   1 -\n sources\/iTermTextDrawingHelper.h     |   3 -\n sources\/iTermTextDrawingHelper.m     |   4 +-\n 8 files changed, 3 insertions(+), 226 deletions(-)\n delete mode 100644 sources\/AsyncHostLookupController.h\n delete mode 100644 sources\/AsyncHostLookupController.m\n\n","diff_code":"diff --git a\/iTerm2.xcodeproj\/project.pbxproj b\/iTerm2.xcodeproj\/project.pbxproj\nindex 63a5a2903..c7328a892 100644\n--- a\/iTerm2.xcodeproj\/project.pbxproj\n+++ b\/iTerm2.xcodeproj\/project.pbxproj\n@@ -630,7 +630,6 @@\n \t\t1D6C4D5A122329F000E0AA3E \/* ColorPresets.plist in Resources *\/ = {isa = PBXBuildFile; fileRef = 1D6C4D59122329F000E0AA3E \/* ColorPresets.plist *\/; };\n \t\t1D6C50A71226EEFB00E0AA3E \/* ProfileListView.h in Headers *\/ = {isa = PBXBuildFile; fileRef = 1D6C50A51226EEFB00E0AA3E \/* ProfileListView.h *\/; };\n \t\t1D6ED85619AEA20D005A7799 \/* URLAction.h in Headers *\/ = {isa = PBXBuildFile; fileRef = A6CFDAD0185D2587005DC94B \/* URLAction.h *\/; };\n-\t\t1D6ED85719AEA20D005A7799 \/* AsyncHostLookupController.h in Headers *\/ = {isa = PBXBuildFile; fileRef = A6CFDAD5185D53C2005DC94B \/* AsyncHostLookupController.h *\/; };\n \t\t1D6ED85819AEA20D005A7799 \/* LineBufferPosition.h in Headers *\/ = {isa = PBXBuildFile; fileRef = 1D78B55C183EE1C000014D49 \/* LineBufferPosition.h *\/; };\n \t\t1D6ED85919AEA20D005A7799 \/* FindContext.h in Headers *\/ = {isa = PBXBuildFile; fileRef = 1D53FD13181C4B4B00524D4F \/* FindContext.h *\/; };\n \t\t1D6ED85A19AEA20D005A7799 \/* ProfilesTerminalPreferencesViewController.h in Headers *\/ = {isa = PBXBuildFile; fileRef = A6A2698D1900F95D00437DA9 \/* ProfilesTerminalPreferencesViewController.h *\/; };\n@@ -2017,7 +2016,6 @@\n \t\tA6C763011B45C52B00E3C992 \/* TransferrableFileMenuItemViewController.m in Sources *\/ = {isa = PBXBuildFile; fileRef = A68A30D9186D1429007F550F \/* TransferrableFileMenuItemViewController.m *\/; };\n \t\tA6C763021B45C52B00E3C992 \/* VT100RemoteHost.m in Sources *\/ = {isa = PBXBuildFile; fileRef = A68A30DA186D1429007F550F \/* VT100RemoteHost.m *\/; };\n \t\tA6C763031B45C52B00E3C992 \/* VT100WorkingDirectory.m in Sources *\/ = {isa = PBXBuildFile; fileRef = A68A30DB186D1429007F550F \/* VT100WorkingDirectory.m *\/; };\n-\t\tA6C763051B45C52B00E3C992 \/* AsyncHostLookupController.m in Sources *\/ = {isa = PBXBuildFile; fileRef = A6CFDAD6185D53C2005DC94B \/* AsyncHostLookupController.m *\/; };\n \t\tA6C763061B45C52B00E3C992 \/* BackgroundThread.m in Sources *\/ = {isa = PBXBuildFile; fileRef = 1DA26ABF15007507004B5792 \/* BackgroundThread.m *\/; };\n \t\tA6C763071B45C52B00E3C992 \/* CapturedOutput.m in Sources *\/ = {isa = PBXBuildFile; fileRef = A67F57D31B11882900B4F135 \/* CapturedOutput.m *\/; };\n \t\tA6C763091B45C52B00E3C992 \/* iTermCommandHistoryCommandUseMO+Addtions.m in Sources *\/ = {isa = PBXBuildFile; fileRef = A6E7474C188C6394005355CF \/* iTermCommandHistoryCommandUseMO+Addtions.m *\/; };\n@@ -2317,7 +2315,6 @@\n \t\tA6CEDA6119988A7300BB57EC \/* LogoShadow.png in Resources *\/ = {isa = PBXBuildFile; fileRef = A6CEDA5E19988A7300BB57EC \/* LogoShadow.png *\/; };\n \t\tA6CEDA6219988A7300BB57EC \/* LogoShadow.png in Resources *\/ = {isa = PBXBuildFile; fileRef = A6CEDA5E19988A7300BB57EC \/* LogoShadow.png *\/; };\n \t\tA6CFDAD2185D2587005DC94B \/* URLAction.h in Headers *\/ = {isa = PBXBuildFile; fileRef = A6CFDAD0185D2587005DC94B \/* URLAction.h *\/; };\n-\t\tA6CFDAD7185D53C2005DC94B \/* AsyncHostLookupController.h in Headers *\/ = {isa = PBXBuildFile; fileRef = A6CFDAD5185D53C2005DC94B \/* AsyncHostLookupController.h *\/; };\n \t\tA6D22A431BC8BE6B004084E0 \/* Model.xcdatamodeld in Sources *\/ = {isa = PBXBuildFile; fileRef = A6D22A411BC8BE6B004084E0 \/* Model.xcdatamodeld *\/; };\n \t\tA6D22A441BC8BE6B004084E0 \/* Model.xcdatamodeld in Sources *\/ = {isa = PBXBuildFile; fileRef = A6D22A411BC8BE6B004084E0 \/* Model.xcdatamodeld *\/; };\n \t\tA6D22A451BC8BE6B004084E0 \/* Model.xcdatamodeld in Sources *\/ = {isa = PBXBuildFile; fileRef = A6D22A411BC8BE6B004084E0 \/* Model.xcdatamodeld *\/; };\n@@ -3837,8 +3834,6 @@\n \t\tA6CEDA5E19988A7300BB57EC \/* LogoShadow.png *\/ = {isa = PBXFileReference; lastKnownFileType = image.png; name = LogoShadow.png; path = images\/LogoParts\/LogoShadow.png; sourceTree = \"<group>\"; };\n \t\tA6CFDAD0185D2587005DC94B \/* URLAction.h *\/ = {isa = PBXFileReference; fileEncoding = 4; indentWidth = 4; lastKnownFileType = sourcecode.c.h; path = URLAction.h; sourceTree = \"<group>\"; tabWidth = 4; };\n \t\tA6CFDAD1185D2587005DC94B \/* URLAction.m *\/ = {isa = PBXFileReference; fileEncoding = 4; indentWidth = 4; lastKnownFileType = sourcecode.c.objc; path = URLAction.m; sourceTree = \"<group>\"; tabWidth = 4; };\n-\t\tA6CFDAD5185D53C2005DC94B \/* AsyncHostLookupController.h *\/ = {isa = PBXFileReference; fileEncoding = 4; indentWidth = 4; lastKnownFileType = sourcecode.c.h; path = AsyncHostLookupController.h; sourceTree = \"<group>\"; tabWidth = 4; };\n-\t\tA6CFDAD6185D53C2005DC94B \/* AsyncHostLookupController.m *\/ = {isa = PBXFileReference; fileEncoding = 4; indentWidth = 4; lastKnownFileType = sourcecode.c.objc; path = AsyncHostLookupController.m; sourceTree = \"<group>\"; tabWidth = 4; };\n \t\tA6D22A421BC8BE6B004084E0 \/* Model.xcdatamodel *\/ = {isa = PBXFileReference; lastKnownFileType = wrapper.xcdatamodel; path = Model.xcdatamodel; sourceTree = \"<group>\"; };\n \t\tA6D22B431BC9D368004084E0 \/* iTermShellHistoryTest.m *\/ = {isa = PBXFileReference; fileEncoding = 4; indentWidth = 4; lastKnownFileType = sourcecode.c.objc; path = iTermShellHistoryTest.m; sourceTree = \"<group>\"; };\n \t\tA6DF401A1897607E00F05947 \/* NSTextField+iTerm.h *\/ = {isa = PBXFileReference; fileEncoding = 4; indentWidth = 4; lastKnownFileType = sourcecode.c.h; path = \"NSTextField+iTerm.h\"; sourceTree = \"<group>\"; tabWidth = 4; };\n@@ -4202,7 +4197,6 @@\n \t\t\t\tA66DB8341C8E4CBB00233E88 \/* iTermOpenQuicklyCommands.h *\/,\n \t\t\t\tA6E7138C18F26A91008D94DD \/* AppearancePreferencesViewController.h *\/,\n \t\t\t\t1D2560A813EE60E4006B35CD \/* ArrangementPreviewView.h *\/,\n-\t\t\t\tA6CFDAD5185D53C2005DC94B \/* AsyncHostLookupController.h *\/,\n \t\t\t\t1DE214DF128212EE004E3ADF \/* Autocomplete.h *\/,\n \t\t\t\t1DA26ABE15007507004B5792 \/* BackgroundThread.h *\/,\n \t\t\t\t1D9DCC0C142D7F5F0016228A \/* BellTrigger.h *\/,\n@@ -5630,7 +5624,6 @@\n \t\t\t\tA6E761631D39D216005C0E5C \/* iTermMutableAttributedStringBuilder.m *\/,\n \t\t\t\t539325EE1DD66EF100CABCEF \/* iTermPreciseTimer.h *\/,\n \t\t\t\t539325EF1DD66EF100CABCEF \/* iTermPreciseTimer.m *\/,\n-\t\t\t\tA6CFDAD6185D53C2005DC94B \/* AsyncHostLookupController.m *\/,\n \t\t\t\t1DA26ABF15007507004B5792 \/* BackgroundThread.m *\/,\n \t\t\t\tA67F57D31B11882900B4F135 \/* CapturedOutput.m *\/,\n \t\t\t\t1D53FD14181C4B4B00524D4F \/* FindContext.m *\/,\n@@ -6134,7 +6127,6 @@\n \t\t\tbuildActionMask = 2147483647;\n \t\t\tfiles = (\n \t\t\t\t1D6ED85619AEA20D005A7799 \/* URLAction.h in Headers *\/,\n-\t\t\t\t1D6ED85719AEA20D005A7799 \/* AsyncHostLookupController.h in Headers *\/,\n \t\t\t\t1D6ED85819AEA20D005A7799 \/* LineBufferPosition.h in Headers *\/,\n \t\t\t\t1D6ED85919AEA20D005A7799 \/* FindContext.h in Headers *\/,\n \t\t\t\t1D6ED85A19AEA20D005A7799 \/* ProfilesTerminalPreferencesViewController.h in Headers *\/,\n@@ -6478,7 +6470,6 @@\n \t\t\tbuildActionMask = 2147483647;\n \t\t\tfiles = (\n \t\t\t\tA6CFDAD2185D2587005DC94B \/* URLAction.h in Headers *\/,\n-\t\t\t\tA6CFDAD7185D53C2005DC94B \/* AsyncHostLookupController.h in Headers *\/,\n \t\t\t\t1D78B55E183EE1C000014D49 \/* LineBufferPosition.h in Headers *\/,\n \t\t\t\tA65B72781B2BF2D200F947A7 \/* iTermProfilesPanel.h in Headers *\/,\n \t\t\t\t1D53FD15181C4B4B00524D4F \/* FindContext.h in Headers *\/,\n@@ -8485,7 +8476,6 @@\n \t\t\t\tA6C7637C1B45C52B00E3C992 \/* ProfilesColorsPreferencesViewController.m in Sources *\/,\n \t\t\t\tA6C763E21B45C6DD00E3C992 \/* PSMTabDragWindow.m in Sources *\/,\n \t\t\t\tA6936B5A1D2F5D1A00521B04 \/* iTermHotkeyPreferencesModel.m in Sources *\/,\n-\t\t\t\tA6C763051B45C52B00E3C992 \/* AsyncHostLookupController.m in Sources *\/,\n \t\t\t\tA6C763DA1B45C6DD00E3C992 \/* NSWindow+PSM.m in Sources *\/,\n \t\t\t\tA6C763121B45C52B00E3C992 \/* iTermImageInfo.m in Sources *\/,\n \t\t\t\tA6C7636E1B45C52B00E3C992 \/* iTermPreferences.m in Sources *\/,\ndiff --git a\/sources\/AsyncHostLookupController.h b\/sources\/AsyncHostLookupController.h\ndeleted file mode 100644\nindex 0e022f2a4..000000000\n--- a\/sources\/AsyncHostLookupController.h\n+++ \/dev\/null\n@@ -1,25 +0,0 @@\n-\/\/\n-\/\/  AsyncHostLookupController.h\n-\/\/  iTerm\n-\/\/\n-\/\/  Created by George Nachman on 12\/14\/13.\n-\/\/\n-\/\/\n-\n-#import <Foundation\/Foundation.h>\n-\n-\/\/ Verify whether host names are valid. Runs in a separate thread and provides asynchronous results.\n-\/\/ Caches very aggressively.\n-@interface AsyncHostLookupController : NSObject\n-\n-+ (instancetype)sharedInstance;\n-\n-\/\/ Calls back to completion indicating whether |host| is an extant hostname. The BOOL is YES if the\n-\/\/ hostname resolves. |host| is passed as the second argument to completion. Does not block.\n-- (void)getAddressForHost:(NSString *)host\n-               completion:(void (^)(BOOL, NSString*))completion;\n-\n-\/\/ Cancels the lookup for |hostname|.\n-- (void)cancelRequestForHostname:(NSString *)hostname;\n-\n-@end\ndiff --git a\/sources\/AsyncHostLookupController.m b\/sources\/AsyncHostLookupController.m\ndeleted file mode 100644\nindex a82675de1..000000000\n--- a\/sources\/AsyncHostLookupController.m\n+++ \/dev\/null\n@@ -1,119 +0,0 @@\n-\/\/\n-\/\/  AsyncHostLookupController.m\n-\/\/  iTerm\n-\/\/\n-\/\/  Created by George Nachman on 12\/14\/13.\n-\/\/\n-\/\/\n-\n-#import \"AsyncHostLookupController.h\"\n-#import \"DebugLogging.h\"\n-#import \"iTermAdvancedSettingsModel.h\"\n-#include <netdb.h>\n-\n-@implementation AsyncHostLookupController {\n-    \/\/ Created at initialization and used to perform blocking gethostbyname calls.\n-    dispatch_queue_t _queue;\n-\n-    \/\/ Set of hostnames waiting to be looked up. If a hostname is removed from\n-    \/\/ this set then it won't be looked up when its turn comes around.\n-    NSMutableSet *_pending;\n-\n-    \/\/ Maps hostname -> @YES or @NO, indicating if it resolved.\n-    NSMutableDictionary *_cache;\n-}\n-\n-+ (instancetype)sharedInstance {\n-    static AsyncHostLookupController *instance;\n-    static dispatch_once_t once;\n-    dispatch_once(&once, ^{\n-        instance = [[self alloc] init];\n-    });\n-    return instance;\n-}\n-\n-- (instancetype)init {\n-    self = [super init];\n-    if (self) {\n-        _queue = dispatch_queue_create(\"AsyncHostLookupControllerQueue\", NULL);\n-        _pending = [[NSMutableSet alloc] init];\n-        _cache = [[NSMutableDictionary alloc] init];\n-    }\n-    return self;\n-}\n-\n-- (void)dealloc {\n-    \/\/ The logic for cleaning up the dispatch queue isn't written, so just make sure the singleton\n-    \/\/ never gets dealloced.\n-    assert(false);\n-    [super dealloc];\n-}\n-\n-- (void)getAddressForHost:(NSString *)hostname\n-               completion:(void (^)(BOOL, NSString *))completion {\n-    if (![iTermAdvancedSettingsModel performDNSLookups]) {\n-        completion(YES, hostname);\n-        return;\n-    }\n-\n-    NSTimeInterval start = [NSDate timeIntervalSinceReferenceDate];\n-    @synchronized(self) {\n-        if ([_pending containsObject:hostname]) {\n-            DLog(@\"Already pending %@\", hostname);\n-            return;\n-        }\n-        NSNumber *okNumber = _cache[hostname];\n-        if (okNumber) {\n-            completion([okNumber boolValue], hostname);\n-            return;\n-        }\n-        [_pending addObject:hostname];\n-    }\n-    dispatch_async(_queue, ^() {\n-        @synchronized(self) {\n-            if (![_pending containsObject:hostname]) {\n-                DLog(@\"Abort nslookup for %@\", hostname);\n-                return;\n-            }\n-        }\n-\n-        BOOL shouldCache;\n-        BOOL ok = [self hostnameHasAddress:[hostname UTF8String] shouldCache:&shouldCache];\n-        if (shouldCache) {\n-            @synchronized(self) {\n-                _cache[hostname] = @(ok);\n-            }\n-        }\n-        dispatch_async(dispatch_get_main_queue(), ^() {\n-            @synchronized(self) {\n-                if (![_pending containsObject:hostname]) {\n-                    DLog(@\"Finished nslookup but don't call block for %@\", hostname);\n-                    return;\n-                }\n-                [_pending removeObject:hostname];\n-            }\n-            DLog(@\"Host %@: %@\", hostname, ok ? @\"OK\" : @\"Unknown\");\n-            completion(ok, hostname);\n-        });\n-    });\n-    DLog(@\"Blocked main thread for %f sec\", [NSDate timeIntervalSinceReferenceDate] - start);\n-}\n-\n-- (void)cancelRequestForHostname:(NSString *)hostname {\n-    @synchronized(self) {\n-        [_pending removeObject:hostname];\n-    }\n-}\n-\n-- (BOOL)hostnameHasAddress:(const char *)hostname shouldCache:(BOOL *)shouldCache {\n-    struct addrinfo *servinfo;\n-    int status = getaddrinfo(hostname, NULL, NULL, &servinfo);\n-    if (status == 0) {\n-        freeaddrinfo(servinfo);\n-    }\n-    \/\/ Don't cache temporary failures\n-    *shouldCache = (status != EAI_AGAIN);\n-    return status == 0;\n-}\n-\n-@end\ndiff --git a\/sources\/PTYTextView.m b\/sources\/PTYTextView.m\nindex ded180f12..48f85b481 100644\n--- a\/sources\/PTYTextView.m\n+++ b\/sources\/PTYTextView.m\n@@ -1,6 +1,5 @@\n #import \"PTYTextView.h\"\n \n-#import \"AsyncHostLookupController.h\"\n #import \"charmaps.h\"\n #import \"FileTransferManager.h\"\n #import \"FontSizeEstimator.h\"\n@@ -96,10 +95,6 @@\n static const NSUInteger kRectangularSelectionModifiers = (NSCommandKeyMask | NSAlternateKeyMask);\n static const NSUInteger kRectangularSelectionModifierMask = (kRectangularSelectionModifiers | NSControlKeyMask);\n \n-\/\/ Notifications posted when hostname lookups finish. Notifications are used to\n-\/\/ avoid dangling references.\n-static NSString *const kHostnameLookupFailed = @\"kHostnameLookupFailed\";\n-static NSString *const kHostnameLookupSucceeded = @\"kHostnameLookupSucceeded\";\n static PTYTextView *gCurrentKeyEventTextView;  \/\/ See comment in -keyDown:\n \n \/\/ Minimum distance that the mouse must move before a cmd+drag will be\n@@ -119,9 +114,6 @@ @interface PTYTextView () <\n     NSMenuDelegate,\n     NSPopoverDelegate>\n \n-\/\/ Set the hostname this view is currently waiting for AsyncHostLookupController to finish looking\n-\/\/ up.\n-@property(nonatomic, copy) NSString *currentUnderlineHostname;\n @property(nonatomic, retain) iTermSelection *selection;\n @property(nonatomic, retain) iTermSemanticHistoryController *semanticHistoryController;\n @property(nonatomic, retain) iTermFindCursorView *findCursorView;\n@@ -309,14 +301,6 @@ - (instancetype)initWithFrame:(NSRect)aRect colorMap:(iTermColorMap *)colorMap {\n                                                  selector:@selector(_pointerSettingsChanged:)\n                                                      name:kPointerPrefsChangedNotification\n                                                    object:nil];\n-        [[NSNotificationCenter defaultCenter] addObserver:self\n-                                                 selector:@selector(hostnameLookupFailed:)\n-                                                     name:kHostnameLookupFailed\n-                                                   object:nil];\n-        [[NSNotificationCenter defaultCenter] addObserver:self\n-                                                 selector:@selector(hostnameLookupSucceeded:)\n-                                                     name:kHostnameLookupSucceeded\n-                                                   object:nil];\n         [[NSNotificationCenter defaultCenter] addObserver:self\n                                                  selector:@selector(imageDidLoad:)\n                                                      name:iTermImageDidLoad\n@@ -400,10 +384,6 @@ - (void)dealloc {\n     [threeFingerTapGestureRecognizer_ disconnectTarget];\n     [threeFingerTapGestureRecognizer_ release];\n \n-    if (self.currentUnderlineHostname) {\n-        [[AsyncHostLookupController sharedInstance] cancelRequestForHostname:self.currentUnderlineHostname];\n-    }\n-    [_currentUnderlineHostname release];\n     _indicatorsHelper.delegate = nil;\n     [_indicatorsHelper release];\n     _selectionScrollHelper.delegate = nil;\n@@ -1115,7 +1095,6 @@ - (void)drawRect:(NSRect)rect {\n     \/\/ Draw the cursor filled in when we're inactive if there's a popup open or key focus was stolen.\n     _drawingHelper.shouldDrawFilledInCursor = ([self.delegate textViewShouldDrawFilledInCursor] || _keyFocusStolenCount);\n     _drawingHelper.isFrontTextView = (self == [[iTermController sharedInstance] frontTextView]);\n-    _drawingHelper.haveUnderlinedHostname = (self.currentUnderlineHostname != nil);\n     _drawingHelper.transparencyAlpha = [self transparencyAlpha];\n     _drawingHelper.now = [NSDate timeIntervalSinceReferenceDate];\n     _drawingHelper.drawMarkIndicators = [_delegate textViewShouldShowMarkIndicators];\n@@ -1772,10 +1751,6 @@ - (void)removeUnderline {\n     }\n     _drawingHelper.underlinedRange =\n         VT100GridAbsWindowedRangeMake(VT100GridAbsCoordRangeMake(-1, -1, -1, -1), 0, 0);\n-    if (self.currentUnderlineHostname) {\n-        [[AsyncHostLookupController sharedInstance] cancelRequestForHostname:self.currentUnderlineHostname];\n-    }\n-    self.currentUnderlineHostname = nil;\n     [self setNeedsDisplay:YES];  \/\/ It would be better to just display the underlined\/formerly underlined area.\n }\n \n@@ -1809,29 +1784,9 @@ - (URLAction *)updateUnderlinedURLs:(NSEvent *)event {\n \n                 if (action.actionType == kURLActionOpenURL) {\n                     NSURL *url = [NSURL URLWithUserSuppliedString:action.string];\n-                    if (![url.host isEqualToString:self.currentUnderlineHostname]) {\n-                        if (self.currentUnderlineHostname) {\n-                            [[AsyncHostLookupController sharedInstance] cancelRequestForHostname:self.currentUnderlineHostname];\n-                        }\n-                        if (url && url.host) {\n-                            self.currentUnderlineHostname = url.host;\n-                            [[AsyncHostLookupController sharedInstance] getAddressForHost:url.host\n-                                                                               completion:^(BOOL ok, NSString *hostname) {\n-                                                                                   if (!ok) {\n-                                                                                       [[NSNotificationCenter defaultCenter] postNotificationName:kHostnameLookupFailed\n-                                                                                                                                           object:hostname];\n-                                                                                   } else {\n-                                                                                       [[NSNotificationCenter defaultCenter] postNotificationName:kHostnameLookupSucceeded\n-                                                                                                                                           object:hostname];\n-                                                                                   }\n-                                                                               }];\n-                        }\n+                    if (url && url.host) {\n+                        [self setNeedsDisplay:YES];\n                     }\n-                } else {\n-                    if (self.currentUnderlineHostname) {\n-                        [[AsyncHostLookupController sharedInstance] cancelRequestForHostname:self.currentUnderlineHostname];\n-                    }\n-                    self.currentUnderlineHostname = nil;\n                 }\n             } else {\n                 [self removeUnderline];\n@@ -6188,23 +6143,6 @@ - (URLAction *)urlActionForClickAtX:(int)x\n                                        }];\n }\n \n-- (void)hostnameLookupFailed:(NSNotification *)notification {\n-    if ([[notification object] isEqualToString:self.currentUnderlineHostname]) {\n-        self.currentUnderlineHostname = nil;\n-        [self removeUnderline];\n-        _drawingHelper.underlinedRange =\n-            VT100GridAbsWindowedRangeMake(VT100GridAbsCoordRangeMake(-1, -1, -1, -1), 0, 0);\n-        [self setNeedsDisplay:YES];\n-    }\n-}\n-\n-- (void)hostnameLookupSucceeded:(NSNotification *)notification {\n-    if ([[notification object] isEqualToString:self.currentUnderlineHostname]) {\n-        self.currentUnderlineHostname = nil;\n-        [self setNeedsDisplay:YES];\n-    }\n-}\n-\n - (void)imageDidLoad:(NSNotification *)notification {\n     if ([self imageIsVisible:notification.object]) {\n         [self setNeedsDisplay:YES];\ndiff --git a\/sources\/iTermAdvancedSettingsModel.h b\/sources\/iTermAdvancedSettingsModel.h\nindex 865140714..98f1e9af8 100644\n--- a\/sources\/iTermAdvancedSettingsModel.h\n+++ b\/sources\/iTermAdvancedSettingsModel.h\n@@ -161,7 +161,6 @@\n + (BOOL)useColorfgbgFallback;\n + (BOOL)promptForPasteWhenNotAtPrompt;\n + (void)setPromptForPasteWhenNotAtPrompt:(BOOL)value;\n-+ (BOOL)performDNSLookups;\n + (BOOL)zeroWidthSpaceAdvancesCursor;\n + (BOOL)darkThemeHasBlackTitlebar;\n + (BOOL)fontChangeAffectsBroadcastingSessions;\ndiff --git a\/sources\/iTermAdvancedSettingsModel.m b\/sources\/iTermAdvancedSettingsModel.m\nindex 91a948ba7..1b23bf5d7 100644\n--- a\/sources\/iTermAdvancedSettingsModel.m\n+++ b\/sources\/iTermAdvancedSettingsModel.m\n@@ -182,7 +182,6 @@ + (NSString *)name { \\\n DEFINE_STRING(URLCharacterSet, @\".?\\\\\/:;%=&_-,+~#@!*'(\uff08)\uff09|[]\", @\"Semantic History: Non-alphanumeric characters considered part of a URL for Semantic History.\\nLetters and numbers are always considered part of the URL. These non-alphanumeric characters are used in addition for the purposes of figuring out where a URL begins and ends.\");\n DEFINE_INT(maxSemanticHistoryPrefixOrSuffix, 2000, @\"Semantic History: Maximum number of bytes of text before and after click location to take into account.\\nThis also limits the size of the \\\\3 and \\\\4 substitutions.\");\n DEFINE_STRING(pathsToIgnore, @\"\", @\"Semantic History: Paths to ignore for Semantic History.\\nSeparate paths with a comma. Any file under one of these paths will not be openable with Semantic History.\");\n-DEFINE_BOOL(performDNSLookups, NO, @\"Semantic History: Perform DNS lookups to check if URLs are valid?\\nWhen enabled, the name under the mouse will be resolved with DNS to determine if it is a clickable link.\");\n DEFINE_BOOL(showYellowMarkForJobStoppedBySignal, YES, @\"Semantic History: Use a yellow for a Shell Integration prompt mark when the job is stopped by a signal.\");\n \n #pragma mark - Debugging\ndiff --git a\/sources\/iTermTextDrawingHelper.h b\/sources\/iTermTextDrawingHelper.h\nindex eaa34cfea..d47750684 100644\n--- a\/sources\/iTermTextDrawingHelper.h\n+++ b\/sources\/iTermTextDrawingHelper.h\n@@ -159,9 +159,6 @@\n \/\/ TODO: This might be the same as textViewIsActiveSession.\n @property(nonatomic, assign) BOOL isFrontTextView;\n \n-\/\/ Is there an underlined hostname?\n-@property(nonatomic, assign) BOOL haveUnderlinedHostname;\n-\n \/\/ Background transparency level. Should be 1 if transparency is off for this view.\n @property(nonatomic, assign) double transparencyAlpha;\n \ndiff --git a\/sources\/iTermTextDrawingHelper.m b\/sources\/iTermTextDrawingHelper.m\nindex ce49fa83d..0bee10731 100644\n--- a\/sources\/iTermTextDrawingHelper.m\n+++ b\/sources\/iTermTextDrawingHelper.m\n@@ -110,7 +110,6 @@ @interface iTermTextDrawingHelper() <iTermCursorDelegate>\n     NSColor *backgroundColor;\n     NSColor *previousBackgroundColor;\n     CGFloat minimumContrast;\n-    BOOL haveUnderlinedHostname;\n     NSColor *previousForegroundColor;\n } iTermTextColorContext;\n \n@@ -1555,7 +1554,7 @@ - (CGContextRef)newGrayscaleContextOfSize:(NSSize)size {\n         \/\/ Black-on-yellow search result.\n         rawColor = [NSColor colorWithCalibratedRed:0 green:0 blue:0 alpha:1];\n         context->havePreviousCharacterAttributes = NO;\n-    } else if (inUnderlinedRange && !context->haveUnderlinedHostname) {\n+    } else if (inUnderlinedRange) {\n         \/\/ Blue link text.\n         rawColor = [context->colorMap colorForKey:kColorMapLink];\n         context->havePreviousCharacterAttributes = NO;\n@@ -1865,7 +1864,6 @@ - (BOOL)zippy {\n         .havePreviousCharacterAttributes = NO,\n         .backgroundColor = backgroundColor,\n         .minimumContrast = _minimumContrast,\n-        .haveUnderlinedHostname = _haveUnderlinedHostname,\n         .previousForegroundColor = nil,\n     };\n     NSDictionary *previousImageAttributes = nil;\n","owner":"gnachman","repo":"iTerm2","source":"cve"},{"CVE_ID":"CVE-2010-4082","CWE_ID":"200","category":"security","commit_id":"b4aaa78f4c2f9cde2f335b14f4ca30b01f9651ca","commit_message":"From b4aaa78f4c2f9cde2f335b14f4ca30b01f9651ca Mon Sep 17 00:00:00 2001\nFrom: Dan Rosenberg <drosenberg@vsecurity.com>\nDate: Wed, 15 Sep 2010 19:08:24 -0400\nSubject: drivers\/video\/via\/ioctl.c: prevent reading uninitialized stack memory\n\nThe VIAFB_GET_INFO device ioctl allows unprivileged users to read 246\nbytes of uninitialized stack memory, because the \"reserved\" member of\nthe viafb_ioctl_info struct declared on the stack is not altered or\nzeroed before being copied back to the user.  This patch takes care of\nit.\n\nSigned-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>\nSigned-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>\n---\n drivers\/video\/via\/ioctl.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/drivers\/video\/via\/ioctl.c b\/drivers\/video\/via\/ioctl.c\nindex da03c074e32a..4d553d0b8d7a 100644\n--- a\/drivers\/video\/via\/ioctl.c\n+++ b\/drivers\/video\/via\/ioctl.c\n@@ -25,6 +25,8 @@ int viafb_ioctl_get_viafb_info(u_long arg)\n {\n \tstruct viafb_ioctl_info viainfo;\n \n+\tmemset(&viainfo, 0, sizeof(struct viafb_ioctl_info));\n+\n \tviainfo.viafb_id = VIAID;\n \tviainfo.vendor_id = PCI_VIA_VENDOR_ID;\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2011-1943","CWE_ID":"200","category":"security","commit_id":"78ce088843d59d4494965bfc40b30a2e63d065f6","commit_message":"From 78ce088843d59d4494965bfc40b30a2e63d065f6 Mon Sep 17 00:00:00 2001\nFrom: Dan Williams <dcbw@redhat.com>\nDate: Thu, 26 May 2011 22:19:35 -0500\nSubject: libnm-util: remove some left-over debugging code\n\n---\n libnm-util\/nm-setting-vpn.c | 1 -\n 1 file changed, 1 deletion(-)\n\n","diff_code":"diff --git a\/libnm-util\/nm-setting-vpn.c b\/libnm-util\/nm-setting-vpn.c\nindex f70363e..23f0738 100644\n--- a\/libnm-util\/nm-setting-vpn.c\n+++ b\/libnm-util\/nm-setting-vpn.c\n@@ -457,7 +457,6 @@ destroy_one_secret (gpointer data)\n \tchar *secret = (char *) data;\n \n \t\/* Don't leave the secret lying around in memory *\/\n-g_message (\"%s: destroying %s\", __func__, secret);\n \tmemset (secret, 0, strlen (secret));\n \tg_free (secret);\n }\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-6412","CWE_ID":"200","category":"security","commit_id":"250c6c49e3b68756b14983c076183568636e2bde","commit_message":"From 250c6c49e3b68756b14983c076183568636e2bde Mon Sep 17 00:00:00 2001\nFrom: Peter Malone <peter.malone@gmail.com>\nDate: Wed, 7 Mar 2018 14:00:34 +0100\nSubject: [PATCH] fbdev: Fixing arbitrary kernel leak in case FBIOGETCMAP_SPARC\n in sbusfb_ioctl_helper().\n\nFixing arbitrary kernel leak in case FBIOGETCMAP_SPARC in\nsbusfb_ioctl_helper().\n\n'index' is defined as an int in sbusfb_ioctl_helper().\nWe retrieve this from the user:\nif (get_user(index, &c->index) ||\n    __get_user(count, &c->count) ||\n    __get_user(ured, &c->red) ||\n    __get_user(ugreen, &c->green) ||\n    __get_user(ublue, &c->blue))\n       return -EFAULT;\n\nand then we use 'index' in the following way:\nred = cmap->red[index + i] >> 8;\ngreen = cmap->green[index + i] >> 8;\nblue = cmap->blue[index + i] >> 8;\n\nThis is a classic information leak vulnerability. 'index' should be\nan unsigned int, given its usage above.\n\nThis patch is straight-forward; it changes 'index' to unsigned int\nin two switch-cases: FBIOGETCMAP_SPARC && FBIOPUTCMAP_SPARC.\n\nThis patch fixes CVE-2018-6412.\n\nSigned-off-by: Peter Malone <peter.malone@gmail.com>\nAcked-by: Mathieu Malaterre <malat@debian.org>\nSigned-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>\n---\n drivers\/video\/fbdev\/sbuslib.c | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/video\/fbdev\/sbuslib.c b\/drivers\/video\/fbdev\/sbuslib.c\nindex af6fc97f4ba4a..a436d44f1b7fb 100644\n--- a\/drivers\/video\/fbdev\/sbuslib.c\n+++ b\/drivers\/video\/fbdev\/sbuslib.c\n@@ -122,7 +122,7 @@ int sbusfb_ioctl_helper(unsigned long cmd, unsigned long arg,\n \t\tunsigned char __user *ured;\n \t\tunsigned char __user *ugreen;\n \t\tunsigned char __user *ublue;\n-\t\tint index, count, i;\n+\t\tunsigned int index, count, i;\n \n \t\tif (get_user(index, &c->index) ||\n \t\t    __get_user(count, &c->count) ||\n@@ -161,7 +161,7 @@ int sbusfb_ioctl_helper(unsigned long cmd, unsigned long arg,\n \t\tunsigned char __user *ugreen;\n \t\tunsigned char __user *ublue;\n \t\tstruct fb_cmap *cmap = &info->cmap;\n-\t\tint index, count, i;\n+\t\tunsigned int index, count, i;\n \t\tu8 red, green, blue;\n \n \t\tif (get_user(index, &c->index) ||\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2014-9423","CWE_ID":"200","category":"security","commit_id":"5bb8a6b9c9eb8dd22bc9526751610aaa255ead9c","commit_message":"From 5bb8a6b9c9eb8dd22bc9526751610aaa255ead9c Mon Sep 17 00:00:00 2001\nFrom: Greg Hudson <ghudson@mit.edu>\nDate: Mon, 29 Dec 2014 13:17:56 -0500\nSubject: [PATCH] Fix gssrpc data leakage [CVE-2014-9423]\n\n[MITKRB5-SA-2015-001] In svcauth_gss_accept_sec_context(), do not copy\nbytes from the union context into the handle field we send to the\nclient.  We do not use this handle field, so just supply a fixed\nstring of \"xxxx\".\n\nIn gss_union_ctx_id_struct, remove the unused \"interposer\" field which\nwas causing part of the union context to remain uninitialized.\n\nticket: 8058 (new)\ntarget_version: 1.13.1\ntags: pullup\n---\n src\/lib\/gssapi\/mechglue\/mglueP.h |  1 -\n src\/lib\/rpc\/svc_auth_gss.c       | 25 ++-----------------------\n 2 files changed, 2 insertions(+), 24 deletions(-)\n\n","diff_code":"diff --git a\/src\/lib\/gssapi\/mechglue\/mglueP.h b\/src\/lib\/gssapi\/mechglue\/mglueP.h\nindex e56b9c1a58..2b5145e079 100644\n--- a\/src\/lib\/gssapi\/mechglue\/mglueP.h\n+++ b\/src\/lib\/gssapi\/mechglue\/mglueP.h\n@@ -25,7 +25,6 @@ do {\t\t\t\t\t\t\t\t\\\n  *\/\n typedef struct gss_union_ctx_id_struct {\n \tstruct gss_union_ctx_id_struct *loopback;\n-\tstruct gss_union_ctx_id_struct *interposer;\n \tgss_OID\t\t\tmech_type;\n \tgss_ctx_id_t\t\tinternal_ctx_id;\n } gss_union_ctx_id_desc, *gss_union_ctx_id_t;\ndiff --git a\/src\/lib\/rpc\/svc_auth_gss.c b\/src\/lib\/rpc\/svc_auth_gss.c\nindex 09a353412f..b81c4a3496 100644\n--- a\/src\/lib\/rpc\/svc_auth_gss.c\n+++ b\/src\/lib\/rpc\/svc_auth_gss.c\n@@ -65,16 +65,6 @@ extern const gss_OID_desc * const gss_mech_spkm3;\n \n extern SVCAUTH svc_auth_none;\n \n-\/*\n- * from mit-krb5-1.2.1 mechglue\/mglueP.h:\n- * Array of context IDs typed by mechanism OID\n- *\/\n-typedef struct gss_union_ctx_id_t {\n-  gss_OID     mech_type;\n-  gss_ctx_id_t    internal_ctx_id;\n-} gss_union_ctx_id_desc, *gss_union_ctx_id_t;\n-\n-\n static auth_gssapi_log_badauth_func log_badauth = NULL;\n static caddr_t log_badauth_data = NULL;\n static auth_gssapi_log_badauth2_func log_badauth2 = NULL;\n@@ -239,16 +229,8 @@ svcauth_gss_accept_sec_context(struct svc_req *rqst,\n \t\tgd->ctx = GSS_C_NO_CONTEXT;\n \t\tgoto errout;\n \t}\n-\t\/*\n-\t * ANDROS: krb5 mechglue returns ctx of size 8 - two pointers,\n-\t * one to the mechanism oid, one to the internal_ctx_id\n-\t *\/\n-\tif ((gr->gr_ctx.value = mem_alloc(sizeof(gss_union_ctx_id_desc))) == NULL) {\n-\t\tfprintf(stderr, \"svcauth_gss_accept_context: out of memory\\n\");\n-\t\tgoto errout;\n-\t}\n-\tmemcpy(gr->gr_ctx.value, gd->ctx, sizeof(gss_union_ctx_id_desc));\n-\tgr->gr_ctx.length = sizeof(gss_union_ctx_id_desc);\n+\tgr->gr_ctx.value = \"xxxx\";\n+\tgr->gr_ctx.length = 4;\n \n \t\/* gr->gr_win = 0x00000005; ANDROS: for debugging linux kernel version...  *\/\n \tgr->gr_win = sizeof(gd->seqmask) * 8;\n@@ -520,8 +502,6 @@ gssrpc__svcauth_gss(struct svc_req *rqst, struct rpc_msg *msg,\n \n \t\tif (!svcauth_gss_nextverf(rqst, htonl(gr.gr_win))) {\n \t\t\tgss_release_buffer(&min_stat, &gr.gr_token);\n-\t\t\tmem_free(gr.gr_ctx.value,\n-\t\t\t\t sizeof(gss_union_ctx_id_desc));\n \t\t\tret_freegc (AUTH_FAILED);\n \t\t}\n \t\t*no_dispatch = TRUE;\n@@ -531,7 +511,6 @@ gssrpc__svcauth_gss(struct svc_req *rqst, struct rpc_msg *msg,\n \n \t\tgss_release_buffer(&min_stat, &gr.gr_token);\n \t\tgss_release_buffer(&min_stat, &gd->checksum);\n-\t\tmem_free(gr.gr_ctx.value, sizeof(gss_union_ctx_id_desc));\n \t\tif (!call_stat)\n \t\t\tret_freegc (AUTH_FAILED);\n \n","owner":"krb5","repo":"krb5","source":"cve"},{"CVE_ID":"CVE-2016-4578","CWE_ID":"200","category":"security","commit_id":"9a47e9cff994f37f7f0dbd9ae23740d0f64f9fe6","commit_message":"From 9a47e9cff994f37f7f0dbd9ae23740d0f64f9fe6 Mon Sep 17 00:00:00 2001\nFrom: Kangjie Lu <kangjielu@gmail.com>\nDate: Tue, 3 May 2016 16:44:20 -0400\nSubject: ALSA: timer: Fix leak in events via snd_timer_user_ccallback\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nThe stack object \u201cr1\u201d has a total size of 32 bytes. Its field\n\u201cevent\u201d and \u201cval\u201d both contain 4 bytes padding. These 8 bytes\npadding bytes are sent to user without being initialized.\n\nSigned-off-by: Kangjie Lu <kjlu@gatech.edu>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>\n---\n sound\/core\/timer.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/sound\/core\/timer.c b\/sound\/core\/timer.c\nindex 306a93dea20a..cc3c08d17ab1 100644\n--- a\/sound\/core\/timer.c\n+++ b\/sound\/core\/timer.c\n@@ -1223,6 +1223,7 @@ static void snd_timer_user_ccallback(struct snd_timer_instance *timeri,\n \t\ttu->tstamp = *tstamp;\n \tif ((tu->filter & (1 << event)) == 0 || !tu->tread)\n \t\treturn;\n+\tmemset(&r1, 0, sizeof(r1));\n \tr1.event = event;\n \tr1.tstamp = *tstamp;\n \tr1.val = resolution;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-1824","CWE_ID":"200","category":"security","commit_id":"afe98b7829d50806559acac9b530acb8283c3bf4","commit_message":"From afe98b7829d50806559acac9b530acb8283c3bf4 Mon Sep 17 00:00:00 2001\nFrom: Dmitry Stogov <dmitry@zend.com>\nDate: Thu, 7 Feb 2013 16:07:05 +0400\nSubject: [PATCH] Disabled external entities loading\n\n---\n ext\/soap\/php_xml.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/ext\/soap\/php_xml.c b\/ext\/soap\/php_xml.c\nindex 65abed1..a69d071 100644\n--- a\/ext\/soap\/php_xml.c\n+++ b\/ext\/soap\/php_xml.c\n@@ -92,6 +92,7 @@ xmlDocPtr soap_xmlParseFile(const char *filename TSRMLS_DC)\n \tPG(allow_url_fopen) = old_allow_url_fopen;\n \tif (ctxt) {\n \t\tctxt->keepBlanks = 0;\n+\t\tctxt->options -= XML_PARSE_DTDLOAD;\n \t\tctxt->sax->ignorableWhitespace = soap_ignorableWhitespace;\n \t\tctxt->sax->comment = soap_Comment;\n \t\tctxt->sax->warning = NULL;\n@@ -133,6 +134,7 @@ xmlDocPtr soap_xmlParseMemory(const void *buf, size_t buf_size)\n *\/\n \tctxt = xmlCreateMemoryParserCtxt(buf, buf_size);\n \tif (ctxt) {\n+\t\tctxt->options -= XML_PARSE_DTDLOAD;\n \t\tctxt->sax->ignorableWhitespace = soap_ignorableWhitespace;\n \t\tctxt->sax->comment = soap_Comment;\n \t\tctxt->sax->warning = NULL;\n-- \n2.1.4\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-19045","CWE_ID":"200","category":"security","commit_id":"5241e4d7b177d0b6f073cfc9ed5444bf51ec89d6","commit_message":"From 5241e4d7b177d0b6f073cfc9ed5444bf51ec89d6 Mon Sep 17 00:00:00 2001\nFrom: Quentin Armitage <quentin@armitage.org.uk>\nDate: Wed, 31 Oct 2018 21:57:02 +0000\nSubject: [PATCH] Fix compile warning introduced in commit c6247a9\n\nCommit c6247a9 - \"Add command line and configuration option to set umask\"\nintroduced a compile warning, although the code would have worked OK.\n\nSigned-off-by: Quentin Armitage <quentin@armitage.org.uk>\n---\n keepalived\/core\/main.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/keepalived\/core\/main.c b\/keepalived\/core\/main.c\nindex 6670ada28..03757f6f6 100644\n--- a\/keepalived\/core\/main.c\n+++ b\/keepalived\/core\/main.c\n@@ -882,7 +882,7 @@ set_umask(const char *optarg)\n \n \tif (*endptr || umask_long < 0 || umask_long & ~0777L) {\n \t\tfprintf(stderr, \"Invalid --umask option %s\", optarg);\n-\t\treturn;\n+\t\treturn 0;\n \t}\n \n \tumask_val = umask_long & 0777;\n","owner":"acassen","repo":"keepalived","source":"cve"},{"CVE_ID":"CVE-2012-3430","CWE_ID":"200","category":"security","commit_id":"06b6a1cf6e776426766298d055bb3991957d90a7","commit_message":"From 06b6a1cf6e776426766298d055bb3991957d90a7 Mon Sep 17 00:00:00 2001\nFrom: Weiping Pan <wpan@redhat.com>\nDate: Mon, 23 Jul 2012 10:37:48 +0800\nSubject: rds: set correct msg_namelen\n\nJay Fenlason (fenlason@redhat.com) found a bug,\nthat recvfrom() on an RDS socket can return the contents of random kernel\nmemory to userspace if it was called with a address length larger than\nsizeof(struct sockaddr_in).\nrds_recvmsg() also fails to set the addr_len paramater properly before\nreturning, but that's just a bug.\nThere are also a number of cases wher recvfrom() can return an entirely bogus\naddress. Anything in rds_recvmsg() that returns a non-negative value but does\nnot go through the \"sin = (struct sockaddr_in *)msg->msg_name;\" code path\nat the end of the while(1) loop will return up to 128 bytes of kernel memory\nto userspace.\n\nAnd I write two test programs to reproduce this bug, you will see that in\nrds_server, fromAddr will be overwritten and the following sock_fd will be\ndestroyed.\nYes, it is the programmer's fault to set msg_namelen incorrectly, but it is\nbetter to make the kernel copy the real length of address to user space in\nsuch case.\n\nHow to run the test programs ?\nI test them on 32bit x86 system, 3.5.0-rc7.\n\n1 compile\ngcc -o rds_client rds_client.c\ngcc -o rds_server rds_server.c\n\n2 run .\/rds_server on one console\n\n3 run .\/rds_client on another console\n\n4 you will see something like:\nserver is waiting to receive data...\nold socket fd=3\nserver received data from client:data from client\nmsg.msg_namelen=32\nnew socket fd=-1067277685\nsendmsg()\n: Bad file descriptor\n\n\/***************** rds_client.c ********************\/\n\nint main(void)\n{\n\tint sock_fd;\n\tstruct sockaddr_in serverAddr;\n\tstruct sockaddr_in toAddr;\n\tchar recvBuffer[128] = \"data from client\";\n\tstruct msghdr msg;\n\tstruct iovec iov;\n\n\tsock_fd = socket(AF_RDS, SOCK_SEQPACKET, 0);\n\tif (sock_fd < 0) {\n\t\tperror(\"create socket error\\n\");\n\t\texit(1);\n\t}\n\n\tmemset(&serverAddr, 0, sizeof(serverAddr));\n\tserverAddr.sin_family = AF_INET;\n\tserverAddr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n\tserverAddr.sin_port = htons(4001);\n\n\tif (bind(sock_fd, (struct sockaddr*)&serverAddr, sizeof(serverAddr)) < 0) {\n\t\tperror(\"bind() error\\n\");\n\t\tclose(sock_fd);\n\t\texit(1);\n\t}\n\n\tmemset(&toAddr, 0, sizeof(toAddr));\n\ttoAddr.sin_family = AF_INET;\n\ttoAddr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n\ttoAddr.sin_port = htons(4000);\n\tmsg.msg_name = &toAddr;\n\tmsg.msg_namelen = sizeof(toAddr);\n\tmsg.msg_iov = &iov;\n\tmsg.msg_iovlen = 1;\n\tmsg.msg_iov->iov_base = recvBuffer;\n\tmsg.msg_iov->iov_len = strlen(recvBuffer) + 1;\n\tmsg.msg_control = 0;\n\tmsg.msg_controllen = 0;\n\tmsg.msg_flags = 0;\n\n\tif (sendmsg(sock_fd, &msg, 0) == -1) {\n\t\tperror(\"sendto() error\\n\");\n\t\tclose(sock_fd);\n\t\texit(1);\n\t}\n\n\tprintf(\"client send data:%s\\n\", recvBuffer);\n\n\tmemset(recvBuffer, '\\0', 128);\n\n\tmsg.msg_name = &toAddr;\n\tmsg.msg_namelen = sizeof(toAddr);\n\tmsg.msg_iov = &iov;\n\tmsg.msg_iovlen = 1;\n\tmsg.msg_iov->iov_base = recvBuffer;\n\tmsg.msg_iov->iov_len = 128;\n\tmsg.msg_control = 0;\n\tmsg.msg_controllen = 0;\n\tmsg.msg_flags = 0;\n\tif (recvmsg(sock_fd, &msg, 0) == -1) {\n\t\tperror(\"recvmsg() error\\n\");\n\t\tclose(sock_fd);\n\t\texit(1);\n\t}\n\n\tprintf(\"receive data from server:%s\\n\", recvBuffer);\n\n\tclose(sock_fd);\n\n\treturn 0;\n}\n\n\/***************** rds_server.c ********************\/\n\nint main(void)\n{\n\tstruct sockaddr_in fromAddr;\n\tint sock_fd;\n\tstruct sockaddr_in serverAddr;\n\tunsigned int addrLen;\n\tchar recvBuffer[128];\n\tstruct msghdr msg;\n\tstruct iovec iov;\n\n\tsock_fd = socket(AF_RDS, SOCK_SEQPACKET, 0);\n\tif(sock_fd < 0) {\n\t\tperror(\"create socket error\\n\");\n\t\texit(0);\n\t}\n\n\tmemset(&serverAddr, 0, sizeof(serverAddr));\n\tserverAddr.sin_family = AF_INET;\n\tserverAddr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n\tserverAddr.sin_port = htons(4000);\n\tif (bind(sock_fd, (struct sockaddr*)&serverAddr, sizeof(serverAddr)) < 0) {\n\t\tperror(\"bind error\\n\");\n\t\tclose(sock_fd);\n\t\texit(1);\n\t}\n\n\tprintf(\"server is waiting to receive data...\\n\");\n\tmsg.msg_name = &fromAddr;\n\n\t\/*\n\t * I add 16 to sizeof(fromAddr), ie 32,\n\t * and pay attention to the definition of fromAddr,\n\t * recvmsg() will overwrite sock_fd,\n\t * since kernel will copy 32 bytes to userspace.\n\t *\n\t * If you just use sizeof(fromAddr), it works fine.\n\t * *\/\n\tmsg.msg_namelen = sizeof(fromAddr) + 16;\n\t\/* msg.msg_namelen = sizeof(fromAddr); *\/\n\tmsg.msg_iov = &iov;\n\tmsg.msg_iovlen = 1;\n\tmsg.msg_iov->iov_base = recvBuffer;\n\tmsg.msg_iov->iov_len = 128;\n\tmsg.msg_control = 0;\n\tmsg.msg_controllen = 0;\n\tmsg.msg_flags = 0;\n\n\twhile (1) {\n\t\tprintf(\"old socket fd=%d\\n\", sock_fd);\n\t\tif (recvmsg(sock_fd, &msg, 0) == -1) {\n\t\t\tperror(\"recvmsg() error\\n\");\n\t\t\tclose(sock_fd);\n\t\t\texit(1);\n\t\t}\n\t\tprintf(\"server received data from client:%s\\n\", recvBuffer);\n\t\tprintf(\"msg.msg_namelen=%d\\n\", msg.msg_namelen);\n\t\tprintf(\"new socket fd=%d\\n\", sock_fd);\n\t\tstrcat(recvBuffer, \"--data from server\");\n\t\tif (sendmsg(sock_fd, &msg, 0) == -1) {\n\t\t\tperror(\"sendmsg()\\n\");\n\t\t\tclose(sock_fd);\n\t\t\texit(1);\n\t\t}\n\t}\n\n\tclose(sock_fd);\n\treturn 0;\n}\n\nSigned-off-by: Weiping Pan <wpan@redhat.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/rds\/recv.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/net\/rds\/recv.c b\/net\/rds\/recv.c\nindex 5c6e9f132026..9f0f17cf6bf9 100644\n--- a\/net\/rds\/recv.c\n+++ b\/net\/rds\/recv.c\n@@ -410,6 +410,8 @@ int rds_recvmsg(struct kiocb *iocb, struct socket *sock, struct msghdr *msg,\n \n \trdsdebug(\"size %zu flags 0x%x timeo %ld\\n\", size, msg_flags, timeo);\n \n+\tmsg->msg_namelen = 0;\n+\n \tif (msg_flags & MSG_OOB)\n \t\tgoto out;\n \n@@ -485,6 +487,7 @@ int rds_recvmsg(struct kiocb *iocb, struct socket *sock, struct msghdr *msg,\n \t\t\tsin->sin_port = inc->i_hdr.h_sport;\n \t\t\tsin->sin_addr.s_addr = inc->i_saddr;\n \t\t\tmemset(sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t\tmsg->msg_namelen = sizeof(*sin);\n \t\t}\n \t\tbreak;\n \t}\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-5330","CWE_ID":"200","category":"security","commit_id":"a118d4220ed85749c07fb43c1229d9e2fecbea6b","commit_message":"From a118d4220ed85749c07fb43c1229d9e2fecbea6b Mon Sep 17 00:00:00 2001\nFrom: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>\nDate: Tue, 24 Nov 2015 13:49:09 +1300\nSubject: [PATCH] CVE-2015-5330: strupper_talloc_n_handle(): properly count\n characters\n\nWhen a codepoint eats more than one byte we really want to know,\nespecially if the string is not NUL terminated.\n\nBug: https:\/\/bugzilla.samba.org\/show_bug.cgi?id=11599\n\nSigned-off-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>\nPair-programmed-with: Andrew Bartlett <abartlet@samba.org>\nReviewed-by: Ralph Boehme <slow@samba.org>\n---\n lib\/util\/charset\/util_unistr.c | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/lib\/util\/charset\/util_unistr.c b\/lib\/util\/charset\/util_unistr.c\nindex f2992695f65..2cc87186dae 100644\n--- a\/lib\/util\/charset\/util_unistr.c\n+++ b\/lib\/util\/charset\/util_unistr.c\n@@ -110,11 +110,12 @@ _PUBLIC_ char *strupper_talloc_n_handle(struct smb_iconv_handle *iconv_handle,\n \t\treturn NULL;\n \t}\n \n-\twhile (n-- && *src) {\n+\twhile (n && *src) {\n \t\tsize_t c_size;\n \t\tcodepoint_t c = next_codepoint_handle_ext(iconv_handle, src, n,\n \t\t\t\t\t\t\t  CH_UNIX, &c_size);\n \t\tsrc += c_size;\n+\t\tn -= c_size;\n \n \t\tc = toupper_m(c);\n \n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2015-5302","CWE_ID":"200","category":"security","commit_id":"257578a23d1537a2d235aaa2b1488ee4f818e360","commit_message":"From 257578a23d1537a2d235aaa2b1488ee4f818e360 Mon Sep 17 00:00:00 2001\nFrom: Matej Habrnal <mhabrnal@redhat.com>\nDate: Mon, 12 Oct 2015 09:14:12 +0200\nSubject: [PATCH] wizard: fix save users changes after reviewing dump dir files\n\nIf the user reviewed the dump dir's files during reporting the crash, the\nchanges was thrown away and original data was passed to the bugzilla bug\nreport.\n\nreport-gtk saves the first text view buffer and then reloads data from the\nreported problem directory, which causes that the changes made to those text\nviews are thrown away.\n\nFunction save_text_if_changed(), except of saving text, also reload the files\nfrom dump dir and update gui state from the dump dir. The commit moves the\nreloading and updating gui functions away from this function.\n\nRelated to rhbz#1270235\n\nSigned-off-by: Matej Habrnal <mhabrnal@redhat.com>\n---\n src\/gui-wizard-gtk\/wizard.c | 9 ++++++---\n 1 file changed, 6 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/src\/gui-wizard-gtk\/wizard.c b\/src\/gui-wizard-gtk\/wizard.c\nindex 55a4b586..2d8d6bab 100644\n--- a\/src\/gui-wizard-gtk\/wizard.c\n+++ b\/src\/gui-wizard-gtk\/wizard.c\n@@ -433,8 +433,6 @@ static void save_text_if_changed(const char *name, const char *new_value)\n \n \/\/FIXME: else: what to do with still-unsaved data in the widget??\n         dd_close(dd);\n-        problem_data_reload_from_dump_dir();\n-        update_gui_state_from_problem_data(\/* don't update selected event *\/ 0);\n     }\n }\n \n@@ -777,7 +775,11 @@ static void tv_details_row_activated(\n         load_text_to_text_view(GTK_TEXT_VIEW(textview), item_name);\n \n         if (gtk_dialog_run(GTK_DIALOG(dialog)) == GTK_RESPONSE_OK)\n+        {\n             save_text_from_text_view(GTK_TEXT_VIEW(textview), item_name);\n+            problem_data_reload_from_dump_dir();\n+            update_gui_state_from_problem_data(\/* don't update selected event *\/ 0);\n+        }\n \n         gtk_widget_destroy(textview);\n         gtk_widget_destroy(scrolled);\n@@ -2709,7 +2711,8 @@ static void on_page_prepare(GtkNotebook *assistant, GtkWidget *page, gpointer us\n      * these tabs will be lost *\/\n     save_items_from_notepad();\n     save_text_from_text_view(g_tv_comment, FILENAME_COMMENT);\n-\n+    problem_data_reload_from_dump_dir();\n+    update_gui_state_from_problem_data(\/* don't update selected event *\/ 0);\n \n     if (pages[PAGENO_SUMMARY].page_widget == page)\n     {\n","owner":"abrt","repo":"libreport","source":"cve"},{"CVE_ID":"CVE-2015-8575","CWE_ID":"200","category":"security","commit_id":"5233252fce714053f0151680933571a2da9cbfb4","commit_message":"From 5233252fce714053f0151680933571a2da9cbfb4 Mon Sep 17 00:00:00 2001\nFrom: \"David S. Miller\" <davem@davemloft.net>\nDate: Tue, 15 Dec 2015 15:39:08 -0500\nSubject: [PATCH] bluetooth: Validate socket address length in sco_sock_bind().\n\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/bluetooth\/sco.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/net\/bluetooth\/sco.c b\/net\/bluetooth\/sco.c\nindex fe129663bd3f7..f52bcbf2e58cd 100644\n--- a\/net\/bluetooth\/sco.c\n+++ b\/net\/bluetooth\/sco.c\n@@ -526,6 +526,9 @@ static int sco_sock_bind(struct socket *sock, struct sockaddr *addr,\n \tif (!addr || addr->sa_family != AF_BLUETOOTH)\n \t\treturn -EINVAL;\n \n+\tif (addr_len < sizeof(struct sockaddr_sco))\n+\t\treturn -EINVAL;\n+\n \tlock_sock(sk);\n \n \tif (sk->sk_state != BT_OPEN) {\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2011-1160","CWE_ID":"200","category":"security","commit_id":"1309d7afbed112f0e8e90be9af975550caa0076b","commit_message":"From 1309d7afbed112f0e8e90be9af975550caa0076b Mon Sep 17 00:00:00 2001\nFrom: Peter Huewe <huewe.external.infineon@googlemail.com>\nDate: Tue, 29 Mar 2011 13:31:25 +0200\nSubject: char\/tpm: Fix unitialized usage of data buffer\n\nThis patch fixes information leakage to the userspace by initializing\nthe data buffer to zero.\n\nReported-by: Peter Huewe <huewe.external@infineon.com>\nSigned-off-by: Peter Huewe <huewe.external@infineon.com>\nSigned-off-by: Marcel Selhorst <m.selhorst@sirrix.com>\n[ Also removed the silly \"* sizeof(u8)\".  If that isn't 1, we have way\n  deeper problems than a simple multiplication can fix.   - Linus ]\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n drivers\/char\/tpm\/tpm.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/drivers\/char\/tpm\/tpm.c b\/drivers\/char\/tpm\/tpm.c\nindex 1f46f1cd9225..7beb0e25f1e1 100644\n--- a\/drivers\/char\/tpm\/tpm.c\n+++ b\/drivers\/char\/tpm\/tpm.c\n@@ -980,7 +980,7 @@ int tpm_open(struct inode *inode, struct file *file)\n \t\treturn -EBUSY;\n \t}\n \n-\tchip->data_buffer = kmalloc(TPM_BUFSIZE * sizeof(u8), GFP_KERNEL);\n+\tchip->data_buffer = kzalloc(TPM_BUFSIZE, GFP_KERNEL);\n \tif (chip->data_buffer == NULL) {\n \t\tclear_bit(0, &chip->is_open);\n \t\tput_device(chip->dev);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"mjg59","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2019-12210","CWE_ID":"200","category":"security","commit_id":"18b1914e32b74ff52000f10e97067e841e5fff62","commit_message":"From 18b1914e32b74ff52000f10e97067e841e5fff62 Mon Sep 17 00:00:00 2001\nFrom: Gabriel Kihlman <g.kihlman@yubico.com>\nDate: Tue, 4 Jun 2019 09:59:50 +0200\nSubject: [PATCH] Do not leak file descriptor when doing exec\n\nWhen opening a custom debug file, the descriptor would stay\nopen when calling exec and leak to the child process.\n\nMake sure all files are opened with close-on-exec.\n\nThis fixes CVE-2019-12210.\n\nThanks to Matthias Gerstner of the SUSE Security Team for reporting\nthe issue.\n---\n pam-u2f.c | 35 +++++++++++++++++++++++++----------\n util.c    | 10 +++++++---\n util.h    |  3 ++-\n 3 files changed, 34 insertions(+), 14 deletions(-)\n\n","diff_code":"diff --git a\/pam-u2f.c b\/pam-u2f.c\nindex 55d5708..071d005 100644\n--- a\/pam-u2f.c\n+++ b\/pam-u2f.c\n@@ -1,5 +1,5 @@\n \/*\n- *  Copyright (C) 2014-2018 Yubico AB - See COPYING\n+ *  Copyright (C) 2014-2019 Yubico AB - See COPYING\n  *\/\n \n \/* Define which PAM interfaces we provide *\/\n@@ -31,7 +31,11 @@ char *secure_getenv(const char *name) {\n #endif\n \n static void parse_cfg(int flags, int argc, const char **argv, cfg_t *cfg) {\n+  struct stat st;\n+  FILE *file = NULL;\n+  int fd = -1;\n   int i;\n+\n   memset(cfg, 0, sizeof(cfg_t));\n   cfg->debug_file = stderr;\n \n@@ -76,14 +80,14 @@ static void parse_cfg(int flags, int argc, const char **argv, cfg_t *cfg) {\n         cfg->debug_file = (FILE *)-1;\n       }\n       else {\n-        struct stat st;\n-        FILE *file;\n-        if(lstat(filename, &st) == 0) {\n-          if(S_ISREG(st.st_mode)) {\n-            file = fopen(filename, \"a\");\n-            if(file != NULL) {\n-              cfg->debug_file = file;\n-            }\n+        fd = open(filename, O_WRONLY | O_APPEND | O_CLOEXEC | O_NOFOLLOW | O_NOCTTY);\n+        if (fd >= 0 && (fstat(fd, &st) == 0) && S_ISREG(st.st_mode)) {\n+          file = fdopen(fd, \"a\");\n+          if(file != NULL) {\n+            cfg->debug_file = file;\n+            cfg->is_custom_debug_file = 1;\n+            file = NULL;\n+            fd = -1;\n           }\n         }\n       }\n@@ -111,6 +115,12 @@ static void parse_cfg(int flags, int argc, const char **argv, cfg_t *cfg) {\n     D(cfg->debug_file, \"appid=%s\", cfg->appid ? cfg->appid : \"(null)\");\n     D(cfg->debug_file, \"prompt=%s\", cfg->prompt ? cfg->prompt : \"(null)\");\n   }\n+\n+  if (fd != -1)\n+    close(fd);\n+\n+  if (file != NULL)\n+    fclose(file);\n }\n \n #ifdef DBG\n@@ -317,7 +327,8 @@ int pam_sm_authenticate(pam_handle_t *pamh, int flags, int argc,\n     DBG(\"Using file '%s' for emitting touch request notifications\", cfg->authpending_file);\n \n     \/\/ Open (or create) the authpending_file to indicate that we start waiting for a touch\n-    authpending_file_descriptor = open(cfg->authpending_file, O_RDONLY | O_CREAT, 0664);\n+    authpending_file_descriptor =\n+      open(cfg->authpending_file, O_RDONLY | O_CREAT | O_CLOEXEC | O_NOFOLLOW | O_NOCTTY, 0664);\n     if (authpending_file_descriptor < 0) {\n       DBG(\"Unable to emit 'authentication started' notification by opening the file '%s', (%s)\",\n           cfg->authpending_file, strerror(errno));\n@@ -385,6 +396,10 @@ int pam_sm_authenticate(pam_handle_t *pamh, int flags, int argc,\n   }\n   DBG(\"done. [%s]\", pam_strerror(pamh, retval));\n \n+  if (cfg->is_custom_debug_file) {\n+    fclose(cfg->debug_file);\n+  }\n+\n   return retval;\n }\n \ndiff --git a\/util.c b\/util.c\nindex 6bf73b9..d6651f6 100644\n--- a\/util.c\n+++ b\/util.c\n@@ -1,5 +1,5 @@\n \/*\n- * Copyright (C) 2014-2018 Yubico AB - See COPYING\n+ * Copyright (C) 2014-2019 Yubico AB - See COPYING\n  *\/\n \n #include \"util.h\"\n@@ -36,7 +36,7 @@ int get_devices_from_authfile(const char *authfile, const char *username,\n   \/* Ensure we never return uninitialized count. *\/\n   *n_devs = 0;\n \n-  fd = open(authfile, O_RDONLY, 0);\n+  fd = open(authfile, O_RDONLY | O_CLOEXEC | O_NOCTTY);\n   if (fd < 0) {\n     if (verbose)\n       D(debug_file, \"Cannot open file: %s (%s)\", authfile, strerror(errno));\n@@ -83,6 +83,8 @@ int get_devices_from_authfile(const char *authfile, const char *username,\n     if (verbose)\n       D(debug_file, \"fdopen: %s\", strerror(errno));\n     goto err;\n+  } else {\n+    fd = -1; \/* fd belongs to opwfile *\/\n   }\n \n   buf = malloc(sizeof(char) * (DEVSIZE * max_devs));\n@@ -211,8 +213,10 @@ int get_devices_from_authfile(const char *authfile, const char *username,\n \n   if (opwfile)\n     fclose(opwfile);\n-  else if (fd >= 0)\n+\n+  if (fd != -1)\n     close(fd);\n+\n   return retval;\n }\n \ndiff --git a\/util.h b\/util.h\nindex 82c3542..d2e7a4d 100644\n--- a\/util.h\n+++ b\/util.h\n@@ -1,5 +1,5 @@\n \/*\n- * Copyright (C) 2014-2018 Yubico AB - See COPYING\n+ * Copyright (C) 2014-2019 Yubico AB - See COPYING\n  *\/\n \n #ifndef UTIL_H\n@@ -45,6 +45,7 @@ typedef struct {\n   const char *appid;\n   const char *prompt;\n   FILE *debug_file;\n+  int is_custom_debug_file;\n } cfg_t;\n \n typedef struct {\n","owner":"Yubico","repo":"pam-u2f","source":"cve"},{"CVE_ID":"CVE-2016-0704","CWE_ID":"200","category":"security","commit_id":"ae50d8270026edf5b3c7f8aaa0c6677462b33d97","commit_message":"From ae50d8270026edf5b3c7f8aaa0c6677462b33d97 Mon Sep 17 00:00:00 2001\nFrom: Emilia Kasper <emilia@openssl.org>\nDate: Wed, 1 Apr 2015 17:08:45 +0200\nSubject: [PATCH] Harden SSLv2-supporting servers against Bleichenbacher's\n attack.\n\nThere is no indication that the timing differences are exploitable in\nOpenSSL, and indeed there is some indication (Usenix '14) that they\nare too small to be exploitable. Nevertheless, be careful and apply\nthe same countermeasures as in s3_srvr.c\n\nThanks to Nimrod Aviram, Sebastian Schinzel and Yuval Shavitt for\nreporting this issue.\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\n---\n ssl\/s2_srvr.c | 104 +++++++++++++++++++++++++-------------------------\n 1 file changed, 51 insertions(+), 53 deletions(-)\n\n","diff_code":"diff --git a\/ssl\/s2_srvr.c b\/ssl\/s2_srvr.c\nindex 19bb48c9cd..4289272b73 100644\n--- a\/ssl\/s2_srvr.c\n+++ b\/ssl\/s2_srvr.c\n@@ -111,6 +111,7 @@\n \n #include \"ssl_locl.h\"\n #ifndef OPENSSL_NO_SSL2\n+#include \"..\/crypto\/constant_time_locl.h\"\n # include <stdio.h>\n # include <openssl\/bio.h>\n # include <openssl\/rand.h>\n@@ -372,12 +373,15 @@ int ssl2_accept(SSL *s)\n static int get_client_master_key(SSL *s)\n {\n     int is_export, i, n, keya;\n-    unsigned int ek;\n+    unsigned int num_encrypted_key_bytes, key_length;\n     unsigned long len;\n     unsigned char *p;\n     const SSL_CIPHER *cp;\n     const EVP_CIPHER *c;\n     const EVP_MD *md;\n+    unsigned char rand_premaster_secret[SSL_MAX_MASTER_KEY_LENGTH];\n+    unsigned char decrypt_good;\n+    size_t j;\n \n     p = (unsigned char *)s->init_buf->data;\n     if (s->state == SSL2_ST_GET_CLIENT_MASTER_KEY_A) {\n@@ -465,12 +469,6 @@ static int get_client_master_key(SSL *s)\n         return (0);\n     }\n \n-    if (s->session->cipher->algorithm2 & SSL2_CF_8_BYTE_ENC) {\n-        is_export = 1;\n-        ek = 8;\n-    } else\n-        ek = 5;\n-\n     \/*\n      * The format of the CLIENT-MASTER-KEY message is\n      * 1 byte message type\n@@ -484,12 +482,27 @@ static int get_client_master_key(SSL *s)\n      *\n      * If the cipher is an export cipher, then the encrypted key bytes\n      * are a fixed portion of the total key (5 or 8 bytes). The size of\n-     * this portion is in |ek|. If the cipher is not an export cipher,\n-     * then the entire key material is encrypted (i.e., clear key length\n-     * must be zero).\n+     * this portion is in |num_encrypted_key_bytes|. If the cipher is not an\n+     * export cipher, then the entire key material is encrypted (i.e., clear\n+     * key length must be zero).\n      *\/\n-    if ((!is_export && s->s2->tmp.clear != 0) ||\n-        (is_export && s->s2->tmp.clear + ek != (unsigned int)EVP_CIPHER_key_length(c))) {\n+    key_length = (unsigned int)EVP_CIPHER_key_length(c);\n+    if (key_length > SSL_MAX_MASTER_KEY_LENGTH) {\n+        ssl2_return_error(s, SSL2_PE_UNDEFINED_ERROR);\n+        SSLerr(SSL_F_GET_CLIENT_MASTER_KEY, ERR_R_INTERNAL_ERROR);\n+        return -1;\n+    }\n+\n+    if (s->session->cipher->algorithm2 & SSL2_CF_8_BYTE_ENC) {\n+        is_export = 1;\n+        num_encrypted_key_bytes = 8;\n+    } else if (is_export) {\n+        num_encrypted_key_bytes = 5;\n+    } else {\n+        num_encrypted_key_bytes = key_length;\n+    }\n+\n+    if (s->s2->tmp.clear + num_encrypted_key_bytes != key_length) {\n         ssl2_return_error(s, SSL2_PE_UNDEFINED_ERROR);\n         SSLerr(SSL_F_GET_CLIENT_MASTER_KEY,SSL_R_BAD_LENGTH);\n         return -1;\n@@ -499,64 +512,49 @@ static int get_client_master_key(SSL *s)\n      * Decryption can't be expanding, so if we don't have enough encrypted\n      * bytes to fit the key in the buffer, stop now.\n      *\/\n-    if ((is_export && s->s2->tmp.enc < ek) ||\n-        (!is_export && s->s2->tmp.enc < (unsigned int)EVP_CIPHER_key_length(c))) {\n+    if (s->s2->tmp.enc < num_encrypted_key_bytes) {\n         ssl2_return_error(s,SSL2_PE_UNDEFINED_ERROR);\n         SSLerr(SSL_F_GET_CLIENT_MASTER_KEY,SSL_R_LENGTH_TOO_SHORT);\n         return -1;\n     }\n \n+    \/*\n+     * We must not leak whether a decryption failure occurs because of\n+     * Bleichenbacher's attack on PKCS #1 v1.5 RSA padding (see RFC 2246,\n+     * section 7.4.7.1). The code follows that advice of the TLS RFC and\n+     * generates a random premaster secret for the case that the decrypt\n+     * fails. See https:\/\/tools.ietf.org\/html\/rfc5246#section-7.4.7.1\n+     *\/\n+\n+    \/*\n+     * should be RAND_bytes, but we cannot work around a failure.\n+     *\/\n+    if (RAND_pseudo_bytes(rand_premaster_secret,\n+                          (int)num_encrypted_key_bytes) <= 0)\n+        return 0;\n+\n     i = ssl_rsa_private_decrypt(s->cert, s->s2->tmp.enc,\n                                 &(p[s->s2->tmp.clear]),\n                                 &(p[s->s2->tmp.clear]),\n                                 (s->s2->ssl2_rollback) ? RSA_SSLV23_PADDING :\n                                 RSA_PKCS1_PADDING);\n-\n-    \/* bad decrypt *\/\n-# if 1\n+    ERR_clear_error();\n     \/*\n      * If a bad decrypt, continue with protocol but with a random master\n      * secret (Bleichenbacher attack)\n      *\/\n-    if ((i < 0) || ((!is_export && i != EVP_CIPHER_key_length(c))\n-                    || (is_export && i != (int)ek))) {\n-        ERR_clear_error();\n-        if (is_export)\n-            i = ek;\n-        else\n-            i = EVP_CIPHER_key_length(c);\n-        if (RAND_pseudo_bytes(&p[s->s2->tmp.clear], i) <= 0)\n-            return 0;\n-    }\n-# else\n-    if (i < 0) {\n-        error = 1;\n-        SSLerr(SSL_F_GET_CLIENT_MASTER_KEY, SSL_R_BAD_RSA_DECRYPT);\n-    }\n-    \/* incorrect number of key bytes for non export cipher *\/\n-    else if ((!is_export && (i != EVP_CIPHER_key_length(c)))\n-             || (is_export && ((i != ek) || (s->s2->tmp.clear + i !=\n-                                             EVP_CIPHER_key_length(c))))) {\n-        error = 1;\n-        SSLerr(SSL_F_GET_CLIENT_MASTER_KEY, SSL_R_WRONG_NUMBER_OF_KEY_BITS);\n-    }\n-    if (error) {\n-        ssl2_return_error(s, SSL2_PE_UNDEFINED_ERROR);\n-        return (-1);\n+    decrypt_good = constant_time_eq_int_8(i, (int)num_encrypted_key_bytes);\n+    for (j = 0; j < num_encrypted_key_bytes; j++) {\n+        p[s->s2->tmp.clear + j] =\n+                constant_time_select_8(decrypt_good, p[s->s2->tmp.clear + j],\n+                                       rand_premaster_secret[j]);\n     }\n-# endif\n \n-    if (is_export)\n-        i = EVP_CIPHER_key_length(c);\n+    s->session->master_key_length = (int)key_length;\n+    memcpy(s->session->master_key, p, key_length);\n+    OPENSSL_cleanse(p, key_length);\n \n-    if (i > SSL_MAX_MASTER_KEY_LENGTH) {\n-        ssl2_return_error(s, SSL2_PE_UNDEFINED_ERROR);\n-        SSLerr(SSL_F_GET_CLIENT_MASTER_KEY, ERR_R_INTERNAL_ERROR);\n-        return -1;\n-    }\n-    s->session->master_key_length = i;\n-    memcpy(s->session->master_key, p, (unsigned int)i);\n-    return (1);\n+    return 1;\n }\n \n static int get_client_hello(SSL *s)\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2012-6536","CWE_ID":"200","category":"security","commit_id":"ecd7918745234e423dd87fcc0c077da557909720","commit_message":"From ecd7918745234e423dd87fcc0c077da557909720 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Thu, 20 Sep 2012 10:01:49 +0000\nSubject: xfrm_user: ensure user supplied esn replay window is valid\n\nThe current code fails to ensure that the netlink message actually\ncontains as many bytes as the header indicates. If a user creates a new\nstate or updates an existing one but does not supply the bytes for the\nwhole ESN replay window, the kernel copies random heap bytes into the\nreplay bitmap, the ones happen to follow the XFRMA_REPLAY_ESN_VAL\nnetlink attribute. This leads to following issues:\n\n1. The replay window has random bits set confusing the replay handling\n   code later on.\n\n2. A malicious user could use this flaw to leak up to ~3.5kB of heap\n   memory when she has access to the XFRM netlink interface (requires\n   CAP_NET_ADMIN).\n\nKnown users of the ESN replay window are strongSwan and Steffen's\niproute2 patch (<http:\/\/patchwork.ozlabs.org\/patch\/85962\/>). The latter\nuses the interface with a bitmap supplied while the former does not.\nstrongSwan is therefore prone to run into issue 1.\n\nTo fix both issues without breaking existing userland allow using the\nXFRMA_REPLAY_ESN_VAL netlink attribute with either an empty bitmap or a\nfully specified one. For the former case we initialize the in-kernel\nbitmap with zero, for the latter we copy the user supplied bitmap. For\nstate updates the full bitmap must be supplied.\n\nTo prevent overflows in the bitmap length calculation the maximum size\nof bmp_len is limited to 128 by this patch -- resulting in a maximum\nreplay window of 4096 packets. This should be sufficient for all real\nlife scenarios (RFC 4303 recommends a default replay window size of 64).\n\nCc: Steffen Klassert <steffen.klassert@secunet.com>\nCc: Martin Willi <martin@revosec.ch>\nCc: Ben Hutchings <bhutchings@solarflare.com>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n include\/linux\/xfrm.h |  2 ++\n net\/xfrm\/xfrm_user.c | 31 +++++++++++++++++++++++++------\n 2 files changed, 27 insertions(+), 6 deletions(-)\n\n","diff_code":"diff --git a\/include\/linux\/xfrm.h b\/include\/linux\/xfrm.h\nindex 22e61fdf75a2..28e493b5b94c 100644\n--- a\/include\/linux\/xfrm.h\n+++ b\/include\/linux\/xfrm.h\n@@ -84,6 +84,8 @@ struct xfrm_replay_state {\n \t__u32\tbitmap;\n };\n \n+#define XFRMA_REPLAY_ESN_MAX\t4096\n+\n struct xfrm_replay_state_esn {\n \tunsigned int\tbmp_len;\n \t__u32\t\toseq;\ndiff --git a\/net\/xfrm\/xfrm_user.c b\/net\/xfrm\/xfrm_user.c\nindex 8024b3dea8c2..5927065e97cf 100644\n--- a\/net\/xfrm\/xfrm_user.c\n+++ b\/net\/xfrm\/xfrm_user.c\n@@ -123,9 +123,21 @@ static inline int verify_replay(struct xfrm_usersa_info *p,\n \t\t\t\tstruct nlattr **attrs)\n {\n \tstruct nlattr *rt = attrs[XFRMA_REPLAY_ESN_VAL];\n+\tstruct xfrm_replay_state_esn *rs;\n \n-\tif ((p->flags & XFRM_STATE_ESN) && !rt)\n-\t\treturn -EINVAL;\n+\tif (p->flags & XFRM_STATE_ESN) {\n+\t\tif (!rt)\n+\t\t\treturn -EINVAL;\n+\n+\t\trs = nla_data(rt);\n+\n+\t\tif (rs->bmp_len > XFRMA_REPLAY_ESN_MAX \/ sizeof(rs->bmp[0]) \/ 8)\n+\t\t\treturn -EINVAL;\n+\n+\t\tif (nla_len(rt) < xfrm_replay_state_esn_len(rs) &&\n+\t\t    nla_len(rt) != sizeof(*rs))\n+\t\t\treturn -EINVAL;\n+\t}\n \n \tif (!rt)\n \t\treturn 0;\n@@ -370,14 +382,15 @@ static inline int xfrm_replay_verify_len(struct xfrm_replay_state_esn *replay_es\n \t\t\t\t\t struct nlattr *rp)\n {\n \tstruct xfrm_replay_state_esn *up;\n+\tint ulen;\n \n \tif (!replay_esn || !rp)\n \t\treturn 0;\n \n \tup = nla_data(rp);\n+\tulen = xfrm_replay_state_esn_len(up);\n \n-\tif (xfrm_replay_state_esn_len(replay_esn) !=\n-\t\t\txfrm_replay_state_esn_len(up))\n+\tif (nla_len(rp) < ulen || xfrm_replay_state_esn_len(replay_esn) != ulen)\n \t\treturn -EINVAL;\n \n \treturn 0;\n@@ -388,22 +401,28 @@ static int xfrm_alloc_replay_state_esn(struct xfrm_replay_state_esn **replay_esn\n \t\t\t\t       struct nlattr *rta)\n {\n \tstruct xfrm_replay_state_esn *p, *pp, *up;\n+\tint klen, ulen;\n \n \tif (!rta)\n \t\treturn 0;\n \n \tup = nla_data(rta);\n+\tklen = xfrm_replay_state_esn_len(up);\n+\tulen = nla_len(rta) >= klen ? klen : sizeof(*up);\n \n-\tp = kmemdup(up, xfrm_replay_state_esn_len(up), GFP_KERNEL);\n+\tp = kzalloc(klen, GFP_KERNEL);\n \tif (!p)\n \t\treturn -ENOMEM;\n \n-\tpp = kmemdup(up, xfrm_replay_state_esn_len(up), GFP_KERNEL);\n+\tpp = kzalloc(klen, GFP_KERNEL);\n \tif (!pp) {\n \t\tkfree(p);\n \t\treturn -ENOMEM;\n \t}\n \n+\tmemcpy(p, up, ulen);\n+\tmemcpy(pp, up, ulen);\n+\n \t*replay_esn = p;\n \t*preplay_esn = pp;\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-8790","CWE_ID":"200","category":"security","commit_id":"ababb64e0c792ad2a314245233db0833ba12036b","commit_message":"From ababb64e0c792ad2a314245233db0833ba12036b Mon Sep 17 00:00:00 2001\nFrom: Moritz Bunkus <moritz@bunkus.org>\nDate: Tue, 20 Oct 2015 11:27:52 +0200\nSubject: [PATCH] EbmlUnicodeString: don't read beyond end of string\n\nThe conversion from an UTF-8 encoded string into a wchar_t one was\nreading from beyond the end of the source buffer if the length indicated\nby a UTF-8 character's first byte exceeds the number of bytes actually\npresent afterwards.\n\nFixes the issue reported as Cisco TALOS-CAN-0036.\n---\n ChangeLog                 |  9 ++++++\n src\/EbmlUnicodeString.cpp | 61 ++++++++++++++++++++++++---------------\n 2 files changed, 47 insertions(+), 23 deletions(-)\n\n","diff_code":"diff --git a\/ChangeLog b\/ChangeLog\nindex a1c95dc..a5139c4 100644\n--- a\/ChangeLog\n+++ b\/ChangeLog\n@@ -1,3 +1,12 @@\n+2015-10-20  Moritz Bunkus  <moritz@bunkus.org>\n+\n+        * EbmlUnicodeString::UpdateFromUTF8(): Fixed an invalid memory\n+        access. When reading from a UTF-8 string in which the length\n+        indicated by a UTF-8 character's first byte exceeds the string's\n+        actual number of bytes the parser would access beyond the end of\n+        the string resulting in a heap information leak. Fixes the issue\n+        reported as Cisco TALOS-CAN-0036.\n+\n 2015-10-17  Moritz Bunkus  <moritz@bunkus.org>\n \n         * Released v1.3.2.\ndiff --git a\/src\/EbmlUnicodeString.cpp b\/src\/EbmlUnicodeString.cpp\nindex 3255add..7b7cd8e 100644\n--- a\/src\/EbmlUnicodeString.cpp\n+++ b\/src\/EbmlUnicodeString.cpp\n@@ -47,6 +47,21 @@ START_LIBEBML_NAMESPACE\n \n \/\/ ===================== UTFstring class ===================\n \n+static unsigned int UTFCharLength(uint8 lead)\n+{\n+  if (lead < 0x80)\n+    return 1;\n+  else if ((lead >> 5) == 0x6)\n+    return 2;\n+  else if ((lead >> 4) == 0xe)\n+    return 3;\n+  else if ((lead >> 3) == 0x1e)\n+    return 4;\n+  else\n+    \/\/ Invalid size?\n+    return 0;\n+}\n+\n UTFstring::UTFstring()\n   :_Length(0)\n   ,_Data(NULL)\n@@ -143,39 +158,39 @@ void UTFstring::UpdateFromUTF8()\n   delete [] _Data;\n   \/\/ find the size of the final UCS-2 string\n   size_t i;\n-  for (_Length=0, i=0; i<UTF8string.length(); _Length++) {\n-    uint8 lead = static_cast<uint8>(UTF8string[i]);\n-    if (lead < 0x80)\n-      i++;\n-    else if ((lead >> 5) == 0x6)\n-      i += 2;\n-    else if ((lead >> 4) == 0xe)\n-      i += 3;\n-    else if ((lead >> 3) == 0x1e)\n-      i += 4;\n+  const size_t SrcLength = UTF8string.length();\n+  for (_Length=0, i=0; i<SrcLength; _Length++) {\n+    const unsigned int CharLength = UTFCharLength(static_cast<uint8>(UTF8string[i]));\n+    if ((CharLength >= 1) && (CharLength <= 4))\n+      i += CharLength;\n     else\n       \/\/ Invalid size?\n       break;\n   }\n   _Data = new wchar_t[_Length+1];\n   size_t j;\n-  for (j=0, i=0; i<UTF8string.length(); j++) {\n-    uint8 lead = static_cast<uint8>(UTF8string[i]);\n-    if (lead < 0x80) {\n+  for (j=0, i=0; i<SrcLength; j++) {\n+    const uint8 lead              = static_cast<uint8>(UTF8string[i]);\n+    const unsigned int CharLength = UTFCharLength(lead);\n+    if ((CharLength < 1) || (CharLength > 4))\n+      \/\/ Invalid char?\n+      break;\n+\n+    if ((i + CharLength) > SrcLength)\n+      \/\/ Guard against invalid memory access beyond the end of the\n+      \/\/ source buffer.\n+      break;\n+\n+    if (CharLength == 1)\n       _Data[j] = lead;\n-      i++;\n-    } else if ((lead >> 5) == 0x6) {\n+    else if (CharLength == 2)\n       _Data[j] = ((lead & 0x1F) << 6) + (UTF8string[i+1] & 0x3F);\n-      i += 2;\n-    } else if ((lead >> 4) == 0xe) {\n+    else if (CharLength == 3)\n       _Data[j] = ((lead & 0x0F) << 12) + ((UTF8string[i+1] & 0x3F) << 6) + (UTF8string[i+2] & 0x3F);\n-      i += 3;\n-    } else if ((lead >> 3) == 0x1e) {\n+    else if (CharLength == 4)\n       _Data[j] = ((lead & 0x07) << 18) + ((UTF8string[i+1] & 0x3F) << 12) + ((UTF8string[i+2] & 0x3F) << 6) + (UTF8string[i+3] & 0x3F);\n-      i += 4;\n-    } else\n-      \/\/ Invalid char?\n-      break;\n+\n+    i += CharLength;\n   }\n   _Data[j] = 0;\n }\n","owner":"Matroska-Org","repo":"libebml","source":"cve"},{"CVE_ID":"CVE-2017-11145","CWE_ID":"200","category":"security","commit_id":"e8b7698f5ee757ce2c8bd10a192a491a498f891c","commit_message":"From e8b7698f5ee757ce2c8bd10a192a491a498f891c Mon Sep 17 00:00:00 2001\nFrom: Derick Rethans <github@derickrethans.nl>\nDate: Mon, 3 Jul 2017 12:37:11 +0100\nSubject: [PATCH] Fixed parsing of strange formats with mixed month\/day and\n time strings\n\n---\n ext\/date\/lib\/parse_date.c  | 12004 ++++++++++++++++++++-----------------------\n ext\/date\/lib\/parse_date.re |     2 +-\n 2 files changed, 5551 insertions(+), 6455 deletions(-)\n\n","diff_code":"diff --git a\/ext\/date\/lib\/parse_date.c b\/ext\/date\/lib\/parse_date.c\nindex 1151c8d..e538464 100644\n--- a\/ext\/date\/lib\/parse_date.c\n+++ b\/ext\/date\/lib\/parse_date.c\n@@ -1,4 +1,4 @@\n-\/* Generated by re2c 0.15.3 on Fri Sep 30 20:18:29 2016 *\/\n+\/* Generated by re2c 0.15.3 on Tue Jul  4 19:19:00 2017 *\/\n #line 1 \"ext\/date\/lib\/parse_date.re\"\n \/*\n  * The MIT License (MIT)\n@@ -866,7 +866,7 @@ std:\n \t\t  0,   0,   0,   0,   0,   0,   0,   0, \n \t\t  0,   0,   0,   0,   0,   0,   0,   0, \n \t};\n-\tif ((YYLIMIT - YYCURSOR) < 31) YYFILL(31);\n+\tif ((YYLIMIT - YYCURSOR) < 33) YYFILL(33);\n \tyych = *YYCURSOR;\n \tswitch (yych) {\n \tcase 0x00:\n@@ -951,14 +951,14 @@ yy2:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'D') goto yy140;\n-\t\t\tgoto yy1523;\n+\t\t\tgoto yy1463;\n \t\t}\n \t} else {\n \t\tif (yych <= 'd') {\n \t\t\tif (yych <= 'Z') goto yy140;\n \t\t\tif (yych >= 'a') goto yy145;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy1532;\n+\t\t\tif (yych <= 'e') goto yy1472;\n \t\t\tif (yych <= 'z') goto yy145;\n \t\t}\n \t}\n@@ -986,7 +986,7 @@ yy4:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'D') goto yy140;\n-\t\t\tgoto yy1523;\n+\t\t\tgoto yy1463;\n \t\t}\n \t} else {\n \t\tif (yych <= 'd') {\n@@ -994,7 +994,7 @@ yy4:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy140;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy1523;\n+\t\t\tif (yych <= 'e') goto yy1463;\n \t\t\tif (yych <= 'z') goto yy140;\n \t\t\tgoto yy3;\n \t\t}\n@@ -1008,12 +1008,12 @@ yy5:\n \t\t\tgoto yy140;\n \t\t} else {\n \t\t\tif (yych <= 'H') {\n-\t\t\t\tif (yych <= 'E') goto yy1494;\n+\t\t\t\tif (yych <= 'E') goto yy1434;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'I') goto yy1495;\n+\t\t\t\tif (yych <= 'I') goto yy1435;\n \t\t\t\tif (yych <= 'N') goto yy140;\n-\t\t\t\tgoto yy1493;\n+\t\t\t\tgoto yy1433;\n \t\t\t}\n \t\t}\n \t} else {\n@@ -1022,15 +1022,15 @@ yy5:\n \t\t\t\tif (yych <= 'Z') goto yy140;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'e') goto yy1510;\n+\t\t\t\tif (yych == 'e') goto yy1450;\n \t\t\t\tgoto yy145;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'n') {\n-\t\t\t\tif (yych <= 'i') goto yy1511;\n+\t\t\t\tif (yych <= 'i') goto yy1451;\n \t\t\t\tgoto yy145;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'o') goto yy1509;\n+\t\t\t\tif (yych <= 'o') goto yy1449;\n \t\t\t\tif (yych <= 'z') goto yy145;\n \t\t\t\tgoto yy3;\n \t\t\t}\n@@ -1045,12 +1045,12 @@ yy6:\n \t\t\tgoto yy140;\n \t\t} else {\n \t\t\tif (yych <= 'H') {\n-\t\t\t\tif (yych <= 'E') goto yy1494;\n+\t\t\t\tif (yych <= 'E') goto yy1434;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'I') goto yy1495;\n+\t\t\t\tif (yych <= 'I') goto yy1435;\n \t\t\t\tif (yych <= 'N') goto yy140;\n-\t\t\t\tgoto yy1493;\n+\t\t\t\tgoto yy1433;\n \t\t\t}\n \t\t}\n \t} else {\n@@ -1059,15 +1059,15 @@ yy6:\n \t\t\t\tif (yych <= 'Z') goto yy140;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'e') goto yy1494;\n+\t\t\t\tif (yych == 'e') goto yy1434;\n \t\t\t\tgoto yy140;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'n') {\n-\t\t\t\tif (yych <= 'i') goto yy1495;\n+\t\t\t\tif (yych <= 'i') goto yy1435;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'o') goto yy1493;\n+\t\t\t\tif (yych <= 'o') goto yy1433;\n \t\t\t\tif (yych <= 'z') goto yy140;\n \t\t\t\tgoto yy3;\n \t\t\t}\n@@ -1079,24 +1079,24 @@ yy7:\n \t\tif (yych <= 'A') {\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tif (yych <= '@') goto yy3;\n-\t\t\tgoto yy1463;\n+\t\t\tgoto yy1403;\n \t\t} else {\n-\t\t\tif (yych == 'I') goto yy1464;\n+\t\t\tif (yych == 'I') goto yy1404;\n \t\t\tif (yych <= 'N') goto yy140;\n-\t\t\tgoto yy1465;\n+\t\t\tgoto yy1405;\n \t\t}\n \t} else {\n \t\tif (yych <= 'h') {\n \t\t\tif (yych <= 'Z') goto yy140;\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tif (yych <= 'a') goto yy1478;\n+\t\t\tif (yych <= 'a') goto yy1418;\n \t\t\tgoto yy145;\n \t\t} else {\n \t\t\tif (yych <= 'n') {\n-\t\t\t\tif (yych <= 'i') goto yy1479;\n+\t\t\t\tif (yych <= 'i') goto yy1419;\n \t\t\t\tgoto yy145;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'o') goto yy1480;\n+\t\t\t\tif (yych <= 'o') goto yy1420;\n \t\t\t\tif (yych <= 'z') goto yy145;\n \t\t\t\tgoto yy3;\n \t\t\t}\n@@ -1108,24 +1108,24 @@ yy8:\n \t\tif (yych <= 'A') {\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tif (yych <= '@') goto yy3;\n-\t\t\tgoto yy1463;\n+\t\t\tgoto yy1403;\n \t\t} else {\n-\t\t\tif (yych == 'I') goto yy1464;\n+\t\t\tif (yych == 'I') goto yy1404;\n \t\t\tif (yych <= 'N') goto yy140;\n-\t\t\tgoto yy1465;\n+\t\t\tgoto yy1405;\n \t\t}\n \t} else {\n \t\tif (yych <= 'h') {\n \t\t\tif (yych <= 'Z') goto yy140;\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tif (yych <= 'a') goto yy1463;\n+\t\t\tif (yych <= 'a') goto yy1403;\n \t\t\tgoto yy140;\n \t\t} else {\n \t\t\tif (yych <= 'n') {\n-\t\t\t\tif (yych <= 'i') goto yy1464;\n+\t\t\t\tif (yych <= 'i') goto yy1404;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'o') goto yy1465;\n+\t\t\t\tif (yych <= 'o') goto yy1405;\n \t\t\t\tif (yych <= 'z') goto yy140;\n \t\t\t\tgoto yy3;\n \t\t\t}\n@@ -1137,15 +1137,15 @@ yy9:\n \tswitch (yych) {\n \tcase ')':\tgoto yy139;\n \tcase '0':\n-\tcase '1':\tgoto yy1393;\n-\tcase '2':\tgoto yy1394;\n+\tcase '1':\tgoto yy1333;\n+\tcase '2':\tgoto yy1334;\n \tcase '3':\n \tcase '4':\n \tcase '5':\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy1395;\n+\tcase '9':\tgoto yy1335;\n \tcase 'A':\n \tcase 'B':\n \tcase 'C':\n@@ -1167,11 +1167,11 @@ yy9:\n \tcase 'X':\n \tcase 'Y':\n \tcase 'Z':\tgoto yy140;\n-\tcase 'E':\tgoto yy1388;\n-\tcase 'H':\tgoto yy1389;\n-\tcase 'O':\tgoto yy1390;\n-\tcase 'U':\tgoto yy1391;\n-\tcase 'W':\tgoto yy1392;\n+\tcase 'E':\tgoto yy1328;\n+\tcase 'H':\tgoto yy1329;\n+\tcase 'O':\tgoto yy1330;\n+\tcase 'U':\tgoto yy1331;\n+\tcase 'W':\tgoto yy1332;\n \tcase 'a':\n \tcase 'b':\n \tcase 'c':\n@@ -1193,11 +1193,11 @@ yy9:\n \tcase 'x':\n \tcase 'y':\n \tcase 'z':\tgoto yy145;\n-\tcase 'e':\tgoto yy1431;\n-\tcase 'h':\tgoto yy1432;\n-\tcase 'o':\tgoto yy1433;\n-\tcase 'u':\tgoto yy1434;\n-\tcase 'w':\tgoto yy1435;\n+\tcase 'e':\tgoto yy1371;\n+\tcase 'h':\tgoto yy1372;\n+\tcase 'o':\tgoto yy1373;\n+\tcase 'u':\tgoto yy1374;\n+\tcase 'w':\tgoto yy1375;\n \tdefault:\tgoto yy3;\n \t}\n yy10:\n@@ -1206,15 +1206,15 @@ yy10:\n \tswitch (yych) {\n \tcase ')':\tgoto yy139;\n \tcase '0':\n-\tcase '1':\tgoto yy1393;\n-\tcase '2':\tgoto yy1394;\n+\tcase '1':\tgoto yy1333;\n+\tcase '2':\tgoto yy1334;\n \tcase '3':\n \tcase '4':\n \tcase '5':\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy1395;\n+\tcase '9':\tgoto yy1335;\n \tcase 'A':\n \tcase 'B':\n \tcase 'C':\n@@ -1258,23 +1258,23 @@ yy10:\n \tcase 'y':\n \tcase 'z':\tgoto yy140;\n \tcase 'E':\n-\tcase 'e':\tgoto yy1388;\n+\tcase 'e':\tgoto yy1328;\n \tcase 'H':\n-\tcase 'h':\tgoto yy1389;\n+\tcase 'h':\tgoto yy1329;\n \tcase 'O':\n-\tcase 'o':\tgoto yy1390;\n+\tcase 'o':\tgoto yy1330;\n \tcase 'U':\n-\tcase 'u':\tgoto yy1391;\n+\tcase 'u':\tgoto yy1331;\n \tcase 'W':\n-\tcase 'w':\tgoto yy1392;\n+\tcase 'w':\tgoto yy1332;\n \tdefault:\tgoto yy3;\n \t}\n yy11:\n \tyyaccept = 1;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '-') goto yy1384;\n+\tif (yych == '-') goto yy1324;\n \tif (yych <= '\/') goto yy12;\n-\tif (yych <= '9') goto yy1385;\n+\tif (yych <= '9') goto yy1325;\n yy12:\n #line 1725 \"ext\/date\/lib\/parse_date.re\"\n \t{\n@@ -1292,16 +1292,16 @@ yy13:\n \t\t\t} else {\n \t\t\t\tif (yych <= '@') goto yy3;\n \t\t\t\tif (yych <= 'D') goto yy140;\n-\t\t\t\tgoto yy1320;\n+\t\t\t\tgoto yy1260;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'N') {\n-\t\t\t\tif (yych == 'I') goto yy1321;\n+\t\t\t\tif (yych == 'I') goto yy1261;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'O') goto yy1322;\n+\t\t\t\tif (yych <= 'O') goto yy1262;\n \t\t\t\tif (yych <= 'Q') goto yy140;\n-\t\t\t\tgoto yy1323;\n+\t\t\t\tgoto yy1263;\n \t\t\t}\n \t\t}\n \t} else {\n@@ -1311,16 +1311,16 @@ yy13:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy145;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1361;\n+\t\t\t\tif (yych <= 'e') goto yy1301;\n \t\t\t\tif (yych <= 'h') goto yy145;\n-\t\t\t\tgoto yy1362;\n+\t\t\t\tgoto yy1302;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'q') {\n-\t\t\t\tif (yych == 'o') goto yy1363;\n+\t\t\t\tif (yych == 'o') goto yy1303;\n \t\t\t\tgoto yy145;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy1364;\n+\t\t\t\tif (yych <= 'r') goto yy1304;\n \t\t\t\tif (yych <= 'z') goto yy145;\n \t\t\t\tgoto yy3;\n \t\t\t}\n@@ -1336,16 +1336,16 @@ yy14:\n \t\t\t} else {\n \t\t\t\tif (yych <= '@') goto yy3;\n \t\t\t\tif (yych <= 'D') goto yy140;\n-\t\t\t\tgoto yy1320;\n+\t\t\t\tgoto yy1260;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'N') {\n-\t\t\t\tif (yych == 'I') goto yy1321;\n+\t\t\t\tif (yych == 'I') goto yy1261;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'O') goto yy1322;\n+\t\t\t\tif (yych <= 'O') goto yy1262;\n \t\t\t\tif (yych <= 'Q') goto yy140;\n-\t\t\t\tgoto yy1323;\n+\t\t\t\tgoto yy1263;\n \t\t\t}\n \t\t}\n \t} else {\n@@ -1355,16 +1355,16 @@ yy14:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1320;\n+\t\t\t\tif (yych <= 'e') goto yy1260;\n \t\t\t\tif (yych <= 'h') goto yy140;\n-\t\t\t\tgoto yy1321;\n+\t\t\t\tgoto yy1261;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'q') {\n-\t\t\t\tif (yych == 'o') goto yy1322;\n+\t\t\t\tif (yych == 'o') goto yy1262;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy1323;\n+\t\t\t\tif (yych <= 'r') goto yy1263;\n \t\t\t\tif (yych <= 'z') goto yy140;\n \t\t\t\tgoto yy3;\n \t\t\t}\n@@ -1375,13 +1375,13 @@ yy15:\n \tif (yych <= 'A') {\n \t\tif (yych == ')') goto yy139;\n \t\tif (yych <= '@') goto yy3;\n-\t\tgoto yy1306;\n+\t\tgoto yy1246;\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych <= 'Z') goto yy140;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy1317;\n+\t\t\tif (yych <= 'a') goto yy1257;\n \t\t\tif (yych <= 'z') goto yy145;\n \t\t\tgoto yy3;\n \t\t}\n@@ -1391,13 +1391,13 @@ yy16:\n \tif (yych <= 'A') {\n \t\tif (yych == ')') goto yy139;\n \t\tif (yych <= '@') goto yy3;\n-\t\tgoto yy1306;\n+\t\tgoto yy1246;\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych <= 'Z') goto yy140;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy1306;\n+\t\t\tif (yych <= 'a') goto yy1246;\n \t\t\tif (yych <= 'z') goto yy140;\n \t\t\tgoto yy3;\n \t\t}\n@@ -1407,13 +1407,13 @@ yy17:\n \tif (yych <= 'A') {\n \t\tif (yych == ')') goto yy139;\n \t\tif (yych <= '@') goto yy3;\n-\t\tgoto yy1286;\n+\t\tgoto yy1226;\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych <= 'Z') goto yy140;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy1303;\n+\t\t\tif (yych <= 'a') goto yy1243;\n \t\t\tif (yych <= 'z') goto yy145;\n \t\t\tgoto yy3;\n \t\t}\n@@ -1423,13 +1423,13 @@ yy18:\n \tif (yych <= 'A') {\n \t\tif (yych == ')') goto yy139;\n \t\tif (yych <= '@') goto yy3;\n-\t\tgoto yy1286;\n+\t\tgoto yy1226;\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych <= 'Z') goto yy140;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy1286;\n+\t\t\tif (yych <= 'a') goto yy1226;\n \t\t\tif (yych <= 'z') goto yy140;\n \t\t\tgoto yy3;\n \t\t}\n@@ -1443,17 +1443,17 @@ yy19:\n \t\t\t\tgoto yy139;\n \t\t\t} else {\n \t\t\t\tif (yych <= '@') goto yy3;\n-\t\t\t\tif (yych <= 'A') goto yy1229;\n+\t\t\t\tif (yych <= 'A') goto yy1169;\n \t\t\t\tgoto yy140;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'H') {\n-\t\t\t\tif (yych <= 'E') goto yy1228;\n+\t\t\t\tif (yych <= 'E') goto yy1168;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'I') goto yy1230;\n+\t\t\t\tif (yych <= 'I') goto yy1170;\n \t\t\t\tif (yych <= 'T') goto yy140;\n-\t\t\t\tgoto yy1231;\n+\t\t\t\tgoto yy1171;\n \t\t\t}\n \t\t}\n \t} else {\n@@ -1462,16 +1462,16 @@ yy19:\n \t\t\t\tif (yych <= 'Z') goto yy140;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'a') goto yy1258;\n+\t\t\t\tif (yych <= 'a') goto yy1198;\n \t\t\t\tif (yych <= 'd') goto yy145;\n-\t\t\t\tgoto yy1257;\n+\t\t\t\tgoto yy1197;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n-\t\t\t\tif (yych == 'i') goto yy1259;\n+\t\t\t\tif (yych == 'i') goto yy1199;\n \t\t\t\tgoto yy145;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'u') goto yy1260;\n+\t\t\t\tif (yych <= 'u') goto yy1200;\n \t\t\t\tif (yych <= 'z') goto yy145;\n \t\t\t\tgoto yy3;\n \t\t\t}\n@@ -1486,17 +1486,17 @@ yy20:\n \t\t\t\tgoto yy139;\n \t\t\t} else {\n \t\t\t\tif (yych <= '@') goto yy3;\n-\t\t\t\tif (yych <= 'A') goto yy1229;\n+\t\t\t\tif (yych <= 'A') goto yy1169;\n \t\t\t\tgoto yy140;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'H') {\n-\t\t\t\tif (yych <= 'E') goto yy1228;\n+\t\t\t\tif (yych <= 'E') goto yy1168;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'I') goto yy1230;\n+\t\t\t\tif (yych <= 'I') goto yy1170;\n \t\t\t\tif (yych <= 'T') goto yy140;\n-\t\t\t\tgoto yy1231;\n+\t\t\t\tgoto yy1171;\n \t\t\t}\n \t\t}\n \t} else {\n@@ -1505,16 +1505,16 @@ yy20:\n \t\t\t\tif (yych <= 'Z') goto yy140;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'a') goto yy1229;\n+\t\t\t\tif (yych <= 'a') goto yy1169;\n \t\t\t\tif (yych <= 'd') goto yy140;\n-\t\t\t\tgoto yy1228;\n+\t\t\t\tgoto yy1168;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n-\t\t\t\tif (yych == 'i') goto yy1230;\n+\t\t\t\tif (yych == 'i') goto yy1170;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'u') goto yy1231;\n+\t\t\t\tif (yych <= 'u') goto yy1171;\n \t\t\t\tif (yych <= 'z') goto yy140;\n \t\t\t\tgoto yy3;\n \t\t\t}\n@@ -1527,18 +1527,18 @@ yy21:\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'I') goto yy1198;\n+\t\t\tif (yych == 'I') goto yy1138;\n \t\t\tif (yych <= 'K') goto yy140;\n-\t\t\tgoto yy1199;\n+\t\t\tgoto yy1139;\n \t\t}\n \t} else {\n \t\tif (yych <= 'i') {\n \t\t\tif (yych <= 'Z') goto yy140;\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tif (yych <= 'h') goto yy145;\n-\t\t\tgoto yy1216;\n+\t\t\tgoto yy1156;\n \t\t} else {\n-\t\t\tif (yych == 'l') goto yy1217;\n+\t\t\tif (yych == 'l') goto yy1157;\n \t\t\tif (yych <= 'z') goto yy145;\n \t\t\tgoto yy3;\n \t\t}\n@@ -1550,18 +1550,18 @@ yy22:\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'I') goto yy1198;\n+\t\t\tif (yych == 'I') goto yy1138;\n \t\t\tif (yych <= 'K') goto yy140;\n-\t\t\tgoto yy1199;\n+\t\t\tgoto yy1139;\n \t\t}\n \t} else {\n \t\tif (yych <= 'i') {\n \t\t\tif (yych <= 'Z') goto yy140;\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tif (yych <= 'h') goto yy140;\n-\t\t\tgoto yy1198;\n+\t\t\tgoto yy1138;\n \t\t} else {\n-\t\t\tif (yych == 'l') goto yy1199;\n+\t\t\tif (yych == 'l') goto yy1139;\n \t\t\tif (yych <= 'z') goto yy140;\n \t\t\tgoto yy3;\n \t\t}\n@@ -1575,7 +1575,7 @@ yy23:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'Q') goto yy140;\n-\t\t\tgoto yy1097;\n+\t\t\tgoto yy1037;\n \t\t}\n \t} else {\n \t\tif (yych <= 'q') {\n@@ -1583,7 +1583,7 @@ yy23:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy145;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy1191;\n+\t\t\tif (yych <= 'r') goto yy1131;\n \t\t\tif (yych <= 'z') goto yy145;\n \t\t\tgoto yy3;\n \t\t}\n@@ -1597,7 +1597,7 @@ yy24:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'Q') goto yy140;\n-\t\t\tgoto yy1097;\n+\t\t\tgoto yy1037;\n \t\t}\n \t} else {\n \t\tif (yych <= 'q') {\n@@ -1605,7 +1605,7 @@ yy24:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy140;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy1097;\n+\t\t\tif (yych <= 'r') goto yy1037;\n \t\t\tif (yych <= 'z') goto yy140;\n \t\t\tgoto yy3;\n \t\t}\n@@ -1614,7 +1614,7 @@ yy25:\n \tyyaccept = 1;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tswitch (yych) {\n-\tcase '\\t':\tgoto yy1051;\n+\tcase '\\t':\tgoto yy991;\n \tcase ' ':\n \tcase 'A':\n \tcase 'D':\n@@ -1639,11 +1639,11 @@ yy25:\n \tcase 'm':\n \tcase 'o':\n \tcase 'w':\n-\tcase 'y':\tgoto yy1053;\n-\tcase '-':\tgoto yy472;\n-\tcase '.':\tgoto yy1063;\n-\tcase '\/':\tgoto yy471;\n-\tcase '0':\tgoto yy1096;\n+\tcase 'y':\tgoto yy993;\n+\tcase '-':\tgoto yy412;\n+\tcase '.':\tgoto yy1003;\n+\tcase '\/':\tgoto yy411;\n+\tcase '0':\tgoto yy1036;\n \tcase '1':\n \tcase '2':\n \tcase '3':\n@@ -1652,19 +1652,19 @@ yy25:\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy1095;\n-\tcase ':':\tgoto yy1064;\n-\tcase 'n':\tgoto yy469;\n-\tcase 'r':\tgoto yy470;\n-\tcase 's':\tgoto yy463;\n-\tcase 't':\tgoto yy467;\n+\tcase '9':\tgoto yy1035;\n+\tcase ':':\tgoto yy1004;\n+\tcase 'n':\tgoto yy409;\n+\tcase 'r':\tgoto yy410;\n+\tcase 's':\tgoto yy403;\n+\tcase 't':\tgoto yy407;\n \tdefault:\tgoto yy12;\n \t}\n yy26:\n \tyyaccept = 1;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tswitch (yych) {\n-\tcase '\\t':\tgoto yy459;\n+\tcase '\\t':\tgoto yy399;\n \tcase ' ':\n \tcase 'A':\n \tcase 'D':\n@@ -1691,32 +1691,32 @@ yy26:\n \tcase 'o':\n \tcase 'p':\n \tcase 'w':\n-\tcase 'y':\tgoto yy461;\n-\tcase '-':\tgoto yy472;\n-\tcase '.':\tgoto yy473;\n-\tcase '\/':\tgoto yy471;\n+\tcase 'y':\tgoto yy401;\n+\tcase '-':\tgoto yy412;\n+\tcase '.':\tgoto yy413;\n+\tcase '\/':\tgoto yy411;\n \tcase '0':\n \tcase '1':\n-\tcase '2':\tgoto yy1095;\n+\tcase '2':\tgoto yy1035;\n \tcase '3':\n \tcase '4':\n \tcase '5':\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy1062;\n-\tcase ':':\tgoto yy482;\n-\tcase 'n':\tgoto yy469;\n-\tcase 'r':\tgoto yy470;\n-\tcase 's':\tgoto yy463;\n-\tcase 't':\tgoto yy467;\n+\tcase '9':\tgoto yy1002;\n+\tcase ':':\tgoto yy422;\n+\tcase 'n':\tgoto yy409;\n+\tcase 'r':\tgoto yy410;\n+\tcase 's':\tgoto yy403;\n+\tcase 't':\tgoto yy407;\n \tdefault:\tgoto yy12;\n \t}\n yy27:\n \tyyaccept = 1;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tswitch (yych) {\n-\tcase '\\t':\tgoto yy459;\n+\tcase '\\t':\tgoto yy399;\n \tcase ' ':\n \tcase 'A':\n \tcase 'D':\n@@ -1743,32 +1743,32 @@ yy27:\n \tcase 'o':\n \tcase 'p':\n \tcase 'w':\n-\tcase 'y':\tgoto yy461;\n-\tcase '-':\tgoto yy472;\n-\tcase '.':\tgoto yy473;\n-\tcase '\/':\tgoto yy471;\n+\tcase 'y':\tgoto yy401;\n+\tcase '-':\tgoto yy412;\n+\tcase '.':\tgoto yy413;\n+\tcase '\/':\tgoto yy411;\n \tcase '0':\n \tcase '1':\n \tcase '2':\n \tcase '3':\n-\tcase '4':\tgoto yy1062;\n+\tcase '4':\tgoto yy1002;\n \tcase '5':\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy1049;\n-\tcase ':':\tgoto yy482;\n-\tcase 'n':\tgoto yy469;\n-\tcase 'r':\tgoto yy470;\n-\tcase 's':\tgoto yy463;\n-\tcase 't':\tgoto yy467;\n+\tcase '9':\tgoto yy989;\n+\tcase ':':\tgoto yy422;\n+\tcase 'n':\tgoto yy409;\n+\tcase 'r':\tgoto yy410;\n+\tcase 's':\tgoto yy403;\n+\tcase 't':\tgoto yy407;\n \tdefault:\tgoto yy12;\n \t}\n yy28:\n \tyyaccept = 1;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tswitch (yych) {\n-\tcase '\\t':\tgoto yy459;\n+\tcase '\\t':\tgoto yy399;\n \tcase ' ':\n \tcase 'A':\n \tcase 'D':\n@@ -1795,12 +1795,12 @@ yy28:\n \tcase 'o':\n \tcase 'p':\n \tcase 'w':\n-\tcase 'y':\tgoto yy461;\n-\tcase '-':\tgoto yy472;\n-\tcase '.':\tgoto yy473;\n-\tcase '\/':\tgoto yy471;\n+\tcase 'y':\tgoto yy401;\n+\tcase '-':\tgoto yy412;\n+\tcase '.':\tgoto yy413;\n+\tcase '\/':\tgoto yy411;\n \tcase '0':\n-\tcase '1':\tgoto yy1049;\n+\tcase '1':\tgoto yy989;\n \tcase '2':\n \tcase '3':\n \tcase '4':\n@@ -1808,19 +1808,19 @@ yy28:\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy468;\n-\tcase ':':\tgoto yy482;\n-\tcase 'n':\tgoto yy469;\n-\tcase 'r':\tgoto yy470;\n-\tcase 's':\tgoto yy463;\n-\tcase 't':\tgoto yy467;\n+\tcase '9':\tgoto yy408;\n+\tcase ':':\tgoto yy422;\n+\tcase 'n':\tgoto yy409;\n+\tcase 'r':\tgoto yy410;\n+\tcase 's':\tgoto yy403;\n+\tcase 't':\tgoto yy407;\n \tdefault:\tgoto yy12;\n \t}\n yy29:\n \tyyaccept = 1;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tswitch (yych) {\n-\tcase '\\t':\tgoto yy459;\n+\tcase '\\t':\tgoto yy399;\n \tcase ' ':\n \tcase 'A':\n \tcase 'D':\n@@ -1847,10 +1847,10 @@ yy29:\n \tcase 'o':\n \tcase 'p':\n \tcase 'w':\n-\tcase 'y':\tgoto yy461;\n-\tcase '-':\tgoto yy472;\n-\tcase '.':\tgoto yy473;\n-\tcase '\/':\tgoto yy471;\n+\tcase 'y':\tgoto yy401;\n+\tcase '-':\tgoto yy412;\n+\tcase '.':\tgoto yy413;\n+\tcase '\/':\tgoto yy411;\n \tcase '0':\n \tcase '1':\n \tcase '2':\n@@ -1860,12 +1860,12 @@ yy29:\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy468;\n-\tcase ':':\tgoto yy482;\n-\tcase 'n':\tgoto yy469;\n-\tcase 'r':\tgoto yy470;\n-\tcase 's':\tgoto yy463;\n-\tcase 't':\tgoto yy467;\n+\tcase '9':\tgoto yy408;\n+\tcase ':':\tgoto yy422;\n+\tcase 'n':\tgoto yy409;\n+\tcase 'r':\tgoto yy410;\n+\tcase 's':\tgoto yy403;\n+\tcase 't':\tgoto yy407;\n \tdefault:\tgoto yy12;\n \t}\n yy30:\n@@ -1876,17 +1876,17 @@ yy30:\n \t}\n \tswitch (yych) {\n \tcase '+':\n-\tcase '-':\tgoto yy439;\n+\tcase '-':\tgoto yy379;\n \tcase '0':\n-\tcase '1':\tgoto yy436;\n-\tcase '2':\tgoto yy437;\n+\tcase '1':\tgoto yy376;\n+\tcase '2':\tgoto yy377;\n \tcase '3':\n \tcase '4':\n \tcase '5':\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy438;\n+\tcase '9':\tgoto yy378;\n \tdefault:\tgoto yy12;\n \t}\n yy31:\n@@ -1916,13 +1916,13 @@ yy31:\n \t\t\t\tif (yych <= '@') goto yy3;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'I') goto yy435;\n+\t\t\t\tif (yych <= 'I') goto yy375;\n \t\t\t\tif (yych <= 'U') goto yy140;\n-\t\t\t\tgoto yy434;\n+\t\t\t\tgoto yy374;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych == 'X') goto yy434;\n+\t\t\t\tif (yych == 'X') goto yy374;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n \t\t\t\tif (yych <= '`') goto yy3;\n@@ -1952,7 +1952,7 @@ yy32:\n \t\t\tgoto yy140;\n \t\t} else {\n \t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= 'I') goto yy431;\n+\t\t\t\tif (yych <= 'I') goto yy371;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n \t\t\t\tif (yych <= '`') goto yy3;\n@@ -1982,7 +1982,7 @@ yy33:\n \t\t\tgoto yy140;\n \t\t} else {\n \t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= 'I') goto yy429;\n+\t\t\t\tif (yych <= 'I') goto yy369;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n \t\t\t\tif (yych <= '`') goto yy3;\n@@ -1998,17 +1998,17 @@ yy34:\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'A') goto yy412;\n+\t\t\tif (yych <= 'A') goto yy352;\n \t\t\tif (yych <= 'T') goto yy140;\n-\t\t\tgoto yy411;\n+\t\t\tgoto yy351;\n \t\t}\n \t} else {\n \t\tif (yych <= 'a') {\n \t\t\tif (yych <= 'Z') goto yy140;\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tgoto yy421;\n+\t\t\tgoto yy361;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy420;\n+\t\t\tif (yych == 'u') goto yy360;\n \t\t\tif (yych <= 'z') goto yy145;\n \t\t\tgoto yy3;\n \t\t}\n@@ -2020,17 +2020,17 @@ yy35:\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'A') goto yy412;\n+\t\t\tif (yych <= 'A') goto yy352;\n \t\t\tif (yych <= 'T') goto yy140;\n-\t\t\tgoto yy411;\n+\t\t\tgoto yy351;\n \t\t}\n \t} else {\n \t\tif (yych <= 'a') {\n \t\t\tif (yych <= 'Z') goto yy140;\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tgoto yy412;\n+\t\t\tgoto yy352;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy411;\n+\t\t\tif (yych == 'u') goto yy351;\n \t\t\tif (yych <= 'z') goto yy140;\n \t\t\tgoto yy3;\n \t\t}\n@@ -2044,12 +2044,12 @@ yy36:\n \t\t\tgoto yy140;\n \t\t} else {\n \t\t\tif (yych <= 'O') {\n-\t\t\t\tif (yych <= 'G') goto yy390;\n+\t\t\t\tif (yych <= 'G') goto yy330;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'P') goto yy389;\n+\t\t\t\tif (yych <= 'P') goto yy329;\n \t\t\t\tif (yych <= 'T') goto yy140;\n-\t\t\t\tgoto yy388;\n+\t\t\t\tgoto yy328;\n \t\t\t}\n \t\t}\n \t} else {\n@@ -2058,15 +2058,15 @@ yy36:\n \t\t\t\tif (yych <= 'Z') goto yy140;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'g') goto yy402;\n+\t\t\t\tif (yych == 'g') goto yy342;\n \t\t\t\tgoto yy145;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n-\t\t\t\tif (yych <= 'p') goto yy401;\n+\t\t\t\tif (yych <= 'p') goto yy341;\n \t\t\t\tgoto yy145;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'u') goto yy400;\n+\t\t\t\tif (yych <= 'u') goto yy340;\n \t\t\t\tif (yych <= 'z') goto yy145;\n \t\t\t\tgoto yy3;\n \t\t\t}\n@@ -2081,12 +2081,12 @@ yy37:\n \t\t\tgoto yy140;\n \t\t} else {\n \t\t\tif (yych <= 'O') {\n-\t\t\t\tif (yych <= 'G') goto yy390;\n+\t\t\t\tif (yych <= 'G') goto yy330;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'P') goto yy389;\n+\t\t\t\tif (yych <= 'P') goto yy329;\n \t\t\t\tif (yych <= 'T') goto yy140;\n-\t\t\t\tgoto yy388;\n+\t\t\t\tgoto yy328;\n \t\t\t}\n \t\t}\n \t} else {\n@@ -2095,15 +2095,15 @@ yy37:\n \t\t\t\tif (yych <= 'Z') goto yy140;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'g') goto yy390;\n+\t\t\t\tif (yych == 'g') goto yy330;\n \t\t\t\tgoto yy140;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n-\t\t\t\tif (yych <= 'p') goto yy389;\n+\t\t\t\tif (yych <= 'p') goto yy329;\n \t\t\t\tgoto yy140;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'u') goto yy388;\n+\t\t\t\tif (yych <= 'u') goto yy328;\n \t\t\t\tif (yych <= 'z') goto yy140;\n \t\t\t\tgoto yy3;\n \t\t\t}\n@@ -2118,7 +2118,7 @@ yy38:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'B') goto yy140;\n-\t\t\tgoto yy378;\n+\t\t\tgoto yy318;\n \t\t}\n \t} else {\n \t\tif (yych <= 'b') {\n@@ -2126,7 +2126,7 @@ yy38:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy145;\n \t\t} else {\n-\t\t\tif (yych <= 'c') goto yy383;\n+\t\t\tif (yych <= 'c') goto yy323;\n \t\t\tif (yych <= 'z') goto yy145;\n \t\t\tgoto yy3;\n \t\t}\n@@ -2140,7 +2140,7 @@ yy39:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'B') goto yy140;\n-\t\t\tgoto yy378;\n+\t\t\tgoto yy318;\n \t\t}\n \t} else {\n \t\tif (yych <= 'b') {\n@@ -2148,7 +2148,7 @@ yy39:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy140;\n \t\t} else {\n-\t\t\tif (yych <= 'c') goto yy378;\n+\t\t\tif (yych <= 'c') goto yy318;\n \t\t\tif (yych <= 'z') goto yy140;\n \t\t\tgoto yy3;\n \t\t}\n@@ -2170,7 +2170,7 @@ yy40:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy145;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy369;\n+\t\t\tif (yych <= 'e') goto yy309;\n \t\t\tif (yych <= 'z') goto yy145;\n \t\t\tgoto yy3;\n \t\t}\n@@ -2397,13 +2397,13 @@ yy56:\n \t\t\t\t\tif (yyaccept == 5) {\n \t\t\t\t\t\tgoto yy193;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy198;\n+\t\t\t\t\t\tgoto yy207;\n \t\t\t\t\t}\n \t\t\t\t} else {\n \t\t\t\t\tif (yyaccept == 7) {\n-\t\t\t\t\t\tgoto yy222;\n+\t\t\t\t\t\tgoto yy221;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy294;\n+\t\t\t\t\t\tgoto yy332;\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t}\n@@ -2411,95 +2411,91 @@ yy56:\n \t\t\tif (yyaccept <= 12) {\n \t\t\t\tif (yyaccept <= 10) {\n \t\t\t\t\tif (yyaccept == 9) {\n-\t\t\t\t\t\tgoto yy392;\n+\t\t\t\t\t\tgoto yy415;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy475;\n+\t\t\t\t\t\tgoto yy430;\n \t\t\t\t\t}\n \t\t\t\t} else {\n \t\t\t\t\tif (yyaccept == 11) {\n-\t\t\t\t\t\tgoto yy490;\n+\t\t\t\t\t\tgoto yy551;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy611;\n+\t\t\t\t\t\tgoto yy596;\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t} else {\n \t\t\t\tif (yyaccept <= 14) {\n \t\t\t\t\tif (yyaccept == 13) {\n-\t\t\t\t\t\tgoto yy656;\n+\t\t\t\t\t\tgoto yy606;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy666;\n+\t\t\t\t\t\tgoto yy703;\n \t\t\t\t\t}\n \t\t\t\t} else {\n \t\t\t\t\tif (yyaccept == 15) {\n-\t\t\t\t\t\tgoto yy763;\n+\t\t\t\t\t\tgoto yy723;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy783;\n+\t\t\t\t\t\tgoto yy754;\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t} else {\n-\t\tif (yyaccept <= 25) {\n-\t\t\tif (yyaccept <= 21) {\n-\t\t\t\tif (yyaccept <= 19) {\n-\t\t\t\t\tif (yyaccept <= 18) {\n-\t\t\t\t\t\tif (yyaccept == 17) {\n-\t\t\t\t\t\t\tgoto yy814;\n-\t\t\t\t\t\t} else {\n-\t\t\t\t\t\t\tgoto yy821;\n-\t\t\t\t\t\t}\n+\t\tif (yyaccept <= 24) {\n+\t\t\tif (yyaccept <= 20) {\n+\t\t\t\tif (yyaccept <= 18) {\n+\t\t\t\t\tif (yyaccept == 17) {\n+\t\t\t\t\t\tgoto yy761;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy848;\n+\t\t\t\t\t\tgoto yy788;\n \t\t\t\t\t}\n \t\t\t\t} else {\n-\t\t\t\t\tif (yyaccept == 20) {\n-\t\t\t\t\t\tgoto yy793;\n+\t\t\t\t\tif (yyaccept == 19) {\n+\t\t\t\t\t\tgoto yy733;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy454;\n+\t\t\t\t\t\tgoto yy394;\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t} else {\n-\t\t\t\tif (yyaccept <= 23) {\n-\t\t\t\t\tif (yyaccept == 22) {\n-\t\t\t\t\t\tgoto yy973;\n+\t\t\t\tif (yyaccept <= 22) {\n+\t\t\t\t\tif (yyaccept == 21) {\n+\t\t\t\t\t\tgoto yy913;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy842;\n+\t\t\t\t\t\tgoto yy782;\n \t\t\t\t\t}\n \t\t\t\t} else {\n-\t\t\t\t\tif (yyaccept == 24) {\n-\t\t\t\t\t\tgoto yy1067;\n+\t\t\t\t\tif (yyaccept == 23) {\n+\t\t\t\t\t\tgoto yy1007;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\t\tgoto yy1015;\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n-\t\t\tif (yyaccept <= 29) {\n-\t\t\t\tif (yyaccept <= 27) {\n-\t\t\t\t\tif (yyaccept == 26) {\n-\t\t\t\t\t\tgoto yy1117;\n+\t\t\tif (yyaccept <= 28) {\n+\t\t\t\tif (yyaccept <= 26) {\n+\t\t\t\t\tif (yyaccept == 25) {\n+\t\t\t\t\t\tgoto yy1057;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy1141;\n+\t\t\t\t\t\tgoto yy1081;\n \t\t\t\t\t}\n \t\t\t\t} else {\n-\t\t\t\t\tif (yyaccept == 28) {\n-\t\t\t\t\t\tgoto yy1294;\n+\t\t\t\t\tif (yyaccept == 27) {\n+\t\t\t\t\t\tgoto yy1234;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy1417;\n+\t\t\t\t\t\tgoto yy1357;\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t} else {\n-\t\t\t\tif (yyaccept <= 31) {\n-\t\t\t\t\tif (yyaccept == 30) {\n-\t\t\t\t\t\tgoto yy1420;\n+\t\t\t\tif (yyaccept <= 30) {\n+\t\t\t\t\tif (yyaccept == 29) {\n+\t\t\t\t\t\tgoto yy1360;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy1500;\n+\t\t\t\t\t\tgoto yy1440;\n \t\t\t\t\t}\n \t\t\t\t} else {\n-\t\t\t\t\tif (yyaccept == 32) {\n-\t\t\t\t\t\tgoto yy1508;\n+\t\t\t\t\tif (yyaccept == 31) {\n+\t\t\t\t\t\tgoto yy1448;\n \t\t\t\t\t} else {\n-\t\t\t\t\t\tgoto yy1531;\n+\t\t\t\t\t\tgoto yy1471;\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t}\n@@ -2692,7 +2688,7 @@ yy72:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_RELATIVE;\n \t}\n-#line 2696 \"<stdout>\"\n+#line 2692 \"<stdout>\"\n yy73:\n \tyych = *++YYCURSOR;\n \tif (yych == 'D') goto yy74;\n@@ -3377,7 +3373,7 @@ yy166:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_WEEKDAY;\n \t}\n-#line 3381 \"<stdout>\"\n+#line 3377 \"<stdout>\"\n yy167:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'K') {\n@@ -3857,14 +3853,14 @@ yy192:\n \t\t\tif (yych <= '@') {\n \t\t\t\tif (yych <= '9') goto yy195;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'E') goto yy201;\n+\t\t\t\tif (yych == 'E') goto yy200;\n \t\t\t\tgoto yy142;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'd') {\n \t\t\t\tif (yych >= 'a') goto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy201;\n+\t\t\t\tif (yych <= 'e') goto yy200;\n \t\t\t\tif (yych <= 'z') goto yy142;\n \t\t\t}\n \t\t}\n@@ -3879,10 +3875,10 @@ yy193:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_DATE_TEXT;\n \t}\n-#line 3883 \"<stdout>\"\n+#line 3879 \"<stdout>\"\n yy194:\n \t++YYCURSOR;\n-\tif ((YYLIMIT - YYCURSOR) < 21) YYFILL(21);\n+\tif ((YYLIMIT - YYCURSOR) < 23) YYFILL(23);\n \tyych = *YYCURSOR;\n yy195:\n \tif (yybm[0+yych] & 32) {\n@@ -3890,104 +3886,147 @@ yy195:\n \t}\n \tif (yych <= '\/') goto yy56;\n \tif (yych <= '2') goto yy197;\n-\tif (yych <= '3') goto yy199;\n-\tif (yych <= '9') goto yy200;\n+\tif (yych <= '3') goto yy198;\n+\tif (yych <= '9') goto yy199;\n \tgoto yy56;\n yy196:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy195;\n-\tif (yych <= '0') goto yy356;\n-\tif (yych <= '2') goto yy357;\n-\tif (yych <= '3') goto yy358;\n+\tif (yych <= '0') goto yy299;\n+\tif (yych <= '2') goto yy300;\n+\tif (yych <= '3') goto yy301;\n \tgoto yy195;\n yy197:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= 'm') {\n-\t\tif (yych <= '1') {\n-\t\t\tif (yych <= '\/') goto yy215;\n-\t\t\tif (yych <= '0') goto yy297;\n-\t\t\tgoto yy298;\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '9') {\n+\t\tif (yych <= ' ') {\n+\t\t\tif (yych <= 0x08) {\n+\t\t\t\tif (yych <= 0x00) goto yy213;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '\\t') goto yy211;\n+\t\t\t\tif (yych <= 0x1F) goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= '2') goto yy354;\n-\t\t\tif (yych <= '9') goto yy355;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= '-') {\n+\t\t\t\tif (yych == ',') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '.') goto yy211;\n+\t\t\t\tif (yych <= '\/') goto yy56;\n+\t\t\t\tgoto yy298;\n+\t\t\t}\n \t\t}\n \t} else {\n-\t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'n') goto yy211;\n-\t\t\tif (yych <= 'q') goto yy215;\n-\t\t\tgoto yy212;\n+\t\tif (yych <= 'm') {\n+\t\t\tif (yych <= 'd') {\n+\t\t\t\tif (yych <= 'c') goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t} else {\n+\t\t\t\tif (yych == 'h') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= 'r') {\n+\t\t\t\tif (yych <= 'n') goto yy208;\n+\t\t\t\tif (yych <= 'q') goto yy56;\n+\t\t\t\tgoto yy209;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= 's') goto yy206;\n+\t\t\t\tif (yych <= 't') goto yy210;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t}\n \t}\n yy198:\n-#line 1366 \"ext\/date\/lib\/parse_date.re\"\n-\t{\n-\t\tint length = 0;\n-\t\tDEBUG_OUTPUT(\"datetextual | datenoyear\");\n-\t\tTIMELIB_INIT;\n-\t\tTIMELIB_HAVE_DATE();\n-\t\ts->time->m = timelib_get_month((char **) &ptr);\n-\t\ts->time->d = timelib_get_nr((char **) &ptr, 2);\n-\t\ts->time->y = timelib_get_nr_ex((char **) &ptr, 4, &length);\n-\t\tTIMELIB_PROCESS_YEAR(s->time->y, length);\n-\t\tTIMELIB_DEINIT;\n-\t\treturn TIMELIB_DATE_TEXT;\n-\t}\n-#line 3942 \"<stdout>\"\n-yy199:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= 'm') {\n-\t\tif (yych <= '1') {\n-\t\t\tif (yych <= '\/') goto yy215;\n-\t\t\tif (yych <= '0') goto yy297;\n-\t\t\tgoto yy298;\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '1') {\n+\t\tif (yych <= ' ') {\n+\t\t\tif (yych <= 0x08) {\n+\t\t\t\tif (yych <= 0x00) goto yy213;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '\\t') goto yy211;\n+\t\t\t\tif (yych <= 0x1F) goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= '2') goto yy208;\n-\t\t\tif (yych <= '9') goto yy209;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= '-') {\n+\t\t\t\tif (yych == ',') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '.') goto yy211;\n+\t\t\t\tif (yych <= '\/') goto yy56;\n+\t\t\t\tgoto yy298;\n+\t\t\t}\n \t\t}\n \t} else {\n-\t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'n') goto yy211;\n-\t\t\tif (yych <= 'q') goto yy215;\n-\t\t\tgoto yy212;\n+\t\tif (yych <= 'm') {\n+\t\t\tif (yych <= 'd') {\n+\t\t\t\tif (yych <= '9') goto yy205;\n+\t\t\t\tif (yych <= 'c') goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t} else {\n+\t\t\t\tif (yych == 'h') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= 'r') {\n+\t\t\t\tif (yych <= 'n') goto yy208;\n+\t\t\t\tif (yych <= 'q') goto yy56;\n+\t\t\t\tgoto yy209;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= 's') goto yy206;\n+\t\t\t\tif (yych <= 't') goto yy210;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t}\n \t}\n-yy200:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= 'm') {\n-\t\tif (yych <= '1') {\n-\t\t\tif (yych <= '\/') goto yy215;\n-\t\t\tif (yych <= '0') goto yy206;\n-\t\t\tgoto yy207;\n+yy199:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '9') {\n+\t\tif (yych <= ' ') {\n+\t\t\tif (yych <= 0x08) {\n+\t\t\t\tif (yych <= 0x00) goto yy213;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '\\t') goto yy211;\n+\t\t\t\tif (yych <= 0x1F) goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= '2') goto yy208;\n-\t\t\tif (yych <= '9') goto yy209;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= '-') {\n+\t\t\t\tif (yych == ',') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '.') goto yy211;\n+\t\t\t\tif (yych <= '\/') goto yy56;\n+\t\t\t\tgoto yy205;\n+\t\t\t}\n \t\t}\n \t} else {\n-\t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'n') goto yy211;\n-\t\t\tif (yych <= 'q') goto yy215;\n-\t\t\tgoto yy212;\n+\t\tif (yych <= 'm') {\n+\t\t\tif (yych <= 'd') {\n+\t\t\t\tif (yych <= 'c') goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t} else {\n+\t\t\t\tif (yych == 'h') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= 'r') {\n+\t\t\t\tif (yych <= 'n') goto yy208;\n+\t\t\t\tif (yych <= 'q') goto yy56;\n+\t\t\t\tgoto yy209;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= 's') goto yy206;\n+\t\t\t\tif (yych <= 't') goto yy210;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t}\n \t}\n-yy201:\n+yy200:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'M') {\n \t\tif (yych <= ')') {\n@@ -4003,12 +4042,12 @@ yy201:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'm') goto yy202;\n+\t\t\tif (yych <= 'm') goto yy201;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy202:\n+yy201:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'B') {\n \t\tif (yych <= ')') {\n@@ -4024,26 +4063,26 @@ yy202:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'b') goto yy203;\n+\t\t\tif (yych <= 'b') goto yy202;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy203:\n+yy202:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'E') goto yy204;\n+\t\tif (yych <= 'E') goto yy203;\n \t\tif (yych != 'e') goto yy3;\n \t}\n-yy204:\n+yy203:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy205;\n+\tif (yych == 'R') goto yy204;\n \tif (yych != 'r') goto yy56;\n-yy205:\n+yy204:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ' ') {\n@@ -4060,129 +4099,143 @@ yy205:\n \t\t\tgoto yy193;\n \t\t}\n \t}\n-yy206:\n+yy205:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy220;\n-\t\tgoto yy56;\n-\t} else {\n-\t\tif (yych <= '0') goto yy295;\n-\t\tif (yych <= '9') goto yy296;\n-\t\tif (yych <= ':') goto yy220;\n-\t\tgoto yy56;\n-\t}\n+\tif (yych <= '\/') goto yy56;\n+\tif (yych <= '9') goto yy295;\n+\tgoto yy56;\n+yy206:\n+\tyyaccept = 6;\n+\tyych = *(YYMARKER = ++YYCURSOR);\n+\tif (yych == 't') goto yy294;\n+\tgoto yy212;\n yy207:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy263;\n-\t\tgoto yy56;\n-\t} else {\n-\t\tif (yych <= '2') goto yy296;\n-\t\tif (yych <= '9') goto yy295;\n-\t\tif (yych <= ':') goto yy263;\n-\t\tgoto yy56;\n+#line 1366 \"ext\/date\/lib\/parse_date.re\"\n+\t{\n+\t\tint length = 0;\n+\t\tDEBUG_OUTPUT(\"datetextual | datenoyear\");\n+\t\tTIMELIB_INIT;\n+\t\tTIMELIB_HAVE_DATE();\n+\t\ts->time->m = timelib_get_month((char **) &ptr);\n+\t\ts->time->d = timelib_get_nr((char **) &ptr, 2);\n+\t\ts->time->y = timelib_get_nr_ex((char **) &ptr, 4, &length);\n+\t\tTIMELIB_PROCESS_YEAR(s->time->y, length);\n+\t\tTIMELIB_DEINIT;\n+\t\treturn TIMELIB_DATE_TEXT;\n \t}\n+#line 4127 \"<stdout>\"\n yy208:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy263;\n-\t\tgoto yy56;\n-\t} else {\n-\t\tif (yych <= '4') goto yy295;\n-\t\tif (yych <= '9') goto yy292;\n-\t\tif (yych <= ':') goto yy263;\n-\t\tgoto yy56;\n-\t}\n-yy209:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy263;\n-\t\tgoto yy56;\n-\t} else {\n-\t\tif (yych <= '9') goto yy292;\n-\t\tif (yych <= ':') goto yy263;\n-\t\tgoto yy56;\n-\t}\n-yy210:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tgoto yy215;\n-yy211:\n \tyyaccept = 6;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tgoto yy215;\n-yy212:\n+\tif (yych == 'd') goto yy294;\n+\tgoto yy212;\n+yy209:\n \tyyaccept = 6;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tgoto yy215;\n-yy213:\n+\tif (yych == 'd') goto yy294;\n+\tgoto yy212;\n+yy210:\n \tyyaccept = 6;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tgoto yy215;\n-yy214:\n+\tif (yych == 'h') goto yy294;\n+\tgoto yy212;\n+yy211:\n \tyyaccept = 6;\n \tYYMARKER = ++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 18) YYFILL(18);\n \tyych = *YYCURSOR;\n-yy215:\n+yy212:\n \tif (yybm[0+yych] & 64) {\n-\t\tgoto yy214;\n+\t\tgoto yy211;\n \t}\n \tif (yych <= '2') {\n-\t\tif (yych <= '\/') goto yy198;\n-\t\tif (yych <= '0') goto yy258;\n-\t\tif (yych <= '1') goto yy259;\n-\t\tgoto yy260;\n+\t\tif (yych <= '\/') goto yy207;\n+\t\tif (yych <= '0') goto yy285;\n+\t\tif (yych <= '1') goto yy286;\n+\t\tgoto yy287;\n+\t} else {\n+\t\tif (yych <= '9') goto yy288;\n+\t\tif (yych == 'T') goto yy214;\n+\t\tgoto yy207;\n+\t}\n+yy213:\n+\tyyaccept = 6;\n+\tyych = *(YYMARKER = ++YYCURSOR);\n+\tif (yych <= '9') {\n+\t\tif (yych <= '0') {\n+\t\t\tif (yych <= '\/') goto yy207;\n+\t\t\tgoto yy215;\n+\t\t} else {\n+\t\t\tif (yych <= '1') goto yy216;\n+\t\t\tif (yych <= '2') goto yy217;\n+\t\t\tgoto yy218;\n+\t\t}\n \t} else {\n-\t\tif (yych <= '9') goto yy261;\n-\t\tif (yych != 'T') goto yy198;\n+\t\tif (yych <= 'T') {\n+\t\t\tif (yych <= 'S') goto yy207;\n+\t\t} else {\n+\t\t\tif (yych != 't') goto yy207;\n+\t\t}\n \t}\n+yy214:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '1') goto yy217;\n-\tif (yych <= '2') goto yy218;\n-\tif (yych <= '9') goto yy219;\n+\tif (yych <= '1') goto yy283;\n+\tif (yych <= '2') goto yy284;\n+\tif (yych <= '9') goto yy273;\n \tgoto yy56;\n-yy217:\n+yy215:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy220;\n+\t\tif (yych == '.') goto yy274;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= '9') goto yy219;\n-\t\tif (yych <= ':') goto yy220;\n+\t\tif (yych <= '0') goto yy273;\n+\t\tif (yych <= '9') goto yy218;\n+\t\tif (yych <= ':') goto yy274;\n \t\tgoto yy56;\n \t}\n-yy218:\n+yy216:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy220;\n+\t\tif (yych == '.') goto yy219;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= '4') goto yy219;\n-\t\tif (yych == ':') goto yy220;\n+\t\tif (yych <= '2') goto yy218;\n+\t\tif (yych <= '9') goto yy273;\n+\t\tif (yych <= ':') goto yy219;\n \t\tgoto yy56;\n \t}\n-yy219:\n+yy217:\n \tyych = *++YYCURSOR;\n-\tif (yych == '.') goto yy220;\n+\tif (yych <= '\/') {\n+\t\tif (yych == '.') goto yy219;\n+\t\tgoto yy56;\n+\t} else {\n+\t\tif (yych <= '4') goto yy273;\n+\t\tif (yych == ':') goto yy219;\n+\t\tgoto yy56;\n+\t}\n+yy218:\n+\tyych = *++YYCURSOR;\n+\tif (yych == '.') goto yy219;\n \tif (yych != ':') goto yy56;\n-yy220:\n+yy219:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy221;\n-\tif (yych <= '9') goto yy223;\n+\tif (yych <= '5') goto yy220;\n+\tif (yych <= '9') goto yy222;\n \tgoto yy56;\n-yy221:\n+yy220:\n \tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy224;\n+\t\tif (yych == '.') goto yy223;\n \t} else {\n-\t\tif (yych <= '9') goto yy223;\n-\t\tif (yych <= ':') goto yy224;\n+\t\tif (yych <= '9') goto yy266;\n+\t\tif (yych <= ':') goto yy223;\n \t}\n-yy222:\n+yy221:\n #line 1668 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint tz_not_found;\n@@ -4212,1997 +4265,1094 @@ yy222:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_SHORTDATE_WITH_TIME;\n \t}\n-#line 4216 \"<stdout>\"\n-yy223:\n+#line 4269 \"<stdout>\"\n+yy222:\n \tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy224;\n-\tif (yych != ':') goto yy222;\n-yy224:\n+\tif (yych == '.') goto yy223;\n+\tif (yych != ':') goto yy221;\n+yy223:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy225;\n-\tif (yych <= '6') goto yy226;\n-\tif (yych <= '9') goto yy227;\n+\tif (yych <= '5') goto yy224;\n+\tif (yych <= '6') goto yy225;\n+\tif (yych <= '9') goto yy226;\n \tgoto yy56;\n+yy224:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '\/') goto yy221;\n+\tif (yych <= '9') goto yy227;\n+\tgoto yy221;\n yy225:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy222;\n-\tif (yych <= '9') goto yy228;\n-\tgoto yy222;\n+\tif (yych == '0') goto yy227;\n+\tgoto yy221;\n yy226:\n \tyych = *++YYCURSOR;\n-\tif (yych == '0') goto yy228;\n-\tgoto yy222;\n+\tgoto yy221;\n yy227:\n-\tyych = *++YYCURSOR;\n-\tgoto yy222;\n-yy228:\n \tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '*') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy230;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych == '\\t') goto yy229;\n+\t\t\tgoto yy221;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy230;\n-\t\t\tif (yych == '(') goto yy230;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= ' ') goto yy229;\n+\t\t\tif (yych == '(') goto yy229;\n+\t\t\tgoto yy221;\n \t\t}\n \t} else {\n \t\tif (yych <= '@') {\n-\t\t\tif (yych == ',') goto yy222;\n-\t\t\tif (yych <= '-') goto yy230;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych == ',') goto yy221;\n+\t\t\tif (yych <= '-') goto yy229;\n+\t\t\tgoto yy221;\n \t\t} else {\n-\t\t\tif (yych <= 'Z') goto yy230;\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych <= 'z') goto yy230;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= 'Z') goto yy229;\n+\t\t\tif (yych <= '`') goto yy221;\n+\t\t\tif (yych <= 'z') goto yy229;\n+\t\t\tgoto yy221;\n \t\t}\n \t}\n-yy229:\n+yy228:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 9) YYFILL(9);\n \tyych = *YYCURSOR;\n-yy230:\n-\tif (yych <= '+') {\n-\t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy229;\n-\t\t\tif (yych <= 0x1F) goto yy56;\n-\t\t\tgoto yy229;\n+yy229:\n+\tif (yych <= '@') {\n+\t\tif (yych <= '\\'') {\n+\t\t\tif (yych <= '\\t') {\n+\t\t\t\tif (yych <= 0x08) goto yy56;\n+\t\t\t\tgoto yy228;\n+\t\t\t} else {\n+\t\t\t\tif (yych == ' ') goto yy228;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych == '(') goto yy233;\n-\t\t\tif (yych <= '*') goto yy56;\n-\t\t\tgoto yy232;\n+\t\t\tif (yych <= '+') {\n+\t\t\t\tif (yych <= '(') goto yy232;\n+\t\t\t\tif (yych <= '*') goto yy56;\n+\t\t\t\tgoto yy231;\n+\t\t\t} else {\n+\t\t\t\tif (yych == '-') goto yy231;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t}\n \t} else {\n-\t\tif (yych <= 'F') {\n-\t\t\tif (yych == '-') goto yy232;\n-\t\t\tif (yych <= '@') goto yy56;\n-\t\t\tgoto yy234;\n-\t\t} else {\n-\t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych >= 'H') goto yy234;\n+\t\tif (yych <= 'Z') {\n+\t\t\tif (yych <= 'G') {\n+\t\t\t\tif (yych <= 'A') goto yy233;\n+\t\t\t\tif (yych <= 'F') goto yy234;\n \t\t\t} else {\n+\t\t\t\tif (yych == 'P') goto yy233;\n+\t\t\t\tgoto yy234;\n+\t\t\t}\n+\t\t} else {\n+\t\t\tif (yych <= 'o') {\n \t\t\t\tif (yych <= '`') goto yy56;\n-\t\t\t\tif (yych <= 'z') goto yy235;\n+\t\t\t\tif (yych <= 'a') goto yy235;\n+\t\t\t\tgoto yy236;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= 'p') goto yy235;\n+\t\t\t\tif (yych <= 'z') goto yy236;\n \t\t\t\tgoto yy56;\n \t\t\t}\n \t\t}\n \t}\n-yy231:\n+yy230:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'L') {\n-\t\tif (yych == ')') goto yy227;\n-\t\tif (yych <= '@') goto yy222;\n-\t\tgoto yy236;\n+\t\tif (yych == ')') goto yy226;\n+\t\tif (yych <= '@') goto yy221;\n+\t\tgoto yy237;\n \t} else {\n \t\tif (yych <= 'Z') {\n-\t\t\tif (yych <= 'M') goto yy256;\n-\t\t\tgoto yy236;\n+\t\t\tif (yych <= 'M') goto yy264;\n+\t\t\tgoto yy237;\n \t\t} else {\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych <= 'z') goto yy241;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= '`') goto yy221;\n+\t\t\tif (yych <= 'z') goto yy248;\n+\t\t\tgoto yy221;\n \t\t}\n \t}\n-yy232:\n+yy231:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '1') goto yy251;\n-\tif (yych <= '2') goto yy252;\n-\tif (yych <= '9') goto yy253;\n+\tif (yych <= '1') goto yy259;\n+\tif (yych <= '2') goto yy260;\n+\tif (yych <= '9') goto yy261;\n \tgoto yy56;\n-yy233:\n+yy232:\n \tyych = *++YYCURSOR;\n \tif (yych <= '@') goto yy56;\n-\tif (yych <= 'Z') goto yy235;\n+\tif (yych <= 'Z') goto yy236;\n \tif (yych <= '`') goto yy56;\n-\tif (yych <= 'z') goto yy235;\n+\tif (yych <= 'z') goto yy236;\n \tgoto yy56;\n+yy233:\n+\tyyaccept = 7;\n+\tyych = *(YYMARKER = ++YYCURSOR);\n+\tif (yych <= 'L') {\n+\t\tif (yych <= '-') {\n+\t\t\tif (yych == ')') goto yy226;\n+\t\t\tgoto yy221;\n+\t\t} else {\n+\t\t\tif (yych <= '.') goto yy242;\n+\t\t\tif (yych <= '@') goto yy221;\n+\t\t\tgoto yy237;\n+\t\t}\n+\t} else {\n+\t\tif (yych <= '`') {\n+\t\t\tif (yych <= 'M') goto yy243;\n+\t\t\tif (yych <= 'Z') goto yy237;\n+\t\t\tgoto yy221;\n+\t\t} else {\n+\t\t\tif (yych == 'm') goto yy258;\n+\t\t\tif (yych <= 'z') goto yy248;\n+\t\t\tgoto yy221;\n+\t\t}\n+\t}\n yy234:\n \tyych = *++YYCURSOR;\n \tif (yych <= '@') {\n-\t\tif (yych == ')') goto yy227;\n-\t\tgoto yy222;\n+\t\tif (yych == ')') goto yy226;\n+\t\tgoto yy221;\n \t} else {\n-\t\tif (yych <= 'Z') goto yy236;\n-\t\tif (yych <= '`') goto yy222;\n-\t\tif (yych <= 'z') goto yy241;\n-\t\tgoto yy222;\n+\t\tif (yych <= 'Z') goto yy237;\n+\t\tif (yych <= '`') goto yy221;\n+\t\tif (yych <= 'z') goto yy248;\n+\t\tgoto yy221;\n \t}\n yy235:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '@') {\n-\t\tif (yych == ')') goto yy227;\n-\t\tgoto yy222;\n+\tyyaccept = 7;\n+\tyych = *(YYMARKER = ++YYCURSOR);\n+\tif (yych <= 'L') {\n+\t\tif (yych <= '-') {\n+\t\t\tif (yych == ')') goto yy226;\n+\t\t\tgoto yy221;\n+\t\t} else {\n+\t\t\tif (yych <= '.') goto yy242;\n+\t\t\tif (yych <= '@') goto yy221;\n+\t\t\tgoto yy237;\n+\t\t}\n \t} else {\n-\t\tif (yych <= 'Z') goto yy236;\n-\t\tif (yych <= '`') goto yy222;\n-\t\tif (yych >= '{') goto yy222;\n+\t\tif (yych <= '`') {\n+\t\t\tif (yych <= 'M') goto yy243;\n+\t\t\tif (yych <= 'Z') goto yy237;\n+\t\t\tgoto yy221;\n+\t\t} else {\n+\t\t\tif (yych == 'm') goto yy243;\n+\t\t\tif (yych <= 'z') goto yy237;\n+\t\t\tgoto yy221;\n+\t\t}\n \t}\n yy236:\n \tyych = *++YYCURSOR;\n \tif (yych <= '@') {\n-\t\tif (yych == ')') goto yy227;\n-\t\tgoto yy222;\n+\t\tif (yych == ')') goto yy226;\n+\t\tgoto yy221;\n \t} else {\n \t\tif (yych <= 'Z') goto yy237;\n-\t\tif (yych <= '`') goto yy222;\n-\t\tif (yych >= '{') goto yy222;\n+\t\tif (yych <= '`') goto yy221;\n+\t\tif (yych >= '{') goto yy221;\n \t}\n yy237:\n \tyych = *++YYCURSOR;\n \tif (yych <= '@') {\n-\t\tif (yych == ')') goto yy227;\n-\t\tgoto yy222;\n+\t\tif (yych == ')') goto yy226;\n+\t\tgoto yy221;\n \t} else {\n \t\tif (yych <= 'Z') goto yy238;\n-\t\tif (yych <= '`') goto yy222;\n-\t\tif (yych >= '{') goto yy222;\n+\t\tif (yych <= '`') goto yy221;\n+\t\tif (yych >= '{') goto yy221;\n \t}\n yy238:\n \tyych = *++YYCURSOR;\n \tif (yych <= '@') {\n-\t\tif (yych == ')') goto yy227;\n-\t\tgoto yy222;\n+\t\tif (yych == ')') goto yy226;\n+\t\tgoto yy221;\n \t} else {\n \t\tif (yych <= 'Z') goto yy239;\n-\t\tif (yych <= '`') goto yy222;\n-\t\tif (yych >= '{') goto yy222;\n+\t\tif (yych <= '`') goto yy221;\n+\t\tif (yych >= '{') goto yy221;\n \t}\n yy239:\n \tyych = *++YYCURSOR;\n \tif (yych <= '@') {\n-\t\tif (yych == ')') goto yy227;\n-\t\tgoto yy222;\n+\t\tif (yych == ')') goto yy226;\n+\t\tgoto yy221;\n \t} else {\n \t\tif (yych <= 'Z') goto yy240;\n-\t\tif (yych <= '`') goto yy222;\n-\t\tif (yych >= '{') goto yy222;\n+\t\tif (yych <= '`') goto yy221;\n+\t\tif (yych >= '{') goto yy221;\n \t}\n yy240:\n \tyych = *++YYCURSOR;\n-\tif (yych == ')') goto yy227;\n-\tgoto yy222;\n+\tif (yych <= '@') {\n+\t\tif (yych == ')') goto yy226;\n+\t\tgoto yy221;\n+\t} else {\n+\t\tif (yych <= 'Z') goto yy241;\n+\t\tif (yych <= '`') goto yy221;\n+\t\tif (yych >= '{') goto yy221;\n+\t}\n yy241:\n+\tyych = *++YYCURSOR;\n+\tif (yych == ')') goto yy226;\n+\tgoto yy221;\n+yy242:\n+\tyych = *++YYCURSOR;\n+\tif (yych == 'M') goto yy247;\n+\tif (yych == 'm') goto yy247;\n+\tgoto yy56;\n+yy243:\n+\tyyaccept = 7;\n+\tyych = *(YYMARKER = ++YYCURSOR);\n+\tif (yych <= ')') {\n+\t\tif (yych <= '\\t') {\n+\t\t\tif (yych <= 0x00) goto yy245;\n+\t\t\tif (yych <= 0x08) goto yy221;\n+\t\t\tgoto yy245;\n+\t\t} else {\n+\t\t\tif (yych == ' ') goto yy245;\n+\t\t\tif (yych <= '(') goto yy221;\n+\t\t\tgoto yy226;\n+\t\t}\n+\t} else {\n+\t\tif (yych <= '@') {\n+\t\t\tif (yych != '.') goto yy221;\n+\t\t} else {\n+\t\t\tif (yych <= 'Z') goto yy238;\n+\t\t\tif (yych <= '`') goto yy221;\n+\t\t\tif (yych <= 'z') goto yy238;\n+\t\t\tgoto yy221;\n+\t\t}\n+\t}\n+yy244:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '\\t') {\n+\t\tif (yych <= 0x00) goto yy245;\n+\t\tif (yych <= 0x08) goto yy56;\n+\t} else {\n+\t\tif (yych != ' ') goto yy56;\n+\t}\n+yy245:\n+\t++YYCURSOR;\n+#line 1644 \"ext\/date\/lib\/parse_date.re\"\n+\t{\n+\t\tDEBUG_OUTPUT(\"dateshortwithtimeshort12 | dateshortwithtimelong12\");\n+\t\tTIMELIB_INIT;\n+\t\tTIMELIB_HAVE_DATE();\n+\t\ts->time->m = timelib_get_month((char **) &ptr);\n+\t\ts->time->d = timelib_get_nr((char **) &ptr, 2);\n+\n+\t\tTIMELIB_HAVE_TIME();\n+\t\ts->time->h = timelib_get_nr((char **) &ptr, 2);\n+\t\ts->time->i = timelib_get_nr((char **) &ptr, 2);\n+\t\tif (*ptr == ':' || *ptr == '.') {\n+\t\t\ts->time->s = timelib_get_nr((char **) &ptr, 2);\n+\n+\t\t\tif (*ptr == '.') {\n+\t\t\t\ts->time->f = timelib_get_frac_nr((char **) &ptr, 8);\n+\t\t\t}\n+\t\t}\n+\n+\t\ts->time->h += timelib_meridian((char **) &ptr, s->time->h);\n+\t\tTIMELIB_DEINIT;\n+\t\treturn TIMELIB_SHORTDATE_WITH_TIME;\n+\t}\n+#line 4565 \"<stdout>\"\n+yy247:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= 0x1F) {\n+\t\tif (yych <= 0x00) goto yy245;\n+\t\tif (yych == '\\t') goto yy245;\n+\t\tgoto yy56;\n+\t} else {\n+\t\tif (yych <= ' ') goto yy245;\n+\t\tif (yych == '.') goto yy244;\n+\t\tgoto yy56;\n+\t}\n+yy248:\n \tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n \t\tif (yych <= ',') {\n-\t\t\tif (yych == ')') goto yy227;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych == ')') goto yy226;\n+\t\t\tgoto yy221;\n \t\t} else {\n-\t\t\tif (yych == '.') goto yy222;\n-\t\t\tgoto yy243;\n+\t\t\tif (yych == '.') goto yy221;\n+\t\t\tgoto yy250;\n \t\t}\n \t} else {\n \t\tif (yych <= '^') {\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tif (yych <= 'Z') goto yy237;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= '@') goto yy221;\n+\t\t\tif (yych <= 'Z') goto yy238;\n+\t\t\tgoto yy221;\n \t\t} else {\n-\t\t\tif (yych <= '_') goto yy243;\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych >= '{') goto yy222;\n+\t\t\tif (yych <= '_') goto yy250;\n+\t\t\tif (yych <= '`') goto yy221;\n+\t\t\tif (yych >= '{') goto yy221;\n \t\t}\n \t}\n-yy242:\n+yy249:\n \tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n \t\tif (yych <= ',') {\n-\t\t\tif (yych == ')') goto yy227;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych == ')') goto yy226;\n+\t\t\tgoto yy221;\n \t\t} else {\n-\t\t\tif (yych == '.') goto yy222;\n+\t\t\tif (yych == '.') goto yy221;\n \t\t}\n \t} else {\n \t\tif (yych <= '^') {\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tif (yych <= 'Z') goto yy238;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= '@') goto yy221;\n+\t\t\tif (yych <= 'Z') goto yy239;\n+\t\t\tgoto yy221;\n \t\t} else {\n-\t\t\tif (yych <= '_') goto yy243;\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych <= 'z') goto yy246;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= '_') goto yy250;\n+\t\t\tif (yych <= '`') goto yy221;\n+\t\t\tif (yych <= 'z') goto yy253;\n+\t\t\tgoto yy221;\n \t\t}\n \t}\n-yy243:\n+yy250:\n \t++YYCURSOR;\n \tif (YYLIMIT <= YYCURSOR) YYFILL(1);\n \tyych = *YYCURSOR;\n \tif (yych <= '@') goto yy56;\n-\tif (yych <= 'Z') goto yy244;\n+\tif (yych <= 'Z') goto yy251;\n \tif (yych <= '`') goto yy56;\n \tif (yych >= '{') goto yy56;\n-yy244:\n+yy251:\n \tyyaccept = 7;\n \tYYMARKER = ++YYCURSOR;\n \tif (YYLIMIT <= YYCURSOR) YYFILL(1);\n \tyych = *YYCURSOR;\n \tif (yych <= '@') {\n \t\tif (yych <= '-') {\n-\t\t\tif (yych <= ',') goto yy222;\n-\t\t\tgoto yy243;\n+\t\t\tif (yych <= ',') goto yy221;\n+\t\t\tgoto yy250;\n \t\t} else {\n-\t\t\tif (yych == '\/') goto yy243;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych == '\/') goto yy250;\n+\t\t\tgoto yy221;\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'Z') goto yy244;\n-\t\t\tif (yych <= '^') goto yy222;\n-\t\t\tgoto yy243;\n+\t\t\tif (yych <= 'Z') goto yy251;\n+\t\t\tif (yych <= '^') goto yy221;\n+\t\t\tgoto yy250;\n \t\t} else {\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych <= 'z') goto yy244;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= '`') goto yy221;\n+\t\t\tif (yych <= 'z') goto yy251;\n+\t\t\tgoto yy221;\n \t\t}\n \t}\n-yy246:\n+yy253:\n \tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n \t\tif (yych <= ',') {\n-\t\t\tif (yych == ')') goto yy227;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych == ')') goto yy226;\n+\t\t\tgoto yy221;\n \t\t} else {\n-\t\t\tif (yych == '.') goto yy222;\n-\t\t\tgoto yy243;\n+\t\t\tif (yych == '.') goto yy221;\n+\t\t\tgoto yy250;\n \t\t}\n \t} else {\n \t\tif (yych <= '^') {\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tif (yych <= 'Z') goto yy239;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= '@') goto yy221;\n+\t\t\tif (yych <= 'Z') goto yy240;\n+\t\t\tgoto yy221;\n \t\t} else {\n-\t\t\tif (yych <= '_') goto yy243;\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych >= '{') goto yy222;\n+\t\t\tif (yych <= '_') goto yy250;\n+\t\t\tif (yych <= '`') goto yy221;\n+\t\t\tif (yych >= '{') goto yy221;\n \t\t}\n \t}\n \tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n \t\tif (yych <= ',') {\n-\t\t\tif (yych == ')') goto yy227;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych == ')') goto yy226;\n+\t\t\tgoto yy221;\n \t\t} else {\n-\t\t\tif (yych == '.') goto yy222;\n-\t\t\tgoto yy243;\n+\t\t\tif (yych == '.') goto yy221;\n+\t\t\tgoto yy250;\n \t\t}\n \t} else {\n \t\tif (yych <= '^') {\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tif (yych <= 'Z') goto yy240;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= '@') goto yy221;\n+\t\t\tif (yych <= 'Z') goto yy241;\n+\t\t\tgoto yy221;\n \t\t} else {\n-\t\t\tif (yych <= '_') goto yy243;\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych >= '{') goto yy222;\n+\t\t\tif (yych <= '_') goto yy250;\n+\t\t\tif (yych <= '`') goto yy221;\n+\t\t\tif (yych >= '{') goto yy221;\n \t\t}\n \t}\n \tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= ')') {\n-\t\t\tif (yych <= '(') goto yy222;\n-\t\t\tgoto yy227;\n+\t\t\tif (yych <= '(') goto yy221;\n+\t\t\tgoto yy226;\n \t\t} else {\n-\t\t\tif (yych == '-') goto yy243;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych == '-') goto yy250;\n+\t\t\tgoto yy221;\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= '\/') goto yy243;\n-\t\t\tif (yych <= '^') goto yy222;\n-\t\t\tgoto yy243;\n+\t\t\tif (yych <= '\/') goto yy250;\n+\t\t\tif (yych <= '^') goto yy221;\n+\t\t\tgoto yy250;\n \t\t} else {\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych >= '{') goto yy222;\n+\t\t\tif (yych <= '`') goto yy221;\n+\t\t\tif (yych >= '{') goto yy221;\n \t\t}\n \t}\n-yy249:\n+yy256:\n \t++YYCURSOR;\n \tif (YYLIMIT <= YYCURSOR) YYFILL(1);\n \tyych = *YYCURSOR;\n \tif (yych <= '\/') {\n-\t\tif (yych == '-') goto yy243;\n+\t\tif (yych == '-') goto yy250;\n \t\tif (yych <= '.') goto yy56;\n-\t\tgoto yy243;\n+\t\tgoto yy250;\n \t} else {\n \t\tif (yych <= '_') {\n \t\t\tif (yych <= '^') goto yy56;\n-\t\t\tgoto yy243;\n+\t\t\tgoto yy250;\n \t\t} else {\n \t\t\tif (yych <= '`') goto yy56;\n-\t\t\tif (yych <= 'z') goto yy249;\n+\t\t\tif (yych <= 'z') goto yy256;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy251:\n+yy258:\n+\tyyaccept = 7;\n+\tyych = *(YYMARKER = ++YYCURSOR);\n+\tif (yych <= '-') {\n+\t\tif (yych <= 0x1F) {\n+\t\t\tif (yych <= 0x00) goto yy245;\n+\t\t\tif (yych == '\\t') goto yy245;\n+\t\t\tgoto yy221;\n+\t\t} else {\n+\t\t\tif (yych <= '(') {\n+\t\t\t\tif (yych <= ' ') goto yy245;\n+\t\t\t\tgoto yy221;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= ')') goto yy226;\n+\t\t\t\tif (yych <= ',') goto yy221;\n+\t\t\t\tgoto yy250;\n+\t\t\t}\n+\t\t}\n+\t} else {\n+\t\tif (yych <= 'Z') {\n+\t\t\tif (yych <= '.') goto yy244;\n+\t\t\tif (yych <= '\/') goto yy250;\n+\t\t\tif (yych <= '@') goto yy221;\n+\t\t\tgoto yy238;\n+\t\t} else {\n+\t\t\tif (yych <= '_') {\n+\t\t\t\tif (yych <= '^') goto yy221;\n+\t\t\t\tgoto yy250;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '`') goto yy221;\n+\t\t\t\tif (yych <= 'z') goto yy249;\n+\t\t\t\tgoto yy221;\n+\t\t\t}\n+\t\t}\n+\t}\n+yy259:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy222;\n-\tif (yych <= '9') goto yy253;\n-\tif (yych <= ':') goto yy254;\n-\tgoto yy222;\n-yy252:\n+\tif (yych <= '\/') goto yy221;\n+\tif (yych <= '9') goto yy261;\n+\tif (yych <= ':') goto yy262;\n+\tgoto yy221;\n+yy260:\n \tyych = *++YYCURSOR;\n \tif (yych <= '5') {\n-\t\tif (yych <= '\/') goto yy222;\n-\t\tif (yych >= '5') goto yy255;\n+\t\tif (yych <= '\/') goto yy221;\n+\t\tif (yych >= '5') goto yy263;\n \t} else {\n-\t\tif (yych <= '9') goto yy227;\n-\t\tif (yych <= ':') goto yy254;\n-\t\tgoto yy222;\n+\t\tif (yych <= '9') goto yy226;\n+\t\tif (yych <= ':') goto yy262;\n+\t\tgoto yy221;\n \t}\n-yy253:\n+yy261:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy222;\n-\tif (yych <= '5') goto yy255;\n-\tif (yych <= '9') goto yy227;\n-\tif (yych >= ';') goto yy222;\n-yy254:\n+\tif (yych <= '\/') goto yy221;\n+\tif (yych <= '5') goto yy263;\n+\tif (yych <= '9') goto yy226;\n+\tif (yych >= ';') goto yy221;\n+yy262:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy222;\n-\tif (yych <= '5') goto yy255;\n-\tif (yych <= '9') goto yy227;\n-\tgoto yy222;\n-yy255:\n+\tif (yych <= '\/') goto yy221;\n+\tif (yych <= '5') goto yy263;\n+\tif (yych <= '9') goto yy226;\n+\tgoto yy221;\n+yy263:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy222;\n-\tif (yych <= '9') goto yy227;\n-\tgoto yy222;\n-yy256:\n+\tif (yych <= '\/') goto yy221;\n+\tif (yych <= '9') goto yy226;\n+\tgoto yy221;\n+yy264:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'S') {\n-\t\tif (yych == ')') goto yy227;\n-\t\tif (yych <= '@') goto yy222;\n-\t\tgoto yy237;\n+\t\tif (yych == ')') goto yy226;\n+\t\tif (yych <= '@') goto yy221;\n+\t\tgoto yy238;\n \t} else {\n \t\tif (yych <= 'Z') {\n-\t\t\tif (yych >= 'U') goto yy237;\n+\t\t\tif (yych >= 'U') goto yy238;\n \t\t} else {\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych <= 'z') goto yy237;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= '`') goto yy221;\n+\t\t\tif (yych <= 'z') goto yy238;\n+\t\t\tgoto yy221;\n \t\t}\n \t}\n \tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ',') {\n \t\tif (yych <= ')') {\n-\t\t\tif (yych <= '(') goto yy222;\n-\t\t\tgoto yy227;\n+\t\t\tif (yych <= '(') goto yy221;\n+\t\t\tgoto yy226;\n \t\t} else {\n-\t\t\tif (yych == '+') goto yy232;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych == '+') goto yy231;\n+\t\t\tgoto yy221;\n \t\t}\n \t} else {\n \t\tif (yych <= 'Z') {\n-\t\t\tif (yych <= '-') goto yy232;\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tgoto yy238;\n+\t\t\tif (yych <= '-') goto yy231;\n+\t\t\tif (yych <= '@') goto yy221;\n+\t\t\tgoto yy239;\n \t\t} else {\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych <= 'z') goto yy238;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= '`') goto yy221;\n+\t\t\tif (yych <= 'z') goto yy239;\n+\t\t\tgoto yy221;\n \t\t}\n \t}\n-yy258:\n-\tyyaccept = 6;\n+yy266:\n+\tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy220;\n-\t\tgoto yy198;\n+\tif (yych <= ':') {\n+\t\tif (yych <= ' ') {\n+\t\t\tif (yych == '\\t') goto yy267;\n+\t\t\tif (yych <= 0x1F) goto yy221;\n+\t\t} else {\n+\t\t\tif (yych == '.') goto yy223;\n+\t\t\tif (yych <= '9') goto yy221;\n+\t\t\tgoto yy223;\n+\t\t}\n \t} else {\n-\t\tif (yych <= '0') goto yy290;\n-\t\tif (yych <= '9') goto yy291;\n-\t\tif (yych <= ':') goto yy220;\n-\t\tgoto yy198;\n+\t\tif (yych <= 'P') {\n+\t\t\tif (yych == 'A') goto yy269;\n+\t\t\tif (yych <= 'O') goto yy221;\n+\t\t\tgoto yy269;\n+\t\t} else {\n+\t\t\tif (yych <= 'a') {\n+\t\t\t\tif (yych <= '`') goto yy221;\n+\t\t\t\tgoto yy269;\n+\t\t\t} else {\n+\t\t\t\tif (yych == 'p') goto yy269;\n+\t\t\t\tgoto yy221;\n+\t\t\t}\n+\t\t}\n \t}\n-yy259:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy263;\n-\t\tgoto yy198;\n+yy267:\n+\t++YYCURSOR;\n+\tif ((YYLIMIT - YYCURSOR) < 5) YYFILL(5);\n+\tyych = *YYCURSOR;\n+\tif (yych <= 'A') {\n+\t\tif (yych <= 0x1F) {\n+\t\t\tif (yych == '\\t') goto yy267;\n+\t\t\tgoto yy56;\n+\t\t} else {\n+\t\t\tif (yych <= ' ') goto yy267;\n+\t\t\tif (yych <= '@') goto yy56;\n+\t\t}\n \t} else {\n-\t\tif (yych <= '2') goto yy291;\n-\t\tif (yych <= '9') goto yy290;\n-\t\tif (yych <= ':') goto yy263;\n-\t\tgoto yy198;\n+\t\tif (yych <= '`') {\n+\t\t\tif (yych != 'P') goto yy56;\n+\t\t} else {\n+\t\t\tif (yych <= 'a') goto yy269;\n+\t\t\tif (yych != 'p') goto yy56;\n+\t\t}\n \t}\n-yy260:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy263;\n-\t\tgoto yy198;\n+yy269:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= 'L') {\n+\t\tif (yych != '.') goto yy56;\n \t} else {\n-\t\tif (yych <= '4') goto yy290;\n-\t\tif (yych <= '9') goto yy262;\n-\t\tif (yych <= ':') goto yy263;\n-\t\tgoto yy198;\n+\t\tif (yych <= 'M') goto yy271;\n+\t\tif (yych == 'm') goto yy271;\n+\t\tgoto yy56;\n \t}\n-yy261:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy263;\n-\t\tgoto yy198;\n+\tyych = *++YYCURSOR;\n+\tif (yych == 'M') goto yy271;\n+\tif (yych != 'm') goto yy56;\n+yy271:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= 0x1F) {\n+\t\tif (yych <= 0x00) goto yy245;\n+\t\tif (yych == '\\t') goto yy245;\n+\t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= '9') goto yy262;\n-\t\tif (yych <= ':') goto yy263;\n-\t\tgoto yy198;\n+\t\tif (yych <= ' ') goto yy245;\n+\t\tif (yych != '.') goto yy56;\n \t}\n-yy262:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy198;\n-\tif (yych <= '9') goto yy288;\n-\tgoto yy198;\n-yy263:\n+\tif (yych <= '\\t') {\n+\t\tif (yych <= 0x00) goto yy245;\n+\t\tif (yych <= 0x08) goto yy56;\n+\t\tgoto yy245;\n+\t} else {\n+\t\tif (yych == ' ') goto yy245;\n+\t\tgoto yy56;\n+\t}\n+yy273:\n+\tyych = *++YYCURSOR;\n+\tif (yych == '.') goto yy274;\n+\tif (yych != ':') goto yy56;\n+yy274:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy264;\n-\tif (yych <= '9') goto yy265;\n+\tif (yych <= '5') goto yy275;\n+\tif (yych <= '9') goto yy276;\n \tgoto yy56;\n-yy264:\n+yy275:\n \tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy266;\n-\t\tgoto yy222;\n+\t\tif (yych == '.') goto yy277;\n+\t\tgoto yy221;\n \t} else {\n-\t\tif (yych <= '9') goto yy281;\n-\t\tif (yych <= ':') goto yy266;\n-\t\tgoto yy222;\n+\t\tif (yych <= '9') goto yy276;\n+\t\tif (yych <= ':') goto yy277;\n+\t\tgoto yy221;\n \t}\n-yy265:\n+yy276:\n \tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy266;\n-\tif (yych != ':') goto yy222;\n-yy266:\n+\tif (yych == '.') goto yy277;\n+\tif (yych != ':') goto yy221;\n+yy277:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy267;\n-\tif (yych <= '6') goto yy268;\n-\tif (yych <= '9') goto yy227;\n+\tif (yych <= '5') goto yy278;\n+\tif (yych <= '6') goto yy279;\n+\tif (yych <= '9') goto yy226;\n \tgoto yy56;\n-yy267:\n+yy278:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy222;\n-\tif (yych <= '9') goto yy269;\n-\tgoto yy222;\n-yy268:\n+\tif (yych <= '\/') goto yy221;\n+\tif (yych <= '9') goto yy280;\n+\tgoto yy221;\n+yy279:\n \tyych = *++YYCURSOR;\n-\tif (yych != '0') goto yy222;\n-yy269:\n+\tif (yych != '0') goto yy221;\n+yy280:\n \tyyaccept = 7;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '*') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy271;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych == '\\t') goto yy282;\n+\t\t\tgoto yy221;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy271;\n-\t\t\tif (yych == '(') goto yy271;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= ' ') goto yy282;\n+\t\t\tif (yych == '(') goto yy282;\n+\t\t\tgoto yy221;\n \t\t}\n \t} else {\n \t\tif (yych <= '@') {\n-\t\t\tif (yych == ',') goto yy222;\n-\t\t\tif (yych <= '-') goto yy271;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych == ',') goto yy221;\n+\t\t\tif (yych <= '-') goto yy282;\n+\t\t\tgoto yy221;\n \t\t} else {\n-\t\t\tif (yych <= 'Z') goto yy271;\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych <= 'z') goto yy271;\n-\t\t\tgoto yy222;\n+\t\t\tif (yych <= 'Z') goto yy282;\n+\t\t\tif (yych <= '`') goto yy221;\n+\t\t\tif (yych <= 'z') goto yy282;\n+\t\t\tgoto yy221;\n \t\t}\n \t}\n-yy270:\n+yy281:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 9) YYFILL(9);\n \tyych = *YYCURSOR;\n-yy271:\n-\tif (yych <= '@') {\n-\t\tif (yych <= '\\'') {\n-\t\t\tif (yych <= '\\t') {\n-\t\t\t\tif (yych <= 0x08) goto yy56;\n-\t\t\t\tgoto yy270;\n-\t\t\t} else {\n-\t\t\t\tif (yych == ' ') goto yy270;\n-\t\t\t\tgoto yy56;\n-\t\t\t}\n+yy282:\n+\tif (yych <= '+') {\n+\t\tif (yych <= ' ') {\n+\t\t\tif (yych == '\\t') goto yy281;\n+\t\t\tif (yych <= 0x1F) goto yy56;\n+\t\t\tgoto yy281;\n \t\t} else {\n-\t\t\tif (yych <= '+') {\n-\t\t\t\tif (yych <= '(') goto yy233;\n-\t\t\t\tif (yych <= '*') goto yy56;\n-\t\t\t\tgoto yy232;\n-\t\t\t} else {\n-\t\t\t\tif (yych == '-') goto yy232;\n-\t\t\t\tgoto yy56;\n-\t\t\t}\n+\t\t\tif (yych == '(') goto yy232;\n+\t\t\tif (yych <= '*') goto yy56;\n+\t\t\tgoto yy231;\n \t\t}\n \t} else {\n-\t\tif (yych <= 'Z') {\n-\t\t\tif (yych <= 'G') {\n-\t\t\t\tif (yych <= 'A') goto yy272;\n-\t\t\t\tif (yych <= 'F') goto yy234;\n-\t\t\t\tgoto yy231;\n-\t\t\t} else {\n-\t\t\t\tif (yych != 'P') goto yy234;\n-\t\t\t}\n+\t\tif (yych <= 'F') {\n+\t\t\tif (yych == '-') goto yy231;\n+\t\t\tif (yych <= '@') goto yy56;\n+\t\t\tgoto yy234;\n \t\t} else {\n-\t\t\tif (yych <= 'o') {\n-\t\t\t\tif (yych <= '`') goto yy56;\n-\t\t\t\tif (yych <= 'a') goto yy273;\n-\t\t\t\tgoto yy235;\n+\t\t\tif (yych <= 'Z') {\n+\t\t\t\tif (yych <= 'G') goto yy230;\n+\t\t\t\tgoto yy234;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'p') goto yy273;\n-\t\t\t\tif (yych <= 'z') goto yy235;\n+\t\t\t\tif (yych <= '`') goto yy56;\n+\t\t\t\tif (yych <= 'z') goto yy236;\n \t\t\t\tgoto yy56;\n \t\t\t}\n \t\t}\n \t}\n-yy272:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= 'L') {\n-\t\tif (yych <= '-') {\n-\t\t\tif (yych == ')') goto yy227;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych <= '.') goto yy274;\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tgoto yy236;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'M') goto yy275;\n-\t\t\tif (yych <= 'Z') goto yy236;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych == 'm') goto yy280;\n-\t\t\tif (yych <= 'z') goto yy241;\n-\t\t\tgoto yy222;\n-\t\t}\n-\t}\n-yy273:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= 'L') {\n-\t\tif (yych <= '-') {\n-\t\t\tif (yych == ')') goto yy227;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych <= '.') goto yy274;\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tgoto yy236;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'M') goto yy275;\n-\t\t\tif (yych <= 'Z') goto yy236;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych == 'm') goto yy275;\n-\t\t\tif (yych <= 'z') goto yy236;\n-\t\t\tgoto yy222;\n-\t\t}\n-\t}\n-yy274:\n-\tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy279;\n-\tif (yych == 'm') goto yy279;\n-\tgoto yy56;\n-yy275:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= ')') {\n-\t\tif (yych <= '\\t') {\n-\t\t\tif (yych <= 0x00) goto yy277;\n-\t\t\tif (yych <= 0x08) goto yy222;\n-\t\t\tgoto yy277;\n-\t\t} else {\n-\t\t\tif (yych == ' ') goto yy277;\n-\t\t\tif (yych <= '(') goto yy222;\n-\t\t\tgoto yy227;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= '@') {\n-\t\t\tif (yych != '.') goto yy222;\n-\t\t} else {\n-\t\t\tif (yych <= 'Z') goto yy237;\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych <= 'z') goto yy237;\n-\t\t\tgoto yy222;\n-\t\t}\n-\t}\n-yy276:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\\t') {\n-\t\tif (yych <= 0x00) goto yy277;\n-\t\tif (yych <= 0x08) goto yy56;\n-\t} else {\n-\t\tif (yych != ' ') goto yy56;\n-\t}\n-yy277:\n-\t++YYCURSOR;\n-#line 1644 \"ext\/date\/lib\/parse_date.re\"\n-\t{\n-\t\tDEBUG_OUTPUT(\"dateshortwithtimeshort12 | dateshortwithtimelong12\");\n-\t\tTIMELIB_INIT;\n-\t\tTIMELIB_HAVE_DATE();\n-\t\ts->time->m = timelib_get_month((char **) &ptr);\n-\t\ts->time->d = timelib_get_nr((char **) &ptr, 2);\n-\n-\t\tTIMELIB_HAVE_TIME();\n-\t\ts->time->h = timelib_get_nr((char **) &ptr, 2);\n-\t\ts->time->i = timelib_get_nr((char **) &ptr, 2);\n-\t\tif (*ptr == ':' || *ptr == '.') {\n-\t\t\ts->time->s = timelib_get_nr((char **) &ptr, 2);\n-\n-\t\t\tif (*ptr == '.') {\n-\t\t\t\ts->time->f = timelib_get_frac_nr((char **) &ptr, 8);\n-\t\t\t}\n-\t\t}\n-\n-\t\ts->time->h += timelib_meridian((char **) &ptr, s->time->h);\n-\t\tTIMELIB_DEINIT;\n-\t\treturn TIMELIB_SHORTDATE_WITH_TIME;\n-\t}\n-#line 4881 \"<stdout>\"\n-yy279:\n+yy283:\n \tyych = *++YYCURSOR;\n-\tif (yych <= 0x1F) {\n-\t\tif (yych <= 0x00) goto yy277;\n-\t\tif (yych == '\\t') goto yy277;\n+\tif (yych <= '\/') {\n+\t\tif (yych == '.') goto yy274;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= ' ') goto yy277;\n-\t\tif (yych == '.') goto yy276;\n+\t\tif (yych <= '9') goto yy273;\n+\t\tif (yych <= ':') goto yy274;\n \t\tgoto yy56;\n \t}\n-yy280:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '-') {\n-\t\tif (yych <= 0x1F) {\n-\t\t\tif (yych <= 0x00) goto yy277;\n-\t\t\tif (yych == '\\t') goto yy277;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych <= '(') {\n-\t\t\t\tif (yych <= ' ') goto yy277;\n-\t\t\t\tgoto yy222;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= ')') goto yy227;\n-\t\t\t\tif (yych <= ',') goto yy222;\n-\t\t\t\tgoto yy243;\n-\t\t\t}\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'Z') {\n-\t\t\tif (yych <= '.') goto yy276;\n-\t\t\tif (yych <= '\/') goto yy243;\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tgoto yy237;\n-\t\t} else {\n-\t\t\tif (yych <= '_') {\n-\t\t\t\tif (yych <= '^') goto yy222;\n-\t\t\t\tgoto yy243;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= '`') goto yy222;\n-\t\t\t\tif (yych <= 'z') goto yy242;\n-\t\t\t\tgoto yy222;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy281:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= ':') {\n-\t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy282;\n-\t\t\tif (yych <= 0x1F) goto yy222;\n-\t\t} else {\n-\t\t\tif (yych == '.') goto yy266;\n-\t\t\tif (yych <= '9') goto yy222;\n-\t\t\tgoto yy266;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'P') {\n-\t\t\tif (yych == 'A') goto yy284;\n-\t\t\tif (yych <= 'O') goto yy222;\n-\t\t\tgoto yy284;\n-\t\t} else {\n-\t\t\tif (yych <= 'a') {\n-\t\t\t\tif (yych <= '`') goto yy222;\n-\t\t\t\tgoto yy284;\n-\t\t\t} else {\n-\t\t\t\tif (yych == 'p') goto yy284;\n-\t\t\t\tgoto yy222;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy282:\n-\t++YYCURSOR;\n-\tif ((YYLIMIT - YYCURSOR) < 5) YYFILL(5);\n-\tyych = *YYCURSOR;\n-\tif (yych <= 'A') {\n-\t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy282;\n-\t\t\tgoto yy56;\n-\t\t} else {\n-\t\t\tif (yych <= ' ') goto yy282;\n-\t\t\tif (yych <= '@') goto yy56;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= '`') {\n-\t\t\tif (yych != 'P') goto yy56;\n-\t\t} else {\n-\t\t\tif (yych <= 'a') goto yy284;\n-\t\t\tif (yych != 'p') goto yy56;\n-\t\t}\n-\t}\n yy284:\n \tyych = *++YYCURSOR;\n-\tif (yych <= 'L') {\n-\t\tif (yych != '.') goto yy56;\n-\t} else {\n-\t\tif (yych <= 'M') goto yy286;\n-\t\tif (yych == 'm') goto yy286;\n-\t\tgoto yy56;\n-\t}\n-yy285:\n-\tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy286;\n-\tif (yych != 'm') goto yy56;\n-yy286:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= 0x1F) {\n-\t\tif (yych <= 0x00) goto yy277;\n-\t\tif (yych == '\\t') goto yy277;\n+\tif (yych <= '\/') {\n+\t\tif (yych == '.') goto yy274;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= ' ') goto yy277;\n-\t\tif (yych != '.') goto yy56;\n-\t}\n-yy287:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\\t') {\n-\t\tif (yych <= 0x00) goto yy277;\n-\t\tif (yych <= 0x08) goto yy56;\n-\t\tgoto yy277;\n-\t} else {\n-\t\tif (yych == ' ') goto yy277;\n+\t\tif (yych <= '4') goto yy273;\n+\t\tif (yych == ':') goto yy274;\n \t\tgoto yy56;\n \t}\n-yy288:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy198;\n-\tif (yych >= ':') goto yy198;\n-\tyych = *++YYCURSOR;\n-\tgoto yy198;\n-yy290:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy220;\n-\t\tgoto yy198;\n-\t} else {\n-\t\tif (yych <= '9') goto yy288;\n-\t\tif (yych <= ':') goto yy220;\n-\t\tgoto yy198;\n-\t}\n-yy291:\n+yy285:\n \tyyaccept = 6;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy263;\n-\t\tgoto yy198;\n-\t} else {\n-\t\tif (yych <= '9') goto yy288;\n-\t\tif (yych <= ':') goto yy263;\n-\t\tgoto yy198;\n-\t}\n-yy292:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy56;\n-\tif (yych >= ':') goto yy56;\n-yy293:\n-\t++YYCURSOR;\n-yy294:\n-#line 1338 \"ext\/date\/lib\/parse_date.re\"\n-\t{\n-\t\tint length = 0;\n-\t\tDEBUG_OUTPUT(\"datenoday\");\n-\t\tTIMELIB_INIT;\n-\t\tTIMELIB_HAVE_DATE();\n-\t\ts->time->m = timelib_get_month((char **) &ptr);\n-\t\ts->time->y = timelib_get_nr_ex((char **) &ptr, 4, &length);\n-\t\ts->time->d = 1;\n-\t\tTIMELIB_PROCESS_YEAR(s->time->y, length);\n-\t\tTIMELIB_DEINIT;\n-\t\treturn TIMELIB_DATE_NO_DAY;\n-\t}\n-#line 5056 \"<stdout>\"\n-yy295:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy220;\n-\t\tgoto yy56;\n-\t} else {\n-\t\tif (yych <= '9') goto yy293;\n-\t\tif (yych <= ':') goto yy220;\n-\t\tgoto yy56;\n-\t}\n-yy296:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy263;\n-\t\tgoto yy56;\n+\t\tif (yych == '.') goto yy274;\n+\t\tgoto yy207;\n \t} else {\n+\t\tif (yych <= '0') goto yy292;\n \t\tif (yych <= '9') goto yy293;\n-\t\tif (yych <= ':') goto yy263;\n-\t\tgoto yy56;\n-\t}\n-yy297:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '9') {\n-\t\tif (yych <= '\/') {\n-\t\t\tif (yych == '.') goto yy330;\n-\t\t\tgoto yy215;\n-\t\t} else {\n-\t\t\tif (yych <= '0') goto yy331;\n-\t\t\tif (yych <= '1') goto yy301;\n-\t\t\tif (yych <= '2') goto yy302;\n-\t\t\tgoto yy296;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'q') {\n-\t\t\tif (yych <= ':') goto yy220;\n-\t\t\tif (yych == 'n') goto yy211;\n-\t\t\tgoto yy215;\n-\t\t} else {\n-\t\t\tif (yych <= 'r') goto yy212;\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n-\t\t}\n-\t}\n-yy298:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '9') {\n-\t\tif (yych <= '\/') {\n-\t\t\tif (yych != '.') goto yy215;\n-\t\t} else {\n-\t\t\tif (yych <= '0') goto yy300;\n-\t\t\tif (yych <= '1') goto yy301;\n-\t\t\tif (yych <= '2') goto yy302;\n-\t\t\tgoto yy296;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'q') {\n-\t\t\tif (yych <= ':') goto yy263;\n-\t\t\tif (yych == 'n') goto yy211;\n-\t\t\tgoto yy215;\n-\t\t} else {\n-\t\t\tif (yych <= 'r') goto yy212;\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n-\t\t}\n+\t\tif (yych <= ':') goto yy274;\n+\t\tgoto yy207;\n \t}\n-yy299:\n+yy286:\n \tyyaccept = 6;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '1') {\n-\t\tif (yych <= '\/') goto yy215;\n-\t\tif (yych <= '0') goto yy305;\n-\t\tgoto yy306;\n-\t} else {\n-\t\tif (yych <= '2') goto yy307;\n-\t\tif (yych <= '5') goto yy308;\n-\t\tif (yych <= '9') goto yy309;\n-\t\tgoto yy215;\n-\t}\n-yy300:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy263;\n-\t\tgoto yy56;\n-\t} else {\n-\t\tif (yych <= '0') goto yy303;\n-\t\tif (yych <= '9') goto yy304;\n-\t\tif (yych <= ':') goto yy263;\n-\t\tgoto yy56;\n-\t}\n-yy301:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy263;\n-\t\tgoto yy56;\n-\t} else {\n-\t\tif (yych <= '2') goto yy304;\n-\t\tif (yych <= '9') goto yy303;\n-\t\tif (yych <= ':') goto yy263;\n-\t\tgoto yy56;\n-\t}\n-yy302:\n-\tyych = *++YYCURSOR;\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy263;\n-\t\tgoto yy56;\n+\t\tif (yych == '.') goto yy219;\n+\t\tgoto yy207;\n \t} else {\n-\t\tif (yych <= '4') goto yy303;\n-\t\tif (yych <= '9') goto yy293;\n-\t\tif (yych <= ':') goto yy263;\n-\t\tgoto yy56;\n+\t\tif (yych <= '2') goto yy293;\n+\t\tif (yych <= '9') goto yy292;\n+\t\tif (yych <= ':') goto yy219;\n+\t\tgoto yy207;\n \t}\n-yy303:\n-\tyyaccept = 8;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy220;\n-\tif (yych == ':') goto yy220;\n-\tgoto yy294;\n-yy304:\n-\tyyaccept = 8;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy263;\n-\tif (yych == ':') goto yy263;\n-\tgoto yy294;\n-yy305:\n+yy287:\n \tyyaccept = 6;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy325;\n-\t\tgoto yy198;\n+\t\tif (yych == '.') goto yy219;\n+\t\tgoto yy207;\n \t} else {\n-\t\tif (yych <= '0') goto yy324;\n-\t\tif (yych <= '9') goto yy329;\n-\t\tif (yych <= ':') goto yy325;\n-\t\tgoto yy198;\n+\t\tif (yych <= '4') goto yy292;\n+\t\tif (yych <= '9') goto yy289;\n+\t\tif (yych <= ':') goto yy219;\n+\t\tgoto yy207;\n \t}\n-yy306:\n+yy288:\n \tyyaccept = 6;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy310;\n-\t\tgoto yy198;\n+\t\tif (yych == '.') goto yy219;\n+\t\tgoto yy207;\n \t} else {\n-\t\tif (yych <= '2') goto yy329;\n-\t\tif (yych <= '9') goto yy324;\n-\t\tif (yych <= ':') goto yy310;\n-\t\tgoto yy198;\n+\t\tif (yych <= '9') goto yy289;\n+\t\tif (yych <= ':') goto yy219;\n+\t\tgoto yy207;\n \t}\n-yy307:\n+yy289:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '\/') goto yy207;\n+\tif (yych >= ':') goto yy207;\n+yy290:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '\/') goto yy207;\n+\tif (yych >= ':') goto yy207;\n+\tyych = *++YYCURSOR;\n+\tgoto yy207;\n+yy292:\n \tyyaccept = 6;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy310;\n-\t\tgoto yy198;\n-\t} else {\n-\t\tif (yych <= '4') goto yy324;\n-\t\tif (yych <= '9') goto yy323;\n-\t\tif (yych <= ':') goto yy310;\n-\t\tgoto yy198;\n-\t}\n-yy308:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy310;\n-\t\tgoto yy198;\n-\t} else {\n-\t\tif (yych <= '9') goto yy323;\n-\t\tif (yych <= ':') goto yy310;\n-\t\tgoto yy198;\n-\t}\n-yy309:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych != '.') goto yy198;\n-\t} else {\n-\t\tif (yych <= '9') goto yy262;\n-\t\tif (yych >= ';') goto yy198;\n-\t}\n-yy310:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy311;\n-\tif (yych <= '6') goto yy312;\n-\tif (yych <= '9') goto yy265;\n-\tgoto yy56;\n-yy311:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy266;\n-\t\tgoto yy222;\n-\t} else {\n-\t\tif (yych <= '9') goto yy313;\n-\t\tif (yych <= ':') goto yy266;\n-\t\tgoto yy222;\n-\t}\n-yy312:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy266;\n-\t\tgoto yy222;\n-\t} else {\n-\t\tif (yych <= '0') goto yy269;\n-\t\tif (yych == ':') goto yy266;\n-\t\tgoto yy222;\n-\t}\n-yy313:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= ',') {\n-\t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy315;\n-\t\t\tif (yych <= 0x1F) goto yy222;\n-\t\t\tgoto yy315;\n-\t\t} else {\n-\t\t\tif (yych <= '(') {\n-\t\t\t\tif (yych <= '\\'') goto yy222;\n-\t\t\t\tgoto yy315;\n-\t\t\t} else {\n-\t\t\t\tif (yych == '+') goto yy315;\n-\t\t\t\tgoto yy222;\n-\t\t\t}\n-\t\t}\n-\t} else {\n-\t\tif (yych <= ':') {\n-\t\t\tif (yych <= '-') goto yy315;\n-\t\t\tif (yych <= '.') goto yy266;\n-\t\t\tif (yych <= '9') goto yy222;\n-\t\t\tgoto yy266;\n-\t\t} else {\n-\t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= '@') goto yy222;\n-\t\t\t\tgoto yy315;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= '`') goto yy222;\n-\t\t\t\tif (yych <= 'z') goto yy315;\n-\t\t\t\tgoto yy222;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy314:\n-\t++YYCURSOR;\n-\tif ((YYLIMIT - YYCURSOR) < 9) YYFILL(9);\n-\tyych = *YYCURSOR;\n-yy315:\n-\tif (yych <= '@') {\n-\t\tif (yych <= '\\'') {\n-\t\t\tif (yych <= '\\t') {\n-\t\t\t\tif (yych <= 0x08) goto yy56;\n-\t\t\t\tgoto yy314;\n-\t\t\t} else {\n-\t\t\t\tif (yych == ' ') goto yy314;\n-\t\t\t\tgoto yy56;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif (yych <= '+') {\n-\t\t\t\tif (yych <= '(') goto yy233;\n-\t\t\t\tif (yych <= '*') goto yy56;\n-\t\t\t\tgoto yy232;\n-\t\t\t} else {\n-\t\t\t\tif (yych == '-') goto yy232;\n-\t\t\t\tgoto yy56;\n-\t\t\t}\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'Z') {\n-\t\t\tif (yych <= 'G') {\n-\t\t\t\tif (yych <= 'A') goto yy316;\n-\t\t\t\tif (yych <= 'F') goto yy234;\n-\t\t\t\tgoto yy231;\n-\t\t\t} else {\n-\t\t\t\tif (yych != 'P') goto yy234;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif (yych <= 'o') {\n-\t\t\t\tif (yych <= '`') goto yy56;\n-\t\t\t\tif (yych <= 'a') goto yy317;\n-\t\t\t\tgoto yy235;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= 'p') goto yy317;\n-\t\t\t\tif (yych <= 'z') goto yy235;\n-\t\t\t\tgoto yy56;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy316:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= 'L') {\n-\t\tif (yych <= '-') {\n-\t\t\tif (yych == ')') goto yy227;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych <= '.') goto yy319;\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tgoto yy236;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'M') goto yy318;\n-\t\t\tif (yych <= 'Z') goto yy236;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych == 'm') goto yy322;\n-\t\t\tif (yych <= 'z') goto yy241;\n-\t\t\tgoto yy222;\n-\t\t}\n-\t}\n-yy317:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= 'L') {\n-\t\tif (yych <= '-') {\n-\t\t\tif (yych == ')') goto yy227;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych <= '.') goto yy319;\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tgoto yy236;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'M') goto yy318;\n-\t\t\tif (yych <= 'Z') goto yy236;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych == 'm') goto yy318;\n-\t\t\tif (yych <= 'z') goto yy236;\n-\t\t\tgoto yy222;\n-\t\t}\n-\t}\n-yy318:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= ')') {\n-\t\tif (yych <= '\\t') {\n-\t\t\tif (yych <= 0x00) goto yy277;\n-\t\t\tif (yych <= 0x08) goto yy222;\n-\t\t\tgoto yy277;\n-\t\t} else {\n-\t\t\tif (yych == ' ') goto yy277;\n-\t\t\tif (yych <= '(') goto yy222;\n-\t\t\tgoto yy227;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= '@') {\n-\t\t\tif (yych == '.') goto yy321;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych <= 'Z') goto yy237;\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych <= 'z') goto yy237;\n-\t\t\tgoto yy222;\n-\t\t}\n-\t}\n-yy319:\n-\tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy320;\n-\tif (yych != 'm') goto yy56;\n-yy320:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= 0x1F) {\n-\t\tif (yych <= 0x00) goto yy277;\n-\t\tif (yych == '\\t') goto yy277;\n-\t\tgoto yy56;\n-\t} else {\n-\t\tif (yych <= ' ') goto yy277;\n-\t\tif (yych != '.') goto yy56;\n-\t}\n-yy321:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\\t') {\n-\t\tif (yych <= 0x00) goto yy277;\n-\t\tif (yych <= 0x08) goto yy56;\n-\t\tgoto yy277;\n-\t} else {\n-\t\tif (yych == ' ') goto yy277;\n-\t\tgoto yy56;\n-\t}\n-yy322:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '-') {\n-\t\tif (yych <= 0x1F) {\n-\t\t\tif (yych <= 0x00) goto yy277;\n-\t\t\tif (yych == '\\t') goto yy277;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych <= '(') {\n-\t\t\t\tif (yych <= ' ') goto yy277;\n-\t\t\t\tgoto yy222;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= ')') goto yy227;\n-\t\t\t\tif (yych <= ',') goto yy222;\n-\t\t\t\tgoto yy243;\n-\t\t\t}\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'Z') {\n-\t\t\tif (yych <= '.') goto yy321;\n-\t\t\tif (yych <= '\/') goto yy243;\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tgoto yy237;\n-\t\t} else {\n-\t\t\tif (yych <= '_') {\n-\t\t\t\tif (yych <= '^') goto yy222;\n-\t\t\t\tgoto yy243;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= '`') goto yy222;\n-\t\t\t\tif (yych <= 'z') goto yy242;\n-\t\t\t\tgoto yy222;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy323:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= ':') {\n-\t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy282;\n-\t\t\tif (yych <= 0x1F) goto yy198;\n-\t\t\tgoto yy282;\n-\t\t} else {\n-\t\t\tif (yych <= '.') {\n-\t\t\t\tif (yych <= '-') goto yy198;\n-\t\t\t\tgoto yy266;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= '\/') goto yy198;\n-\t\t\t\tif (yych <= '9') goto yy288;\n-\t\t\t\tgoto yy266;\n-\t\t\t}\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'P') {\n-\t\t\tif (yych == 'A') goto yy284;\n-\t\t\tif (yych <= 'O') goto yy198;\n-\t\t\tgoto yy284;\n-\t\t} else {\n-\t\t\tif (yych <= 'a') {\n-\t\t\t\tif (yych <= '`') goto yy198;\n-\t\t\t\tgoto yy284;\n-\t\t\t} else {\n-\t\t\t\tif (yych == 'p') goto yy284;\n-\t\t\t\tgoto yy198;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy324:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= ':') {\n-\t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy282;\n-\t\t\tif (yych <= 0x1F) goto yy198;\n-\t\t\tgoto yy282;\n-\t\t} else {\n-\t\t\tif (yych <= '.') {\n-\t\t\t\tif (yych <= '-') goto yy198;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= '\/') goto yy198;\n-\t\t\t\tif (yych <= '9') goto yy288;\n-\t\t\t}\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'P') {\n-\t\t\tif (yych == 'A') goto yy284;\n-\t\t\tif (yych <= 'O') goto yy198;\n-\t\t\tgoto yy284;\n-\t\t} else {\n-\t\t\tif (yych <= 'a') {\n-\t\t\t\tif (yych <= '`') goto yy198;\n-\t\t\t\tgoto yy284;\n-\t\t\t} else {\n-\t\t\t\tif (yych == 'p') goto yy284;\n-\t\t\t\tgoto yy198;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy325:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy326;\n-\tif (yych <= '6') goto yy327;\n-\tif (yych <= '9') goto yy223;\n-\tgoto yy56;\n-yy326:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy224;\n-\t\tgoto yy222;\n-\t} else {\n-\t\tif (yych <= '9') goto yy328;\n-\t\tif (yych <= ':') goto yy224;\n-\t\tgoto yy222;\n-\t}\n-yy327:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy224;\n-\t\tgoto yy222;\n-\t} else {\n-\t\tif (yych <= '0') goto yy269;\n-\t\tif (yych == ':') goto yy224;\n-\t\tgoto yy222;\n-\t}\n-yy328:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= ',') {\n-\t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy271;\n-\t\t\tif (yych <= 0x1F) goto yy222;\n-\t\t\tgoto yy271;\n-\t\t} else {\n-\t\t\tif (yych <= '(') {\n-\t\t\t\tif (yych <= '\\'') goto yy222;\n-\t\t\t\tgoto yy271;\n-\t\t\t} else {\n-\t\t\t\tif (yych == '+') goto yy271;\n-\t\t\t\tgoto yy222;\n-\t\t\t}\n-\t\t}\n-\t} else {\n-\t\tif (yych <= ':') {\n-\t\t\tif (yych <= '-') goto yy271;\n-\t\t\tif (yych <= '.') goto yy224;\n-\t\t\tif (yych <= '9') goto yy222;\n-\t\t\tgoto yy224;\n-\t\t} else {\n-\t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= '@') goto yy222;\n-\t\t\t\tgoto yy271;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= '`') goto yy222;\n-\t\t\t\tif (yych <= 'z') goto yy271;\n-\t\t\t\tgoto yy222;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy329:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= ':') {\n-\t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy282;\n-\t\t\tif (yych <= 0x1F) goto yy198;\n-\t\t\tgoto yy282;\n-\t\t} else {\n-\t\t\tif (yych <= '.') {\n-\t\t\t\tif (yych <= '-') goto yy198;\n-\t\t\t\tgoto yy310;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= '\/') goto yy198;\n-\t\t\t\tif (yych <= '9') goto yy288;\n-\t\t\t\tgoto yy310;\n-\t\t\t}\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'P') {\n-\t\t\tif (yych == 'A') goto yy284;\n-\t\t\tif (yych <= 'O') goto yy198;\n-\t\t\tgoto yy284;\n-\t\t} else {\n-\t\t\tif (yych <= 'a') {\n-\t\t\t\tif (yych <= '`') goto yy198;\n-\t\t\t\tgoto yy284;\n-\t\t\t} else {\n-\t\t\t\tif (yych == 'p') goto yy284;\n-\t\t\t\tgoto yy198;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy330:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '1') {\n-\t\tif (yych <= '\/') goto yy215;\n-\t\tif (yych <= '0') goto yy332;\n-\t\tgoto yy333;\n-\t} else {\n-\t\tif (yych <= '2') goto yy334;\n-\t\tif (yych <= '5') goto yy335;\n-\t\tif (yych <= '9') goto yy336;\n-\t\tgoto yy215;\n-\t}\n-yy331:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy220;\n-\t\tgoto yy56;\n-\t} else {\n-\t\tif (yych <= '0') goto yy303;\n-\t\tif (yych <= '9') goto yy304;\n-\t\tif (yych <= ':') goto yy220;\n-\t\tgoto yy56;\n-\t}\n-yy332:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy349;\n-\t\tgoto yy198;\n-\t} else {\n-\t\tif (yych <= '0') goto yy348;\n-\t\tif (yych <= '9') goto yy353;\n-\t\tif (yych <= ':') goto yy349;\n-\t\tgoto yy198;\n-\t}\n-yy333:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy337;\n-\t\tgoto yy198;\n-\t} else {\n-\t\tif (yych <= '2') goto yy353;\n-\t\tif (yych <= '9') goto yy348;\n-\t\tif (yych <= ':') goto yy337;\n-\t\tgoto yy198;\n-\t}\n-yy334:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy337;\n-\t\tgoto yy198;\n-\t} else {\n-\t\tif (yych <= '4') goto yy348;\n-\t\tif (yych <= '9') goto yy347;\n-\t\tif (yych <= ':') goto yy337;\n-\t\tgoto yy198;\n-\t}\n-yy335:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy337;\n-\t\tgoto yy198;\n-\t} else {\n-\t\tif (yych <= '9') goto yy347;\n-\t\tif (yych <= ':') goto yy337;\n-\t\tgoto yy198;\n-\t}\n-yy336:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych != '.') goto yy198;\n-\t} else {\n-\t\tif (yych <= '9') goto yy262;\n-\t\tif (yych >= ';') goto yy198;\n-\t}\n-yy337:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy338;\n-\tif (yych <= '6') goto yy339;\n-\tif (yych <= '9') goto yy265;\n-\tgoto yy56;\n-yy338:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy266;\n-\t\tgoto yy222;\n-\t} else {\n-\t\tif (yych <= '9') goto yy340;\n-\t\tif (yych <= ':') goto yy266;\n-\t\tgoto yy222;\n-\t}\n-yy339:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy266;\n-\t\tgoto yy222;\n-\t} else {\n-\t\tif (yych <= '0') goto yy228;\n-\t\tif (yych == ':') goto yy266;\n-\t\tgoto yy222;\n-\t}\n-yy340:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= ',') {\n-\t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy342;\n-\t\t\tif (yych <= 0x1F) goto yy222;\n-\t\t\tgoto yy342;\n-\t\t} else {\n-\t\t\tif (yych <= '(') {\n-\t\t\t\tif (yych <= '\\'') goto yy222;\n-\t\t\t\tgoto yy342;\n-\t\t\t} else {\n-\t\t\t\tif (yych == '+') goto yy342;\n-\t\t\t\tgoto yy222;\n-\t\t\t}\n-\t\t}\n-\t} else {\n-\t\tif (yych <= ':') {\n-\t\t\tif (yych <= '-') goto yy342;\n-\t\t\tif (yych <= '.') goto yy266;\n-\t\t\tif (yych <= '9') goto yy222;\n-\t\t\tgoto yy266;\n-\t\t} else {\n-\t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= '@') goto yy222;\n-\t\t\t\tgoto yy342;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= '`') goto yy222;\n-\t\t\t\tif (yych <= 'z') goto yy342;\n-\t\t\t\tgoto yy222;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy341:\n-\t++YYCURSOR;\n-\tif ((YYLIMIT - YYCURSOR) < 9) YYFILL(9);\n-\tyych = *YYCURSOR;\n-yy342:\n-\tif (yych <= '@') {\n-\t\tif (yych <= '\\'') {\n-\t\t\tif (yych <= '\\t') {\n-\t\t\t\tif (yych <= 0x08) goto yy56;\n-\t\t\t\tgoto yy341;\n-\t\t\t} else {\n-\t\t\t\tif (yych == ' ') goto yy341;\n-\t\t\t\tgoto yy56;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif (yych <= '+') {\n-\t\t\t\tif (yych <= '(') goto yy233;\n-\t\t\t\tif (yych <= '*') goto yy56;\n-\t\t\t\tgoto yy232;\n-\t\t\t} else {\n-\t\t\t\tif (yych == '-') goto yy232;\n-\t\t\t\tgoto yy56;\n-\t\t\t}\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'Z') {\n-\t\t\tif (yych <= 'G') {\n-\t\t\t\tif (yych <= 'A') goto yy343;\n-\t\t\t\tif (yych <= 'F') goto yy234;\n-\t\t\t\tgoto yy231;\n-\t\t\t} else {\n-\t\t\t\tif (yych != 'P') goto yy234;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif (yych <= 'o') {\n-\t\t\t\tif (yych <= '`') goto yy56;\n-\t\t\t\tif (yych <= 'a') goto yy344;\n-\t\t\t\tgoto yy235;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= 'p') goto yy344;\n-\t\t\t\tif (yych <= 'z') goto yy235;\n-\t\t\t\tgoto yy56;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy343:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= 'L') {\n-\t\tif (yych <= '-') {\n-\t\t\tif (yych == ')') goto yy227;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych <= '.') goto yy285;\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tgoto yy236;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'M') goto yy345;\n-\t\t\tif (yych <= 'Z') goto yy236;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych == 'm') goto yy346;\n-\t\t\tif (yych <= 'z') goto yy241;\n-\t\t\tgoto yy222;\n-\t\t}\n-\t}\n-yy344:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= 'L') {\n-\t\tif (yych <= '-') {\n-\t\t\tif (yych == ')') goto yy227;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych <= '.') goto yy285;\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tgoto yy236;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'M') goto yy345;\n-\t\t\tif (yych <= 'Z') goto yy236;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych == 'm') goto yy345;\n-\t\t\tif (yych <= 'z') goto yy236;\n-\t\t\tgoto yy222;\n-\t\t}\n-\t}\n-yy345:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= ')') {\n-\t\tif (yych <= '\\t') {\n-\t\t\tif (yych <= 0x00) goto yy277;\n-\t\t\tif (yych <= 0x08) goto yy222;\n-\t\t\tgoto yy277;\n-\t\t} else {\n-\t\t\tif (yych == ' ') goto yy277;\n-\t\t\tif (yych <= '(') goto yy222;\n-\t\t\tgoto yy227;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= '@') {\n-\t\t\tif (yych == '.') goto yy287;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych <= 'Z') goto yy237;\n-\t\t\tif (yych <= '`') goto yy222;\n-\t\t\tif (yych <= 'z') goto yy237;\n-\t\t\tgoto yy222;\n-\t\t}\n-\t}\n-yy346:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '-') {\n-\t\tif (yych <= 0x1F) {\n-\t\t\tif (yych <= 0x00) goto yy277;\n-\t\t\tif (yych == '\\t') goto yy277;\n-\t\t\tgoto yy222;\n-\t\t} else {\n-\t\t\tif (yych <= '(') {\n-\t\t\t\tif (yych <= ' ') goto yy277;\n-\t\t\t\tgoto yy222;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= ')') goto yy227;\n-\t\t\t\tif (yych <= ',') goto yy222;\n-\t\t\t\tgoto yy243;\n-\t\t\t}\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'Z') {\n-\t\t\tif (yych <= '.') goto yy287;\n-\t\t\tif (yych <= '\/') goto yy243;\n-\t\t\tif (yych <= '@') goto yy222;\n-\t\t\tgoto yy237;\n-\t\t} else {\n-\t\t\tif (yych <= '_') {\n-\t\t\t\tif (yych <= '^') goto yy222;\n-\t\t\t\tgoto yy243;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= '`') goto yy222;\n-\t\t\t\tif (yych <= 'z') goto yy242;\n-\t\t\t\tgoto yy222;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy347:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy224;\n-\t\tgoto yy198;\n-\t} else {\n-\t\tif (yych <= '9') goto yy288;\n-\t\tif (yych <= ':') goto yy224;\n-\t\tgoto yy198;\n-\t}\n-yy348:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych != '.') goto yy198;\n-\t} else {\n-\t\tif (yych <= '9') goto yy288;\n-\t\tif (yych >= ';') goto yy198;\n-\t}\n-yy349:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy350;\n-\tif (yych <= '6') goto yy351;\n-\tif (yych <= '9') goto yy223;\n-\tgoto yy56;\n-yy350:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy224;\n-\t\tgoto yy222;\n-\t} else {\n-\t\tif (yych <= '9') goto yy352;\n-\t\tif (yych <= ':') goto yy224;\n-\t\tgoto yy222;\n-\t}\n-yy351:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy224;\n-\t\tgoto yy222;\n-\t} else {\n-\t\tif (yych <= '0') goto yy228;\n-\t\tif (yych == ':') goto yy224;\n-\t\tgoto yy222;\n-\t}\n-yy352:\n-\tyyaccept = 7;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= ',') {\n-\t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy230;\n-\t\t\tif (yych <= 0x1F) goto yy222;\n-\t\t\tgoto yy230;\n-\t\t} else {\n-\t\t\tif (yych <= '(') {\n-\t\t\t\tif (yych <= '\\'') goto yy222;\n-\t\t\t\tgoto yy230;\n-\t\t\t} else {\n-\t\t\t\tif (yych == '+') goto yy230;\n-\t\t\t\tgoto yy222;\n-\t\t\t}\n-\t\t}\n-\t} else {\n-\t\tif (yych <= ':') {\n-\t\t\tif (yych <= '-') goto yy230;\n-\t\t\tif (yych <= '.') goto yy224;\n-\t\t\tif (yych <= '9') goto yy222;\n-\t\t\tgoto yy224;\n-\t\t} else {\n-\t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= '@') goto yy222;\n-\t\t\t\tgoto yy230;\n-\t\t\t} else {\n-\t\t\t\tif (yych <= '`') goto yy222;\n-\t\t\t\tif (yych <= 'z') goto yy230;\n-\t\t\t\tgoto yy222;\n-\t\t\t}\n-\t\t}\n-\t}\n-yy353:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy337;\n-\t\tgoto yy198;\n-\t} else {\n-\t\tif (yych <= '9') goto yy288;\n-\t\tif (yych <= ':') goto yy337;\n-\t\tgoto yy198;\n-\t}\n-yy354:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '9') {\n-\t\tif (yych <= '\/') {\n-\t\t\tif (yych == '.') goto yy299;\n-\t\t\tgoto yy215;\n-\t\t} else {\n-\t\t\tif (yych <= '0') goto yy331;\n-\t\t\tif (yych <= '1') goto yy301;\n-\t\t\tif (yych <= '2') goto yy302;\n-\t\t\tgoto yy296;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'q') {\n-\t\t\tif (yych <= ':') goto yy263;\n-\t\t\tif (yych == 'n') goto yy211;\n-\t\t\tgoto yy215;\n-\t\t} else {\n-\t\t\tif (yych <= 'r') goto yy212;\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n-\t\t}\n+\t\tif (yych == '.') goto yy274;\n+\t\tgoto yy207;\n+\t} else {\n+\t\tif (yych <= '9') goto yy290;\n+\t\tif (yych <= ':') goto yy274;\n+\t\tgoto yy207;\n \t}\n-yy355:\n+yy293:\n \tyyaccept = 6;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '9') {\n-\t\tif (yych <= '\/') {\n-\t\t\tif (yych == '.') goto yy299;\n-\t\t\tgoto yy215;\n-\t\t} else {\n-\t\t\tif (yych <= '0') goto yy331;\n-\t\t\tif (yych <= '1') goto yy301;\n-\t\t\tif (yych <= '2') goto yy302;\n-\t\t\tgoto yy296;\n-\t\t}\n+\tif (yych <= '\/') {\n+\t\tif (yych == '.') goto yy219;\n+\t\tgoto yy207;\n \t} else {\n-\t\tif (yych <= 'q') {\n-\t\t\tif (yych <= ':') goto yy263;\n-\t\t\tif (yych == 'n') goto yy211;\n-\t\t\tgoto yy215;\n-\t\t} else {\n-\t\t\tif (yych <= 'r') goto yy212;\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n-\t\t}\n+\t\tif (yych <= '9') goto yy290;\n+\t\tif (yych <= ':') goto yy219;\n+\t\tgoto yy207;\n \t}\n-yy356:\n+yy294:\n \tyyaccept = 6;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= 'm') {\n-\t\tif (yych <= '1') {\n-\t\t\tif (yych <= '\/') goto yy215;\n-\t\t\tif (yych <= '0') goto yy359;\n-\t\t\tgoto yy360;\n+\tif (yych <= 0x00) goto yy213;\n+\tgoto yy212;\n+yy295:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '\/') goto yy56;\n+\tif (yych >= ':') goto yy56;\n+\t++YYCURSOR;\n+#line 1338 \"ext\/date\/lib\/parse_date.re\"\n+\t{\n+\t\tint length = 0;\n+\t\tDEBUG_OUTPUT(\"datenoday\");\n+\t\tTIMELIB_INIT;\n+\t\tTIMELIB_HAVE_DATE();\n+\t\ts->time->m = timelib_get_month((char **) &ptr);\n+\t\ts->time->y = timelib_get_nr_ex((char **) &ptr, 4, &length);\n+\t\ts->time->d = 1;\n+\t\tTIMELIB_PROCESS_YEAR(s->time->y, length);\n+\t\tTIMELIB_DEINIT;\n+\t\treturn TIMELIB_DATE_NO_DAY;\n+\t}\n+#line 5134 \"<stdout>\"\n+yy298:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '9') {\n+\t\tif (yych <= ' ') {\n+\t\t\tif (yych <= 0x08) {\n+\t\t\t\tif (yych <= 0x00) goto yy213;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '\\t') goto yy211;\n+\t\t\t\tif (yych <= 0x1F) goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= '2') goto yy367;\n-\t\t\tif (yych <= '9') goto yy368;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= '-') {\n+\t\t\t\tif (yych == ',') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '.') goto yy211;\n+\t\t\t\tif (yych <= '\/') goto yy56;\n+\t\t\t\tgoto yy295;\n+\t\t\t}\n \t\t}\n \t} else {\n-\t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'n') goto yy211;\n-\t\t\tif (yych <= 'q') goto yy215;\n-\t\t\tgoto yy212;\n+\t\tif (yych <= 'm') {\n+\t\t\tif (yych <= 'd') {\n+\t\t\t\tif (yych <= 'c') goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t} else {\n+\t\t\t\tif (yych == 'h') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= 'r') {\n+\t\t\t\tif (yych <= 'n') goto yy208;\n+\t\t\t\tif (yych <= 'q') goto yy56;\n+\t\t\t\tgoto yy209;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= 's') goto yy206;\n+\t\t\t\tif (yych <= 't') goto yy210;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t}\n \t}\n-yy357:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= 'm') {\n-\t\tif (yych <= '1') {\n-\t\t\tif (yych <= '\/') goto yy215;\n-\t\t\tif (yych <= '0') goto yy359;\n-\t\t\tgoto yy360;\n+yy299:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '9') {\n+\t\tif (yych <= ' ') {\n+\t\t\tif (yych <= 0x08) {\n+\t\t\t\tif (yych <= 0x00) goto yy213;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '\\t') goto yy211;\n+\t\t\t\tif (yych <= 0x1F) goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= '2') goto yy367;\n-\t\t\tif (yych <= '9') goto yy368;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= '-') {\n+\t\t\t\tif (yych == ',') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '.') goto yy211;\n+\t\t\t\tif (yych <= '\/') goto yy56;\n+\t\t\t\tgoto yy302;\n+\t\t\t}\n \t\t}\n \t} else {\n-\t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'n') goto yy211;\n-\t\t\tif (yych <= 'q') goto yy215;\n-\t\t\tgoto yy212;\n+\t\tif (yych <= 'm') {\n+\t\t\tif (yych <= 'd') {\n+\t\t\t\tif (yych <= 'c') goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t} else {\n+\t\t\t\tif (yych == 'h') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= 'r') {\n+\t\t\t\tif (yych <= 'n') goto yy208;\n+\t\t\t\tif (yych <= 'q') goto yy56;\n+\t\t\t\tgoto yy209;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= 's') goto yy206;\n+\t\t\t\tif (yych <= 't') goto yy210;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t}\n \t}\n-yy358:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= 'm') {\n-\t\tif (yych <= '1') {\n-\t\t\tif (yych <= '\/') goto yy215;\n-\t\t\tif (yych >= '1') goto yy360;\n+yy300:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '9') {\n+\t\tif (yych <= ' ') {\n+\t\t\tif (yych <= 0x08) {\n+\t\t\t\tif (yych <= 0x00) goto yy213;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '\\t') goto yy211;\n+\t\t\t\tif (yych <= 0x1F) goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= '2') goto yy208;\n-\t\t\tif (yych <= '9') goto yy209;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= '-') {\n+\t\t\t\tif (yych == ',') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '.') goto yy211;\n+\t\t\t\tif (yych <= '\/') goto yy56;\n+\t\t\t\tgoto yy302;\n+\t\t\t}\n \t\t}\n \t} else {\n-\t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'n') goto yy211;\n-\t\t\tif (yych <= 'q') goto yy215;\n-\t\t\tgoto yy212;\n+\t\tif (yych <= 'm') {\n+\t\t\tif (yych <= 'd') {\n+\t\t\t\tif (yych <= 'c') goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t} else {\n+\t\t\t\tif (yych == 'h') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= 'r') {\n+\t\t\t\tif (yych <= 'n') goto yy208;\n+\t\t\t\tif (yych <= 'q') goto yy56;\n+\t\t\t\tgoto yy209;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= 's') goto yy206;\n+\t\t\t\tif (yych <= 't') goto yy210;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t}\n \t}\n-yy359:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '9') {\n-\t\tif (yych <= '\/') {\n-\t\t\tif (yych <= ',') goto yy215;\n-\t\t\tif (yych <= '-') goto yy361;\n-\t\t\tif (yych <= '.') goto yy330;\n-\t\t\tgoto yy215;\n+yy301:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '1') {\n+\t\tif (yych <= ' ') {\n+\t\t\tif (yych <= 0x08) {\n+\t\t\t\tif (yych <= 0x00) goto yy213;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '\\t') goto yy211;\n+\t\t\t\tif (yych <= 0x1F) goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= '0') goto yy331;\n-\t\t\tif (yych <= '1') goto yy301;\n-\t\t\tif (yych <= '2') goto yy302;\n-\t\t\tgoto yy296;\n+\t\t\tif (yych <= '-') {\n+\t\t\t\tif (yych == ',') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '.') goto yy211;\n+\t\t\t\tif (yych <= '\/') goto yy56;\n+\t\t\t}\n \t\t}\n \t} else {\n-\t\tif (yych <= 'q') {\n-\t\t\tif (yych <= ':') goto yy220;\n-\t\t\tif (yych == 'n') goto yy211;\n-\t\t\tgoto yy215;\n+\t\tif (yych <= 'm') {\n+\t\t\tif (yych <= 'd') {\n+\t\t\t\tif (yych <= '9') goto yy205;\n+\t\t\t\tif (yych <= 'c') goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t} else {\n+\t\t\t\tif (yych == 'h') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy212;\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= 'r') {\n+\t\t\t\tif (yych <= 'n') goto yy208;\n+\t\t\t\tif (yych <= 'q') goto yy56;\n+\t\t\t\tgoto yy209;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= 's') goto yy206;\n+\t\t\t\tif (yych <= 't') goto yy210;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t}\n \t}\n-yy360:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n+yy302:\n+\tyych = *++YYCURSOR;\n \tif (yych <= '9') {\n-\t\tif (yych <= '\/') {\n-\t\t\tif (yych <= ',') goto yy215;\n-\t\t\tif (yych <= '-') goto yy361;\n-\t\t\tif (yych <= '.') goto yy299;\n-\t\t\tgoto yy215;\n+\t\tif (yych <= ' ') {\n+\t\t\tif (yych <= 0x08) {\n+\t\t\t\tif (yych <= 0x00) goto yy213;\n+\t\t\t\tgoto yy56;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '\\t') goto yy211;\n+\t\t\t\tif (yych <= 0x1F) goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= '0') goto yy300;\n-\t\t\tif (yych <= '1') goto yy301;\n-\t\t\tif (yych <= '2') goto yy302;\n-\t\t\tgoto yy296;\n+\t\t\tif (yych <= '-') {\n+\t\t\t\tif (yych <= '+') goto yy56;\n+\t\t\t\tif (yych <= ',') goto yy211;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= '.') goto yy211;\n+\t\t\t\tif (yych <= '\/') goto yy56;\n+\t\t\t\tgoto yy295;\n+\t\t\t}\n \t\t}\n \t} else {\n-\t\tif (yych <= 'q') {\n-\t\t\tif (yych <= ':') goto yy263;\n-\t\t\tif (yych == 'n') goto yy211;\n-\t\t\tgoto yy215;\n+\t\tif (yych <= 'm') {\n+\t\t\tif (yych <= 'd') {\n+\t\t\t\tif (yych <= 'c') goto yy56;\n+\t\t\t\tgoto yy211;\n+\t\t\t} else {\n+\t\t\t\tif (yych == 'h') goto yy211;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy212;\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n+\t\t\tif (yych <= 'r') {\n+\t\t\t\tif (yych <= 'n') goto yy208;\n+\t\t\t\tif (yych <= 'q') goto yy56;\n+\t\t\t\tgoto yy209;\n+\t\t\t} else {\n+\t\t\t\tif (yych <= 's') goto yy206;\n+\t\t\t\tif (yych <= 't') goto yy210;\n+\t\t\t\tgoto yy56;\n+\t\t\t}\n \t\t}\n \t}\n-yy361:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n \t++YYCURSOR;\n-\tif ((yych = *YYCURSOR) <= '\/') goto yy363;\n-\tif (yych <= '9') goto yy364;\n-yy363:\n+\tif ((yych = *YYCURSOR) <= '\/') goto yy305;\n+\tif (yych <= '9') goto yy306;\n+yy305:\n #line 1482 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint length = 0;\n@@ -6216,71 +5366,17 @@ yy363:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_PG_TEXT;\n \t}\n-#line 6220 \"<stdout>\"\n-yy364:\n+#line 5370 \"<stdout>\"\n+yy306:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy363;\n-\tif (yych >= ':') goto yy363;\n+\tif (yych <= '\/') goto yy305;\n+\tif (yych >= ':') goto yy305;\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy363;\n-\tif (yych >= ':') goto yy363;\n+\tif (yych <= '\/') goto yy305;\n+\tif (yych >= ':') goto yy305;\n \tyych = *++YYCURSOR;\n-\tgoto yy363;\n-yy367:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '9') {\n-\t\tif (yych <= '\/') {\n-\t\t\tif (yych <= ',') goto yy215;\n-\t\t\tif (yych <= '-') goto yy361;\n-\t\t\tif (yych <= '.') goto yy299;\n-\t\t\tgoto yy215;\n-\t\t} else {\n-\t\t\tif (yych <= '0') goto yy331;\n-\t\t\tif (yych <= '1') goto yy301;\n-\t\t\tif (yych <= '2') goto yy302;\n-\t\t\tgoto yy296;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'q') {\n-\t\t\tif (yych <= ':') goto yy263;\n-\t\t\tif (yych == 'n') goto yy211;\n-\t\t\tgoto yy215;\n-\t\t} else {\n-\t\t\tif (yych <= 'r') goto yy212;\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n-\t\t}\n-\t}\n-yy368:\n-\tyyaccept = 6;\n-\tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '9') {\n-\t\tif (yych <= '\/') {\n-\t\t\tif (yych <= ',') goto yy215;\n-\t\t\tif (yych <= '-') goto yy361;\n-\t\t\tif (yych <= '.') goto yy299;\n-\t\t\tgoto yy215;\n-\t\t} else {\n-\t\t\tif (yych <= '0') goto yy331;\n-\t\t\tif (yych <= '1') goto yy301;\n-\t\t\tif (yych <= '2') goto yy302;\n-\t\t\tgoto yy296;\n-\t\t}\n-\t} else {\n-\t\tif (yych <= 'q') {\n-\t\t\tif (yych <= ':') goto yy263;\n-\t\t\tif (yych == 'n') goto yy211;\n-\t\t\tgoto yy215;\n-\t\t} else {\n-\t\t\tif (yych <= 'r') goto yy212;\n-\t\t\tif (yych <= 's') goto yy210;\n-\t\t\tif (yych <= 't') goto yy213;\n-\t\t\tgoto yy215;\n-\t\t}\n-\t}\n-yy369:\n+\tgoto yy305;\n+yy309:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'B') {\n@@ -6304,13 +5400,13 @@ yy369:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'c') goto yy370;\n+\t\t\t\tif (yych <= 'c') goto yy310;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy370:\n+yy310:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n@@ -6337,7 +5433,7 @@ yy370:\n \t\t\t\tif (yych <= '@') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'E') goto yy201;\n+\t\t\t\tif (yych <= 'E') goto yy200;\n \t\t\t\tif (yych <= 'Z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n@@ -6347,23 +5443,23 @@ yy370:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy372;\n+\t\t\t\tif (yych <= 'e') goto yy312;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy371:\n+yy311:\n \tyych = *++YYCURSOR;\n \tif (yybm[0+yych] & 8) {\n \t\tgoto yy148;\n \t}\n \tif (yych <= '\/') goto yy195;\n-\tif (yych <= '0') goto yy356;\n-\tif (yych <= '2') goto yy357;\n-\tif (yych <= '3') goto yy358;\n+\tif (yych <= '0') goto yy299;\n+\tif (yych <= '2') goto yy300;\n+\tif (yych <= '3') goto yy301;\n \tgoto yy195;\n-yy372:\n+yy312:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'L') {\n@@ -6378,7 +5474,7 @@ yy372:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'M') goto yy202;\n+\t\t\tif (yych <= 'M') goto yy201;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -6387,13 +5483,13 @@ yy372:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'm') goto yy373;\n+\t\t\t\tif (yych <= 'm') goto yy313;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy373:\n+yy313:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'A') {\n@@ -6408,7 +5504,7 @@ yy373:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'B') goto yy203;\n+\t\t\tif (yych <= 'B') goto yy202;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -6417,13 +5513,13 @@ yy373:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'b') goto yy374;\n+\t\t\t\tif (yych <= 'b') goto yy314;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy374:\n+yy314:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n@@ -6437,20 +5533,20 @@ yy374:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'E') goto yy204;\n+\t\t\tif (yych <= 'E') goto yy203;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'e') goto yy375;\n+\t\t\tif (yych == 'e') goto yy315;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy375:\n+yy315:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy205;\n+\tif (yych == 'R') goto yy204;\n \tif (yych != 'r') goto yy154;\n-yy376:\n+yy316:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yybm[0+yych] & 16) {\n@@ -6473,13 +5569,13 @@ yy376:\n \t\t\tgoto yy193;\n \t\t}\n \t}\n-yy377:\n+yy317:\n \tyych = *++YYCURSOR;\n \tif (yybm[0+yych] & 8) {\n \t\tgoto yy148;\n \t}\n \tgoto yy195;\n-yy378:\n+yy318:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -6495,12 +5591,12 @@ yy378:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy379;\n+\t\t\tif (yych <= 't') goto yy319;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy379:\n+yy319:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n@@ -6535,13 +5631,13 @@ yy379:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'o') goto yy380;\n+\t\t\t\tif (yych <= 'o') goto yy320;\n \t\t\t\tif (yych <= 'z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy380:\n+yy320:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'B') {\n \t\tif (yych <= ')') {\n@@ -6557,12 +5653,12 @@ yy380:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'b') goto yy381;\n+\t\t\tif (yych <= 'b') goto yy321;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy381:\n+yy321:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'E') {\n \t\tif (yych <= ')') {\n@@ -6578,22 +5674,22 @@ yy381:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy382;\n+\t\t\tif (yych <= 'e') goto yy322;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy382:\n+yy322:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'Q') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'R') goto yy205;\n-\t\tif (yych == 'r') goto yy205;\n+\t\tif (yych <= 'R') goto yy204;\n+\t\tif (yych == 'r') goto yy204;\n \t\tgoto yy3;\n \t}\n-yy383:\n+yy323:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -6608,7 +5704,7 @@ yy383:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy379;\n+\t\t\tif (yych <= 'T') goto yy319;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -6617,13 +5713,13 @@ yy383:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy384;\n+\t\t\t\tif (yych <= 't') goto yy324;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy384:\n+yy324:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n@@ -6639,7 +5735,7 @@ yy384:\n \t\t\tif (yych <= '-') {\n \t\t\t\tif (yych <= ')') goto yy139;\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tgoto yy371;\n+\t\t\t\tgoto yy311;\n \t\t\t} else {\n \t\t\t\tif (yych == '\/') goto yy147;\n \t\t\t\tgoto yy195;\n@@ -6651,7 +5747,7 @@ yy384:\n \t\t\t\tif (yych <= '@') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'O') goto yy380;\n+\t\t\t\tif (yych <= 'O') goto yy320;\n \t\t\t\tif (yych <= 'Z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n@@ -6661,13 +5757,13 @@ yy384:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'o') goto yy385;\n+\t\t\t\tif (yych <= 'o') goto yy325;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy385:\n+yy325:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'A') {\n@@ -6682,7 +5778,7 @@ yy385:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'B') goto yy381;\n+\t\t\tif (yych <= 'B') goto yy321;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -6691,13 +5787,13 @@ yy385:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'b') goto yy386;\n+\t\t\t\tif (yych <= 'b') goto yy326;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy386:\n+yy326:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n@@ -6712,7 +5808,7 @@ yy386:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'E') goto yy382;\n+\t\t\tif (yych <= 'E') goto yy322;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -6721,13 +5817,13 @@ yy386:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy387;\n+\t\t\t\tif (yych <= 'e') goto yy327;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy387:\n+yy327:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n@@ -6741,16 +5837,16 @@ yy387:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'R') goto yy205;\n+\t\t\tif (yych <= 'R') goto yy204;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'r') goto yy376;\n+\t\t\tif (yych == 'r') goto yy316;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy388:\n+yy328:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'G') {\n \t\tif (yych <= ')') {\n@@ -6759,7 +5855,7 @@ yy388:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'F') goto yy141;\n-\t\t\tgoto yy396;\n+\t\t\tgoto yy336;\n \t\t}\n \t} else {\n \t\tif (yych <= 'f') {\n@@ -6767,12 +5863,12 @@ yy388:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'g') goto yy396;\n+\t\t\tif (yych <= 'g') goto yy336;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy389:\n+yy329:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'R') {\n \t\tif (yych <= ')') {\n@@ -6781,7 +5877,7 @@ yy389:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'Q') goto yy141;\n-\t\t\tgoto yy393;\n+\t\t\tgoto yy333;\n \t\t}\n \t} else {\n \t\tif (yych <= 'q') {\n@@ -6789,12 +5885,12 @@ yy389:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy393;\n+\t\t\tif (yych <= 'r') goto yy333;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy390:\n+yy330:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'O') {\n \t\tif (yych <= ')') {\n@@ -6810,21 +5906,21 @@ yy390:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'o') goto yy391;\n+\t\t\tif (yych <= 'o') goto yy331;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy391:\n+yy331:\n \t++YYCURSOR;\n \tif ((yych = *YYCURSOR) <= '@') {\n \t\tif (yych == ')') goto yy139;\n \t} else {\n \t\tif (yych <= 'Z') goto yy142;\n-\t\tif (yych <= '`') goto yy392;\n+\t\tif (yych <= '`') goto yy332;\n \t\tif (yych <= 'z') goto yy142;\n \t}\n-yy392:\n+yy332:\n #line 1540 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tDEBUG_OUTPUT(\"ago\");\n@@ -6845,8 +5941,8 @@ yy392:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_AGO;\n \t}\n-#line 6849 \"<stdout>\"\n-yy393:\n+#line 5945 \"<stdout>\"\n+yy333:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n@@ -6881,13 +5977,13 @@ yy393:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'i') goto yy394;\n+\t\t\t\tif (yych <= 'i') goto yy334;\n \t\t\t\tif (yych <= 'z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy394:\n+yy334:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'L') {\n \t\tif (yych <= ')') {\n@@ -6903,12 +5999,12 @@ yy394:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'l') goto yy395;\n+\t\t\tif (yych <= 'l') goto yy335;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy395:\n+yy335:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ',') {\n@@ -6932,7 +6028,7 @@ yy395:\n \t\t\tgoto yy193;\n \t\t}\n \t}\n-yy396:\n+yy336:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n@@ -6967,13 +6063,13 @@ yy396:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'u') goto yy397;\n+\t\t\t\tif (yych <= 'u') goto yy337;\n \t\t\t\tif (yych <= 'z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy397:\n+yy337:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'S') {\n \t\tif (yych <= ')') {\n@@ -6989,12 +6085,12 @@ yy397:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy398;\n+\t\t\tif (yych <= 's') goto yy338;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy398:\n+yy338:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -7010,12 +6106,12 @@ yy398:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy399;\n+\t\t\tif (yych <= 't') goto yy339;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy399:\n+yy339:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '(') {\n@@ -7037,7 +6133,7 @@ yy399:\n \t\t\tgoto yy193;\n \t\t}\n \t}\n-yy400:\n+yy340:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'F') {\n@@ -7052,7 +6148,7 @@ yy400:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'G') goto yy396;\n+\t\t\tif (yych <= 'G') goto yy336;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -7061,13 +6157,13 @@ yy400:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'g') goto yy407;\n+\t\t\t\tif (yych <= 'g') goto yy347;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy401:\n+yy341:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n@@ -7082,7 +6178,7 @@ yy401:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'R') goto yy393;\n+\t\t\tif (yych <= 'R') goto yy333;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -7091,13 +6187,13 @@ yy401:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy404;\n+\t\t\t\tif (yych <= 'r') goto yy344;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy402:\n+yy342:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'N') {\n@@ -7112,7 +6208,7 @@ yy402:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'O') goto yy391;\n+\t\t\tif (yych <= 'O') goto yy331;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -7121,36 +6217,36 @@ yy402:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'o') goto yy403;\n+\t\t\t\tif (yych <= 'o') goto yy343;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy403:\n-\tyyaccept = 9;\n+yy343:\n+\tyyaccept = 8;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n \t\tif (yych <= ',') {\n \t\t\tif (yych == ')') goto yy139;\n-\t\t\tgoto yy392;\n+\t\t\tgoto yy332;\n \t\t} else {\n-\t\t\tif (yych == '.') goto yy392;\n+\t\t\tif (yych == '.') goto yy332;\n \t\t\tgoto yy147;\n \t\t}\n \t} else {\n \t\tif (yych <= '^') {\n-\t\t\tif (yych <= '@') goto yy392;\n+\t\t\tif (yych <= '@') goto yy332;\n \t\t\tif (yych <= 'Z') goto yy142;\n-\t\t\tgoto yy392;\n+\t\t\tgoto yy332;\n \t\t} else {\n \t\t\tif (yych <= '_') goto yy147;\n-\t\t\tif (yych <= '`') goto yy392;\n+\t\t\tif (yych <= '`') goto yy332;\n \t\t\tif (yych <= 'z') goto yy150;\n-\t\t\tgoto yy392;\n+\t\t\tgoto yy332;\n \t\t}\n \t}\n-yy404:\n+yy344:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n@@ -7166,7 +6262,7 @@ yy404:\n \t\t\tif (yych <= '-') {\n \t\t\t\tif (yych <= ')') goto yy139;\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tgoto yy371;\n+\t\t\t\tgoto yy311;\n \t\t\t} else {\n \t\t\t\tif (yych == '\/') goto yy147;\n \t\t\t\tgoto yy195;\n@@ -7178,7 +6274,7 @@ yy404:\n \t\t\t\tif (yych <= '@') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'I') goto yy394;\n+\t\t\t\tif (yych <= 'I') goto yy334;\n \t\t\t\tif (yych <= 'Z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n@@ -7188,13 +6284,13 @@ yy404:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'i') goto yy405;\n+\t\t\t\tif (yych <= 'i') goto yy345;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy405:\n+yy345:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'K') {\n@@ -7209,7 +6305,7 @@ yy405:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'L') goto yy395;\n+\t\t\tif (yych <= 'L') goto yy335;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -7218,13 +6314,13 @@ yy405:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'l') goto yy406;\n+\t\t\t\tif (yych <= 'l') goto yy346;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy406:\n+yy346:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n@@ -7238,7 +6334,7 @@ yy406:\n \t\t\t\tgoto yy139;\n \t\t\t} else {\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tif (yych <= '-') goto yy377;\n+\t\t\t\tif (yych <= '-') goto yy317;\n \t\t\t\tgoto yy195;\n \t\t\t}\n \t\t}\n@@ -7259,7 +6355,7 @@ yy406:\n \t\t\t}\n \t\t}\n \t}\n-yy407:\n+yy347:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n@@ -7275,7 +6371,7 @@ yy407:\n \t\t\tif (yych <= '-') {\n \t\t\t\tif (yych <= ')') goto yy139;\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tgoto yy371;\n+\t\t\t\tgoto yy311;\n \t\t\t} else {\n \t\t\t\tif (yych == '\/') goto yy147;\n \t\t\t\tgoto yy195;\n@@ -7287,7 +6383,7 @@ yy407:\n \t\t\t\tif (yych <= '@') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'U') goto yy397;\n+\t\t\t\tif (yych <= 'U') goto yy337;\n \t\t\t\tif (yych <= 'Z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n@@ -7297,13 +6393,13 @@ yy407:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'u') goto yy408;\n+\t\t\t\tif (yych <= 'u') goto yy348;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy408:\n+yy348:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'R') {\n@@ -7318,7 +6414,7 @@ yy408:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'S') goto yy398;\n+\t\t\tif (yych <= 'S') goto yy338;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -7327,13 +6423,13 @@ yy408:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 's') goto yy409;\n+\t\t\t\tif (yych <= 's') goto yy349;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy409:\n+yy349:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -7348,7 +6444,7 @@ yy409:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy399;\n+\t\t\tif (yych <= 'T') goto yy339;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -7357,13 +6453,13 @@ yy409:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy410;\n+\t\t\t\tif (yych <= 't') goto yy350;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy410:\n+yy350:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yybm[0+yych] & 16) {\n@@ -7380,7 +6476,7 @@ yy410:\n \t\t}\n \t} else {\n \t\tif (yych <= '\/') {\n-\t\t\tif (yych <= '-') goto yy377;\n+\t\t\tif (yych <= '-') goto yy317;\n \t\t\tif (yych <= '.') goto yy195;\n \t\t\tgoto yy147;\n \t\t} else {\n@@ -7389,30 +6485,30 @@ yy410:\n \t\t\tgoto yy193;\n \t\t}\n \t}\n-yy411:\n+yy351:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n \t\tif (yych <= '@') {\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'L') goto yy418;\n+\t\t\tif (yych == 'L') goto yy358;\n \t\t\tif (yych <= 'M') goto yy141;\n-\t\t\tgoto yy417;\n+\t\t\tgoto yy357;\n \t\t}\n \t} else {\n \t\tif (yych <= 'l') {\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tif (yych <= 'k') goto yy141;\n-\t\t\tgoto yy418;\n+\t\t\tgoto yy358;\n \t\t} else {\n-\t\t\tif (yych == 'n') goto yy417;\n+\t\t\tif (yych == 'n') goto yy357;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy412:\n+yy352:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n \t\tif (yych <= ')') {\n@@ -7428,12 +6524,12 @@ yy412:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'n') goto yy413;\n+\t\t\tif (yych <= 'n') goto yy353;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy413:\n+yy353:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n@@ -7468,13 +6564,13 @@ yy413:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'u') goto yy414;\n+\t\t\t\tif (yych <= 'u') goto yy354;\n \t\t\t\tif (yych <= 'z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy414:\n+yy354:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'A') {\n \t\tif (yych == ')') goto yy139;\n@@ -7484,12 +6580,12 @@ yy414:\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy415;\n+\t\t\tif (yych <= 'a') goto yy355;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy415:\n+yy355:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'R') {\n \t\tif (yych <= ')') {\n@@ -7505,22 +6601,22 @@ yy415:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy416;\n+\t\t\tif (yych <= 'r') goto yy356;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy416:\n+yy356:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'X') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'Y') goto yy205;\n-\t\tif (yych == 'y') goto yy205;\n+\t\tif (yych <= 'Y') goto yy204;\n+\t\tif (yych == 'y') goto yy204;\n \t\tgoto yy3;\n \t}\n-yy417:\n+yy357:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n@@ -7548,7 +6644,7 @@ yy417:\n \t\t\t\tif (yych <= '9') goto yy195;\n \t\t\t\tgoto yy193;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'E') goto yy419;\n+\t\t\t\tif (yych == 'E') goto yy359;\n \t\t\t\tgoto yy142;\n \t\t\t}\n \t\t} else {\n@@ -7556,13 +6652,13 @@ yy417:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy419;\n+\t\t\t\tif (yych <= 'e') goto yy359;\n \t\t\t\tif (yych <= 'z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy418:\n+yy358:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n@@ -7597,13 +6693,13 @@ yy418:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'y') goto yy419;\n+\t\t\t\tif (yych <= 'y') goto yy359;\n \t\t\t\tif (yych <= 'z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy419:\n+yy359:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ',') {\n@@ -7627,7 +6723,7 @@ yy419:\n \t\t\tgoto yy193;\n \t\t}\n \t}\n-yy420:\n+yy360:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'M') {\n@@ -7644,14 +6740,14 @@ yy420:\n \t\t\t\tif (yych <= '\/') goto yy147;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'L') goto yy418;\n+\t\t\t\tif (yych == 'L') goto yy358;\n \t\t\t\tgoto yy141;\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= 'N') goto yy417;\n+\t\t\t\tif (yych <= 'N') goto yy357;\n \t\t\t\tgoto yy141;\n \t\t\t} else {\n \t\t\t\tif (yych == '_') goto yy147;\n@@ -7659,16 +6755,16 @@ yy420:\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'm') {\n-\t\t\t\tif (yych == 'l') goto yy427;\n+\t\t\t\tif (yych == 'l') goto yy367;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'n') goto yy426;\n+\t\t\t\tif (yych <= 'n') goto yy366;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy421:\n+yy361:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'M') {\n@@ -7683,7 +6779,7 @@ yy421:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'N') goto yy413;\n+\t\t\tif (yych <= 'N') goto yy353;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -7692,13 +6788,13 @@ yy421:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'n') goto yy422;\n+\t\t\t\tif (yych <= 'n') goto yy362;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy422:\n+yy362:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n@@ -7714,7 +6810,7 @@ yy422:\n \t\t\tif (yych <= '-') {\n \t\t\t\tif (yych <= ')') goto yy139;\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tgoto yy371;\n+\t\t\t\tgoto yy311;\n \t\t\t} else {\n \t\t\t\tif (yych == '\/') goto yy147;\n \t\t\t\tgoto yy195;\n@@ -7726,7 +6822,7 @@ yy422:\n \t\t\t\tif (yych <= '@') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'U') goto yy414;\n+\t\t\t\tif (yych <= 'U') goto yy354;\n \t\t\t\tif (yych <= 'Z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n@@ -7736,13 +6832,13 @@ yy422:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'u') goto yy423;\n+\t\t\t\tif (yych <= 'u') goto yy363;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy423:\n+yy363:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n@@ -7756,18 +6852,18 @@ yy423:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'A') goto yy415;\n+\t\t\tif (yych <= 'A') goto yy355;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n \t\t} else {\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tif (yych <= 'a') goto yy424;\n+\t\t\tif (yych <= 'a') goto yy364;\n \t\t\tif (yych <= 'z') goto yy151;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy424:\n+yy364:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n@@ -7782,7 +6878,7 @@ yy424:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'R') goto yy416;\n+\t\t\tif (yych <= 'R') goto yy356;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -7791,13 +6887,13 @@ yy424:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy425;\n+\t\t\t\tif (yych <= 'r') goto yy365;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy425:\n+yy365:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'X') {\n@@ -7811,16 +6907,16 @@ yy425:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'Y') goto yy205;\n+\t\t\tif (yych <= 'Y') goto yy204;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'y') goto yy376;\n+\t\t\tif (yych == 'y') goto yy316;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy426:\n+yy366:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n@@ -7836,7 +6932,7 @@ yy426:\n \t\t\tif (yych <= '-') {\n \t\t\t\tif (yych <= ')') goto yy139;\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tgoto yy371;\n+\t\t\t\tgoto yy311;\n \t\t\t} else {\n \t\t\t\tif (yych == '\/') goto yy147;\n \t\t\t\tgoto yy195;\n@@ -7848,7 +6944,7 @@ yy426:\n \t\t\t\tif (yych <= '@') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'E') goto yy419;\n+\t\t\t\tif (yych <= 'E') goto yy359;\n \t\t\t\tif (yych <= 'Z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n@@ -7858,13 +6954,13 @@ yy426:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy428;\n+\t\t\t\tif (yych <= 'e') goto yy368;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy427:\n+yy367:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n@@ -7880,7 +6976,7 @@ yy427:\n \t\t\tif (yych <= '-') {\n \t\t\t\tif (yych <= ')') goto yy139;\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tgoto yy371;\n+\t\t\t\tgoto yy311;\n \t\t\t} else {\n \t\t\t\tif (yych == '\/') goto yy147;\n \t\t\t\tgoto yy195;\n@@ -7892,7 +6988,7 @@ yy427:\n \t\t\t\tif (yych <= '@') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'Y') goto yy419;\n+\t\t\t\tif (yych <= 'Y') goto yy359;\n \t\t\t\tif (yych <= 'Z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n@@ -7902,13 +6998,13 @@ yy427:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'y') goto yy428;\n+\t\t\t\tif (yych <= 'y') goto yy368;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy428:\n+yy368:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n@@ -7922,7 +7018,7 @@ yy428:\n \t\t\t\tgoto yy139;\n \t\t\t} else {\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tif (yych <= '-') goto yy377;\n+\t\t\t\tif (yych <= '-') goto yy317;\n \t\t\t\tgoto yy195;\n \t\t\t}\n \t\t}\n@@ -7943,7 +7039,7 @@ yy428:\n \t\t\t}\n \t\t}\n \t}\n-yy429:\n+yy369:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n@@ -7972,7 +7068,7 @@ yy429:\n \t\t\t}\n \t\t}\n \t}\n-yy430:\n+yy370:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ',') {\n@@ -7996,7 +7092,7 @@ yy430:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy431:\n+yy371:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n@@ -8076,7 +7172,7 @@ yy431:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy434:\n+yy374:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ',') {\n@@ -8100,7 +7196,7 @@ yy434:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy435:\n+yy375:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n@@ -8121,7 +7217,7 @@ yy435:\n \t\t\tgoto yy141;\n \t\t} else {\n \t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= 'I') goto yy430;\n+\t\t\t\tif (yych <= 'I') goto yy370;\n \t\t\t\tgoto yy141;\n \t\t\t} else {\n \t\t\t\tif (yych <= '`') goto yy3;\n@@ -8130,7 +7226,7 @@ yy435:\n \t\t\t}\n \t\t}\n \t}\n-yy436:\n+yy376:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'V') {\n@@ -8142,7 +7238,7 @@ yy436:\n \t\t\t} else {\n \t\t\t\tif (yych <= '9') {\n \t\t\t\t\tif (yych <= '\/') goto yy3;\n-\t\t\t\t\tgoto yy456;\n+\t\t\t\t\tgoto yy396;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych <= ':') goto yy162;\n \t\t\t\t\tif (yych <= 'C') goto yy3;\n@@ -8196,7 +7292,7 @@ yy436:\n \t\t\t}\n \t\t}\n \t}\n-yy437:\n+yy377:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n@@ -8208,10 +7304,10 @@ yy437:\n \t\t\t} else {\n \t\t\t\tif (yych <= '4') {\n \t\t\t\t\tif (yych <= '\/') goto yy3;\n-\t\t\t\t\tgoto yy456;\n+\t\t\t\t\tgoto yy396;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= '5') goto yy441;\n-\t\t\t\t\tif (yych <= '9') goto yy442;\n+\t\t\t\t\tif (yych <= '5') goto yy381;\n+\t\t\t\t\tif (yych <= '9') goto yy382;\n \t\t\t\t\tgoto yy162;\n \t\t\t\t}\n \t\t\t}\n@@ -8271,7 +7367,7 @@ yy437:\n \t\t\t}\n \t\t}\n \t}\n-yy438:\n+yy378:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n@@ -8283,9 +7379,9 @@ yy438:\n \t\t\t} else {\n \t\t\t\tif (yych <= '5') {\n \t\t\t\t\tif (yych <= '\/') goto yy3;\n-\t\t\t\t\tgoto yy441;\n+\t\t\t\t\tgoto yy381;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= '9') goto yy442;\n+\t\t\t\t\tif (yych <= '9') goto yy382;\n \t\t\t\t\tif (yych <= ':') goto yy162;\n \t\t\t\t\tgoto yy3;\n \t\t\t\t}\n@@ -8342,7 +7438,7 @@ yy438:\n \t\t\t}\n \t\t}\n \t}\n-yy439:\n+yy379:\n \t++YYCURSOR;\n \tif (YYLIMIT <= YYCURSOR) YYFILL(1);\n \tyych = *YYCURSOR;\n@@ -8350,15 +7446,15 @@ yy439:\n \t\tgoto yy57;\n \t}\n \tif (yych <= ',') {\n-\t\tif (yych == '+') goto yy439;\n+\t\tif (yych == '+') goto yy379;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= '-') goto yy439;\n+\t\tif (yych <= '-') goto yy379;\n \t\tif (yych <= '\/') goto yy56;\n \t\tif (yych <= '9') goto yy54;\n \t\tgoto yy56;\n \t}\n-yy441:\n+yy381:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'V') {\n@@ -8369,7 +7465,7 @@ yy441:\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= '\/') goto yy3;\n-\t\t\t\tif (yych <= '9') goto yy455;\n+\t\t\t\tif (yych <= '9') goto yy395;\n \t\t\t\tif (yych <= 'C') goto yy3;\n \t\t\t\tgoto yy60;\n \t\t\t}\n@@ -8420,7 +7516,7 @@ yy441:\n \t\t\t}\n \t\t}\n \t}\n-yy442:\n+yy382:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'V') {\n@@ -8431,7 +7527,7 @@ yy442:\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= '\/') goto yy3;\n-\t\t\t\tif (yych <= '9') goto yy443;\n+\t\t\t\tif (yych <= '9') goto yy383;\n \t\t\t\tif (yych <= 'C') goto yy3;\n \t\t\t\tgoto yy60;\n \t\t\t}\n@@ -8482,57 +7578,57 @@ yy442:\n \t\t\t}\n \t\t}\n \t}\n-yy443:\n+yy383:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n \tif (yych >= ':') goto yy60;\n-yy444:\n+yy384:\n \tyych = *++YYCURSOR;\n \tif (yybm[0+yych] & 2) {\n \t\tgoto yy54;\n \t}\n \tif (yych != '-') goto yy60;\n-yy445:\n+yy385:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '0') goto yy446;\n-\tif (yych <= '1') goto yy447;\n+\tif (yych <= '0') goto yy386;\n+\tif (yych <= '1') goto yy387;\n \tgoto yy56;\n-yy446:\n+yy386:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy448;\n+\tif (yych <= '9') goto yy388;\n \tgoto yy56;\n-yy447:\n+yy387:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= '3') goto yy56;\n-yy448:\n+yy388:\n \tyych = *++YYCURSOR;\n \tif (yych != '-') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '0') goto yy450;\n-\tif (yych <= '2') goto yy451;\n-\tif (yych <= '3') goto yy452;\n+\tif (yych <= '0') goto yy390;\n+\tif (yych <= '2') goto yy391;\n+\tif (yych <= '3') goto yy392;\n \tgoto yy56;\n-yy450:\n+yy390:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy453;\n+\tif (yych <= '9') goto yy393;\n \tgoto yy56;\n-yy451:\n+yy391:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy453;\n+\tif (yych <= '9') goto yy393;\n \tgoto yy56;\n-yy452:\n+yy392:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= '2') goto yy56;\n-yy453:\n+yy393:\n \t++YYCURSOR;\n-yy454:\n+yy394:\n #line 1243 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tDEBUG_OUTPUT(\"iso8601date4 | iso8601date2 | iso8601dateslash | dateslash\");\n@@ -8544,8 +7640,8 @@ yy454:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_ISO_DATE;\n \t}\n-#line 8548 \"<stdout>\"\n-yy455:\n+#line 7644 \"<stdout>\"\n+yy395:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'V') {\n@@ -8556,7 +7652,7 @@ yy455:\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= '\/') goto yy3;\n-\t\t\t\tif (yych <= '9') goto yy444;\n+\t\t\t\tif (yych <= '9') goto yy384;\n \t\t\t\tif (yych <= 'C') goto yy3;\n \t\t\t\tgoto yy60;\n \t\t\t}\n@@ -8607,7 +7703,7 @@ yy455:\n \t\t\t}\n \t\t}\n \t}\n-yy456:\n+yy396:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n@@ -8620,7 +7716,7 @@ yy456:\n \t\t\t\tif (yych <= '5') {\n \t\t\t\t\tif (yych <= '\/') goto yy3;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= '9') goto yy455;\n+\t\t\t\t\tif (yych <= '9') goto yy395;\n \t\t\t\t\tif (yych <= ':') goto yy162;\n \t\t\t\t\tgoto yy3;\n \t\t\t\t}\n@@ -8687,7 +7783,7 @@ yy456:\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= '\/') goto yy3;\n-\t\t\t\tif (yych <= '9') goto yy458;\n+\t\t\t\tif (yych <= '9') goto yy398;\n \t\t\t\tif (yych <= 'C') goto yy3;\n \t\t\t\tgoto yy60;\n \t\t\t}\n@@ -8738,7 +7834,7 @@ yy456:\n \t\t\t}\n \t\t}\n \t}\n-yy458:\n+yy398:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yybm[0+yych] & 2) {\n@@ -8751,7 +7847,7 @@ yy458:\n \t\t\t\tif (yych <= 0x1F) goto yy3;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n-\t\t\t\tif (yych == '-') goto yy445;\n+\t\t\t\tif (yych == '-') goto yy385;\n \t\t\t\tif (yych <= 'C') goto yy3;\n \t\t\t\tgoto yy60;\n \t\t\t}\n@@ -8802,62 +7898,62 @@ yy458:\n \t\t\t}\n \t\t}\n \t}\n-yy459:\n+yy399:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy461;\n-\tif (yych <= '0') goto yy735;\n-\tif (yych <= '1') goto yy736;\n-\tif (yych <= '9') goto yy737;\n-\tgoto yy461;\n-yy460:\n+\tif (yych <= '\/') goto yy401;\n+\tif (yych <= '0') goto yy675;\n+\tif (yych <= '1') goto yy676;\n+\tif (yych <= '9') goto yy677;\n+\tgoto yy401;\n+yy400:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 13) YYFILL(13);\n \tyych = *YYCURSOR;\n-yy461:\n+yy401:\n \tswitch (yych) {\n \tcase '\\t':\n-\tcase ' ':\tgoto yy460;\n+\tcase ' ':\tgoto yy400;\n \tcase '-':\n-\tcase '.':\tgoto yy576;\n+\tcase '.':\tgoto yy516;\n \tcase 'A':\n-\tcase 'a':\tgoto yy479;\n+\tcase 'a':\tgoto yy419;\n \tcase 'D':\n-\tcase 'd':\tgoto yy465;\n+\tcase 'd':\tgoto yy405;\n \tcase 'F':\n-\tcase 'f':\tgoto yy466;\n+\tcase 'f':\tgoto yy406;\n \tcase 'H':\n \tcase 'h':\tgoto yy63;\n-\tcase 'I':\tgoto yy474;\n+\tcase 'I':\tgoto yy414;\n \tcase 'J':\n-\tcase 'j':\tgoto yy478;\n+\tcase 'j':\tgoto yy418;\n \tcase 'M':\n-\tcase 'm':\tgoto yy464;\n+\tcase 'm':\tgoto yy404;\n \tcase 'N':\n-\tcase 'n':\tgoto yy481;\n+\tcase 'n':\tgoto yy421;\n \tcase 'O':\n-\tcase 'o':\tgoto yy480;\n+\tcase 'o':\tgoto yy420;\n \tcase 'P':\n-\tcase 'p':\tgoto yy483;\n+\tcase 'p':\tgoto yy423;\n \tcase 'S':\n-\tcase 's':\tgoto yy462;\n+\tcase 's':\tgoto yy402;\n \tcase 'T':\n \tcase 't':\tgoto yy68;\n-\tcase 'V':\tgoto yy476;\n+\tcase 'V':\tgoto yy416;\n \tcase 'W':\n \tcase 'w':\tgoto yy67;\n-\tcase 'X':\tgoto yy477;\n+\tcase 'X':\tgoto yy417;\n \tcase 'Y':\n \tcase 'y':\tgoto yy66;\n \tdefault:\tgoto yy56;\n \t}\n-yy462:\n+yy402:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n \t\tif (yych <= 'D') {\n \t\t\tif (yych == 'A') goto yy126;\n \t\t\tgoto yy56;\n \t\t} else {\n-\t\t\tif (yych <= 'E') goto yy1048;\n+\t\t\tif (yych <= 'E') goto yy988;\n \t\t\tif (yych <= 'T') goto yy56;\n \t\t\tgoto yy125;\n \t\t}\n@@ -8866,19 +7962,19 @@ yy462:\n \t\t\tif (yych == 'a') goto yy126;\n \t\t\tgoto yy56;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy1048;\n+\t\t\tif (yych <= 'e') goto yy988;\n \t\t\tif (yych == 'u') goto yy125;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy463:\n+yy403:\n \tyych = *++YYCURSOR;\n \tif (yych <= '`') {\n \t\tif (yych <= 'D') {\n \t\t\tif (yych == 'A') goto yy126;\n \t\t\tgoto yy56;\n \t\t} else {\n-\t\t\tif (yych <= 'E') goto yy1048;\n+\t\t\tif (yych <= 'E') goto yy988;\n \t\t\tif (yych == 'U') goto yy125;\n \t\t\tgoto yy56;\n \t\t}\n@@ -8886,19 +7982,19 @@ yy463:\n \t\tif (yych <= 'e') {\n \t\t\tif (yych <= 'a') goto yy126;\n \t\t\tif (yych <= 'd') goto yy56;\n-\t\t\tgoto yy1048;\n+\t\t\tgoto yy988;\n \t\t} else {\n \t\t\tif (yych <= 's') goto yy56;\n-\t\t\tif (yych <= 't') goto yy728;\n+\t\t\tif (yych <= 't') goto yy668;\n \t\t\tif (yych <= 'u') goto yy125;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy464:\n+yy404:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'O') {\n \t\tif (yych <= 'H') {\n-\t\t\tif (yych == 'A') goto yy591;\n+\t\t\tif (yych == 'A') goto yy531;\n \t\t\tgoto yy56;\n \t\t} else {\n \t\t\tif (yych <= 'I') goto yy117;\n@@ -8907,7 +8003,7 @@ yy464:\n \t\t}\n \t} else {\n \t\tif (yych <= 'h') {\n-\t\t\tif (yych == 'a') goto yy591;\n+\t\t\tif (yych == 'a') goto yy531;\n \t\t\tgoto yy56;\n \t\t} else {\n \t\t\tif (yych <= 'i') goto yy117;\n@@ -8915,26 +8011,26 @@ yy464:\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy465:\n+yy405:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'E') {\n \t\tif (yych == 'A') goto yy113;\n \t\tif (yych <= 'D') goto yy56;\n-\t\tgoto yy578;\n+\t\tgoto yy518;\n \t} else {\n \t\tif (yych <= 'a') {\n \t\t\tif (yych <= '`') goto yy56;\n \t\t\tgoto yy113;\n \t\t} else {\n-\t\t\tif (yych == 'e') goto yy578;\n+\t\t\tif (yych == 'e') goto yy518;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy466:\n+yy406:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'R') {\n \t\tif (yych <= 'N') {\n-\t\t\tif (yych == 'E') goto yy594;\n+\t\t\tif (yych == 'E') goto yy534;\n \t\t\tgoto yy56;\n \t\t} else {\n \t\t\tif (yych <= 'O') goto yy98;\n@@ -8943,7 +8039,7 @@ yy466:\n \t\t}\n \t} else {\n \t\tif (yych <= 'n') {\n-\t\t\tif (yych == 'e') goto yy594;\n+\t\t\tif (yych == 'e') goto yy534;\n \t\t\tgoto yy56;\n \t\t} else {\n \t\t\tif (yych <= 'o') goto yy98;\n@@ -8951,7 +8047,7 @@ yy466:\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy467:\n+yy407:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n \t\tif (yych == 'H') goto yy69;\n@@ -8960,68 +8056,68 @@ yy467:\n \t} else {\n \t\tif (yych <= 'h') {\n \t\t\tif (yych <= 'g') goto yy56;\n-\t\t\tgoto yy1047;\n+\t\t\tgoto yy987;\n \t\t} else {\n \t\t\tif (yych == 'u') goto yy70;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy468:\n+yy408:\n \tyych = *++YYCURSOR;\n-\tif (yych == '-') goto yy741;\n+\tif (yych == '-') goto yy681;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '9') goto yy740;\n+\tif (yych <= '9') goto yy680;\n \tgoto yy60;\n-yy469:\n+yy409:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'c') {\n-\t\tif (yych == 'O') goto yy529;\n+\t\tif (yych == 'O') goto yy469;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= 'd') goto yy728;\n-\t\tif (yych == 'o') goto yy529;\n+\t\tif (yych <= 'd') goto yy668;\n+\t\tif (yych == 'o') goto yy469;\n \t\tgoto yy56;\n \t}\n-yy470:\n+yy410:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'd') goto yy728;\n+\tif (yych == 'd') goto yy668;\n \tgoto yy56;\n-yy471:\n+yy411:\n \tyych = *++YYCURSOR;\n \tswitch (yych) {\n \tcase '0':\n \tcase '1':\n-\tcase '2':\tgoto yy665;\n-\tcase '3':\tgoto yy667;\n+\tcase '2':\tgoto yy605;\n+\tcase '3':\tgoto yy607;\n \tcase '4':\n \tcase '5':\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy668;\n+\tcase '9':\tgoto yy608;\n \tcase 'A':\n-\tcase 'a':\tgoto yy672;\n+\tcase 'a':\tgoto yy612;\n \tcase 'D':\n-\tcase 'd':\tgoto yy676;\n+\tcase 'd':\tgoto yy616;\n \tcase 'F':\n-\tcase 'f':\tgoto yy670;\n+\tcase 'f':\tgoto yy610;\n \tcase 'J':\n-\tcase 'j':\tgoto yy669;\n+\tcase 'j':\tgoto yy609;\n \tcase 'M':\n-\tcase 'm':\tgoto yy671;\n+\tcase 'm':\tgoto yy611;\n \tcase 'N':\n-\tcase 'n':\tgoto yy675;\n+\tcase 'n':\tgoto yy615;\n \tcase 'O':\n-\tcase 'o':\tgoto yy674;\n+\tcase 'o':\tgoto yy614;\n \tcase 'S':\n-\tcase 's':\tgoto yy673;\n+\tcase 's':\tgoto yy613;\n \tdefault:\tgoto yy56;\n \t}\n-yy472:\n+yy412:\n \tyych = *++YYCURSOR;\n \tswitch (yych) {\n-\tcase '0':\tgoto yy615;\n-\tcase '1':\tgoto yy616;\n+\tcase '0':\tgoto yy555;\n+\tcase '1':\tgoto yy556;\n \tcase '2':\n \tcase '3':\n \tcase '4':\n@@ -9029,57 +8125,57 @@ yy472:\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy617;\n+\tcase '9':\tgoto yy557;\n \tcase 'A':\n-\tcase 'a':\tgoto yy621;\n+\tcase 'a':\tgoto yy561;\n \tcase 'D':\n-\tcase 'd':\tgoto yy625;\n+\tcase 'd':\tgoto yy565;\n \tcase 'F':\n-\tcase 'f':\tgoto yy619;\n+\tcase 'f':\tgoto yy559;\n \tcase 'J':\n-\tcase 'j':\tgoto yy618;\n+\tcase 'j':\tgoto yy558;\n \tcase 'M':\n-\tcase 'm':\tgoto yy620;\n+\tcase 'm':\tgoto yy560;\n \tcase 'N':\n-\tcase 'n':\tgoto yy624;\n+\tcase 'n':\tgoto yy564;\n \tcase 'O':\n-\tcase 'o':\tgoto yy623;\n+\tcase 'o':\tgoto yy563;\n \tcase 'S':\n-\tcase 's':\tgoto yy622;\n-\tdefault:\tgoto yy577;\n+\tcase 's':\tgoto yy562;\n+\tdefault:\tgoto yy517;\n \t}\n-yy473:\n+yy413:\n \tyych = *++YYCURSOR;\n \tif (yych <= '1') {\n-\t\tif (yych <= '\/') goto yy577;\n-\t\tif (yych <= '0') goto yy567;\n-\t\tgoto yy568;\n+\t\tif (yych <= '\/') goto yy517;\n+\t\tif (yych <= '0') goto yy507;\n+\t\tgoto yy508;\n \t} else {\n-\t\tif (yych <= '5') goto yy569;\n-\t\tif (yych <= '9') goto yy570;\n-\t\tgoto yy577;\n+\t\tif (yych <= '5') goto yy509;\n+\t\tif (yych <= '9') goto yy510;\n+\t\tgoto yy517;\n \t}\n-yy474:\n-\tyyaccept = 10;\n+yy414:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n+\t\t\tif (yych == '\\t') goto yy471;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych <= '.') goto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych <= '.') goto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'U') {\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tif (yych == 'I') goto yy566;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tif (yych == 'I') goto yy506;\n \t\t} else {\n-\t\t\tif (yych == 'W') goto yy475;\n-\t\t\tif (yych <= 'X') goto yy539;\n+\t\t\tif (yych == 'W') goto yy415;\n+\t\t\tif (yych <= 'X') goto yy479;\n \t\t}\n \t}\n-yy475:\n+yy415:\n #line 1380 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tDEBUG_OUTPUT(\"datenoyearrev\");\n@@ -9091,133 +8187,133 @@ yy475:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_DATE_TEXT;\n \t}\n-#line 9095 \"<stdout>\"\n-yy476:\n-\tyyaccept = 10;\n+#line 8191 \"<stdout>\"\n+yy416:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ',') {\n \t\tif (yych <= '\\t') {\n-\t\t\tif (yych <= 0x08) goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= 0x08) goto yy415;\n+\t\t\tgoto yy471;\n \t\t} else {\n-\t\t\tif (yych == ' ') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == ' ') goto yy471;\n+\t\t\tgoto yy415;\n \t\t}\n \t} else {\n \t\tif (yych <= '9') {\n-\t\t\tif (yych <= '.') goto yy531;\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tgoto yy533;\n+\t\t\tif (yych <= '.') goto yy471;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tgoto yy473;\n \t\t} else {\n-\t\t\tif (yych == 'I') goto yy564;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == 'I') goto yy504;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy477:\n-\tyyaccept = 10;\n+yy417:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ',') {\n \t\tif (yych <= '\\t') {\n-\t\t\tif (yych <= 0x08) goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= 0x08) goto yy415;\n+\t\t\tgoto yy471;\n \t\t} else {\n-\t\t\tif (yych == ' ') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == ' ') goto yy471;\n+\t\t\tgoto yy415;\n \t\t}\n \t} else {\n \t\tif (yych <= '9') {\n-\t\t\tif (yych <= '.') goto yy531;\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tgoto yy533;\n+\t\t\tif (yych <= '.') goto yy471;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tgoto yy473;\n \t\t} else {\n-\t\t\tif (yych == 'I') goto yy563;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == 'I') goto yy503;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy478:\n+yy418:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'A') goto yy556;\n+\t\tif (yych == 'A') goto yy496;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy555;\n+\t\tgoto yy495;\n \t} else {\n \t\tif (yych <= 'a') {\n \t\t\tif (yych <= '`') goto yy56;\n-\t\t\tgoto yy556;\n+\t\t\tgoto yy496;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy555;\n+\t\t\tif (yych == 'u') goto yy495;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy479:\n+yy419:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= 'L') {\n-\t\t\tif (yych == '.') goto yy484;\n+\t\t\tif (yych == '.') goto yy424;\n \t\t\tgoto yy56;\n \t\t} else {\n-\t\t\tif (yych <= 'M') goto yy485;\n-\t\t\tif (yych == 'P') goto yy549;\n+\t\t\tif (yych <= 'M') goto yy425;\n+\t\t\tif (yych == 'P') goto yy489;\n \t\t\tgoto yy56;\n \t\t}\n \t} else {\n \t\tif (yych <= 'o') {\n-\t\t\tif (yych <= 'U') goto yy548;\n-\t\t\tif (yych == 'm') goto yy485;\n+\t\t\tif (yych <= 'U') goto yy488;\n+\t\t\tif (yych == 'm') goto yy425;\n \t\t\tgoto yy56;\n \t\t} else {\n-\t\t\tif (yych <= 'p') goto yy549;\n-\t\t\tif (yych == 'u') goto yy548;\n+\t\t\tif (yych <= 'p') goto yy489;\n+\t\t\tif (yych == 'u') goto yy488;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy480:\n+yy420:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy543;\n-\tif (yych == 'c') goto yy543;\n+\tif (yych == 'C') goto yy483;\n+\tif (yych == 'c') goto yy483;\n \tgoto yy56;\n-yy481:\n+yy421:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'O') goto yy529;\n-\tif (yych == 'o') goto yy529;\n+\tif (yych == 'O') goto yy469;\n+\tif (yych == 'o') goto yy469;\n \tgoto yy56;\n-yy482:\n+yy422:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy489;\n-\tif (yych <= '9') goto yy491;\n+\tif (yych <= '5') goto yy429;\n+\tif (yych <= '9') goto yy431;\n \tgoto yy56;\n-yy483:\n+yy423:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'L') {\n \t\tif (yych != '.') goto yy56;\n \t} else {\n-\t\tif (yych <= 'M') goto yy485;\n-\t\tif (yych == 'm') goto yy485;\n+\t\tif (yych <= 'M') goto yy425;\n+\t\tif (yych == 'm') goto yy425;\n \t\tgoto yy56;\n \t}\n-yy484:\n+yy424:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy485;\n+\tif (yych == 'M') goto yy425;\n \tif (yych != 'm') goto yy56;\n-yy485:\n+yy425:\n \tyych = *++YYCURSOR;\n \tif (yych <= 0x1F) {\n-\t\tif (yych <= 0x00) goto yy487;\n-\t\tif (yych == '\\t') goto yy487;\n+\t\tif (yych <= 0x00) goto yy427;\n+\t\tif (yych == '\\t') goto yy427;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= ' ') goto yy487;\n+\t\tif (yych <= ' ') goto yy427;\n \t\tif (yych != '.') goto yy56;\n \t}\n \tyych = *++YYCURSOR;\n \tif (yych <= '\\t') {\n-\t\tif (yych <= 0x00) goto yy487;\n+\t\tif (yych <= 0x00) goto yy427;\n \t\tif (yych <= 0x08) goto yy56;\n \t} else {\n \t\tif (yych != ' ') goto yy56;\n \t}\n-yy487:\n+yy427:\n \t++YYCURSOR;\n #line 1098 \"ext\/date\/lib\/parse_date.re\"\n \t{\n@@ -9235,17 +8331,17 @@ yy487:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_TIME12;\n \t}\n-#line 9239 \"<stdout>\"\n-yy489:\n-\tyyaccept = 11;\n+#line 8335 \"<stdout>\"\n+yy429:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy492;\n+\t\tif (yych == '.') goto yy432;\n \t} else {\n-\t\tif (yych <= '9') goto yy506;\n-\t\tif (yych <= ':') goto yy492;\n+\t\tif (yych <= '9') goto yy446;\n+\t\tif (yych <= ':') goto yy432;\n \t}\n-yy490:\n+yy430:\n #line 1135 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint tz_not_found;\n@@ -9271,282 +8367,282 @@ yy490:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_TIME24_WITH_ZONE;\n \t}\n-#line 9275 \"<stdout>\"\n-yy491:\n-\tyyaccept = 11;\n+#line 8371 \"<stdout>\"\n+yy431:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy492;\n-\tif (yych != ':') goto yy490;\n-yy492:\n+\tif (yych == '.') goto yy432;\n+\tif (yych != ':') goto yy430;\n+yy432:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy493;\n-\tif (yych <= '6') goto yy494;\n-\tif (yych <= '9') goto yy495;\n+\tif (yych <= '5') goto yy433;\n+\tif (yych <= '6') goto yy434;\n+\tif (yych <= '9') goto yy435;\n \tgoto yy56;\n-yy493:\n-\tyyaccept = 11;\n+yy433:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy496;\n-\tif (yych <= '\/') goto yy490;\n-\tif (yych <= '9') goto yy499;\n-\tgoto yy490;\n-yy494:\n-\tyyaccept = 11;\n+\tif (yych == '.') goto yy436;\n+\tif (yych <= '\/') goto yy430;\n+\tif (yych <= '9') goto yy439;\n+\tgoto yy430;\n+yy434:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy496;\n-\tif (yych == '0') goto yy499;\n-\tgoto yy490;\n-yy495:\n-\tyyaccept = 11;\n+\tif (yych == '.') goto yy436;\n+\tif (yych == '0') goto yy439;\n+\tgoto yy430;\n+yy435:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych != '.') goto yy490;\n-yy496:\n+\tif (yych != '.') goto yy430;\n+yy436:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n-yy497:\n+yy437:\n \t++YYCURSOR;\n \tif (YYLIMIT <= YYCURSOR) YYFILL(1);\n \tyych = *YYCURSOR;\n-\tif (yych <= '\/') goto yy490;\n-\tif (yych <= '9') goto yy497;\n-\tgoto yy490;\n-yy499:\n-\tyyaccept = 11;\n+\tif (yych <= '\/') goto yy430;\n+\tif (yych <= '9') goto yy437;\n+\tgoto yy430;\n+yy439:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych != '\\t') goto yy490;\n+\t\t\tif (yych != '\\t') goto yy430;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy500;\n-\t\t\tif (yych == '.') goto yy496;\n-\t\t\tgoto yy490;\n+\t\t\tif (yych <= ' ') goto yy440;\n+\t\t\tif (yych == '.') goto yy436;\n+\t\t\tgoto yy430;\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'A') goto yy502;\n-\t\t\tif (yych == 'P') goto yy502;\n-\t\t\tgoto yy490;\n+\t\t\tif (yych <= 'A') goto yy442;\n+\t\t\tif (yych == 'P') goto yy442;\n+\t\t\tgoto yy430;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy502;\n-\t\t\tif (yych == 'p') goto yy502;\n-\t\t\tgoto yy490;\n+\t\t\tif (yych <= 'a') goto yy442;\n+\t\t\tif (yych == 'p') goto yy442;\n+\t\t\tgoto yy430;\n \t\t}\n \t}\n-yy500:\n+yy440:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 5) YYFILL(5);\n \tyych = *YYCURSOR;\n \tif (yych <= 'A') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy500;\n+\t\t\tif (yych == '\\t') goto yy440;\n \t\t\tgoto yy56;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy500;\n+\t\t\tif (yych <= ' ') goto yy440;\n \t\t\tif (yych <= '@') goto yy56;\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych != 'P') goto yy56;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy502;\n+\t\t\tif (yych <= 'a') goto yy442;\n \t\t\tif (yych != 'p') goto yy56;\n \t\t}\n \t}\n-yy502:\n+yy442:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'L') {\n \t\tif (yych != '.') goto yy56;\n \t} else {\n-\t\tif (yych <= 'M') goto yy504;\n-\t\tif (yych == 'm') goto yy504;\n+\t\tif (yych <= 'M') goto yy444;\n+\t\tif (yych == 'm') goto yy444;\n \t\tgoto yy56;\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy504;\n+\tif (yych == 'M') goto yy444;\n \tif (yych != 'm') goto yy56;\n-yy504:\n+yy444:\n \tyych = *++YYCURSOR;\n \tif (yych <= 0x1F) {\n-\t\tif (yych <= 0x00) goto yy487;\n-\t\tif (yych == '\\t') goto yy487;\n+\t\tif (yych <= 0x00) goto yy427;\n+\t\tif (yych == '\\t') goto yy427;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= ' ') goto yy487;\n+\t\tif (yych <= ' ') goto yy427;\n \t\tif (yych != '.') goto yy56;\n \t}\n \tyych = *++YYCURSOR;\n \tif (yych <= '\\t') {\n-\t\tif (yych <= 0x00) goto yy487;\n+\t\tif (yych <= 0x00) goto yy427;\n \t\tif (yych <= 0x08) goto yy56;\n-\t\tgoto yy487;\n+\t\tgoto yy427;\n \t} else {\n-\t\tif (yych == ' ') goto yy487;\n+\t\tif (yych == ' ') goto yy427;\n \t\tgoto yy56;\n \t}\n-yy506:\n-\tyyaccept = 11;\n+yy446:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ':') {\n \t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy507;\n-\t\t\tif (yych <= 0x1F) goto yy490;\n+\t\t\tif (yych == '\\t') goto yy447;\n+\t\t\tif (yych <= 0x1F) goto yy430;\n \t\t} else {\n-\t\t\tif (yych == '.') goto yy492;\n-\t\t\tif (yych <= '9') goto yy490;\n-\t\t\tgoto yy510;\n+\t\t\tif (yych == '.') goto yy432;\n+\t\t\tif (yych <= '9') goto yy430;\n+\t\t\tgoto yy450;\n \t\t}\n \t} else {\n \t\tif (yych <= 'P') {\n-\t\t\tif (yych == 'A') goto yy509;\n-\t\t\tif (yych <= 'O') goto yy490;\n-\t\t\tgoto yy509;\n+\t\t\tif (yych == 'A') goto yy449;\n+\t\t\tif (yych <= 'O') goto yy430;\n+\t\t\tgoto yy449;\n \t\t} else {\n \t\t\tif (yych <= 'a') {\n-\t\t\t\tif (yych <= '`') goto yy490;\n-\t\t\t\tgoto yy509;\n+\t\t\t\tif (yych <= '`') goto yy430;\n+\t\t\t\tgoto yy449;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'p') goto yy509;\n-\t\t\t\tgoto yy490;\n+\t\t\t\tif (yych == 'p') goto yy449;\n+\t\t\t\tgoto yy430;\n \t\t\t}\n \t\t}\n \t}\n-yy507:\n+yy447:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 5) YYFILL(5);\n \tyych = *YYCURSOR;\n \tif (yych <= 'A') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy507;\n+\t\t\tif (yych == '\\t') goto yy447;\n \t\t\tgoto yy56;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy507;\n+\t\t\tif (yych <= ' ') goto yy447;\n \t\t\tif (yych <= '@') goto yy56;\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych != 'P') goto yy56;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy509;\n+\t\t\tif (yych <= 'a') goto yy449;\n \t\t\tif (yych != 'p') goto yy56;\n \t\t}\n \t}\n-yy509:\n+yy449:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'L') {\n-\t\tif (yych == '.') goto yy526;\n+\t\tif (yych == '.') goto yy466;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= 'M') goto yy527;\n-\t\tif (yych == 'm') goto yy527;\n+\t\tif (yych <= 'M') goto yy467;\n+\t\tif (yych == 'm') goto yy467;\n \t\tgoto yy56;\n \t}\n-yy510:\n+yy450:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy511;\n-\tif (yych <= '6') goto yy512;\n-\tif (yych <= '9') goto yy495;\n+\tif (yych <= '5') goto yy451;\n+\tif (yych <= '6') goto yy452;\n+\tif (yych <= '9') goto yy435;\n \tgoto yy56;\n-yy511:\n-\tyyaccept = 11;\n+yy451:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy496;\n-\tif (yych <= '\/') goto yy490;\n-\tif (yych <= '9') goto yy513;\n-\tgoto yy490;\n-yy512:\n-\tyyaccept = 11;\n+\tif (yych == '.') goto yy436;\n+\tif (yych <= '\/') goto yy430;\n+\tif (yych <= '9') goto yy453;\n+\tgoto yy430;\n+yy452:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy496;\n-\tif (yych != '0') goto yy490;\n-yy513:\n-\tyyaccept = 11;\n+\tif (yych == '.') goto yy436;\n+\tif (yych != '0') goto yy430;\n+yy453:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ':') {\n \t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy500;\n-\t\t\tif (yych <= 0x1F) goto yy490;\n-\t\t\tgoto yy500;\n+\t\t\tif (yych == '\\t') goto yy440;\n+\t\t\tif (yych <= 0x1F) goto yy430;\n+\t\t\tgoto yy440;\n \t\t} else {\n-\t\t\tif (yych == '.') goto yy514;\n-\t\t\tif (yych <= '9') goto yy490;\n-\t\t\tgoto yy515;\n+\t\t\tif (yych == '.') goto yy454;\n+\t\t\tif (yych <= '9') goto yy430;\n+\t\t\tgoto yy455;\n \t\t}\n \t} else {\n \t\tif (yych <= 'P') {\n-\t\t\tif (yych == 'A') goto yy502;\n-\t\t\tif (yych <= 'O') goto yy490;\n-\t\t\tgoto yy502;\n+\t\t\tif (yych == 'A') goto yy442;\n+\t\t\tif (yych <= 'O') goto yy430;\n+\t\t\tgoto yy442;\n \t\t} else {\n \t\t\tif (yych <= 'a') {\n-\t\t\t\tif (yych <= '`') goto yy490;\n-\t\t\t\tgoto yy502;\n+\t\t\t\tif (yych <= '`') goto yy430;\n+\t\t\t\tgoto yy442;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'p') goto yy502;\n-\t\t\t\tgoto yy490;\n+\t\t\t\tif (yych == 'p') goto yy442;\n+\t\t\t\tgoto yy430;\n \t\t\t}\n \t\t}\n \t}\n-yy514:\n+yy454:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy524;\n+\tif (yych <= '9') goto yy464;\n \tgoto yy56;\n-yy515:\n+yy455:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n-yy516:\n+yy456:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 5) YYFILL(5);\n \tyych = *YYCURSOR;\n \tif (yych <= 'O') {\n \t\tif (yych <= '9') {\n \t\t\tif (yych <= '\/') goto yy56;\n-\t\t\tgoto yy516;\n+\t\t\tgoto yy456;\n \t\t} else {\n \t\t\tif (yych != 'A') goto yy56;\n \t\t}\n \t} else {\n \t\tif (yych <= 'a') {\n-\t\t\tif (yych <= 'P') goto yy518;\n+\t\t\tif (yych <= 'P') goto yy458;\n \t\t\tif (yych <= '`') goto yy56;\n \t\t} else {\n \t\t\tif (yych != 'p') goto yy56;\n \t\t}\n \t}\n-yy518:\n+yy458:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'L') {\n \t\tif (yych != '.') goto yy56;\n \t} else {\n-\t\tif (yych <= 'M') goto yy520;\n-\t\tif (yych == 'm') goto yy520;\n+\t\tif (yych <= 'M') goto yy460;\n+\t\tif (yych == 'm') goto yy460;\n \t\tgoto yy56;\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy520;\n+\tif (yych == 'M') goto yy460;\n \tif (yych != 'm') goto yy56;\n-yy520:\n+yy460:\n \tyych = *++YYCURSOR;\n \tif (yych <= 0x1F) {\n-\t\tif (yych <= 0x00) goto yy522;\n-\t\tif (yych == '\\t') goto yy522;\n+\t\tif (yych <= 0x00) goto yy462;\n+\t\tif (yych == '\\t') goto yy462;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= ' ') goto yy522;\n+\t\tif (yych <= ' ') goto yy462;\n \t\tif (yych != '.') goto yy56;\n \t}\n \tyych = *++YYCURSOR;\n \tif (yych <= '\\t') {\n-\t\tif (yych <= 0x00) goto yy522;\n+\t\tif (yych <= 0x00) goto yy462;\n \t\tif (yych <= 0x08) goto yy56;\n \t} else {\n \t\tif (yych != ' ') goto yy56;\n \t}\n-yy522:\n+yy462:\n \t++YYCURSOR;\n #line 1115 \"ext\/date\/lib\/parse_date.re\"\n \t{\n@@ -9567,101 +8663,101 @@ yy522:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_TIME24_WITH_ZONE;\n \t}\n-#line 9571 \"<stdout>\"\n-yy524:\n-\tyyaccept = 11;\n+#line 8667 \"<stdout>\"\n+yy464:\n+\tyyaccept = 10;\n \tYYMARKER = ++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 5) YYFILL(5);\n \tyych = *YYCURSOR;\n \tif (yych <= 'O') {\n \t\tif (yych <= '9') {\n-\t\t\tif (yych <= '\/') goto yy490;\n-\t\t\tgoto yy524;\n+\t\t\tif (yych <= '\/') goto yy430;\n+\t\t\tgoto yy464;\n \t\t} else {\n-\t\t\tif (yych == 'A') goto yy518;\n-\t\t\tgoto yy490;\n+\t\t\tif (yych == 'A') goto yy458;\n+\t\t\tgoto yy430;\n \t\t}\n \t} else {\n \t\tif (yych <= 'a') {\n-\t\t\tif (yych <= 'P') goto yy518;\n-\t\t\tif (yych <= '`') goto yy490;\n-\t\t\tgoto yy518;\n+\t\t\tif (yych <= 'P') goto yy458;\n+\t\t\tif (yych <= '`') goto yy430;\n+\t\t\tgoto yy458;\n \t\t} else {\n-\t\t\tif (yych == 'p') goto yy518;\n-\t\t\tgoto yy490;\n+\t\t\tif (yych == 'p') goto yy458;\n+\t\t\tgoto yy430;\n \t\t}\n \t}\n-yy526:\n+yy466:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy527;\n+\tif (yych == 'M') goto yy467;\n \tif (yych != 'm') goto yy56;\n-yy527:\n+yy467:\n \tyych = *++YYCURSOR;\n \tif (yych <= 0x1F) {\n-\t\tif (yych <= 0x00) goto yy487;\n-\t\tif (yych == '\\t') goto yy487;\n+\t\tif (yych <= 0x00) goto yy427;\n+\t\tif (yych == '\\t') goto yy427;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= ' ') goto yy487;\n+\t\tif (yych <= ' ') goto yy427;\n \t\tif (yych != '.') goto yy56;\n \t}\n \tyych = *++YYCURSOR;\n \tif (yych <= '\\t') {\n-\t\tif (yych <= 0x00) goto yy487;\n+\t\tif (yych <= 0x00) goto yy427;\n \t\tif (yych <= 0x08) goto yy56;\n-\t\tgoto yy487;\n+\t\tgoto yy427;\n \t} else {\n-\t\tif (yych == ' ') goto yy487;\n+\t\tif (yych == ' ') goto yy427;\n \t\tgoto yy56;\n \t}\n-yy529:\n+yy469:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'V') goto yy530;\n+\tif (yych == 'V') goto yy470;\n \tif (yych != 'v') goto yy56;\n-yy530:\n-\tyyaccept = 10;\n+yy470:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych != '\\t') goto yy475;\n+\t\t\tif (yych != '\\t') goto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n \t\t}\n \t} else {\n \t\tif (yych <= 'D') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'E') goto yy535;\n-\t\t\tif (yych == 'e') goto yy535;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'E') goto yy475;\n+\t\t\tif (yych == 'e') goto yy475;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy531:\n+yy471:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);\n \tyych = *YYCURSOR;\n-yy532:\n+yy472:\n \tif (yych <= ' ') {\n-\t\tif (yych == '\\t') goto yy531;\n+\t\tif (yych == '\\t') goto yy471;\n \t\tif (yych <= 0x1F) goto yy56;\n-\t\tgoto yy531;\n+\t\tgoto yy471;\n \t} else {\n \t\tif (yych <= '.') {\n \t\t\tif (yych <= ',') goto yy56;\n-\t\t\tgoto yy531;\n+\t\t\tgoto yy471;\n \t\t} else {\n \t\t\tif (yych <= '\/') goto yy56;\n \t\t\tif (yych >= ':') goto yy56;\n \t\t}\n \t}\n-yy533:\n+yy473:\n \t++YYCURSOR;\n-\tif ((yych = *YYCURSOR) <= '\/') goto yy534;\n-\tif (yych <= '9') goto yy540;\n-yy534:\n+\tif ((yych = *YYCURSOR) <= '\/') goto yy474;\n+\tif (yych <= '9') goto yy480;\n+yy474:\n #line 1297 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint length = 0;\n@@ -9676,666 +8772,666 @@ yy534:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_DATE_FULL;\n \t}\n-#line 9680 \"<stdout>\"\n-yy535:\n+#line 8776 \"<stdout>\"\n+yy475:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy536;\n+\tif (yych == 'M') goto yy476;\n \tif (yych != 'm') goto yy56;\n-yy536:\n+yy476:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy537;\n+\tif (yych == 'B') goto yy477;\n \tif (yych != 'b') goto yy56;\n-yy537:\n+yy477:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy538;\n+\tif (yych == 'E') goto yy478;\n \tif (yych != 'e') goto yy56;\n-yy538:\n+yy478:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy539;\n+\tif (yych == 'R') goto yy479;\n \tif (yych != 'r') goto yy56;\n-yy539:\n-\tyyaccept = 10;\n+yy479:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ' ') {\n-\t\tif (yych == '\\t') goto yy531;\n-\t\tif (yych <= 0x1F) goto yy475;\n-\t\tgoto yy531;\n+\t\tif (yych == '\\t') goto yy471;\n+\t\tif (yych <= 0x1F) goto yy415;\n+\t\tgoto yy471;\n \t} else {\n \t\tif (yych <= '.') {\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tgoto yy471;\n \t\t} else {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy540:\n+yy480:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy534;\n-\tif (yych >= ':') goto yy534;\n-yy541:\n+\tif (yych <= '\/') goto yy474;\n+\tif (yych >= ':') goto yy474;\n+yy481:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy534;\n-\tif (yych >= ':') goto yy534;\n+\tif (yych <= '\/') goto yy474;\n+\tif (yych >= ':') goto yy474;\n \tyych = *++YYCURSOR;\n-\tgoto yy534;\n-yy543:\n+\tgoto yy474;\n+yy483:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy544;\n+\tif (yych == 'T') goto yy484;\n \tif (yych != 't') goto yy56;\n-yy544:\n-\tyyaccept = 10;\n+yy484:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'N') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'O') goto yy545;\n-\t\t\tif (yych != 'o') goto yy475;\n+\t\t\tif (yych <= 'O') goto yy485;\n+\t\t\tif (yych != 'o') goto yy415;\n \t\t}\n \t}\n-yy545:\n+yy485:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy546;\n+\tif (yych == 'B') goto yy486;\n \tif (yych != 'b') goto yy56;\n-yy546:\n+yy486:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy547;\n+\tif (yych == 'E') goto yy487;\n \tif (yych != 'e') goto yy56;\n-yy547:\n+yy487:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy539;\n-\tif (yych == 'r') goto yy539;\n+\tif (yych == 'R') goto yy479;\n+\tif (yych == 'r') goto yy479;\n \tgoto yy56;\n-yy548:\n+yy488:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'G') goto yy552;\n-\tif (yych == 'g') goto yy552;\n+\tif (yych == 'G') goto yy492;\n+\tif (yych == 'g') goto yy492;\n \tgoto yy56;\n-yy549:\n+yy489:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy550;\n+\tif (yych == 'R') goto yy490;\n \tif (yych != 'r') goto yy56;\n-yy550:\n-\tyyaccept = 10;\n+yy490:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'H') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'I') goto yy551;\n-\t\t\tif (yych != 'i') goto yy475;\n+\t\t\tif (yych <= 'I') goto yy491;\n+\t\t\tif (yych != 'i') goto yy415;\n \t\t}\n \t}\n-yy551:\n+yy491:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'L') goto yy539;\n-\tif (yych == 'l') goto yy539;\n+\tif (yych == 'L') goto yy479;\n+\tif (yych == 'l') goto yy479;\n \tgoto yy56;\n-yy552:\n-\tyyaccept = 10;\n+yy492:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'T') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'U') goto yy553;\n-\t\t\tif (yych != 'u') goto yy475;\n+\t\t\tif (yych <= 'U') goto yy493;\n+\t\t\tif (yych != 'u') goto yy415;\n \t\t}\n \t}\n-yy553:\n+yy493:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'S') goto yy554;\n+\tif (yych == 'S') goto yy494;\n \tif (yych != 's') goto yy56;\n-yy554:\n+yy494:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy539;\n-\tif (yych == 't') goto yy539;\n+\tif (yych == 'T') goto yy479;\n+\tif (yych == 't') goto yy479;\n \tgoto yy56;\n-yy555:\n+yy495:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n-\t\tif (yych == 'L') goto yy562;\n+\t\tif (yych == 'L') goto yy502;\n \t\tif (yych <= 'M') goto yy56;\n-\t\tgoto yy561;\n+\t\tgoto yy501;\n \t} else {\n \t\tif (yych <= 'l') {\n \t\t\tif (yych <= 'k') goto yy56;\n-\t\t\tgoto yy562;\n+\t\t\tgoto yy502;\n \t\t} else {\n-\t\t\tif (yych == 'n') goto yy561;\n+\t\t\tif (yych == 'n') goto yy501;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy556:\n+yy496:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'N') goto yy557;\n+\tif (yych == 'N') goto yy497;\n \tif (yych != 'n') goto yy56;\n-yy557:\n-\tyyaccept = 10;\n+yy497:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'T') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'U') goto yy558;\n-\t\t\tif (yych != 'u') goto yy475;\n+\t\t\tif (yych <= 'U') goto yy498;\n+\t\t\tif (yych != 'u') goto yy415;\n \t\t}\n \t}\n-yy558:\n+yy498:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy559;\n+\tif (yych == 'A') goto yy499;\n \tif (yych != 'a') goto yy56;\n-yy559:\n+yy499:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy560;\n+\tif (yych == 'R') goto yy500;\n \tif (yych != 'r') goto yy56;\n-yy560:\n+yy500:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy539;\n-\tif (yych == 'y') goto yy539;\n+\tif (yych == 'Y') goto yy479;\n+\tif (yych == 'y') goto yy479;\n \tgoto yy56;\n-yy561:\n-\tyyaccept = 10;\n+yy501:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'D') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'E') goto yy539;\n-\t\t\tif (yych == 'e') goto yy539;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'E') goto yy479;\n+\t\t\tif (yych == 'e') goto yy479;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy562:\n-\tyyaccept = 10;\n+yy502:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'X') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'Y') goto yy539;\n-\t\t\tif (yych == 'y') goto yy539;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'Y') goto yy479;\n+\t\t\tif (yych == 'y') goto yy479;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy563:\n-\tyyaccept = 10;\n+yy503:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ',') {\n \t\tif (yych <= '\\t') {\n-\t\t\tif (yych <= 0x08) goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= 0x08) goto yy415;\n+\t\t\tgoto yy471;\n \t\t} else {\n-\t\t\tif (yych == ' ') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == ' ') goto yy471;\n+\t\t\tgoto yy415;\n \t\t}\n \t} else {\n \t\tif (yych <= '9') {\n-\t\t\tif (yych <= '.') goto yy531;\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tgoto yy533;\n+\t\t\tif (yych <= '.') goto yy471;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tgoto yy473;\n \t\t} else {\n-\t\t\tif (yych == 'I') goto yy539;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == 'I') goto yy479;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy564:\n-\tyyaccept = 10;\n+yy504:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ',') {\n \t\tif (yych <= '\\t') {\n-\t\t\tif (yych <= 0x08) goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= 0x08) goto yy415;\n+\t\t\tgoto yy471;\n \t\t} else {\n-\t\t\tif (yych == ' ') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == ' ') goto yy471;\n+\t\t\tgoto yy415;\n \t\t}\n \t} else {\n \t\tif (yych <= '9') {\n-\t\t\tif (yych <= '.') goto yy531;\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tgoto yy533;\n+\t\t\tif (yych <= '.') goto yy471;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tgoto yy473;\n \t\t} else {\n-\t\t\tif (yych != 'I') goto yy475;\n+\t\t\tif (yych != 'I') goto yy415;\n \t\t}\n \t}\n-\tyyaccept = 10;\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ',') {\n \t\tif (yych <= '\\t') {\n-\t\t\tif (yych <= 0x08) goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= 0x08) goto yy415;\n+\t\t\tgoto yy471;\n \t\t} else {\n-\t\t\tif (yych == ' ') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == ' ') goto yy471;\n+\t\t\tgoto yy415;\n \t\t}\n \t} else {\n \t\tif (yych <= '9') {\n-\t\t\tif (yych <= '.') goto yy531;\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tgoto yy533;\n+\t\t\tif (yych <= '.') goto yy471;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tgoto yy473;\n \t\t} else {\n-\t\t\tif (yych == 'I') goto yy539;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == 'I') goto yy479;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy566:\n-\tyyaccept = 10;\n+yy506:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ',') {\n \t\tif (yych <= '\\t') {\n-\t\t\tif (yych <= 0x08) goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= 0x08) goto yy415;\n+\t\t\tgoto yy471;\n \t\t} else {\n-\t\t\tif (yych == ' ') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == ' ') goto yy471;\n+\t\t\tgoto yy415;\n \t\t}\n \t} else {\n \t\tif (yych <= '9') {\n-\t\t\tif (yych <= '.') goto yy531;\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tgoto yy533;\n+\t\t\tif (yych <= '.') goto yy471;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tgoto yy473;\n \t\t} else {\n-\t\t\tif (yych == 'I') goto yy539;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == 'I') goto yy479;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy567:\n-\tyyaccept = 11;\n+yy507:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n-\t\tif (yych <= ',') goto yy490;\n-\t\tif (yych <= '-') goto yy601;\n-\t\tgoto yy600;\n+\t\tif (yych <= ',') goto yy430;\n+\t\tif (yych <= '-') goto yy541;\n+\t\tgoto yy540;\n \t} else {\n-\t\tif (yych <= '\/') goto yy490;\n-\t\tif (yych <= '9') goto yy614;\n-\t\tif (yych <= ':') goto yy492;\n-\t\tgoto yy490;\n+\t\tif (yych <= '\/') goto yy430;\n+\t\tif (yych <= '9') goto yy554;\n+\t\tif (yych <= ':') goto yy432;\n+\t\tgoto yy430;\n \t}\n-yy568:\n-\tyyaccept = 11;\n+yy508:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n-\t\tif (yych <= ',') goto yy490;\n-\t\tif (yych <= '-') goto yy601;\n-\t\tif (yych <= '.') goto yy600;\n-\t\tgoto yy490;\n+\t\tif (yych <= ',') goto yy430;\n+\t\tif (yych <= '-') goto yy541;\n+\t\tif (yych <= '.') goto yy540;\n+\t\tgoto yy430;\n \t} else {\n-\t\tif (yych <= '2') goto yy614;\n-\t\tif (yych <= '9') goto yy613;\n-\t\tif (yych <= ':') goto yy492;\n-\t\tgoto yy490;\n+\t\tif (yych <= '2') goto yy554;\n+\t\tif (yych <= '9') goto yy553;\n+\t\tif (yych <= ':') goto yy432;\n+\t\tgoto yy430;\n \t}\n-yy569:\n-\tyyaccept = 11;\n+yy509:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n-\t\tif (yych <= ',') goto yy490;\n-\t\tif (yych <= '-') goto yy601;\n-\t\tgoto yy600;\n+\t\tif (yych <= ',') goto yy430;\n+\t\tif (yych <= '-') goto yy541;\n+\t\tgoto yy540;\n \t} else {\n-\t\tif (yych <= '\/') goto yy490;\n-\t\tif (yych <= '9') goto yy613;\n-\t\tif (yych <= ':') goto yy492;\n-\t\tgoto yy490;\n+\t\tif (yych <= '\/') goto yy430;\n+\t\tif (yych <= '9') goto yy553;\n+\t\tif (yych <= ':') goto yy432;\n+\t\tgoto yy430;\n \t}\n-yy570:\n-\tyyaccept = 11;\n+yy510:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n-\t\tif (yych <= ',') goto yy490;\n-\t\tif (yych <= '-') goto yy601;\n-\t\tgoto yy600;\n+\t\tif (yych <= ',') goto yy430;\n+\t\tif (yych <= '-') goto yy541;\n+\t\tgoto yy540;\n \t} else {\n-\t\tif (yych == ':') goto yy492;\n-\t\tgoto yy490;\n+\t\tif (yych == ':') goto yy432;\n+\t\tgoto yy430;\n \t}\n-yy571:\n+yy511:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy594;\n-\tif (yych == 'e') goto yy594;\n+\tif (yych == 'E') goto yy534;\n+\tif (yych == 'e') goto yy534;\n \tgoto yy56;\n-yy572:\n+yy512:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy591;\n-\tif (yych == 'a') goto yy591;\n+\tif (yych == 'A') goto yy531;\n+\tif (yych == 'a') goto yy531;\n \tgoto yy56;\n-yy573:\n+yy513:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'P') goto yy549;\n+\t\tif (yych == 'P') goto yy489;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy548;\n+\t\tgoto yy488;\n \t} else {\n \t\tif (yych <= 'p') {\n \t\t\tif (yych <= 'o') goto yy56;\n-\t\t\tgoto yy549;\n+\t\t\tgoto yy489;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy548;\n+\t\t\tif (yych == 'u') goto yy488;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy574:\n+yy514:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy584;\n-\tif (yych == 'e') goto yy584;\n+\tif (yych == 'E') goto yy524;\n+\tif (yych == 'e') goto yy524;\n \tgoto yy56;\n-yy575:\n+yy515:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy578;\n-\tif (yych == 'e') goto yy578;\n+\tif (yych == 'E') goto yy518;\n+\tif (yych == 'e') goto yy518;\n \tgoto yy56;\n-yy576:\n+yy516:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 13) YYFILL(13);\n \tyych = *YYCURSOR;\n-yy577:\n+yy517:\n \tswitch (yych) {\n \tcase '\\t':\n \tcase ' ':\n \tcase '-':\n-\tcase '.':\tgoto yy576;\n+\tcase '.':\tgoto yy516;\n \tcase 'A':\n-\tcase 'a':\tgoto yy573;\n+\tcase 'a':\tgoto yy513;\n \tcase 'D':\n-\tcase 'd':\tgoto yy575;\n+\tcase 'd':\tgoto yy515;\n \tcase 'F':\n-\tcase 'f':\tgoto yy571;\n-\tcase 'I':\tgoto yy474;\n+\tcase 'f':\tgoto yy511;\n+\tcase 'I':\tgoto yy414;\n \tcase 'J':\n-\tcase 'j':\tgoto yy478;\n+\tcase 'j':\tgoto yy418;\n \tcase 'M':\n-\tcase 'm':\tgoto yy572;\n+\tcase 'm':\tgoto yy512;\n \tcase 'N':\n-\tcase 'n':\tgoto yy481;\n+\tcase 'n':\tgoto yy421;\n \tcase 'O':\n-\tcase 'o':\tgoto yy480;\n+\tcase 'o':\tgoto yy420;\n \tcase 'S':\n-\tcase 's':\tgoto yy574;\n-\tcase 'V':\tgoto yy476;\n-\tcase 'X':\tgoto yy477;\n+\tcase 's':\tgoto yy514;\n+\tcase 'V':\tgoto yy416;\n+\tcase 'X':\tgoto yy417;\n \tdefault:\tgoto yy56;\n \t}\n-yy578:\n+yy518:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy579;\n+\tif (yych == 'C') goto yy519;\n \tif (yych != 'c') goto yy56;\n-yy579:\n-\tyyaccept = 10;\n+yy519:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'D') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'E') goto yy580;\n-\t\t\tif (yych != 'e') goto yy475;\n+\t\t\tif (yych <= 'E') goto yy520;\n+\t\t\tif (yych != 'e') goto yy415;\n \t\t}\n \t}\n-yy580:\n+yy520:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy581;\n+\tif (yych == 'M') goto yy521;\n \tif (yych != 'm') goto yy56;\n-yy581:\n+yy521:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy582;\n+\tif (yych == 'B') goto yy522;\n \tif (yych != 'b') goto yy56;\n-yy582:\n+yy522:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy583;\n+\tif (yych == 'E') goto yy523;\n \tif (yych != 'e') goto yy56;\n-yy583:\n+yy523:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy539;\n-\tif (yych == 'r') goto yy539;\n+\tif (yych == 'R') goto yy479;\n+\tif (yych == 'r') goto yy479;\n \tgoto yy56;\n-yy584:\n+yy524:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'P') goto yy585;\n+\tif (yych == 'P') goto yy525;\n \tif (yych != 'p') goto yy56;\n-yy585:\n-\tyyaccept = 10;\n+yy525:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'S') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'T') goto yy586;\n-\t\t\tif (yych != 't') goto yy475;\n+\t\t\tif (yych <= 'T') goto yy526;\n+\t\t\tif (yych != 't') goto yy415;\n \t\t}\n \t}\n-yy586:\n-\tyyaccept = 10;\n+yy526:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'D') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'E') goto yy587;\n-\t\t\tif (yych != 'e') goto yy475;\n+\t\t\tif (yych <= 'E') goto yy527;\n+\t\t\tif (yych != 'e') goto yy415;\n \t\t}\n \t}\n-yy587:\n+yy527:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy588;\n+\tif (yych == 'M') goto yy528;\n \tif (yych != 'm') goto yy56;\n-yy588:\n+yy528:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy589;\n+\tif (yych == 'B') goto yy529;\n \tif (yych != 'b') goto yy56;\n-yy589:\n+yy529:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy590;\n+\tif (yych == 'E') goto yy530;\n \tif (yych != 'e') goto yy56;\n-yy590:\n+yy530:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy539;\n-\tif (yych == 'r') goto yy539;\n+\tif (yych == 'R') goto yy479;\n+\tif (yych == 'r') goto yy479;\n \tgoto yy56;\n-yy591:\n+yy531:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'Y') {\n-\t\tif (yych == 'R') goto yy592;\n+\t\tif (yych == 'R') goto yy532;\n \t\tif (yych <= 'X') goto yy56;\n-\t\tgoto yy539;\n+\t\tgoto yy479;\n \t} else {\n \t\tif (yych <= 'r') {\n \t\t\tif (yych <= 'q') goto yy56;\n \t\t} else {\n-\t\t\tif (yych == 'y') goto yy539;\n+\t\t\tif (yych == 'y') goto yy479;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy592:\n-\tyyaccept = 10;\n+yy532:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'B') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'C') goto yy593;\n-\t\t\tif (yych != 'c') goto yy475;\n+\t\t\tif (yych <= 'C') goto yy533;\n+\t\t\tif (yych != 'c') goto yy415;\n \t\t}\n \t}\n-yy593:\n+yy533:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'H') goto yy539;\n-\tif (yych == 'h') goto yy539;\n+\tif (yych == 'H') goto yy479;\n+\tif (yych == 'h') goto yy479;\n \tgoto yy56;\n-yy594:\n+yy534:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy595;\n+\tif (yych == 'B') goto yy535;\n \tif (yych != 'b') goto yy56;\n-yy595:\n-\tyyaccept = 10;\n+yy535:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'Q') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'R') goto yy596;\n-\t\t\tif (yych != 'r') goto yy475;\n+\t\t\tif (yych <= 'R') goto yy536;\n+\t\t\tif (yych != 'r') goto yy415;\n \t\t}\n \t}\n-yy596:\n+yy536:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'U') goto yy597;\n+\tif (yych == 'U') goto yy537;\n \tif (yych != 'u') goto yy56;\n-yy597:\n+yy537:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy598;\n+\tif (yych == 'A') goto yy538;\n \tif (yych != 'a') goto yy56;\n-yy598:\n+yy538:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy599;\n+\tif (yych == 'R') goto yy539;\n \tif (yych != 'r') goto yy56;\n-yy599:\n+yy539:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy539;\n-\tif (yych == 'y') goto yy539;\n+\tif (yych == 'Y') goto yy479;\n+\tif (yych == 'y') goto yy479;\n \tgoto yy56;\n-yy600:\n+yy540:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy607;\n-\tif (yych <= '6') goto yy608;\n-\tif (yych <= '9') goto yy609;\n+\tif (yych <= '5') goto yy547;\n+\tif (yych <= '6') goto yy548;\n+\tif (yych <= '9') goto yy549;\n \tgoto yy56;\n-yy601:\n+yy541:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n-yy603:\n+yy543:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n-yy604:\n+yy544:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n@@ -10351,37 +9447,37 @@ yy604:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_DATE_FULL_POINTED;\n \t}\n-#line 10355 \"<stdout>\"\n-yy607:\n-\tyyaccept = 11;\n+#line 9451 \"<stdout>\"\n+yy547:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy496;\n-\tif (yych <= '\/') goto yy490;\n-\tif (yych <= '9') goto yy612;\n-\tgoto yy490;\n-yy608:\n-\tyyaccept = 11;\n+\tif (yych == '.') goto yy436;\n+\tif (yych <= '\/') goto yy430;\n+\tif (yych <= '9') goto yy552;\n+\tgoto yy430;\n+yy548:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy496;\n-\t\tgoto yy490;\n+\t\tif (yych == '.') goto yy436;\n+\t\tgoto yy430;\n \t} else {\n-\t\tif (yych <= '0') goto yy612;\n-\t\tif (yych <= '9') goto yy610;\n-\t\tgoto yy490;\n+\t\tif (yych <= '0') goto yy552;\n+\t\tif (yych <= '9') goto yy550;\n+\t\tgoto yy430;\n \t}\n-yy609:\n-\tyyaccept = 11;\n+yy549:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy496;\n-\tif (yych <= '\/') goto yy490;\n-\tif (yych >= ':') goto yy490;\n-yy610:\n-\tyyaccept = 12;\n+\tif (yych == '.') goto yy436;\n+\tif (yych <= '\/') goto yy430;\n+\tif (yych >= ':') goto yy430;\n+yy550:\n+\tyyaccept = 11;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') goto yy611;\n-\tif (yych <= '9') goto yy604;\n-yy611:\n+\tif (yych <= '\/') goto yy551;\n+\tif (yych <= '9') goto yy544;\n+yy551:\n #line 1324 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint length = 0;\n@@ -10395,602 +9491,602 @@ yy611:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_DATE_FULL_POINTED;\n \t}\n-#line 10399 \"<stdout>\"\n-yy612:\n-\tyyaccept = 11;\n+#line 9495 \"<stdout>\"\n+yy552:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n \t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy500;\n-\t\t\tif (yych <= 0x1F) goto yy490;\n-\t\t\tgoto yy500;\n+\t\t\tif (yych == '\\t') goto yy440;\n+\t\t\tif (yych <= 0x1F) goto yy430;\n+\t\t\tgoto yy440;\n \t\t} else {\n-\t\t\tif (yych == '.') goto yy496;\n-\t\t\tif (yych <= '\/') goto yy490;\n-\t\t\tgoto yy604;\n+\t\t\tif (yych == '.') goto yy436;\n+\t\t\tif (yych <= '\/') goto yy430;\n+\t\t\tgoto yy544;\n \t\t}\n \t} else {\n \t\tif (yych <= 'P') {\n-\t\t\tif (yych == 'A') goto yy502;\n-\t\t\tif (yych <= 'O') goto yy490;\n-\t\t\tgoto yy502;\n+\t\t\tif (yych == 'A') goto yy442;\n+\t\t\tif (yych <= 'O') goto yy430;\n+\t\t\tgoto yy442;\n \t\t} else {\n \t\t\tif (yych <= 'a') {\n-\t\t\t\tif (yych <= '`') goto yy490;\n-\t\t\t\tgoto yy502;\n+\t\t\t\tif (yych <= '`') goto yy430;\n+\t\t\t\tgoto yy442;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'p') goto yy502;\n-\t\t\t\tgoto yy490;\n+\t\t\t\tif (yych == 'p') goto yy442;\n+\t\t\t\tgoto yy430;\n \t\t\t}\n \t\t}\n \t}\n-yy613:\n-\tyyaccept = 11;\n+yy553:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ':') {\n \t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy507;\n-\t\t\tif (yych <= 0x1F) goto yy490;\n-\t\t\tgoto yy507;\n+\t\t\tif (yych == '\\t') goto yy447;\n+\t\t\tif (yych <= 0x1F) goto yy430;\n+\t\t\tgoto yy447;\n \t\t} else {\n-\t\t\tif (yych == '.') goto yy492;\n-\t\t\tif (yych <= '9') goto yy490;\n-\t\t\tgoto yy492;\n+\t\t\tif (yych == '.') goto yy432;\n+\t\t\tif (yych <= '9') goto yy430;\n+\t\t\tgoto yy432;\n \t\t}\n \t} else {\n \t\tif (yych <= 'P') {\n-\t\t\tif (yych == 'A') goto yy509;\n-\t\t\tif (yych <= 'O') goto yy490;\n-\t\t\tgoto yy509;\n+\t\t\tif (yych == 'A') goto yy449;\n+\t\t\tif (yych <= 'O') goto yy430;\n+\t\t\tgoto yy449;\n \t\t} else {\n \t\t\tif (yych <= 'a') {\n-\t\t\t\tif (yych <= '`') goto yy490;\n-\t\t\t\tgoto yy509;\n+\t\t\t\tif (yych <= '`') goto yy430;\n+\t\t\t\tgoto yy449;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'p') goto yy509;\n-\t\t\t\tgoto yy490;\n+\t\t\t\tif (yych == 'p') goto yy449;\n+\t\t\t\tgoto yy430;\n \t\t\t}\n \t\t}\n \t}\n-yy614:\n-\tyyaccept = 11;\n+yy554:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ':') {\n \t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy507;\n-\t\t\tif (yych <= 0x1F) goto yy490;\n-\t\t\tgoto yy507;\n+\t\t\tif (yych == '\\t') goto yy447;\n+\t\t\tif (yych <= 0x1F) goto yy430;\n+\t\t\tgoto yy447;\n \t\t} else {\n \t\t\tif (yych <= '-') {\n-\t\t\t\tif (yych <= ',') goto yy490;\n-\t\t\t\tgoto yy601;\n+\t\t\t\tif (yych <= ',') goto yy430;\n+\t\t\t\tgoto yy541;\n \t\t\t} else {\n-\t\t\t\tif (yych <= '.') goto yy600;\n-\t\t\t\tif (yych <= '9') goto yy490;\n-\t\t\t\tgoto yy492;\n+\t\t\t\tif (yych <= '.') goto yy540;\n+\t\t\t\tif (yych <= '9') goto yy430;\n+\t\t\t\tgoto yy432;\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= 'P') {\n-\t\t\tif (yych == 'A') goto yy509;\n-\t\t\tif (yych <= 'O') goto yy490;\n-\t\t\tgoto yy509;\n+\t\t\tif (yych == 'A') goto yy449;\n+\t\t\tif (yych <= 'O') goto yy430;\n+\t\t\tgoto yy449;\n \t\t} else {\n \t\t\tif (yych <= 'a') {\n-\t\t\t\tif (yych <= '`') goto yy490;\n-\t\t\t\tgoto yy509;\n+\t\t\t\tif (yych <= '`') goto yy430;\n+\t\t\t\tgoto yy449;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'p') goto yy509;\n-\t\t\t\tgoto yy490;\n+\t\t\t\tif (yych == 'p') goto yy449;\n+\t\t\t\tgoto yy430;\n \t\t\t}\n \t\t}\n \t}\n-yy615:\n+yy555:\n \tyych = *++YYCURSOR;\n \tif (yych <= '.') {\n \t\tif (yych <= ',') goto yy56;\n-\t\tif (yych <= '-') goto yy654;\n-\t\tgoto yy601;\n+\t\tif (yych <= '-') goto yy594;\n+\t\tgoto yy541;\n \t} else {\n \t\tif (yych <= '\/') goto yy56;\n-\t\tif (yych <= '9') goto yy617;\n+\t\tif (yych <= '9') goto yy557;\n \t\tgoto yy56;\n \t}\n-yy616:\n+yy556:\n \tyych = *++YYCURSOR;\n \tif (yych <= '.') {\n \t\tif (yych <= ',') goto yy56;\n-\t\tif (yych <= '-') goto yy654;\n-\t\tgoto yy601;\n+\t\tif (yych <= '-') goto yy594;\n+\t\tgoto yy541;\n \t} else {\n \t\tif (yych <= '\/') goto yy56;\n \t\tif (yych >= '3') goto yy56;\n \t}\n-yy617:\n+yy557:\n \tyych = *++YYCURSOR;\n \tif (yych <= ',') goto yy56;\n-\tif (yych <= '-') goto yy654;\n-\tif (yych <= '.') goto yy601;\n+\tif (yych <= '-') goto yy594;\n+\tif (yych <= '.') goto yy541;\n \tgoto yy56;\n-yy618:\n+yy558:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'A') goto yy650;\n+\t\tif (yych == 'A') goto yy590;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy649;\n+\t\tgoto yy589;\n \t} else {\n \t\tif (yych <= 'a') {\n \t\t\tif (yych <= '`') goto yy56;\n-\t\t\tgoto yy650;\n+\t\t\tgoto yy590;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy649;\n+\t\t\tif (yych == 'u') goto yy589;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy619:\n+yy559:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy647;\n-\tif (yych == 'e') goto yy647;\n+\tif (yych == 'E') goto yy587;\n+\tif (yych == 'e') goto yy587;\n \tgoto yy56;\n-yy620:\n+yy560:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy644;\n-\tif (yych == 'a') goto yy644;\n+\tif (yych == 'A') goto yy584;\n+\tif (yych == 'a') goto yy584;\n \tgoto yy56;\n-yy621:\n+yy561:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'P') goto yy641;\n+\t\tif (yych == 'P') goto yy581;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy640;\n+\t\tgoto yy580;\n \t} else {\n \t\tif (yych <= 'p') {\n \t\t\tif (yych <= 'o') goto yy56;\n-\t\t\tgoto yy641;\n+\t\t\tgoto yy581;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy640;\n+\t\t\tif (yych == 'u') goto yy580;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy622:\n+yy562:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy637;\n-\tif (yych == 'e') goto yy637;\n+\tif (yych == 'E') goto yy577;\n+\tif (yych == 'e') goto yy577;\n \tgoto yy56;\n-yy623:\n+yy563:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy635;\n-\tif (yych == 'c') goto yy635;\n+\tif (yych == 'C') goto yy575;\n+\tif (yych == 'c') goto yy575;\n \tgoto yy56;\n-yy624:\n+yy564:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'O') goto yy633;\n-\tif (yych == 'o') goto yy633;\n+\tif (yych == 'O') goto yy573;\n+\tif (yych == 'o') goto yy573;\n \tgoto yy56;\n-yy625:\n+yy565:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy626;\n+\tif (yych == 'E') goto yy566;\n \tif (yych != 'e') goto yy56;\n-yy626:\n+yy566:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy627;\n+\tif (yych == 'C') goto yy567;\n \tif (yych != 'c') goto yy56;\n-yy627:\n-\tyyaccept = 10;\n+yy567:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych >= '.') goto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych >= '.') goto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'D') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n-\t\t} else {\n-\t\t\tif (yych <= 'E') goto yy580;\n-\t\t\tif (yych == 'e') goto yy580;\n-\t\t\tgoto yy475;\n-\t\t}\n-\t}\n-yy628:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy532;\n-\tif (yych <= '0') goto yy629;\n-\tif (yych <= '2') goto yy630;\n-\tif (yych <= '3') goto yy631;\n-\tgoto yy532;\n-yy629:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy534;\n-\tif (yych <= '9') goto yy632;\n-\tgoto yy534;\n-yy630:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy534;\n-\tif (yych <= '9') goto yy632;\n-\tgoto yy534;\n-yy631:\n-\tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy534;\n-\tif (yych <= '1') goto yy632;\n-\tif (yych <= '9') goto yy540;\n-\tgoto yy534;\n-yy632:\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n+\t\t} else {\n+\t\t\tif (yych <= 'E') goto yy520;\n+\t\t\tif (yych == 'e') goto yy520;\n+\t\t\tgoto yy415;\n+\t\t}\n+\t}\n+yy568:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy534;\n-\tif (yych <= '9') goto yy541;\n-\tgoto yy534;\n-yy633:\n+\tif (yych <= '\/') goto yy472;\n+\tif (yych <= '0') goto yy569;\n+\tif (yych <= '2') goto yy570;\n+\tif (yych <= '3') goto yy571;\n+\tgoto yy472;\n+yy569:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '\/') goto yy474;\n+\tif (yych <= '9') goto yy572;\n+\tgoto yy474;\n+yy570:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '\/') goto yy474;\n+\tif (yych <= '9') goto yy572;\n+\tgoto yy474;\n+yy571:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '\/') goto yy474;\n+\tif (yych <= '1') goto yy572;\n+\tif (yych <= '9') goto yy480;\n+\tgoto yy474;\n+yy572:\n+\tyych = *++YYCURSOR;\n+\tif (yych <= '\/') goto yy474;\n+\tif (yych <= '9') goto yy481;\n+\tgoto yy474;\n+yy573:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'V') goto yy634;\n+\tif (yych == 'V') goto yy574;\n \tif (yych != 'v') goto yy56;\n-yy634:\n-\tyyaccept = 10;\n+yy574:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych <= '-') goto yy628;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych <= '-') goto yy568;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'D') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'E') goto yy535;\n-\t\t\tif (yych == 'e') goto yy535;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'E') goto yy475;\n+\t\t\tif (yych == 'e') goto yy475;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy635:\n+yy575:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy636;\n+\tif (yych == 'T') goto yy576;\n \tif (yych != 't') goto yy56;\n-yy636:\n-\tyyaccept = 10;\n+yy576:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych <= '-') goto yy628;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych <= '-') goto yy568;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'N') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'O') goto yy545;\n-\t\t\tif (yych == 'o') goto yy545;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'O') goto yy485;\n+\t\t\tif (yych == 'o') goto yy485;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy637:\n+yy577:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'P') goto yy638;\n+\tif (yych == 'P') goto yy578;\n \tif (yych != 'p') goto yy56;\n-yy638:\n-\tyyaccept = 10;\n+yy578:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych <= '-') goto yy628;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych <= '-') goto yy568;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'S') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'T') goto yy639;\n-\t\t\tif (yych != 't') goto yy475;\n+\t\t\tif (yych <= 'T') goto yy579;\n+\t\t\tif (yych != 't') goto yy415;\n \t\t}\n \t}\n-yy639:\n-\tyyaccept = 10;\n+yy579:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych <= '-') goto yy628;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych <= '-') goto yy568;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'D') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'E') goto yy587;\n-\t\t\tif (yych == 'e') goto yy587;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'E') goto yy527;\n+\t\t\tif (yych == 'e') goto yy527;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy640:\n+yy580:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'G') goto yy643;\n-\tif (yych == 'g') goto yy643;\n+\tif (yych == 'G') goto yy583;\n+\tif (yych == 'g') goto yy583;\n \tgoto yy56;\n-yy641:\n+yy581:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy642;\n+\tif (yych == 'R') goto yy582;\n \tif (yych != 'r') goto yy56;\n-yy642:\n-\tyyaccept = 10;\n+yy582:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych <= '-') goto yy628;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych <= '-') goto yy568;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'H') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'I') goto yy551;\n-\t\t\tif (yych == 'i') goto yy551;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'I') goto yy491;\n+\t\t\tif (yych == 'i') goto yy491;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy643:\n-\tyyaccept = 10;\n+yy583:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych <= '-') goto yy628;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych <= '-') goto yy568;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'T') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'U') goto yy553;\n-\t\t\tif (yych == 'u') goto yy553;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'U') goto yy493;\n+\t\t\tif (yych == 'u') goto yy493;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy644:\n+yy584:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'Y') {\n-\t\tif (yych == 'R') goto yy645;\n+\t\tif (yych == 'R') goto yy585;\n \t\tif (yych <= 'X') goto yy56;\n-\t\tgoto yy646;\n+\t\tgoto yy586;\n \t} else {\n \t\tif (yych <= 'r') {\n \t\t\tif (yych <= 'q') goto yy56;\n \t\t} else {\n-\t\t\tif (yych == 'y') goto yy646;\n+\t\t\tif (yych == 'y') goto yy586;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy645:\n-\tyyaccept = 10;\n+yy585:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych <= '-') goto yy628;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych <= '-') goto yy568;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'B') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'C') goto yy593;\n-\t\t\tif (yych == 'c') goto yy593;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'C') goto yy533;\n+\t\t\tif (yych == 'c') goto yy533;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy646:\n-\tyyaccept = 10;\n+yy586:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ',') {\n \t\tif (yych <= '\\t') {\n-\t\t\tif (yych <= 0x08) goto yy475;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= 0x08) goto yy415;\n+\t\t\tgoto yy471;\n \t\t} else {\n-\t\t\tif (yych == ' ') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == ' ') goto yy471;\n+\t\t\tgoto yy415;\n \t\t}\n \t} else {\n \t\tif (yych <= '.') {\n-\t\t\tif (yych <= '-') goto yy628;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= '-') goto yy568;\n+\t\t\tgoto yy471;\n \t\t} else {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy647:\n+yy587:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy648;\n+\tif (yych == 'B') goto yy588;\n \tif (yych != 'b') goto yy56;\n-yy648:\n-\tyyaccept = 10;\n+yy588:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych <= '-') goto yy628;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych <= '-') goto yy568;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'Q') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'R') goto yy596;\n-\t\t\tif (yych == 'r') goto yy596;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'R') goto yy536;\n+\t\t\tif (yych == 'r') goto yy536;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy649:\n+yy589:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n-\t\tif (yych == 'L') goto yy653;\n+\t\tif (yych == 'L') goto yy593;\n \t\tif (yych <= 'M') goto yy56;\n-\t\tgoto yy652;\n+\t\tgoto yy592;\n \t} else {\n \t\tif (yych <= 'l') {\n \t\t\tif (yych <= 'k') goto yy56;\n-\t\t\tgoto yy653;\n+\t\t\tgoto yy593;\n \t\t} else {\n-\t\t\tif (yych == 'n') goto yy652;\n+\t\t\tif (yych == 'n') goto yy592;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy650:\n+yy590:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'N') goto yy651;\n+\tif (yych == 'N') goto yy591;\n \tif (yych != 'n') goto yy56;\n-yy651:\n-\tyyaccept = 10;\n+yy591:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych <= '-') goto yy628;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych <= '-') goto yy568;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'T') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'U') goto yy558;\n-\t\t\tif (yych == 'u') goto yy558;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'U') goto yy498;\n+\t\t\tif (yych == 'u') goto yy498;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy652:\n-\tyyaccept = 10;\n+yy592:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych <= '-') goto yy628;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych <= '-') goto yy568;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'D') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'E') goto yy539;\n-\t\t\tif (yych == 'e') goto yy539;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'E') goto yy479;\n+\t\t\tif (yych == 'e') goto yy479;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy653:\n-\tyyaccept = 10;\n+yy593:\n+\tyyaccept = 9;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy531;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych == '\\t') goto yy471;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy531;\n-\t\t\tif (yych <= ',') goto yy475;\n-\t\t\tif (yych <= '-') goto yy628;\n-\t\t\tgoto yy531;\n+\t\t\tif (yych <= ' ') goto yy471;\n+\t\t\tif (yych <= ',') goto yy415;\n+\t\t\tif (yych <= '-') goto yy568;\n+\t\t\tgoto yy471;\n \t\t}\n \t} else {\n \t\tif (yych <= 'X') {\n-\t\t\tif (yych <= '\/') goto yy475;\n-\t\t\tif (yych <= '9') goto yy533;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= '\/') goto yy415;\n+\t\t\tif (yych <= '9') goto yy473;\n+\t\t\tgoto yy415;\n \t\t} else {\n-\t\t\tif (yych <= 'Y') goto yy539;\n-\t\t\tif (yych == 'y') goto yy539;\n-\t\t\tgoto yy475;\n+\t\t\tif (yych <= 'Y') goto yy479;\n+\t\t\tif (yych == 'y') goto yy479;\n+\t\t\tgoto yy415;\n \t\t}\n \t}\n-yy654:\n+yy594:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '2') goto yy655;\n-\tif (yych <= '3') goto yy657;\n-\tif (yych <= '9') goto yy658;\n+\tif (yych <= '2') goto yy595;\n+\tif (yych <= '3') goto yy597;\n+\tif (yych <= '9') goto yy598;\n \tgoto yy56;\n-yy655:\n-\tyyaccept = 13;\n+yy595:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy656;\n-\t\tif (yych <= '9') goto yy664;\n-\t\tif (yych >= 'n') goto yy660;\n+\t\tif (yych <= '\/') goto yy596;\n+\t\tif (yych <= '9') goto yy604;\n+\t\tif (yych >= 'n') goto yy600;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych >= 'r') goto yy661;\n+\t\t\tif (yych >= 'r') goto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n \t\t}\n \t}\n-yy656:\n+yy596:\n #line 1283 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint length = 0;\n@@ -11004,102 +10100,102 @@ yy656:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_ISO_DATE;\n \t}\n-#line 11008 \"<stdout>\"\n-yy657:\n-\tyyaccept = 13;\n+#line 10104 \"<stdout>\"\n+yy597:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n \t\tif (yych <= '1') {\n-\t\t\tif (yych <= '\/') goto yy656;\n-\t\t\tgoto yy664;\n+\t\t\tif (yych <= '\/') goto yy596;\n+\t\t\tgoto yy604;\n \t\t} else {\n-\t\t\tif (yych <= '9') goto yy603;\n-\t\t\tif (yych <= 'm') goto yy656;\n-\t\t\tgoto yy660;\n+\t\t\tif (yych <= '9') goto yy543;\n+\t\t\tif (yych <= 'm') goto yy596;\n+\t\t\tgoto yy600;\n \t\t}\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy661;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy658:\n-\tyyaccept = 13;\n+yy598:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy656;\n-\t\tif (yych <= '9') goto yy603;\n-\t\tif (yych <= 'm') goto yy656;\n-\t\tgoto yy660;\n+\t\tif (yych <= '\/') goto yy596;\n+\t\tif (yych <= '9') goto yy543;\n+\t\tif (yych <= 'm') goto yy596;\n+\t\tgoto yy600;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy661;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy659:\n+yy599:\n \tyych = *++YYCURSOR;\n-\tif (yych == 't') goto yy663;\n+\tif (yych == 't') goto yy603;\n \tgoto yy56;\n-yy660:\n+yy600:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'd') goto yy663;\n+\tif (yych == 'd') goto yy603;\n \tgoto yy56;\n-yy661:\n+yy601:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'd') goto yy663;\n+\tif (yych == 'd') goto yy603;\n \tgoto yy56;\n-yy662:\n+yy602:\n \tyych = *++YYCURSOR;\n \tif (yych != 'h') goto yy56;\n-yy663:\n+yy603:\n \tyych = *++YYCURSOR;\n-\tgoto yy656;\n-yy664:\n-\tyyaccept = 13;\n+\tgoto yy596;\n+yy604:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy656;\n-\t\tif (yych <= '9') goto yy604;\n-\t\tif (yych <= 'm') goto yy656;\n-\t\tgoto yy660;\n+\t\tif (yych <= '\/') goto yy596;\n+\t\tif (yych <= '9') goto yy544;\n+\t\tif (yych <= 'm') goto yy596;\n+\t\tgoto yy600;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy661;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy665:\n-\tyyaccept = 14;\n+yy605:\n+\tyyaccept = 13;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n \t\tif (yych <= '\/') {\n-\t\t\tif (yych >= '\/') goto yy722;\n+\t\t\tif (yych >= '\/') goto yy662;\n \t\t} else {\n-\t\t\tif (yych <= '9') goto yy668;\n-\t\t\tif (yych >= 'n') goto yy719;\n+\t\t\tif (yych <= '9') goto yy608;\n+\t\t\tif (yych >= 'n') goto yy659;\n \t\t}\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych >= 'r') goto yy720;\n+\t\t\tif (yych >= 'r') goto yy660;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy718;\n-\t\t\tif (yych <= 't') goto yy721;\n+\t\t\tif (yych <= 's') goto yy658;\n+\t\t\tif (yych <= 't') goto yy661;\n \t\t}\n \t}\n-yy666:\n+yy606:\n #line 1227 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint length = 0;\n@@ -11115,113 +10211,113 @@ yy666:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_AMERICAN;\n \t}\n-#line 11119 \"<stdout>\"\n-yy667:\n-\tyyaccept = 14;\n+#line 10215 \"<stdout>\"\n+yy607:\n+\tyyaccept = 13;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n \t\tif (yych <= '\/') {\n-\t\t\tif (yych <= '.') goto yy666;\n-\t\t\tgoto yy722;\n+\t\t\tif (yych <= '.') goto yy606;\n+\t\t\tgoto yy662;\n \t\t} else {\n-\t\t\tif (yych <= '1') goto yy668;\n-\t\t\tif (yych <= 'm') goto yy666;\n-\t\t\tgoto yy719;\n+\t\t\tif (yych <= '1') goto yy608;\n+\t\t\tif (yych <= 'm') goto yy606;\n+\t\t\tgoto yy659;\n \t\t}\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy666;\n-\t\t\tgoto yy720;\n+\t\t\tif (yych <= 'q') goto yy606;\n+\t\t\tgoto yy660;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy718;\n-\t\t\tif (yych <= 't') goto yy721;\n-\t\t\tgoto yy666;\n+\t\t\tif (yych <= 's') goto yy658;\n+\t\t\tif (yych <= 't') goto yy661;\n+\t\t\tgoto yy606;\n \t\t}\n \t}\n-yy668:\n-\tyyaccept = 14;\n+yy608:\n+\tyyaccept = 13;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych == '\/') goto yy722;\n-\t\tif (yych <= 'm') goto yy666;\n-\t\tgoto yy719;\n+\t\tif (yych == '\/') goto yy662;\n+\t\tif (yych <= 'm') goto yy606;\n+\t\tgoto yy659;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy666;\n-\t\t\tgoto yy720;\n+\t\t\tif (yych <= 'q') goto yy606;\n+\t\t\tgoto yy660;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy718;\n-\t\t\tif (yych <= 't') goto yy721;\n-\t\t\tgoto yy666;\n+\t\t\tif (yych <= 's') goto yy658;\n+\t\t\tif (yych <= 't') goto yy661;\n+\t\t\tgoto yy606;\n \t\t}\n \t}\n-yy669:\n+yy609:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'A') goto yy717;\n+\t\tif (yych == 'A') goto yy657;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy716;\n+\t\tgoto yy656;\n \t} else {\n \t\tif (yych <= 'a') {\n \t\t\tif (yych <= '`') goto yy56;\n-\t\t\tgoto yy717;\n+\t\t\tgoto yy657;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy716;\n+\t\t\tif (yych == 'u') goto yy656;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy670:\n+yy610:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy715;\n-\tif (yych == 'e') goto yy715;\n+\tif (yych == 'E') goto yy655;\n+\tif (yych == 'e') goto yy655;\n \tgoto yy56;\n-yy671:\n+yy611:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy714;\n-\tif (yych == 'a') goto yy714;\n+\tif (yych == 'A') goto yy654;\n+\tif (yych == 'a') goto yy654;\n \tgoto yy56;\n-yy672:\n+yy612:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'P') goto yy713;\n+\t\tif (yych == 'P') goto yy653;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy712;\n+\t\tgoto yy652;\n \t} else {\n \t\tif (yych <= 'p') {\n \t\t\tif (yych <= 'o') goto yy56;\n-\t\t\tgoto yy713;\n+\t\t\tgoto yy653;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy712;\n+\t\t\tif (yych == 'u') goto yy652;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy673:\n+yy613:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy710;\n-\tif (yych == 'e') goto yy710;\n+\tif (yych == 'E') goto yy650;\n+\tif (yych == 'e') goto yy650;\n \tgoto yy56;\n-yy674:\n+yy614:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy709;\n-\tif (yych == 'c') goto yy709;\n+\tif (yych == 'C') goto yy649;\n+\tif (yych == 'c') goto yy649;\n \tgoto yy56;\n-yy675:\n+yy615:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'O') goto yy708;\n-\tif (yych == 'o') goto yy708;\n+\tif (yych == 'O') goto yy648;\n+\tif (yych == 'o') goto yy648;\n \tgoto yy56;\n-yy676:\n+yy616:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy677;\n+\tif (yych == 'E') goto yy617;\n \tif (yych != 'e') goto yy56;\n-yy677:\n+yy617:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy678;\n+\tif (yych == 'C') goto yy618;\n \tif (yych != 'c') goto yy56;\n-yy678:\n+yy618:\n \tyych = *++YYCURSOR;\n \tif (yych != '\/') goto yy56;\n-yy679:\n+yy619:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n@@ -11238,19 +10334,19 @@ yy679:\n \tif (yych != ':') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '1') goto yy685;\n-\tif (yych <= '2') goto yy686;\n+\tif (yych <= '1') goto yy625;\n+\tif (yych <= '2') goto yy626;\n \tgoto yy56;\n-yy685:\n+yy625:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy687;\n+\tif (yych <= '9') goto yy627;\n \tgoto yy56;\n-yy686:\n+yy626:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= '5') goto yy56;\n-yy687:\n+yy627:\n \tyych = *++YYCURSOR;\n \tif (yych != ':') goto yy56;\n \tyych = *++YYCURSOR;\n@@ -11263,57 +10359,57 @@ yy687:\n \tif (yych != ':') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy692;\n-\tif (yych <= '6') goto yy693;\n+\tif (yych <= '5') goto yy632;\n+\tif (yych <= '6') goto yy633;\n \tgoto yy56;\n-yy692:\n+yy632:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy694;\n+\tif (yych <= '9') goto yy634;\n \tgoto yy56;\n-yy693:\n+yy633:\n \tyych = *++YYCURSOR;\n \tif (yych != '0') goto yy56;\n-yy694:\n+yy634:\n \tyych = *++YYCURSOR;\n-\tif (yych == '\\t') goto yy695;\n+\tif (yych == '\\t') goto yy635;\n \tif (yych != ' ') goto yy56;\n-yy695:\n+yy635:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 9) YYFILL(9);\n \tyych = *YYCURSOR;\n \tif (yych <= '*') {\n \t\tif (yych <= '\\t') {\n \t\t\tif (yych <= 0x08) goto yy56;\n-\t\t\tgoto yy695;\n+\t\t\tgoto yy635;\n \t\t} else {\n-\t\t\tif (yych == ' ') goto yy695;\n+\t\t\tif (yych == ' ') goto yy635;\n \t\t\tgoto yy56;\n \t\t}\n \t} else {\n \t\tif (yych <= '-') {\n \t\t\tif (yych == ',') goto yy56;\n-\t\t\tgoto yy698;\n+\t\t\tgoto yy638;\n \t\t} else {\n \t\t\tif (yych != 'G') goto yy56;\n \t\t}\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy706;\n+\tif (yych == 'M') goto yy646;\n \tgoto yy56;\n-yy698:\n+yy638:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '1') goto yy699;\n-\tif (yych <= '2') goto yy701;\n-\tif (yych <= '9') goto yy702;\n+\tif (yych <= '1') goto yy639;\n+\tif (yych <= '2') goto yy641;\n+\tif (yych <= '9') goto yy642;\n \tgoto yy56;\n-yy699:\n+yy639:\n \t++YYCURSOR;\n-\tif ((yych = *YYCURSOR) <= '\/') goto yy700;\n-\tif (yych <= '9') goto yy702;\n-\tif (yych <= ':') goto yy703;\n-yy700:\n+\tif ((yych = *YYCURSOR) <= '\/') goto yy640;\n+\tif (yych <= '9') goto yy642;\n+\tif (yych <= ':') goto yy643;\n+yy640:\n #line 1510 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint tz_not_found;\n@@ -11334,261 +10430,261 @@ yy700:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_CLF;\n \t}\n-#line 11338 \"<stdout>\"\n-yy701:\n+#line 10434 \"<stdout>\"\n+yy641:\n \tyych = *++YYCURSOR;\n \tif (yych <= '5') {\n-\t\tif (yych <= '\/') goto yy700;\n-\t\tif (yych >= '5') goto yy704;\n+\t\tif (yych <= '\/') goto yy640;\n+\t\tif (yych >= '5') goto yy644;\n \t} else {\n-\t\tif (yych <= '9') goto yy705;\n-\t\tif (yych <= ':') goto yy703;\n-\t\tgoto yy700;\n+\t\tif (yych <= '9') goto yy645;\n+\t\tif (yych <= ':') goto yy643;\n+\t\tgoto yy640;\n \t}\n-yy702:\n+yy642:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy700;\n-\tif (yych <= '5') goto yy704;\n-\tif (yych <= '9') goto yy705;\n-\tif (yych >= ';') goto yy700;\n-yy703:\n+\tif (yych <= '\/') goto yy640;\n+\tif (yych <= '5') goto yy644;\n+\tif (yych <= '9') goto yy645;\n+\tif (yych >= ';') goto yy640;\n+yy643:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy700;\n-\tif (yych <= '5') goto yy704;\n-\tif (yych <= '9') goto yy705;\n-\tgoto yy700;\n-yy704:\n+\tif (yych <= '\/') goto yy640;\n+\tif (yych <= '5') goto yy644;\n+\tif (yych <= '9') goto yy645;\n+\tgoto yy640;\n+yy644:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy700;\n-\tif (yych >= ':') goto yy700;\n-yy705:\n+\tif (yych <= '\/') goto yy640;\n+\tif (yych >= ':') goto yy640;\n+yy645:\n \tyych = *++YYCURSOR;\n-\tgoto yy700;\n-yy706:\n+\tgoto yy640;\n+yy646:\n \tyych = *++YYCURSOR;\n \tif (yych != 'T') goto yy56;\n \tyych = *++YYCURSOR;\n-\tif (yych == '+') goto yy698;\n-\tif (yych == '-') goto yy698;\n+\tif (yych == '+') goto yy638;\n+\tif (yych == '-') goto yy638;\n \tgoto yy56;\n-yy708:\n+yy648:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'V') goto yy678;\n-\tif (yych == 'v') goto yy678;\n+\tif (yych == 'V') goto yy618;\n+\tif (yych == 'v') goto yy618;\n \tgoto yy56;\n-yy709:\n+yy649:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy678;\n-\tif (yych == 't') goto yy678;\n+\tif (yych == 'T') goto yy618;\n+\tif (yych == 't') goto yy618;\n \tgoto yy56;\n-yy710:\n+yy650:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'P') goto yy711;\n+\tif (yych == 'P') goto yy651;\n \tif (yych != 'p') goto yy56;\n-yy711:\n+yy651:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'S') {\n-\t\tif (yych == '\/') goto yy679;\n+\t\tif (yych == '\/') goto yy619;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= 'T') goto yy678;\n-\t\tif (yych == 't') goto yy678;\n+\t\tif (yych <= 'T') goto yy618;\n+\t\tif (yych == 't') goto yy618;\n \t\tgoto yy56;\n \t}\n-yy712:\n+yy652:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'G') goto yy678;\n-\tif (yych == 'g') goto yy678;\n+\tif (yych == 'G') goto yy618;\n+\tif (yych == 'g') goto yy618;\n \tgoto yy56;\n-yy713:\n+yy653:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy678;\n-\tif (yych == 'r') goto yy678;\n+\tif (yych == 'R') goto yy618;\n+\tif (yych == 'r') goto yy618;\n \tgoto yy56;\n-yy714:\n+yy654:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'Y') {\n-\t\tif (yych == 'R') goto yy678;\n+\t\tif (yych == 'R') goto yy618;\n \t\tif (yych <= 'X') goto yy56;\n-\t\tgoto yy678;\n+\t\tgoto yy618;\n \t} else {\n \t\tif (yych <= 'r') {\n \t\t\tif (yych <= 'q') goto yy56;\n-\t\t\tgoto yy678;\n+\t\t\tgoto yy618;\n \t\t} else {\n-\t\t\tif (yych == 'y') goto yy678;\n+\t\t\tif (yych == 'y') goto yy618;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy715:\n+yy655:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy678;\n-\tif (yych == 'b') goto yy678;\n+\tif (yych == 'B') goto yy618;\n+\tif (yych == 'b') goto yy618;\n \tgoto yy56;\n-yy716:\n+yy656:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n-\t\tif (yych == 'L') goto yy678;\n+\t\tif (yych == 'L') goto yy618;\n \t\tif (yych <= 'M') goto yy56;\n-\t\tgoto yy678;\n+\t\tgoto yy618;\n \t} else {\n \t\tif (yych <= 'l') {\n \t\t\tif (yych <= 'k') goto yy56;\n-\t\t\tgoto yy678;\n+\t\t\tgoto yy618;\n \t\t} else {\n-\t\t\tif (yych == 'n') goto yy678;\n+\t\t\tif (yych == 'n') goto yy618;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy717:\n+yy657:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'N') goto yy678;\n-\tif (yych == 'n') goto yy678;\n+\tif (yych == 'N') goto yy618;\n+\tif (yych == 'n') goto yy618;\n \tgoto yy56;\n-yy718:\n+yy658:\n \tyych = *++YYCURSOR;\n-\tif (yych == 't') goto yy727;\n+\tif (yych == 't') goto yy667;\n \tgoto yy56;\n-yy719:\n+yy659:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'd') goto yy727;\n+\tif (yych == 'd') goto yy667;\n \tgoto yy56;\n-yy720:\n+yy660:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'd') goto yy727;\n+\tif (yych == 'd') goto yy667;\n \tgoto yy56;\n-yy721:\n+yy661:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'h') goto yy727;\n+\tif (yych == 'h') goto yy667;\n \tgoto yy56;\n-yy722:\n+yy662:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy666;\n-\tif (yych >= ':') goto yy666;\n+\tif (yych <= '\/') goto yy606;\n+\tif (yych >= ':') goto yy606;\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy666;\n-\tif (yych >= ':') goto yy666;\n+\tif (yych <= '\/') goto yy606;\n+\tif (yych >= ':') goto yy606;\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy666;\n-\tif (yych >= ':') goto yy666;\n+\tif (yych <= '\/') goto yy606;\n+\tif (yych >= ':') goto yy606;\n \tyych = *++YYCURSOR;\n-\tgoto yy666;\n-yy727:\n-\tyyaccept = 14;\n+\tgoto yy606;\n+yy667:\n+\tyyaccept = 13;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '\/') goto yy722;\n-\tgoto yy666;\n-yy728:\n+\tif (yych == '\/') goto yy662;\n+\tgoto yy606;\n+yy668:\n \tyych = *++YYCURSOR;\n \tif (yych <= ',') {\n-\t\tif (yych == '\\t') goto yy730;\n-\t\tgoto yy577;\n+\t\tif (yych == '\\t') goto yy670;\n+\t\tgoto yy517;\n \t} else {\n-\t\tif (yych <= '-') goto yy731;\n-\t\tif (yych <= '.') goto yy730;\n-\t\tif (yych >= '0') goto yy577;\n+\t\tif (yych <= '-') goto yy671;\n+\t\tif (yych <= '.') goto yy670;\n+\t\tif (yych >= '0') goto yy517;\n \t}\n-yy729:\n+yy669:\n \tyych = *++YYCURSOR;\n \tswitch (yych) {\n \tcase 'A':\n-\tcase 'a':\tgoto yy672;\n+\tcase 'a':\tgoto yy612;\n \tcase 'D':\n-\tcase 'd':\tgoto yy676;\n+\tcase 'd':\tgoto yy616;\n \tcase 'F':\n-\tcase 'f':\tgoto yy670;\n+\tcase 'f':\tgoto yy610;\n \tcase 'J':\n-\tcase 'j':\tgoto yy669;\n+\tcase 'j':\tgoto yy609;\n \tcase 'M':\n-\tcase 'm':\tgoto yy671;\n+\tcase 'm':\tgoto yy611;\n \tcase 'N':\n-\tcase 'n':\tgoto yy675;\n+\tcase 'n':\tgoto yy615;\n \tcase 'O':\n-\tcase 'o':\tgoto yy674;\n+\tcase 'o':\tgoto yy614;\n \tcase 'S':\n-\tcase 's':\tgoto yy673;\n+\tcase 's':\tgoto yy613;\n \tdefault:\tgoto yy56;\n \t}\n-yy730:\n+yy670:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy577;\n-\tif (yych <= '0') goto yy735;\n-\tif (yych <= '1') goto yy736;\n-\tif (yych <= '9') goto yy737;\n-\tgoto yy577;\n-yy731:\n+\tif (yych <= '\/') goto yy517;\n+\tif (yych <= '0') goto yy675;\n+\tif (yych <= '1') goto yy676;\n+\tif (yych <= '9') goto yy677;\n+\tgoto yy517;\n+yy671:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy577;\n-\tif (yych <= '0') goto yy732;\n-\tif (yych <= '1') goto yy733;\n-\tif (yych <= '9') goto yy734;\n-\tgoto yy577;\n-yy732:\n+\tif (yych <= '\/') goto yy517;\n+\tif (yych <= '0') goto yy672;\n+\tif (yych <= '1') goto yy673;\n+\tif (yych <= '9') goto yy674;\n+\tgoto yy517;\n+yy672:\n \tyych = *++YYCURSOR;\n \tif (yych <= ',') goto yy56;\n-\tif (yych <= '.') goto yy601;\n+\tif (yych <= '.') goto yy541;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy734;\n+\tif (yych <= '9') goto yy674;\n \tgoto yy56;\n-yy733:\n+yy673:\n \tyych = *++YYCURSOR;\n \tif (yych <= ',') goto yy56;\n-\tif (yych <= '.') goto yy601;\n+\tif (yych <= '.') goto yy541;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= '3') goto yy56;\n-yy734:\n+yy674:\n \tyych = *++YYCURSOR;\n \tif (yych <= ',') goto yy56;\n-\tif (yych <= '.') goto yy601;\n+\tif (yych <= '.') goto yy541;\n \tgoto yy56;\n-yy735:\n+yy675:\n \tyych = *++YYCURSOR;\n \tif (yych <= '.') {\n \t\tif (yych <= ',') goto yy56;\n-\t\tif (yych <= '-') goto yy601;\n-\t\tgoto yy738;\n+\t\tif (yych <= '-') goto yy541;\n+\t\tgoto yy678;\n \t} else {\n \t\tif (yych <= '\/') goto yy56;\n-\t\tif (yych <= '9') goto yy737;\n+\t\tif (yych <= '9') goto yy677;\n \t\tgoto yy56;\n \t}\n-yy736:\n+yy676:\n \tyych = *++YYCURSOR;\n \tif (yych <= '.') {\n \t\tif (yych <= ',') goto yy56;\n-\t\tif (yych <= '-') goto yy601;\n-\t\tgoto yy738;\n+\t\tif (yych <= '-') goto yy541;\n+\t\tgoto yy678;\n \t} else {\n \t\tif (yych <= '\/') goto yy56;\n \t\tif (yych >= '3') goto yy56;\n \t}\n-yy737:\n+yy677:\n \tyych = *++YYCURSOR;\n \tif (yych <= ',') goto yy56;\n-\tif (yych <= '-') goto yy601;\n+\tif (yych <= '-') goto yy541;\n \tif (yych >= '\/') goto yy56;\n-yy738:\n+yy678:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy610;\n+\tif (yych <= '9') goto yy550;\n \tgoto yy56;\n-yy740:\n+yy680:\n \tyych = *++YYCURSOR;\n-\tif (yych == '-') goto yy784;\n+\tif (yych == '-') goto yy724;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '9') goto yy782;\n+\tif (yych <= '9') goto yy722;\n \tgoto yy60;\n-yy741:\n+yy681:\n \tyych = *++YYCURSOR;\n \tswitch (yych) {\n-\tcase '0':\tgoto yy750;\n-\tcase '1':\tgoto yy751;\n+\tcase '0':\tgoto yy690;\n+\tcase '1':\tgoto yy691;\n \tcase '2':\n \tcase '3':\n \tcase '4':\n@@ -11596,231 +10692,231 @@ yy741:\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy752;\n+\tcase '9':\tgoto yy692;\n \tcase 'A':\n-\tcase 'a':\tgoto yy745;\n+\tcase 'a':\tgoto yy685;\n \tcase 'D':\n-\tcase 'd':\tgoto yy749;\n+\tcase 'd':\tgoto yy689;\n \tcase 'F':\n-\tcase 'f':\tgoto yy743;\n+\tcase 'f':\tgoto yy683;\n \tcase 'J':\n-\tcase 'j':\tgoto yy742;\n+\tcase 'j':\tgoto yy682;\n \tcase 'M':\n-\tcase 'm':\tgoto yy744;\n+\tcase 'm':\tgoto yy684;\n \tcase 'N':\n-\tcase 'n':\tgoto yy748;\n+\tcase 'n':\tgoto yy688;\n \tcase 'O':\n-\tcase 'o':\tgoto yy747;\n+\tcase 'o':\tgoto yy687;\n \tcase 'S':\n-\tcase 's':\tgoto yy746;\n+\tcase 's':\tgoto yy686;\n \tdefault:\tgoto yy56;\n \t}\n-yy742:\n+yy682:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'A') goto yy781;\n+\t\tif (yych == 'A') goto yy721;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy780;\n+\t\tgoto yy720;\n \t} else {\n \t\tif (yych <= 'a') {\n \t\t\tif (yych <= '`') goto yy56;\n-\t\t\tgoto yy781;\n+\t\t\tgoto yy721;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy780;\n+\t\t\tif (yych == 'u') goto yy720;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy743:\n+yy683:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy779;\n-\tif (yych == 'e') goto yy779;\n+\tif (yych == 'E') goto yy719;\n+\tif (yych == 'e') goto yy719;\n \tgoto yy56;\n-yy744:\n+yy684:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy778;\n-\tif (yych == 'a') goto yy778;\n+\tif (yych == 'A') goto yy718;\n+\tif (yych == 'a') goto yy718;\n \tgoto yy56;\n-yy745:\n+yy685:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'P') goto yy777;\n+\t\tif (yych == 'P') goto yy717;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy776;\n+\t\tgoto yy716;\n \t} else {\n \t\tif (yych <= 'p') {\n \t\t\tif (yych <= 'o') goto yy56;\n-\t\t\tgoto yy777;\n+\t\t\tgoto yy717;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy776;\n+\t\t\tif (yych == 'u') goto yy716;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy746:\n+yy686:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy774;\n-\tif (yych == 'e') goto yy774;\n+\tif (yych == 'E') goto yy714;\n+\tif (yych == 'e') goto yy714;\n \tgoto yy56;\n-yy747:\n+yy687:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy773;\n-\tif (yych == 'c') goto yy773;\n+\tif (yych == 'C') goto yy713;\n+\tif (yych == 'c') goto yy713;\n \tgoto yy56;\n-yy748:\n+yy688:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'O') goto yy772;\n-\tif (yych == 'o') goto yy772;\n+\tif (yych == 'O') goto yy712;\n+\tif (yych == 'o') goto yy712;\n \tgoto yy56;\n-yy749:\n+yy689:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy764;\n-\tif (yych == 'e') goto yy764;\n+\tif (yych == 'E') goto yy704;\n+\tif (yych == 'e') goto yy704;\n \tgoto yy56;\n-yy750:\n+yy690:\n \tyych = *++YYCURSOR;\n-\tif (yych == '-') goto yy753;\n+\tif (yych == '-') goto yy693;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy757;\n+\tif (yych <= '9') goto yy697;\n \tgoto yy56;\n-yy751:\n+yy691:\n \tyych = *++YYCURSOR;\n-\tif (yych == '-') goto yy753;\n+\tif (yych == '-') goto yy693;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '2') goto yy757;\n+\tif (yych <= '2') goto yy697;\n \tgoto yy56;\n-yy752:\n+yy692:\n \tyych = *++YYCURSOR;\n \tif (yych != '-') goto yy56;\n-yy753:\n+yy693:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '2') goto yy754;\n-\tif (yych <= '3') goto yy755;\n-\tif (yych <= '9') goto yy756;\n+\tif (yych <= '2') goto yy694;\n+\tif (yych <= '3') goto yy695;\n+\tif (yych <= '9') goto yy696;\n \tgoto yy56;\n-yy754:\n-\tyyaccept = 13;\n+yy694:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy656;\n-\t\tif (yych <= '9') goto yy756;\n-\t\tif (yych <= 'm') goto yy656;\n-\t\tgoto yy660;\n+\t\tif (yych <= '\/') goto yy596;\n+\t\tif (yych <= '9') goto yy696;\n+\t\tif (yych <= 'm') goto yy596;\n+\t\tgoto yy600;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy661;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy755:\n-\tyyaccept = 13;\n+yy695:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy656;\n-\t\tif (yych <= '1') goto yy756;\n-\t\tif (yych <= 'm') goto yy656;\n-\t\tgoto yy660;\n+\t\tif (yych <= '\/') goto yy596;\n+\t\tif (yych <= '1') goto yy696;\n+\t\tif (yych <= 'm') goto yy596;\n+\t\tgoto yy600;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy661;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy756:\n-\tyyaccept = 13;\n+yy696:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'q') {\n-\t\tif (yych == 'n') goto yy660;\n-\t\tgoto yy656;\n+\t\tif (yych == 'n') goto yy600;\n+\t\tgoto yy596;\n \t} else {\n-\t\tif (yych <= 'r') goto yy661;\n-\t\tif (yych <= 's') goto yy659;\n-\t\tif (yych <= 't') goto yy662;\n-\t\tgoto yy656;\n+\t\tif (yych <= 'r') goto yy601;\n+\t\tif (yych <= 's') goto yy599;\n+\t\tif (yych <= 't') goto yy602;\n+\t\tgoto yy596;\n \t}\n-yy757:\n+yy697:\n \tyych = *++YYCURSOR;\n \tif (yych != '-') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '2') {\n \t\tif (yych <= '\/') goto yy56;\n-\t\tif (yych >= '1') goto yy760;\n+\t\tif (yych >= '1') goto yy700;\n \t} else {\n-\t\tif (yych <= '3') goto yy761;\n-\t\tif (yych <= '9') goto yy756;\n+\t\tif (yych <= '3') goto yy701;\n+\t\tif (yych <= '9') goto yy696;\n \t\tgoto yy56;\n \t}\n-\tyyaccept = 13;\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy656;\n-\t\tif (yych <= '9') goto yy762;\n-\t\tif (yych <= 'm') goto yy656;\n-\t\tgoto yy660;\n+\t\tif (yych <= '\/') goto yy596;\n+\t\tif (yych <= '9') goto yy702;\n+\t\tif (yych <= 'm') goto yy596;\n+\t\tgoto yy600;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy661;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy760:\n-\tyyaccept = 13;\n+yy700:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy656;\n-\t\tif (yych <= '9') goto yy762;\n-\t\tif (yych <= 'm') goto yy656;\n-\t\tgoto yy660;\n+\t\tif (yych <= '\/') goto yy596;\n+\t\tif (yych <= '9') goto yy702;\n+\t\tif (yych <= 'm') goto yy596;\n+\t\tgoto yy600;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy661;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy761:\n-\tyyaccept = 13;\n+yy701:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy656;\n-\t\tif (yych <= '1') goto yy762;\n-\t\tif (yych <= 'm') goto yy656;\n-\t\tgoto yy660;\n+\t\tif (yych <= '\/') goto yy596;\n+\t\tif (yych <= '1') goto yy702;\n+\t\tif (yych <= 'm') goto yy596;\n+\t\tgoto yy600;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy661;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy762:\n-\tyyaccept = 15;\n+yy702:\n+\tyyaccept = 14;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'q') {\n-\t\tif (yych == 'n') goto yy660;\n+\t\tif (yych == 'n') goto yy600;\n \t} else {\n-\t\tif (yych <= 'r') goto yy661;\n-\t\tif (yych <= 's') goto yy659;\n-\t\tif (yych <= 't') goto yy662;\n+\t\tif (yych <= 'r') goto yy601;\n+\t\tif (yych <= 's') goto yy599;\n+\t\tif (yych <= 't') goto yy602;\n \t}\n-yy763:\n+yy703:\n #line 1255 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint length = 0;\n@@ -11834,36 +10930,36 @@ yy763:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_ISO_DATE;\n \t}\n-#line 11838 \"<stdout>\"\n-yy764:\n+#line 10934 \"<stdout>\"\n+yy704:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy765;\n+\tif (yych == 'C') goto yy705;\n \tif (yych != 'c') goto yy56;\n-yy765:\n+yy705:\n \tyych = *++YYCURSOR;\n \tif (yych != '-') goto yy56;\n-yy766:\n+yy706:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '0') goto yy767;\n-\tif (yych <= '2') goto yy768;\n-\tif (yych <= '3') goto yy769;\n+\tif (yych <= '0') goto yy707;\n+\tif (yych <= '2') goto yy708;\n+\tif (yych <= '3') goto yy709;\n \tgoto yy56;\n-yy767:\n+yy707:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy770;\n+\tif (yych <= '9') goto yy710;\n \tgoto yy56;\n-yy768:\n+yy708:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy770;\n+\tif (yych <= '9') goto yy710;\n \tgoto yy56;\n-yy769:\n+yy709:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= '2') goto yy56;\n-yy770:\n+yy710:\n \t++YYCURSOR;\n #line 1496 \"ext\/date\/lib\/parse_date.re\"\n \t{\n@@ -11878,83 +10974,83 @@ yy770:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_PG_TEXT;\n \t}\n-#line 11882 \"<stdout>\"\n-yy772:\n+#line 10978 \"<stdout>\"\n+yy712:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'V') goto yy765;\n-\tif (yych == 'v') goto yy765;\n+\tif (yych == 'V') goto yy705;\n+\tif (yych == 'v') goto yy705;\n \tgoto yy56;\n-yy773:\n+yy713:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy765;\n-\tif (yych == 't') goto yy765;\n+\tif (yych == 'T') goto yy705;\n+\tif (yych == 't') goto yy705;\n \tgoto yy56;\n-yy774:\n+yy714:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'P') goto yy775;\n+\tif (yych == 'P') goto yy715;\n \tif (yych != 'p') goto yy56;\n-yy775:\n+yy715:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'S') {\n-\t\tif (yych == '-') goto yy766;\n+\t\tif (yych == '-') goto yy706;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= 'T') goto yy765;\n-\t\tif (yych == 't') goto yy765;\n+\t\tif (yych <= 'T') goto yy705;\n+\t\tif (yych == 't') goto yy705;\n \t\tgoto yy56;\n \t}\n-yy776:\n+yy716:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'G') goto yy765;\n-\tif (yych == 'g') goto yy765;\n+\tif (yych == 'G') goto yy705;\n+\tif (yych == 'g') goto yy705;\n \tgoto yy56;\n-yy777:\n+yy717:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy765;\n-\tif (yych == 'r') goto yy765;\n+\tif (yych == 'R') goto yy705;\n+\tif (yych == 'r') goto yy705;\n \tgoto yy56;\n-yy778:\n+yy718:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'Y') {\n-\t\tif (yych == 'R') goto yy765;\n+\t\tif (yych == 'R') goto yy705;\n \t\tif (yych <= 'X') goto yy56;\n-\t\tgoto yy765;\n+\t\tgoto yy705;\n \t} else {\n \t\tif (yych <= 'r') {\n \t\t\tif (yych <= 'q') goto yy56;\n-\t\t\tgoto yy765;\n+\t\t\tgoto yy705;\n \t\t} else {\n-\t\t\tif (yych == 'y') goto yy765;\n+\t\t\tif (yych == 'y') goto yy705;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy779:\n+yy719:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy765;\n-\tif (yych == 'b') goto yy765;\n+\tif (yych == 'B') goto yy705;\n+\tif (yych == 'b') goto yy705;\n \tgoto yy56;\n-yy780:\n+yy720:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n-\t\tif (yych == 'L') goto yy765;\n+\t\tif (yych == 'L') goto yy705;\n \t\tif (yych <= 'M') goto yy56;\n-\t\tgoto yy765;\n+\t\tgoto yy705;\n \t} else {\n \t\tif (yych <= 'l') {\n \t\t\tif (yych <= 'k') goto yy56;\n-\t\t\tgoto yy765;\n+\t\t\tgoto yy705;\n \t\t} else {\n-\t\t\tif (yych == 'n') goto yy765;\n+\t\t\tif (yych == 'n') goto yy705;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy781:\n+yy721:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'N') goto yy765;\n-\tif (yych == 'n') goto yy765;\n+\tif (yych == 'N') goto yy705;\n+\tif (yych == 'n') goto yy705;\n \tgoto yy56;\n-yy782:\n-\tyyaccept = 16;\n+yy722:\n+\tyyaccept = 15;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tswitch (yych) {\n \tcase '\\t':\n@@ -11984,25 +11080,25 @@ yy782:\n \tcase 's':\n \tcase 't':\n \tcase 'w':\n-\tcase 'y':\tgoto yy790;\n-\tcase '-':\tgoto yy787;\n-\tcase '.':\tgoto yy791;\n-\tcase '\/':\tgoto yy788;\n-\tcase '0':\tgoto yy804;\n-\tcase '1':\tgoto yy805;\n-\tcase '2':\tgoto yy807;\n-\tcase '3':\tgoto yy808;\n+\tcase 'y':\tgoto yy730;\n+\tcase '-':\tgoto yy727;\n+\tcase '.':\tgoto yy731;\n+\tcase '\/':\tgoto yy728;\n+\tcase '0':\tgoto yy744;\n+\tcase '1':\tgoto yy745;\n+\tcase '2':\tgoto yy747;\n+\tcase '3':\tgoto yy748;\n \tcase '4':\n \tcase '5':\n \tcase '6':\n \tcase '7':\n \tcase '8':\n \tcase '9':\tgoto yy54;\n-\tcase ':':\tgoto yy806;\n-\tcase 'W':\tgoto yy809;\n-\tdefault:\tgoto yy783;\n+\tcase ':':\tgoto yy746;\n+\tcase 'W':\tgoto yy749;\n+\tdefault:\tgoto yy723;\n \t}\n-yy783:\n+yy723:\n #line 1531 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tDEBUG_OUTPUT(\"year4\");\n@@ -12011,12 +11107,12 @@ yy783:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_CLF;\n \t}\n-#line 12015 \"<stdout>\"\n-yy784:\n+#line 11111 \"<stdout>\"\n+yy724:\n \tyych = *++YYCURSOR;\n \tswitch (yych) {\n-\tcase '0':\tgoto yy785;\n-\tcase '1':\tgoto yy786;\n+\tcase '0':\tgoto yy725;\n+\tcase '1':\tgoto yy726;\n \tcase '2':\n \tcase '3':\n \tcase '4':\n@@ -12024,42 +11120,42 @@ yy784:\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy752;\n+\tcase '9':\tgoto yy692;\n \tcase 'A':\n-\tcase 'a':\tgoto yy745;\n+\tcase 'a':\tgoto yy685;\n \tcase 'D':\n-\tcase 'd':\tgoto yy749;\n+\tcase 'd':\tgoto yy689;\n \tcase 'F':\n-\tcase 'f':\tgoto yy743;\n+\tcase 'f':\tgoto yy683;\n \tcase 'J':\n-\tcase 'j':\tgoto yy742;\n+\tcase 'j':\tgoto yy682;\n \tcase 'M':\n-\tcase 'm':\tgoto yy744;\n+\tcase 'm':\tgoto yy684;\n \tcase 'N':\n-\tcase 'n':\tgoto yy748;\n+\tcase 'n':\tgoto yy688;\n \tcase 'O':\n-\tcase 'o':\tgoto yy747;\n+\tcase 'o':\tgoto yy687;\n \tcase 'S':\n-\tcase 's':\tgoto yy746;\n+\tcase 's':\tgoto yy686;\n \tdefault:\tgoto yy56;\n \t}\n-yy785:\n+yy725:\n \tyych = *++YYCURSOR;\n-\tif (yych == '-') goto yy753;\n+\tif (yych == '-') goto yy693;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy752;\n+\tif (yych <= '9') goto yy692;\n \tgoto yy56;\n-yy786:\n+yy726:\n \tyych = *++YYCURSOR;\n-\tif (yych == '-') goto yy753;\n+\tif (yych == '-') goto yy693;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '2') goto yy752;\n+\tif (yych <= '2') goto yy692;\n \tgoto yy56;\n-yy787:\n+yy727:\n \tyych = *++YYCURSOR;\n \tswitch (yych) {\n-\tcase '0':\tgoto yy972;\n-\tcase '1':\tgoto yy974;\n+\tcase '0':\tgoto yy912;\n+\tcase '1':\tgoto yy914;\n \tcase '2':\n \tcase '3':\n \tcase '4':\n@@ -12067,88 +11163,88 @@ yy787:\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy975;\n+\tcase '9':\tgoto yy915;\n \tcase 'A':\n-\tcase 'a':\tgoto yy966;\n+\tcase 'a':\tgoto yy906;\n \tcase 'D':\n-\tcase 'd':\tgoto yy970;\n+\tcase 'd':\tgoto yy910;\n \tcase 'F':\n-\tcase 'f':\tgoto yy964;\n+\tcase 'f':\tgoto yy904;\n \tcase 'J':\n-\tcase 'j':\tgoto yy963;\n+\tcase 'j':\tgoto yy903;\n \tcase 'M':\n-\tcase 'm':\tgoto yy965;\n+\tcase 'm':\tgoto yy905;\n \tcase 'N':\n-\tcase 'n':\tgoto yy969;\n+\tcase 'n':\tgoto yy909;\n \tcase 'O':\n-\tcase 'o':\tgoto yy968;\n+\tcase 'o':\tgoto yy908;\n \tcase 'S':\n-\tcase 's':\tgoto yy967;\n-\tcase 'W':\tgoto yy971;\n-\tdefault:\tgoto yy938;\n+\tcase 's':\tgoto yy907;\n+\tcase 'W':\tgoto yy911;\n+\tdefault:\tgoto yy878;\n \t}\n-yy788:\n+yy728:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '0') goto yy946;\n-\tif (yych <= '1') goto yy947;\n-\tif (yych <= '9') goto yy948;\n+\tif (yych <= '0') goto yy886;\n+\tif (yych <= '1') goto yy887;\n+\tif (yych <= '9') goto yy888;\n \tgoto yy56;\n-yy789:\n+yy729:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 11) YYFILL(11);\n \tyych = *YYCURSOR;\n-yy790:\n+yy730:\n \tswitch (yych) {\n \tcase '\\t':\n-\tcase ' ':\tgoto yy789;\n+\tcase ' ':\tgoto yy729;\n \tcase '-':\n-\tcase '.':\tgoto yy937;\n+\tcase '.':\tgoto yy877;\n \tcase 'A':\n-\tcase 'a':\tgoto yy799;\n+\tcase 'a':\tgoto yy739;\n \tcase 'D':\n-\tcase 'd':\tgoto yy803;\n+\tcase 'd':\tgoto yy743;\n \tcase 'F':\n-\tcase 'f':\tgoto yy797;\n+\tcase 'f':\tgoto yy737;\n \tcase 'H':\n \tcase 'h':\tgoto yy63;\n-\tcase 'I':\tgoto yy792;\n+\tcase 'I':\tgoto yy732;\n \tcase 'J':\n-\tcase 'j':\tgoto yy796;\n+\tcase 'j':\tgoto yy736;\n \tcase 'M':\n-\tcase 'm':\tgoto yy798;\n+\tcase 'm':\tgoto yy738;\n \tcase 'N':\n-\tcase 'n':\tgoto yy802;\n+\tcase 'n':\tgoto yy742;\n \tcase 'O':\n-\tcase 'o':\tgoto yy801;\n+\tcase 'o':\tgoto yy741;\n \tcase 'S':\n-\tcase 's':\tgoto yy800;\n+\tcase 's':\tgoto yy740;\n \tcase 'T':\n \tcase 't':\tgoto yy68;\n-\tcase 'V':\tgoto yy794;\n+\tcase 'V':\tgoto yy734;\n \tcase 'W':\n \tcase 'w':\tgoto yy67;\n-\tcase 'X':\tgoto yy795;\n+\tcase 'X':\tgoto yy735;\n \tcase 'Y':\n \tcase 'y':\tgoto yy66;\n \tdefault:\tgoto yy56;\n \t}\n-yy791:\n+yy731:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy938;\n-\tif (yych <= '0') goto yy930;\n-\tif (yych <= '2') goto yy931;\n-\tif (yych <= '3') goto yy932;\n-\tgoto yy938;\n-yy792:\n+\tif (yych <= '\/') goto yy878;\n+\tif (yych <= '0') goto yy870;\n+\tif (yych <= '2') goto yy871;\n+\tif (yych <= '3') goto yy872;\n+\tgoto yy878;\n+yy732:\n \t++YYCURSOR;\n \tif ((yych = *YYCURSOR) <= 'U') {\n-\t\tif (yych == 'I') goto yy929;\n+\t\tif (yych == 'I') goto yy869;\n \t} else {\n-\t\tif (yych == 'W') goto yy793;\n-\t\tif (yych <= 'X') goto yy883;\n+\t\tif (yych == 'W') goto yy733;\n+\t\tif (yych <= 'X') goto yy823;\n \t}\n-yy793:\n+yy733:\n #line 1352 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint length = 0;\n@@ -12162,35 +11258,35 @@ yy793:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_DATE_NO_DAY;\n \t}\n-#line 12166 \"<stdout>\"\n-yy794:\n+#line 11262 \"<stdout>\"\n+yy734:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'I') goto yy927;\n-\tgoto yy793;\n-yy795:\n+\tif (yych == 'I') goto yy867;\n+\tgoto yy733;\n+yy735:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'I') goto yy926;\n-\tgoto yy793;\n-yy796:\n+\tif (yych == 'I') goto yy866;\n+\tgoto yy733;\n+yy736:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'A') goto yy919;\n+\t\tif (yych == 'A') goto yy859;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy918;\n+\t\tgoto yy858;\n \t} else {\n \t\tif (yych <= 'a') {\n \t\t\tif (yych <= '`') goto yy56;\n-\t\t\tgoto yy919;\n+\t\t\tgoto yy859;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy918;\n+\t\t\tif (yych == 'u') goto yy858;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy797:\n+yy737:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'R') {\n \t\tif (yych <= 'N') {\n-\t\t\tif (yych == 'E') goto yy912;\n+\t\t\tif (yych == 'E') goto yy852;\n \t\t\tgoto yy56;\n \t\t} else {\n \t\t\tif (yych <= 'O') goto yy98;\n@@ -12199,7 +11295,7 @@ yy797:\n \t\t}\n \t} else {\n \t\tif (yych <= 'n') {\n-\t\t\tif (yych == 'e') goto yy912;\n+\t\t\tif (yych == 'e') goto yy852;\n \t\t\tgoto yy56;\n \t\t} else {\n \t\t\tif (yych <= 'o') goto yy98;\n@@ -12207,11 +11303,11 @@ yy797:\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy798:\n+yy738:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'O') {\n \t\tif (yych <= 'H') {\n-\t\t\tif (yych == 'A') goto yy909;\n+\t\t\tif (yych == 'A') goto yy849;\n \t\t\tgoto yy56;\n \t\t} else {\n \t\t\tif (yych <= 'I') goto yy117;\n@@ -12220,7 +11316,7 @@ yy798:\n \t\t}\n \t} else {\n \t\tif (yych <= 'h') {\n-\t\t\tif (yych == 'a') goto yy909;\n+\t\t\tif (yych == 'a') goto yy849;\n \t\t\tgoto yy56;\n \t\t} else {\n \t\t\tif (yych <= 'i') goto yy117;\n@@ -12228,29 +11324,29 @@ yy798:\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy799:\n+yy739:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'P') goto yy903;\n+\t\tif (yych == 'P') goto yy843;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy902;\n+\t\tgoto yy842;\n \t} else {\n \t\tif (yych <= 'p') {\n \t\t\tif (yych <= 'o') goto yy56;\n-\t\t\tgoto yy903;\n+\t\t\tgoto yy843;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy902;\n+\t\t\tif (yych == 'u') goto yy842;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy800:\n+yy740:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n \t\tif (yych <= 'D') {\n \t\t\tif (yych == 'A') goto yy126;\n \t\t\tgoto yy56;\n \t\t} else {\n-\t\t\tif (yych <= 'E') goto yy895;\n+\t\t\tif (yych <= 'E') goto yy835;\n \t\t\tif (yych <= 'T') goto yy56;\n \t\t\tgoto yy125;\n \t\t}\n@@ -12259,73 +11355,73 @@ yy800:\n \t\t\tif (yych == 'a') goto yy126;\n \t\t\tgoto yy56;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy895;\n+\t\t\tif (yych <= 'e') goto yy835;\n \t\t\tif (yych == 'u') goto yy125;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy801:\n+yy741:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy890;\n-\tif (yych == 'c') goto yy890;\n+\tif (yych == 'C') goto yy830;\n+\tif (yych == 'c') goto yy830;\n \tgoto yy56;\n-yy802:\n+yy742:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'O') goto yy884;\n-\tif (yych == 'o') goto yy884;\n+\tif (yych == 'O') goto yy824;\n+\tif (yych == 'o') goto yy824;\n \tgoto yy56;\n-yy803:\n+yy743:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'E') {\n \t\tif (yych == 'A') goto yy113;\n \t\tif (yych <= 'D') goto yy56;\n-\t\tgoto yy877;\n+\t\tgoto yy817;\n \t} else {\n \t\tif (yych <= 'a') {\n \t\t\tif (yych <= '`') goto yy56;\n \t\t\tgoto yy113;\n \t\t} else {\n-\t\t\tif (yych == 'e') goto yy877;\n+\t\t\tif (yych == 'e') goto yy817;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy804:\n+yy744:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '0') goto yy874;\n-\tif (yych <= '9') goto yy875;\n+\tif (yych <= '0') goto yy814;\n+\tif (yych <= '9') goto yy815;\n \tgoto yy60;\n-yy805:\n+yy745:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '2') goto yy843;\n-\tif (yych <= '9') goto yy822;\n+\tif (yych <= '2') goto yy783;\n+\tif (yych <= '9') goto yy762;\n \tgoto yy60;\n-yy806:\n+yy746:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '0') goto yy823;\n-\tif (yych <= '1') goto yy824;\n+\tif (yych <= '0') goto yy763;\n+\tif (yych <= '1') goto yy764;\n \tgoto yy56;\n-yy807:\n+yy747:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '9') goto yy822;\n+\tif (yych <= '9') goto yy762;\n \tgoto yy60;\n-yy808:\n+yy748:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '5') goto yy818;\n-\tif (yych <= '6') goto yy819;\n+\tif (yych <= '5') goto yy758;\n+\tif (yych <= '6') goto yy759;\n \tif (yych <= '9') goto yy54;\n \tgoto yy60;\n-yy809:\n+yy749:\n \tyych = *++YYCURSOR;\n \tif (yych <= '5') {\n \t\tif (yych <= '\/') goto yy56;\n-\t\tif (yych <= '0') goto yy810;\n-\t\tif (yych <= '4') goto yy811;\n-\t\tgoto yy812;\n+\t\tif (yych <= '0') goto yy750;\n+\t\tif (yych <= '4') goto yy751;\n+\t\tgoto yy752;\n \t} else {\n \t\tif (yych <= 'E') {\n \t\t\tif (yych <= 'D') goto yy56;\n@@ -12335,27 +11431,27 @@ yy809:\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy810:\n+yy750:\n \tyych = *++YYCURSOR;\n \tif (yych <= '0') goto yy56;\n-\tif (yych <= '9') goto yy813;\n+\tif (yych <= '9') goto yy753;\n \tgoto yy56;\n-yy811:\n+yy751:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy813;\n+\tif (yych <= '9') goto yy753;\n \tgoto yy56;\n-yy812:\n+yy752:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= '4') goto yy56;\n-yy813:\n-\tyyaccept = 17;\n+yy753:\n+\tyyaccept = 16;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '-') goto yy815;\n-\tif (yych <= '\/') goto yy814;\n-\tif (yych <= '7') goto yy816;\n-yy814:\n+\tif (yych == '-') goto yy755;\n+\tif (yych <= '\/') goto yy754;\n+\tif (yych <= '7') goto yy756;\n+yy754:\n #line 1463 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\ttimelib_sll w, d;\n@@ -12374,12 +11470,12 @@ yy814:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_ISO_WEEK;\n \t}\n-#line 12378 \"<stdout>\"\n-yy815:\n+#line 11474 \"<stdout>\"\n+yy755:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= '8') goto yy56;\n-yy816:\n+yy756:\n \t++YYCURSOR;\n #line 1444 \"ext\/date\/lib\/parse_date.re\"\n \t{\n@@ -12399,20 +11495,20 @@ yy816:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_ISO_WEEK;\n \t}\n-#line 12403 \"<stdout>\"\n-yy818:\n+#line 11499 \"<stdout>\"\n+yy758:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '9') goto yy820;\n+\tif (yych <= '9') goto yy760;\n \tgoto yy60;\n-yy819:\n+yy759:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '6') goto yy820;\n+\tif (yych <= '6') goto yy760;\n \tif (yych <= '9') goto yy54;\n \tgoto yy60;\n-yy820:\n-\tyyaccept = 18;\n+yy760:\n+\tyyaccept = 17;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yybm[0+yych] & 2) {\n \t\tgoto yy54;\n@@ -12431,7 +11527,7 @@ yy820:\n \t\t\t\tif (yych == 'H') goto yy60;\n \t\t\t\tif (yych >= 'M') goto yy60;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'R') goto yy821;\n+\t\t\t\tif (yych <= 'R') goto yy761;\n \t\t\t\tif (yych <= 'T') goto yy60;\n \t\t\t\tif (yych >= 'W') goto yy60;\n \t\t\t}\n@@ -12458,7 +11554,7 @@ yy820:\n \t\t\t}\n \t\t}\n \t}\n-yy821:\n+yy761:\n #line 1430 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint length = 0;\n@@ -12472,62 +11568,62 @@ yy821:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_PG_YEARDAY;\n \t}\n-#line 12476 \"<stdout>\"\n-yy822:\n+#line 11572 \"<stdout>\"\n+yy762:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '9') goto yy820;\n+\tif (yych <= '9') goto yy760;\n \tgoto yy60;\n-yy823:\n+yy763:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy825;\n+\tif (yych <= '9') goto yy765;\n \tgoto yy56;\n-yy824:\n+yy764:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= '3') goto yy56;\n-yy825:\n+yy765:\n \tyych = *++YYCURSOR;\n \tif (yych != ':') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '0') goto yy827;\n-\tif (yych <= '2') goto yy828;\n-\tif (yych <= '3') goto yy829;\n+\tif (yych <= '0') goto yy767;\n+\tif (yych <= '2') goto yy768;\n+\tif (yych <= '3') goto yy769;\n \tgoto yy56;\n-yy827:\n+yy767:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy830;\n+\tif (yych <= '9') goto yy770;\n \tgoto yy56;\n-yy828:\n+yy768:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy830;\n+\tif (yych <= '9') goto yy770;\n \tgoto yy56;\n-yy829:\n+yy769:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= '2') goto yy56;\n-yy830:\n+yy770:\n \tyych = *++YYCURSOR;\n \tif (yych != ' ') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '1') goto yy832;\n-\tif (yych <= '2') goto yy833;\n+\tif (yych <= '1') goto yy772;\n+\tif (yych <= '2') goto yy773;\n \tgoto yy56;\n-yy832:\n+yy772:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy834;\n+\tif (yych <= '9') goto yy774;\n \tgoto yy56;\n-yy833:\n+yy773:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= '5') goto yy56;\n-yy834:\n+yy774:\n \tyych = *++YYCURSOR;\n \tif (yych != ':') goto yy56;\n \tyych = *++YYCURSOR;\n@@ -12540,20 +11636,20 @@ yy834:\n \tif (yych != ':') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy839;\n-\tif (yych <= '6') goto yy840;\n+\tif (yych <= '5') goto yy779;\n+\tif (yych <= '6') goto yy780;\n \tgoto yy56;\n-yy839:\n+yy779:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy841;\n+\tif (yych <= '9') goto yy781;\n \tgoto yy56;\n-yy840:\n+yy780:\n \tyych = *++YYCURSOR;\n \tif (yych != '0') goto yy56;\n-yy841:\n+yy781:\n \t++YYCURSOR;\n-yy842:\n+yy782:\n #line 1404 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint tz_not_found;\n@@ -12579,208 +11675,208 @@ yy842:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_XMLRPC_SOAP;\n \t}\n-#line 12583 \"<stdout>\"\n-yy843:\n+#line 11679 \"<stdout>\"\n+yy783:\n \tyych = *++YYCURSOR;\n \tif (yych <= '2') {\n \t\tif (yych <= '\/') goto yy60;\n-\t\tif (yych >= '1') goto yy845;\n+\t\tif (yych >= '1') goto yy785;\n \t} else {\n-\t\tif (yych <= '3') goto yy846;\n-\t\tif (yych <= '9') goto yy820;\n+\t\tif (yych <= '3') goto yy786;\n+\t\tif (yych <= '9') goto yy760;\n \t\tgoto yy60;\n \t}\n-yy844:\n-\tyyaccept = 18;\n+yy784:\n+\tyyaccept = 17;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'V') {\n \t\tif (yych <= 'D') {\n \t\t\tif (yych <= ' ') {\n \t\t\t\tif (yych == '\\t') goto yy60;\n-\t\t\t\tif (yych <= 0x1F) goto yy821;\n+\t\t\t\tif (yych <= 0x1F) goto yy761;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n-\t\t\t\tif (yych <= '\/') goto yy821;\n-\t\t\t\tif (yych <= '9') goto yy847;\n-\t\t\t\tif (yych <= 'C') goto yy821;\n+\t\t\t\tif (yych <= '\/') goto yy761;\n+\t\t\t\tif (yych <= '9') goto yy787;\n+\t\t\t\tif (yych <= 'C') goto yy761;\n \t\t\t\tgoto yy60;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'H') {\n \t\t\t\tif (yych == 'F') goto yy60;\n-\t\t\t\tif (yych <= 'G') goto yy821;\n+\t\t\t\tif (yych <= 'G') goto yy761;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'M') {\n-\t\t\t\t\tif (yych <= 'L') goto yy821;\n+\t\t\t\t\tif (yych <= 'L') goto yy761;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= 'R') goto yy821;\n+\t\t\t\t\tif (yych <= 'R') goto yy761;\n \t\t\t\t\tif (yych <= 'T') goto yy60;\n-\t\t\t\t\tgoto yy821;\n+\t\t\t\t\tgoto yy761;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= 'h') {\n \t\t\tif (yych <= 'c') {\n-\t\t\t\tif (yych == 'X') goto yy821;\n+\t\t\t\tif (yych == 'X') goto yy761;\n \t\t\t\tif (yych <= 'Y') goto yy60;\n-\t\t\t\tgoto yy821;\n+\t\t\t\tgoto yy761;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'e') {\n \t\t\t\t\tif (yych <= 'd') goto yy60;\n-\t\t\t\t\tgoto yy821;\n+\t\t\t\t\tgoto yy761;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych == 'g') goto yy821;\n+\t\t\t\t\tif (yych == 'g') goto yy761;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n \t\t\t\tif (yych == 'm') goto yy60;\n-\t\t\t\tif (yych <= 'r') goto yy821;\n+\t\t\t\tif (yych <= 'r') goto yy761;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'w') {\n-\t\t\t\t\tif (yych <= 'v') goto yy821;\n+\t\t\t\t\tif (yych <= 'v') goto yy761;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'y') goto yy60;\n-\t\t\t\t\tgoto yy821;\n+\t\t\t\t\tgoto yy761;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t}\n-yy845:\n-\tyyaccept = 18;\n+yy785:\n+\tyyaccept = 17;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'V') {\n \t\tif (yych <= 'D') {\n \t\t\tif (yych <= ' ') {\n \t\t\t\tif (yych == '\\t') goto yy60;\n-\t\t\t\tif (yych <= 0x1F) goto yy821;\n+\t\t\t\tif (yych <= 0x1F) goto yy761;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n-\t\t\t\tif (yych <= '\/') goto yy821;\n-\t\t\t\tif (yych <= '9') goto yy847;\n-\t\t\t\tif (yych <= 'C') goto yy821;\n+\t\t\t\tif (yych <= '\/') goto yy761;\n+\t\t\t\tif (yych <= '9') goto yy787;\n+\t\t\t\tif (yych <= 'C') goto yy761;\n \t\t\t\tgoto yy60;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'H') {\n \t\t\t\tif (yych == 'F') goto yy60;\n-\t\t\t\tif (yych <= 'G') goto yy821;\n+\t\t\t\tif (yych <= 'G') goto yy761;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'M') {\n-\t\t\t\t\tif (yych <= 'L') goto yy821;\n+\t\t\t\t\tif (yych <= 'L') goto yy761;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= 'R') goto yy821;\n+\t\t\t\t\tif (yych <= 'R') goto yy761;\n \t\t\t\t\tif (yych <= 'T') goto yy60;\n-\t\t\t\t\tgoto yy821;\n+\t\t\t\t\tgoto yy761;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= 'h') {\n \t\t\tif (yych <= 'c') {\n-\t\t\t\tif (yych == 'X') goto yy821;\n+\t\t\t\tif (yych == 'X') goto yy761;\n \t\t\t\tif (yych <= 'Y') goto yy60;\n-\t\t\t\tgoto yy821;\n+\t\t\t\tgoto yy761;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'e') {\n \t\t\t\t\tif (yych <= 'd') goto yy60;\n-\t\t\t\t\tgoto yy821;\n+\t\t\t\t\tgoto yy761;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych == 'g') goto yy821;\n+\t\t\t\t\tif (yych == 'g') goto yy761;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n \t\t\t\tif (yych == 'm') goto yy60;\n-\t\t\t\tif (yych <= 'r') goto yy821;\n+\t\t\t\tif (yych <= 'r') goto yy761;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'w') {\n-\t\t\t\t\tif (yych <= 'v') goto yy821;\n+\t\t\t\t\tif (yych <= 'v') goto yy761;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'y') goto yy60;\n-\t\t\t\t\tgoto yy821;\n+\t\t\t\t\tgoto yy761;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t}\n-yy846:\n-\tyyaccept = 18;\n+yy786:\n+\tyyaccept = 17;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'V') {\n \t\tif (yych <= 'D') {\n \t\t\tif (yych <= ' ') {\n \t\t\t\tif (yych == '\\t') goto yy60;\n-\t\t\t\tif (yych <= 0x1F) goto yy821;\n+\t\t\t\tif (yych <= 0x1F) goto yy761;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= '1') {\n-\t\t\t\t\tif (yych <= '\/') goto yy821;\n+\t\t\t\t\tif (yych <= '\/') goto yy761;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych <= '9') goto yy54;\n-\t\t\t\t\tif (yych <= 'C') goto yy821;\n+\t\t\t\t\tif (yych <= 'C') goto yy761;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'H') {\n \t\t\t\tif (yych == 'F') goto yy60;\n-\t\t\t\tif (yych <= 'G') goto yy821;\n+\t\t\t\tif (yych <= 'G') goto yy761;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'M') {\n-\t\t\t\t\tif (yych <= 'L') goto yy821;\n+\t\t\t\t\tif (yych <= 'L') goto yy761;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= 'R') goto yy821;\n+\t\t\t\t\tif (yych <= 'R') goto yy761;\n \t\t\t\t\tif (yych <= 'T') goto yy60;\n-\t\t\t\t\tgoto yy821;\n+\t\t\t\t\tgoto yy761;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= 'h') {\n \t\t\tif (yych <= 'c') {\n-\t\t\t\tif (yych == 'X') goto yy821;\n+\t\t\t\tif (yych == 'X') goto yy761;\n \t\t\t\tif (yych <= 'Y') goto yy60;\n-\t\t\t\tgoto yy821;\n+\t\t\t\tgoto yy761;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'e') {\n \t\t\t\t\tif (yych <= 'd') goto yy60;\n-\t\t\t\t\tgoto yy821;\n+\t\t\t\t\tgoto yy761;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych == 'g') goto yy821;\n+\t\t\t\t\tif (yych == 'g') goto yy761;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n \t\t\t\tif (yych == 'm') goto yy60;\n-\t\t\t\tif (yych <= 'r') goto yy821;\n+\t\t\t\tif (yych <= 'r') goto yy761;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'w') {\n-\t\t\t\t\tif (yych <= 'v') goto yy821;\n+\t\t\t\t\tif (yych <= 'v') goto yy761;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'y') goto yy60;\n-\t\t\t\t\tgoto yy821;\n+\t\t\t\t\tgoto yy761;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t}\n-yy847:\n-\tyyaccept = 19;\n+yy787:\n+\tyyaccept = 18;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yybm[0+yych] & 2) {\n \t\tgoto yy54;\n@@ -12802,7 +11898,7 @@ yy847:\n \t\t\t\tif (yych <= 'S') {\n \t\t\t\t\tif (yych >= 'S') goto yy61;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= 'T') goto yy849;\n+\t\t\t\t\tif (yych <= 'T') goto yy789;\n \t\t\t\t\tif (yych >= 'W') goto yy67;\n \t\t\t\t}\n \t\t\t}\n@@ -12822,9 +11918,9 @@ yy847:\n \t\t} else {\n \t\t\tif (yych <= 't') {\n \t\t\t\tif (yych <= 'm') goto yy62;\n-\t\t\t\tif (yych <= 'r') goto yy848;\n+\t\t\t\tif (yych <= 'r') goto yy788;\n \t\t\t\tif (yych <= 's') goto yy61;\n-\t\t\t\tgoto yy850;\n+\t\t\t\tgoto yy790;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'w') {\n \t\t\t\t\tif (yych >= 'w') goto yy67;\n@@ -12834,7 +11930,7 @@ yy847:\n \t\t\t}\n \t\t}\n \t}\n-yy848:\n+yy788:\n #line 1392 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tDEBUG_OUTPUT(\"datenocolon\");\n@@ -12846,16 +11942,16 @@ yy848:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_DATE_NOCOLON;\n \t}\n-#line 12850 \"<stdout>\"\n-yy849:\n+#line 11946 \"<stdout>\"\n+yy789:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'H') {\n \t\tif (yych <= '2') {\n \t\t\tif (yych <= '\/') goto yy56;\n-\t\t\tif (yych <= '1') goto yy864;\n-\t\t\tgoto yy865;\n+\t\t\tif (yych <= '1') goto yy804;\n+\t\t\tgoto yy805;\n \t\t} else {\n-\t\t\tif (yych <= '9') goto yy866;\n+\t\t\tif (yych <= '9') goto yy806;\n \t\t\tif (yych <= 'G') goto yy56;\n \t\t\tgoto yy69;\n \t\t}\n@@ -12869,14 +11965,14 @@ yy849:\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy850:\n+yy790:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'H') {\n \t\tif (yych <= '2') {\n \t\t\tif (yych <= '\/') goto yy56;\n-\t\t\tif (yych >= '2') goto yy852;\n+\t\t\tif (yych >= '2') goto yy792;\n \t\t} else {\n-\t\t\tif (yych <= '9') goto yy853;\n+\t\t\tif (yych <= '9') goto yy793;\n \t\t\tif (yych <= 'G') goto yy56;\n \t\t\tgoto yy69;\n \t\t}\n@@ -12892,97 +11988,97 @@ yy850:\n \t}\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy858;\n-\tif (yych <= '9') goto yy853;\n+\tif (yych <= '5') goto yy798;\n+\tif (yych <= '9') goto yy793;\n \tgoto yy56;\n-yy852:\n+yy792:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '4') goto yy858;\n-\tif (yych <= '5') goto yy854;\n+\tif (yych <= '4') goto yy798;\n+\tif (yych <= '5') goto yy794;\n \tgoto yy56;\n-yy853:\n+yy793:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= '6') goto yy56;\n-yy854:\n+yy794:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n-yy855:\n+yy795:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy856;\n-\tif (yych <= '6') goto yy857;\n+\tif (yych <= '5') goto yy796;\n+\tif (yych <= '6') goto yy797;\n \tgoto yy56;\n-yy856:\n+yy796:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy841;\n+\tif (yych <= '9') goto yy781;\n \tgoto yy56;\n-yy857:\n+yy797:\n \tyych = *++YYCURSOR;\n-\tif (yych == '0') goto yy841;\n+\tif (yych == '0') goto yy781;\n \tgoto yy56;\n-yy858:\n+yy798:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy859;\n-\tif (yych <= '9') goto yy855;\n+\tif (yych <= '5') goto yy799;\n+\tif (yych <= '9') goto yy795;\n \tgoto yy56;\n-yy859:\n+yy799:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy860;\n-\tif (yych <= '6') goto yy861;\n-\tif (yych <= '9') goto yy855;\n+\tif (yych <= '5') goto yy800;\n+\tif (yych <= '6') goto yy801;\n+\tif (yych <= '9') goto yy795;\n \tgoto yy56;\n-yy860:\n+yy800:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy862;\n-\tif (yych <= '6') goto yy863;\n-\tif (yych <= '9') goto yy841;\n+\tif (yych <= '5') goto yy802;\n+\tif (yych <= '6') goto yy803;\n+\tif (yych <= '9') goto yy781;\n \tgoto yy56;\n-yy861:\n+yy801:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '0') goto yy862;\n-\tif (yych <= '5') goto yy856;\n-\tif (yych <= '6') goto yy857;\n+\tif (yych <= '0') goto yy802;\n+\tif (yych <= '5') goto yy796;\n+\tif (yych <= '6') goto yy797;\n \tgoto yy56;\n-yy862:\n+yy802:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy842;\n-\tif (yych <= '9') goto yy841;\n-\tgoto yy842;\n-yy863:\n+\tif (yych <= '\/') goto yy782;\n+\tif (yych <= '9') goto yy781;\n+\tgoto yy782;\n+yy803:\n \tyych = *++YYCURSOR;\n-\tif (yych == '0') goto yy841;\n-\tgoto yy842;\n-yy864:\n+\tif (yych == '0') goto yy781;\n+\tgoto yy782;\n+yy804:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy873;\n-\tif (yych <= '9') goto yy866;\n-\tif (yych <= ':') goto yy867;\n+\tif (yych <= '5') goto yy813;\n+\tif (yych <= '9') goto yy806;\n+\tif (yych <= ':') goto yy807;\n \tgoto yy56;\n-yy865:\n+yy805:\n \tyych = *++YYCURSOR;\n \tif (yych <= '5') {\n \t\tif (yych <= '\/') goto yy56;\n-\t\tif (yych <= '4') goto yy873;\n-\t\tgoto yy854;\n+\t\tif (yych <= '4') goto yy813;\n+\t\tgoto yy794;\n \t} else {\n-\t\tif (yych == ':') goto yy867;\n+\t\tif (yych == ':') goto yy807;\n \t\tgoto yy56;\n \t}\n-yy866:\n+yy806:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy854;\n+\tif (yych <= '5') goto yy794;\n \tif (yych != ':') goto yy56;\n-yy867:\n+yy807:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= '6') goto yy56;\n@@ -12993,129 +12089,129 @@ yy867:\n \tif (yych != ':') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy871;\n-\tif (yych <= '6') goto yy872;\n+\tif (yych <= '5') goto yy811;\n+\tif (yych <= '6') goto yy812;\n \tgoto yy56;\n-yy871:\n+yy811:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy841;\n+\tif (yych <= '9') goto yy781;\n \tgoto yy56;\n-yy872:\n+yy812:\n \tyych = *++YYCURSOR;\n-\tif (yych == '0') goto yy841;\n+\tif (yych == '0') goto yy781;\n \tgoto yy56;\n-yy873:\n+yy813:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy859;\n-\tif (yych <= '9') goto yy855;\n-\tif (yych <= ':') goto yy867;\n+\tif (yych <= '5') goto yy799;\n+\tif (yych <= '9') goto yy795;\n+\tif (yych <= ':') goto yy807;\n \tgoto yy56;\n-yy874:\n+yy814:\n \tyych = *++YYCURSOR;\n \tif (yych <= '2') {\n \t\tif (yych <= '\/') goto yy60;\n-\t\tif (yych <= '0') goto yy876;\n-\t\tgoto yy845;\n+\t\tif (yych <= '0') goto yy816;\n+\t\tgoto yy785;\n \t} else {\n-\t\tif (yych <= '3') goto yy846;\n-\t\tif (yych <= '9') goto yy820;\n+\t\tif (yych <= '3') goto yy786;\n+\t\tif (yych <= '9') goto yy760;\n \t\tgoto yy60;\n \t}\n-yy875:\n+yy815:\n \tyych = *++YYCURSOR;\n \tif (yych <= '2') {\n \t\tif (yych <= '\/') goto yy60;\n-\t\tif (yych <= '0') goto yy844;\n-\t\tgoto yy845;\n+\t\tif (yych <= '0') goto yy784;\n+\t\tgoto yy785;\n \t} else {\n-\t\tif (yych <= '3') goto yy846;\n-\t\tif (yych <= '9') goto yy820;\n+\t\tif (yych <= '3') goto yy786;\n+\t\tif (yych <= '9') goto yy760;\n \t\tgoto yy60;\n \t}\n-yy876:\n+yy816:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '9') goto yy847;\n+\tif (yych <= '9') goto yy787;\n \tgoto yy60;\n-yy877:\n+yy817:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy878;\n+\tif (yych == 'C') goto yy818;\n \tif (yych != 'c') goto yy56;\n-yy878:\n-\tyyaccept = 20;\n+yy818:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == 'E') goto yy879;\n-\tif (yych != 'e') goto yy793;\n-yy879:\n+\tif (yych == 'E') goto yy819;\n+\tif (yych != 'e') goto yy733;\n+yy819:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy880;\n+\tif (yych == 'M') goto yy820;\n \tif (yych != 'm') goto yy56;\n-yy880:\n+yy820:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy881;\n+\tif (yych == 'B') goto yy821;\n \tif (yych != 'b') goto yy56;\n-yy881:\n+yy821:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy882;\n+\tif (yych == 'E') goto yy822;\n \tif (yych != 'e') goto yy56;\n-yy882:\n+yy822:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy883;\n+\tif (yych == 'R') goto yy823;\n \tif (yych != 'r') goto yy56;\n-yy883:\n+yy823:\n \tyych = *++YYCURSOR;\n-\tgoto yy793;\n-yy884:\n+\tgoto yy733;\n+yy824:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'V') goto yy885;\n+\tif (yych == 'V') goto yy825;\n \tif (yych != 'v') goto yy56;\n-yy885:\n-\tyyaccept = 20;\n+yy825:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == 'E') goto yy886;\n-\tif (yych != 'e') goto yy793;\n-yy886:\n+\tif (yych == 'E') goto yy826;\n+\tif (yych != 'e') goto yy733;\n+yy826:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy887;\n+\tif (yych == 'M') goto yy827;\n \tif (yych != 'm') goto yy56;\n-yy887:\n+yy827:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy888;\n+\tif (yych == 'B') goto yy828;\n \tif (yych != 'b') goto yy56;\n-yy888:\n+yy828:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy889;\n+\tif (yych == 'E') goto yy829;\n \tif (yych != 'e') goto yy56;\n-yy889:\n+yy829:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy883;\n-\tif (yych == 'r') goto yy883;\n+\tif (yych == 'R') goto yy823;\n+\tif (yych == 'r') goto yy823;\n \tgoto yy56;\n-yy890:\n+yy830:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy891;\n+\tif (yych == 'T') goto yy831;\n \tif (yych != 't') goto yy56;\n-yy891:\n-\tyyaccept = 20;\n+yy831:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == 'O') goto yy892;\n-\tif (yych != 'o') goto yy793;\n-yy892:\n+\tif (yych == 'O') goto yy832;\n+\tif (yych != 'o') goto yy733;\n+yy832:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy893;\n+\tif (yych == 'B') goto yy833;\n \tif (yych != 'b') goto yy56;\n-yy893:\n+yy833:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy894;\n+\tif (yych == 'E') goto yy834;\n \tif (yych != 'e') goto yy56;\n-yy894:\n+yy834:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy883;\n-\tif (yych == 'r') goto yy883;\n+\tif (yych == 'R') goto yy823;\n+\tif (yych == 'r') goto yy823;\n \tgoto yy56;\n-yy895:\n+yy835:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'P') {\n \t\tif (yych == 'C') goto yy128;\n@@ -13128,518 +12224,518 @@ yy895:\n \t\t\tif (yych != 'p') goto yy56;\n \t\t}\n \t}\n-yy896:\n+yy836:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy897;\n-\tif (yych != 't') goto yy793;\n-yy897:\n-\tyyaccept = 20;\n+\tif (yych == 'T') goto yy837;\n+\tif (yych != 't') goto yy733;\n+yy837:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == 'E') goto yy898;\n-\tif (yych != 'e') goto yy793;\n-yy898:\n+\tif (yych == 'E') goto yy838;\n+\tif (yych != 'e') goto yy733;\n+yy838:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy899;\n+\tif (yych == 'M') goto yy839;\n \tif (yych != 'm') goto yy56;\n-yy899:\n+yy839:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy900;\n+\tif (yych == 'B') goto yy840;\n \tif (yych != 'b') goto yy56;\n-yy900:\n+yy840:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy901;\n+\tif (yych == 'E') goto yy841;\n \tif (yych != 'e') goto yy56;\n-yy901:\n+yy841:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy883;\n-\tif (yych == 'r') goto yy883;\n+\tif (yych == 'R') goto yy823;\n+\tif (yych == 'r') goto yy823;\n \tgoto yy56;\n-yy902:\n+yy842:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'G') goto yy906;\n-\tif (yych == 'g') goto yy906;\n+\tif (yych == 'G') goto yy846;\n+\tif (yych == 'g') goto yy846;\n \tgoto yy56;\n-yy903:\n+yy843:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy904;\n+\tif (yych == 'R') goto yy844;\n \tif (yych != 'r') goto yy56;\n-yy904:\n-\tyyaccept = 20;\n+yy844:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == 'I') goto yy905;\n-\tif (yych != 'i') goto yy793;\n-yy905:\n+\tif (yych == 'I') goto yy845;\n+\tif (yych != 'i') goto yy733;\n+yy845:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'L') goto yy883;\n-\tif (yych == 'l') goto yy883;\n+\tif (yych == 'L') goto yy823;\n+\tif (yych == 'l') goto yy823;\n \tgoto yy56;\n-yy906:\n-\tyyaccept = 20;\n+yy846:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == 'U') goto yy907;\n-\tif (yych != 'u') goto yy793;\n-yy907:\n+\tif (yych == 'U') goto yy847;\n+\tif (yych != 'u') goto yy733;\n+yy847:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'S') goto yy908;\n+\tif (yych == 'S') goto yy848;\n \tif (yych != 's') goto yy56;\n-yy908:\n+yy848:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy883;\n-\tif (yych == 't') goto yy883;\n+\tif (yych == 'T') goto yy823;\n+\tif (yych == 't') goto yy823;\n \tgoto yy56;\n-yy909:\n+yy849:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'Y') {\n-\t\tif (yych == 'R') goto yy910;\n+\t\tif (yych == 'R') goto yy850;\n \t\tif (yych <= 'X') goto yy56;\n-\t\tgoto yy883;\n+\t\tgoto yy823;\n \t} else {\n \t\tif (yych <= 'r') {\n \t\t\tif (yych <= 'q') goto yy56;\n \t\t} else {\n-\t\t\tif (yych == 'y') goto yy883;\n+\t\t\tif (yych == 'y') goto yy823;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy910:\n-\tyyaccept = 20;\n+yy850:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == 'C') goto yy911;\n-\tif (yych != 'c') goto yy793;\n-yy911:\n+\tif (yych == 'C') goto yy851;\n+\tif (yych != 'c') goto yy733;\n+yy851:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'H') goto yy883;\n-\tif (yych == 'h') goto yy883;\n+\tif (yych == 'H') goto yy823;\n+\tif (yych == 'h') goto yy823;\n \tgoto yy56;\n-yy912:\n+yy852:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy913;\n+\tif (yych == 'B') goto yy853;\n \tif (yych != 'b') goto yy56;\n-yy913:\n-\tyyaccept = 20;\n+yy853:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == 'R') goto yy914;\n-\tif (yych != 'r') goto yy793;\n-yy914:\n+\tif (yych == 'R') goto yy854;\n+\tif (yych != 'r') goto yy733;\n+yy854:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'U') goto yy915;\n+\tif (yych == 'U') goto yy855;\n \tif (yych != 'u') goto yy56;\n-yy915:\n+yy855:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy916;\n+\tif (yych == 'A') goto yy856;\n \tif (yych != 'a') goto yy56;\n-yy916:\n+yy856:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy917;\n+\tif (yych == 'R') goto yy857;\n \tif (yych != 'r') goto yy56;\n-yy917:\n+yy857:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy883;\n-\tif (yych == 'y') goto yy883;\n+\tif (yych == 'Y') goto yy823;\n+\tif (yych == 'y') goto yy823;\n \tgoto yy56;\n-yy918:\n+yy858:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n-\t\tif (yych == 'L') goto yy925;\n+\t\tif (yych == 'L') goto yy865;\n \t\tif (yych <= 'M') goto yy56;\n-\t\tgoto yy924;\n+\t\tgoto yy864;\n \t} else {\n \t\tif (yych <= 'l') {\n \t\t\tif (yych <= 'k') goto yy56;\n-\t\t\tgoto yy925;\n+\t\t\tgoto yy865;\n \t\t} else {\n-\t\t\tif (yych == 'n') goto yy924;\n+\t\t\tif (yych == 'n') goto yy864;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy919:\n+yy859:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'N') goto yy920;\n+\tif (yych == 'N') goto yy860;\n \tif (yych != 'n') goto yy56;\n-yy920:\n-\tyyaccept = 20;\n+yy860:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == 'U') goto yy921;\n-\tif (yych != 'u') goto yy793;\n-yy921:\n+\tif (yych == 'U') goto yy861;\n+\tif (yych != 'u') goto yy733;\n+yy861:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy922;\n+\tif (yych == 'A') goto yy862;\n \tif (yych != 'a') goto yy56;\n-yy922:\n+yy862:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy923;\n+\tif (yych == 'R') goto yy863;\n \tif (yych != 'r') goto yy56;\n-yy923:\n+yy863:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy883;\n-\tif (yych == 'y') goto yy883;\n+\tif (yych == 'Y') goto yy823;\n+\tif (yych == 'y') goto yy823;\n \tgoto yy56;\n-yy924:\n+yy864:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy883;\n-\tif (yych == 'e') goto yy883;\n-\tgoto yy793;\n-yy925:\n+\tif (yych == 'E') goto yy823;\n+\tif (yych == 'e') goto yy823;\n+\tgoto yy733;\n+yy865:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy883;\n-\tif (yych == 'y') goto yy883;\n-\tgoto yy793;\n-yy926:\n+\tif (yych == 'Y') goto yy823;\n+\tif (yych == 'y') goto yy823;\n+\tgoto yy733;\n+yy866:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'I') goto yy883;\n-\tgoto yy793;\n-yy927:\n+\tif (yych == 'I') goto yy823;\n+\tgoto yy733;\n+yy867:\n \tyych = *++YYCURSOR;\n-\tif (yych != 'I') goto yy793;\n+\tif (yych != 'I') goto yy733;\n \tyych = *++YYCURSOR;\n-\tif (yych == 'I') goto yy883;\n-\tgoto yy793;\n-yy929:\n+\tif (yych == 'I') goto yy823;\n+\tgoto yy733;\n+yy869:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'I') goto yy883;\n-\tgoto yy793;\n-yy930:\n+\tif (yych == 'I') goto yy823;\n+\tgoto yy733;\n+yy870:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '0') goto yy945;\n-\tif (yych <= '9') goto yy944;\n+\tif (yych <= '0') goto yy885;\n+\tif (yych <= '9') goto yy884;\n \tgoto yy56;\n-yy931:\n+yy871:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy943;\n+\tif (yych <= '9') goto yy883;\n \tgoto yy56;\n-yy932:\n+yy872:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy941;\n-\tif (yych <= '6') goto yy940;\n+\tif (yych <= '5') goto yy881;\n+\tif (yych <= '6') goto yy880;\n \tgoto yy56;\n-yy933:\n+yy873:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy912;\n-\tif (yych == 'e') goto yy912;\n+\tif (yych == 'E') goto yy852;\n+\tif (yych == 'e') goto yy852;\n \tgoto yy56;\n-yy934:\n+yy874:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy909;\n-\tif (yych == 'a') goto yy909;\n+\tif (yych == 'A') goto yy849;\n+\tif (yych == 'a') goto yy849;\n \tgoto yy56;\n-yy935:\n+yy875:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy939;\n-\tif (yych == 'e') goto yy939;\n+\tif (yych == 'E') goto yy879;\n+\tif (yych == 'e') goto yy879;\n \tgoto yy56;\n-yy936:\n+yy876:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy877;\n-\tif (yych == 'e') goto yy877;\n+\tif (yych == 'E') goto yy817;\n+\tif (yych == 'e') goto yy817;\n \tgoto yy56;\n-yy937:\n+yy877:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 9) YYFILL(9);\n \tyych = *YYCURSOR;\n-yy938:\n+yy878:\n \tswitch (yych) {\n \tcase '\\t':\n \tcase ' ':\n \tcase '-':\n-\tcase '.':\tgoto yy937;\n+\tcase '.':\tgoto yy877;\n \tcase 'A':\n-\tcase 'a':\tgoto yy799;\n+\tcase 'a':\tgoto yy739;\n \tcase 'D':\n-\tcase 'd':\tgoto yy936;\n+\tcase 'd':\tgoto yy876;\n \tcase 'F':\n-\tcase 'f':\tgoto yy933;\n-\tcase 'I':\tgoto yy792;\n+\tcase 'f':\tgoto yy873;\n+\tcase 'I':\tgoto yy732;\n \tcase 'J':\n-\tcase 'j':\tgoto yy796;\n+\tcase 'j':\tgoto yy736;\n \tcase 'M':\n-\tcase 'm':\tgoto yy934;\n+\tcase 'm':\tgoto yy874;\n \tcase 'N':\n-\tcase 'n':\tgoto yy802;\n+\tcase 'n':\tgoto yy742;\n \tcase 'O':\n-\tcase 'o':\tgoto yy801;\n+\tcase 'o':\tgoto yy741;\n \tcase 'S':\n-\tcase 's':\tgoto yy935;\n-\tcase 'V':\tgoto yy794;\n-\tcase 'X':\tgoto yy795;\n+\tcase 's':\tgoto yy875;\n+\tcase 'V':\tgoto yy734;\n+\tcase 'X':\tgoto yy735;\n \tdefault:\tgoto yy56;\n \t}\n-yy939:\n+yy879:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'P') goto yy896;\n-\tif (yych == 'p') goto yy896;\n+\tif (yych == 'P') goto yy836;\n+\tif (yych == 'p') goto yy836;\n \tgoto yy56;\n-yy940:\n+yy880:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '6') goto yy942;\n+\tif (yych <= '6') goto yy882;\n \tgoto yy56;\n-yy941:\n+yy881:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n-yy942:\n+yy882:\n \tyych = *++YYCURSOR;\n-\tgoto yy821;\n-yy943:\n+\tgoto yy761;\n+yy883:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy942;\n+\tif (yych <= '9') goto yy882;\n \tgoto yy56;\n-yy944:\n+yy884:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy942;\n+\tif (yych <= '9') goto yy882;\n \tgoto yy56;\n-yy945:\n+yy885:\n \tyych = *++YYCURSOR;\n \tif (yych <= '0') goto yy56;\n-\tif (yych <= '9') goto yy942;\n+\tif (yych <= '9') goto yy882;\n \tgoto yy56;\n-yy946:\n+yy886:\n \tyych = *++YYCURSOR;\n \tif (yych <= '.') goto yy56;\n-\tif (yych <= '\/') goto yy949;\n-\tif (yych <= '9') goto yy957;\n+\tif (yych <= '\/') goto yy889;\n+\tif (yych <= '9') goto yy897;\n \tgoto yy56;\n-yy947:\n+yy887:\n \tyych = *++YYCURSOR;\n \tif (yych <= '.') goto yy56;\n-\tif (yych <= '\/') goto yy949;\n-\tif (yych <= '2') goto yy957;\n+\tif (yych <= '\/') goto yy889;\n+\tif (yych <= '2') goto yy897;\n \tgoto yy56;\n-yy948:\n+yy888:\n \tyych = *++YYCURSOR;\n \tif (yych != '\/') goto yy56;\n-yy949:\n+yy889:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '2') goto yy950;\n-\tif (yych <= '3') goto yy951;\n-\tif (yych <= '9') goto yy952;\n+\tif (yych <= '2') goto yy890;\n+\tif (yych <= '3') goto yy891;\n+\tif (yych <= '9') goto yy892;\n \tgoto yy56;\n-yy950:\n-\tyyaccept = 21;\n+yy890:\n+\tyyaccept = 20;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy454;\n-\t\tif (yych <= '9') goto yy952;\n-\t\tif (yych <= 'm') goto yy454;\n-\t\tgoto yy954;\n+\t\tif (yych <= '\/') goto yy394;\n+\t\tif (yych <= '9') goto yy892;\n+\t\tif (yych <= 'm') goto yy394;\n+\t\tgoto yy894;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy454;\n-\t\t\tgoto yy955;\n+\t\t\tif (yych <= 'q') goto yy394;\n+\t\t\tgoto yy895;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy953;\n-\t\t\tif (yych <= 't') goto yy956;\n-\t\t\tgoto yy454;\n+\t\t\tif (yych <= 's') goto yy893;\n+\t\t\tif (yych <= 't') goto yy896;\n+\t\t\tgoto yy394;\n \t\t}\n \t}\n-yy951:\n-\tyyaccept = 21;\n+yy891:\n+\tyyaccept = 20;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy454;\n-\t\tif (yych <= '1') goto yy952;\n-\t\tif (yych <= 'm') goto yy454;\n-\t\tgoto yy954;\n+\t\tif (yych <= '\/') goto yy394;\n+\t\tif (yych <= '1') goto yy892;\n+\t\tif (yych <= 'm') goto yy394;\n+\t\tgoto yy894;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy454;\n-\t\t\tgoto yy955;\n+\t\t\tif (yych <= 'q') goto yy394;\n+\t\t\tgoto yy895;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy953;\n-\t\t\tif (yych <= 't') goto yy956;\n-\t\t\tgoto yy454;\n+\t\t\tif (yych <= 's') goto yy893;\n+\t\t\tif (yych <= 't') goto yy896;\n+\t\t\tgoto yy394;\n \t\t}\n \t}\n-yy952:\n-\tyyaccept = 21;\n+yy892:\n+\tyyaccept = 20;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'q') {\n-\t\tif (yych == 'n') goto yy954;\n-\t\tgoto yy454;\n+\t\tif (yych == 'n') goto yy894;\n+\t\tgoto yy394;\n \t} else {\n-\t\tif (yych <= 'r') goto yy955;\n-\t\tif (yych <= 's') goto yy953;\n-\t\tif (yych <= 't') goto yy956;\n-\t\tgoto yy454;\n+\t\tif (yych <= 'r') goto yy895;\n+\t\tif (yych <= 's') goto yy893;\n+\t\tif (yych <= 't') goto yy896;\n+\t\tgoto yy394;\n \t}\n-yy953:\n+yy893:\n \tyych = *++YYCURSOR;\n-\tif (yych == 't') goto yy453;\n+\tif (yych == 't') goto yy393;\n \tgoto yy56;\n-yy954:\n+yy894:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'd') goto yy453;\n+\tif (yych == 'd') goto yy393;\n \tgoto yy56;\n-yy955:\n+yy895:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'd') goto yy453;\n+\tif (yych == 'd') goto yy393;\n \tgoto yy56;\n-yy956:\n+yy896:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'h') goto yy453;\n+\tif (yych == 'h') goto yy393;\n \tgoto yy56;\n-yy957:\n+yy897:\n \tyych = *++YYCURSOR;\n \tif (yych != '\/') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '2') {\n \t\tif (yych <= '\/') goto yy56;\n-\t\tif (yych >= '1') goto yy960;\n+\t\tif (yych >= '1') goto yy900;\n \t} else {\n-\t\tif (yych <= '3') goto yy961;\n-\t\tif (yych <= '9') goto yy952;\n+\t\tif (yych <= '3') goto yy901;\n+\t\tif (yych <= '9') goto yy892;\n \t\tgoto yy56;\n \t}\n-\tyyaccept = 21;\n+\tyyaccept = 20;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy454;\n-\t\tif (yych <= '9') goto yy962;\n-\t\tif (yych <= 'm') goto yy454;\n-\t\tgoto yy954;\n+\t\tif (yych <= '\/') goto yy394;\n+\t\tif (yych <= '9') goto yy902;\n+\t\tif (yych <= 'm') goto yy394;\n+\t\tgoto yy894;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy454;\n-\t\t\tgoto yy955;\n+\t\t\tif (yych <= 'q') goto yy394;\n+\t\t\tgoto yy895;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy953;\n-\t\t\tif (yych <= 't') goto yy956;\n-\t\t\tgoto yy454;\n+\t\t\tif (yych <= 's') goto yy893;\n+\t\t\tif (yych <= 't') goto yy896;\n+\t\t\tgoto yy394;\n \t\t}\n \t}\n-yy960:\n-\tyyaccept = 21;\n+yy900:\n+\tyyaccept = 20;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy454;\n-\t\tif (yych <= '9') goto yy962;\n-\t\tif (yych <= 'm') goto yy454;\n-\t\tgoto yy954;\n+\t\tif (yych <= '\/') goto yy394;\n+\t\tif (yych <= '9') goto yy902;\n+\t\tif (yych <= 'm') goto yy394;\n+\t\tgoto yy894;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy454;\n-\t\t\tgoto yy955;\n+\t\t\tif (yych <= 'q') goto yy394;\n+\t\t\tgoto yy895;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy953;\n-\t\t\tif (yych <= 't') goto yy956;\n-\t\t\tgoto yy454;\n+\t\t\tif (yych <= 's') goto yy893;\n+\t\t\tif (yych <= 't') goto yy896;\n+\t\t\tgoto yy394;\n \t\t}\n \t}\n-yy961:\n-\tyyaccept = 21;\n+yy901:\n+\tyyaccept = 20;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy454;\n-\t\tif (yych <= '1') goto yy962;\n-\t\tif (yych <= 'm') goto yy454;\n-\t\tgoto yy954;\n+\t\tif (yych <= '\/') goto yy394;\n+\t\tif (yych <= '1') goto yy902;\n+\t\tif (yych <= 'm') goto yy394;\n+\t\tgoto yy894;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy454;\n-\t\t\tgoto yy955;\n+\t\t\tif (yych <= 'q') goto yy394;\n+\t\t\tgoto yy895;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy953;\n-\t\t\tif (yych <= 't') goto yy956;\n-\t\t\tgoto yy454;\n+\t\t\tif (yych <= 's') goto yy893;\n+\t\t\tif (yych <= 't') goto yy896;\n+\t\t\tgoto yy394;\n \t\t}\n \t}\n-yy962:\n-\tyyaccept = 21;\n+yy902:\n+\tyyaccept = 20;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych == '\/') goto yy453;\n-\t\tif (yych <= 'm') goto yy454;\n-\t\tgoto yy954;\n+\t\tif (yych == '\/') goto yy393;\n+\t\tif (yych <= 'm') goto yy394;\n+\t\tgoto yy894;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy454;\n-\t\t\tgoto yy955;\n+\t\t\tif (yych <= 'q') goto yy394;\n+\t\t\tgoto yy895;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy953;\n-\t\t\tif (yych <= 't') goto yy956;\n-\t\t\tgoto yy454;\n+\t\t\tif (yych <= 's') goto yy893;\n+\t\t\tif (yych <= 't') goto yy896;\n+\t\t\tgoto yy394;\n \t\t}\n \t}\n-yy963:\n+yy903:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'A') goto yy1043;\n+\t\tif (yych == 'A') goto yy983;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy1042;\n+\t\tgoto yy982;\n \t} else {\n \t\tif (yych <= 'a') {\n \t\t\tif (yych <= '`') goto yy56;\n-\t\t\tgoto yy1043;\n+\t\t\tgoto yy983;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy1042;\n+\t\t\tif (yych == 'u') goto yy982;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy964:\n+yy904:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy1040;\n-\tif (yych == 'e') goto yy1040;\n+\tif (yych == 'E') goto yy980;\n+\tif (yych == 'e') goto yy980;\n \tgoto yy56;\n-yy965:\n+yy905:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1037;\n-\tif (yych == 'a') goto yy1037;\n+\tif (yych == 'A') goto yy977;\n+\tif (yych == 'a') goto yy977;\n \tgoto yy56;\n-yy966:\n+yy906:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'P') goto yy1034;\n+\t\tif (yych == 'P') goto yy974;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy1033;\n+\t\tgoto yy973;\n \t} else {\n \t\tif (yych <= 'p') {\n \t\t\tif (yych <= 'o') goto yy56;\n-\t\t\tgoto yy1034;\n+\t\t\tgoto yy974;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy1033;\n+\t\t\tif (yych == 'u') goto yy973;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy967:\n+yy907:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy1030;\n-\tif (yych == 'e') goto yy1030;\n+\tif (yych == 'E') goto yy970;\n+\tif (yych == 'e') goto yy970;\n \tgoto yy56;\n-yy968:\n+yy908:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy1028;\n-\tif (yych == 'c') goto yy1028;\n+\tif (yych == 'C') goto yy968;\n+\tif (yych == 'c') goto yy968;\n \tgoto yy56;\n-yy969:\n+yy909:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'O') goto yy1026;\n-\tif (yych == 'o') goto yy1026;\n+\tif (yych == 'O') goto yy966;\n+\tif (yych == 'o') goto yy966;\n \tgoto yy56;\n-yy970:\n+yy910:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy1024;\n-\tif (yych == 'e') goto yy1024;\n+\tif (yych == 'E') goto yy964;\n+\tif (yych == 'e') goto yy964;\n \tgoto yy56;\n-yy971:\n+yy911:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '0') goto yy810;\n-\tif (yych <= '4') goto yy811;\n-\tif (yych <= '5') goto yy812;\n+\tif (yych <= '0') goto yy750;\n+\tif (yych <= '4') goto yy751;\n+\tif (yych <= '5') goto yy752;\n \tgoto yy56;\n-yy972:\n-\tyyaccept = 22;\n+yy912:\n+\tyyaccept = 21;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '-') goto yy976;\n-\tif (yych <= '\/') goto yy973;\n-\tif (yych <= '9') goto yy995;\n-yy973:\n+\tif (yych == '-') goto yy916;\n+\tif (yych <= '\/') goto yy913;\n+\tif (yych <= '9') goto yy935;\n+yy913:\n #line 1269 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint length = 0;\n@@ -13653,639 +12749,639 @@ yy973:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_ISO_DATE;\n \t}\n-#line 13657 \"<stdout>\"\n-yy974:\n-\tyyaccept = 22;\n+#line 12753 \"<stdout>\"\n+yy914:\n+\tyyaccept = 21;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '-') goto yy976;\n-\tif (yych <= '\/') goto yy973;\n-\tif (yych <= '2') goto yy995;\n-\tgoto yy973;\n-yy975:\n-\tyyaccept = 22;\n+\tif (yych == '-') goto yy916;\n+\tif (yych <= '\/') goto yy913;\n+\tif (yych <= '2') goto yy935;\n+\tgoto yy913;\n+yy915:\n+\tyyaccept = 21;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych != '-') goto yy973;\n-yy976:\n+\tif (yych != '-') goto yy913;\n+yy916:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '2') goto yy977;\n-\tif (yych <= '3') goto yy978;\n-\tif (yych <= '9') goto yy979;\n+\tif (yych <= '2') goto yy917;\n+\tif (yych <= '3') goto yy918;\n+\tif (yych <= '9') goto yy919;\n \tgoto yy56;\n-yy977:\n-\tyyaccept = 13;\n+yy917:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'm') {\n \t\tif (yych <= '9') {\n-\t\t\tif (yych <= '\/') goto yy656;\n-\t\t\tgoto yy979;\n+\t\t\tif (yych <= '\/') goto yy596;\n+\t\t\tgoto yy919;\n \t\t} else {\n-\t\t\tif (yych == 'T') goto yy984;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych == 'T') goto yy924;\n+\t\t\tgoto yy596;\n \t\t}\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'n') goto yy981;\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy982;\n+\t\t\tif (yych <= 'n') goto yy921;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy922;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy980;\n-\t\t\tif (yych <= 't') goto yy983;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy920;\n+\t\t\tif (yych <= 't') goto yy923;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy978:\n-\tyyaccept = 13;\n+yy918:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'm') {\n \t\tif (yych <= '1') {\n-\t\t\tif (yych <= '\/') goto yy656;\n+\t\t\tif (yych <= '\/') goto yy596;\n \t\t} else {\n-\t\t\tif (yych == 'T') goto yy984;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych == 'T') goto yy924;\n+\t\t\tgoto yy596;\n \t\t}\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'n') goto yy981;\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy982;\n+\t\t\tif (yych <= 'n') goto yy921;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy922;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy980;\n-\t\t\tif (yych <= 't') goto yy983;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy920;\n+\t\t\tif (yych <= 't') goto yy923;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy979:\n-\tyyaccept = 13;\n+yy919:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych == 'T') goto yy984;\n-\t\tif (yych <= 'm') goto yy656;\n-\t\tgoto yy981;\n+\t\tif (yych == 'T') goto yy924;\n+\t\tif (yych <= 'm') goto yy596;\n+\t\tgoto yy921;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy982;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy922;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy980;\n-\t\t\tif (yych <= 't') goto yy983;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy920;\n+\t\t\tif (yych <= 't') goto yy923;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy980:\n+yy920:\n \tyych = *++YYCURSOR;\n-\tif (yych == 't') goto yy994;\n+\tif (yych == 't') goto yy934;\n \tgoto yy56;\n-yy981:\n+yy921:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'd') goto yy994;\n+\tif (yych == 'd') goto yy934;\n \tgoto yy56;\n-yy982:\n+yy922:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'd') goto yy994;\n+\tif (yych == 'd') goto yy934;\n \tgoto yy56;\n-yy983:\n+yy923:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'h') goto yy994;\n+\tif (yych == 'h') goto yy934;\n \tgoto yy56;\n-yy984:\n+yy924:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '1') goto yy985;\n-\tif (yych <= '2') goto yy986;\n-\tif (yych <= '9') goto yy987;\n+\tif (yych <= '1') goto yy925;\n+\tif (yych <= '2') goto yy926;\n+\tif (yych <= '9') goto yy927;\n \tgoto yy56;\n-yy985:\n+yy925:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy987;\n-\tif (yych <= ':') goto yy988;\n+\tif (yych <= '9') goto yy927;\n+\tif (yych <= ':') goto yy928;\n \tgoto yy56;\n-yy986:\n+yy926:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '4') goto yy987;\n-\tif (yych == ':') goto yy988;\n+\tif (yych <= '4') goto yy927;\n+\tif (yych == ':') goto yy928;\n \tgoto yy56;\n-yy987:\n+yy927:\n \tyych = *++YYCURSOR;\n \tif (yych != ':') goto yy56;\n-yy988:\n+yy928:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy989;\n-\tif (yych <= '9') goto yy990;\n+\tif (yych <= '5') goto yy929;\n+\tif (yych <= '9') goto yy930;\n \tgoto yy56;\n-yy989:\n+yy929:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy990;\n-\tif (yych <= ':') goto yy991;\n+\tif (yych <= '9') goto yy930;\n+\tif (yych <= ':') goto yy931;\n \tgoto yy56;\n-yy990:\n+yy930:\n \tyych = *++YYCURSOR;\n \tif (yych != ':') goto yy56;\n-yy991:\n+yy931:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy992;\n-\tif (yych <= '6') goto yy993;\n-\tif (yych <= '9') goto yy841;\n+\tif (yych <= '5') goto yy932;\n+\tif (yych <= '6') goto yy933;\n+\tif (yych <= '9') goto yy781;\n \tgoto yy56;\n-yy992:\n+yy932:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy842;\n-\tif (yych <= '9') goto yy841;\n-\tgoto yy842;\n-yy993:\n+\tif (yych <= '\/') goto yy782;\n+\tif (yych <= '9') goto yy781;\n+\tgoto yy782;\n+yy933:\n \tyych = *++YYCURSOR;\n-\tif (yych == '0') goto yy841;\n-\tgoto yy842;\n-yy994:\n-\tyyaccept = 13;\n+\tif (yych == '0') goto yy781;\n+\tgoto yy782;\n+yy934:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == 'T') goto yy984;\n-\tgoto yy656;\n-yy995:\n-\tyyaccept = 22;\n+\tif (yych == 'T') goto yy924;\n+\tgoto yy596;\n+yy935:\n+\tyyaccept = 21;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych != '-') goto yy973;\n+\tif (yych != '-') goto yy913;\n \tyych = *++YYCURSOR;\n \tif (yych <= '2') {\n \t\tif (yych <= '\/') goto yy56;\n-\t\tif (yych >= '1') goto yy998;\n+\t\tif (yych >= '1') goto yy938;\n \t} else {\n-\t\tif (yych <= '3') goto yy999;\n-\t\tif (yych <= '9') goto yy979;\n+\t\tif (yych <= '3') goto yy939;\n+\t\tif (yych <= '9') goto yy919;\n \t\tgoto yy56;\n \t}\n-\tyyaccept = 13;\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'm') {\n \t\tif (yych <= '9') {\n-\t\t\tif (yych <= '\/') goto yy656;\n-\t\t\tgoto yy1000;\n+\t\t\tif (yych <= '\/') goto yy596;\n+\t\t\tgoto yy940;\n \t\t} else {\n-\t\t\tif (yych == 'T') goto yy984;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych == 'T') goto yy924;\n+\t\t\tgoto yy596;\n \t\t}\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'n') goto yy981;\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy982;\n+\t\t\tif (yych <= 'n') goto yy921;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy922;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy980;\n-\t\t\tif (yych <= 't') goto yy983;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy920;\n+\t\t\tif (yych <= 't') goto yy923;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy998:\n-\tyyaccept = 13;\n+yy938:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'm') {\n \t\tif (yych <= '9') {\n-\t\t\tif (yych <= '\/') goto yy656;\n-\t\t\tgoto yy1000;\n+\t\t\tif (yych <= '\/') goto yy596;\n+\t\t\tgoto yy940;\n \t\t} else {\n-\t\t\tif (yych == 'T') goto yy984;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych == 'T') goto yy924;\n+\t\t\tgoto yy596;\n \t\t}\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'n') goto yy981;\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy982;\n+\t\t\tif (yych <= 'n') goto yy921;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy922;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy980;\n-\t\t\tif (yych <= 't') goto yy983;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy920;\n+\t\t\tif (yych <= 't') goto yy923;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy999:\n-\tyyaccept = 13;\n+yy939:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'm') {\n \t\tif (yych <= '1') {\n-\t\t\tif (yych <= '\/') goto yy656;\n+\t\t\tif (yych <= '\/') goto yy596;\n \t\t} else {\n-\t\t\tif (yych == 'T') goto yy984;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych == 'T') goto yy924;\n+\t\t\tgoto yy596;\n \t\t}\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'n') goto yy981;\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy982;\n+\t\t\tif (yych <= 'n') goto yy921;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy922;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy980;\n-\t\t\tif (yych <= 't') goto yy983;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy920;\n+\t\t\tif (yych <= 't') goto yy923;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy1000:\n-\tyyaccept = 21;\n+yy940:\n+\tyyaccept = 20;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych == 'T') goto yy1001;\n-\t\tif (yych <= 'm') goto yy454;\n-\t\tgoto yy981;\n+\t\tif (yych == 'T') goto yy941;\n+\t\tif (yych <= 'm') goto yy394;\n+\t\tgoto yy921;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy454;\n-\t\t\tgoto yy982;\n+\t\t\tif (yych <= 'q') goto yy394;\n+\t\t\tgoto yy922;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy980;\n-\t\t\tif (yych <= 't') goto yy983;\n-\t\t\tgoto yy454;\n+\t\t\tif (yych <= 's') goto yy920;\n+\t\t\tif (yych <= 't') goto yy923;\n+\t\t\tgoto yy394;\n \t\t}\n \t}\n-yy1001:\n+yy941:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '1') goto yy1002;\n-\tif (yych <= '2') goto yy1003;\n-\tif (yych <= '9') goto yy987;\n+\tif (yych <= '1') goto yy942;\n+\tif (yych <= '2') goto yy943;\n+\tif (yych <= '9') goto yy927;\n \tgoto yy56;\n-yy1002:\n+yy942:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy1004;\n-\tif (yych <= ':') goto yy988;\n+\tif (yych <= '9') goto yy944;\n+\tif (yych <= ':') goto yy928;\n \tgoto yy56;\n-yy1003:\n+yy943:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '4') goto yy1004;\n-\tif (yych == ':') goto yy988;\n+\tif (yych <= '4') goto yy944;\n+\tif (yych == ':') goto yy928;\n \tgoto yy56;\n-yy1004:\n+yy944:\n \tyych = *++YYCURSOR;\n \tif (yych != ':') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy1006;\n-\tif (yych <= '9') goto yy990;\n+\tif (yych <= '5') goto yy946;\n+\tif (yych <= '9') goto yy930;\n \tgoto yy56;\n-yy1006:\n+yy946:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy1007;\n-\tif (yych <= ':') goto yy991;\n+\tif (yych <= '9') goto yy947;\n+\tif (yych <= ':') goto yy931;\n \tgoto yy56;\n-yy1007:\n+yy947:\n \tyych = *++YYCURSOR;\n \tif (yych != ':') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy1009;\n-\tif (yych <= '6') goto yy1010;\n-\tif (yych <= '9') goto yy841;\n+\tif (yych <= '5') goto yy949;\n+\tif (yych <= '6') goto yy950;\n+\tif (yych <= '9') goto yy781;\n \tgoto yy56;\n-yy1009:\n+yy949:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy842;\n-\tif (yych <= '9') goto yy1011;\n-\tgoto yy842;\n-yy1010:\n+\tif (yych <= '\/') goto yy782;\n+\tif (yych <= '9') goto yy951;\n+\tgoto yy782;\n+yy950:\n \tyych = *++YYCURSOR;\n-\tif (yych != '0') goto yy842;\n-yy1011:\n-\tyyaccept = 23;\n+\tif (yych != '0') goto yy782;\n+yy951:\n+\tyyaccept = 22;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych != '.') goto yy842;\n+\tif (yych != '.') goto yy782;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n-yy1013:\n-\tyyaccept = 23;\n+yy953:\n+\tyyaccept = 22;\n \tYYMARKER = ++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 9) YYFILL(9);\n \tyych = *YYCURSOR;\n \tif (yych <= '-') {\n-\t\tif (yych == '+') goto yy1016;\n-\t\tif (yych <= ',') goto yy842;\n-\t\tgoto yy1016;\n+\t\tif (yych == '+') goto yy956;\n+\t\tif (yych <= ',') goto yy782;\n+\t\tgoto yy956;\n \t} else {\n \t\tif (yych <= '9') {\n-\t\t\tif (yych <= '\/') goto yy842;\n-\t\t\tgoto yy1013;\n+\t\t\tif (yych <= '\/') goto yy782;\n+\t\t\tgoto yy953;\n \t\t} else {\n-\t\t\tif (yych != 'G') goto yy842;\n+\t\t\tif (yych != 'G') goto yy782;\n \t\t}\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy1022;\n+\tif (yych == 'M') goto yy962;\n \tgoto yy56;\n-yy1016:\n+yy956:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '1') goto yy1017;\n-\tif (yych <= '2') goto yy1018;\n-\tif (yych <= '9') goto yy1019;\n+\tif (yych <= '1') goto yy957;\n+\tif (yych <= '2') goto yy958;\n+\tif (yych <= '9') goto yy959;\n \tgoto yy56;\n-yy1017:\n+yy957:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy842;\n-\tif (yych <= '9') goto yy1019;\n-\tif (yych <= ':') goto yy1020;\n-\tgoto yy842;\n-yy1018:\n+\tif (yych <= '\/') goto yy782;\n+\tif (yych <= '9') goto yy959;\n+\tif (yych <= ':') goto yy960;\n+\tgoto yy782;\n+yy958:\n \tyych = *++YYCURSOR;\n \tif (yych <= '5') {\n-\t\tif (yych <= '\/') goto yy842;\n-\t\tif (yych >= '5') goto yy1021;\n+\t\tif (yych <= '\/') goto yy782;\n+\t\tif (yych >= '5') goto yy961;\n \t} else {\n-\t\tif (yych <= '9') goto yy841;\n-\t\tif (yych <= ':') goto yy1020;\n-\t\tgoto yy842;\n+\t\tif (yych <= '9') goto yy781;\n+\t\tif (yych <= ':') goto yy960;\n+\t\tgoto yy782;\n \t}\n-yy1019:\n+yy959:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy842;\n-\tif (yych <= '5') goto yy1021;\n-\tif (yych <= '9') goto yy841;\n-\tif (yych >= ';') goto yy842;\n-yy1020:\n+\tif (yych <= '\/') goto yy782;\n+\tif (yych <= '5') goto yy961;\n+\tif (yych <= '9') goto yy781;\n+\tif (yych >= ';') goto yy782;\n+yy960:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy842;\n-\tif (yych <= '5') goto yy1021;\n-\tif (yych <= '9') goto yy841;\n-\tgoto yy842;\n-yy1021:\n+\tif (yych <= '\/') goto yy782;\n+\tif (yych <= '5') goto yy961;\n+\tif (yych <= '9') goto yy781;\n+\tgoto yy782;\n+yy961:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy842;\n-\tif (yych <= '9') goto yy841;\n-\tgoto yy842;\n-yy1022:\n+\tif (yych <= '\/') goto yy782;\n+\tif (yych <= '9') goto yy781;\n+\tgoto yy782;\n+yy962:\n \tyych = *++YYCURSOR;\n \tif (yych != 'T') goto yy56;\n \tyych = *++YYCURSOR;\n-\tif (yych == '+') goto yy1016;\n-\tif (yych == '-') goto yy1016;\n+\tif (yych == '+') goto yy956;\n+\tif (yych == '-') goto yy956;\n \tgoto yy56;\n-yy1024:\n+yy964:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy1025;\n+\tif (yych == 'C') goto yy965;\n \tif (yych != 'c') goto yy56;\n-yy1025:\n-\tyyaccept = 20;\n+yy965:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n-\t\tif (yych == '-') goto yy766;\n-\t\tgoto yy793;\n+\t\tif (yych == '-') goto yy706;\n+\t\tgoto yy733;\n \t} else {\n-\t\tif (yych <= 'E') goto yy879;\n-\t\tif (yych == 'e') goto yy879;\n-\t\tgoto yy793;\n+\t\tif (yych <= 'E') goto yy819;\n+\t\tif (yych == 'e') goto yy819;\n+\t\tgoto yy733;\n \t}\n-yy1026:\n+yy966:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'V') goto yy1027;\n+\tif (yych == 'V') goto yy967;\n \tif (yych != 'v') goto yy56;\n-yy1027:\n-\tyyaccept = 20;\n+yy967:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n-\t\tif (yych == '-') goto yy766;\n-\t\tgoto yy793;\n+\t\tif (yych == '-') goto yy706;\n+\t\tgoto yy733;\n \t} else {\n-\t\tif (yych <= 'E') goto yy886;\n-\t\tif (yych == 'e') goto yy886;\n-\t\tgoto yy793;\n+\t\tif (yych <= 'E') goto yy826;\n+\t\tif (yych == 'e') goto yy826;\n+\t\tgoto yy733;\n \t}\n-yy1028:\n+yy968:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy1029;\n+\tif (yych == 'T') goto yy969;\n \tif (yych != 't') goto yy56;\n-yy1029:\n-\tyyaccept = 20;\n+yy969:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'N') {\n-\t\tif (yych == '-') goto yy766;\n-\t\tgoto yy793;\n+\t\tif (yych == '-') goto yy706;\n+\t\tgoto yy733;\n \t} else {\n-\t\tif (yych <= 'O') goto yy892;\n-\t\tif (yych == 'o') goto yy892;\n-\t\tgoto yy793;\n+\t\tif (yych <= 'O') goto yy832;\n+\t\tif (yych == 'o') goto yy832;\n+\t\tgoto yy733;\n \t}\n-yy1030:\n+yy970:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'P') goto yy1031;\n+\tif (yych == 'P') goto yy971;\n \tif (yych != 'p') goto yy56;\n-yy1031:\n-\tyyaccept = 20;\n+yy971:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n-\t\tif (yych == '-') goto yy766;\n-\t\tgoto yy793;\n+\t\tif (yych == '-') goto yy706;\n+\t\tgoto yy733;\n \t} else {\n-\t\tif (yych <= 'T') goto yy1032;\n-\t\tif (yych != 't') goto yy793;\n+\t\tif (yych <= 'T') goto yy972;\n+\t\tif (yych != 't') goto yy733;\n \t}\n-yy1032:\n-\tyyaccept = 20;\n+yy972:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n-\t\tif (yych == '-') goto yy766;\n-\t\tgoto yy793;\n+\t\tif (yych == '-') goto yy706;\n+\t\tgoto yy733;\n \t} else {\n-\t\tif (yych <= 'E') goto yy898;\n-\t\tif (yych == 'e') goto yy898;\n-\t\tgoto yy793;\n+\t\tif (yych <= 'E') goto yy838;\n+\t\tif (yych == 'e') goto yy838;\n+\t\tgoto yy733;\n \t}\n-yy1033:\n+yy973:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'G') goto yy1036;\n-\tif (yych == 'g') goto yy1036;\n+\tif (yych == 'G') goto yy976;\n+\tif (yych == 'g') goto yy976;\n \tgoto yy56;\n-yy1034:\n+yy974:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy1035;\n+\tif (yych == 'R') goto yy975;\n \tif (yych != 'r') goto yy56;\n-yy1035:\n-\tyyaccept = 20;\n+yy975:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'H') {\n-\t\tif (yych == '-') goto yy766;\n-\t\tgoto yy793;\n+\t\tif (yych == '-') goto yy706;\n+\t\tgoto yy733;\n \t} else {\n-\t\tif (yych <= 'I') goto yy905;\n-\t\tif (yych == 'i') goto yy905;\n-\t\tgoto yy793;\n+\t\tif (yych <= 'I') goto yy845;\n+\t\tif (yych == 'i') goto yy845;\n+\t\tgoto yy733;\n \t}\n-yy1036:\n-\tyyaccept = 20;\n+yy976:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n-\t\tif (yych == '-') goto yy766;\n-\t\tgoto yy793;\n+\t\tif (yych == '-') goto yy706;\n+\t\tgoto yy733;\n \t} else {\n-\t\tif (yych <= 'U') goto yy907;\n-\t\tif (yych == 'u') goto yy907;\n-\t\tgoto yy793;\n+\t\tif (yych <= 'U') goto yy847;\n+\t\tif (yych == 'u') goto yy847;\n+\t\tgoto yy733;\n \t}\n-yy1037:\n+yy977:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'Y') {\n-\t\tif (yych == 'R') goto yy1038;\n+\t\tif (yych == 'R') goto yy978;\n \t\tif (yych <= 'X') goto yy56;\n-\t\tgoto yy1039;\n+\t\tgoto yy979;\n \t} else {\n \t\tif (yych <= 'r') {\n \t\t\tif (yych <= 'q') goto yy56;\n \t\t} else {\n-\t\t\tif (yych == 'y') goto yy1039;\n+\t\t\tif (yych == 'y') goto yy979;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy1038:\n-\tyyaccept = 20;\n+yy978:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'B') {\n-\t\tif (yych == '-') goto yy766;\n-\t\tgoto yy793;\n+\t\tif (yych == '-') goto yy706;\n+\t\tgoto yy733;\n \t} else {\n-\t\tif (yych <= 'C') goto yy911;\n-\t\tif (yych == 'c') goto yy911;\n-\t\tgoto yy793;\n+\t\tif (yych <= 'C') goto yy851;\n+\t\tif (yych == 'c') goto yy851;\n+\t\tgoto yy733;\n \t}\n-yy1039:\n-\tyyaccept = 20;\n+yy979:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '-') goto yy766;\n-\tgoto yy793;\n-yy1040:\n+\tif (yych == '-') goto yy706;\n+\tgoto yy733;\n+yy980:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'B') goto yy1041;\n+\tif (yych == 'B') goto yy981;\n \tif (yych != 'b') goto yy56;\n-yy1041:\n-\tyyaccept = 20;\n+yy981:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n-\t\tif (yych == '-') goto yy766;\n-\t\tgoto yy793;\n+\t\tif (yych == '-') goto yy706;\n+\t\tgoto yy733;\n \t} else {\n-\t\tif (yych <= 'R') goto yy914;\n-\t\tif (yych == 'r') goto yy914;\n-\t\tgoto yy793;\n+\t\tif (yych <= 'R') goto yy854;\n+\t\tif (yych == 'r') goto yy854;\n+\t\tgoto yy733;\n \t}\n-yy1042:\n+yy982:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n-\t\tif (yych == 'L') goto yy1046;\n+\t\tif (yych == 'L') goto yy986;\n \t\tif (yych <= 'M') goto yy56;\n-\t\tgoto yy1045;\n+\t\tgoto yy985;\n \t} else {\n \t\tif (yych <= 'l') {\n \t\t\tif (yych <= 'k') goto yy56;\n-\t\t\tgoto yy1046;\n+\t\t\tgoto yy986;\n \t\t} else {\n-\t\t\tif (yych == 'n') goto yy1045;\n+\t\t\tif (yych == 'n') goto yy985;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy1043:\n+yy983:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'N') goto yy1044;\n+\tif (yych == 'N') goto yy984;\n \tif (yych != 'n') goto yy56;\n-yy1044:\n-\tyyaccept = 20;\n+yy984:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n-\t\tif (yych == '-') goto yy766;\n-\t\tgoto yy793;\n+\t\tif (yych == '-') goto yy706;\n+\t\tgoto yy733;\n \t} else {\n-\t\tif (yych <= 'U') goto yy921;\n-\t\tif (yych == 'u') goto yy921;\n-\t\tgoto yy793;\n+\t\tif (yych <= 'U') goto yy861;\n+\t\tif (yych == 'u') goto yy861;\n+\t\tgoto yy733;\n \t}\n-yy1045:\n-\tyyaccept = 20;\n+yy985:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n-\t\tif (yych == '-') goto yy766;\n-\t\tgoto yy793;\n+\t\tif (yych == '-') goto yy706;\n+\t\tgoto yy733;\n \t} else {\n-\t\tif (yych <= 'E') goto yy883;\n-\t\tif (yych == 'e') goto yy883;\n-\t\tgoto yy793;\n+\t\tif (yych <= 'E') goto yy823;\n+\t\tif (yych == 'e') goto yy823;\n+\t\tgoto yy733;\n \t}\n-yy1046:\n-\tyyaccept = 20;\n+yy986:\n+\tyyaccept = 19;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'X') {\n-\t\tif (yych == '-') goto yy766;\n-\t\tgoto yy793;\n+\t\tif (yych == '-') goto yy706;\n+\t\tgoto yy733;\n \t} else {\n-\t\tif (yych <= 'Y') goto yy883;\n-\t\tif (yych == 'y') goto yy883;\n-\t\tgoto yy793;\n+\t\tif (yych <= 'Y') goto yy823;\n+\t\tif (yych == 'y') goto yy823;\n+\t\tgoto yy733;\n \t}\n-yy1047:\n+yy987:\n \tyych = *++YYCURSOR;\n \tif (yych <= '.') {\n \t\tif (yych <= '\\t') {\n-\t\t\tif (yych <= 0x08) goto yy577;\n-\t\t\tgoto yy730;\n+\t\t\tif (yych <= 0x08) goto yy517;\n+\t\t\tgoto yy670;\n \t\t} else {\n-\t\t\tif (yych <= ',') goto yy577;\n-\t\t\tif (yych <= '-') goto yy731;\n-\t\t\tgoto yy730;\n+\t\t\tif (yych <= ',') goto yy517;\n+\t\t\tif (yych <= '-') goto yy671;\n+\t\t\tgoto yy670;\n \t\t}\n \t} else {\n \t\tif (yych <= 'U') {\n-\t\t\tif (yych <= '\/') goto yy729;\n-\t\t\tif (yych <= 'T') goto yy577;\n+\t\t\tif (yych <= '\/') goto yy669;\n+\t\t\tif (yych <= 'T') goto yy517;\n \t\t\tgoto yy77;\n \t\t} else {\n \t\t\tif (yych == 'u') goto yy77;\n-\t\t\tgoto yy577;\n+\t\t\tgoto yy517;\n \t\t}\n \t}\n-yy1048:\n+yy988:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'P') {\n \t\tif (yych == 'C') goto yy128;\n \t\tif (yych <= 'O') goto yy56;\n-\t\tgoto yy585;\n+\t\tgoto yy525;\n \t} else {\n \t\tif (yych <= 'c') {\n \t\t\tif (yych <= 'b') goto yy56;\n \t\t\tgoto yy128;\n \t\t} else {\n-\t\t\tif (yych == 'p') goto yy585;\n+\t\t\tif (yych == 'p') goto yy525;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy1049:\n+yy989:\n \tyych = *++YYCURSOR;\n \tif (yych <= '9') {\n \t\tif (yych <= ',') {\n-\t\t\tif (yych == '\\t') goto yy1051;\n-\t\t\tgoto yy1053;\n+\t\t\tif (yych == '\\t') goto yy991;\n+\t\t\tgoto yy993;\n \t\t} else {\n-\t\t\tif (yych <= '-') goto yy1050;\n-\t\t\tif (yych <= '.') goto yy730;\n-\t\t\tif (yych <= '\/') goto yy729;\n-\t\t\tgoto yy740;\n+\t\t\tif (yych <= '-') goto yy990;\n+\t\t\tif (yych <= '.') goto yy670;\n+\t\t\tif (yych <= '\/') goto yy669;\n+\t\t\tgoto yy680;\n \t\t}\n \t} else {\n \t\tif (yych <= 'q') {\n-\t\t\tif (yych == 'n') goto yy469;\n-\t\t\tgoto yy1053;\n+\t\t\tif (yych == 'n') goto yy409;\n+\t\t\tgoto yy993;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy470;\n-\t\t\tif (yych <= 's') goto yy463;\n-\t\t\tif (yych <= 't') goto yy467;\n-\t\t\tgoto yy1053;\n+\t\t\tif (yych <= 'r') goto yy410;\n+\t\t\tif (yych <= 's') goto yy403;\n+\t\t\tif (yych <= 't') goto yy407;\n+\t\t\tgoto yy993;\n \t\t}\n \t}\n-yy1050:\n+yy990:\n \tyych = *++YYCURSOR;\n \tswitch (yych) {\n-\tcase '0':\tgoto yy1054;\n-\tcase '1':\tgoto yy1055;\n+\tcase '0':\tgoto yy994;\n+\tcase '1':\tgoto yy995;\n \tcase '2':\n \tcase '3':\n \tcase '4':\n@@ -14293,230 +13389,230 @@ yy1050:\n \tcase '6':\n \tcase '7':\n \tcase '8':\n-\tcase '9':\tgoto yy617;\n+\tcase '9':\tgoto yy557;\n \tcase 'A':\n-\tcase 'a':\tgoto yy621;\n+\tcase 'a':\tgoto yy561;\n \tcase 'D':\n-\tcase 'd':\tgoto yy625;\n+\tcase 'd':\tgoto yy565;\n \tcase 'F':\n-\tcase 'f':\tgoto yy619;\n+\tcase 'f':\tgoto yy559;\n \tcase 'J':\n-\tcase 'j':\tgoto yy618;\n+\tcase 'j':\tgoto yy558;\n \tcase 'M':\n-\tcase 'm':\tgoto yy620;\n+\tcase 'm':\tgoto yy560;\n \tcase 'N':\n-\tcase 'n':\tgoto yy624;\n+\tcase 'n':\tgoto yy564;\n \tcase 'O':\n-\tcase 'o':\tgoto yy623;\n+\tcase 'o':\tgoto yy563;\n \tcase 'S':\n-\tcase 's':\tgoto yy622;\n-\tdefault:\tgoto yy577;\n+\tcase 's':\tgoto yy562;\n+\tdefault:\tgoto yy517;\n \t}\n-yy1051:\n+yy991:\n \tyych = *++YYCURSOR;\n-\tif (yych <= '\/') goto yy1053;\n-\tif (yych <= '0') goto yy735;\n-\tif (yych <= '1') goto yy736;\n-\tif (yych <= '9') goto yy737;\n-\tgoto yy1053;\n-yy1052:\n+\tif (yych <= '\/') goto yy993;\n+\tif (yych <= '0') goto yy675;\n+\tif (yych <= '1') goto yy676;\n+\tif (yych <= '9') goto yy677;\n+\tgoto yy993;\n+yy992:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 13) YYFILL(13);\n \tyych = *YYCURSOR;\n-yy1053:\n+yy993:\n \tswitch (yych) {\n \tcase '\\t':\n-\tcase ' ':\tgoto yy1052;\n+\tcase ' ':\tgoto yy992;\n \tcase '-':\n-\tcase '.':\tgoto yy576;\n+\tcase '.':\tgoto yy516;\n \tcase 'A':\n-\tcase 'a':\tgoto yy573;\n+\tcase 'a':\tgoto yy513;\n \tcase 'D':\n-\tcase 'd':\tgoto yy465;\n+\tcase 'd':\tgoto yy405;\n \tcase 'F':\n-\tcase 'f':\tgoto yy466;\n+\tcase 'f':\tgoto yy406;\n \tcase 'H':\n \tcase 'h':\tgoto yy63;\n-\tcase 'I':\tgoto yy474;\n+\tcase 'I':\tgoto yy414;\n \tcase 'J':\n-\tcase 'j':\tgoto yy478;\n+\tcase 'j':\tgoto yy418;\n \tcase 'M':\n-\tcase 'm':\tgoto yy464;\n+\tcase 'm':\tgoto yy404;\n \tcase 'N':\n-\tcase 'n':\tgoto yy481;\n+\tcase 'n':\tgoto yy421;\n \tcase 'O':\n-\tcase 'o':\tgoto yy480;\n+\tcase 'o':\tgoto yy420;\n \tcase 'S':\n-\tcase 's':\tgoto yy462;\n+\tcase 's':\tgoto yy402;\n \tcase 'T':\n \tcase 't':\tgoto yy68;\n-\tcase 'V':\tgoto yy476;\n+\tcase 'V':\tgoto yy416;\n \tcase 'W':\n \tcase 'w':\tgoto yy67;\n-\tcase 'X':\tgoto yy477;\n+\tcase 'X':\tgoto yy417;\n \tcase 'Y':\n \tcase 'y':\tgoto yy66;\n \tdefault:\tgoto yy56;\n \t}\n-yy1054:\n+yy994:\n \tyych = *++YYCURSOR;\n \tif (yych <= '.') {\n \t\tif (yych <= ',') goto yy56;\n-\t\tif (yych <= '-') goto yy654;\n-\t\tgoto yy601;\n+\t\tif (yych <= '-') goto yy594;\n+\t\tgoto yy541;\n \t} else {\n \t\tif (yych <= '\/') goto yy56;\n-\t\tif (yych <= '9') goto yy1056;\n+\t\tif (yych <= '9') goto yy996;\n \t\tgoto yy56;\n \t}\n-yy1055:\n+yy995:\n \tyych = *++YYCURSOR;\n \tif (yych <= '.') {\n \t\tif (yych <= ',') goto yy56;\n-\t\tif (yych <= '-') goto yy654;\n-\t\tgoto yy601;\n+\t\tif (yych <= '-') goto yy594;\n+\t\tgoto yy541;\n \t} else {\n \t\tif (yych <= '\/') goto yy56;\n \t\tif (yych >= '3') goto yy56;\n \t}\n-yy1056:\n+yy996:\n \tyych = *++YYCURSOR;\n \tif (yych <= ',') goto yy56;\n-\tif (yych <= '-') goto yy1057;\n-\tif (yych <= '.') goto yy601;\n+\tif (yych <= '-') goto yy997;\n+\tif (yych <= '.') goto yy541;\n \tgoto yy56;\n-yy1057:\n+yy997:\n \tyych = *++YYCURSOR;\n \tif (yych <= '2') {\n \t\tif (yych <= '\/') goto yy56;\n-\t\tif (yych >= '1') goto yy1059;\n+\t\tif (yych >= '1') goto yy999;\n \t} else {\n-\t\tif (yych <= '3') goto yy1060;\n-\t\tif (yych <= '9') goto yy658;\n+\t\tif (yych <= '3') goto yy1000;\n+\t\tif (yych <= '9') goto yy598;\n \t\tgoto yy56;\n \t}\n-\tyyaccept = 13;\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy656;\n-\t\tif (yych <= '9') goto yy1061;\n-\t\tif (yych <= 'm') goto yy656;\n-\t\tgoto yy660;\n+\t\tif (yych <= '\/') goto yy596;\n+\t\tif (yych <= '9') goto yy1001;\n+\t\tif (yych <= 'm') goto yy596;\n+\t\tgoto yy600;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy661;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy1059:\n-\tyyaccept = 13;\n+yy999:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy656;\n-\t\tif (yych <= '9') goto yy1061;\n-\t\tif (yych <= 'm') goto yy656;\n-\t\tgoto yy660;\n+\t\tif (yych <= '\/') goto yy596;\n+\t\tif (yych <= '9') goto yy1001;\n+\t\tif (yych <= 'm') goto yy596;\n+\t\tgoto yy600;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy661;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy1060:\n-\tyyaccept = 13;\n+yy1000:\n+\tyyaccept = 12;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n \t\tif (yych <= '1') {\n-\t\t\tif (yych <= '\/') goto yy656;\n+\t\t\tif (yych <= '\/') goto yy596;\n \t\t} else {\n-\t\t\tif (yych <= '9') goto yy603;\n-\t\t\tif (yych <= 'm') goto yy656;\n-\t\t\tgoto yy660;\n+\t\t\tif (yych <= '9') goto yy543;\n+\t\t\tif (yych <= 'm') goto yy596;\n+\t\t\tgoto yy600;\n \t\t}\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy656;\n-\t\t\tgoto yy661;\n+\t\t\tif (yych <= 'q') goto yy596;\n+\t\t\tgoto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n-\t\t\tgoto yy656;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n+\t\t\tgoto yy596;\n \t\t}\n \t}\n-yy1061:\n-\tyyaccept = 15;\n+yy1001:\n+\tyyaccept = 14;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'n') {\n-\t\tif (yych <= '\/') goto yy763;\n-\t\tif (yych <= '9') goto yy604;\n-\t\tif (yych <= 'm') goto yy763;\n-\t\tgoto yy660;\n+\t\tif (yych <= '\/') goto yy703;\n+\t\tif (yych <= '9') goto yy544;\n+\t\tif (yych <= 'm') goto yy703;\n+\t\tgoto yy600;\n \t} else {\n \t\tif (yych <= 'r') {\n-\t\t\tif (yych <= 'q') goto yy763;\n-\t\t\tgoto yy661;\n+\t\t\tif (yych <= 'q') goto yy703;\n+\t\t\tgoto yy601;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy659;\n-\t\t\tif (yych <= 't') goto yy662;\n-\t\t\tgoto yy763;\n+\t\t\tif (yych <= 's') goto yy599;\n+\t\t\tif (yych <= 't') goto yy602;\n+\t\t\tgoto yy703;\n \t\t}\n \t}\n-yy1062:\n+yy1002:\n \tyych = *++YYCURSOR;\n \tif (yych <= '9') {\n \t\tif (yych <= '-') {\n-\t\t\tif (yych == '\\t') goto yy1051;\n-\t\t\tif (yych <= ',') goto yy1053;\n-\t\t\tgoto yy1050;\n+\t\t\tif (yych == '\\t') goto yy991;\n+\t\t\tif (yych <= ',') goto yy993;\n+\t\t\tgoto yy990;\n \t\t} else {\n-\t\t\tif (yych <= '.') goto yy1063;\n-\t\t\tif (yych <= '\/') goto yy729;\n-\t\t\tif (yych <= '5') goto yy1065;\n-\t\t\tgoto yy740;\n+\t\t\tif (yych <= '.') goto yy1003;\n+\t\t\tif (yych <= '\/') goto yy669;\n+\t\t\tif (yych <= '5') goto yy1005;\n+\t\t\tgoto yy680;\n \t\t}\n \t} else {\n \t\tif (yych <= 'q') {\n-\t\t\tif (yych <= ':') goto yy1064;\n-\t\t\tif (yych == 'n') goto yy469;\n-\t\t\tgoto yy1053;\n+\t\t\tif (yych <= ':') goto yy1004;\n+\t\t\tif (yych == 'n') goto yy409;\n+\t\t\tgoto yy993;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy470;\n-\t\t\tif (yych <= 's') goto yy463;\n-\t\t\tif (yych <= 't') goto yy467;\n-\t\t\tgoto yy1053;\n+\t\t\tif (yych <= 'r') goto yy410;\n+\t\t\tif (yych <= 's') goto yy403;\n+\t\t\tif (yych <= 't') goto yy407;\n+\t\t\tgoto yy993;\n \t\t}\n \t}\n-yy1063:\n+yy1003:\n \tyych = *++YYCURSOR;\n \tif (yych <= '1') {\n-\t\tif (yych <= '\/') goto yy577;\n-\t\tif (yych <= '0') goto yy1087;\n-\t\tgoto yy1088;\n+\t\tif (yych <= '\/') goto yy517;\n+\t\tif (yych <= '0') goto yy1027;\n+\t\tgoto yy1028;\n \t} else {\n-\t\tif (yych <= '5') goto yy1089;\n-\t\tif (yych <= '9') goto yy1090;\n-\t\tgoto yy577;\n+\t\tif (yych <= '5') goto yy1029;\n+\t\tif (yych <= '9') goto yy1030;\n+\t\tgoto yy517;\n \t}\n-yy1064:\n+yy1004:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy1082;\n-\tif (yych <= '9') goto yy1083;\n+\tif (yych <= '5') goto yy1022;\n+\tif (yych <= '9') goto yy1023;\n \tgoto yy56;\n-yy1065:\n+yy1005:\n \tyych = *++YYCURSOR;\n-\tif (yych == '-') goto yy784;\n+\tif (yych == '-') goto yy724;\n \tif (yych <= '\/') goto yy60;\n \tif (yych >= ':') goto yy60;\n-\tyyaccept = 24;\n+\tyyaccept = 23;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tswitch (yych) {\n \tcase '\\t':\n@@ -14546,25 +13642,25 @@ yy1065:\n \tcase 's':\n \tcase 't':\n \tcase 'w':\n-\tcase 'y':\tgoto yy790;\n-\tcase '-':\tgoto yy787;\n-\tcase '.':\tgoto yy791;\n-\tcase '\/':\tgoto yy788;\n-\tcase '0':\tgoto yy1068;\n-\tcase '1':\tgoto yy1069;\n-\tcase '2':\tgoto yy1070;\n-\tcase '3':\tgoto yy1071;\n+\tcase 'y':\tgoto yy730;\n+\tcase '-':\tgoto yy727;\n+\tcase '.':\tgoto yy731;\n+\tcase '\/':\tgoto yy728;\n+\tcase '0':\tgoto yy1008;\n+\tcase '1':\tgoto yy1009;\n+\tcase '2':\tgoto yy1010;\n+\tcase '3':\tgoto yy1011;\n \tcase '4':\n-\tcase '5':\tgoto yy1072;\n-\tcase '6':\tgoto yy1073;\n+\tcase '5':\tgoto yy1012;\n+\tcase '6':\tgoto yy1013;\n \tcase '7':\n \tcase '8':\n \tcase '9':\tgoto yy54;\n-\tcase ':':\tgoto yy806;\n-\tcase 'W':\tgoto yy809;\n-\tdefault:\tgoto yy1067;\n+\tcase ':':\tgoto yy746;\n+\tcase 'W':\tgoto yy749;\n+\tdefault:\tgoto yy1007;\n \t}\n-yy1067:\n+yy1007:\n #line 1161 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tDEBUG_OUTPUT(\"gnunocolon\");\n@@ -14587,44 +13683,44 @@ yy1067:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_GNU_NOCOLON;\n \t}\n-#line 14591 \"<stdout>\"\n-yy1068:\n+#line 13687 \"<stdout>\"\n+yy1008:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '0') goto yy1080;\n-\tif (yych <= '9') goto yy1081;\n+\tif (yych <= '0') goto yy1020;\n+\tif (yych <= '9') goto yy1021;\n \tgoto yy60;\n-yy1069:\n+yy1009:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '2') goto yy1079;\n-\tif (yych <= '9') goto yy1078;\n+\tif (yych <= '2') goto yy1019;\n+\tif (yych <= '9') goto yy1018;\n \tgoto yy60;\n-yy1070:\n+yy1010:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '9') goto yy1078;\n+\tif (yych <= '9') goto yy1018;\n \tgoto yy60;\n-yy1071:\n+yy1011:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '5') goto yy1076;\n-\tif (yych <= '6') goto yy1077;\n-\tif (yych <= '9') goto yy1074;\n+\tif (yych <= '5') goto yy1016;\n+\tif (yych <= '6') goto yy1017;\n+\tif (yych <= '9') goto yy1014;\n \tgoto yy60;\n-yy1072:\n+yy1012:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '9') goto yy1074;\n+\tif (yych <= '9') goto yy1014;\n \tgoto yy60;\n-yy1073:\n+yy1013:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy60;\n-\tif (yych <= '0') goto yy1074;\n+\tif (yych <= '0') goto yy1014;\n \tif (yych <= '9') goto yy54;\n \tgoto yy60;\n-yy1074:\n-\tyyaccept = 25;\n+yy1014:\n+\tyyaccept = 24;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yybm[0+yych] & 2) {\n \t\tgoto yy54;\n@@ -14643,7 +13739,7 @@ yy1074:\n \t\t\t\tif (yych == 'H') goto yy60;\n \t\t\t\tif (yych >= 'M') goto yy60;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'R') goto yy1075;\n+\t\t\t\tif (yych <= 'R') goto yy1015;\n \t\t\t\tif (yych <= 'T') goto yy60;\n \t\t\t\tif (yych >= 'W') goto yy60;\n \t\t\t}\n@@ -14670,7 +13766,7 @@ yy1074:\n \t\t\t}\n \t\t}\n \t}\n-yy1075:\n+yy1015:\n #line 1207 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tint tz_not_found;\n@@ -14690,232 +13786,232 @@ yy1075:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_ISO_NOCOLON;\n \t}\n-#line 14694 \"<stdout>\"\n-yy1076:\n-\tyyaccept = 25;\n+#line 13790 \"<stdout>\"\n+yy1016:\n+\tyyaccept = 24;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'V') {\n \t\tif (yych <= 'D') {\n \t\t\tif (yych <= ' ') {\n \t\t\t\tif (yych == '\\t') goto yy60;\n-\t\t\t\tif (yych <= 0x1F) goto yy1075;\n+\t\t\t\tif (yych <= 0x1F) goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n-\t\t\t\tif (yych <= '\/') goto yy1075;\n-\t\t\t\tif (yych <= '9') goto yy820;\n-\t\t\t\tif (yych <= 'C') goto yy1075;\n+\t\t\t\tif (yych <= '\/') goto yy1015;\n+\t\t\t\tif (yych <= '9') goto yy760;\n+\t\t\t\tif (yych <= 'C') goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'H') {\n \t\t\t\tif (yych == 'F') goto yy60;\n-\t\t\t\tif (yych <= 'G') goto yy1075;\n+\t\t\t\tif (yych <= 'G') goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'M') {\n-\t\t\t\t\tif (yych <= 'L') goto yy1075;\n+\t\t\t\t\tif (yych <= 'L') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= 'R') goto yy1075;\n+\t\t\t\t\tif (yych <= 'R') goto yy1015;\n \t\t\t\t\tif (yych <= 'T') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= 'h') {\n \t\t\tif (yych <= 'c') {\n-\t\t\t\tif (yych == 'X') goto yy1075;\n+\t\t\t\tif (yych == 'X') goto yy1015;\n \t\t\t\tif (yych <= 'Y') goto yy60;\n-\t\t\t\tgoto yy1075;\n+\t\t\t\tgoto yy1015;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'e') {\n \t\t\t\t\tif (yych <= 'd') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych == 'g') goto yy1075;\n+\t\t\t\t\tif (yych == 'g') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n \t\t\t\tif (yych == 'm') goto yy60;\n-\t\t\t\tif (yych <= 'r') goto yy1075;\n+\t\t\t\tif (yych <= 'r') goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'w') {\n-\t\t\t\t\tif (yych <= 'v') goto yy1075;\n+\t\t\t\t\tif (yych <= 'v') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'y') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t}\n-yy1077:\n-\tyyaccept = 25;\n+yy1017:\n+\tyyaccept = 24;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'V') {\n \t\tif (yych <= 'D') {\n \t\t\tif (yych <= ' ') {\n \t\t\t\tif (yych == '\\t') goto yy60;\n-\t\t\t\tif (yych <= 0x1F) goto yy1075;\n+\t\t\t\tif (yych <= 0x1F) goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= '6') {\n-\t\t\t\t\tif (yych <= '\/') goto yy1075;\n-\t\t\t\t\tgoto yy820;\n+\t\t\t\t\tif (yych <= '\/') goto yy1015;\n+\t\t\t\t\tgoto yy760;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych <= '9') goto yy54;\n-\t\t\t\t\tif (yych <= 'C') goto yy1075;\n+\t\t\t\t\tif (yych <= 'C') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'H') {\n \t\t\t\tif (yych == 'F') goto yy60;\n-\t\t\t\tif (yych <= 'G') goto yy1075;\n+\t\t\t\tif (yych <= 'G') goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'M') {\n-\t\t\t\t\tif (yych <= 'L') goto yy1075;\n+\t\t\t\t\tif (yych <= 'L') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= 'R') goto yy1075;\n+\t\t\t\t\tif (yych <= 'R') goto yy1015;\n \t\t\t\t\tif (yych <= 'T') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= 'h') {\n \t\t\tif (yych <= 'c') {\n-\t\t\t\tif (yych == 'X') goto yy1075;\n+\t\t\t\tif (yych == 'X') goto yy1015;\n \t\t\t\tif (yych <= 'Y') goto yy60;\n-\t\t\t\tgoto yy1075;\n+\t\t\t\tgoto yy1015;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'e') {\n \t\t\t\t\tif (yych <= 'd') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych == 'g') goto yy1075;\n+\t\t\t\t\tif (yych == 'g') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n \t\t\t\tif (yych == 'm') goto yy60;\n-\t\t\t\tif (yych <= 'r') goto yy1075;\n+\t\t\t\tif (yych <= 'r') goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'w') {\n-\t\t\t\t\tif (yych <= 'v') goto yy1075;\n+\t\t\t\t\tif (yych <= 'v') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'y') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t}\n-yy1078:\n-\tyyaccept = 25;\n+yy1018:\n+\tyyaccept = 24;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'V') {\n \t\tif (yych <= 'D') {\n \t\t\tif (yych <= ' ') {\n \t\t\t\tif (yych == '\\t') goto yy60;\n-\t\t\t\tif (yych <= 0x1F) goto yy1075;\n+\t\t\t\tif (yych <= 0x1F) goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n-\t\t\t\tif (yych <= '\/') goto yy1075;\n-\t\t\t\tif (yych <= '9') goto yy820;\n-\t\t\t\tif (yych <= 'C') goto yy1075;\n+\t\t\t\tif (yych <= '\/') goto yy1015;\n+\t\t\t\tif (yych <= '9') goto yy760;\n+\t\t\t\tif (yych <= 'C') goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'H') {\n \t\t\t\tif (yych == 'F') goto yy60;\n-\t\t\t\tif (yych <= 'G') goto yy1075;\n+\t\t\t\tif (yych <= 'G') goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'M') {\n-\t\t\t\t\tif (yych <= 'L') goto yy1075;\n+\t\t\t\t\tif (yych <= 'L') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= 'R') goto yy1075;\n+\t\t\t\t\tif (yych <= 'R') goto yy1015;\n \t\t\t\t\tif (yych <= 'T') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= 'h') {\n \t\t\tif (yych <= 'c') {\n-\t\t\t\tif (yych == 'X') goto yy1075;\n+\t\t\t\tif (yych == 'X') goto yy1015;\n \t\t\t\tif (yych <= 'Y') goto yy60;\n-\t\t\t\tgoto yy1075;\n+\t\t\t\tgoto yy1015;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'e') {\n \t\t\t\t\tif (yych <= 'd') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych == 'g') goto yy1075;\n+\t\t\t\t\tif (yych == 'g') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n \t\t\t\tif (yych == 'm') goto yy60;\n-\t\t\t\tif (yych <= 'r') goto yy1075;\n+\t\t\t\tif (yych <= 'r') goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'w') {\n-\t\t\t\t\tif (yych <= 'v') goto yy1075;\n+\t\t\t\t\tif (yych <= 'v') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'y') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t}\n-yy1079:\n-\tyyaccept = 25;\n+yy1019:\n+\tyyaccept = 24;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n \t\tif (yych <= '9') {\n \t\t\tif (yych <= ' ') {\n \t\t\t\tif (yych == '\\t') goto yy60;\n-\t\t\t\tif (yych <= 0x1F) goto yy1075;\n+\t\t\t\tif (yych <= 0x1F) goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= '0') {\n-\t\t\t\t\tif (yych <= '\/') goto yy1075;\n-\t\t\t\t\tgoto yy844;\n+\t\t\t\t\tif (yych <= '\/') goto yy1015;\n+\t\t\t\t\tgoto yy784;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= '2') goto yy845;\n-\t\t\t\t\tif (yych <= '3') goto yy846;\n-\t\t\t\t\tgoto yy820;\n+\t\t\t\t\tif (yych <= '2') goto yy785;\n+\t\t\t\t\tif (yych <= '3') goto yy786;\n+\t\t\t\t\tgoto yy760;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'G') {\n \t\t\t\tif (yych <= 'D') {\n-\t\t\t\t\tif (yych <= 'C') goto yy1075;\n+\t\t\t\t\tif (yych <= 'C') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'F') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t} else {\n \t\t\t\tif (yych <= 'L') {\n \t\t\t\t\tif (yych <= 'H') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych <= 'M') goto yy60;\n-\t\t\t\t\tif (yych <= 'R') goto yy1075;\n+\t\t\t\t\tif (yych <= 'R') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t}\n@@ -14924,73 +14020,73 @@ yy1079:\n \t\tif (yych <= 'g') {\n \t\t\tif (yych <= 'Y') {\n \t\t\t\tif (yych == 'W') goto yy60;\n-\t\t\t\tif (yych <= 'X') goto yy1075;\n+\t\t\t\tif (yych <= 'X') goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'd') {\n-\t\t\t\t\tif (yych <= 'c') goto yy1075;\n+\t\t\t\t\tif (yych <= 'c') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'f') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n \t\t\t\tif (yych <= 'l') {\n \t\t\t\t\tif (yych <= 'h') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych <= 'm') goto yy60;\n-\t\t\t\t\tif (yych <= 'r') goto yy1075;\n+\t\t\t\t\tif (yych <= 'r') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t} else {\n \t\t\t\tif (yych <= 'w') {\n-\t\t\t\t\tif (yych <= 'v') goto yy1075;\n+\t\t\t\t\tif (yych <= 'v') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'y') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t}\n-yy1080:\n-\tyyaccept = 25;\n+yy1020:\n+\tyyaccept = 24;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n \t\tif (yych <= '9') {\n \t\t\tif (yych <= ' ') {\n \t\t\t\tif (yych == '\\t') goto yy60;\n-\t\t\t\tif (yych <= 0x1F) goto yy1075;\n+\t\t\t\tif (yych <= 0x1F) goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= '0') {\n-\t\t\t\t\tif (yych <= '\/') goto yy1075;\n-\t\t\t\t\tgoto yy876;\n+\t\t\t\t\tif (yych <= '\/') goto yy1015;\n+\t\t\t\t\tgoto yy816;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= '2') goto yy845;\n-\t\t\t\t\tif (yych <= '3') goto yy846;\n-\t\t\t\t\tgoto yy820;\n+\t\t\t\t\tif (yych <= '2') goto yy785;\n+\t\t\t\t\tif (yych <= '3') goto yy786;\n+\t\t\t\t\tgoto yy760;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'G') {\n \t\t\t\tif (yych <= 'D') {\n-\t\t\t\t\tif (yych <= 'C') goto yy1075;\n+\t\t\t\t\tif (yych <= 'C') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'F') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t} else {\n \t\t\t\tif (yych <= 'L') {\n \t\t\t\t\tif (yych <= 'H') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych <= 'M') goto yy60;\n-\t\t\t\t\tif (yych <= 'R') goto yy1075;\n+\t\t\t\t\tif (yych <= 'R') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t}\n@@ -14999,73 +14095,73 @@ yy1080:\n \t\tif (yych <= 'g') {\n \t\t\tif (yych <= 'Y') {\n \t\t\t\tif (yych == 'W') goto yy60;\n-\t\t\t\tif (yych <= 'X') goto yy1075;\n+\t\t\t\tif (yych <= 'X') goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'd') {\n-\t\t\t\t\tif (yych <= 'c') goto yy1075;\n+\t\t\t\t\tif (yych <= 'c') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'f') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n \t\t\t\tif (yych <= 'l') {\n \t\t\t\t\tif (yych <= 'h') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych <= 'm') goto yy60;\n-\t\t\t\t\tif (yych <= 'r') goto yy1075;\n+\t\t\t\t\tif (yych <= 'r') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t} else {\n \t\t\t\tif (yych <= 'w') {\n-\t\t\t\t\tif (yych <= 'v') goto yy1075;\n+\t\t\t\t\tif (yych <= 'v') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'y') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t}\n-yy1081:\n-\tyyaccept = 25;\n+yy1021:\n+\tyyaccept = 24;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n \t\tif (yych <= '9') {\n \t\t\tif (yych <= ' ') {\n \t\t\t\tif (yych == '\\t') goto yy60;\n-\t\t\t\tif (yych <= 0x1F) goto yy1075;\n+\t\t\t\tif (yych <= 0x1F) goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= '0') {\n-\t\t\t\t\tif (yych <= '\/') goto yy1075;\n-\t\t\t\t\tgoto yy844;\n+\t\t\t\t\tif (yych <= '\/') goto yy1015;\n+\t\t\t\t\tgoto yy784;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= '2') goto yy845;\n-\t\t\t\t\tif (yych <= '3') goto yy846;\n-\t\t\t\t\tgoto yy820;\n+\t\t\t\t\tif (yych <= '2') goto yy785;\n+\t\t\t\t\tif (yych <= '3') goto yy786;\n+\t\t\t\t\tgoto yy760;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'G') {\n \t\t\t\tif (yych <= 'D') {\n-\t\t\t\t\tif (yych <= 'C') goto yy1075;\n+\t\t\t\t\tif (yych <= 'C') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'F') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t} else {\n \t\t\t\tif (yych <= 'L') {\n \t\t\t\t\tif (yych <= 'H') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych <= 'M') goto yy60;\n-\t\t\t\t\tif (yych <= 'R') goto yy1075;\n+\t\t\t\t\tif (yych <= 'R') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t}\n@@ -15074,207 +14170,207 @@ yy1081:\n \t\tif (yych <= 'g') {\n \t\t\tif (yych <= 'Y') {\n \t\t\t\tif (yych == 'W') goto yy60;\n-\t\t\t\tif (yych <= 'X') goto yy1075;\n+\t\t\t\tif (yych <= 'X') goto yy1015;\n \t\t\t\tgoto yy60;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'd') {\n-\t\t\t\t\tif (yych <= 'c') goto yy1075;\n+\t\t\t\t\tif (yych <= 'c') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'f') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n \t\t\t\tif (yych <= 'l') {\n \t\t\t\t\tif (yych <= 'h') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych <= 'm') goto yy60;\n-\t\t\t\t\tif (yych <= 'r') goto yy1075;\n+\t\t\t\t\tif (yych <= 'r') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t}\n \t\t\t} else {\n \t\t\t\tif (yych <= 'w') {\n-\t\t\t\t\tif (yych <= 'v') goto yy1075;\n+\t\t\t\t\tif (yych <= 'v') goto yy1015;\n \t\t\t\t\tgoto yy60;\n \t\t\t\t} else {\n \t\t\t\t\tif (yych == 'y') goto yy60;\n-\t\t\t\t\tgoto yy1075;\n+\t\t\t\t\tgoto yy1015;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t}\n-yy1082:\n-\tyyaccept = 11;\n+yy1022:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy1084;\n-\t\tgoto yy490;\n+\t\tif (yych == '.') goto yy1024;\n+\t\tgoto yy430;\n \t} else {\n-\t\tif (yych <= '9') goto yy1083;\n-\t\tif (yych <= ':') goto yy1084;\n-\t\tgoto yy490;\n+\t\tif (yych <= '9') goto yy1023;\n+\t\tif (yych <= ':') goto yy1024;\n+\t\tgoto yy430;\n \t}\n-yy1083:\n-\tyyaccept = 11;\n+yy1023:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy1084;\n-\tif (yych != ':') goto yy490;\n-yy1084:\n+\tif (yych == '.') goto yy1024;\n+\tif (yych != ':') goto yy430;\n+yy1024:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy1085;\n-\tif (yych <= '6') goto yy1086;\n-\tif (yych <= '9') goto yy495;\n+\tif (yych <= '5') goto yy1025;\n+\tif (yych <= '6') goto yy1026;\n+\tif (yych <= '9') goto yy435;\n \tgoto yy56;\n-yy1085:\n-\tyyaccept = 11;\n+yy1025:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy496;\n-\tif (yych <= '\/') goto yy490;\n-\tif (yych <= '9') goto yy495;\n-\tgoto yy490;\n-yy1086:\n-\tyyaccept = 11;\n+\tif (yych == '.') goto yy436;\n+\tif (yych <= '\/') goto yy430;\n+\tif (yych <= '9') goto yy435;\n+\tgoto yy430;\n+yy1026:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy496;\n-\tif (yych == '0') goto yy495;\n-\tgoto yy490;\n-yy1087:\n-\tyyaccept = 11;\n+\tif (yych == '.') goto yy436;\n+\tif (yych == '0') goto yy435;\n+\tgoto yy430;\n+yy1027:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n-\t\tif (yych <= ',') goto yy490;\n-\t\tif (yych <= '-') goto yy601;\n-\t\tgoto yy1091;\n+\t\tif (yych <= ',') goto yy430;\n+\t\tif (yych <= '-') goto yy541;\n+\t\tgoto yy1031;\n \t} else {\n-\t\tif (yych <= '\/') goto yy490;\n-\t\tif (yych <= '9') goto yy1090;\n-\t\tif (yych <= ':') goto yy1084;\n-\t\tgoto yy490;\n+\t\tif (yych <= '\/') goto yy430;\n+\t\tif (yych <= '9') goto yy1030;\n+\t\tif (yych <= ':') goto yy1024;\n+\t\tgoto yy430;\n \t}\n-yy1088:\n-\tyyaccept = 11;\n+yy1028:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n-\t\tif (yych <= ',') goto yy490;\n-\t\tif (yych <= '-') goto yy601;\n-\t\tif (yych <= '.') goto yy1091;\n-\t\tgoto yy490;\n+\t\tif (yych <= ',') goto yy430;\n+\t\tif (yych <= '-') goto yy541;\n+\t\tif (yych <= '.') goto yy1031;\n+\t\tgoto yy430;\n \t} else {\n-\t\tif (yych <= '2') goto yy1090;\n-\t\tif (yych <= '9') goto yy1083;\n-\t\tif (yych <= ':') goto yy1084;\n-\t\tgoto yy490;\n+\t\tif (yych <= '2') goto yy1030;\n+\t\tif (yych <= '9') goto yy1023;\n+\t\tif (yych <= ':') goto yy1024;\n+\t\tgoto yy430;\n \t}\n-yy1089:\n-\tyyaccept = 11;\n+yy1029:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n-\t\tif (yych <= ',') goto yy490;\n-\t\tif (yych <= '-') goto yy601;\n-\t\tgoto yy1091;\n+\t\tif (yych <= ',') goto yy430;\n+\t\tif (yych <= '-') goto yy541;\n+\t\tgoto yy1031;\n \t} else {\n-\t\tif (yych <= '\/') goto yy490;\n-\t\tif (yych <= '9') goto yy1083;\n-\t\tif (yych <= ':') goto yy1084;\n-\t\tgoto yy490;\n+\t\tif (yych <= '\/') goto yy430;\n+\t\tif (yych <= '9') goto yy1023;\n+\t\tif (yych <= ':') goto yy1024;\n+\t\tgoto yy430;\n \t}\n-yy1090:\n-\tyyaccept = 11;\n+yy1030:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n-\t\tif (yych <= ',') goto yy490;\n-\t\tif (yych <= '-') goto yy601;\n+\t\tif (yych <= ',') goto yy430;\n+\t\tif (yych <= '-') goto yy541;\n \t} else {\n-\t\tif (yych == ':') goto yy1084;\n-\t\tgoto yy490;\n+\t\tif (yych == ':') goto yy1024;\n+\t\tgoto yy430;\n \t}\n-yy1091:\n+yy1031:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '5') goto yy1092;\n-\tif (yych <= '6') goto yy1093;\n-\tif (yych <= '9') goto yy609;\n+\tif (yych <= '5') goto yy1032;\n+\tif (yych <= '6') goto yy1033;\n+\tif (yych <= '9') goto yy549;\n \tgoto yy56;\n-yy1092:\n-\tyyaccept = 11;\n+yy1032:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy496;\n-\tif (yych <= '\/') goto yy490;\n-\tif (yych <= '9') goto yy1094;\n-\tgoto yy490;\n-yy1093:\n-\tyyaccept = 11;\n+\tif (yych == '.') goto yy436;\n+\tif (yych <= '\/') goto yy430;\n+\tif (yych <= '9') goto yy1034;\n+\tgoto yy430;\n+yy1033:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy496;\n-\t\tgoto yy490;\n+\t\tif (yych == '.') goto yy436;\n+\t\tgoto yy430;\n \t} else {\n-\t\tif (yych <= '0') goto yy1094;\n-\t\tif (yych <= '9') goto yy610;\n-\t\tgoto yy490;\n+\t\tif (yych <= '0') goto yy1034;\n+\t\tif (yych <= '9') goto yy550;\n+\t\tgoto yy430;\n \t}\n-yy1094:\n-\tyyaccept = 11;\n+yy1034:\n+\tyyaccept = 10;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '.') goto yy496;\n-\tif (yych <= '\/') goto yy490;\n-\tif (yych <= '9') goto yy604;\n-\tgoto yy490;\n-yy1095:\n+\tif (yych == '.') goto yy436;\n+\tif (yych <= '\/') goto yy430;\n+\tif (yych <= '9') goto yy544;\n+\tgoto yy430;\n+yy1035:\n \tyych = *++YYCURSOR;\n \tif (yych <= '9') {\n \t\tif (yych <= '-') {\n-\t\t\tif (yych == '\\t') goto yy459;\n-\t\t\tif (yych <= ',') goto yy461;\n-\t\t\tgoto yy1050;\n+\t\t\tif (yych == '\\t') goto yy399;\n+\t\t\tif (yych <= ',') goto yy401;\n+\t\t\tgoto yy990;\n \t\t} else {\n-\t\t\tif (yych <= '.') goto yy473;\n-\t\t\tif (yych <= '\/') goto yy471;\n-\t\t\tif (yych <= '5') goto yy1065;\n-\t\t\tgoto yy740;\n+\t\t\tif (yych <= '.') goto yy413;\n+\t\t\tif (yych <= '\/') goto yy411;\n+\t\t\tif (yych <= '5') goto yy1005;\n+\t\t\tgoto yy680;\n \t\t}\n \t} else {\n \t\tif (yych <= 'q') {\n-\t\t\tif (yych <= ':') goto yy482;\n-\t\t\tif (yych == 'n') goto yy469;\n-\t\t\tgoto yy461;\n+\t\t\tif (yych <= ':') goto yy422;\n+\t\t\tif (yych == 'n') goto yy409;\n+\t\t\tgoto yy401;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy470;\n-\t\t\tif (yych <= 's') goto yy463;\n-\t\t\tif (yych <= 't') goto yy467;\n-\t\t\tgoto yy461;\n+\t\t\tif (yych <= 'r') goto yy410;\n+\t\t\tif (yych <= 's') goto yy403;\n+\t\t\tif (yych <= 't') goto yy407;\n+\t\t\tgoto yy401;\n \t\t}\n \t}\n-yy1096:\n+yy1036:\n \tyych = *++YYCURSOR;\n \tif (yych <= '9') {\n \t\tif (yych <= '-') {\n-\t\t\tif (yych == '\\t') goto yy1051;\n-\t\t\tif (yych <= ',') goto yy1053;\n-\t\t\tgoto yy1050;\n+\t\t\tif (yych == '\\t') goto yy991;\n+\t\t\tif (yych <= ',') goto yy993;\n+\t\t\tgoto yy990;\n \t\t} else {\n-\t\t\tif (yych <= '.') goto yy1063;\n-\t\t\tif (yych <= '\/') goto yy471;\n-\t\t\tif (yych <= '5') goto yy1065;\n-\t\t\tgoto yy740;\n+\t\t\tif (yych <= '.') goto yy1003;\n+\t\t\tif (yych <= '\/') goto yy411;\n+\t\t\tif (yych <= '5') goto yy1005;\n+\t\t\tgoto yy680;\n \t\t}\n \t} else {\n \t\tif (yych <= 'q') {\n-\t\t\tif (yych <= ':') goto yy1064;\n-\t\t\tif (yych == 'n') goto yy469;\n-\t\t\tgoto yy1053;\n+\t\t\tif (yych <= ':') goto yy1004;\n+\t\t\tif (yych == 'n') goto yy409;\n+\t\t\tgoto yy993;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy470;\n-\t\t\tif (yych <= 's') goto yy463;\n-\t\t\tif (yych <= 't') goto yy467;\n-\t\t\tgoto yy1053;\n+\t\t\tif (yych <= 'r') goto yy410;\n+\t\t\tif (yych <= 's') goto yy403;\n+\t\t\tif (yych <= 't') goto yy407;\n+\t\t\tgoto yy993;\n \t\t}\n \t}\n-yy1097:\n+yy1037:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'E') {\n \t\tif (yych <= ')') {\n@@ -15290,12 +14386,12 @@ yy1097:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy1098;\n+\t\t\tif (yych <= 'e') goto yy1038;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1098:\n+yy1038:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'V') {\n \t\tif (yych <= ')') {\n@@ -15311,12 +14407,12 @@ yy1098:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'v') goto yy1099;\n+\t\t\tif (yych <= 'v') goto yy1039;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1099:\n+yy1039:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'I') {\n \t\tif (yych <= ')') {\n@@ -15332,12 +14428,12 @@ yy1099:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'i') goto yy1100;\n+\t\t\tif (yych <= 'i') goto yy1040;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1100:\n+yy1040:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'O') {\n \t\tif (yych <= ')') {\n@@ -15353,199 +14449,199 @@ yy1100:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'o') goto yy1101;\n+\t\t\tif (yych <= 'o') goto yy1041;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1101:\n+yy1041:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'U') goto yy1102;\n+\t\tif (yych <= 'U') goto yy1042;\n \t\tif (yych != 'u') goto yy3;\n \t}\n-yy1102:\n+yy1042:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'S') goto yy1103;\n+\tif (yych == 'S') goto yy1043;\n \tif (yych != 's') goto yy56;\n-yy1103:\n+yy1043:\n \tyych = *++YYCURSOR;\n-\tif (yych == '\\t') goto yy1104;\n+\tif (yych == '\\t') goto yy1044;\n \tif (yych != ' ') goto yy56;\n-yy1104:\n+yy1044:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 11) YYFILL(11);\n \tyych = *YYCURSOR;\n-yy1105:\n+yy1045:\n \tif (yych <= 'W') {\n \t\tif (yych <= 'F') {\n \t\t\tif (yych <= ' ') {\n-\t\t\t\tif (yych == '\\t') goto yy1104;\n+\t\t\t\tif (yych == '\\t') goto yy1044;\n \t\t\t\tif (yych <= 0x1F) goto yy56;\n-\t\t\t\tgoto yy1104;\n+\t\t\t\tgoto yy1044;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'D') goto yy1109;\n+\t\t\t\tif (yych == 'D') goto yy1049;\n \t\t\t\tif (yych <= 'E') goto yy56;\n-\t\t\t\tgoto yy1110;\n+\t\t\t\tgoto yy1050;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'M') {\n-\t\t\t\tif (yych == 'H') goto yy1108;\n+\t\t\t\tif (yych == 'H') goto yy1048;\n \t\t\t\tif (yych <= 'L') goto yy56;\n-\t\t\t\tgoto yy1107;\n+\t\t\t\tgoto yy1047;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'S') {\n \t\t\t\t\tif (yych <= 'R') goto yy56;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= 'T') goto yy1113;\n+\t\t\t\t\tif (yych <= 'T') goto yy1053;\n \t\t\t\t\tif (yych <= 'V') goto yy56;\n-\t\t\t\t\tgoto yy1112;\n+\t\t\t\t\tgoto yy1052;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= 'l') {\n \t\t\tif (yych <= 'd') {\n-\t\t\t\tif (yych == 'Y') goto yy1111;\n+\t\t\t\tif (yych == 'Y') goto yy1051;\n \t\t\t\tif (yych <= 'c') goto yy56;\n-\t\t\t\tgoto yy1109;\n+\t\t\t\tgoto yy1049;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'f') {\n \t\t\t\t\tif (yych <= 'e') goto yy56;\n-\t\t\t\t\tgoto yy1110;\n+\t\t\t\t\tgoto yy1050;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych == 'h') goto yy1108;\n+\t\t\t\t\tif (yych == 'h') goto yy1048;\n \t\t\t\t\tgoto yy56;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n-\t\t\t\tif (yych <= 'm') goto yy1107;\n+\t\t\t\tif (yych <= 'm') goto yy1047;\n \t\t\t\tif (yych <= 'r') goto yy56;\n-\t\t\t\tif (yych >= 't') goto yy1113;\n+\t\t\t\tif (yych >= 't') goto yy1053;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'w') {\n \t\t\t\t\tif (yych <= 'v') goto yy56;\n-\t\t\t\t\tgoto yy1112;\n+\t\t\t\t\tgoto yy1052;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych == 'y') goto yy1111;\n+\t\t\t\t\tif (yych == 'y') goto yy1051;\n \t\t\t\t\tgoto yy56;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t}\n-yy1106:\n+yy1046:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n \t\tif (yych <= 'D') {\n-\t\t\tif (yych == 'A') goto yy1178;\n+\t\t\tif (yych == 'A') goto yy1118;\n \t\t\tgoto yy56;\n \t\t} else {\n-\t\t\tif (yych <= 'E') goto yy1179;\n+\t\t\tif (yych <= 'E') goto yy1119;\n \t\t\tif (yych <= 'T') goto yy56;\n-\t\t\tgoto yy1177;\n+\t\t\tgoto yy1117;\n \t\t}\n \t} else {\n \t\tif (yych <= 'd') {\n-\t\t\tif (yych == 'a') goto yy1178;\n+\t\t\tif (yych == 'a') goto yy1118;\n \t\t\tgoto yy56;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy1179;\n-\t\t\tif (yych == 'u') goto yy1177;\n+\t\t\tif (yych <= 'e') goto yy1119;\n+\t\t\tif (yych == 'u') goto yy1117;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy1107:\n+yy1047:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'O') {\n-\t\tif (yych == 'I') goto yy1169;\n+\t\tif (yych == 'I') goto yy1109;\n \t\tif (yych <= 'N') goto yy56;\n-\t\tgoto yy1168;\n+\t\tgoto yy1108;\n \t} else {\n \t\tif (yych <= 'i') {\n \t\t\tif (yych <= 'h') goto yy56;\n-\t\t\tgoto yy1169;\n+\t\t\tgoto yy1109;\n \t\t} else {\n-\t\t\tif (yych == 'o') goto yy1168;\n+\t\t\tif (yych == 'o') goto yy1108;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy1108:\n+yy1048:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'O') goto yy1166;\n-\tif (yych == 'o') goto yy1166;\n+\tif (yych == 'O') goto yy1106;\n+\tif (yych == 'o') goto yy1106;\n \tgoto yy56;\n-yy1109:\n+yy1049:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1165;\n-\tif (yych == 'a') goto yy1165;\n+\tif (yych == 'A') goto yy1105;\n+\tif (yych == 'a') goto yy1105;\n \tgoto yy56;\n-yy1110:\n+yy1050:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'R') {\n-\t\tif (yych == 'O') goto yy1150;\n+\t\tif (yych == 'O') goto yy1090;\n \t\tif (yych <= 'Q') goto yy56;\n-\t\tgoto yy1149;\n+\t\tgoto yy1089;\n \t} else {\n \t\tif (yych <= 'o') {\n \t\t\tif (yych <= 'n') goto yy56;\n-\t\t\tgoto yy1150;\n+\t\t\tgoto yy1090;\n \t\t} else {\n-\t\t\tif (yych == 'r') goto yy1149;\n+\t\t\tif (yych == 'r') goto yy1089;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy1111:\n+yy1051:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy1146;\n-\tif (yych == 'e') goto yy1146;\n+\tif (yych == 'E') goto yy1086;\n+\tif (yych == 'e') goto yy1086;\n \tgoto yy56;\n-yy1112:\n+yy1052:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy1132;\n-\tif (yych == 'e') goto yy1132;\n+\tif (yych == 'E') goto yy1072;\n+\tif (yych == 'e') goto yy1072;\n \tgoto yy56;\n-yy1113:\n+yy1053:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n-\t\tif (yych == 'H') goto yy1114;\n+\t\tif (yych == 'H') goto yy1054;\n \t\tif (yych <= 'T') goto yy56;\n-\t\tgoto yy1115;\n+\t\tgoto yy1055;\n \t} else {\n \t\tif (yych <= 'h') {\n \t\t\tif (yych <= 'g') goto yy56;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy1115;\n+\t\t\tif (yych == 'u') goto yy1055;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy1114:\n+yy1054:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'U') goto yy1127;\n-\tif (yych == 'u') goto yy1127;\n+\tif (yych == 'U') goto yy1067;\n+\tif (yych == 'u') goto yy1067;\n \tgoto yy56;\n-yy1115:\n+yy1055:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy1116;\n+\tif (yych == 'E') goto yy1056;\n \tif (yych != 'e') goto yy56;\n-yy1116:\n-\tyyaccept = 26;\n+yy1056:\n+\tyyaccept = 25;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ' ') {\n-\t\tif (yych == '\\t') goto yy1118;\n-\t\tif (yych >= ' ') goto yy1118;\n+\t\tif (yych == '\\t') goto yy1058;\n+\t\tif (yych >= ' ') goto yy1058;\n \t} else {\n \t\tif (yych <= 'S') {\n-\t\t\tif (yych >= 'S') goto yy1120;\n+\t\t\tif (yych >= 'S') goto yy1060;\n \t\t} else {\n-\t\t\tif (yych == 's') goto yy1120;\n+\t\t\tif (yych == 's') goto yy1060;\n \t\t}\n \t}\n-yy1117:\n+yy1057:\n #line 1603 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\ttimelib_sll i;\n@@ -15562,47 +14658,47 @@ yy1117:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_RELATIVE;\n \t}\n-#line 15566 \"<stdout>\"\n-yy1118:\n+#line 14662 \"<stdout>\"\n+yy1058:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);\n \tyych = *YYCURSOR;\n \tif (yych <= ' ') {\n-\t\tif (yych == '\\t') goto yy1118;\n+\t\tif (yych == '\\t') goto yy1058;\n \t\tif (yych <= 0x1F) goto yy56;\n-\t\tgoto yy1118;\n+\t\tgoto yy1058;\n \t} else {\n \t\tif (yych <= 'O') {\n \t\t\tif (yych <= 'N') goto yy56;\n-\t\t\tgoto yy1124;\n+\t\t\tgoto yy1064;\n \t\t} else {\n-\t\t\tif (yych == 'o') goto yy1124;\n+\t\t\tif (yych == 'o') goto yy1064;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy1120:\n+yy1060:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'D') goto yy1121;\n+\tif (yych == 'D') goto yy1061;\n \tif (yych != 'd') goto yy56;\n-yy1121:\n+yy1061:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1122;\n+\tif (yych == 'A') goto yy1062;\n \tif (yych != 'a') goto yy56;\n-yy1122:\n+yy1062:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1123;\n+\tif (yych == 'Y') goto yy1063;\n \tif (yych != 'y') goto yy56;\n-yy1123:\n-\tyyaccept = 26;\n+yy1063:\n+\tyyaccept = 25;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych == '\\t') goto yy1118;\n-\tif (yych == ' ') goto yy1118;\n-\tgoto yy1117;\n-yy1124:\n+\tif (yych == '\\t') goto yy1058;\n+\tif (yych == ' ') goto yy1058;\n+\tgoto yy1057;\n+yy1064:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'F') goto yy1125;\n+\tif (yych == 'F') goto yy1065;\n \tif (yych != 'f') goto yy56;\n-yy1125:\n+yy1065:\n \t++YYCURSOR;\n #line 1076 \"ext\/date\/lib\/parse_date.re\"\n \t{\n@@ -15625,99 +14721,99 @@ yy1125:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_WEEK_DAY_OF_MONTH;\n \t}\n-#line 15629 \"<stdout>\"\n-yy1127:\n-\tyyaccept = 26;\n+#line 14725 \"<stdout>\"\n+yy1067:\n+\tyyaccept = 25;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ' ') {\n-\t\tif (yych == '\\t') goto yy1118;\n-\t\tif (yych <= 0x1F) goto yy1117;\n-\t\tgoto yy1118;\n+\t\tif (yych == '\\t') goto yy1058;\n+\t\tif (yych <= 0x1F) goto yy1057;\n+\t\tgoto yy1058;\n \t} else {\n \t\tif (yych <= 'R') {\n-\t\t\tif (yych <= 'Q') goto yy1117;\n+\t\t\tif (yych <= 'Q') goto yy1057;\n \t\t} else {\n-\t\t\tif (yych != 'r') goto yy1117;\n+\t\t\tif (yych != 'r') goto yy1057;\n \t\t}\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'S') goto yy1129;\n+\tif (yych == 'S') goto yy1069;\n \tif (yych != 's') goto yy56;\n-yy1129:\n+yy1069:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'D') goto yy1130;\n+\tif (yych == 'D') goto yy1070;\n \tif (yych != 'd') goto yy56;\n-yy1130:\n+yy1070:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1131;\n+\tif (yych == 'A') goto yy1071;\n \tif (yych != 'a') goto yy56;\n-yy1131:\n+yy1071:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1123;\n-\tif (yych == 'y') goto yy1123;\n+\tif (yych == 'Y') goto yy1063;\n+\tif (yych == 'y') goto yy1063;\n \tgoto yy56;\n-yy1132:\n+yy1072:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'E') {\n \t\tif (yych <= 'C') goto yy56;\n-\t\tif (yych <= 'D') goto yy1134;\n+\t\tif (yych <= 'D') goto yy1074;\n \t} else {\n \t\tif (yych <= 'c') goto yy56;\n-\t\tif (yych <= 'd') goto yy1134;\n+\t\tif (yych <= 'd') goto yy1074;\n \t\tif (yych >= 'f') goto yy56;\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'K') goto yy1140;\n-\tif (yych == 'k') goto yy1140;\n+\tif (yych == 'K') goto yy1080;\n+\tif (yych == 'k') goto yy1080;\n \tgoto yy56;\n-yy1134:\n-\tyyaccept = 26;\n+yy1074:\n+\tyyaccept = 25;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ' ') {\n-\t\tif (yych == '\\t') goto yy1118;\n-\t\tif (yych <= 0x1F) goto yy1117;\n-\t\tgoto yy1118;\n+\t\tif (yych == '\\t') goto yy1058;\n+\t\tif (yych <= 0x1F) goto yy1057;\n+\t\tgoto yy1058;\n \t} else {\n \t\tif (yych <= 'N') {\n-\t\t\tif (yych <= 'M') goto yy1117;\n+\t\t\tif (yych <= 'M') goto yy1057;\n \t\t} else {\n-\t\t\tif (yych != 'n') goto yy1117;\n+\t\t\tif (yych != 'n') goto yy1057;\n \t\t}\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy1136;\n+\tif (yych == 'E') goto yy1076;\n \tif (yych != 'e') goto yy56;\n-yy1136:\n+yy1076:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'S') goto yy1137;\n+\tif (yych == 'S') goto yy1077;\n \tif (yych != 's') goto yy56;\n-yy1137:\n+yy1077:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'D') goto yy1138;\n+\tif (yych == 'D') goto yy1078;\n \tif (yych != 'd') goto yy56;\n-yy1138:\n+yy1078:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1139;\n+\tif (yych == 'A') goto yy1079;\n \tif (yych != 'a') goto yy56;\n-yy1139:\n+yy1079:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1123;\n-\tif (yych == 'y') goto yy1123;\n+\tif (yych == 'Y') goto yy1063;\n+\tif (yych == 'y') goto yy1063;\n \tgoto yy56;\n-yy1140:\n-\tyyaccept = 27;\n+yy1080:\n+\tyyaccept = 26;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n-\t\tif (yych == 'D') goto yy1143;\n-\t\tif (yych >= 'S') goto yy1142;\n+\t\tif (yych == 'D') goto yy1083;\n+\t\tif (yych >= 'S') goto yy1082;\n \t} else {\n \t\tif (yych <= 'd') {\n-\t\t\tif (yych >= 'd') goto yy1143;\n+\t\t\tif (yych >= 'd') goto yy1083;\n \t\t} else {\n-\t\t\tif (yych == 's') goto yy1142;\n+\t\t\tif (yych == 's') goto yy1082;\n \t\t}\n \t}\n-yy1141:\n+yy1081:\n #line 1579 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\ttimelib_sll i;\n@@ -15741,294 +14837,294 @@ yy1141:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_RELATIVE;\n \t}\n-#line 15745 \"<stdout>\"\n-yy1142:\n+#line 14841 \"<stdout>\"\n+yy1082:\n \tyych = *++YYCURSOR;\n-\tgoto yy1117;\n-yy1143:\n+\tgoto yy1057;\n+yy1083:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1144;\n+\tif (yych == 'A') goto yy1084;\n \tif (yych != 'a') goto yy56;\n-yy1144:\n+yy1084:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1145;\n+\tif (yych == 'Y') goto yy1085;\n \tif (yych != 'y') goto yy56;\n-yy1145:\n+yy1085:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'S') goto yy1142;\n-\tif (yych == 's') goto yy1142;\n-\tgoto yy1117;\n-yy1146:\n+\tif (yych == 'S') goto yy1082;\n+\tif (yych == 's') goto yy1082;\n+\tgoto yy1057;\n+yy1086:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1147;\n+\tif (yych == 'A') goto yy1087;\n \tif (yych != 'a') goto yy56;\n-yy1147:\n+yy1087:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy1148;\n+\tif (yych == 'R') goto yy1088;\n \tif (yych != 'r') goto yy56;\n-yy1148:\n+yy1088:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'S') goto yy1142;\n-\tif (yych == 's') goto yy1142;\n-\tgoto yy1117;\n-yy1149:\n+\tif (yych == 'S') goto yy1082;\n+\tif (yych == 's') goto yy1082;\n+\tgoto yy1057;\n+yy1089:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'I') goto yy1162;\n-\tif (yych == 'i') goto yy1162;\n+\tif (yych == 'I') goto yy1102;\n+\tif (yych == 'i') goto yy1102;\n \tgoto yy56;\n-yy1150:\n+yy1090:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy1151;\n+\tif (yych == 'R') goto yy1091;\n \tif (yych != 'r') goto yy56;\n-yy1151:\n+yy1091:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy1152;\n+\tif (yych == 'T') goto yy1092;\n \tif (yych != 't') goto yy56;\n-yy1152:\n+yy1092:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n-\t\tif (yych == 'H') goto yy1154;\n+\t\tif (yych == 'H') goto yy1094;\n \t\tif (yych <= 'M') goto yy56;\n \t} else {\n \t\tif (yych <= 'h') {\n \t\t\tif (yych <= 'g') goto yy56;\n-\t\t\tgoto yy1154;\n+\t\t\tgoto yy1094;\n \t\t} else {\n \t\t\tif (yych != 'n') goto yy56;\n \t\t}\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'I') goto yy1159;\n-\tif (yych == 'i') goto yy1159;\n+\tif (yych == 'I') goto yy1099;\n+\tif (yych == 'i') goto yy1099;\n \tgoto yy56;\n-yy1154:\n+yy1094:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'N') goto yy1155;\n+\tif (yych == 'N') goto yy1095;\n \tif (yych != 'n') goto yy56;\n-yy1155:\n+yy1095:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'I') goto yy1156;\n+\tif (yych == 'I') goto yy1096;\n \tif (yych != 'i') goto yy56;\n-yy1156:\n+yy1096:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'G') goto yy1157;\n+\tif (yych == 'G') goto yy1097;\n \tif (yych != 'g') goto yy56;\n-yy1157:\n+yy1097:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'H') goto yy1158;\n+\tif (yych == 'H') goto yy1098;\n \tif (yych != 'h') goto yy56;\n-yy1158:\n+yy1098:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy1148;\n-\tif (yych == 't') goto yy1148;\n+\tif (yych == 'T') goto yy1088;\n+\tif (yych == 't') goto yy1088;\n \tgoto yy56;\n-yy1159:\n+yy1099:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'G') goto yy1160;\n+\tif (yych == 'G') goto yy1100;\n \tif (yych != 'g') goto yy56;\n-yy1160:\n+yy1100:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'H') goto yy1161;\n+\tif (yych == 'H') goto yy1101;\n \tif (yych != 'h') goto yy56;\n-yy1161:\n+yy1101:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy1148;\n-\tif (yych == 't') goto yy1148;\n+\tif (yych == 'T') goto yy1088;\n+\tif (yych == 't') goto yy1088;\n \tgoto yy56;\n-yy1162:\n-\tyyaccept = 26;\n+yy1102:\n+\tyyaccept = 25;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ' ') {\n-\t\tif (yych == '\\t') goto yy1118;\n-\t\tif (yych <= 0x1F) goto yy1117;\n-\t\tgoto yy1118;\n+\t\tif (yych == '\\t') goto yy1058;\n+\t\tif (yych <= 0x1F) goto yy1057;\n+\t\tgoto yy1058;\n \t} else {\n \t\tif (yych <= 'D') {\n-\t\t\tif (yych <= 'C') goto yy1117;\n+\t\t\tif (yych <= 'C') goto yy1057;\n \t\t} else {\n-\t\t\tif (yych != 'd') goto yy1117;\n+\t\t\tif (yych != 'd') goto yy1057;\n \t\t}\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1164;\n+\tif (yych == 'A') goto yy1104;\n \tif (yych != 'a') goto yy56;\n-yy1164:\n+yy1104:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1123;\n-\tif (yych == 'y') goto yy1123;\n+\tif (yych == 'Y') goto yy1063;\n+\tif (yych == 'y') goto yy1063;\n \tgoto yy56;\n-yy1165:\n+yy1105:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1148;\n-\tif (yych == 'y') goto yy1148;\n+\tif (yych == 'Y') goto yy1088;\n+\tif (yych == 'y') goto yy1088;\n \tgoto yy56;\n-yy1166:\n+yy1106:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'U') goto yy1167;\n+\tif (yych == 'U') goto yy1107;\n \tif (yych != 'u') goto yy56;\n-yy1167:\n+yy1107:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy1148;\n-\tif (yych == 'r') goto yy1148;\n+\tif (yych == 'R') goto yy1088;\n+\tif (yych == 'r') goto yy1088;\n \tgoto yy56;\n-yy1168:\n+yy1108:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'N') goto yy1173;\n-\tif (yych == 'n') goto yy1173;\n+\tif (yych == 'N') goto yy1113;\n+\tif (yych == 'n') goto yy1113;\n \tgoto yy56;\n-yy1169:\n+yy1109:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'N') goto yy1170;\n+\tif (yych == 'N') goto yy1110;\n \tif (yych != 'n') goto yy56;\n-yy1170:\n-\tyyaccept = 26;\n+yy1110:\n+\tyyaccept = 25;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'U') {\n-\t\tif (yych == 'S') goto yy1142;\n-\t\tif (yych <= 'T') goto yy1117;\n+\t\tif (yych == 'S') goto yy1082;\n+\t\tif (yych <= 'T') goto yy1057;\n \t} else {\n \t\tif (yych <= 's') {\n-\t\t\tif (yych <= 'r') goto yy1117;\n-\t\t\tgoto yy1142;\n+\t\t\tif (yych <= 'r') goto yy1057;\n+\t\t\tgoto yy1082;\n \t\t} else {\n-\t\t\tif (yych != 'u') goto yy1117;\n+\t\t\tif (yych != 'u') goto yy1057;\n \t\t}\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy1172;\n+\tif (yych == 'T') goto yy1112;\n \tif (yych != 't') goto yy56;\n-yy1172:\n+yy1112:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy1148;\n-\tif (yych == 'e') goto yy1148;\n+\tif (yych == 'E') goto yy1088;\n+\tif (yych == 'e') goto yy1088;\n \tgoto yy56;\n-yy1173:\n-\tyyaccept = 26;\n+yy1113:\n+\tyyaccept = 25;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy1118;\n-\t\t\tgoto yy1117;\n+\t\t\tif (yych == '\\t') goto yy1058;\n+\t\t\tgoto yy1057;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy1118;\n-\t\t\tif (yych <= 'C') goto yy1117;\n+\t\t\tif (yych <= ' ') goto yy1058;\n+\t\t\tif (yych <= 'C') goto yy1057;\n \t\t}\n \t} else {\n \t\tif (yych <= 'c') {\n-\t\t\tif (yych == 'T') goto yy1175;\n-\t\t\tgoto yy1117;\n+\t\t\tif (yych == 'T') goto yy1115;\n+\t\t\tgoto yy1057;\n \t\t} else {\n-\t\t\tif (yych <= 'd') goto yy1174;\n-\t\t\tif (yych == 't') goto yy1175;\n-\t\t\tgoto yy1117;\n+\t\t\tif (yych <= 'd') goto yy1114;\n+\t\t\tif (yych == 't') goto yy1115;\n+\t\t\tgoto yy1057;\n \t\t}\n \t}\n-yy1174:\n+yy1114:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1176;\n-\tif (yych == 'a') goto yy1176;\n+\tif (yych == 'A') goto yy1116;\n+\tif (yych == 'a') goto yy1116;\n \tgoto yy56;\n-yy1175:\n+yy1115:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'H') goto yy1148;\n-\tif (yych == 'h') goto yy1148;\n+\tif (yych == 'H') goto yy1088;\n+\tif (yych == 'h') goto yy1088;\n \tgoto yy56;\n-yy1176:\n+yy1116:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1123;\n-\tif (yych == 'y') goto yy1123;\n+\tif (yych == 'Y') goto yy1063;\n+\tif (yych == 'y') goto yy1063;\n \tgoto yy56;\n-yy1177:\n+yy1117:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'N') goto yy1188;\n-\tif (yych == 'n') goto yy1188;\n+\tif (yych == 'N') goto yy1128;\n+\tif (yych == 'n') goto yy1128;\n \tgoto yy56;\n-yy1178:\n+yy1118:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy1183;\n-\tif (yych == 't') goto yy1183;\n+\tif (yych == 'T') goto yy1123;\n+\tif (yych == 't') goto yy1123;\n \tgoto yy56;\n-yy1179:\n+yy1119:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'C') goto yy1180;\n+\tif (yych == 'C') goto yy1120;\n \tif (yych != 'c') goto yy56;\n-yy1180:\n-\tyyaccept = 26;\n+yy1120:\n+\tyyaccept = 25;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n-\t\tif (yych == 'O') goto yy1181;\n-\t\tif (yych <= 'R') goto yy1117;\n-\t\tgoto yy1142;\n+\t\tif (yych == 'O') goto yy1121;\n+\t\tif (yych <= 'R') goto yy1057;\n+\t\tgoto yy1082;\n \t} else {\n \t\tif (yych <= 'o') {\n-\t\t\tif (yych <= 'n') goto yy1117;\n+\t\t\tif (yych <= 'n') goto yy1057;\n \t\t} else {\n-\t\t\tif (yych == 's') goto yy1142;\n-\t\t\tgoto yy1117;\n+\t\t\tif (yych == 's') goto yy1082;\n+\t\t\tgoto yy1057;\n \t\t}\n \t}\n-yy1181:\n+yy1121:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'N') goto yy1182;\n+\tif (yych == 'N') goto yy1122;\n \tif (yych != 'n') goto yy56;\n-yy1182:\n+yy1122:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'D') goto yy1148;\n-\tif (yych == 'd') goto yy1148;\n+\tif (yych == 'D') goto yy1088;\n+\tif (yych == 'd') goto yy1088;\n \tgoto yy56;\n-yy1183:\n-\tyyaccept = 26;\n+yy1123:\n+\tyyaccept = 25;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ' ') {\n-\t\tif (yych == '\\t') goto yy1118;\n-\t\tif (yych <= 0x1F) goto yy1117;\n-\t\tgoto yy1118;\n+\t\tif (yych == '\\t') goto yy1058;\n+\t\tif (yych <= 0x1F) goto yy1057;\n+\t\tgoto yy1058;\n \t} else {\n \t\tif (yych <= 'U') {\n-\t\t\tif (yych <= 'T') goto yy1117;\n+\t\t\tif (yych <= 'T') goto yy1057;\n \t\t} else {\n-\t\t\tif (yych != 'u') goto yy1117;\n+\t\t\tif (yych != 'u') goto yy1057;\n \t\t}\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy1185;\n+\tif (yych == 'R') goto yy1125;\n \tif (yych != 'r') goto yy56;\n-yy1185:\n+yy1125:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'D') goto yy1186;\n+\tif (yych == 'D') goto yy1126;\n \tif (yych != 'd') goto yy56;\n-yy1186:\n+yy1126:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1187;\n+\tif (yych == 'A') goto yy1127;\n \tif (yych != 'a') goto yy56;\n-yy1187:\n+yy1127:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1123;\n-\tif (yych == 'y') goto yy1123;\n+\tif (yych == 'Y') goto yy1063;\n+\tif (yych == 'y') goto yy1063;\n \tgoto yy56;\n-yy1188:\n-\tyyaccept = 26;\n+yy1128:\n+\tyyaccept = 25;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ' ') {\n-\t\tif (yych == '\\t') goto yy1118;\n-\t\tif (yych <= 0x1F) goto yy1117;\n-\t\tgoto yy1118;\n+\t\tif (yych == '\\t') goto yy1058;\n+\t\tif (yych <= 0x1F) goto yy1057;\n+\t\tgoto yy1058;\n \t} else {\n \t\tif (yych <= 'D') {\n-\t\t\tif (yych <= 'C') goto yy1117;\n+\t\t\tif (yych <= 'C') goto yy1057;\n \t\t} else {\n-\t\t\tif (yych != 'd') goto yy1117;\n+\t\t\tif (yych != 'd') goto yy1057;\n \t\t}\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1190;\n+\tif (yych == 'A') goto yy1130;\n \tif (yych != 'a') goto yy56;\n-yy1190:\n+yy1130:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1123;\n-\tif (yych == 'y') goto yy1123;\n+\tif (yych == 'Y') goto yy1063;\n+\tif (yych == 'y') goto yy1063;\n \tgoto yy56;\n-yy1191:\n+yy1131:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n@@ -16043,7 +15139,7 @@ yy1191:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'E') goto yy1098;\n+\t\t\tif (yych <= 'E') goto yy1038;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -16052,13 +15148,13 @@ yy1191:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1192;\n+\t\t\t\tif (yych <= 'e') goto yy1132;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1192:\n+yy1132:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'U') {\n@@ -16073,7 +15169,7 @@ yy1192:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'V') goto yy1099;\n+\t\t\tif (yych <= 'V') goto yy1039;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -16082,13 +15178,13 @@ yy1192:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'v') goto yy1193;\n+\t\t\t\tif (yych <= 'v') goto yy1133;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1193:\n+yy1133:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'H') {\n@@ -16103,7 +15199,7 @@ yy1193:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'I') goto yy1100;\n+\t\t\tif (yych <= 'I') goto yy1040;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -16112,13 +15208,13 @@ yy1193:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'i') goto yy1194;\n+\t\t\t\tif (yych <= 'i') goto yy1134;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1194:\n+yy1134:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'N') {\n@@ -16133,7 +15229,7 @@ yy1194:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'O') goto yy1101;\n+\t\t\tif (yych <= 'O') goto yy1041;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -16142,13 +15238,13 @@ yy1194:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'o') goto yy1195;\n+\t\t\t\tif (yych <= 'o') goto yy1135;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1195:\n+yy1135:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n@@ -16162,18 +15258,18 @@ yy1195:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'U') goto yy1102;\n+\t\t\tif (yych <= 'U') goto yy1042;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy1196;\n+\t\t\tif (yych == 'u') goto yy1136;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1196:\n+yy1136:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'S') goto yy1103;\n+\tif (yych == 'S') goto yy1043;\n \tif (yych != 's') goto yy154;\n \tyych = *++YYCURSOR;\n \tif (yybm[0+yych] & 16) {\n@@ -16182,9 +15278,9 @@ yy1196:\n \tif (yych <= ',') {\n \t\tif (yych <= '\\t') {\n \t\t\tif (yych <= 0x08) goto yy56;\n-\t\t\tgoto yy1104;\n+\t\t\tgoto yy1044;\n \t\t} else {\n-\t\t\tif (yych == ' ') goto yy1104;\n+\t\t\tif (yych == ' ') goto yy1044;\n \t\t\tgoto yy56;\n \t\t}\n \t} else {\n@@ -16196,7 +15292,7 @@ yy1196:\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy1198:\n+yy1138:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'G') {\n \t\tif (yych <= ')') {\n@@ -16205,7 +15301,7 @@ yy1198:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'F') goto yy141;\n-\t\t\tgoto yy1212;\n+\t\t\tgoto yy1152;\n \t\t}\n \t} else {\n \t\tif (yych <= 'f') {\n@@ -16213,12 +15309,12 @@ yy1198:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'g') goto yy1212;\n+\t\t\tif (yych <= 'g') goto yy1152;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1199:\n+yy1139:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'E') {\n \t\tif (yych <= ')') {\n@@ -16234,12 +15330,12 @@ yy1199:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy1200;\n+\t\t\tif (yych <= 'e') goto yy1140;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1200:\n+yy1140:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'V') {\n \t\tif (yych <= ')') {\n@@ -16255,12 +15351,12 @@ yy1200:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'v') goto yy1201;\n+\t\t\tif (yych <= 'v') goto yy1141;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1201:\n+yy1141:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'E') {\n \t\tif (yych <= ')') {\n@@ -16276,12 +15372,12 @@ yy1201:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy1202;\n+\t\t\tif (yych <= 'e') goto yy1142;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1202:\n+yy1142:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n \t\tif (yych <= ')') {\n@@ -16297,56 +15393,56 @@ yy1202:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'n') goto yy1203;\n+\t\t\tif (yych <= 'n') goto yy1143;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1203:\n+yy1143:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'T') goto yy1204;\n+\t\tif (yych <= 'T') goto yy1144;\n \t\tif (yych != 't') goto yy3;\n \t}\n-yy1204:\n+yy1144:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'H') goto yy1205;\n+\tif (yych == 'H') goto yy1145;\n \tif (yych != 'h') goto yy56;\n-yy1205:\n+yy1145:\n \tyych = *++YYCURSOR;\n-\tif (yych == '\\t') goto yy1206;\n+\tif (yych == '\\t') goto yy1146;\n \tif (yych != ' ') goto yy56;\n-yy1206:\n+yy1146:\n \t++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 11) YYFILL(11);\n \tyych = *YYCURSOR;\n-yy1207:\n+yy1147:\n \tif (yych <= 'W') {\n \t\tif (yych <= 'F') {\n \t\t\tif (yych <= ' ') {\n-\t\t\t\tif (yych == '\\t') goto yy1206;\n+\t\t\t\tif (yych == '\\t') goto yy1146;\n \t\t\t\tif (yych <= 0x1F) goto yy56;\n-\t\t\t\tgoto yy1206;\n+\t\t\t\tgoto yy1146;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'D') goto yy1109;\n+\t\t\t\tif (yych == 'D') goto yy1049;\n \t\t\t\tif (yych <= 'E') goto yy56;\n-\t\t\t\tgoto yy1110;\n+\t\t\t\tgoto yy1050;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'M') {\n-\t\t\t\tif (yych == 'H') goto yy1108;\n+\t\t\t\tif (yych == 'H') goto yy1048;\n \t\t\t\tif (yych <= 'L') goto yy56;\n-\t\t\t\tgoto yy1107;\n+\t\t\t\tgoto yy1047;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'S') {\n \t\t\t\t\tif (yych <= 'R') goto yy56;\n-\t\t\t\t\tgoto yy1106;\n+\t\t\t\t\tgoto yy1046;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych <= 'T') goto yy1113;\n+\t\t\t\t\tif (yych <= 'T') goto yy1053;\n \t\t\t\t\tif (yych <= 'V') goto yy56;\n \t\t\t\t}\n \t\t\t}\n@@ -16354,66 +15450,66 @@ yy1207:\n \t} else {\n \t\tif (yych <= 'l') {\n \t\t\tif (yych <= 'd') {\n-\t\t\t\tif (yych == 'Y') goto yy1111;\n+\t\t\t\tif (yych == 'Y') goto yy1051;\n \t\t\t\tif (yych <= 'c') goto yy56;\n-\t\t\t\tgoto yy1109;\n+\t\t\t\tgoto yy1049;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'f') {\n \t\t\t\t\tif (yych <= 'e') goto yy56;\n-\t\t\t\t\tgoto yy1110;\n+\t\t\t\t\tgoto yy1050;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych == 'h') goto yy1108;\n+\t\t\t\t\tif (yych == 'h') goto yy1048;\n \t\t\t\t\tgoto yy56;\n \t\t\t\t}\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n-\t\t\t\tif (yych <= 'm') goto yy1107;\n+\t\t\t\tif (yych <= 'm') goto yy1047;\n \t\t\t\tif (yych <= 'r') goto yy56;\n-\t\t\t\tif (yych <= 's') goto yy1106;\n-\t\t\t\tgoto yy1113;\n+\t\t\t\tif (yych <= 's') goto yy1046;\n+\t\t\t\tgoto yy1053;\n \t\t\t} else {\n \t\t\t\tif (yych <= 'w') {\n \t\t\t\t\tif (yych <= 'v') goto yy56;\n \t\t\t\t} else {\n-\t\t\t\t\tif (yych == 'y') goto yy1111;\n+\t\t\t\t\tif (yych == 'y') goto yy1051;\n \t\t\t\t\tgoto yy56;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy1209;\n+\tif (yych == 'E') goto yy1149;\n \tif (yych != 'e') goto yy56;\n-yy1209:\n+yy1149:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'E') {\n \t\tif (yych <= 'C') goto yy56;\n-\t\tif (yych <= 'D') goto yy1134;\n+\t\tif (yych <= 'D') goto yy1074;\n \t} else {\n \t\tif (yych <= 'c') goto yy56;\n-\t\tif (yych <= 'd') goto yy1134;\n+\t\tif (yych <= 'd') goto yy1074;\n \t\tif (yych >= 'f') goto yy56;\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'K') goto yy1211;\n+\tif (yych == 'K') goto yy1151;\n \tif (yych != 'k') goto yy56;\n-yy1211:\n+yy1151:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'S') {\n-\t\tif (yych == 'D') goto yy1143;\n+\t\tif (yych == 'D') goto yy1083;\n \t\tif (yych <= 'R') goto yy56;\n-\t\tgoto yy1142;\n+\t\tgoto yy1082;\n \t} else {\n \t\tif (yych <= 'd') {\n \t\t\tif (yych <= 'c') goto yy56;\n-\t\t\tgoto yy1143;\n+\t\t\tgoto yy1083;\n \t\t} else {\n-\t\t\tif (yych == 's') goto yy1142;\n+\t\t\tif (yych == 's') goto yy1082;\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy1212:\n+yy1152:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'H') {\n \t\tif (yych <= ')') {\n@@ -16429,12 +15525,12 @@ yy1212:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'h') goto yy1213;\n+\t\t\tif (yych <= 'h') goto yy1153;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1213:\n+yy1153:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -16450,46 +15546,46 @@ yy1213:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1214;\n+\t\t\tif (yych <= 't') goto yy1154;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1214:\n+yy1154:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy1206;\n+\t\t\tif (yych == '\\t') goto yy1146;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy1206;\n+\t\t\tif (yych <= ' ') goto yy1146;\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tgoto yy3;\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych == 'H') goto yy1215;\n+\t\t\tif (yych == 'H') goto yy1155;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'h') goto yy1215;\n+\t\t\tif (yych == 'h') goto yy1155;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1215:\n+yy1155:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 0x1F) {\n-\t\tif (yych == '\\t') goto yy1206;\n+\t\tif (yych == '\\t') goto yy1146;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= ' ') goto yy1206;\n+\t\tif (yych <= ' ') goto yy1146;\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t}\n-yy1216:\n+yy1156:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'F') {\n@@ -16504,7 +15600,7 @@ yy1216:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'G') goto yy1212;\n+\t\t\tif (yych <= 'G') goto yy1152;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -16513,13 +15609,13 @@ yy1216:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'g') goto yy1224;\n+\t\t\t\tif (yych <= 'g') goto yy1164;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1217:\n+yy1157:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n@@ -16534,7 +15630,7 @@ yy1217:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'E') goto yy1200;\n+\t\t\tif (yych <= 'E') goto yy1140;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -16543,13 +15639,13 @@ yy1217:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1218;\n+\t\t\t\tif (yych <= 'e') goto yy1158;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1218:\n+yy1158:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'U') {\n@@ -16564,7 +15660,7 @@ yy1218:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'V') goto yy1201;\n+\t\t\tif (yych <= 'V') goto yy1141;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -16573,13 +15669,13 @@ yy1218:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'v') goto yy1219;\n+\t\t\t\tif (yych <= 'v') goto yy1159;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1219:\n+yy1159:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n@@ -16594,7 +15690,7 @@ yy1219:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'E') goto yy1202;\n+\t\t\tif (yych <= 'E') goto yy1142;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -16603,13 +15699,13 @@ yy1219:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1220;\n+\t\t\t\tif (yych <= 'e') goto yy1160;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1220:\n+yy1160:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'M') {\n@@ -16624,7 +15720,7 @@ yy1220:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'N') goto yy1203;\n+\t\t\tif (yych <= 'N') goto yy1143;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -16633,13 +15729,13 @@ yy1220:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'n') goto yy1221;\n+\t\t\t\tif (yych <= 'n') goto yy1161;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1221:\n+yy1161:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -16653,20 +15749,20 @@ yy1221:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'T') goto yy1204;\n+\t\t\tif (yych <= 'T') goto yy1144;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 't') goto yy1222;\n+\t\t\tif (yych == 't') goto yy1162;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1222:\n+yy1162:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'H') goto yy1205;\n+\tif (yych == 'H') goto yy1145;\n \tif (yych != 'h') goto yy154;\n-yy1223:\n+yy1163:\n \tyych = *++YYCURSOR;\n \tif (yybm[0+yych] & 16) {\n \t\tgoto yy153;\n@@ -16674,9 +15770,9 @@ yy1223:\n \tif (yych <= ',') {\n \t\tif (yych <= '\\t') {\n \t\t\tif (yych <= 0x08) goto yy56;\n-\t\t\tgoto yy1206;\n+\t\t\tgoto yy1146;\n \t\t} else {\n-\t\t\tif (yych == ' ') goto yy1206;\n+\t\t\tif (yych == ' ') goto yy1146;\n \t\t\tgoto yy56;\n \t\t}\n \t} else {\n@@ -16688,7 +15784,7 @@ yy1223:\n \t\t\tgoto yy56;\n \t\t}\n \t}\n-yy1224:\n+yy1164:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n@@ -16703,7 +15799,7 @@ yy1224:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'H') goto yy1213;\n+\t\t\tif (yych <= 'H') goto yy1153;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -16712,13 +15808,13 @@ yy1224:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'h') goto yy1225;\n+\t\t\t\tif (yych <= 'h') goto yy1165;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1225:\n+yy1165:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -16733,7 +15829,7 @@ yy1225:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1214;\n+\t\t\tif (yych <= 'T') goto yy1154;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -16742,22 +15838,22 @@ yy1225:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1226;\n+\t\t\t\tif (yych <= 't') goto yy1166;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1226:\n+yy1166:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n \t\tif (yych <= '(') {\n \t\t\tif (yych <= '\\t') {\n \t\t\t\tif (yych <= 0x08) goto yy3;\n-\t\t\t\tgoto yy1206;\n+\t\t\t\tgoto yy1146;\n \t\t\t} else {\n-\t\t\t\tif (yych == ' ') goto yy1206;\n+\t\t\t\tif (yych == ' ') goto yy1146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t} else {\n@@ -16775,7 +15871,7 @@ yy1226:\n \t\t\t\tif (yych <= '@') goto yy3;\n \t\t\t\tgoto yy144;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'H') goto yy1215;\n+\t\t\t\tif (yych <= 'H') goto yy1155;\n \t\t\t\tif (yych <= 'Z') goto yy144;\n \t\t\t\tgoto yy3;\n \t\t\t}\n@@ -16785,13 +15881,13 @@ yy1226:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'h') goto yy1227;\n+\t\t\t\tif (yych <= 'h') goto yy1167;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1227:\n+yy1167:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yybm[0+yych] & 16) {\n@@ -16799,10 +15895,10 @@ yy1227:\n \t}\n \tif (yych <= ')') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy1206;\n+\t\t\tif (yych == '\\t') goto yy1146;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy1206;\n+\t\t\tif (yych <= ' ') goto yy1146;\n \t\t\tif (yych <= '(') goto yy3;\n \t\t\tgoto yy139;\n \t\t}\n@@ -16816,7 +15912,7 @@ yy1227:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1228:\n+yy1168:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'V') {\n \t\tif (yych <= 'B') {\n@@ -16825,12 +15921,12 @@ yy1228:\n \t\t\tgoto yy141;\n \t\t} else {\n \t\t\tif (yych <= 'O') {\n-\t\t\t\tif (yych <= 'C') goto yy1244;\n+\t\t\t\tif (yych <= 'C') goto yy1184;\n \t\t\t\tgoto yy141;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'P') goto yy1246;\n+\t\t\t\tif (yych <= 'P') goto yy1186;\n \t\t\t\tif (yych <= 'U') goto yy141;\n-\t\t\t\tgoto yy1245;\n+\t\t\t\tgoto yy1185;\n \t\t\t}\n \t\t}\n \t} else {\n@@ -16839,21 +15935,21 @@ yy1228:\n \t\t\t\tif (yych <= 'Z') goto yy141;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'c') goto yy1244;\n+\t\t\t\tif (yych == 'c') goto yy1184;\n \t\t\t\tgoto yy141;\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'u') {\n-\t\t\t\tif (yych <= 'p') goto yy1246;\n+\t\t\t\tif (yych <= 'p') goto yy1186;\n \t\t\t\tgoto yy141;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'v') goto yy1245;\n+\t\t\t\tif (yych <= 'v') goto yy1185;\n \t\t\t\tif (yych <= 'z') goto yy141;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1229:\n+yy1169:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -16862,7 +15958,7 @@ yy1229:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'S') goto yy141;\n-\t\t\tgoto yy1239;\n+\t\t\tgoto yy1179;\n \t\t}\n \t} else {\n \t\tif (yych <= 's') {\n@@ -16870,12 +15966,12 @@ yy1229:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1239;\n+\t\t\tif (yych <= 't') goto yy1179;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1230:\n+yy1170:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'X') {\n \t\tif (yych <= ')') {\n@@ -16884,7 +15980,7 @@ yy1230:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'W') goto yy141;\n-\t\t\tgoto yy1236;\n+\t\t\tgoto yy1176;\n \t\t}\n \t} else {\n \t\tif (yych <= 'w') {\n@@ -16892,12 +15988,12 @@ yy1230:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'x') goto yy1236;\n+\t\t\tif (yych <= 'x') goto yy1176;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1231:\n+yy1171:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n \t\tif (yych <= ')') {\n@@ -16913,12 +16009,12 @@ yy1231:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'n') goto yy1232;\n+\t\t\tif (yych <= 'n') goto yy1172;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1232:\n+yy1172:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'D') {\n \t\tif (yych <= ')') {\n@@ -16934,12 +16030,12 @@ yy1232:\n \t\t\tif (yych <= '`') goto yy166;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'd') goto yy1233;\n+\t\t\tif (yych <= 'd') goto yy1173;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy166;\n \t\t}\n \t}\n-yy1233:\n+yy1173:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'A') {\n \t\tif (yych == ')') goto yy139;\n@@ -16949,12 +16045,12 @@ yy1233:\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy1234;\n+\t\t\tif (yych <= 'a') goto yy1174;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1234:\n+yy1174:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'Y') {\n \t\tif (yych <= ')') {\n@@ -16970,16 +16066,16 @@ yy1234:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'y') goto yy1235;\n+\t\t\tif (yych <= 'y') goto yy1175;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1235:\n+yy1175:\n \tyych = *++YYCURSOR;\n \tif (yych == ')') goto yy139;\n \tgoto yy166;\n-yy1236:\n+yy1176:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -16995,12 +16091,12 @@ yy1236:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1237;\n+\t\t\tif (yych <= 't') goto yy1177;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1237:\n+yy1177:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'H') {\n \t\tif (yych <= ')') {\n@@ -17016,20 +16112,20 @@ yy1237:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'h') goto yy1238;\n+\t\t\tif (yych <= 'h') goto yy1178;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1238:\n+yy1178:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '(') {\n \t\tif (yych <= '\\t') {\n \t\t\tif (yych <= 0x08) goto yy3;\n-\t\t\tgoto yy1206;\n+\t\t\tgoto yy1146;\n \t\t} else {\n-\t\t\tif (yych == ' ') goto yy1206;\n+\t\t\tif (yych == ' ') goto yy1146;\n \t\t\tgoto yy3;\n \t\t}\n \t} else {\n@@ -17043,7 +16139,7 @@ yy1238:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1239:\n+yy1179:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n \t\tif (yych <= ')') {\n@@ -17059,12 +16155,12 @@ yy1239:\n \t\t\tif (yych <= '`') goto yy166;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'u') goto yy1240;\n+\t\t\tif (yych <= 'u') goto yy1180;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy166;\n \t\t}\n \t}\n-yy1240:\n+yy1180:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'R') {\n \t\tif (yych <= ')') {\n@@ -17080,12 +16176,12 @@ yy1240:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy1241;\n+\t\t\tif (yych <= 'r') goto yy1181;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1241:\n+yy1181:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'D') {\n \t\tif (yych <= ')') {\n@@ -17101,27 +16197,27 @@ yy1241:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'd') goto yy1242;\n+\t\t\tif (yych <= 'd') goto yy1182;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1242:\n+yy1182:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'A') goto yy1243;\n+\t\tif (yych <= 'A') goto yy1183;\n \t\tif (yych != 'a') goto yy3;\n \t}\n-yy1243:\n+yy1183:\n \tyych = *++YYCURSOR;\n \tif (yych == 'Y') goto yy172;\n \tif (yych == 'y') goto yy172;\n \tgoto yy56;\n-yy1244:\n+yy1184:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'O') {\n \t\tif (yych <= ')') {\n@@ -17130,7 +16226,7 @@ yy1244:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'N') goto yy142;\n-\t\t\tgoto yy1255;\n+\t\t\tgoto yy1195;\n \t\t}\n \t} else {\n \t\tif (yych <= 'n') {\n@@ -17138,12 +16234,12 @@ yy1244:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'o') goto yy1255;\n+\t\t\tif (yych <= 'o') goto yy1195;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1245:\n+yy1185:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'E') {\n \t\tif (yych <= ')') {\n@@ -17152,7 +16248,7 @@ yy1245:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'D') goto yy142;\n-\t\t\tgoto yy1252;\n+\t\t\tgoto yy1192;\n \t\t}\n \t} else {\n \t\tif (yych <= 'd') {\n@@ -17160,12 +16256,12 @@ yy1245:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy1252;\n+\t\t\tif (yych <= 'e') goto yy1192;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1246:\n+yy1186:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n@@ -17200,13 +16296,13 @@ yy1246:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1247;\n+\t\t\t\tif (yych <= 't') goto yy1187;\n \t\t\t\tif (yych <= 'z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy1247:\n+yy1187:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n@@ -17241,13 +16337,13 @@ yy1247:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy143;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1248;\n+\t\t\t\tif (yych <= 'e') goto yy1188;\n \t\t\t\tif (yych <= 'z') goto yy143;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy1248:\n+yy1188:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'M') {\n \t\tif (yych <= ')') {\n@@ -17263,31 +16359,31 @@ yy1248:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'm') goto yy1249;\n+\t\t\tif (yych <= 'm') goto yy1189;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1249:\n+yy1189:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'A') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'B') goto yy1250;\n+\t\tif (yych <= 'B') goto yy1190;\n \t\tif (yych != 'b') goto yy3;\n \t}\n-yy1250:\n+yy1190:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy1251;\n+\tif (yych == 'E') goto yy1191;\n \tif (yych != 'e') goto yy56;\n-yy1251:\n+yy1191:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy205;\n-\tif (yych == 'r') goto yy205;\n+\tif (yych == 'R') goto yy204;\n+\tif (yych == 'r') goto yy204;\n \tgoto yy56;\n-yy1252:\n+yy1192:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n \t\tif (yych <= ')') {\n@@ -17303,12 +16399,12 @@ yy1252:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'n') goto yy1253;\n+\t\t\tif (yych <= 'n') goto yy1193;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1253:\n+yy1193:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -17324,23 +16420,23 @@ yy1253:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1254;\n+\t\t\tif (yych <= 't') goto yy1194;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1254:\n+yy1194:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'H') goto yy1205;\n-\t\tif (yych == 'h') goto yy1205;\n+\t\tif (yych <= 'H') goto yy1145;\n+\t\tif (yych == 'h') goto yy1145;\n \t\tgoto yy3;\n \t}\n-yy1255:\n+yy1195:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n \t\tif (yych <= ')') {\n@@ -17356,12 +16452,12 @@ yy1255:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'n') goto yy1256;\n+\t\t\tif (yych <= 'n') goto yy1196;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1256:\n+yy1196:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'D') {\n \t\tif (yych <= ')') {\n@@ -17370,7 +16466,7 @@ yy1256:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'C') goto yy144;\n-\t\t\tgoto yy1215;\n+\t\t\tgoto yy1155;\n \t\t}\n \t} else {\n \t\tif (yych <= 'c') {\n@@ -17378,12 +16474,12 @@ yy1256:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'd') goto yy1215;\n+\t\t\tif (yych <= 'd') goto yy1155;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1257:\n+yy1197:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'U') {\n@@ -17399,16 +16495,16 @@ yy1257:\n \t\t\tif (yych <= 'C') {\n \t\t\t\tif (yych <= '@') goto yy3;\n \t\t\t\tif (yych <= 'B') goto yy141;\n-\t\t\t\tgoto yy1244;\n+\t\t\t\tgoto yy1184;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'P') goto yy1246;\n+\t\t\t\tif (yych == 'P') goto yy1186;\n \t\t\t\tgoto yy141;\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= 'b') {\n \t\t\tif (yych <= '^') {\n-\t\t\t\tif (yych <= 'V') goto yy1245;\n+\t\t\t\tif (yych <= 'V') goto yy1185;\n \t\t\t\tif (yych <= 'Z') goto yy141;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n@@ -17418,17 +16514,17 @@ yy1257:\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'p') {\n-\t\t\t\tif (yych <= 'c') goto yy1273;\n+\t\t\t\tif (yych <= 'c') goto yy1213;\n \t\t\t\tif (yych <= 'o') goto yy146;\n-\t\t\t\tgoto yy1275;\n+\t\t\t\tgoto yy1215;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'v') goto yy1274;\n+\t\t\t\tif (yych == 'v') goto yy1214;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1258:\n+yy1198:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -17443,7 +16539,7 @@ yy1258:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1239;\n+\t\t\tif (yych <= 'T') goto yy1179;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -17452,13 +16548,13 @@ yy1258:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1268;\n+\t\t\t\tif (yych <= 't') goto yy1208;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1259:\n+yy1199:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'W') {\n@@ -17473,7 +16569,7 @@ yy1259:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'X') goto yy1236;\n+\t\t\tif (yych <= 'X') goto yy1176;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -17482,13 +16578,13 @@ yy1259:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'x') goto yy1265;\n+\t\t\t\tif (yych <= 'x') goto yy1205;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1260:\n+yy1200:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'M') {\n@@ -17503,7 +16599,7 @@ yy1260:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'N') goto yy1232;\n+\t\t\tif (yych <= 'N') goto yy1172;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -17512,13 +16608,13 @@ yy1260:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'n') goto yy1261;\n+\t\t\t\tif (yych <= 'n') goto yy1201;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1261:\n+yy1201:\n \tyyaccept = 4;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'C') {\n@@ -17533,7 +16629,7 @@ yy1261:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'D') goto yy1233;\n+\t\t\tif (yych <= 'D') goto yy1173;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy166;\n \t\t\tgoto yy147;\n@@ -17542,13 +16638,13 @@ yy1261:\n \t\t\t\tif (yych <= '`') goto yy166;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'd') goto yy1262;\n+\t\t\t\tif (yych <= 'd') goto yy1202;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy166;\n \t\t\t}\n \t\t}\n \t}\n-yy1262:\n+yy1202:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n@@ -17562,18 +16658,18 @@ yy1262:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'A') goto yy1234;\n+\t\t\tif (yych <= 'A') goto yy1174;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n \t\t} else {\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tif (yych <= 'a') goto yy1263;\n+\t\t\tif (yych <= 'a') goto yy1203;\n \t\t\tif (yych <= 'z') goto yy151;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1263:\n+yy1203:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'X') {\n@@ -17588,7 +16684,7 @@ yy1263:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'Y') goto yy1235;\n+\t\t\tif (yych <= 'Y') goto yy1175;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -17597,13 +16693,13 @@ yy1263:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'y') goto yy1264;\n+\t\t\t\tif (yych <= 'y') goto yy1204;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1264:\n+yy1204:\n \tyyaccept = 4;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yybm[0+yych] & 16) {\n@@ -17622,7 +16718,7 @@ yy1264:\n \t\t\tgoto yy166;\n \t\t}\n \t}\n-yy1265:\n+yy1205:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -17637,7 +16733,7 @@ yy1265:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1237;\n+\t\t\tif (yych <= 'T') goto yy1177;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -17646,13 +16742,13 @@ yy1265:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1266;\n+\t\t\t\tif (yych <= 't') goto yy1206;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1266:\n+yy1206:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n@@ -17667,7 +16763,7 @@ yy1266:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'H') goto yy1238;\n+\t\t\tif (yych <= 'H') goto yy1178;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -17676,20 +16772,20 @@ yy1266:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'h') goto yy1267;\n+\t\t\t\tif (yych <= 'h') goto yy1207;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1267:\n+yy1207:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '-') {\n \t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy1206;\n+\t\t\tif (yych == '\\t') goto yy1146;\n \t\t\tif (yych <= 0x1F) goto yy3;\n-\t\t\tgoto yy1206;\n+\t\t\tgoto yy1146;\n \t\t} else {\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tif (yych <= ',') goto yy3;\n@@ -17711,7 +16807,7 @@ yy1267:\n \t\t\t}\n \t\t}\n \t}\n-yy1268:\n+yy1208:\n \tyyaccept = 4;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n@@ -17726,7 +16822,7 @@ yy1268:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'U') goto yy1240;\n+\t\t\tif (yych <= 'U') goto yy1180;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy166;\n \t\t\tgoto yy147;\n@@ -17735,13 +16831,13 @@ yy1268:\n \t\t\t\tif (yych <= '`') goto yy166;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'u') goto yy1269;\n+\t\t\t\tif (yych <= 'u') goto yy1209;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy166;\n \t\t\t}\n \t\t}\n \t}\n-yy1269:\n+yy1209:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n@@ -17756,7 +16852,7 @@ yy1269:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'R') goto yy1241;\n+\t\t\tif (yych <= 'R') goto yy1181;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -17765,13 +16861,13 @@ yy1269:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy1270;\n+\t\t\t\tif (yych <= 'r') goto yy1210;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1270:\n+yy1210:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'C') {\n@@ -17786,7 +16882,7 @@ yy1270:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'D') goto yy1242;\n+\t\t\tif (yych <= 'D') goto yy1182;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -17795,13 +16891,13 @@ yy1270:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'd') goto yy1271;\n+\t\t\t\tif (yych <= 'd') goto yy1211;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1271:\n+yy1211:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n@@ -17815,22 +16911,22 @@ yy1271:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'A') goto yy1243;\n+\t\t\tif (yych <= 'A') goto yy1183;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n \t\t} else {\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tif (yych <= 'a') goto yy1272;\n+\t\t\tif (yych <= 'a') goto yy1212;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1272:\n+yy1212:\n \tyych = *++YYCURSOR;\n \tif (yych == 'Y') goto yy172;\n \tif (yych == 'y') goto yy185;\n \tgoto yy154;\n-yy1273:\n+yy1213:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'N') {\n@@ -17845,7 +16941,7 @@ yy1273:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'O') goto yy1255;\n+\t\t\tif (yych <= 'O') goto yy1195;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -17854,13 +16950,13 @@ yy1273:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'o') goto yy1284;\n+\t\t\t\tif (yych <= 'o') goto yy1224;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1274:\n+yy1214:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n@@ -17875,7 +16971,7 @@ yy1274:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'E') goto yy1252;\n+\t\t\tif (yych <= 'E') goto yy1192;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -17884,13 +16980,13 @@ yy1274:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1281;\n+\t\t\t\tif (yych <= 'e') goto yy1221;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1275:\n+yy1215:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n@@ -17906,7 +17002,7 @@ yy1275:\n \t\t\tif (yych <= '-') {\n \t\t\t\tif (yych <= ')') goto yy139;\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tgoto yy371;\n+\t\t\t\tgoto yy311;\n \t\t\t} else {\n \t\t\t\tif (yych == '\/') goto yy147;\n \t\t\t\tgoto yy195;\n@@ -17918,7 +17014,7 @@ yy1275:\n \t\t\t\tif (yych <= '@') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'T') goto yy1247;\n+\t\t\t\tif (yych <= 'T') goto yy1187;\n \t\t\t\tif (yych <= 'Z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n@@ -17928,13 +17024,13 @@ yy1275:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1276;\n+\t\t\t\tif (yych <= 't') goto yy1216;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy1276:\n+yy1216:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n@@ -17950,7 +17046,7 @@ yy1276:\n \t\t\tif (yych <= '-') {\n \t\t\t\tif (yych <= ')') goto yy139;\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tgoto yy371;\n+\t\t\t\tgoto yy311;\n \t\t\t} else {\n \t\t\t\tif (yych == '\/') goto yy147;\n \t\t\t\tgoto yy195;\n@@ -17962,7 +17058,7 @@ yy1276:\n \t\t\t\tif (yych <= '@') goto yy193;\n \t\t\t\tgoto yy143;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'E') goto yy1248;\n+\t\t\t\tif (yych <= 'E') goto yy1188;\n \t\t\t\tif (yych <= 'Z') goto yy143;\n \t\t\t\tgoto yy193;\n \t\t\t}\n@@ -17972,13 +17068,13 @@ yy1276:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1277;\n+\t\t\t\tif (yych <= 'e') goto yy1217;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy1277:\n+yy1217:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'L') {\n@@ -17993,7 +17089,7 @@ yy1277:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'M') goto yy1249;\n+\t\t\tif (yych <= 'M') goto yy1189;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -18002,13 +17098,13 @@ yy1277:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'm') goto yy1278;\n+\t\t\t\tif (yych <= 'm') goto yy1218;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1278:\n+yy1218:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'A') {\n@@ -18022,24 +17118,24 @@ yy1278:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'B') goto yy1250;\n+\t\t\tif (yych <= 'B') goto yy1190;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'b') goto yy1279;\n+\t\t\tif (yych == 'b') goto yy1219;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1279:\n+yy1219:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'E') goto yy1251;\n+\tif (yych == 'E') goto yy1191;\n \tif (yych != 'e') goto yy154;\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy205;\n-\tif (yych == 'r') goto yy376;\n+\tif (yych == 'R') goto yy204;\n+\tif (yych == 'r') goto yy316;\n \tgoto yy154;\n-yy1281:\n+yy1221:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'M') {\n@@ -18054,7 +17150,7 @@ yy1281:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'N') goto yy1253;\n+\t\t\tif (yych <= 'N') goto yy1193;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -18063,13 +17159,13 @@ yy1281:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'n') goto yy1282;\n+\t\t\t\tif (yych <= 'n') goto yy1222;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1282:\n+yy1222:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -18084,7 +17180,7 @@ yy1282:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1254;\n+\t\t\tif (yych <= 'T') goto yy1194;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -18093,13 +17189,13 @@ yy1282:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1283;\n+\t\t\t\tif (yych <= 't') goto yy1223;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1283:\n+yy1223:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n@@ -18113,16 +17209,16 @@ yy1283:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'H') goto yy1205;\n+\t\t\tif (yych <= 'H') goto yy1145;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'h') goto yy1223;\n+\t\t\tif (yych == 'h') goto yy1163;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1284:\n+yy1224:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'M') {\n@@ -18137,7 +17233,7 @@ yy1284:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'N') goto yy1256;\n+\t\t\tif (yych <= 'N') goto yy1196;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -18146,13 +17242,13 @@ yy1284:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'n') goto yy1285;\n+\t\t\t\tif (yych <= 'n') goto yy1225;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1285:\n+yy1225:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'C') {\n@@ -18167,7 +17263,7 @@ yy1285:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'D') goto yy1215;\n+\t\t\tif (yych <= 'D') goto yy1155;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -18176,13 +17272,13 @@ yy1285:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'd') goto yy1227;\n+\t\t\t\tif (yych <= 'd') goto yy1167;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1286:\n+yy1226:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'C') {\n \t\tif (yych <= ')') {\n@@ -18198,12 +17294,12 @@ yy1286:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'c') goto yy1287;\n+\t\t\tif (yych <= 'c') goto yy1227;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1287:\n+yy1227:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'K') {\n \t\tif (yych <= ')') {\n@@ -18219,16 +17315,16 @@ yy1287:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'k') goto yy1288;\n+\t\t\tif (yych <= 'k') goto yy1228;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1288:\n+yy1228:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ')') {\n-\t\tif (yych == ' ') goto yy1289;\n+\t\tif (yych == ' ') goto yy1229;\n \t\tif (yych <= '(') goto yy3;\n \t\tgoto yy139;\n \t} else {\n@@ -18241,30 +17337,30 @@ yy1288:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1289:\n+yy1229:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'O') goto yy1290;\n+\tif (yych == 'O') goto yy1230;\n \tif (yych != 'o') goto yy56;\n-yy1290:\n+yy1230:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'F') goto yy1291;\n+\tif (yych == 'F') goto yy1231;\n \tif (yych != 'f') goto yy56;\n-yy1291:\n+yy1231:\n \tyych = *++YYCURSOR;\n \tif (yych != ' ') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '1') goto yy1293;\n-\tif (yych <= '2') goto yy1295;\n-\tif (yych <= '9') goto yy1296;\n+\tif (yych <= '1') goto yy1233;\n+\tif (yych <= '2') goto yy1235;\n+\tif (yych <= '9') goto yy1236;\n \tgoto yy56;\n-yy1293:\n-\tyyaccept = 28;\n+yy1233:\n+\tyyaccept = 27;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') goto yy1297;\n-\tif (yych <= '9') goto yy1296;\n-\tgoto yy1297;\n-yy1294:\n+\tif (yych <= '\/') goto yy1237;\n+\tif (yych <= '9') goto yy1236;\n+\tgoto yy1237;\n+yy1234:\n #line 1053 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tDEBUG_OUTPUT(\"backof | frontof\");\n@@ -18287,67 +17383,67 @@ yy1294:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_LF_DAY_OF_MONTH;\n \t}\n-#line 18291 \"<stdout>\"\n-yy1295:\n-\tyyaccept = 28;\n+#line 17387 \"<stdout>\"\n+yy1235:\n+\tyyaccept = 27;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') goto yy1297;\n-\tif (yych >= '5') goto yy1297;\n-yy1296:\n-\tyyaccept = 28;\n+\tif (yych <= '\/') goto yy1237;\n+\tif (yych >= '5') goto yy1237;\n+yy1236:\n+\tyyaccept = 27;\n \tYYMARKER = ++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 5) YYFILL(5);\n \tyych = *YYCURSOR;\n-yy1297:\n+yy1237:\n \tif (yych <= 'A') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy1296;\n-\t\t\tgoto yy1294;\n+\t\t\tif (yych == '\\t') goto yy1236;\n+\t\t\tgoto yy1234;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy1296;\n-\t\t\tif (yych <= '@') goto yy1294;\n+\t\t\tif (yych <= ' ') goto yy1236;\n+\t\t\tif (yych <= '@') goto yy1234;\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych != 'P') goto yy1294;\n+\t\t\tif (yych != 'P') goto yy1234;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy1298;\n-\t\t\tif (yych != 'p') goto yy1294;\n+\t\t\tif (yych <= 'a') goto yy1238;\n+\t\t\tif (yych != 'p') goto yy1234;\n \t\t}\n \t}\n-yy1298:\n+yy1238:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'L') {\n \t\tif (yych != '.') goto yy56;\n \t} else {\n-\t\tif (yych <= 'M') goto yy1300;\n-\t\tif (yych == 'm') goto yy1300;\n+\t\tif (yych <= 'M') goto yy1240;\n+\t\tif (yych == 'm') goto yy1240;\n \t\tgoto yy56;\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy1300;\n+\tif (yych == 'M') goto yy1240;\n \tif (yych != 'm') goto yy56;\n-yy1300:\n+yy1240:\n \tyych = *++YYCURSOR;\n \tif (yych <= 0x1F) {\n-\t\tif (yych <= 0x00) goto yy1302;\n-\t\tif (yych == '\\t') goto yy1302;\n+\t\tif (yych <= 0x00) goto yy1242;\n+\t\tif (yych == '\\t') goto yy1242;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= ' ') goto yy1302;\n+\t\tif (yych <= ' ') goto yy1242;\n \t\tif (yych != '.') goto yy56;\n \t}\n \tyych = *++YYCURSOR;\n \tif (yych <= '\\t') {\n-\t\tif (yych <= 0x00) goto yy1302;\n+\t\tif (yych <= 0x00) goto yy1242;\n \t\tif (yych <= 0x08) goto yy56;\n \t} else {\n \t\tif (yych != ' ') goto yy56;\n \t}\n-yy1302:\n+yy1242:\n \tyych = *++YYCURSOR;\n-\tgoto yy1294;\n-yy1303:\n+\tgoto yy1234;\n+yy1243:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'B') {\n@@ -18362,7 +17458,7 @@ yy1303:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'C') goto yy1287;\n+\t\t\tif (yych <= 'C') goto yy1227;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -18371,13 +17467,13 @@ yy1303:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'c') goto yy1304;\n+\t\t\t\tif (yych <= 'c') goto yy1244;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1304:\n+yy1244:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'J') {\n@@ -18392,7 +17488,7 @@ yy1304:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'K') goto yy1288;\n+\t\t\tif (yych <= 'K') goto yy1228;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -18401,18 +17497,18 @@ yy1304:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'k') goto yy1305;\n+\t\t\t\tif (yych <= 'k') goto yy1245;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1305:\n+yy1245:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= '(') {\n-\t\t\tif (yych == ' ') goto yy1289;\n+\t\t\tif (yych == ' ') goto yy1229;\n \t\t\tgoto yy3;\n \t\t} else {\n \t\t\tif (yych <= ')') goto yy139;\n@@ -18432,7 +17528,7 @@ yy1305:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1306:\n+yy1246:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'S') {\n \t\tif (yych <= ')') {\n@@ -18448,12 +17544,12 @@ yy1306:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy1307;\n+\t\t\tif (yych <= 's') goto yy1247;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1307:\n+yy1247:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -18469,18 +17565,18 @@ yy1307:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1308;\n+\t\t\tif (yych <= 't') goto yy1248;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1308:\n+yy1248:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '(') {\n \t\tif (yych <= '\\t') {\n \t\t\tif (yych <= 0x08) goto yy3;\n-\t\t\tgoto yy1104;\n+\t\t\tgoto yy1044;\n \t\t} else {\n \t\t\tif (yych != ' ') goto yy3;\n \t\t}\n@@ -18495,36 +17591,36 @@ yy1308:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1309:\n+yy1249:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'D') goto yy1310;\n-\tif (yych != 'd') goto yy1105;\n-yy1310:\n+\tif (yych == 'D') goto yy1250;\n+\tif (yych != 'd') goto yy1045;\n+yy1250:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1311;\n+\tif (yych == 'A') goto yy1251;\n \tif (yych != 'a') goto yy56;\n-yy1311:\n+yy1251:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1312;\n+\tif (yych == 'Y') goto yy1252;\n \tif (yych != 'y') goto yy56;\n-yy1312:\n-\tyyaccept = 26;\n+yy1252:\n+\tyyaccept = 25;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'R') {\n-\t\tif (yych != ' ') goto yy1117;\n+\t\tif (yych != ' ') goto yy1057;\n \t} else {\n-\t\tif (yych <= 'S') goto yy1142;\n-\t\tif (yych == 's') goto yy1142;\n-\t\tgoto yy1117;\n+\t\tif (yych <= 'S') goto yy1082;\n+\t\tif (yych == 's') goto yy1082;\n+\t\tgoto yy1057;\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'O') goto yy1314;\n+\tif (yych == 'O') goto yy1254;\n \tif (yych != 'o') goto yy56;\n-yy1314:\n+yy1254:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'F') goto yy1315;\n+\tif (yych == 'F') goto yy1255;\n \tif (yych != 'f') goto yy56;\n-yy1315:\n+yy1255:\n \t++YYCURSOR;\n #line 1036 \"ext\/date\/lib\/parse_date.re\"\n \t{\n@@ -18542,8 +17638,8 @@ yy1315:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_LF_DAY_OF_MONTH;\n \t}\n-#line 18546 \"<stdout>\"\n-yy1317:\n+#line 17642 \"<stdout>\"\n+yy1257:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'R') {\n@@ -18558,7 +17654,7 @@ yy1317:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'S') goto yy1307;\n+\t\t\tif (yych <= 'S') goto yy1247;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -18567,13 +17663,13 @@ yy1317:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 's') goto yy1318;\n+\t\t\t\tif (yych <= 's') goto yy1258;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1318:\n+yy1258:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -18588,7 +17684,7 @@ yy1318:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1308;\n+\t\t\tif (yych <= 'T') goto yy1248;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -18597,20 +17693,20 @@ yy1318:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1319;\n+\t\t\t\tif (yych <= 't') goto yy1259;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1319:\n+yy1259:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '-') {\n \t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy1104;\n+\t\t\tif (yych == '\\t') goto yy1044;\n \t\t\tif (yych <= 0x1F) goto yy3;\n-\t\t\tgoto yy1309;\n+\t\t\tgoto yy1249;\n \t\t} else {\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tif (yych <= ',') goto yy3;\n@@ -18632,7 +17728,7 @@ yy1319:\n \t\t\t}\n \t\t}\n \t}\n-yy1320:\n+yy1260:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'B') {\n \t\tif (yych <= ')') {\n@@ -18641,7 +17737,7 @@ yy1320:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'A') goto yy141;\n-\t\t\tgoto yy1356;\n+\t\t\tgoto yy1296;\n \t\t}\n \t} else {\n \t\tif (yych <= 'a') {\n@@ -18649,35 +17745,35 @@ yy1320:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'b') goto yy1356;\n+\t\t\tif (yych <= 'b') goto yy1296;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1321:\n+yy1261:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'R') {\n \t\tif (yych <= '@') {\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'F') goto yy1346;\n+\t\t\tif (yych == 'F') goto yy1286;\n \t\t\tif (yych <= 'Q') goto yy141;\n-\t\t\tgoto yy1345;\n+\t\t\tgoto yy1285;\n \t\t}\n \t} else {\n \t\tif (yych <= 'f') {\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tif (yych <= 'e') goto yy141;\n-\t\t\tgoto yy1346;\n+\t\t\tgoto yy1286;\n \t\t} else {\n-\t\t\tif (yych == 'r') goto yy1345;\n+\t\t\tif (yych == 'r') goto yy1285;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1322:\n+yy1262:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n \t\tif (yych <= ')') {\n@@ -18686,7 +17782,7 @@ yy1322:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'T') goto yy141;\n-\t\t\tgoto yy1342;\n+\t\t\tgoto yy1282;\n \t\t}\n \t} else {\n \t\tif (yych <= 't') {\n@@ -18694,19 +17790,19 @@ yy1322:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'u') goto yy1342;\n+\t\t\tif (yych <= 'u') goto yy1282;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1323:\n+yy1263:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'O') {\n \t\tif (yych <= '@') {\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'I') goto yy1325;\n+\t\t\tif (yych == 'I') goto yy1265;\n \t\t\tif (yych <= 'N') goto yy141;\n \t\t}\n \t} else {\n@@ -18714,14 +17810,14 @@ yy1323:\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tif (yych <= 'h') goto yy141;\n-\t\t\tgoto yy1325;\n+\t\t\tgoto yy1265;\n \t\t} else {\n-\t\t\tif (yych == 'o') goto yy1324;\n+\t\t\tif (yych == 'o') goto yy1264;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1324:\n+yy1264:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n \t\tif (yych <= ')') {\n@@ -18730,7 +17826,7 @@ yy1324:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'M') goto yy142;\n-\t\t\tgoto yy1328;\n+\t\t\tgoto yy1268;\n \t\t}\n \t} else {\n \t\tif (yych <= 'm') {\n@@ -18738,12 +17834,12 @@ yy1324:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'n') goto yy1328;\n+\t\t\tif (yych <= 'n') goto yy1268;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1325:\n+yy1265:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'D') {\n \t\tif (yych <= ')') {\n@@ -18759,12 +17855,12 @@ yy1325:\n \t\t\tif (yych <= '`') goto yy166;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'd') goto yy1326;\n+\t\t\tif (yych <= 'd') goto yy1266;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy166;\n \t\t}\n \t}\n-yy1326:\n+yy1266:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'A') {\n \t\tif (yych == ')') goto yy139;\n@@ -18774,12 +17870,12 @@ yy1326:\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy1327;\n+\t\t\tif (yych <= 'a') goto yy1267;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1327:\n+yy1267:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'Y') {\n \t\tif (yych <= ')') {\n@@ -18788,7 +17884,7 @@ yy1327:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'X') goto yy144;\n-\t\t\tgoto yy1235;\n+\t\t\tgoto yy1175;\n \t\t}\n \t} else {\n \t\tif (yych <= 'x') {\n@@ -18796,12 +17892,12 @@ yy1327:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'y') goto yy1235;\n+\t\t\tif (yych <= 'y') goto yy1175;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1328:\n+yy1268:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -18817,16 +17913,16 @@ yy1328:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1329;\n+\t\t\tif (yych <= 't') goto yy1269;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1329:\n+yy1269:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= ')') {\n-\t\tif (yych == ' ') goto yy1330;\n+\t\tif (yych == ' ') goto yy1270;\n \t\tif (yych <= '(') goto yy3;\n \t\tgoto yy139;\n \t} else {\n@@ -18839,88 +17935,88 @@ yy1329:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1330:\n+yy1270:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'O') goto yy1331;\n+\tif (yych == 'O') goto yy1271;\n \tif (yych != 'o') goto yy56;\n-yy1331:\n+yy1271:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'F') goto yy1332;\n+\tif (yych == 'F') goto yy1272;\n \tif (yych != 'f') goto yy56;\n-yy1332:\n+yy1272:\n \tyych = *++YYCURSOR;\n \tif (yych != ' ') goto yy56;\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '1') goto yy1334;\n-\tif (yych <= '2') goto yy1335;\n-\tif (yych <= '9') goto yy1336;\n+\tif (yych <= '1') goto yy1274;\n+\tif (yych <= '2') goto yy1275;\n+\tif (yych <= '9') goto yy1276;\n \tgoto yy56;\n-yy1334:\n-\tyyaccept = 28;\n+yy1274:\n+\tyyaccept = 27;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') goto yy1337;\n-\tif (yych <= '9') goto yy1336;\n-\tgoto yy1337;\n-yy1335:\n-\tyyaccept = 28;\n+\tif (yych <= '\/') goto yy1277;\n+\tif (yych <= '9') goto yy1276;\n+\tgoto yy1277;\n+yy1275:\n+\tyyaccept = 27;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') goto yy1337;\n-\tif (yych >= '5') goto yy1337;\n-yy1336:\n-\tyyaccept = 28;\n+\tif (yych <= '\/') goto yy1277;\n+\tif (yych >= '5') goto yy1277;\n+yy1276:\n+\tyyaccept = 27;\n \tYYMARKER = ++YYCURSOR;\n \tif ((YYLIMIT - YYCURSOR) < 5) YYFILL(5);\n \tyych = *YYCURSOR;\n-yy1337:\n+yy1277:\n \tif (yych <= 'A') {\n \t\tif (yych <= 0x1F) {\n-\t\t\tif (yych == '\\t') goto yy1336;\n-\t\t\tgoto yy1294;\n+\t\t\tif (yych == '\\t') goto yy1276;\n+\t\t\tgoto yy1234;\n \t\t} else {\n-\t\t\tif (yych <= ' ') goto yy1336;\n-\t\t\tif (yych <= '@') goto yy1294;\n+\t\t\tif (yych <= ' ') goto yy1276;\n+\t\t\tif (yych <= '@') goto yy1234;\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych != 'P') goto yy1294;\n+\t\t\tif (yych != 'P') goto yy1234;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy1338;\n-\t\t\tif (yych != 'p') goto yy1294;\n+\t\t\tif (yych <= 'a') goto yy1278;\n+\t\t\tif (yych != 'p') goto yy1234;\n \t\t}\n \t}\n-yy1338:\n+yy1278:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'L') {\n \t\tif (yych != '.') goto yy56;\n \t} else {\n-\t\tif (yych <= 'M') goto yy1340;\n-\t\tif (yych == 'm') goto yy1340;\n+\t\tif (yych <= 'M') goto yy1280;\n+\t\tif (yych == 'm') goto yy1280;\n \t\tgoto yy56;\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'M') goto yy1340;\n+\tif (yych == 'M') goto yy1280;\n \tif (yych != 'm') goto yy56;\n-yy1340:\n+yy1280:\n \tyych = *++YYCURSOR;\n \tif (yych <= 0x1F) {\n-\t\tif (yych <= 0x00) goto yy1302;\n-\t\tif (yych == '\\t') goto yy1302;\n+\t\tif (yych <= 0x00) goto yy1242;\n+\t\tif (yych == '\\t') goto yy1242;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= ' ') goto yy1302;\n+\t\tif (yych <= ' ') goto yy1242;\n \t\tif (yych != '.') goto yy56;\n \t}\n \tyych = *++YYCURSOR;\n \tif (yych <= '\\t') {\n-\t\tif (yych <= 0x00) goto yy1302;\n+\t\tif (yych <= 0x00) goto yy1242;\n \t\tif (yych <= 0x08) goto yy56;\n-\t\tgoto yy1302;\n+\t\tgoto yy1242;\n \t} else {\n-\t\tif (yych == ' ') goto yy1302;\n+\t\tif (yych == ' ') goto yy1242;\n \t\tgoto yy56;\n \t}\n-yy1342:\n+yy1282:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'R') {\n \t\tif (yych <= ')') {\n@@ -18936,12 +18032,12 @@ yy1342:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy1343;\n+\t\t\tif (yych <= 'r') goto yy1283;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1343:\n+yy1283:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -18957,12 +18053,12 @@ yy1343:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1344;\n+\t\t\tif (yych <= 't') goto yy1284;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1344:\n+yy1284:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'H') {\n \t\tif (yych <= ')') {\n@@ -18971,7 +18067,7 @@ yy1344:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'G') goto yy144;\n-\t\t\tgoto yy1215;\n+\t\t\tgoto yy1155;\n \t\t}\n \t} else {\n \t\tif (yych <= 'g') {\n@@ -18979,12 +18075,12 @@ yy1344:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'h') goto yy1215;\n+\t\t\tif (yych <= 'h') goto yy1155;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1345:\n+yy1285:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'S') {\n \t\tif (yych <= ')') {\n@@ -18993,7 +18089,7 @@ yy1345:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'R') goto yy142;\n-\t\t\tgoto yy1348;\n+\t\t\tgoto yy1288;\n \t\t}\n \t} else {\n \t\tif (yych <= 'r') {\n@@ -19001,12 +18097,12 @@ yy1345:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy1348;\n+\t\t\tif (yych <= 's') goto yy1288;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1346:\n+yy1286:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -19022,12 +18118,12 @@ yy1346:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1347;\n+\t\t\tif (yych <= 't') goto yy1287;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1347:\n+yy1287:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'H') {\n \t\tif (yych <= ')') {\n@@ -19036,7 +18132,7 @@ yy1347:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'G') goto yy143;\n-\t\t\tgoto yy1238;\n+\t\t\tgoto yy1178;\n \t\t}\n \t} else {\n \t\tif (yych <= 'g') {\n@@ -19044,12 +18140,12 @@ yy1347:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'h') goto yy1238;\n+\t\t\tif (yych <= 'h') goto yy1178;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1348:\n+yy1288:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -19065,18 +18161,18 @@ yy1348:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1349;\n+\t\t\tif (yych <= 't') goto yy1289;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1349:\n+yy1289:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '(') {\n \t\tif (yych <= '\\t') {\n \t\t\tif (yych <= 0x08) goto yy3;\n-\t\t\tgoto yy1206;\n+\t\t\tgoto yy1146;\n \t\t} else {\n \t\t\tif (yych != ' ') goto yy3;\n \t\t}\n@@ -19091,37 +18187,37 @@ yy1349:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1350:\n+yy1290:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'D') goto yy1351;\n-\tif (yych != 'd') goto yy1207;\n-yy1351:\n+\tif (yych == 'D') goto yy1291;\n+\tif (yych != 'd') goto yy1147;\n+yy1291:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1352;\n+\tif (yych == 'A') goto yy1292;\n \tif (yych != 'a') goto yy56;\n-yy1352:\n+yy1292:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1353;\n+\tif (yych == 'Y') goto yy1293;\n \tif (yych != 'y') goto yy56;\n-yy1353:\n-\tyyaccept = 26;\n+yy1293:\n+\tyyaccept = 25;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'R') {\n-\t\tif (yych != ' ') goto yy1117;\n+\t\tif (yych != ' ') goto yy1057;\n \t} else {\n-\t\tif (yych <= 'S') goto yy1142;\n-\t\tif (yych == 's') goto yy1142;\n-\t\tgoto yy1117;\n+\t\tif (yych <= 'S') goto yy1082;\n+\t\tif (yych == 's') goto yy1082;\n+\t\tgoto yy1057;\n \t}\n \tyych = *++YYCURSOR;\n-\tif (yych == 'O') goto yy1355;\n+\tif (yych == 'O') goto yy1295;\n \tif (yych != 'o') goto yy56;\n-yy1355:\n+yy1295:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'F') goto yy1315;\n-\tif (yych == 'f') goto yy1315;\n+\tif (yych == 'F') goto yy1255;\n+\tif (yych == 'f') goto yy1255;\n \tgoto yy56;\n-yy1356:\n+yy1296:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n@@ -19156,13 +18252,13 @@ yy1356:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy1357;\n+\t\t\t\tif (yych <= 'r') goto yy1297;\n \t\t\t\tif (yych <= 'z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy1357:\n+yy1297:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n \t\tif (yych <= ')') {\n@@ -19178,12 +18274,12 @@ yy1357:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'u') goto yy1358;\n+\t\t\tif (yych <= 'u') goto yy1298;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1358:\n+yy1298:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'A') {\n \t\tif (yych == ')') goto yy139;\n@@ -19193,27 +18289,27 @@ yy1358:\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy1359;\n+\t\t\tif (yych <= 'a') goto yy1299;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1359:\n+yy1299:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'R') goto yy1360;\n+\t\tif (yych <= 'R') goto yy1300;\n \t\tif (yych != 'r') goto yy3;\n \t}\n-yy1360:\n+yy1300:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy205;\n-\tif (yych == 'y') goto yy205;\n+\tif (yych == 'Y') goto yy204;\n+\tif (yych == 'y') goto yy204;\n \tgoto yy56;\n-yy1361:\n+yy1301:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'A') {\n@@ -19228,7 +18324,7 @@ yy1361:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'B') goto yy1356;\n+\t\t\tif (yych <= 'B') goto yy1296;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19237,13 +18333,13 @@ yy1361:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'b') goto yy1379;\n+\t\t\t\tif (yych <= 'b') goto yy1319;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1362:\n+yy1302:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n@@ -19260,14 +18356,14 @@ yy1362:\n \t\t\t\tif (yych <= '\/') goto yy147;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'F') goto yy1346;\n+\t\t\t\tif (yych == 'F') goto yy1286;\n \t\t\t\tgoto yy141;\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= 'R') goto yy1345;\n+\t\t\t\tif (yych <= 'R') goto yy1285;\n \t\t\t\tgoto yy141;\n \t\t\t} else {\n \t\t\t\tif (yych == '_') goto yy147;\n@@ -19275,16 +18371,16 @@ yy1362:\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'q') {\n-\t\t\t\tif (yych == 'f') goto yy1375;\n+\t\t\t\tif (yych == 'f') goto yy1315;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy1374;\n+\t\t\t\tif (yych <= 'r') goto yy1314;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1363:\n+yy1303:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n@@ -19299,7 +18395,7 @@ yy1363:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'U') goto yy1342;\n+\t\t\tif (yych <= 'U') goto yy1282;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19308,13 +18404,13 @@ yy1363:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'u') goto yy1371;\n+\t\t\t\tif (yych <= 'u') goto yy1311;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1364:\n+yy1304:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'N') {\n@@ -19331,14 +18427,14 @@ yy1364:\n \t\t\t\tif (yych <= '\/') goto yy147;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'I') goto yy1325;\n+\t\t\t\tif (yych == 'I') goto yy1265;\n \t\t\t\tgoto yy141;\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= 'O') goto yy1324;\n+\t\t\t\tif (yych <= 'O') goto yy1264;\n \t\t\t\tgoto yy141;\n \t\t\t} else {\n \t\t\t\tif (yych == '_') goto yy147;\n@@ -19346,16 +18442,16 @@ yy1364:\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'n') {\n-\t\t\t\tif (yych == 'i') goto yy1366;\n+\t\t\t\tif (yych == 'i') goto yy1306;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'o') goto yy1365;\n+\t\t\t\tif (yych <= 'o') goto yy1305;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1365:\n+yy1305:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'M') {\n@@ -19370,7 +18466,7 @@ yy1365:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'N') goto yy1328;\n+\t\t\tif (yych <= 'N') goto yy1268;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19379,13 +18475,13 @@ yy1365:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'n') goto yy1369;\n+\t\t\t\tif (yych <= 'n') goto yy1309;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1366:\n+yy1306:\n \tyyaccept = 4;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'C') {\n@@ -19400,7 +18496,7 @@ yy1366:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'D') goto yy1326;\n+\t\t\tif (yych <= 'D') goto yy1266;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy166;\n \t\t\tgoto yy147;\n@@ -19409,13 +18505,13 @@ yy1366:\n \t\t\t\tif (yych <= '`') goto yy166;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'd') goto yy1367;\n+\t\t\t\tif (yych <= 'd') goto yy1307;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy166;\n \t\t\t}\n \t\t}\n \t}\n-yy1367:\n+yy1307:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n@@ -19429,18 +18525,18 @@ yy1367:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'A') goto yy1327;\n+\t\t\tif (yych <= 'A') goto yy1267;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n \t\t} else {\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tif (yych <= 'a') goto yy1368;\n+\t\t\tif (yych <= 'a') goto yy1308;\n \t\t\tif (yych <= 'z') goto yy151;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1368:\n+yy1308:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'X') {\n@@ -19455,7 +18551,7 @@ yy1368:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'Y') goto yy1235;\n+\t\t\tif (yych <= 'Y') goto yy1175;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19464,13 +18560,13 @@ yy1368:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'y') goto yy1264;\n+\t\t\t\tif (yych <= 'y') goto yy1204;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1369:\n+yy1309:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -19485,7 +18581,7 @@ yy1369:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1329;\n+\t\t\tif (yych <= 'T') goto yy1269;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19494,18 +18590,18 @@ yy1369:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1370;\n+\t\t\t\tif (yych <= 't') goto yy1310;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1370:\n+yy1310:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n \t\tif (yych <= '(') {\n-\t\t\tif (yych == ' ') goto yy1330;\n+\t\t\tif (yych == ' ') goto yy1270;\n \t\t\tgoto yy3;\n \t\t} else {\n \t\t\tif (yych <= ')') goto yy139;\n@@ -19525,7 +18621,7 @@ yy1370:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1371:\n+yy1311:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n@@ -19540,7 +18636,7 @@ yy1371:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'R') goto yy1343;\n+\t\t\tif (yych <= 'R') goto yy1283;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19549,13 +18645,13 @@ yy1371:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy1372;\n+\t\t\t\tif (yych <= 'r') goto yy1312;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1372:\n+yy1312:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -19570,7 +18666,7 @@ yy1372:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1344;\n+\t\t\tif (yych <= 'T') goto yy1284;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19579,13 +18675,13 @@ yy1372:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1373;\n+\t\t\t\tif (yych <= 't') goto yy1313;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1373:\n+yy1313:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n@@ -19600,7 +18696,7 @@ yy1373:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'H') goto yy1215;\n+\t\t\tif (yych <= 'H') goto yy1155;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19609,13 +18705,13 @@ yy1373:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'h') goto yy1227;\n+\t\t\t\tif (yych <= 'h') goto yy1167;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1374:\n+yy1314:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'R') {\n@@ -19630,7 +18726,7 @@ yy1374:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'S') goto yy1348;\n+\t\t\tif (yych <= 'S') goto yy1288;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19639,13 +18735,13 @@ yy1374:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 's') goto yy1377;\n+\t\t\t\tif (yych <= 's') goto yy1317;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1375:\n+yy1315:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -19660,7 +18756,7 @@ yy1375:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1347;\n+\t\t\tif (yych <= 'T') goto yy1287;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19669,13 +18765,13 @@ yy1375:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1376;\n+\t\t\t\tif (yych <= 't') goto yy1316;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1376:\n+yy1316:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n@@ -19690,7 +18786,7 @@ yy1376:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'H') goto yy1238;\n+\t\t\tif (yych <= 'H') goto yy1178;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19699,13 +18795,13 @@ yy1376:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'h') goto yy1267;\n+\t\t\t\tif (yych <= 'h') goto yy1207;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1377:\n+yy1317:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -19720,7 +18816,7 @@ yy1377:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1349;\n+\t\t\tif (yych <= 'T') goto yy1289;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19729,20 +18825,20 @@ yy1377:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1378;\n+\t\t\t\tif (yych <= 't') goto yy1318;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1378:\n+yy1318:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '-') {\n \t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy1206;\n+\t\t\tif (yych == '\\t') goto yy1146;\n \t\t\tif (yych <= 0x1F) goto yy3;\n-\t\t\tgoto yy1350;\n+\t\t\tgoto yy1290;\n \t\t} else {\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tif (yych <= ',') goto yy3;\n@@ -19764,7 +18860,7 @@ yy1378:\n \t\t\t}\n \t\t}\n \t}\n-yy1379:\n+yy1319:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n@@ -19780,7 +18876,7 @@ yy1379:\n \t\t\tif (yych <= '-') {\n \t\t\t\tif (yych <= ')') goto yy139;\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tgoto yy371;\n+\t\t\t\tgoto yy311;\n \t\t\t} else {\n \t\t\t\tif (yych == '\/') goto yy147;\n \t\t\t\tgoto yy195;\n@@ -19792,7 +18888,7 @@ yy1379:\n \t\t\t\tif (yych <= '@') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'R') goto yy1357;\n+\t\t\t\tif (yych <= 'R') goto yy1297;\n \t\t\t\tif (yych <= 'Z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n@@ -19802,13 +18898,13 @@ yy1379:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy1380;\n+\t\t\t\tif (yych <= 'r') goto yy1320;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy1380:\n+yy1320:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n@@ -19823,7 +18919,7 @@ yy1380:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'U') goto yy1358;\n+\t\t\tif (yych <= 'U') goto yy1298;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -19832,13 +18928,13 @@ yy1380:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'u') goto yy1381;\n+\t\t\t\tif (yych <= 'u') goto yy1321;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1381:\n+yy1321:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n@@ -19852,18 +18948,18 @@ yy1381:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'A') goto yy1359;\n+\t\t\tif (yych <= 'A') goto yy1299;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n \t\t} else {\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tif (yych <= 'a') goto yy1382;\n+\t\t\tif (yych <= 'a') goto yy1322;\n \t\t\tif (yych <= 'z') goto yy152;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1382:\n+yy1322:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n@@ -19877,31 +18973,31 @@ yy1382:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'R') goto yy1360;\n+\t\t\tif (yych <= 'R') goto yy1300;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'r') goto yy1383;\n+\t\t\tif (yych == 'r') goto yy1323;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1383:\n+yy1323:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy205;\n-\tif (yych == 'y') goto yy376;\n+\tif (yych == 'Y') goto yy204;\n+\tif (yych == 'y') goto yy316;\n \tgoto yy154;\n-yy1384:\n+yy1324:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n-yy1385:\n+yy1325:\n \t++YYCURSOR;\n \tif (YYLIMIT <= YYCURSOR) YYFILL(1);\n \tyych = *YYCURSOR;\n-\tif (yych <= '\/') goto yy1387;\n-\tif (yych <= '9') goto yy1385;\n-yy1387:\n+\tif (yych <= '\/') goto yy1327;\n+\tif (yych <= '9') goto yy1325;\n+yy1327:\n #line 1010 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\ttimelib_ull i;\n@@ -19927,8 +19023,8 @@ yy1387:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_RELATIVE;\n \t}\n-#line 19931 \"<stdout>\"\n-yy1388:\n+#line 19027 \"<stdout>\"\n+yy1328:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n \t\tif (yych <= ')') {\n@@ -19937,7 +19033,7 @@ yy1388:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'M') goto yy141;\n-\t\t\tgoto yy1429;\n+\t\t\tgoto yy1369;\n \t\t}\n \t} else {\n \t\tif (yych <= 'm') {\n@@ -19945,58 +19041,58 @@ yy1388:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'n') goto yy1429;\n+\t\t\tif (yych <= 'n') goto yy1369;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1389:\n+yy1329:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'U') {\n \t\tif (yych <= '@') {\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'I') goto yy1421;\n+\t\t\tif (yych == 'I') goto yy1361;\n \t\t\tif (yych <= 'T') goto yy141;\n-\t\t\tgoto yy1422;\n+\t\t\tgoto yy1362;\n \t\t}\n \t} else {\n \t\tif (yych <= 'i') {\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tif (yych <= 'h') goto yy141;\n-\t\t\tgoto yy1421;\n+\t\t\tgoto yy1361;\n \t\t} else {\n-\t\t\tif (yych == 'u') goto yy1422;\n+\t\t\tif (yych == 'u') goto yy1362;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1390:\n+yy1330:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'M') {\n \t\tif (yych <= '@') {\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'D') goto yy1410;\n+\t\t\tif (yych == 'D') goto yy1350;\n \t\t\tif (yych <= 'L') goto yy141;\n-\t\t\tgoto yy1411;\n+\t\t\tgoto yy1351;\n \t\t}\n \t} else {\n \t\tif (yych <= 'd') {\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tif (yych <= 'c') goto yy141;\n-\t\t\tgoto yy1410;\n+\t\t\tgoto yy1350;\n \t\t} else {\n-\t\t\tif (yych == 'm') goto yy1411;\n+\t\t\tif (yych == 'm') goto yy1351;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1391:\n+yy1331:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'E') {\n \t\tif (yych <= ')') {\n@@ -20005,7 +19101,7 @@ yy1391:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'D') goto yy141;\n-\t\t\tgoto yy1406;\n+\t\t\tgoto yy1346;\n \t\t}\n \t} else {\n \t\tif (yych <= 'd') {\n@@ -20013,12 +19109,12 @@ yy1391:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy1406;\n+\t\t\tif (yych <= 'e') goto yy1346;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1392:\n+yy1332:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'E') {\n \t\tif (yych <= ')') {\n@@ -20027,7 +19123,7 @@ yy1392:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'D') goto yy141;\n-\t\t\tgoto yy1402;\n+\t\t\tgoto yy1342;\n \t\t}\n \t} else {\n \t\tif (yych <= 'd') {\n@@ -20035,68 +19131,68 @@ yy1392:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy1402;\n+\t\t\tif (yych <= 'e') goto yy1342;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1393:\n+yy1333:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy1064;\n+\t\tif (yych == '.') goto yy1004;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= '9') goto yy1396;\n-\t\tif (yych <= ':') goto yy1064;\n+\t\tif (yych <= '9') goto yy1336;\n+\t\tif (yych <= ':') goto yy1004;\n \t\tgoto yy56;\n \t}\n-yy1394:\n+yy1334:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy1064;\n+\t\tif (yych == '.') goto yy1004;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= '4') goto yy1396;\n-\t\tif (yych == ':') goto yy1064;\n+\t\tif (yych <= '4') goto yy1336;\n+\t\tif (yych == ':') goto yy1004;\n \t\tgoto yy56;\n \t}\n-yy1395:\n+yy1335:\n \tyych = *++YYCURSOR;\n-\tif (yych == '.') goto yy1064;\n-\tif (yych == ':') goto yy1064;\n+\tif (yych == '.') goto yy1004;\n+\tif (yych == ':') goto yy1004;\n \tgoto yy56;\n-yy1396:\n+yy1336:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') {\n-\t\tif (yych == '.') goto yy1064;\n+\t\tif (yych == '.') goto yy1004;\n \t\tgoto yy56;\n \t} else {\n-\t\tif (yych <= '5') goto yy1397;\n-\t\tif (yych == ':') goto yy1064;\n+\t\tif (yych <= '5') goto yy1337;\n+\t\tif (yych == ':') goto yy1004;\n \t\tgoto yy56;\n \t}\n-yy1397:\n+yy1337:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n \tif (yych >= ':') goto yy56;\n-\tyyaccept = 24;\n+\tyyaccept = 23;\n \tyych = *(YYMARKER = ++YYCURSOR);\n-\tif (yych <= '\/') goto yy1067;\n-\tif (yych <= '5') goto yy1399;\n-\tif (yych <= '6') goto yy1400;\n-\tgoto yy1067;\n-yy1399:\n+\tif (yych <= '\/') goto yy1007;\n+\tif (yych <= '5') goto yy1339;\n+\tif (yych <= '6') goto yy1340;\n+\tgoto yy1007;\n+yy1339:\n \tyych = *++YYCURSOR;\n \tif (yych <= '\/') goto yy56;\n-\tif (yych <= '9') goto yy1401;\n+\tif (yych <= '9') goto yy1341;\n \tgoto yy56;\n-yy1400:\n+yy1340:\n \tyych = *++YYCURSOR;\n \tif (yych != '0') goto yy56;\n-yy1401:\n+yy1341:\n \tyych = *++YYCURSOR;\n-\tgoto yy1075;\n-yy1402:\n+\tgoto yy1015;\n+yy1342:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'L') {\n \t\tif (yych <= ')') {\n@@ -20112,12 +19208,12 @@ yy1402:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'l') goto yy1403;\n+\t\t\tif (yych <= 'l') goto yy1343;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1403:\n+yy1343:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'F') {\n \t\tif (yych <= ')') {\n@@ -20133,12 +19229,12 @@ yy1403:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'f') goto yy1404;\n+\t\t\tif (yych <= 'f') goto yy1344;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1404:\n+yy1344:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -20154,23 +19250,23 @@ yy1404:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1405;\n+\t\t\tif (yych <= 't') goto yy1345;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1405:\n+yy1345:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'H') goto yy1205;\n-\t\tif (yych == 'h') goto yy1205;\n+\t\tif (yych <= 'H') goto yy1145;\n+\t\tif (yych == 'h') goto yy1145;\n \t\tgoto yy3;\n \t}\n-yy1406:\n+yy1346:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'S') {\n \t\tif (yych <= ')') {\n@@ -20186,12 +19282,12 @@ yy1406:\n \t\t\tif (yych <= '`') goto yy166;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy1407;\n+\t\t\tif (yych <= 's') goto yy1347;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy166;\n \t\t}\n \t}\n-yy1407:\n+yy1347:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'D') {\n \t\tif (yych <= ')') {\n@@ -20207,12 +19303,12 @@ yy1407:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'd') goto yy1408;\n+\t\t\tif (yych <= 'd') goto yy1348;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1408:\n+yy1348:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'A') {\n \t\tif (yych == ')') goto yy139;\n@@ -20222,12 +19318,12 @@ yy1408:\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy1409;\n+\t\t\tif (yych <= 'a') goto yy1349;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1409:\n+yy1349:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'X') {\n \t\tif (yych == ')') goto yy139;\n@@ -20237,23 +19333,23 @@ yy1409:\n \t\tif (yych == 'y') goto yy172;\n \t\tgoto yy3;\n \t}\n-yy1410:\n+yy1350:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'A') {\n \t\tif (yych == ')') goto yy139;\n \t\tif (yych <= '@') goto yy3;\n-\t\tgoto yy1418;\n+\t\tgoto yy1358;\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy1418;\n+\t\t\tif (yych <= 'a') goto yy1358;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1411:\n+yy1351:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'O') {\n \t\tif (yych <= ')') {\n@@ -20269,12 +19365,12 @@ yy1411:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'o') goto yy1412;\n+\t\t\tif (yych <= 'o') goto yy1352;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1412:\n+yy1352:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'R') {\n \t\tif (yych <= ')') {\n@@ -20290,12 +19386,12 @@ yy1412:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy1413;\n+\t\t\tif (yych <= 'r') goto yy1353;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1413:\n+yy1353:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'R') {\n \t\tif (yych <= ')') {\n@@ -20311,28 +19407,28 @@ yy1413:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy1414;\n+\t\t\tif (yych <= 'r') goto yy1354;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1414:\n+yy1354:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'N') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'O') goto yy1415;\n+\t\tif (yych <= 'O') goto yy1355;\n \t\tif (yych != 'o') goto yy3;\n \t}\n-yy1415:\n+yy1355:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'W') goto yy1416;\n+\tif (yych == 'W') goto yy1356;\n \tif (yych != 'w') goto yy56;\n-yy1416:\n+yy1356:\n \t++YYCURSOR;\n-yy1417:\n+yy1357:\n #line 998 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tDEBUG_OUTPUT(\"tomorrow\");\n@@ -20344,8 +19440,8 @@ yy1417:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_RELATIVE;\n \t}\n-#line 20348 \"<stdout>\"\n-yy1418:\n+#line 19444 \"<stdout>\"\n+yy1358:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'Y') {\n \t\tif (yych <= ')') {\n@@ -20361,21 +19457,21 @@ yy1418:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'y') goto yy1419;\n+\t\t\tif (yych <= 'y') goto yy1359;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1419:\n+yy1359:\n \t++YYCURSOR;\n \tif ((yych = *YYCURSOR) <= '@') {\n \t\tif (yych == ')') goto yy139;\n \t} else {\n \t\tif (yych <= 'Z') goto yy144;\n-\t\tif (yych <= '`') goto yy1420;\n+\t\tif (yych <= '`') goto yy1360;\n \t\tif (yych <= 'z') goto yy144;\n \t}\n-yy1420:\n+yy1360:\n #line 988 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tDEBUG_OUTPUT(\"midnight | today\");\n@@ -20385,8 +19481,8 @@ yy1420:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_RELATIVE;\n \t}\n-#line 20389 \"<stdout>\"\n-yy1421:\n+#line 19485 \"<stdout>\"\n+yy1361:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'S') {\n \t\tif (yych <= '@') {\n@@ -20394,8 +19490,8 @@ yy1421:\n \t\t\tgoto yy3;\n \t\t} else {\n \t\t\tif (yych <= 'Q') goto yy142;\n-\t\t\tif (yych <= 'R') goto yy1427;\n-\t\t\tgoto yy1428;\n+\t\t\tif (yych <= 'R') goto yy1367;\n+\t\t\tgoto yy1368;\n \t\t}\n \t} else {\n \t\tif (yych <= 'q') {\n@@ -20403,13 +19499,13 @@ yy1421:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy1427;\n-\t\t\tif (yych <= 's') goto yy1428;\n+\t\t\tif (yych <= 'r') goto yy1367;\n+\t\t\tif (yych <= 's') goto yy1368;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1422:\n+yy1362:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'R') {\n \t\tif (yych <= ')') {\n@@ -20425,12 +19521,12 @@ yy1422:\n \t\t\tif (yych <= '`') goto yy166;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy1423;\n+\t\t\tif (yych <= 'r') goto yy1363;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy166;\n \t\t}\n \t}\n-yy1423:\n+yy1363:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'S') {\n \t\tif (yych <= ')') {\n@@ -20446,12 +19542,12 @@ yy1423:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy1424;\n+\t\t\tif (yych <= 's') goto yy1364;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1424:\n+yy1364:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'D') {\n \t\tif (yych <= ')') {\n@@ -20467,27 +19563,27 @@ yy1424:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'd') goto yy1425;\n+\t\t\tif (yych <= 'd') goto yy1365;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1425:\n+yy1365:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'A') goto yy1426;\n+\t\tif (yych <= 'A') goto yy1366;\n \t\tif (yych != 'a') goto yy3;\n \t}\n-yy1426:\n+yy1366:\n \tyych = *++YYCURSOR;\n \tif (yych == 'Y') goto yy172;\n \tif (yych == 'y') goto yy172;\n \tgoto yy56;\n-yy1427:\n+yy1367:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'D') {\n \t\tif (yych <= ')') {\n@@ -20496,7 +19592,7 @@ yy1427:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'C') goto yy143;\n-\t\t\tgoto yy1238;\n+\t\t\tgoto yy1178;\n \t\t}\n \t} else {\n \t\tif (yych <= 'c') {\n@@ -20504,20 +19600,20 @@ yy1427:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'd') goto yy1238;\n+\t\t\tif (yych <= 'd') goto yy1178;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1428:\n+yy1368:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '(') {\n \t\tif (yych <= '\\t') {\n \t\t\tif (yych <= 0x08) goto yy3;\n-\t\t\tgoto yy1104;\n+\t\t\tgoto yy1044;\n \t\t} else {\n-\t\t\tif (yych == ' ') goto yy1104;\n+\t\t\tif (yych == ' ') goto yy1044;\n \t\t\tgoto yy3;\n \t\t}\n \t} else {\n@@ -20531,7 +19627,7 @@ yy1428:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1429:\n+yy1369:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -20547,12 +19643,12 @@ yy1429:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1430;\n+\t\t\tif (yych <= 't') goto yy1370;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1430:\n+yy1370:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'H') {\n \t\tif (yych <= ')') {\n@@ -20561,7 +19657,7 @@ yy1430:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'G') goto yy143;\n-\t\t\tgoto yy1238;\n+\t\t\tgoto yy1178;\n \t\t}\n \t} else {\n \t\tif (yych <= 'g') {\n@@ -20569,12 +19665,12 @@ yy1430:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'h') goto yy1238;\n+\t\t\tif (yych <= 'h') goto yy1178;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1431:\n+yy1371:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'M') {\n@@ -20589,7 +19685,7 @@ yy1431:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'N') goto yy1429;\n+\t\t\tif (yych <= 'N') goto yy1369;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -20598,13 +19694,13 @@ yy1431:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'n') goto yy1461;\n+\t\t\t\tif (yych <= 'n') goto yy1401;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1432:\n+yy1372:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'T') {\n@@ -20621,14 +19717,14 @@ yy1432:\n \t\t\t\tif (yych <= '\/') goto yy147;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'I') goto yy1421;\n+\t\t\t\tif (yych == 'I') goto yy1361;\n \t\t\t\tgoto yy141;\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= 'U') goto yy1422;\n+\t\t\t\tif (yych <= 'U') goto yy1362;\n \t\t\t\tgoto yy141;\n \t\t\t} else {\n \t\t\t\tif (yych == '_') goto yy147;\n@@ -20636,16 +19732,16 @@ yy1432:\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 't') {\n-\t\t\t\tif (yych == 'i') goto yy1453;\n+\t\t\t\tif (yych == 'i') goto yy1393;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'u') goto yy1454;\n+\t\t\t\tif (yych <= 'u') goto yy1394;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1433:\n+yy1373:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'L') {\n@@ -20662,14 +19758,14 @@ yy1433:\n \t\t\t\tif (yych <= '\/') goto yy147;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'D') goto yy1410;\n+\t\t\t\tif (yych == 'D') goto yy1350;\n \t\t\t\tgoto yy141;\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= 'M') goto yy1411;\n+\t\t\t\tif (yych <= 'M') goto yy1351;\n \t\t\t\tgoto yy141;\n \t\t\t} else {\n \t\t\t\tif (yych == '_') goto yy147;\n@@ -20677,16 +19773,16 @@ yy1433:\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'l') {\n-\t\t\t\tif (yych == 'd') goto yy1444;\n+\t\t\t\tif (yych == 'd') goto yy1384;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'm') goto yy1445;\n+\t\t\t\tif (yych <= 'm') goto yy1385;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1434:\n+yy1374:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n@@ -20701,7 +19797,7 @@ yy1434:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'E') goto yy1406;\n+\t\t\tif (yych <= 'E') goto yy1346;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -20710,13 +19806,13 @@ yy1434:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1440;\n+\t\t\t\tif (yych <= 'e') goto yy1380;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1435:\n+yy1375:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n@@ -20731,7 +19827,7 @@ yy1435:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'E') goto yy1402;\n+\t\t\tif (yych <= 'E') goto yy1342;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -20740,13 +19836,13 @@ yy1435:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1436;\n+\t\t\t\tif (yych <= 'e') goto yy1376;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1436:\n+yy1376:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'K') {\n@@ -20761,7 +19857,7 @@ yy1436:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'L') goto yy1403;\n+\t\t\tif (yych <= 'L') goto yy1343;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -20770,13 +19866,13 @@ yy1436:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'l') goto yy1437;\n+\t\t\t\tif (yych <= 'l') goto yy1377;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1437:\n+yy1377:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'E') {\n@@ -20791,7 +19887,7 @@ yy1437:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'F') goto yy1404;\n+\t\t\tif (yych <= 'F') goto yy1344;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -20800,13 +19896,13 @@ yy1437:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'f') goto yy1438;\n+\t\t\t\tif (yych <= 'f') goto yy1378;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1438:\n+yy1378:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -20821,7 +19917,7 @@ yy1438:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1405;\n+\t\t\tif (yych <= 'T') goto yy1345;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -20830,13 +19926,13 @@ yy1438:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1439;\n+\t\t\t\tif (yych <= 't') goto yy1379;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1439:\n+yy1379:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n@@ -20850,16 +19946,16 @@ yy1439:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'H') goto yy1205;\n+\t\t\tif (yych <= 'H') goto yy1145;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'h') goto yy1223;\n+\t\t\tif (yych == 'h') goto yy1163;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1440:\n+yy1380:\n \tyyaccept = 4;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'R') {\n@@ -20874,7 +19970,7 @@ yy1440:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'S') goto yy1407;\n+\t\t\tif (yych <= 'S') goto yy1347;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy166;\n \t\t\tgoto yy147;\n@@ -20883,13 +19979,13 @@ yy1440:\n \t\t\t\tif (yych <= '`') goto yy166;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 's') goto yy1441;\n+\t\t\t\tif (yych <= 's') goto yy1381;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy166;\n \t\t\t}\n \t\t}\n \t}\n-yy1441:\n+yy1381:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'C') {\n@@ -20904,7 +20000,7 @@ yy1441:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'D') goto yy1408;\n+\t\t\tif (yych <= 'D') goto yy1348;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -20913,13 +20009,13 @@ yy1441:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'd') goto yy1442;\n+\t\t\t\tif (yych <= 'd') goto yy1382;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1442:\n+yy1382:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n@@ -20933,18 +20029,18 @@ yy1442:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'A') goto yy1409;\n+\t\t\tif (yych <= 'A') goto yy1349;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n \t\t} else {\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tif (yych <= 'a') goto yy1443;\n+\t\t\tif (yych <= 'a') goto yy1383;\n \t\t\tif (yych <= 'z') goto yy152;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1443:\n+yy1383:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'X') {\n@@ -20967,7 +20063,7 @@ yy1443:\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1444:\n+yy1384:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n@@ -20981,18 +20077,18 @@ yy1444:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'A') goto yy1418;\n+\t\t\tif (yych <= 'A') goto yy1358;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n \t\t} else {\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tif (yych <= 'a') goto yy1451;\n+\t\t\tif (yych <= 'a') goto yy1391;\n \t\t\tif (yych <= 'z') goto yy150;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1445:\n+yy1385:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'N') {\n@@ -21007,7 +20103,7 @@ yy1445:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'O') goto yy1412;\n+\t\t\tif (yych <= 'O') goto yy1352;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21016,13 +20112,13 @@ yy1445:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'o') goto yy1446;\n+\t\t\t\tif (yych <= 'o') goto yy1386;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1446:\n+yy1386:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n@@ -21037,7 +20133,7 @@ yy1446:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'R') goto yy1413;\n+\t\t\tif (yych <= 'R') goto yy1353;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21046,13 +20142,13 @@ yy1446:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy1447;\n+\t\t\t\tif (yych <= 'r') goto yy1387;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1447:\n+yy1387:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n@@ -21067,7 +20163,7 @@ yy1447:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'R') goto yy1414;\n+\t\t\tif (yych <= 'R') goto yy1354;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21076,13 +20172,13 @@ yy1447:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy1448;\n+\t\t\t\tif (yych <= 'r') goto yy1388;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1448:\n+yy1388:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'N') {\n@@ -21096,33 +20192,33 @@ yy1448:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'O') goto yy1415;\n+\t\t\tif (yych <= 'O') goto yy1355;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'o') goto yy1449;\n+\t\t\tif (yych == 'o') goto yy1389;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1449:\n+yy1389:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'W') goto yy1416;\n+\tif (yych == 'W') goto yy1356;\n \tif (yych != 'w') goto yy154;\n-\tyyaccept = 29;\n+\tyyaccept = 28;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yybm[0+yych] & 16) {\n \t\tgoto yy153;\n \t}\n \tif (yych <= '.') {\n \t\tif (yych == '-') goto yy147;\n-\t\tgoto yy1417;\n+\t\tgoto yy1357;\n \t} else {\n \t\tif (yych <= '\/') goto yy147;\n \t\tif (yych == '_') goto yy147;\n-\t\tgoto yy1417;\n+\t\tgoto yy1357;\n \t}\n-yy1451:\n+yy1391:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'X') {\n@@ -21137,7 +20233,7 @@ yy1451:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'Y') goto yy1419;\n+\t\t\tif (yych <= 'Y') goto yy1359;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21146,36 +20242,36 @@ yy1451:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'y') goto yy1452;\n+\t\t\t\tif (yych <= 'y') goto yy1392;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1452:\n-\tyyaccept = 30;\n+yy1392:\n+\tyyaccept = 29;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n \t\tif (yych <= ',') {\n \t\t\tif (yych == ')') goto yy139;\n-\t\t\tgoto yy1420;\n+\t\t\tgoto yy1360;\n \t\t} else {\n-\t\t\tif (yych == '.') goto yy1420;\n+\t\t\tif (yych == '.') goto yy1360;\n \t\t\tgoto yy147;\n \t\t}\n \t} else {\n \t\tif (yych <= '^') {\n-\t\t\tif (yych <= '@') goto yy1420;\n+\t\t\tif (yych <= '@') goto yy1360;\n \t\t\tif (yych <= 'Z') goto yy144;\n-\t\t\tgoto yy1420;\n+\t\t\tgoto yy1360;\n \t\t} else {\n \t\t\tif (yych <= '_') goto yy147;\n-\t\t\tif (yych <= '`') goto yy1420;\n+\t\t\tif (yych <= '`') goto yy1360;\n \t\t\tif (yych <= 'z') goto yy152;\n-\t\t\tgoto yy1420;\n+\t\t\tgoto yy1360;\n \t\t}\n \t}\n-yy1453:\n+yy1393:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'R') {\n@@ -21190,13 +20286,13 @@ yy1453:\n \t\t\t} else {\n \t\t\t\tif (yych <= '@') goto yy3;\n \t\t\t\tif (yych <= 'Q') goto yy142;\n-\t\t\t\tgoto yy1427;\n+\t\t\t\tgoto yy1367;\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= 'S') goto yy1428;\n+\t\t\t\tif (yych <= 'S') goto yy1368;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n \t\t\t\tif (yych == '_') goto yy147;\n@@ -21205,15 +20301,15 @@ yy1453:\n \t\t} else {\n \t\t\tif (yych <= 'r') {\n \t\t\t\tif (yych <= 'q') goto yy150;\n-\t\t\t\tgoto yy1459;\n+\t\t\t\tgoto yy1399;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 's') goto yy1460;\n+\t\t\t\tif (yych <= 's') goto yy1400;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1454:\n+yy1394:\n \tyyaccept = 4;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n@@ -21228,7 +20324,7 @@ yy1454:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'R') goto yy1423;\n+\t\t\tif (yych <= 'R') goto yy1363;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy166;\n \t\t\tgoto yy147;\n@@ -21237,13 +20333,13 @@ yy1454:\n \t\t\t\tif (yych <= '`') goto yy166;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy1455;\n+\t\t\t\tif (yych <= 'r') goto yy1395;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy166;\n \t\t\t}\n \t\t}\n \t}\n-yy1455:\n+yy1395:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'R') {\n@@ -21258,7 +20354,7 @@ yy1455:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'S') goto yy1424;\n+\t\t\tif (yych <= 'S') goto yy1364;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21267,13 +20363,13 @@ yy1455:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 's') goto yy1456;\n+\t\t\t\tif (yych <= 's') goto yy1396;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1456:\n+yy1396:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'C') {\n@@ -21288,7 +20384,7 @@ yy1456:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'D') goto yy1425;\n+\t\t\tif (yych <= 'D') goto yy1365;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21297,13 +20393,13 @@ yy1456:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'd') goto yy1457;\n+\t\t\t\tif (yych <= 'd') goto yy1397;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1457:\n+yy1397:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n@@ -21317,22 +20413,22 @@ yy1457:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'A') goto yy1426;\n+\t\t\tif (yych <= 'A') goto yy1366;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n \t\t} else {\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tif (yych <= 'a') goto yy1458;\n+\t\t\tif (yych <= 'a') goto yy1398;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1458:\n+yy1398:\n \tyych = *++YYCURSOR;\n \tif (yych == 'Y') goto yy172;\n \tif (yych == 'y') goto yy185;\n \tgoto yy154;\n-yy1459:\n+yy1399:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'C') {\n@@ -21347,7 +20443,7 @@ yy1459:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'D') goto yy1238;\n+\t\t\tif (yych <= 'D') goto yy1178;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21356,20 +20452,20 @@ yy1459:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'd') goto yy1267;\n+\t\t\t\tif (yych <= 'd') goto yy1207;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1460:\n+yy1400:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '-') {\n \t\tif (yych <= ' ') {\n-\t\t\tif (yych == '\\t') goto yy1104;\n+\t\t\tif (yych == '\\t') goto yy1044;\n \t\t\tif (yych <= 0x1F) goto yy3;\n-\t\t\tgoto yy1104;\n+\t\t\tgoto yy1044;\n \t\t} else {\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tif (yych <= ',') goto yy3;\n@@ -21391,7 +20487,7 @@ yy1460:\n \t\t\t}\n \t\t}\n \t}\n-yy1461:\n+yy1401:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -21406,7 +20502,7 @@ yy1461:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1430;\n+\t\t\tif (yych <= 'T') goto yy1370;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21415,13 +20511,13 @@ yy1461:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1462;\n+\t\t\t\tif (yych <= 't') goto yy1402;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1462:\n+yy1402:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n@@ -21436,7 +20532,7 @@ yy1462:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'H') goto yy1238;\n+\t\t\tif (yych <= 'H') goto yy1178;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21445,36 +20541,36 @@ yy1462:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'h') goto yy1267;\n+\t\t\t\tif (yych <= 'h') goto yy1207;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1463:\n+yy1403:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'Y') {\n \t\tif (yych <= '@') {\n \t\t\tif (yych == ')') goto yy139;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'R') goto yy1475;\n+\t\t\tif (yych == 'R') goto yy1415;\n \t\t\tif (yych <= 'X') goto yy141;\n-\t\t\tgoto yy1476;\n+\t\t\tgoto yy1416;\n \t\t}\n \t} else {\n \t\tif (yych <= 'r') {\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tif (yych <= 'q') goto yy141;\n-\t\t\tgoto yy1475;\n+\t\t\tgoto yy1415;\n \t\t} else {\n-\t\t\tif (yych == 'y') goto yy1476;\n+\t\t\tif (yych == 'y') goto yy1416;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1464:\n+yy1404:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'D') {\n \t\tif (yych <= ')') {\n@@ -21483,7 +20579,7 @@ yy1464:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'C') goto yy141;\n-\t\t\tgoto yy1469;\n+\t\t\tgoto yy1409;\n \t\t}\n \t} else {\n \t\tif (yych <= 'c') {\n@@ -21491,12 +20587,12 @@ yy1464:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'd') goto yy1469;\n+\t\t\tif (yych <= 'd') goto yy1409;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1465:\n+yy1405:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n \t\tif (yych <= ')') {\n@@ -21512,12 +20608,12 @@ yy1465:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'n') goto yy1466;\n+\t\t\tif (yych <= 'n') goto yy1406;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1466:\n+yy1406:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'D') {\n \t\tif (yych <= ')') {\n@@ -21533,12 +20629,12 @@ yy1466:\n \t\t\tif (yych <= '`') goto yy166;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'd') goto yy1467;\n+\t\t\tif (yych <= 'd') goto yy1407;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy166;\n \t\t}\n \t}\n-yy1467:\n+yy1407:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'A') {\n \t\tif (yych == ')') goto yy139;\n@@ -21548,12 +20644,12 @@ yy1467:\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych <= 'a') goto yy1468;\n+\t\t\tif (yych <= 'a') goto yy1408;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1468:\n+yy1408:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'Y') {\n \t\tif (yych <= ')') {\n@@ -21562,7 +20658,7 @@ yy1468:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'X') goto yy144;\n-\t\t\tgoto yy1235;\n+\t\t\tgoto yy1175;\n \t\t}\n \t} else {\n \t\tif (yych <= 'x') {\n@@ -21570,12 +20666,12 @@ yy1468:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'y') goto yy1235;\n+\t\t\tif (yych <= 'y') goto yy1175;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1469:\n+yy1409:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n \t\tif (yych <= ')') {\n@@ -21591,12 +20687,12 @@ yy1469:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'n') goto yy1470;\n+\t\t\tif (yych <= 'n') goto yy1410;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1470:\n+yy1410:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'I') {\n \t\tif (yych <= ')') {\n@@ -21612,12 +20708,12 @@ yy1470:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'i') goto yy1471;\n+\t\t\tif (yych <= 'i') goto yy1411;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1471:\n+yy1411:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'G') {\n \t\tif (yych <= ')') {\n@@ -21633,29 +20729,29 @@ yy1471:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'g') goto yy1472;\n+\t\t\tif (yych <= 'g') goto yy1412;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1472:\n+yy1412:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'H') goto yy1473;\n+\t\tif (yych <= 'H') goto yy1413;\n \t\tif (yych != 'h') goto yy3;\n \t}\n-yy1473:\n+yy1413:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy1474;\n+\tif (yych == 'T') goto yy1414;\n \tif (yych != 't') goto yy56;\n-yy1474:\n+yy1414:\n \tyych = *++YYCURSOR;\n-\tgoto yy1420;\n-yy1475:\n+\tgoto yy1360;\n+yy1415:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n@@ -21683,7 +20779,7 @@ yy1475:\n \t\t\t\tif (yych <= '9') goto yy195;\n \t\t\t\tgoto yy193;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'C') goto yy1477;\n+\t\t\t\tif (yych == 'C') goto yy1417;\n \t\t\t\tgoto yy142;\n \t\t\t}\n \t\t} else {\n@@ -21691,13 +20787,13 @@ yy1475:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'c') goto yy1477;\n+\t\t\t\tif (yych <= 'c') goto yy1417;\n \t\t\t\tif (yych <= 'z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy1476:\n+yy1416:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '-') {\n@@ -21722,7 +20818,7 @@ yy1476:\n \t\t\tgoto yy193;\n \t\t}\n \t}\n-yy1477:\n+yy1417:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'H') {\n \t\tif (yych <= ')') {\n@@ -21731,7 +20827,7 @@ yy1477:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'G') goto yy143;\n-\t\t\tgoto yy395;\n+\t\t\tgoto yy335;\n \t\t}\n \t} else {\n \t\tif (yych <= 'g') {\n@@ -21739,12 +20835,12 @@ yy1477:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'h') goto yy395;\n+\t\t\tif (yych <= 'h') goto yy335;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1478:\n+yy1418:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'X') {\n@@ -21761,14 +20857,14 @@ yy1478:\n \t\t\t\tif (yych <= '\/') goto yy147;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n-\t\t\t\tif (yych == 'R') goto yy1475;\n+\t\t\t\tif (yych == 'R') goto yy1415;\n \t\t\t\tgoto yy141;\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n \t\t\tif (yych <= 'Z') {\n-\t\t\t\tif (yych <= 'Y') goto yy1476;\n+\t\t\t\tif (yych <= 'Y') goto yy1416;\n \t\t\t\tgoto yy141;\n \t\t\t} else {\n \t\t\t\tif (yych == '_') goto yy147;\n@@ -21776,16 +20872,16 @@ yy1478:\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'x') {\n-\t\t\t\tif (yych == 'r') goto yy1490;\n+\t\t\t\tif (yych == 'r') goto yy1430;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'y') goto yy1491;\n+\t\t\t\tif (yych <= 'y') goto yy1431;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1479:\n+yy1419:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'C') {\n@@ -21800,7 +20896,7 @@ yy1479:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'D') goto yy1469;\n+\t\t\tif (yych <= 'D') goto yy1409;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21809,13 +20905,13 @@ yy1479:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'd') goto yy1484;\n+\t\t\t\tif (yych <= 'd') goto yy1424;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1480:\n+yy1420:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'M') {\n@@ -21830,7 +20926,7 @@ yy1480:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'N') goto yy1466;\n+\t\t\tif (yych <= 'N') goto yy1406;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21839,13 +20935,13 @@ yy1480:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'n') goto yy1481;\n+\t\t\t\tif (yych <= 'n') goto yy1421;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1481:\n+yy1421:\n \tyyaccept = 4;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'C') {\n@@ -21860,7 +20956,7 @@ yy1481:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'D') goto yy1467;\n+\t\t\tif (yych <= 'D') goto yy1407;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy166;\n \t\t\tgoto yy147;\n@@ -21869,13 +20965,13 @@ yy1481:\n \t\t\t\tif (yych <= '`') goto yy166;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'd') goto yy1482;\n+\t\t\t\tif (yych <= 'd') goto yy1422;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy166;\n \t\t\t}\n \t\t}\n \t}\n-yy1482:\n+yy1422:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '@') {\n@@ -21889,18 +20985,18 @@ yy1482:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'A') goto yy1468;\n+\t\t\tif (yych <= 'A') goto yy1408;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n \t\t} else {\n \t\t\tif (yych <= '`') goto yy3;\n-\t\t\tif (yych <= 'a') goto yy1483;\n+\t\t\tif (yych <= 'a') goto yy1423;\n \t\t\tif (yych <= 'z') goto yy151;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1483:\n+yy1423:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'X') {\n@@ -21915,7 +21011,7 @@ yy1483:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'Y') goto yy1235;\n+\t\t\tif (yych <= 'Y') goto yy1175;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21924,13 +21020,13 @@ yy1483:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'y') goto yy1264;\n+\t\t\t\tif (yych <= 'y') goto yy1204;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1484:\n+yy1424:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'M') {\n@@ -21945,7 +21041,7 @@ yy1484:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'N') goto yy1470;\n+\t\t\tif (yych <= 'N') goto yy1410;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21954,13 +21050,13 @@ yy1484:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'n') goto yy1485;\n+\t\t\t\tif (yych <= 'n') goto yy1425;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1485:\n+yy1425:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'H') {\n@@ -21975,7 +21071,7 @@ yy1485:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'I') goto yy1471;\n+\t\t\tif (yych <= 'I') goto yy1411;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -21984,13 +21080,13 @@ yy1485:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'i') goto yy1486;\n+\t\t\t\tif (yych <= 'i') goto yy1426;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1486:\n+yy1426:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'F') {\n@@ -22005,7 +21101,7 @@ yy1486:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'G') goto yy1472;\n+\t\t\tif (yych <= 'G') goto yy1412;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -22014,13 +21110,13 @@ yy1486:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'g') goto yy1487;\n+\t\t\t\tif (yych <= 'g') goto yy1427;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1487:\n+yy1427:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n@@ -22034,33 +21130,33 @@ yy1487:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'H') goto yy1473;\n+\t\t\tif (yych <= 'H') goto yy1413;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'h') goto yy1488;\n+\t\t\tif (yych == 'h') goto yy1428;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1488:\n+yy1428:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'T') goto yy1474;\n+\tif (yych == 'T') goto yy1414;\n \tif (yych != 't') goto yy154;\n-\tyyaccept = 30;\n+\tyyaccept = 29;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yybm[0+yych] & 16) {\n \t\tgoto yy153;\n \t}\n \tif (yych <= '.') {\n \t\tif (yych == '-') goto yy147;\n-\t\tgoto yy1420;\n+\t\tgoto yy1360;\n \t} else {\n \t\tif (yych <= '\/') goto yy147;\n \t\tif (yych == '_') goto yy147;\n-\t\tgoto yy1420;\n+\t\tgoto yy1360;\n \t}\n-yy1490:\n+yy1430:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n@@ -22076,7 +21172,7 @@ yy1490:\n \t\t\tif (yych <= '-') {\n \t\t\t\tif (yych <= ')') goto yy139;\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tgoto yy371;\n+\t\t\t\tgoto yy311;\n \t\t\t} else {\n \t\t\t\tif (yych == '\/') goto yy147;\n \t\t\t\tgoto yy195;\n@@ -22088,7 +21184,7 @@ yy1490:\n \t\t\t\tif (yych <= '@') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'C') goto yy1477;\n+\t\t\t\tif (yych <= 'C') goto yy1417;\n \t\t\t\tif (yych <= 'Z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n@@ -22098,13 +21194,13 @@ yy1490:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'c') goto yy1492;\n+\t\t\t\tif (yych <= 'c') goto yy1432;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy1491:\n+yy1431:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '.') {\n@@ -22118,7 +21214,7 @@ yy1491:\n \t\t\t\tgoto yy139;\n \t\t\t} else {\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tif (yych <= '-') goto yy371;\n+\t\t\t\tif (yych <= '-') goto yy311;\n \t\t\t\tgoto yy195;\n \t\t\t}\n \t\t}\n@@ -22139,7 +21235,7 @@ yy1491:\n \t\t\t}\n \t\t}\n \t}\n-yy1492:\n+yy1432:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n@@ -22154,7 +21250,7 @@ yy1492:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'H') goto yy395;\n+\t\t\tif (yych <= 'H') goto yy335;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -22163,13 +21259,13 @@ yy1492:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'h') goto yy406;\n+\t\t\t\tif (yych <= 'h') goto yy346;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1493:\n+yy1433:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'W') {\n \t\tif (yych <= 'N') {\n@@ -22177,29 +21273,29 @@ yy1493:\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'O') goto yy1501;\n+\t\t\tif (yych <= 'O') goto yy1441;\n \t\t\tif (yych <= 'U') goto yy141;\n-\t\t\tif (yych <= 'V') goto yy1502;\n-\t\t\tgoto yy1499;\n+\t\t\tif (yych <= 'V') goto yy1442;\n+\t\t\tgoto yy1439;\n \t\t}\n \t} else {\n \t\tif (yych <= 'o') {\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tif (yych <= 'n') goto yy141;\n-\t\t\tgoto yy1501;\n+\t\t\tgoto yy1441;\n \t\t} else {\n \t\t\tif (yych <= 'v') {\n \t\t\t\tif (yych <= 'u') goto yy141;\n-\t\t\t\tgoto yy1502;\n+\t\t\t\tgoto yy1442;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'w') goto yy1499;\n+\t\t\t\tif (yych <= 'w') goto yy1439;\n \t\t\t\tif (yych <= 'z') goto yy141;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1494:\n+yy1434:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'X') {\n \t\tif (yych <= ')') {\n@@ -22208,7 +21304,7 @@ yy1494:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'W') goto yy141;\n-\t\t\tgoto yy1498;\n+\t\t\tgoto yy1438;\n \t\t}\n \t} else {\n \t\tif (yych <= 'w') {\n@@ -22216,12 +21312,12 @@ yy1494:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'x') goto yy1498;\n+\t\t\tif (yych <= 'x') goto yy1438;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1495:\n+yy1435:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n \t\tif (yych <= ')') {\n@@ -22237,12 +21333,12 @@ yy1495:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 'n') goto yy1496;\n+\t\t\tif (yych <= 'n') goto yy1436;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1496:\n+yy1436:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -22258,12 +21354,12 @@ yy1496:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1497;\n+\t\t\tif (yych <= 't') goto yy1437;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1497:\n+yy1437:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'H') {\n \t\tif (yych <= ')') {\n@@ -22272,7 +21368,7 @@ yy1497:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'G') goto yy143;\n-\t\t\tgoto yy1238;\n+\t\t\tgoto yy1178;\n \t\t}\n \t} else {\n \t\tif (yych <= 'g') {\n@@ -22280,12 +21376,12 @@ yy1497:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'h') goto yy1238;\n+\t\t\tif (yych <= 'h') goto yy1178;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1498:\n+yy1438:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -22294,7 +21390,7 @@ yy1498:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'S') goto yy142;\n-\t\t\tgoto yy1428;\n+\t\t\tgoto yy1368;\n \t\t}\n \t} else {\n \t\tif (yych <= 's') {\n@@ -22302,21 +21398,21 @@ yy1498:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1428;\n+\t\t\tif (yych <= 't') goto yy1368;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1499:\n+yy1439:\n \t++YYCURSOR;\n \tif ((yych = *YYCURSOR) <= '@') {\n \t\tif (yych == ')') goto yy139;\n \t} else {\n \t\tif (yych <= 'Z') goto yy142;\n-\t\tif (yych <= '`') goto yy1500;\n+\t\tif (yych <= '`') goto yy1440;\n \t\tif (yych <= 'z') goto yy142;\n \t}\n-yy1500:\n+yy1440:\n #line 967 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tDEBUG_OUTPUT(\"now\");\n@@ -22325,8 +21421,8 @@ yy1500:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_RELATIVE;\n \t}\n-#line 22329 \"<stdout>\"\n-yy1501:\n+#line 21425 \"<stdout>\"\n+yy1441:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'N') {\n \t\tif (yych <= ')') {\n@@ -22335,7 +21431,7 @@ yy1501:\n \t\t} else {\n \t\t\tif (yych <= '@') goto yy3;\n \t\t\tif (yych <= 'M') goto yy142;\n-\t\t\tgoto yy1507;\n+\t\t\tgoto yy1447;\n \t\t}\n \t} else {\n \t\tif (yych <= 'm') {\n@@ -22343,12 +21439,12 @@ yy1501:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 'n') goto yy1507;\n+\t\t\tif (yych <= 'n') goto yy1447;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1502:\n+yy1442:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n@@ -22383,13 +21479,13 @@ yy1502:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1503;\n+\t\t\t\tif (yych <= 'e') goto yy1443;\n \t\t\t\tif (yych <= 'z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy1503:\n+yy1443:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'M') {\n \t\tif (yych <= ')') {\n@@ -22405,12 +21501,12 @@ yy1503:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'm') goto yy1504;\n+\t\t\tif (yych <= 'm') goto yy1444;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1504:\n+yy1444:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'B') {\n \t\tif (yych <= ')') {\n@@ -22426,36 +21522,36 @@ yy1504:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'b') goto yy1505;\n+\t\t\tif (yych <= 'b') goto yy1445;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1505:\n+yy1445:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'E') goto yy1506;\n+\t\tif (yych <= 'E') goto yy1446;\n \t\tif (yych != 'e') goto yy3;\n \t}\n-yy1506:\n+yy1446:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy205;\n-\tif (yych == 'r') goto yy205;\n+\tif (yych == 'R') goto yy204;\n+\tif (yych == 'r') goto yy204;\n \tgoto yy56;\n-yy1507:\n+yy1447:\n \t++YYCURSOR;\n \tif ((yych = *YYCURSOR) <= '@') {\n \t\tif (yych == ')') goto yy139;\n \t} else {\n \t\tif (yych <= 'Z') goto yy143;\n-\t\tif (yych <= '`') goto yy1508;\n+\t\tif (yych <= '`') goto yy1448;\n \t\tif (yych <= 'z') goto yy143;\n \t}\n-yy1508:\n+yy1448:\n #line 976 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tDEBUG_OUTPUT(\"noon\");\n@@ -22467,8 +21563,8 @@ yy1508:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_RELATIVE;\n \t}\n-#line 22471 \"<stdout>\"\n-yy1509:\n+#line 21567 \"<stdout>\"\n+yy1449:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'V') {\n@@ -22486,15 +21582,15 @@ yy1509:\n \t\t\t\tif (yych <= '@') goto yy3;\n \t\t\t\tgoto yy141;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'O') goto yy1501;\n+\t\t\t\tif (yych <= 'O') goto yy1441;\n \t\t\t\tif (yych <= 'U') goto yy141;\n-\t\t\t\tgoto yy1502;\n+\t\t\t\tgoto yy1442;\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (yych <= 'n') {\n \t\t\tif (yych <= '^') {\n-\t\t\t\tif (yych <= 'W') goto yy1499;\n+\t\t\t\tif (yych <= 'W') goto yy1439;\n \t\t\t\tif (yych <= 'Z') goto yy141;\n \t\t\t\tgoto yy3;\n \t\t\t} else {\n@@ -22504,17 +21600,17 @@ yy1509:\n \t\t\t}\n \t\t} else {\n \t\t\tif (yych <= 'v') {\n-\t\t\t\tif (yych <= 'o') goto yy1516;\n+\t\t\t\tif (yych <= 'o') goto yy1456;\n \t\t\t\tif (yych <= 'u') goto yy146;\n-\t\t\t\tgoto yy1517;\n+\t\t\t\tgoto yy1457;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'w') goto yy1515;\n+\t\t\t\tif (yych <= 'w') goto yy1455;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1510:\n+yy1450:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'W') {\n@@ -22529,7 +21625,7 @@ yy1510:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'X') goto yy1498;\n+\t\t\tif (yych <= 'X') goto yy1438;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -22538,13 +21634,13 @@ yy1510:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'x') goto yy1514;\n+\t\t\t\tif (yych <= 'x') goto yy1454;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1511:\n+yy1451:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'M') {\n@@ -22559,7 +21655,7 @@ yy1511:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'N') goto yy1496;\n+\t\t\tif (yych <= 'N') goto yy1436;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -22568,13 +21664,13 @@ yy1511:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'n') goto yy1512;\n+\t\t\t\tif (yych <= 'n') goto yy1452;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1512:\n+yy1452:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -22589,7 +21685,7 @@ yy1512:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1497;\n+\t\t\tif (yych <= 'T') goto yy1437;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -22598,13 +21694,13 @@ yy1512:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1513;\n+\t\t\t\tif (yych <= 't') goto yy1453;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1513:\n+yy1453:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'G') {\n@@ -22619,7 +21715,7 @@ yy1513:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'H') goto yy1238;\n+\t\t\tif (yych <= 'H') goto yy1178;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -22628,13 +21724,13 @@ yy1513:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'h') goto yy1267;\n+\t\t\t\tif (yych <= 'h') goto yy1207;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1514:\n+yy1454:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -22649,7 +21745,7 @@ yy1514:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1428;\n+\t\t\tif (yych <= 'T') goto yy1368;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -22658,36 +21754,36 @@ yy1514:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1460;\n+\t\t\t\tif (yych <= 't') goto yy1400;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1515:\n-\tyyaccept = 31;\n+yy1455:\n+\tyyaccept = 30;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n \t\tif (yych <= ',') {\n \t\t\tif (yych == ')') goto yy139;\n-\t\t\tgoto yy1500;\n+\t\t\tgoto yy1440;\n \t\t} else {\n-\t\t\tif (yych == '.') goto yy1500;\n+\t\t\tif (yych == '.') goto yy1440;\n \t\t\tgoto yy147;\n \t\t}\n \t} else {\n \t\tif (yych <= '^') {\n-\t\t\tif (yych <= '@') goto yy1500;\n+\t\t\tif (yych <= '@') goto yy1440;\n \t\t\tif (yych <= 'Z') goto yy142;\n-\t\t\tgoto yy1500;\n+\t\t\tgoto yy1440;\n \t\t} else {\n \t\t\tif (yych <= '_') goto yy147;\n-\t\t\tif (yych <= '`') goto yy1500;\n+\t\t\tif (yych <= '`') goto yy1440;\n \t\t\tif (yych <= 'z') goto yy150;\n-\t\t\tgoto yy1500;\n+\t\t\tgoto yy1440;\n \t\t}\n \t}\n-yy1516:\n+yy1456:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'M') {\n@@ -22702,7 +21798,7 @@ yy1516:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'N') goto yy1507;\n+\t\t\tif (yych <= 'N') goto yy1447;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -22711,13 +21807,13 @@ yy1516:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'n') goto yy1522;\n+\t\t\t\tif (yych <= 'n') goto yy1462;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1517:\n+yy1457:\n \tyyaccept = 5;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '9') {\n@@ -22733,7 +21829,7 @@ yy1517:\n \t\t\tif (yych <= '-') {\n \t\t\t\tif (yych <= ')') goto yy139;\n \t\t\t\tif (yych <= ',') goto yy193;\n-\t\t\t\tgoto yy371;\n+\t\t\t\tgoto yy311;\n \t\t\t} else {\n \t\t\t\tif (yych == '\/') goto yy147;\n \t\t\t\tgoto yy195;\n@@ -22745,7 +21841,7 @@ yy1517:\n \t\t\t\tif (yych <= '@') goto yy193;\n \t\t\t\tgoto yy142;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'E') goto yy1503;\n+\t\t\t\tif (yych <= 'E') goto yy1443;\n \t\t\t\tif (yych <= 'Z') goto yy142;\n \t\t\t\tgoto yy193;\n \t\t\t}\n@@ -22755,13 +21851,13 @@ yy1517:\n \t\t\t\tif (yych <= '`') goto yy193;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1518;\n+\t\t\t\tif (yych <= 'e') goto yy1458;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy193;\n \t\t\t}\n \t\t}\n \t}\n-yy1518:\n+yy1458:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'L') {\n@@ -22776,7 +21872,7 @@ yy1518:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'M') goto yy1504;\n+\t\t\tif (yych <= 'M') goto yy1444;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -22785,13 +21881,13 @@ yy1518:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'm') goto yy1519;\n+\t\t\t\tif (yych <= 'm') goto yy1459;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1519:\n+yy1459:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'A') {\n@@ -22806,7 +21902,7 @@ yy1519:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'B') goto yy1505;\n+\t\t\tif (yych <= 'B') goto yy1445;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -22815,13 +21911,13 @@ yy1519:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'b') goto yy1520;\n+\t\t\t\tif (yych <= 'b') goto yy1460;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1520:\n+yy1460:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n@@ -22835,44 +21931,44 @@ yy1520:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'E') goto yy1506;\n+\t\t\tif (yych <= 'E') goto yy1446;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'e') goto yy1521;\n+\t\t\tif (yych == 'e') goto yy1461;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1521:\n+yy1461:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'R') goto yy205;\n-\tif (yych == 'r') goto yy376;\n+\tif (yych == 'R') goto yy204;\n+\tif (yych == 'r') goto yy316;\n \tgoto yy154;\n-yy1522:\n-\tyyaccept = 32;\n+yy1462:\n+\tyyaccept = 31;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= '\/') {\n \t\tif (yych <= ',') {\n \t\t\tif (yych == ')') goto yy139;\n-\t\t\tgoto yy1508;\n+\t\t\tgoto yy1448;\n \t\t} else {\n-\t\t\tif (yych == '.') goto yy1508;\n+\t\t\tif (yych == '.') goto yy1448;\n \t\t\tgoto yy147;\n \t\t}\n \t} else {\n \t\tif (yych <= '^') {\n-\t\t\tif (yych <= '@') goto yy1508;\n+\t\t\tif (yych <= '@') goto yy1448;\n \t\t\tif (yych <= 'Z') goto yy143;\n-\t\t\tgoto yy1508;\n+\t\t\tgoto yy1448;\n \t\t} else {\n \t\t\tif (yych <= '_') goto yy147;\n-\t\t\tif (yych <= '`') goto yy1508;\n+\t\t\tif (yych <= '`') goto yy1448;\n \t\t\tif (yych <= 'z') goto yy151;\n-\t\t\tgoto yy1508;\n+\t\t\tgoto yy1448;\n \t\t}\n \t}\n-yy1523:\n+yy1463:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'S') {\n \t\tif (yych <= ')') {\n@@ -22888,12 +21984,12 @@ yy1523:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy141;\n \t\t} else {\n-\t\t\tif (yych <= 's') goto yy1524;\n+\t\t\tif (yych <= 's') goto yy1464;\n \t\t\tif (yych <= 'z') goto yy141;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1524:\n+yy1464:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'T') {\n \t\tif (yych <= ')') {\n@@ -22909,12 +22005,12 @@ yy1524:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy142;\n \t\t} else {\n-\t\t\tif (yych <= 't') goto yy1525;\n+\t\t\tif (yych <= 't') goto yy1465;\n \t\t\tif (yych <= 'z') goto yy142;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1525:\n+yy1465:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'E') {\n \t\tif (yych <= ')') {\n@@ -22930,12 +22026,12 @@ yy1525:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy143;\n \t\t} else {\n-\t\t\tif (yych <= 'e') goto yy1526;\n+\t\t\tif (yych <= 'e') goto yy1466;\n \t\t\tif (yych <= 'z') goto yy143;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1526:\n+yy1466:\n \tyych = *++YYCURSOR;\n \tif (yych <= 'R') {\n \t\tif (yych <= ')') {\n@@ -22951,32 +22047,32 @@ yy1526:\n \t\t\tif (yych <= '`') goto yy3;\n \t\t\tgoto yy144;\n \t\t} else {\n-\t\t\tif (yych <= 'r') goto yy1527;\n+\t\t\tif (yych <= 'r') goto yy1467;\n \t\t\tif (yych <= 'z') goto yy144;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1527:\n+yy1467:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'C') {\n \t\tif (yych == ')') goto yy139;\n \t\tgoto yy3;\n \t} else {\n-\t\tif (yych <= 'D') goto yy1528;\n+\t\tif (yych <= 'D') goto yy1468;\n \t\tif (yych != 'd') goto yy3;\n \t}\n-yy1528:\n+yy1468:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1529;\n+\tif (yych == 'A') goto yy1469;\n \tif (yych != 'a') goto yy56;\n-yy1529:\n+yy1469:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1530;\n+\tif (yych == 'Y') goto yy1470;\n \tif (yych != 'y') goto yy56;\n-yy1530:\n+yy1470:\n \t++YYCURSOR;\n-yy1531:\n+yy1471:\n #line 955 \"ext\/date\/lib\/parse_date.re\"\n \t{\n \t\tDEBUG_OUTPUT(\"yesterday\");\n@@ -22988,8 +22084,8 @@ yy1531:\n \t\tTIMELIB_DEINIT;\n \t\treturn TIMELIB_RELATIVE;\n \t}\n-#line 22992 \"<stdout>\"\n-yy1532:\n+#line 22088 \"<stdout>\"\n+yy1472:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'R') {\n@@ -23004,7 +22100,7 @@ yy1532:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'S') goto yy1524;\n+\t\t\tif (yych <= 'S') goto yy1464;\n \t\t\tif (yych <= 'Z') goto yy141;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -23013,13 +22109,13 @@ yy1532:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy146;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 's') goto yy1533;\n+\t\t\t\tif (yych <= 's') goto yy1473;\n \t\t\t\tif (yych <= 'z') goto yy146;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1533:\n+yy1473:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'S') {\n@@ -23034,7 +22130,7 @@ yy1533:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'T') goto yy1525;\n+\t\t\tif (yych <= 'T') goto yy1465;\n \t\t\tif (yych <= 'Z') goto yy142;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -23043,13 +22139,13 @@ yy1533:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy150;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 't') goto yy1534;\n+\t\t\t\tif (yych <= 't') goto yy1474;\n \t\t\t\tif (yych <= 'z') goto yy150;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1534:\n+yy1474:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'D') {\n@@ -23064,7 +22160,7 @@ yy1534:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'E') goto yy1526;\n+\t\t\tif (yych <= 'E') goto yy1466;\n \t\t\tif (yych <= 'Z') goto yy143;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -23073,13 +22169,13 @@ yy1534:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy151;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'e') goto yy1535;\n+\t\t\t\tif (yych <= 'e') goto yy1475;\n \t\t\t\tif (yych <= 'z') goto yy151;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1535:\n+yy1475:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'Q') {\n@@ -23094,7 +22190,7 @@ yy1535:\n \t\t}\n \t} else {\n \t\tif (yych <= '_') {\n-\t\t\tif (yych <= 'R') goto yy1527;\n+\t\t\tif (yych <= 'R') goto yy1467;\n \t\t\tif (yych <= 'Z') goto yy144;\n \t\t\tif (yych <= '^') goto yy3;\n \t\t\tgoto yy147;\n@@ -23103,13 +22199,13 @@ yy1535:\n \t\t\t\tif (yych <= '`') goto yy3;\n \t\t\t\tgoto yy152;\n \t\t\t} else {\n-\t\t\t\tif (yych <= 'r') goto yy1536;\n+\t\t\t\tif (yych <= 'r') goto yy1476;\n \t\t\t\tif (yych <= 'z') goto yy152;\n \t\t\t\tgoto yy3;\n \t\t\t}\n \t\t}\n \t}\n-yy1536:\n+yy1476:\n \tyyaccept = 0;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yych <= 'C') {\n@@ -23123,41 +22219,41 @@ yy1536:\n \t\t}\n \t} else {\n \t\tif (yych <= '`') {\n-\t\t\tif (yych <= 'D') goto yy1528;\n+\t\t\tif (yych <= 'D') goto yy1468;\n \t\t\tif (yych == '_') goto yy147;\n \t\t\tgoto yy3;\n \t\t} else {\n-\t\t\tif (yych == 'd') goto yy1537;\n+\t\t\tif (yych == 'd') goto yy1477;\n \t\t\tif (yych <= 'z') goto yy153;\n \t\t\tgoto yy3;\n \t\t}\n \t}\n-yy1537:\n+yy1477:\n \tyych = *++YYCURSOR;\n-\tif (yych == 'A') goto yy1529;\n+\tif (yych == 'A') goto yy1469;\n \tif (yych != 'a') goto yy154;\n \tyych = *++YYCURSOR;\n-\tif (yych == 'Y') goto yy1530;\n+\tif (yych == 'Y') goto yy1470;\n \tif (yych != 'y') goto yy154;\n-\tyyaccept = 33;\n+\tyyaccept = 32;\n \tyych = *(YYMARKER = ++YYCURSOR);\n \tif (yybm[0+yych] & 16) {\n \t\tgoto yy153;\n \t}\n \tif (yych <= '.') {\n \t\tif (yych == '-') goto yy147;\n-\t\tgoto yy1531;\n+\t\tgoto yy1471;\n \t} else {\n \t\tif (yych <= '\/') goto yy147;\n \t\tif (yych == '_') goto yy147;\n-\t\tgoto yy1531;\n+\t\tgoto yy1471;\n \t}\n }\n #line 1729 \"ext\/date\/lib\/parse_date.re\"\n \n }\n \n-#define YYMAXFILL 31\n+#define YYMAXFILL 33\n \n timelib_time* timelib_strtotime(char *s, size_t len, struct timelib_error_container **errors, const timelib_tzdb *tzdb, timelib_tz_get_wrapper tz_get_wrapper)\n {\ndiff --git a\/ext\/date\/lib\/parse_date.re b\/ext\/date\/lib\/parse_date.re\nindex 79dabe4..8c50699 100644\n--- a\/ext\/date\/lib\/parse_date.re\n+++ b\/ext\/date\/lib\/parse_date.re\n@@ -899,7 +899,7 @@ datefull         = day ([ \\t.-])* monthtext ([ \\t.-])* year;\n datenoday        = monthtext ([ .\\t-])* year4;\n datenodayrev     = year4 ([ .\\t-])* monthtext;\n datetextual      = monthtext ([ .\\t-])* day [,.stndrh\\t ]+ year;\n-datenoyear       = monthtext ([ .\\t-])* day [,.stndrh\\t ]*;\n+datenoyear       = monthtext ([ .\\t-])* day ([,.stndrh\\t ]+|[\\000]);\n datenoyearrev    = day ([ .\\t-])* monthtext;\n datenocolon      = year4 monthlz daylz;\n \n-- \n2.1.4\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-11645","CWE_ID":"200","category":"security","commit_id":"b60d50b7567369ad856cebe1efb6cd7dd2284219","commit_message":"From b60d50b7567369ad856cebe1efb6cd7dd2284219 Mon Sep 17 00:00:00 2001\nFrom: Chris Liddell <chris.liddell@artifex.com>\nDate: Sat, 8 Oct 2016 16:35:39 +0100\nSubject: [PATCH] Bug 697193: status operator honour SAFER option\n\n---\n psi\/zfile.c | 16 +++++++++++-----\n 1 file changed, 11 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/psi\/zfile.c b\/psi\/zfile.c\nindex 2f27f82..be3a6a6 100644\n--- a\/psi\/zfile.c\n+++ b\/psi\/zfile.c\n@@ -209,10 +209,13 @@ z_check_file_permissions(gs_memory_t *mem, const char *fname, const int len, con\n     if (code < 0)\n         return code;\n \n-    if (pname.iodev && i_ctx_p->LockFilePermissions && strcmp(pname.iodev->dname, \"%pipe%\") == 0)\n-        return gs_error_invalidfileaccess;\n-        \n-    code = check_file_permissions(i_ctx_p, fname, len, permitgroup);\n+    if (pname.iodev && i_ctx_p->LockFilePermissions\n+         && strcmp(pname.iodev->dname, \"%pipe%\") == 0) {\n+        code = gs_note_error(gs_error_invalidfileaccess);\n+    }\n+    else {\n+        code = check_file_permissions(i_ctx_p, fname, len, permitgroup);\n+    }\n     return code;\n }\n \n@@ -503,8 +506,11 @@ zstatus(i_ctx_t *i_ctx_p)\n                 code = gs_terminate_file_name(&pname, imemory, \"status\");\n                 if (code < 0)\n                     return code;\n-                code = (*pname.iodev->procs.file_status)(pname.iodev,\n+                if ((code = check_file_permissions(i_ctx_p, pname.fname, pname.len,\n+                                       \"PermitFileReading\")) >= 0) {\n+                    code = (*pname.iodev->procs.file_status)(pname.iodev,\n                                                        pname.fname, &fstat);\n+                }\n                 switch (code) {\n                     case 0:\n                         check_ostack(4);\n-- \n2.9.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2010-4078","CWE_ID":"200","category":"security","commit_id":"fd02db9de73faebc51240619c7c7f99bee9f65c7","commit_message":"From fd02db9de73faebc51240619c7c7f99bee9f65c7 Mon Sep 17 00:00:00 2001\nFrom: Dan Rosenberg <drosenberg@vsecurity.com>\nDate: Wed, 22 Sep 2010 13:05:09 -0700\nSubject: drivers\/video\/sis\/sis_main.c: prevent reading uninitialized stack\n memory\n\nThe FBIOGET_VBLANK device ioctl allows unprivileged users to read 16 bytes\nof uninitialized stack memory, because the \"reserved\" member of the\nfb_vblank struct declared on the stack is not altered or zeroed before\nbeing copied back to the user.  This patch takes care of it.\n\nSigned-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>\nCc: Thomas Winischhofer <thomas@winischhofer.net>\nCc: <stable@kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n drivers\/video\/sis\/sis_main.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/drivers\/video\/sis\/sis_main.c b\/drivers\/video\/sis\/sis_main.c\nindex 559bf1727a2b..b52f8e4ef1fd 100644\n--- a\/drivers\/video\/sis\/sis_main.c\n+++ b\/drivers\/video\/sis\/sis_main.c\n@@ -1701,6 +1701,9 @@ static int\tsisfb_ioctl(struct fb_info *info, unsigned int cmd,\n \t\tbreak;\n \n \t   case FBIOGET_VBLANK:\n+\n+\t\tmemset(&sisvbblank, 0, sizeof(struct fb_vblank));\n+\n \t\tsisvbblank.count = 0;\n \t\tsisvbblank.flags = sisfb_setupvbblankflags(ivideo, &sisvbblank.vcount, &sisvbblank.hcount);\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-14991","CWE_ID":"200","category":"security","commit_id":"3e0097499839e0fe3af380410eababe5a47c4cf9","commit_message":"From 3e0097499839e0fe3af380410eababe5a47c4cf9 Mon Sep 17 00:00:00 2001\nFrom: Hannes Reinecke <hare@suse.de>\nDate: Fri, 15 Sep 2017 14:05:16 +0200\nSubject: [PATCH] scsi: sg: fixup infoleak when using SG_GET_REQUEST_TABLE\n\nWhen calling SG_GET_REQUEST_TABLE ioctl only a half-filled table is\nreturned; the remaining part will then contain stale kernel memory\ninformation.  This patch zeroes out the entire table to avoid this\nissue.\n\nSigned-off-by: Hannes Reinecke <hare@suse.com>\nReviewed-by: Bart Van Assche <bart.vanassche@wdc.com>\nReviewed-by: Christoph Hellwig <hch@lst.de>\nReviewed-by: Eric Dumazet <edumazet@google.com>\nSigned-off-by: Martin K. Petersen <martin.petersen@oracle.com>\n---\n drivers\/scsi\/sg.c | 5 ++---\n 1 file changed, 2 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/scsi\/sg.c b\/drivers\/scsi\/sg.c\nindex 1acdb6e039998..0419c2298eabd 100644\n--- a\/drivers\/scsi\/sg.c\n+++ b\/drivers\/scsi\/sg.c\n@@ -839,7 +839,6 @@ sg_fill_request_table(Sg_fd *sfp, sg_req_info_t *rinfo)\n \tlist_for_each_entry(srp, &sfp->rq_list, entry) {\n \t\tif (val > SG_MAX_QUEUE)\n \t\t\tbreak;\n-\t\tmemset(&rinfo[val], 0, SZ_SG_REQ_INFO);\n \t\trinfo[val].req_state = srp->done + 1;\n \t\trinfo[val].problem =\n \t\t\tsrp->header.masked_status &\n@@ -1047,8 +1046,8 @@ sg_ioctl(struct file *filp, unsigned int cmd_in, unsigned long arg)\n \t\telse {\n \t\t\tsg_req_info_t *rinfo;\n \n-\t\t\trinfo = kmalloc(SZ_SG_REQ_INFO * SG_MAX_QUEUE,\n-\t\t\t\t\t\t\t\tGFP_KERNEL);\n+\t\t\trinfo = kzalloc(SZ_SG_REQ_INFO * SG_MAX_QUEUE,\n+\t\t\t\t\tGFP_KERNEL);\n \t\t\tif (!rinfo)\n \t\t\t\treturn -ENOMEM;\n \t\t\tread_lock_irqsave(&sfp->rq_list_lock, iflags);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2019-10638","CWE_ID":"200","category":"security","commit_id":"55f0fc7a02de8f12757f4937143d8d5091b2e40b","commit_message":"From 55f0fc7a02de8f12757f4937143d8d5091b2e40b Mon Sep 17 00:00:00 2001\nFrom: Amit Klein <aksecurity@gmail.com>\nDate: Thu, 18 Apr 2019 21:07:11 +0000\nSubject: [PATCH] inet: update the IP ID generation algorithm to higher\n standards.\n\nCommit 355b98553789 (\"netns: provide pure entropy for net_hash_mix()\")\nmakes net_hash_mix() return a true 32 bits of entropy.  When used in the\nIP ID generation algorithm, this has the effect of extending the IP ID\ngeneration key from 32 bits to 64 bits.\n\nHowever, net_hash_mix() is only used for IP ID generation starting with\nkernel version 4.1.  Therefore, earlier kernels remain with 32-bit key\nno matter what the net_hash_mix() return value is.\n\nThis change addresses the issue by explicitly extending the key to 64\nbits for kernels older than 4.1.\n\nSigned-off-by: Amit Klein <aksecurity@gmail.com>\nCc: Ben Hutchings <ben@decadent.org.uk>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\n---\n net\/ipv4\/route.c      | 4 +++-\n net\/ipv6\/ip6_output.c | 3 +++\n 2 files changed, 6 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/ipv4\/route.c b\/net\/ipv4\/route.c\nindex ede610a4abc8a..5b2a8d04a8a0d 100644\n--- a\/net\/ipv4\/route.c\n+++ b\/net\/ipv4\/route.c\n@@ -488,13 +488,15 @@ EXPORT_SYMBOL(ip_idents_reserve);\n void __ip_select_ident(struct iphdr *iph, int segs)\n {\n \tstatic u32 ip_idents_hashrnd __read_mostly;\n+\tstatic u32 ip_idents_hashrnd_extra __read_mostly;\n \tu32 hash, id;\n \n \tnet_get_random_once(&ip_idents_hashrnd, sizeof(ip_idents_hashrnd));\n+\tnet_get_random_once(&ip_idents_hashrnd_extra, sizeof(ip_idents_hashrnd_extra));\n \n \thash = jhash_3words((__force u32)iph->daddr,\n \t\t\t    (__force u32)iph->saddr,\n-\t\t\t    iph->protocol,\n+\t\t\t    iph->protocol ^ ip_idents_hashrnd_extra,\n \t\t\t    ip_idents_hashrnd);\n \tid = ip_idents_reserve(hash, segs);\n \tiph->id = htons(id);\ndiff --git a\/net\/ipv6\/ip6_output.c b\/net\/ipv6\/ip6_output.c\nindex 2b69a4b965edf..c3cef2d5c0208 100644\n--- a\/net\/ipv6\/ip6_output.c\n+++ b\/net\/ipv6\/ip6_output.c\n@@ -546,12 +546,15 @@ static void ip6_copy_metadata(struct sk_buff *to, struct sk_buff *from)\n static void ipv6_select_ident(struct frag_hdr *fhdr, struct rt6_info *rt)\n {\n \tstatic u32 ip6_idents_hashrnd __read_mostly;\n+\tstatic u32 ip6_idents_hashrnd_extra __read_mostly;\n \tu32 hash, id;\n \n \tnet_get_random_once(&ip6_idents_hashrnd, sizeof(ip6_idents_hashrnd));\n+\tnet_get_random_once(&ip6_idents_hashrnd_extra, sizeof(ip6_idents_hashrnd_extra));\n \n \thash = __ipv6_addr_jhash(&rt->rt6i_dst.addr, ip6_idents_hashrnd);\n \thash = __ipv6_addr_jhash(&rt->rt6i_src.addr, hash);\n+\thash = jhash_1word(hash, ip6_idents_hashrnd_extra);\n \n \tid = ip_idents_reserve(hash, 1);\n \tfhdr->identification = htonl(id);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2005-4881","CWE_ID":"200","category":"security","commit_id":"9ef1d4c7c7aca1cd436612b6ca785b726ffb8ed8","commit_message":"From 9ef1d4c7c7aca1cd436612b6ca785b726ffb8ed8 Mon Sep 17 00:00:00 2001\nFrom: Patrick McHardy <kaber@trash.net>\nDate: Tue, 28 Jun 2005 12:55:30 -0700\nSubject: [NETLINK]: Missing initializations in dumped data\n\nMostly missing initialization of padding fields of 1 or 2 bytes length,\ntwo instances of uninitialized nlmsgerr->msg of 16 bytes length.\n\nSigned-off-by: Patrick McHardy <kaber@trash.net>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/core\/neighbour.c |  6 ++++++\n net\/core\/rtnetlink.c |  1 +\n net\/core\/wireless.c  |  1 +\n net\/ipv4\/ipmr.c      | 10 ++++++++--\n net\/ipv6\/addrconf.c  |  1 +\n net\/sched\/act_api.c  | 10 +++++++++-\n net\/sched\/cls_api.c  |  2 ++\n net\/sched\/sch_api.c  |  2 ++\n net\/sched\/sch_cbq.c  |  2 ++\n 9 files changed, 32 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/net\/core\/neighbour.c b\/net\/core\/neighbour.c\nindex 851eb927ed97..1beb782ac41b 100644\n--- a\/net\/core\/neighbour.c\n+++ b\/net\/core\/neighbour.c\n@@ -1598,6 +1598,8 @@ static int neightbl_fill_info(struct neigh_table *tbl, struct sk_buff *skb,\n \n \tread_lock_bh(&tbl->lock);\n \tndtmsg->ndtm_family = tbl->family;\n+\tndtmsg->ndtm_pad1   = 0;\n+\tndtmsg->ndtm_pad2   = 0;\n \n \tRTA_PUT_STRING(skb, NDTA_NAME, tbl->id);\n \tRTA_PUT_MSECS(skb, NDTA_GC_INTERVAL, tbl->gc_interval);\n@@ -1683,6 +1685,8 @@ static int neightbl_fill_param_info(struct neigh_table *tbl,\n \n \tread_lock_bh(&tbl->lock);\n \tndtmsg->ndtm_family = tbl->family;\n+\tndtmsg->ndtm_pad1   = 0;\n+\tndtmsg->ndtm_pad2   = 0;\n \tRTA_PUT_STRING(skb, NDTA_NAME, tbl->id);\n \n \tif (neightbl_fill_parms(skb, parms) < 0)\n@@ -1872,6 +1876,8 @@ static int neigh_fill_info(struct sk_buff *skb, struct neighbour *n,\n \tstruct ndmsg *ndm = NLMSG_DATA(nlh);\n \n \tndm->ndm_family\t = n->ops->family;\n+\tndm->ndm_pad1    = 0;\n+\tndm->ndm_pad2    = 0;\n \tndm->ndm_flags\t = n->flags;\n \tndm->ndm_type\t = n->type;\n \tndm->ndm_ifindex = n->dev->ifindex;\ndiff --git a\/net\/core\/rtnetlink.c b\/net\/core\/rtnetlink.c\nindex 879237c378f8..4b1bb30e6381 100644\n--- a\/net\/core\/rtnetlink.c\n+++ b\/net\/core\/rtnetlink.c\n@@ -189,6 +189,7 @@ static int rtnetlink_fill_ifinfo(struct sk_buff *skb, struct net_device *dev,\n \tnlh = NLMSG_NEW(skb, pid, seq, type, sizeof(*r), flags);\n \tr = NLMSG_DATA(nlh);\n \tr->ifi_family = AF_UNSPEC;\n+\tr->__ifi_pad = 0;\n \tr->ifi_type = dev->type;\n \tr->ifi_index = dev->ifindex;\n \tr->ifi_flags = dev_get_flags(dev);\ndiff --git a\/net\/core\/wireless.c b\/net\/core\/wireless.c\nindex b2fe378dfbf8..3ff5639c0b78 100644\n--- a\/net\/core\/wireless.c\n+++ b\/net\/core\/wireless.c\n@@ -1102,6 +1102,7 @@ static inline int rtnetlink_fill_iwinfo(struct sk_buff *\tskb,\n \tnlh = NLMSG_PUT(skb, 0, 0, type, sizeof(*r));\n \tr = NLMSG_DATA(nlh);\n \tr->ifi_family = AF_UNSPEC;\n+\tr->__ifi_pad = 0;\n \tr->ifi_type = dev->type;\n \tr->ifi_index = dev->ifindex;\n \tr->ifi_flags = dev->flags;\ndiff --git a\/net\/ipv4\/ipmr.c b\/net\/ipv4\/ipmr.c\nindex e4f809a93f47..7833d920bdba 100644\n--- a\/net\/ipv4\/ipmr.c\n+++ b\/net\/ipv4\/ipmr.c\n@@ -297,6 +297,7 @@ static int vif_delete(int vifi)\n static void ipmr_destroy_unres(struct mfc_cache *c)\n {\n \tstruct sk_buff *skb;\n+\tstruct nlmsgerr *e;\n \n \tatomic_dec(&cache_resolve_queue_len);\n \n@@ -306,7 +307,9 @@ static void ipmr_destroy_unres(struct mfc_cache *c)\n \t\t\tnlh->nlmsg_type = NLMSG_ERROR;\n \t\t\tnlh->nlmsg_len = NLMSG_LENGTH(sizeof(struct nlmsgerr));\n \t\t\tskb_trim(skb, nlh->nlmsg_len);\n-\t\t\t((struct nlmsgerr*)NLMSG_DATA(nlh))->error = -ETIMEDOUT;\n+\t\t\te = NLMSG_DATA(nlh);\n+\t\t\te->error = -ETIMEDOUT;\n+\t\t\tmemset(&e->msg, 0, sizeof(e->msg));\n \t\t\tnetlink_unicast(rtnl, skb, NETLINK_CB(skb).dst_pid, MSG_DONTWAIT);\n \t\t} else\n \t\t\tkfree_skb(skb);\n@@ -499,6 +502,7 @@ static struct mfc_cache *ipmr_cache_alloc_unres(void)\n static void ipmr_cache_resolve(struct mfc_cache *uc, struct mfc_cache *c)\n {\n \tstruct sk_buff *skb;\n+\tstruct nlmsgerr *e;\n \n \t\/*\n \t *\tPlay the pending entries through our router\n@@ -515,7 +519,9 @@ static void ipmr_cache_resolve(struct mfc_cache *uc, struct mfc_cache *c)\n \t\t\t\tnlh->nlmsg_type = NLMSG_ERROR;\n \t\t\t\tnlh->nlmsg_len = NLMSG_LENGTH(sizeof(struct nlmsgerr));\n \t\t\t\tskb_trim(skb, nlh->nlmsg_len);\n-\t\t\t\t((struct nlmsgerr*)NLMSG_DATA(nlh))->error = -EMSGSIZE;\n+\t\t\t\te = NLMSG_DATA(nlh);\n+\t\t\t\te->error = -EMSGSIZE;\n+\t\t\t\tmemset(&e->msg, 0, sizeof(e->msg));\n \t\t\t}\n \t\t\terr = netlink_unicast(rtnl, skb, NETLINK_CB(skb).dst_pid, MSG_DONTWAIT);\n \t\t} else\ndiff --git a\/net\/ipv6\/addrconf.c b\/net\/ipv6\/addrconf.c\nindex a54d4ef3fd35..8140bed78a26 100644\n--- a\/net\/ipv6\/addrconf.c\n+++ b\/net\/ipv6\/addrconf.c\n@@ -2923,6 +2923,7 @@ static int inet6_fill_ifinfo(struct sk_buff *skb, struct inet6_dev *idev,\n \tnlh = NLMSG_NEW(skb, pid, seq, event, sizeof(*r), flags);\n \tr = NLMSG_DATA(nlh);\n \tr->ifi_family = AF_INET6;\n+\tr->__ifi_pad = 0;\n \tr->ifi_type = dev->type;\n \tr->ifi_index = dev->ifindex;\n \tr->ifi_flags = dev_get_flags(dev);\ndiff --git a\/net\/sched\/act_api.c b\/net\/sched\/act_api.c\nindex 9594206e6035..249c61936ea0 100644\n--- a\/net\/sched\/act_api.c\n+++ b\/net\/sched\/act_api.c\n@@ -439,6 +439,8 @@ tca_get_fill(struct sk_buff *skb, struct tc_action *a, u32 pid, u32 seq,\n \n \tt = NLMSG_DATA(nlh);\n \tt->tca_family = AF_UNSPEC;\n+\tt->tca__pad1 = 0;\n+\tt->tca__pad2 = 0;\n \t\n \tx = (struct rtattr*) skb->tail;\n \tRTA_PUT(skb, TCA_ACT_TAB, 0, NULL);\n@@ -580,6 +582,8 @@ static int tca_action_flush(struct rtattr *rta, struct nlmsghdr *n, u32 pid)\n \tnlh = NLMSG_PUT(skb, pid, n->nlmsg_seq, RTM_DELACTION, sizeof(*t));\n \tt = NLMSG_DATA(nlh);\n \tt->tca_family = AF_UNSPEC;\n+\tt->tca__pad1 = 0;\n+\tt->tca__pad2 = 0;\n \n \tx = (struct rtattr *) skb->tail;\n \tRTA_PUT(skb, TCA_ACT_TAB, 0, NULL);\n@@ -687,7 +691,9 @@ static int tcf_add_notify(struct tc_action *a, u32 pid, u32 seq, int event,\n \tnlh = NLMSG_NEW(skb, pid, seq, event, sizeof(*t), flags);\n \tt = NLMSG_DATA(nlh);\n \tt->tca_family = AF_UNSPEC;\n-\t\n+\tt->tca__pad1 = 0;\n+\tt->tca__pad2 = 0;\n+\n \tx = (struct rtattr*) skb->tail;\n \tRTA_PUT(skb, TCA_ACT_TAB, 0, NULL);\n \n@@ -842,6 +848,8 @@ tc_dump_action(struct sk_buff *skb, struct netlink_callback *cb)\n \t                cb->nlh->nlmsg_type, sizeof(*t));\n \tt = NLMSG_DATA(nlh);\n \tt->tca_family = AF_UNSPEC;\n+\tt->tca__pad1 = 0;\n+\tt->tca__pad2 = 0;\n \n \tx = (struct rtattr *) skb->tail;\n \tRTA_PUT(skb, TCA_ACT_TAB, 0, NULL);\ndiff --git a\/net\/sched\/cls_api.c b\/net\/sched\/cls_api.c\nindex 1616bf5c9627..3b5714ef4d1a 100644\n--- a\/net\/sched\/cls_api.c\n+++ b\/net\/sched\/cls_api.c\n@@ -331,6 +331,8 @@ tcf_fill_node(struct sk_buff *skb, struct tcf_proto *tp, unsigned long fh,\n \tnlh = NLMSG_NEW(skb, pid, seq, event, sizeof(*tcm), flags);\n \ttcm = NLMSG_DATA(nlh);\n \ttcm->tcm_family = AF_UNSPEC;\n+\ttcm->tcm__pad1 = 0;\n+\ttcm->tcm__pad1 = 0;\n \ttcm->tcm_ifindex = tp->q->dev->ifindex;\n \ttcm->tcm_parent = tp->classid;\n \ttcm->tcm_info = TC_H_MAKE(tp->prio, tp->protocol);\ndiff --git a\/net\/sched\/sch_api.c b\/net\/sched\/sch_api.c\nindex 97c1c75d5c78..05e6e0a799da 100644\n--- a\/net\/sched\/sch_api.c\n+++ b\/net\/sched\/sch_api.c\n@@ -770,6 +770,8 @@ static int tc_fill_qdisc(struct sk_buff *skb, struct Qdisc *q, u32 clid,\n \tnlh = NLMSG_NEW(skb, pid, seq, event, sizeof(*tcm), flags);\n \ttcm = NLMSG_DATA(nlh);\n \ttcm->tcm_family = AF_UNSPEC;\n+\ttcm->tcm__pad1 = 0;\n+\ttcm->tcm__pad2 = 0;\n \ttcm->tcm_ifindex = q->dev->ifindex;\n \ttcm->tcm_parent = clid;\n \ttcm->tcm_handle = q->handle;\ndiff --git a\/net\/sched\/sch_cbq.c b\/net\/sched\/sch_cbq.c\nindex d43e3b8cbf6a..baeb3111f75e 100644\n--- a\/net\/sched\/sch_cbq.c\n+++ b\/net\/sched\/sch_cbq.c\n@@ -1563,6 +1563,8 @@ static __inline__ int cbq_dump_police(struct sk_buff *skb, struct cbq_class *cl)\n \n \tif (cl->police) {\n \t\topt.police = cl->police;\n+\t\topt.__res1 = 0;\n+\t\topt.__res2 = 0;\n \t\tRTA_PUT(skb, TCA_CBQ_POLICE, sizeof(opt), &opt);\n \t}\n \treturn skb->len;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-4486","CWE_ID":"200","category":"security","commit_id":"5f8e44741f9f216e33736ea4ec65ca9ac03036e6","commit_message":"From 5f8e44741f9f216e33736ea4ec65ca9ac03036e6 Mon Sep 17 00:00:00 2001\nFrom: Kangjie Lu <kangjielu@gmail.com>\nDate: Tue, 3 May 2016 16:46:24 -0400\nSubject: [PATCH] net: fix infoleak in rtnetlink\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nThe stack object \u201cmap\u201d has a total size of 32 bytes. Its last 4\nbytes are padding generated by compiler. These padding bytes are\nnot initialized and sent out via \u201cnla_put\u201d.\n\nSigned-off-by: Kangjie Lu <kjlu@gatech.edu>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/core\/rtnetlink.c | 18 ++++++++++--------\n 1 file changed, 10 insertions(+), 8 deletions(-)\n\n","diff_code":"diff --git a\/net\/core\/rtnetlink.c b\/net\/core\/rtnetlink.c\nindex a75f7e94b4456..65763c29f8454 100644\n--- a\/net\/core\/rtnetlink.c\n+++ b\/net\/core\/rtnetlink.c\n@@ -1180,14 +1180,16 @@ static noinline_for_stack int rtnl_fill_vfinfo(struct sk_buff *skb,\n \n static int rtnl_fill_link_ifmap(struct sk_buff *skb, struct net_device *dev)\n {\n-\tstruct rtnl_link_ifmap map = {\n-\t\t.mem_start   = dev->mem_start,\n-\t\t.mem_end     = dev->mem_end,\n-\t\t.base_addr   = dev->base_addr,\n-\t\t.irq         = dev->irq,\n-\t\t.dma         = dev->dma,\n-\t\t.port        = dev->if_port,\n-\t};\n+\tstruct rtnl_link_ifmap map;\n+\n+\tmemset(&map, 0, sizeof(map));\n+\tmap.mem_start   = dev->mem_start;\n+\tmap.mem_end     = dev->mem_end;\n+\tmap.base_addr   = dev->base_addr;\n+\tmap.irq         = dev->irq;\n+\tmap.dma         = dev->dma;\n+\tmap.port        = dev->if_port;\n+\n \tif (nla_put(skb, IFLA_MAP, sizeof(map), &map))\n \t\treturn -EMSGSIZE;\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2010-2943","CWE_ID":"200","category":"security","commit_id":"7b6259e7a83647948fa33a736cc832310c8d85aa","commit_message":"From 7b6259e7a83647948fa33a736cc832310c8d85aa Mon Sep 17 00:00:00 2001\nFrom: Dave Chinner <dchinner@redhat.com>\nDate: Thu, 24 Jun 2010 11:35:17 +1000\nSubject: xfs: remove block number from inode lookup code\n\nThe block number comes from bulkstat based inode lookups to shortcut\nthe mapping calculations. We ar enot able to trust anything from\nbulkstat, so drop the block number as well so that the correct\nlookups and mappings are always done.\n\nSigned-off-by: Dave Chinner <dchinner@redhat.com>\nReviewed-by: Christoph Hellwig <hch@lst.de>\n---\n fs\/xfs\/linux-2.6\/xfs_export.c  |  2 +-\n fs\/xfs\/linux-2.6\/xfs_ioctl32.c |  5 ++---\n fs\/xfs\/quota\/xfs_qm.c          |  7 +++----\n fs\/xfs\/quota\/xfs_qm_syscalls.c | 11 +++++------\n fs\/xfs\/xfs_ialloc.c            | 16 ----------------\n fs\/xfs\/xfs_iget.c              | 10 +++-------\n fs\/xfs\/xfs_inode.c             |  3 ---\n fs\/xfs\/xfs_inode.h             |  4 ++--\n fs\/xfs\/xfs_itable.c            | 12 ++++--------\n fs\/xfs\/xfs_itable.h            |  3 ---\n fs\/xfs\/xfs_log_recover.c       |  2 +-\n fs\/xfs\/xfs_mount.c             |  2 +-\n fs\/xfs\/xfs_rtalloc.c           |  4 ++--\n fs\/xfs\/xfs_trans_inode.c       |  2 +-\n fs\/xfs\/xfs_vnodeops.c          |  2 +-\n 15 files changed, 26 insertions(+), 59 deletions(-)\n\n","diff_code":"diff --git a\/fs\/xfs\/linux-2.6\/xfs_export.c b\/fs\/xfs\/linux-2.6\/xfs_export.c\nindex 92c84a19cc9e..e7839ee49e43 100644\n--- a\/fs\/xfs\/linux-2.6\/xfs_export.c\n+++ b\/fs\/xfs\/linux-2.6\/xfs_export.c\n@@ -133,7 +133,7 @@ xfs_nfs_get_inode(\n \t * send invalid file handles and we have to handle it gracefully..\n \t *\/\n \terror = xfs_iget(mp, NULL, ino, XFS_IGET_UNTRUSTED,\n-\t\t\t XFS_ILOCK_SHARED, &ip, 0);\n+\t\t\t XFS_ILOCK_SHARED, &ip);\n \tif (error) {\n \t\t\/*\n \t\t * EINVAL means the inode cluster doesn't exist anymore.\ndiff --git a\/fs\/xfs\/linux-2.6\/xfs_ioctl32.c b\/fs\/xfs\/linux-2.6\/xfs_ioctl32.c\nindex e1d8380b049d..52ed49e6465c 100644\n--- a\/fs\/xfs\/linux-2.6\/xfs_ioctl32.c\n+++ b\/fs\/xfs\/linux-2.6\/xfs_ioctl32.c\n@@ -237,12 +237,11 @@ xfs_bulkstat_one_compat(\n \txfs_ino_t\tino,\t\t\/* inode number to get data for *\/\n \tvoid\t\t__user *buffer,\t\/* buffer to place output in *\/\n \tint\t\tubsize,\t\t\/* size of buffer *\/\n-\txfs_daddr_t\tbno,\t\t\/* starting bno of inode cluster *\/\n \tint\t\t*ubused,\t\/* bytes used by me *\/\n \tint\t\t*stat)\t\t\/* BULKSTAT_RV_... *\/\n {\n \treturn xfs_bulkstat_one_int(mp, ino, buffer, ubsize,\n-\t\t\t\t    xfs_bulkstat_one_fmt_compat, bno,\n+\t\t\t\t    xfs_bulkstat_one_fmt_compat,\n \t\t\t\t    ubused, stat);\n }\n \n@@ -296,7 +295,7 @@ xfs_compat_ioc_bulkstat(\n \t\tint res;\n \n \t\terror = xfs_bulkstat_one_compat(mp, inlast, bulkreq.ubuffer,\n-\t\t\t\tsizeof(compat_xfs_bstat_t), 0, NULL, &res);\n+\t\t\t\tsizeof(compat_xfs_bstat_t), 0, &res);\n \t} else if (cmd == XFS_IOC_FSBULKSTAT_32) {\n \t\terror = xfs_bulkstat(mp, &inlast, &count,\n \t\t\txfs_bulkstat_one_compat, sizeof(compat_xfs_bstat_t),\ndiff --git a\/fs\/xfs\/quota\/xfs_qm.c b\/fs\/xfs\/quota\/xfs_qm.c\nindex f19f94c4cb9f..8c117ff2e3ab 100644\n--- a\/fs\/xfs\/quota\/xfs_qm.c\n+++ b\/fs\/xfs\/quota\/xfs_qm.c\n@@ -1632,7 +1632,6 @@ xfs_qm_dqusage_adjust(\n \txfs_ino_t\tino,\t\t\/* inode number to get data for *\/\n \tvoid\t\t__user *buffer,\t\/* not used *\/\n \tint\t\tubsize,\t\t\/* not used *\/\n-\txfs_daddr_t\tbno,\t\t\/* starting block of inode cluster *\/\n \tint\t\t*ubused,\t\/* not used *\/\n \tint\t\t*res)\t\t\/* result code value *\/\n {\n@@ -1658,7 +1657,7 @@ xfs_qm_dqusage_adjust(\n \t * the case in all other instances. It's OK that we do this because\n \t * quotacheck is done only at mount time.\n \t *\/\n-\tif ((error = xfs_iget(mp, NULL, ino, 0, XFS_ILOCK_EXCL, &ip, bno))) {\n+\tif ((error = xfs_iget(mp, NULL, ino, 0, XFS_ILOCK_EXCL, &ip))) {\n \t\t*res = BULKSTAT_RV_NOTHING;\n \t\treturn error;\n \t}\n@@ -1888,14 +1887,14 @@ xfs_qm_init_quotainos(\n \t\t    mp->m_sb.sb_uquotino != NULLFSINO) {\n \t\t\tASSERT(mp->m_sb.sb_uquotino > 0);\n \t\t\tif ((error = xfs_iget(mp, NULL, mp->m_sb.sb_uquotino,\n-\t\t\t\t\t     0, 0, &uip, 0)))\n+\t\t\t\t\t     0, 0, &uip)))\n \t\t\t\treturn XFS_ERROR(error);\n \t\t}\n \t\tif (XFS_IS_OQUOTA_ON(mp) &&\n \t\t    mp->m_sb.sb_gquotino != NULLFSINO) {\n \t\t\tASSERT(mp->m_sb.sb_gquotino > 0);\n \t\t\tif ((error = xfs_iget(mp, NULL, mp->m_sb.sb_gquotino,\n-\t\t\t\t\t     0, 0, &gip, 0))) {\n+\t\t\t\t\t     0, 0, &gip))) {\n \t\t\t\tif (uip)\n \t\t\t\t\tIRELE(uip);\n \t\t\t\treturn XFS_ERROR(error);\ndiff --git a\/fs\/xfs\/quota\/xfs_qm_syscalls.c b\/fs\/xfs\/quota\/xfs_qm_syscalls.c\nindex 99a2d8e0f173..b4487764e923 100644\n--- a\/fs\/xfs\/quota\/xfs_qm_syscalls.c\n+++ b\/fs\/xfs\/quota\/xfs_qm_syscalls.c\n@@ -262,7 +262,7 @@ xfs_qm_scall_trunc_qfiles(\n \t}\n \n \tif ((flags & XFS_DQ_USER) && mp->m_sb.sb_uquotino != NULLFSINO) {\n-\t\terror = xfs_iget(mp, NULL, mp->m_sb.sb_uquotino, 0, 0, &qip, 0);\n+\t\terror = xfs_iget(mp, NULL, mp->m_sb.sb_uquotino, 0, 0, &qip);\n \t\tif (!error) {\n \t\t\terror = xfs_truncate_file(mp, qip);\n \t\t\tIRELE(qip);\n@@ -271,7 +271,7 @@ xfs_qm_scall_trunc_qfiles(\n \n \tif ((flags & (XFS_DQ_GROUP|XFS_DQ_PROJ)) &&\n \t    mp->m_sb.sb_gquotino != NULLFSINO) {\n-\t\terror2 = xfs_iget(mp, NULL, mp->m_sb.sb_gquotino, 0, 0, &qip, 0);\n+\t\terror2 = xfs_iget(mp, NULL, mp->m_sb.sb_gquotino, 0, 0, &qip);\n \t\tif (!error2) {\n \t\t\terror2 = xfs_truncate_file(mp, qip);\n \t\t\tIRELE(qip);\n@@ -417,12 +417,12 @@ xfs_qm_scall_getqstat(\n \t}\n \tif (!uip && mp->m_sb.sb_uquotino != NULLFSINO) {\n \t\tif (xfs_iget(mp, NULL, mp->m_sb.sb_uquotino,\n-\t\t\t\t\t0, 0, &uip, 0) == 0)\n+\t\t\t\t\t0, 0, &uip) == 0)\n \t\t\ttempuqip = B_TRUE;\n \t}\n \tif (!gip && mp->m_sb.sb_gquotino != NULLFSINO) {\n \t\tif (xfs_iget(mp, NULL, mp->m_sb.sb_gquotino,\n-\t\t\t\t\t0, 0, &gip, 0) == 0)\n+\t\t\t\t\t0, 0, &gip) == 0)\n \t\t\ttempgqip = B_TRUE;\n \t}\n \tif (uip) {\n@@ -1109,7 +1109,6 @@ xfs_qm_internalqcheck_adjust(\n \txfs_ino_t\tino,\t\t\/* inode number to get data for *\/\n \tvoid\t\t__user *buffer,\t\/* not used *\/\n \tint\t\tubsize,\t\t\/* not used *\/\n-\txfs_daddr_t\tbno,\t\t\/* starting block of inode cluster *\/\n \tint\t\t*ubused,\t\/* not used *\/\n \tint\t\t*res)\t\t\/* bulkstat result code *\/\n {\n@@ -1132,7 +1131,7 @@ xfs_qm_internalqcheck_adjust(\n \tipreleased = B_FALSE;\n  again:\n \tlock_flags = XFS_ILOCK_SHARED;\n-\tif ((error = xfs_iget(mp, NULL, ino, 0, lock_flags, &ip, bno))) {\n+\tif ((error = xfs_iget(mp, NULL, ino, 0, lock_flags, &ip))) {\n \t\t*res = BULKSTAT_RV_NOTHING;\n \t\treturn (error);\n \t}\ndiff --git a\/fs\/xfs\/xfs_ialloc.c b\/fs\/xfs\/xfs_ialloc.c\nindex d8fd36685eb9..c7142a064c48 100644\n--- a\/fs\/xfs\/xfs_ialloc.c\n+++ b\/fs\/xfs\/xfs_ialloc.c\n@@ -1354,22 +1354,6 @@ xfs_imap(\n \t\treturn 0;\n \t}\n \n-\t\/*\n-\t * If we get a block number passed we can use it to\n-\t * find the buffer easily.\n-\t *\/\n-\tif (imap->im_blkno) {\n-\t\toffset = XFS_INO_TO_OFFSET(mp, ino);\n-\t\tASSERT(offset < mp->m_sb.sb_inopblock);\n-\n-\t\tcluster_agbno = xfs_daddr_to_agbno(mp, imap->im_blkno);\n-\t\toffset += (agbno - cluster_agbno) * mp->m_sb.sb_inopblock;\n-\n-\t\timap->im_len = XFS_FSB_TO_BB(mp, blks_per_cluster);\n-\t\timap->im_boffset = (ushort)(offset << mp->m_sb.sb_inodelog);\n-\t\treturn 0;\n-\t}\n-\n \t\/*\n \t * If the inode chunks are aligned then use simple maths to\n \t * find the location. Otherwise we have to do a btree\ndiff --git a\/fs\/xfs\/xfs_iget.c b\/fs\/xfs\/xfs_iget.c\nindex 75df75f43d48..8f8b91be2c99 100644\n--- a\/fs\/xfs\/xfs_iget.c\n+++ b\/fs\/xfs\/xfs_iget.c\n@@ -259,7 +259,6 @@ xfs_iget_cache_miss(\n \txfs_trans_t\t\t*tp,\n \txfs_ino_t\t\tino,\n \tstruct xfs_inode\t**ipp,\n-\txfs_daddr_t\t\tbno,\n \tint\t\t\tflags,\n \tint\t\t\tlock_flags)\n {\n@@ -272,7 +271,7 @@ xfs_iget_cache_miss(\n \tif (!ip)\n \t\treturn ENOMEM;\n \n-\terror = xfs_iread(mp, tp, ip, bno, flags);\n+\terror = xfs_iread(mp, tp, ip, flags);\n \tif (error)\n \t\tgoto out_destroy;\n \n@@ -358,8 +357,6 @@ out_destroy:\n  *        within the file system for the inode being requested.\n  * lock_flags -- flags indicating how to lock the inode.  See the comment\n  *\t\t for xfs_ilock() for a list of valid values.\n- * bno -- the block number starting the buffer containing the inode,\n- *\t  if known (as by bulkstat), else 0.\n  *\/\n int\n xfs_iget(\n@@ -368,8 +365,7 @@ xfs_iget(\n \txfs_ino_t\tino,\n \tuint\t\tflags,\n \tuint\t\tlock_flags,\n-\txfs_inode_t\t**ipp,\n-\txfs_daddr_t\tbno)\n+\txfs_inode_t\t**ipp)\n {\n \txfs_inode_t\t*ip;\n \tint\t\terror;\n@@ -397,7 +393,7 @@ again:\n \t\tread_unlock(&pag->pag_ici_lock);\n \t\tXFS_STATS_INC(xs_ig_missed);\n \n-\t\terror = xfs_iget_cache_miss(mp, pag, tp, ino, &ip, bno,\n+\t\terror = xfs_iget_cache_miss(mp, pag, tp, ino, &ip,\n \t\t\t\t\t\t\tflags, lock_flags);\n \t\tif (error)\n \t\t\tgoto out_error_or_again;\ndiff --git a\/fs\/xfs\/xfs_inode.c b\/fs\/xfs\/xfs_inode.c\nindex 12c277a5e98a..b76a829d7e20 100644\n--- a\/fs\/xfs\/xfs_inode.c\n+++ b\/fs\/xfs\/xfs_inode.c\n@@ -787,7 +787,6 @@ xfs_iread(\n \txfs_mount_t\t*mp,\n \txfs_trans_t\t*tp,\n \txfs_inode_t\t*ip,\n-\txfs_daddr_t\tbno,\n \tuint\t\tiget_flags)\n {\n \txfs_buf_t\t*bp;\n@@ -797,11 +796,9 @@ xfs_iread(\n \t\/*\n \t * Fill in the location information in the in-core inode.\n \t *\/\n-\tip->i_imap.im_blkno = bno;\n \terror = xfs_imap(mp, tp, ip->i_ino, &ip->i_imap, iget_flags);\n \tif (error)\n \t\treturn error;\n-\tASSERT(bno == 0 || bno == ip->i_imap.im_blkno);\n \n \t\/*\n \t * Get pointers to the on-disk inode and the buffer containing it.\ndiff --git a\/fs\/xfs\/xfs_inode.h b\/fs\/xfs\/xfs_inode.h\nindex 6b31b38244ab..78550df13cd6 100644\n--- a\/fs\/xfs\/xfs_inode.h\n+++ b\/fs\/xfs\/xfs_inode.h\n@@ -442,7 +442,7 @@ static inline void xfs_ifunlock(xfs_inode_t *ip)\n  * xfs_iget.c prototypes.\n  *\/\n int\t\txfs_iget(struct xfs_mount *, struct xfs_trans *, xfs_ino_t,\n-\t\t\t uint, uint, xfs_inode_t **, xfs_daddr_t);\n+\t\t\t uint, uint, xfs_inode_t **);\n void\t\txfs_iput(xfs_inode_t *, uint);\n void\t\txfs_iput_new(xfs_inode_t *, uint);\n void\t\txfs_ilock(xfs_inode_t *, uint);\n@@ -509,7 +509,7 @@ int\t\txfs_itobp(struct xfs_mount *, struct xfs_trans *,\n \t\t\t  struct xfs_inode *, struct xfs_dinode **,\n \t\t\t  struct xfs_buf **, uint);\n int\t\txfs_iread(struct xfs_mount *, struct xfs_trans *,\n-\t\t\t  struct xfs_inode *, xfs_daddr_t, uint);\n+\t\t\t  struct xfs_inode *, uint);\n void\t\txfs_dinode_to_disk(struct xfs_dinode *,\n \t\t\t\t   struct xfs_icdinode *);\n void\t\txfs_idestroy_fork(struct xfs_inode *, int);\ndiff --git a\/fs\/xfs\/xfs_itable.c b\/fs\/xfs\/xfs_itable.c\nindex 2acd12fd3f25..2b86f8610512 100644\n--- a\/fs\/xfs\/xfs_itable.c\n+++ b\/fs\/xfs\/xfs_itable.c\n@@ -60,7 +60,6 @@ xfs_bulkstat_one_int(\n \tvoid __user\t\t*buffer,\t\/* buffer to place output in *\/\n \tint\t\t\tubsize,\t\t\/* size of buffer *\/\n \tbulkstat_one_fmt_pf\tformatter,\t\/* formatter, copy to user *\/\n-\txfs_daddr_t\t\tbno,\t\t\/* starting bno of cluster *\/\n \tint\t\t\t*ubused,\t\/* bytes used by me *\/\n \tint\t\t\t*stat)\t\t\/* BULKSTAT_RV_... *\/\n {\n@@ -80,7 +79,7 @@ xfs_bulkstat_one_int(\n \t\treturn XFS_ERROR(ENOMEM);\n \n \terror = xfs_iget(mp, NULL, ino,\n-\t\t\t XFS_IGET_UNTRUSTED, XFS_ILOCK_SHARED, &ip, bno);\n+\t\t\t XFS_IGET_UNTRUSTED, XFS_ILOCK_SHARED, &ip);\n \tif (error) {\n \t\t*stat = BULKSTAT_RV_NOTHING;\n \t\tgoto out_free;\n@@ -179,13 +178,11 @@ xfs_bulkstat_one(\n \txfs_ino_t\tino,\t\t\/* inode number to get data for *\/\n \tvoid\t\t__user *buffer,\t\/* buffer to place output in *\/\n \tint\t\tubsize,\t\t\/* size of buffer *\/\n-\txfs_daddr_t\tbno,\t\t\/* starting bno of inode cluster *\/\n \tint\t\t*ubused,\t\/* bytes used by me *\/\n \tint\t\t*stat)\t\t\/* BULKSTAT_RV_... *\/\n {\n \treturn xfs_bulkstat_one_int(mp, ino, buffer, ubsize,\n-\t\t\t\t    xfs_bulkstat_one_fmt, bno,\n-\t\t\t\t    ubused, stat);\n+\t\t\t\t    xfs_bulkstat_one_fmt, ubused, stat);\n }\n \n #define XFS_BULKSTAT_UBLEFT(ubleft)\t((ubleft) >= statstruct_size)\n@@ -485,7 +482,7 @@ xfs_bulkstat(\n \t\t\t\t * Get the inode and fill in a single buffer.\n \t\t\t\t *\/\n \t\t\t\tubused = statstruct_size;\n-\t\t\t\terror = formatter(mp, ino, ubufp, ubleft, bno,\n+\t\t\t\terror = formatter(mp, ino, ubufp, ubleft,\n \t\t\t\t\t\t  &ubused, &fmterror);\n \t\t\t\tif (fmterror == BULKSTAT_RV_NOTHING) {\n \t\t\t\t\tif (error && error != ENOENT &&\n@@ -578,8 +575,7 @@ xfs_bulkstat_single(\n \t *\/\n \n \tino = (xfs_ino_t)*lastinop;\n-\terror = xfs_bulkstat_one(mp, ino, buffer, sizeof(xfs_bstat_t),\n-\t\t\t\t 0, NULL, &res);\n+\terror = xfs_bulkstat_one(mp, ino, buffer, sizeof(xfs_bstat_t), 0, &res);\n \tif (error) {\n \t\t\/*\n \t\t * Special case way failed, do it the \"long\" way\ndiff --git a\/fs\/xfs\/xfs_itable.h b\/fs\/xfs\/xfs_itable.h\nindex fea03397a3ab..97295d91d170 100644\n--- a\/fs\/xfs\/xfs_itable.h\n+++ b\/fs\/xfs\/xfs_itable.h\n@@ -27,7 +27,6 @@ typedef int (*bulkstat_one_pf)(struct xfs_mount\t*mp,\n \t\t\t       xfs_ino_t\tino,\n \t\t\t       void\t\t__user *buffer,\n \t\t\t       int\t\tubsize,\n-\t\t\t       xfs_daddr_t\tbno,\n \t\t\t       int\t\t*ubused,\n \t\t\t       int\t\t*stat);\n \n@@ -71,7 +70,6 @@ xfs_bulkstat_one_int(\n \tvoid\t\t\t__user *buffer,\n \tint\t\t\tubsize,\n \tbulkstat_one_fmt_pf\tformatter,\n-\txfs_daddr_t\t\tbno,\n \tint\t\t\t*ubused,\n \tint\t\t\t*stat);\n \n@@ -81,7 +79,6 @@ xfs_bulkstat_one(\n \txfs_ino_t\t\tino,\n \tvoid\t\t\t__user *buffer,\n \tint\t\t\tubsize,\n-\txfs_daddr_t\t\tbno,\n \tint\t\t\t*ubused,\n \tint\t\t\t*stat);\n \ndiff --git a\/fs\/xfs\/xfs_log_recover.c b\/fs\/xfs\/xfs_log_recover.c\nindex ed0684cc50ee..9ac5cfab27b9 100644\n--- a\/fs\/xfs\/xfs_log_recover.c\n+++ b\/fs\/xfs\/xfs_log_recover.c\n@@ -3198,7 +3198,7 @@ xlog_recover_process_one_iunlink(\n \tint\t\t\t\terror;\n \n \tino = XFS_AGINO_TO_INO(mp, agno, agino);\n-\terror = xfs_iget(mp, NULL, ino, 0, 0, &ip, 0);\n+\terror = xfs_iget(mp, NULL, ino, 0, 0, &ip);\n \tif (error)\n \t\tgoto fail;\n \ndiff --git a\/fs\/xfs\/xfs_mount.c b\/fs\/xfs\/xfs_mount.c\nindex d59f4e8bedcf..69f62d8b2816 100644\n--- a\/fs\/xfs\/xfs_mount.c\n+++ b\/fs\/xfs\/xfs_mount.c\n@@ -1300,7 +1300,7 @@ xfs_mountfs(\n \t * Get and sanity-check the root inode.\n \t * Save the pointer to it in the mount structure.\n \t *\/\n-\terror = xfs_iget(mp, NULL, sbp->sb_rootino, 0, XFS_ILOCK_EXCL, &rip, 0);\n+\terror = xfs_iget(mp, NULL, sbp->sb_rootino, 0, XFS_ILOCK_EXCL, &rip);\n \tif (error) {\n \t\tcmn_err(CE_WARN, \"XFS: failed to read root inode\");\n \t\tgoto out_log_dealloc;\ndiff --git a\/fs\/xfs\/xfs_rtalloc.c b\/fs\/xfs\/xfs_rtalloc.c\nindex 16445518506d..a2d32ce335aa 100644\n--- a\/fs\/xfs\/xfs_rtalloc.c\n+++ b\/fs\/xfs\/xfs_rtalloc.c\n@@ -2277,12 +2277,12 @@ xfs_rtmount_inodes(\n \tsbp = &mp->m_sb;\n \tif (sbp->sb_rbmino == NULLFSINO)\n \t\treturn 0;\n-\terror = xfs_iget(mp, NULL, sbp->sb_rbmino, 0, 0, &mp->m_rbmip, 0);\n+\terror = xfs_iget(mp, NULL, sbp->sb_rbmino, 0, 0, &mp->m_rbmip);\n \tif (error)\n \t\treturn error;\n \tASSERT(mp->m_rbmip != NULL);\n \tASSERT(sbp->sb_rsumino != NULLFSINO);\n-\terror = xfs_iget(mp, NULL, sbp->sb_rsumino, 0, 0, &mp->m_rsumip, 0);\n+\terror = xfs_iget(mp, NULL, sbp->sb_rsumino, 0, 0, &mp->m_rsumip);\n \tif (error) {\n \t\tIRELE(mp->m_rbmip);\n \t\treturn error;\ndiff --git a\/fs\/xfs\/xfs_trans_inode.c b\/fs\/xfs\/xfs_trans_inode.c\nindex 785ff101da0a..2559dfec946b 100644\n--- a\/fs\/xfs\/xfs_trans_inode.c\n+++ b\/fs\/xfs\/xfs_trans_inode.c\n@@ -62,7 +62,7 @@ xfs_trans_iget(\n {\n \tint\t\t\terror;\n \n-\terror = xfs_iget(mp, tp, ino, flags, lock_flags, ipp, 0);\n+\terror = xfs_iget(mp, tp, ino, flags, lock_flags, ipp);\n \tif (!error && tp)\n \t\txfs_trans_ijoin(tp, *ipp, lock_flags);\n \treturn error;\ndiff --git a\/fs\/xfs\/xfs_vnodeops.c b\/fs\/xfs\/xfs_vnodeops.c\nindex a06bd62504fc..c1646838898f 100644\n--- a\/fs\/xfs\/xfs_vnodeops.c\n+++ b\/fs\/xfs\/xfs_vnodeops.c\n@@ -1269,7 +1269,7 @@ xfs_lookup(\n \tif (error)\n \t\tgoto out;\n \n-\terror = xfs_iget(dp->i_mount, NULL, inum, 0, 0, ipp, 0);\n+\terror = xfs_iget(dp->i_mount, NULL, inum, 0, 0, ipp);\n \tif (error)\n \t\tgoto out_free_name;\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2015-4176","CWE_ID":"200","category":"security","commit_id":"e0c9c0afd2fc958ffa34b697972721d81df8a56f","commit_message":"From e0c9c0afd2fc958ffa34b697972721d81df8a56f Mon Sep 17 00:00:00 2001\nFrom: \"Eric W. Biederman\" <ebiederm@xmission.com>\nDate: Wed, 1 Apr 2015 18:30:06 -0500\nSubject: [PATCH] mnt: Update detach_mounts to leave mounts connected\n\nNow that it is possible to lazily unmount an entire mount tree and\nleave the individual mounts connected to each other add a new flag\nUMOUNT_CONNECTED to umount_tree to force this behavior and use\nthis flag in detach_mounts.\n\nThis closes a bug where the deletion of a file or directory could\ntrigger an unmount and reveal data under a mount point.\n\nCc: stable@vger.kernel.org\nSigned-off-by: \"Eric W. Biederman\" <ebiederm@xmission.com>\n---\n fs\/namespace.c | 8 ++++++--\n 1 file changed, 6 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/fs\/namespace.c b\/fs\/namespace.c\nindex e8f7f8c58c3c6..1f4f9dac6e5af 100644\n--- a\/fs\/namespace.c\n+++ b\/fs\/namespace.c\n@@ -1348,6 +1348,7 @@ static inline void namespace_lock(void)\n enum umount_tree_flags {\n \tUMOUNT_SYNC = 1,\n \tUMOUNT_PROPAGATE = 2,\n+\tUMOUNT_CONNECTED = 4,\n };\n \/*\n  * mount_lock must be held\n@@ -1386,7 +1387,10 @@ static void umount_tree(struct mount *mnt, enum umount_tree_flags how)\n \t\tif (how & UMOUNT_SYNC)\n \t\t\tp->mnt.mnt_flags |= MNT_SYNC_UMOUNT;\n \n-\t\tdisconnect = !IS_MNT_LOCKED_AND_LAZY(p);\n+\t\tdisconnect = !(((how & UMOUNT_CONNECTED) &&\n+\t\t\t\tmnt_has_parent(p) &&\n+\t\t\t\t(p->mnt_parent->mnt.mnt_flags & MNT_UMOUNT)) ||\n+\t\t\t       IS_MNT_LOCKED_AND_LAZY(p));\n \n \t\tpin_insert_group(&p->mnt_umount, &p->mnt_parent->mnt,\n \t\t\t\t disconnect ? &unmounted : NULL);\n@@ -1529,7 +1533,7 @@ void __detach_mounts(struct dentry *dentry)\n \t\t\t\tumount_mnt(p);\n \t\t\t}\n \t\t}\n-\t\telse umount_tree(mnt, 0);\n+\t\telse umount_tree(mnt, UMOUNT_CONNECTED);\n \t}\n \tunlock_mount_hash();\n \tput_mountpoint(mp);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-3232","CWE_ID":"200","category":"security","commit_id":"3ce5efad47b62c57a4f5c54248347085a750ce0e","commit_message":"From 3ce5efad47b62c57a4f5c54248347085a750ce0e Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:57 +0000\nSubject: netrom: fix info leak via msg_name in nr_recvmsg()\n\nIn case msg_name is set the sockaddr info gets filled out, as\nrequested, but the code fails to initialize the padding bytes of\nstruct sockaddr_ax25 inserted by the compiler for alignment. Also\nthe sax25_ndigis member does not get assigned, leaking four more\nbytes.\n\nBoth issues lead to the fact that the code will leak uninitialized\nkernel stack bytes in net\/socket.c.\n\nFix both issues by initializing the memory with memset(0).\n\nCc: Ralf Baechle <ralf@linux-mips.org>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/netrom\/af_netrom.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/netrom\/af_netrom.c b\/net\/netrom\/af_netrom.c\nindex d1fa1d9ffd2e..7fcb307dea47 100644\n--- a\/net\/netrom\/af_netrom.c\n+++ b\/net\/netrom\/af_netrom.c\n@@ -1173,6 +1173,7 @@ static int nr_recvmsg(struct kiocb *iocb, struct socket *sock,\n \t}\n \n \tif (sax != NULL) {\n+\t\tmemset(sax, 0, sizeof(sax));\n \t\tsax->sax25_family = AF_NETROM;\n \t\tskb_copy_from_linear_data_offset(skb, 7, sax->sax25_call.ax25_call,\n \t\t\t      AX25_ADDR_LEN);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"mjg59","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-6494","CWE_ID":"200","category":"security","commit_id":"035cf2afc04988b22cb67f4ebfd77e9b344cb6e0","commit_message":"From 035cf2afc04988b22cb67f4ebfd77e9b344cb6e0 Mon Sep 17 00:00:00 2001\nFrom: Kevin Pulo <kevin.pulo@mongodb.com>\nDate: Tue, 6 Sep 2016 11:44:20 +1000\nSubject: [PATCH] SERVER-25335 avoid group and other permissions when creating\n .dbshell history file\n\n---\n jstests\/noPassthrough\/shell_history.js | 103 +++++++++++++++++++++++++\n src\/mongo\/shell\/linenoise.cpp          |  14 +++-\n 2 files changed, 115 insertions(+), 2 deletions(-)\n create mode 100644 jstests\/noPassthrough\/shell_history.js\n\n","diff_code":"diff --git a\/jstests\/noPassthrough\/shell_history.js b\/jstests\/noPassthrough\/shell_history.js\nnew file mode 100644\nindex 00000000000..72300a7d8a0\n--- \/dev\/null\n+++ b\/jstests\/noPassthrough\/shell_history.js\n@@ -0,0 +1,103 @@\n+\/\/ Test that when running the shell for the first time creates the ~\/.dbshell file, and it has\n+\/\/ appropriate permissions (where relevant).\n+\n+(function() {\n+    \"use strict\";\n+\n+    \/\/ Use dataPath because it includes the trailing \"\/\" or \"\\\".\n+    var tmpHome = MongoRunner.dataPath;\n+    \/\/ Ensure it exists and is a dir (eg. if running without resmoke.py and \/data\/db doesn't exist).\n+    mkdir(tmpHome);\n+    removeFile(tmpHome + \".dbshell\");\n+\n+    var args = [];\n+    var cmdline = \"mongo --nodb\";\n+    var redirection = \"\";\n+    var env = {};\n+    if (_isWindows()) {\n+        args.push(\"cmd.exe\");\n+        args.push(\"\/c\");\n+\n+        \/\/ Input is set to NUL.  The output must also be redirected to NUL, otherwise running the\n+        \/\/ jstest manually has strange terminal IO behaviour.\n+        redirection = \"< NUL > NUL\";\n+\n+        \/\/ USERPROFILE set to the tmp homedir.\n+        \/\/ Since NUL is a character device, isatty() will return true, which means that .mongorc.js\n+        \/\/ will be created in the HOMEDRIVE + HOMEPATH location, so we must set them also.\n+        if (tmpHome.match(\"^[a-zA-Z]:\")) {\n+            var tmpHomeDrive = tmpHome.substr(0, 2);\n+            var tmpHomePath = tmpHome.substr(2);\n+        } else {\n+            var _pwd = pwd();\n+            assert(_pwd.match(\"^[a-zA-Z]:\"), \"pwd must include drive\");\n+            var tmpHomeDrive = _pwd.substr(0, 2);\n+            var tmpHomePath = tmpHome;\n+        }\n+        env = {USERPROFILE: tmpHome, HOMEDRIVE: tmpHomeDrive, HOMEPATH: tmpHomePath};\n+\n+    } else {\n+        args.push(\"sh\");\n+        args.push(\"-c\");\n+\n+        \/\/ Use the mongo shell from the current dir, same as resmoke.py does.\n+        \/\/ Doesn't handle resmoke's --mongo= option.\n+        cmdline = \".\/\" + cmdline;\n+\n+        \/\/ Set umask to 0 prior to running the shell.\n+        cmdline = \"umask 0 ; \" + cmdline;\n+\n+        \/\/ stdin is \/dev\/null.\n+        redirection = \"< \/dev\/null\";\n+\n+        \/\/ HOME set to the tmp homedir.\n+        if (!tmpHome.startsWith(\"\/\")) {\n+            tmpHome = pwd() + \"\/\" + tmpHome;\n+        }\n+        env = {HOME: tmpHome};\n+    }\n+\n+    \/\/ Add redirection to cmdline, and add cmdline to args.\n+    cmdline += \" \" + redirection;\n+    args.push(cmdline);\n+    jsTestLog(\"Running args:\\n    \" + tojson(args) + \"\\nwith env:\\n    \" + tojson(env));\n+    var pid = _startMongoProgram({args, env});\n+    var rc = waitProgram(pid);\n+\n+    assert.eq(rc, 0);\n+\n+    var files = listFiles(tmpHome);\n+    jsTestLog(tojson(files));\n+\n+    var findFile = function(baseName) {\n+        for (var i = 0; i < files.length; i++) {\n+            if (files[i].baseName === baseName) {\n+                return files[i];\n+            }\n+        }\n+        return undefined;\n+    };\n+\n+    var targetFile = \".dbshell\";\n+    var file = findFile(targetFile);\n+\n+    assert.neq(typeof(file), \"undefined\", targetFile + \" should exist, but it doesn't\");\n+    assert.eq(file.isDirectory, false, targetFile + \" should not be a directory, but it is\");\n+    assert.eq(file.size, 0, targetFile + \" should be empty, but it isn't\");\n+\n+    if (!_isWindows()) {\n+        \/\/ On Unix, check that the file has the correct mode (permissions).\n+        \/\/ The shell has no way to stat a file.\n+        \/\/ There is no stat utility in POSIX.\n+        \/\/ `ls -l` is POSIX, so this is the best that we have.\n+        \/\/ Check for exactly \"-rw-------\".\n+        clearRawMongoProgramOutput();\n+        var rc = runProgram(\"ls\", \"-l\", file.name);\n+        assert.eq(rc, 0);\n+        var output = rawMongoProgramOutput();\n+        var fields = output.split(\" \");\n+        \/\/ First field is the prefix, second field is the `ls -l` permissions.\n+        assert.eq(fields[1], \"-rw-------\", targetFile + \" has bad permissions\");\n+    }\n+\n+})();\ndiff --git a\/src\/mongo\/shell\/linenoise.cpp b\/src\/mongo\/shell\/linenoise.cpp\nindex f75028c8845..8b70214ac5b 100644\n--- a\/src\/mongo\/shell\/linenoise.cpp\n+++ b\/src\/mongo\/shell\/linenoise.cpp\n@@ -2762,7 +2762,17 @@ int linenoiseHistorySetMaxLen(int len) {\n \/* Save the history in the specified file. On success 0 is returned\n  * otherwise -1 is returned. *\/\n int linenoiseHistorySave(const char* filename) {\n-    FILE* fp = fopen(filename, \"wt\");\n+    FILE* fp;\n+#if _POSIX_C_SOURCE >= 1 || _XOPEN_SOURCE || _POSIX_SOURCE\n+    int fd = open(filename, O_CREAT, S_IRUSR | S_IWUSR);\n+    if (fd == -1) {\n+        \/\/ report errno somehow?\n+        return -1;\n+    }\n+    fp = fdopen(fd, \"wt\");\n+#else\n+    fp = fopen(filename, \"wt\");\n+#endif  \/\/ _POSIX_C_SOURCE >= 1 || _XOPEN_SOURCE || _POSIX_SOURCE\n     if (fp == NULL) {\n         return -1;\n     }\n@@ -2772,7 +2782,7 @@ int linenoiseHistorySave(const char* filename) {\n             fprintf(fp, \"%s\\n\", history[j]);\n         }\n     }\n-    fclose(fp);\n+    fclose(fp);  \/\/ Also causes fd to be closed.\n     return 0;\n }\n \n","owner":"mongodb","repo":"mongo","source":"cve"},{"CVE_ID":"CVE-2010-3875","CWE_ID":"200","category":"security","commit_id":"fe10ae53384e48c51996941b7720ee16995cbcb7","commit_message":"From fe10ae53384e48c51996941b7720ee16995cbcb7 Mon Sep 17 00:00:00 2001\nFrom: Vasiliy Kulikov <segooon@gmail.com>\nDate: Wed, 10 Nov 2010 10:14:33 -0800\nSubject: net: ax25: fix information leak to userland\n\nSometimes ax25_getname() doesn't initialize all members of fsa_digipeater\nfield of fsa struct, also the struct has padding bytes between\nsax25_call and sax25_ndigis fields.  This structure is then copied to\nuserland.  It leads to leaking of contents of kernel stack memory.\n\nSigned-off-by: Vasiliy Kulikov <segooon@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/ax25\/af_ax25.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/ax25\/af_ax25.c b\/net\/ax25\/af_ax25.c\nindex 26eaebf4aaa9..bb86d2932394 100644\n--- a\/net\/ax25\/af_ax25.c\n+++ b\/net\/ax25\/af_ax25.c\n@@ -1392,6 +1392,7 @@ static int ax25_getname(struct socket *sock, struct sockaddr *uaddr,\n \tax25_cb *ax25;\n \tint err = 0;\n \n+\tmemset(fsa, 0, sizeof(fsa));\n \tlock_sock(sk);\n \tax25 = ax25_sk(sk);\n \n@@ -1403,7 +1404,6 @@ static int ax25_getname(struct socket *sock, struct sockaddr *uaddr,\n \n \t\tfsa->fsa_ax25.sax25_family = AF_AX25;\n \t\tfsa->fsa_ax25.sax25_call   = ax25->dest_addr;\n-\t\tfsa->fsa_ax25.sax25_ndigis = 0;\n \n \t\tif (ax25->digipeat != NULL) {\n \t\t\tndigi = ax25->digipeat->ndigi;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2007-3850","CWE_ID":"200","category":"security","commit_id":"721151d004dcf01a71b12bb6b893f9160284cf6e","commit_message":"From 721151d004dcf01a71b12bb6b893f9160284cf6e Mon Sep 17 00:00:00 2001\nFrom: Paul Mackerras <paulus@samba.org>\nDate: Tue, 3 Apr 2007 21:24:02 +1000\nSubject: [POWERPC] Allow drivers to map individual 4k pages to userspace\n\nSome drivers have resources that they want to be able to map into\nuserspace that are 4k in size.  On a kernel configured with 64k pages\nwe currently end up mapping the 4k we want plus another 60k of\nphysical address space, which could contain anything.  This can\nintroduce security problems, for example in the case of an infiniband\nadaptor where the other 60k could contain registers that some other\nprogram is using for its communications.\n\nThis patch adds a new function, remap_4k_pfn, which drivers can use to\nmap a single 4k page to userspace regardless of whether the kernel is\nusing a 4k or a 64k page size.  Like remap_pfn_range, it would\ntypically be called in a driver's mmap function.  It only maps a\nsingle 4k page, which on a 64k page kernel appears replicated 16 times\nthroughout a 64k page.  On a 4k page kernel it reduces to a call to\nremap_pfn_range.\n\nThe way this works on a 64k kernel is that a new bit, _PAGE_4K_PFN,\ngets set on the linux PTE.  This alters the way that __hash_page_4K\ncomputes the real address to put in the HPTE.  The RPN field of the\nlinux PTE becomes the 4k RPN directly rather than being interpreted as\na 64k RPN.  Since the RPN field is 32 bits, this means that physical\naddresses being mapped with remap_4k_pfn have to be below 2^44,\ni.e. 0x100000000000.\n\nThe patch also factors out the code in arch\/powerpc\/mm\/hash_utils_64.c\nthat deals with demoting a process to use 4k pages into one function\nthat gets called in the various different places where we need to do\nthat.  There were some discrepancies between exactly what was done in\nthe various places, such as a call to spu_flush_all_slbs in one case\nbut not in others.\n\nSigned-off-by: Paul Mackerras <paulus@samba.org>\n---\n arch\/powerpc\/mm\/hash_low_64.S     |  5 ++++-\n arch\/powerpc\/mm\/hash_utils_64.c   | 43 +++++++++++++++++++++++++++------------\n include\/asm-powerpc\/pgtable-4k.h  |  3 +++\n include\/asm-powerpc\/pgtable-64k.h |  5 +++++\n 4 files changed, 42 insertions(+), 14 deletions(-)\n\n","diff_code":"diff --git a\/arch\/powerpc\/mm\/hash_low_64.S b\/arch\/powerpc\/mm\/hash_low_64.S\nindex 9bc0a9c2b9bc..e64ce3eec36e 100644\n--- a\/arch\/powerpc\/mm\/hash_low_64.S\n+++ b\/arch\/powerpc\/mm\/hash_low_64.S\n@@ -445,9 +445,12 @@ END_FTR_SECTION(CPU_FTR_NOEXECUTE|CPU_FTR_COHERENT_ICACHE, CPU_FTR_NOEXECUTE)\n \n htab_insert_pte:\n \t\/* real page number in r5, PTE RPN value + index *\/\n-\trldicl\tr5,r31,64-PTE_RPN_SHIFT,PTE_RPN_SHIFT\n+\tandis.\tr0,r31,_PAGE_4K_PFN@h\n+\tsrdi\tr5,r31,PTE_RPN_SHIFT\n+\tbne-\thtab_special_pfn\n \tsldi\tr5,r5,PAGE_SHIFT-HW_PAGE_SHIFT\n \tadd\tr5,r5,r25\n+htab_special_pfn:\n \tsldi\tr5,r5,HW_PAGE_SHIFT\n \n \t\/* Calculate primary group hash *\/\ndiff --git a\/arch\/powerpc\/mm\/hash_utils_64.c b\/arch\/powerpc\/mm\/hash_utils_64.c\nindex 3c7fe2c65b5a..aae085317018 100644\n--- a\/arch\/powerpc\/mm\/hash_utils_64.c\n+++ b\/arch\/powerpc\/mm\/hash_utils_64.c\n@@ -573,6 +573,27 @@ unsigned int hash_page_do_lazy_icache(unsigned int pp, pte_t pte, int trap)\n \treturn pp;\n }\n \n+\/*\n+ * Demote a segment to using 4k pages.\n+ * For now this makes the whole process use 4k pages.\n+ *\/\n+void demote_segment_4k(struct mm_struct *mm, unsigned long addr)\n+{\n+#ifdef CONFIG_PPC_64K_PAGES\n+\tif (mm->context.user_psize == MMU_PAGE_4K)\n+\t\treturn;\n+\tmm->context.user_psize = MMU_PAGE_4K;\n+\tmm->context.sllp = SLB_VSID_USER | mmu_psize_defs[MMU_PAGE_4K].sllp;\n+\tget_paca()->context = mm->context;\n+\tslb_flush_and_rebolt();\n+#ifdef CONFIG_SPE_BASE\n+\tspu_flush_all_slbs(mm);\n+#endif\n+#endif\n+}\n+\n+EXPORT_SYMBOL_GPL(demote_segment_4k);\n+\n \/* Result code is:\n  *  0 - handled\n  *  1 - normal page fault\n@@ -665,15 +686,19 @@ int hash_page(unsigned long ea, unsigned long access, unsigned long trap)\n #ifndef CONFIG_PPC_64K_PAGES\n \trc = __hash_page_4K(ea, access, vsid, ptep, trap, local);\n #else\n+\t\/* If _PAGE_4K_PFN is set, make sure this is a 4k segment *\/\n+\tif (pte_val(*ptep) & _PAGE_4K_PFN) {\n+\t\tdemote_segment_4k(mm, ea);\n+\t\tpsize = MMU_PAGE_4K;\n+\t}\n+\n \tif (mmu_ci_restrictions) {\n \t\t\/* If this PTE is non-cacheable, switch to 4k *\/\n \t\tif (psize == MMU_PAGE_64K &&\n \t\t    (pte_val(*ptep) & _PAGE_NO_CACHE)) {\n \t\t\tif (user_region) {\n+\t\t\t\tdemote_segment_4k(mm, ea);\n \t\t\t\tpsize = MMU_PAGE_4K;\n-\t\t\t\tmm->context.user_psize = MMU_PAGE_4K;\n-\t\t\t\tmm->context.sllp = SLB_VSID_USER |\n-\t\t\t\t\tmmu_psize_defs[MMU_PAGE_4K].sllp;\n \t\t\t} else if (ea < VMALLOC_END) {\n \t\t\t\t\/*\n \t\t\t\t * some driver did a non-cacheable mapping\n@@ -756,16 +781,8 @@ void hash_preload(struct mm_struct *mm, unsigned long ea,\n \tif (mmu_ci_restrictions) {\n \t\t\/* If this PTE is non-cacheable, switch to 4k *\/\n \t\tif (mm->context.user_psize == MMU_PAGE_64K &&\n-\t\t    (pte_val(*ptep) & _PAGE_NO_CACHE)) {\n-\t\t\tmm->context.user_psize = MMU_PAGE_4K;\n-\t\t\tmm->context.sllp = SLB_VSID_USER |\n-\t\t\t\tmmu_psize_defs[MMU_PAGE_4K].sllp;\n-\t\t\tget_paca()->context = mm->context;\n-\t\t\tslb_flush_and_rebolt();\n-#ifdef CONFIG_SPE_BASE\n-\t\t\tspu_flush_all_slbs(mm);\n-#endif\n-\t\t}\n+\t\t    (pte_val(*ptep) & _PAGE_NO_CACHE))\n+\t\t\tdemote_segment_4k(mm, ea);\n \t}\n \tif (mm->context.user_psize == MMU_PAGE_64K)\n \t\t__hash_page_64K(ea, access, vsid, ptep, trap, local);\ndiff --git a\/include\/asm-powerpc\/pgtable-4k.h b\/include\/asm-powerpc\/pgtable-4k.h\nindex 345d9b07b3e2..a28fa8bc01da 100644\n--- a\/include\/asm-powerpc\/pgtable-4k.h\n+++ b\/include\/asm-powerpc\/pgtable-4k.h\n@@ -97,3 +97,6 @@\n \n #define pud_ERROR(e) \\\n \tprintk(\"%s:%d: bad pud %08lx.\\n\", __FILE__, __LINE__, pud_val(e))\n+\n+#define remap_4k_pfn(vma, addr, pfn, prot)\t\\\n+\tremap_pfn_range((vma), (addr), (pfn), PAGE_SIZE, (prot))\ndiff --git a\/include\/asm-powerpc\/pgtable-64k.h b\/include\/asm-powerpc\/pgtable-64k.h\nindex 4b7126c53f37..5e84f070eaf7 100644\n--- a\/include\/asm-powerpc\/pgtable-64k.h\n+++ b\/include\/asm-powerpc\/pgtable-64k.h\n@@ -35,6 +35,7 @@\n #define _PAGE_HPTE_SUB\t0x0ffff000 \/* combo only: sub pages HPTE bits *\/\n #define _PAGE_HPTE_SUB0\t0x08000000 \/* combo only: first sub page *\/\n #define _PAGE_COMBO\t0x10000000 \/* this is a combo 4k page *\/\n+#define _PAGE_4K_PFN\t0x20000000 \/* PFN is for a single 4k page *\/\n #define _PAGE_F_SECOND  0x00008000 \/* full page: hidx bits *\/\n #define _PAGE_F_GIX     0x00007000 \/* full page: hidx bits *\/\n \n@@ -93,6 +94,10 @@\n #define pte_pagesize_index(pte)\t\\\n \t(((pte) & _PAGE_COMBO)? MMU_PAGE_4K: MMU_PAGE_64K)\n \n+#define remap_4k_pfn(vma, addr, pfn, prot)\t\t\t\t\\\n+\tremap_pfn_range((vma), (addr), (pfn), PAGE_SIZE,\t\t\\\n+\t\t\t__pgprot(pgprot_val((prot)) | _PAGE_4K_PFN))\n+\n #endif \/*  __ASSEMBLY__ *\/\n #endif \/* __KERNEL__ *\/\n #endif \/* _ASM_POWERPC_PGTABLE_64K_H *\/\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-9993","CWE_ID":"200","category":"security","commit_id":"189ff4219644532bdfa7bab28dfedaee4d6d4021","commit_message":"From 189ff4219644532bdfa7bab28dfedaee4d6d4021 Mon Sep 17 00:00:00 2001\nFrom: Michael Niedermayer <michael@niedermayer.cc>\nDate: Sat, 3 Jun 2017 21:20:04 +0200\nSubject: [PATCH] avformat\/hls: Check local file extensions\n\nThis reduces the attack surface of local file-system\ninformation leaking.\n\nIt prevents the existing exploit leading to an information leak. As\nwell as similar hypothetical attacks.\n\nLeaks of information from files and symlinks ending in common multimedia extensions\nare still possible. But files with sensitive information like private keys and passwords\ngenerally do not use common multimedia filename extensions.\nIt does not stop leaks via remote addresses in the LAN.\n\nThe existing exploit depends on a specific decoder as well.\nIt does appear though that the exploit should be possible with any decoder.\nThe problem is that as long as sensitive information gets into the decoder,\nthe output of the decoder becomes sensitive as well.\nThe only obvious solution is to prevent access to sensitive information. Or to\ndisable hls or possibly some of its feature. More complex solutions like\nchecking the path to limit access to only subdirectories of the hls path may\nwork as an alternative. But such solutions are fragile and tricky to implement\nportably and would not stop every possible attack nor would they work with all\nvalid hls files.\n\nDevelopers have expressed their dislike \/ objected to disabling hls by default as well\nas disabling hls with local files. There also where objections against restricting\nremote url file extensions. This here is a less robust but also lower\ninconvenience solution.\nIt can be applied stand alone or together with other solutions.\nlimiting the check to local files was suggested by nevcairiel\n\nThis recommits the security fix without the author name joke which was\noriginally requested by Nicolas.\n\nFound-by: Emil Lerner and Pavel Cheremushkin\nReported-by: Thierry Foucu <tfoucu@google.com>\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n---\n libavformat\/hls.c | 18 +++++++++++++++++-\n 1 file changed, 17 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/libavformat\/hls.c b\/libavformat\/hls.c\nindex 4b8fb19a527..01731bd36b0 100644\n--- a\/libavformat\/hls.c\n+++ b\/libavformat\/hls.c\n@@ -204,6 +204,7 @@ typedef struct HLSContext {\n     char *http_proxy;                    \/\/\/< holds the address of the HTTP proxy server\n     AVDictionary *avio_opts;\n     int strict_std_compliance;\n+    char *allowed_extensions;\n } HLSContext;\n \n static int read_chomp_line(AVIOContext *s, char *buf, int maxlen)\n@@ -618,8 +619,19 @@ static int open_url(AVFormatContext *s, AVIOContext **pb, const char *url,\n         return AVERROR_INVALIDDATA;\n \n     \/\/ only http(s) & file are allowed\n-    if (!av_strstart(proto_name, \"http\", NULL) && !av_strstart(proto_name, \"file\", NULL))\n+    if (av_strstart(proto_name, \"file\", NULL)) {\n+        if (strcmp(c->allowed_extensions, \"ALL\") && !av_match_ext(url, c->allowed_extensions)) {\n+            av_log(s, AV_LOG_ERROR,\n+                \"Filename extension of \\'%s\\' is not a common multimedia extension, blocked for security reasons.\\n\"\n+                \"If you wish to override this adjust allowed_extensions, you can set it to \\'ALL\\' to allow all\\n\",\n+                url);\n+            return AVERROR_INVALIDDATA;\n+        }\n+    } else if (av_strstart(proto_name, \"http\", NULL)) {\n+        ;\n+    } else\n         return AVERROR_INVALIDDATA;\n+\n     if (!strncmp(proto_name, url, strlen(proto_name)) && url[strlen(proto_name)] == ':')\n         ;\n     else if (av_strstart(url, \"crypto\", NULL) && !strncmp(proto_name, url + 7, strlen(proto_name)) && url[7 + strlen(proto_name)] == ':')\n@@ -2134,6 +2146,10 @@ static int hls_probe(AVProbeData *p)\n static const AVOption hls_options[] = {\n     {\"live_start_index\", \"segment index to start live streams at (negative values are from the end)\",\n         OFFSET(live_start_index), AV_OPT_TYPE_INT, {.i64 = -3}, INT_MIN, INT_MAX, FLAGS},\n+    {\"allowed_extensions\", \"List of file extensions that hls is allowed to access\",\n+        OFFSET(allowed_extensions), AV_OPT_TYPE_STRING,\n+        {.str = \"3gp,aac,avi,flac,mkv,m3u8,m4a,m4s,m4v,mpg,mov,mp2,mp3,mp4,mpeg,mpegts,ogg,ogv,oga,ts,vob,wav\"},\n+        INT_MIN, INT_MAX, FLAGS},\n     {NULL}\n };\n \n","owner":"FFmpeg","repo":"FFmpeg","source":"cve"},{"CVE_ID":"CVE-2017-15652","CWE_ID":"200","category":"security","commit_id":"2fc463d0efbd044a8232611f0898eeb12b72a970","commit_message":"From 2fc463d0efbd044a8232611f0898eeb12b72a970 Mon Sep 17 00:00:00 2001\nFrom: Chris Liddell <chris.liddell@artifex.com>\nDate: Fri, 20 Oct 2017 14:16:44 +0100\nSubject: [PATCH] Bug 698676: have filenameforall permission check use\n \"reduced\" path\n\nPrevents working around SAFER file access permissions.\n\nCVE-2017-15652\n---\n psi\/zfile.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/psi\/zfile.c b\/psi\/zfile.c\nindex 458339d..00da24c 100644\n--- a\/psi\/zfile.c\n+++ b\/psi\/zfile.c\n@@ -410,7 +410,7 @@ file_continue(i_ctx_t *i_ctx_p)\n         } else if (code > len)      \/* overran string *\/\n             return_error(gs_error_rangecheck);\n         else if (iodev != iodev_default(imemory)\n-              || (check_file_permissions_reduced(i_ctx_p, (char *)pscratch->value.bytes, code + devlen, iodev, \"PermitFileReading\")) == 0) {\n+              || (check_file_permissions(i_ctx_p, (char *)pscratch->value.bytes, code + devlen, iodev, \"PermitFileReading\")) == 0) {\n             push(1);\n             ref_assign(op, pscratch);\n             r_set_size(op, code + devlen);\n-- \n2.9.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2010-3881","CWE_ID":"200","category":"security","commit_id":"831d9d02f9522e739825a51a11e3bc5aa531a905","commit_message":"From 831d9d02f9522e739825a51a11e3bc5aa531a905 Mon Sep 17 00:00:00 2001\nFrom: Vasiliy Kulikov <segooon@gmail.com>\nDate: Sat, 30 Oct 2010 22:54:47 +0400\nSubject: KVM: x86: fix information leak to userland\n\nStructures kvm_vcpu_events, kvm_debugregs, kvm_pit_state2 and\nkvm_clock_data are copied to userland with some padding and reserved\nfields unitialized.  It leads to leaking of contents of kernel stack\nmemory.  We have to initialize them to zero.\n\nIn patch v1 Jan Kiszka suggested to fill reserved fields with zeros\ninstead of memset'ting the whole struct.  It makes sense as these\nfields are explicitly marked as padding.  No more fields need zeroing.\n\nKVM-Stable-Tag.\nSigned-off-by: Vasiliy Kulikov <segooon@gmail.com>\nSigned-off-by: Marcelo Tosatti <mtosatti@redhat.com>\n---\n arch\/x86\/kvm\/x86.c | 6 ++++++\n 1 file changed, 6 insertions(+)\n\n","diff_code":"diff --git a\/arch\/x86\/kvm\/x86.c b\/arch\/x86\/kvm\/x86.c\nindex a542433e4ea1..67cec867519b 100644\n--- a\/arch\/x86\/kvm\/x86.c\n+++ b\/arch\/x86\/kvm\/x86.c\n@@ -2599,6 +2599,7 @@ static void kvm_vcpu_ioctl_x86_get_vcpu_events(struct kvm_vcpu *vcpu,\n \t\t!kvm_exception_is_soft(vcpu->arch.exception.nr);\n \tevents->exception.nr = vcpu->arch.exception.nr;\n \tevents->exception.has_error_code = vcpu->arch.exception.has_error_code;\n+\tevents->exception.pad = 0;\n \tevents->exception.error_code = vcpu->arch.exception.error_code;\n \n \tevents->interrupt.injected =\n@@ -2612,12 +2613,14 @@ static void kvm_vcpu_ioctl_x86_get_vcpu_events(struct kvm_vcpu *vcpu,\n \tevents->nmi.injected = vcpu->arch.nmi_injected;\n \tevents->nmi.pending = vcpu->arch.nmi_pending;\n \tevents->nmi.masked = kvm_x86_ops->get_nmi_mask(vcpu);\n+\tevents->nmi.pad = 0;\n \n \tevents->sipi_vector = vcpu->arch.sipi_vector;\n \n \tevents->flags = (KVM_VCPUEVENT_VALID_NMI_PENDING\n \t\t\t | KVM_VCPUEVENT_VALID_SIPI_VECTOR\n \t\t\t | KVM_VCPUEVENT_VALID_SHADOW);\n+\tmemset(&events->reserved, 0, sizeof(events->reserved));\n }\n \n static int kvm_vcpu_ioctl_x86_set_vcpu_events(struct kvm_vcpu *vcpu,\n@@ -2662,6 +2665,7 @@ static void kvm_vcpu_ioctl_x86_get_debugregs(struct kvm_vcpu *vcpu,\n \tdbgregs->dr6 = vcpu->arch.dr6;\n \tdbgregs->dr7 = vcpu->arch.dr7;\n \tdbgregs->flags = 0;\n+\tmemset(&dbgregs->reserved, 0, sizeof(dbgregs->reserved));\n }\n \n static int kvm_vcpu_ioctl_x86_set_debugregs(struct kvm_vcpu *vcpu,\n@@ -3145,6 +3149,7 @@ static int kvm_vm_ioctl_get_pit2(struct kvm *kvm, struct kvm_pit_state2 *ps)\n \t\tsizeof(ps->channels));\n \tps->flags = kvm->arch.vpit->pit_state.flags;\n \tmutex_unlock(&kvm->arch.vpit->pit_state.lock);\n+\tmemset(&ps->reserved, 0, sizeof(ps->reserved));\n \treturn r;\n }\n \n@@ -3520,6 +3525,7 @@ long kvm_arch_vm_ioctl(struct file *filp,\n \t\tuser_ns.clock = kvm->arch.kvmclock_offset + now_ns;\n \t\tlocal_irq_enable();\n \t\tuser_ns.flags = 0;\n+\t\tmemset(&user_ns.pad, 0, sizeof(user_ns.pad));\n \n \t\tr = -EFAULT;\n \t\tif (copy_to_user(argp, &user_ns, sizeof(user_ns)))\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2015-5697","CWE_ID":"200","category":"security","commit_id":"b6878d9e03043695dbf3fa1caa6dfc09db225b16","commit_message":"From b6878d9e03043695dbf3fa1caa6dfc09db225b16 Mon Sep 17 00:00:00 2001\nFrom: Benjamin Randazzo <benjamin@randazzo.fr>\nDate: Sat, 25 Jul 2015 16:36:50 +0200\nSubject: [PATCH] md: use kzalloc() when bitmap is disabled\n\nIn drivers\/md\/md.c get_bitmap_file() uses kmalloc() for creating a\nmdu_bitmap_file_t called \"file\".\n\n5769         file = kmalloc(sizeof(*file), GFP_NOIO);\n5770         if (!file)\n5771                 return -ENOMEM;\n\nThis structure is copied to user space at the end of the function.\n\n5786         if (err == 0 &&\n5787             copy_to_user(arg, file, sizeof(*file)))\n5788                 err = -EFAULT\n\nBut if bitmap is disabled only the first byte of \"file\" is initialized\nwith zero, so it's possible to read some bytes (up to 4095) of kernel\nspace memory from user space. This is an information leak.\n\n5775         \/* bitmap disabled, zero the first byte and copy out *\/\n5776         if (!mddev->bitmap_info.file)\n5777                 file->pathname[0] = '\\0';\n\nSigned-off-by: Benjamin Randazzo <benjamin@randazzo.fr>\nSigned-off-by: NeilBrown <neilb@suse.com>\n---\n drivers\/md\/md.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/drivers\/md\/md.c b\/drivers\/md\/md.c\nindex 0c2a4e8b873c6..e25f00f0138a7 100644\n--- a\/drivers\/md\/md.c\n+++ b\/drivers\/md\/md.c\n@@ -5759,7 +5759,7 @@ static int get_bitmap_file(struct mddev *mddev, void __user * arg)\n \tchar *ptr;\n \tint err;\n \n-\tfile = kmalloc(sizeof(*file), GFP_NOIO);\n+\tfile = kzalloc(sizeof(*file), GFP_NOIO);\n \tif (!file)\n \t\treturn -ENOMEM;\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-16994","CWE_ID":"200","category":"security","commit_id":"373c4557d2aa362702c4c2d41288fb1e54990b7c","commit_message":"From 373c4557d2aa362702c4c2d41288fb1e54990b7c Mon Sep 17 00:00:00 2001\nFrom: Jann Horn <jannh@google.com>\nDate: Tue, 14 Nov 2017 01:03:44 +0100\nSubject: [PATCH] mm\/pagewalk.c: report holes in hugetlb ranges\n\nThis matters at least for the mincore syscall, which will otherwise copy\nuninitialized memory from the page allocator to userspace.  It is\nprobably also a correctness error for \/proc\/$pid\/pagemap, but I haven't\ntested that.\n\nRemoving the `walk->hugetlb_entry` condition in walk_hugetlb_range() has\nno effect because the caller already checks for that.\n\nThis only reports holes in hugetlb ranges to callers who have specified\na hugetlb_entry callback.\n\nThis issue was found using an AFL-based fuzzer.\n\nv2:\n - don't crash on ->pte_hole==NULL (Andrew Morton)\n - add Cc stable (Andrew Morton)\n\nFixes: 1e25a271c8ac (\"mincore: apply page table walker on do_mincore()\")\nSigned-off-by: Jann Horn <jannh@google.com>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n mm\/pagewalk.c | 6 +++++-\n 1 file changed, 5 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/mm\/pagewalk.c b\/mm\/pagewalk.c\nindex 8bd4afa83cb89..23a3e415ac2ce 100644\n--- a\/mm\/pagewalk.c\n+++ b\/mm\/pagewalk.c\n@@ -188,8 +188,12 @@ static int walk_hugetlb_range(unsigned long addr, unsigned long end,\n \tdo {\n \t\tnext = hugetlb_entry_end(h, addr, end);\n \t\tpte = huge_pte_offset(walk->mm, addr & hmask, sz);\n-\t\tif (pte && walk->hugetlb_entry)\n+\n+\t\tif (pte)\n \t\t\terr = walk->hugetlb_entry(pte, hmask, addr, next, walk);\n+\t\telse if (walk->pte_hole)\n+\t\t\terr = walk->pte_hole(addr, next, walk);\n+\n \t\tif (err)\n \t\t\tbreak;\n \t} while (addr = next, addr != end);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2018-15473","CWE_ID":"200","category":"security","commit_id":"779974d35b4859c07bc3cb8a12c74b43b0a7d1e0","commit_message":"From 779974d35b4859c07bc3cb8a12c74b43b0a7d1e0 Mon Sep 17 00:00:00 2001\nFrom: djm <djm@openbsd.org>\nDate: Tue, 31 Jul 2018 03:10:27 +0000\nSubject: [PATCH] =?UTF-8?q?delay=20bailout=20for=20invalid=20authenticatin?=\n =?UTF-8?q?g=20user=20until=20after=20the=20packet=20containing=20the=20re?=\n =?UTF-8?q?quest=20has=20been=20fully=20parsed.=20Reported=20by=20Dariusz?=\n =?UTF-8?q?=20Tytko=20and=20Micha=C5=82=20Sajdak;=20ok=20deraadt?=\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n---\n usr.bin\/ssh\/auth2-gss.c       | 11 +++++++----\n usr.bin\/ssh\/auth2-hostbased.c | 11 ++++++-----\n usr.bin\/ssh\/auth2-pubkey.c    | 25 +++++++++++++++----------\n 3 files changed, 28 insertions(+), 19 deletions(-)\n\n","diff_code":"diff --git a\/usr.bin\/ssh\/auth2-gss.c b\/usr.bin\/ssh\/auth2-gss.c\nindex 649c830916a..c919ef4c353 100644\n--- a\/usr.bin\/ssh\/auth2-gss.c\n+++ b\/usr.bin\/ssh\/auth2-gss.c\n@@ -1,4 +1,4 @@\n-\/* $OpenBSD: auth2-gss.c,v 1.28 2018\/07\/10 09:13:30 djm Exp $ *\/\n+\/* $OpenBSD: auth2-gss.c,v 1.29 2018\/07\/31 03:10:27 djm Exp $ *\/\n \n \/*\n  * Copyright (c) 2001-2003 Simon Wilkinson. All rights reserved.\n@@ -65,9 +65,6 @@ userauth_gssapi(struct ssh *ssh)\n \tsize_t len;\n \tu_char *doid = NULL;\n \n-\tif (!authctxt->valid || authctxt->user == NULL)\n-\t\treturn (0);\n-\n \tif ((r = sshpkt_get_u32(ssh, &mechs)) != 0)\n \t\tfatal(\"%s: %s\", __func__, ssh_err(r));\n \n@@ -101,6 +98,12 @@ userauth_gssapi(struct ssh *ssh)\n \t\treturn (0);\n \t}\n \n+\tif (!authctxt->valid || authctxt->user == NULL) {\n+\t\tdebug2(\"%s: disabled because of invalid user\", __func__);\n+\t\tfree(doid);\n+\t\treturn (0);\n+\t}\n+\n \tif (GSS_ERROR(PRIVSEP(ssh_gssapi_server_ctx(&ctxt, &goid)))) {\n \t\tif (ctxt != NULL)\n \t\t\tssh_gssapi_delete_ctx(&ctxt);\ndiff --git a\/usr.bin\/ssh\/auth2-hostbased.c b\/usr.bin\/ssh\/auth2-hostbased.c\nindex ad335555934..fb5e5f42272 100644\n--- a\/usr.bin\/ssh\/auth2-hostbased.c\n+++ b\/usr.bin\/ssh\/auth2-hostbased.c\n@@ -1,4 +1,4 @@\n-\/* $OpenBSD: auth2-hostbased.c,v 1.35 2018\/07\/09 21:35:50 markus Exp $ *\/\n+\/* $OpenBSD: auth2-hostbased.c,v 1.36 2018\/07\/31 03:10:27 djm Exp $ *\/\n \/*\n  * Copyright (c) 2000 Markus Friedl.  All rights reserved.\n  *\n@@ -66,10 +66,6 @@ userauth_hostbased(struct ssh *ssh)\n \tsize_t alen, blen, slen;\n \tint r, pktype, authenticated = 0;\n \n-\tif (!authctxt->valid) {\n-\t\tdebug2(\"%s: disabled because of invalid user\", __func__);\n-\t\treturn 0;\n-\t}\n \t\/* XXX use sshkey_froms() *\/\n \tif ((r = sshpkt_get_cstring(ssh, &pkalg, &alen)) != 0 ||\n \t    (r = sshpkt_get_string(ssh, &pkblob, &blen)) != 0 ||\n@@ -116,6 +112,11 @@ userauth_hostbased(struct ssh *ssh)\n \t\tgoto done;\n \t}\n \n+\tif (!authctxt->valid || authctxt->user == NULL) {\n+\t\tdebug2(\"%s: disabled because of invalid user\", __func__);\n+\t\tgoto done;\n+\t}\n+\n \tif ((b = sshbuf_new()) == NULL)\n \t\tfatal(\"%s: sshbuf_new failed\", __func__);\n \t\/* reconstruct packet *\/\ndiff --git a\/usr.bin\/ssh\/auth2-pubkey.c b\/usr.bin\/ssh\/auth2-pubkey.c\nindex 195da5e2111..af9e5f04c45 100644\n--- a\/usr.bin\/ssh\/auth2-pubkey.c\n+++ b\/usr.bin\/ssh\/auth2-pubkey.c\n@@ -1,4 +1,4 @@\n-\/* $OpenBSD: auth2-pubkey.c,v 1.82 2018\/07\/11 18:55:11 markus Exp $ *\/\n+\/* $OpenBSD: auth2-pubkey.c,v 1.83 2018\/07\/31 03:10:27 djm Exp $ *\/\n \/*\n  * Copyright (c) 2000 Markus Friedl.  All rights reserved.\n  *\n@@ -86,19 +86,15 @@ userauth_pubkey(struct ssh *ssh)\n {\n \tAuthctxt *authctxt = ssh->authctxt;\n \tstruct passwd *pw = authctxt->pw;\n-\tstruct sshbuf *b;\n+\tstruct sshbuf *b = NULL;\n \tstruct sshkey *key = NULL;\n-\tchar *pkalg, *userstyle = NULL, *key_s = NULL, *ca_s = NULL;\n-\tu_char *pkblob, *sig, have_sig;\n+\tchar *pkalg = NULL, *userstyle = NULL, *key_s = NULL, *ca_s = NULL;\n+\tu_char *pkblob = NULL, *sig = NULL, have_sig;\n \tsize_t blen, slen;\n \tint r, pktype;\n \tint authenticated = 0;\n \tstruct sshauthopt *authopts = NULL;\n \n-\tif (!authctxt->valid) {\n-\t\tdebug2(\"%s: disabled because of invalid user\", __func__);\n-\t\treturn 0;\n-\t}\n \tif ((r = sshpkt_get_u8(ssh, &have_sig)) != 0 ||\n \t    (r = sshpkt_get_cstring(ssh, &pkalg, NULL)) != 0 ||\n \t    (r = sshpkt_get_string(ssh, &pkblob, &blen)) != 0)\n@@ -164,6 +160,11 @@ userauth_pubkey(struct ssh *ssh)\n \t\t\t\tfatal(\"%s: sshbuf_put_string session id: %s\",\n \t\t\t\t    __func__, ssh_err(r));\n \t\t}\n+\t\tif (!authctxt->valid || authctxt->user == NULL) {\n+\t\t\tdebug2(\"%s: disabled because of invalid user\",\n+\t\t\t    __func__);\n+\t\t\tgoto done;\n+\t\t}\n \t\t\/* reconstruct packet *\/\n \t\txasprintf(&userstyle, \"%s%s%s\", authctxt->user,\n \t\t    authctxt->style ? \":\" : \"\",\n@@ -180,7 +181,6 @@ userauth_pubkey(struct ssh *ssh)\n #ifdef DEBUG_PK\n \t\tsshbuf_dump(b, stderr);\n #endif\n-\n \t\t\/* test for correct signature *\/\n \t\tauthenticated = 0;\n \t\tif (PRIVSEP(user_key_allowed(ssh, pw, key, 1, &authopts)) &&\n@@ -191,7 +191,6 @@ userauth_pubkey(struct ssh *ssh)\n \t\t\tauthenticated = 1;\n \t\t}\n \t\tsshbuf_free(b);\n-\t\tfree(sig);\n \t\tauth2_record_key(authctxt, authenticated, key);\n \t} else {\n \t\tdebug(\"%s: test pkalg %s pkblob %s%s%s\",\n@@ -202,6 +201,11 @@ userauth_pubkey(struct ssh *ssh)\n \t\tif ((r = sshpkt_get_end(ssh)) != 0)\n \t\t\tfatal(\"%s: %s\", __func__, ssh_err(r));\n \n+\t\tif (!authctxt->valid || authctxt->user == NULL) {\n+\t\t\tdebug2(\"%s: disabled because of invalid user\",\n+\t\t\t    __func__);\n+\t\t\tgoto done;\n+\t\t}\n \t\t\/* XXX fake reply and always send PK_OK ? *\/\n \t\t\/*\n \t\t * XXX this allows testing whether a user is allowed\n@@ -235,6 +239,7 @@ userauth_pubkey(struct ssh *ssh)\n \tfree(pkblob);\n \tfree(key_s);\n \tfree(ca_s);\n+\tfree(sig);\n \treturn authenticated;\n }\n \n","owner":"openbsd","repo":"src","source":"cve"},{"CVE_ID":"CVE-2017-1000380","CWE_ID":"200","category":"security","commit_id":"ba3021b2c79b2fa9114f92790a99deb27a65b728","commit_message":"From ba3021b2c79b2fa9114f92790a99deb27a65b728 Mon Sep 17 00:00:00 2001\nFrom: Takashi Iwai <tiwai@suse.de>\nDate: Fri, 2 Jun 2017 17:26:56 +0200\nSubject: [PATCH] ALSA: timer: Fix missing queue indices reset at\n SNDRV_TIMER_IOCTL_SELECT\n\nsnd_timer_user_tselect() reallocates the queue buffer dynamically, but\nit forgot to reset its indices.  Since the read may happen\nconcurrently with ioctl and snd_timer_user_tselect() allocates the\nbuffer via kmalloc(), this may lead to the leak of uninitialized\nkernel-space data, as spotted via KMSAN:\n\n  BUG: KMSAN: use of unitialized memory in snd_timer_user_read+0x6c4\/0xa10\n  CPU: 0 PID: 1037 Comm: probe Not tainted 4.11.0-rc5+ #2739\n  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01\/01\/2011\n  Call Trace:\n   __dump_stack lib\/dump_stack.c:16\n   dump_stack+0x143\/0x1b0 lib\/dump_stack.c:52\n   kmsan_report+0x12a\/0x180 mm\/kmsan\/kmsan.c:1007\n   kmsan_check_memory+0xc2\/0x140 mm\/kmsan\/kmsan.c:1086\n   copy_to_user .\/arch\/x86\/include\/asm\/uaccess.h:725\n   snd_timer_user_read+0x6c4\/0xa10 sound\/core\/timer.c:2004\n   do_loop_readv_writev fs\/read_write.c:716\n   __do_readv_writev+0x94c\/0x1380 fs\/read_write.c:864\n   do_readv_writev fs\/read_write.c:894\n   vfs_readv fs\/read_write.c:908\n   do_readv+0x52a\/0x5d0 fs\/read_write.c:934\n   SYSC_readv+0xb6\/0xd0 fs\/read_write.c:1021\n   SyS_readv+0x87\/0xb0 fs\/read_write.c:1018\n\nThis patch adds the missing reset of queue indices.  Together with the\nprevious fix for the ioctl\/read race, we cover the whole problem.\n\nReported-by: Alexander Potapenko <glider@google.com>\nTested-by: Alexander Potapenko <glider@google.com>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>\n---\n sound\/core\/timer.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/sound\/core\/timer.c b\/sound\/core\/timer.c\nindex 1118bd8e2d3c2..cd67d1c12cf1c 100644\n--- a\/sound\/core\/timer.c\n+++ b\/sound\/core\/timer.c\n@@ -1618,6 +1618,7 @@ static int snd_timer_user_tselect(struct file *file,\n \tif (err < 0)\n \t\tgoto __err;\n \n+\ttu->qhead = tu->qtail = tu->qused = 0;\n \tkfree(tu->queue);\n \ttu->queue = NULL;\n \tkfree(tu->tqueue);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-6548","CWE_ID":"200","category":"security","commit_id":"0143fc5e9f6f5aad4764801015bc8d4b4a278200","commit_message":"From 0143fc5e9f6f5aad4764801015bc8d4b4a278200 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Thu, 12 Jul 2012 08:46:55 +0200\nSubject: udf: avoid info leak on export\n\nFor type 0x51 the udf.parent_partref member in struct fid gets copied\nuninitialized to userland. Fix this by initializing it to 0.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: Jan Kara <jack@suse.cz>\n---\n fs\/udf\/namei.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/fs\/udf\/namei.c b\/fs\/udf\/namei.c\nindex 18024178ac4c..c31deb382afd 100644\n--- a\/fs\/udf\/namei.c\n+++ b\/fs\/udf\/namei.c\n@@ -1279,6 +1279,7 @@ static int udf_encode_fh(struct inode *inode, __u32 *fh, int *lenp,\n \t*lenp = 3;\n \tfid->udf.block = location.logicalBlockNum;\n \tfid->udf.partref = location.partitionReferenceNum;\n+\tfid->udf.parent_partref = 0;\n \tfid->udf.generation = inode->i_generation;\n \n \tif (parent) {\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-5299","CWE_ID":"200","category":"security","commit_id":"675fd8d771f9d43e354dba53ddd9b5483ae0a1d7","commit_message":"From 675fd8d771f9d43e354dba53ddd9b5483ae0a1d7 Mon Sep 17 00:00:00 2001\nFrom: Jeremy Allison <jra@samba.org>\nDate: Fri, 23 Oct 2015 14:54:31 -0700\nSubject: [PATCH] CVE-2015-5299: s3-shadow-copy2: fix missing access check on\n snapdir\n\nFix originally from <partha@exablox.com>\n\nhttps:\/\/bugzilla.samba.org\/show_bug.cgi?id=11529\n\nSigned-off-by: Jeremy Allison <jra@samba.org>\nReviewed-by: David Disseldorp <ddiss@samba.org>\n---\n source3\/modules\/vfs_shadow_copy2.c | 45 ++++++++++++++++++++++++++++++\n 1 file changed, 45 insertions(+)\n\n","diff_code":"diff --git a\/source3\/modules\/vfs_shadow_copy2.c b\/source3\/modules\/vfs_shadow_copy2.c\nindex 4d2ec54dcaa..d1673a427ef 100644\n--- a\/source3\/modules\/vfs_shadow_copy2.c\n+++ b\/source3\/modules\/vfs_shadow_copy2.c\n@@ -30,6 +30,7 @@\n  *\/\n \n #include \"includes.h\"\n+#include \"smbd\/smbd.h\"\n #include \"system\/filesys.h\"\n #include \"include\/ntioctl.h\"\n #include \"util_tdb.h\"\n@@ -1180,6 +1181,42 @@ static char *have_snapdir(struct vfs_handle_struct *handle,\n \treturn NULL;\n }\n \n+static bool check_access_snapdir(struct vfs_handle_struct *handle,\n+\t\t\t\tconst char *path)\n+{\n+\tstruct smb_filename smb_fname;\n+\tint ret;\n+\tNTSTATUS status;\n+\n+\tZERO_STRUCT(smb_fname);\n+\tsmb_fname.base_name = talloc_asprintf(talloc_tos(),\n+\t\t\t\t\t\t\"%s\",\n+\t\t\t\t\t\tpath);\n+\tif (smb_fname.base_name == NULL) {\n+\t\treturn false;\n+\t}\n+\n+\tret = SMB_VFS_NEXT_STAT(handle, &smb_fname);\n+\tif (ret != 0 || !S_ISDIR(smb_fname.st.st_ex_mode)) {\n+\t\tTALLOC_FREE(smb_fname.base_name);\n+\t\treturn false;\n+\t}\n+\n+\tstatus = smbd_check_access_rights(handle->conn,\n+\t\t\t\t\t&smb_fname,\n+\t\t\t\t\tfalse,\n+\t\t\t\t\tSEC_DIR_LIST);\n+\tif (!NT_STATUS_IS_OK(status)) {\n+\t\tDEBUG(0,(\"user does not have list permission \"\n+\t\t\t\"on snapdir %s\\n\",\n+\t\t\tsmb_fname.base_name));\n+\t\tTALLOC_FREE(smb_fname.base_name);\n+\t\treturn false;\n+\t}\n+\tTALLOC_FREE(smb_fname.base_name);\n+\treturn true;\n+}\n+\n \/**\n  * Find the snapshot directory (if any) for the given\n  * filename (which is relative to the share).\n@@ -1329,6 +1366,7 @@ static int shadow_copy2_get_shadow_copy_data(\n \tconst char *snapdir;\n \tstruct dirent *d;\n \tTALLOC_CTX *tmp_ctx = talloc_stackframe();\n+\tbool ret;\n \n \tsnapdir = shadow_copy2_find_snapdir(tmp_ctx, handle, fsp->fsp_name);\n \tif (snapdir == NULL) {\n@@ -1338,6 +1376,13 @@ static int shadow_copy2_get_shadow_copy_data(\n \t\ttalloc_free(tmp_ctx);\n \t\treturn -1;\n \t}\n+\tret = check_access_snapdir(handle, snapdir);\n+\tif (!ret) {\n+\t\tDEBUG(0,(\"access denied on listing snapdir %s\\n\", snapdir));\n+\t\terrno = EACCES;\n+\t\ttalloc_free(tmp_ctx);\n+\t\treturn -1;\n+\t}\n \n \tp = SMB_VFS_NEXT_OPENDIR(handle, snapdir, NULL, 0);\n \n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2009-3001","CWE_ID":"200","category":"security","commit_id":"28e9fc592cb8c7a43e4d3147b38be6032a0e81bc","commit_message":"From 28e9fc592cb8c7a43e4d3147b38be6032a0e81bc Mon Sep 17 00:00:00 2001\nFrom: Jiri Slaby <jirislaby@gmail.com>\nDate: Sun, 23 Aug 2009 22:55:51 -0700\nSubject: NET: llc, zero sockaddr_llc struct\n\nsllc_arphrd member of sockaddr_llc might not be changed. Zero sllc\nbefore copying to the above layer's structure.\n\nSigned-off-by: Jiri Slaby <jirislaby@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/llc\/af_llc.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/llc\/af_llc.c b\/net\/llc\/af_llc.c\nindex 9208cf5f2bd5..c45eee1c0e8d 100644\n--- a\/net\/llc\/af_llc.c\n+++ b\/net\/llc\/af_llc.c\n@@ -914,6 +914,7 @@ static int llc_ui_getname(struct socket *sock, struct sockaddr *uaddr,\n \tstruct llc_sock *llc = llc_sk(sk);\n \tint rc = 0;\n \n+\tmemset(&sllc, 0, sizeof(sllc));\n \tlock_sock(sk);\n \tif (sock_flag(sk, SOCK_ZAPPED))\n \t\tgoto out;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2012-6543","CWE_ID":"200","category":"security","commit_id":"04d4fbca1017c11381e7d82acea21dd741e748bc","commit_message":"From 04d4fbca1017c11381e7d82acea21dd741e748bc Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:52 +0000\nSubject: [PATCH] l2tp: fix info leak via getsockname()\n\nThe L2TP code for IPv6 fails to initialize the l2tp_unused member of\nstruct sockaddr_l2tpip6 and that for leaks two bytes kernel stack via\nthe getsockname() syscall. Initialize l2tp_unused with 0 to avoid the\ninfo leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nCc: James Chapman <jchapman@katalix.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/l2tp\/l2tp_ip6.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/l2tp\/l2tp_ip6.c b\/net\/l2tp\/l2tp_ip6.c\nindex 35e1e4bde5873..927547171bc71 100644\n--- a\/net\/l2tp\/l2tp_ip6.c\n+++ b\/net\/l2tp\/l2tp_ip6.c\n@@ -410,6 +410,7 @@ static int l2tp_ip6_getname(struct socket *sock, struct sockaddr *uaddr,\n \tlsa->l2tp_family = AF_INET6;\n \tlsa->l2tp_flowinfo = 0;\n \tlsa->l2tp_scope_id = 0;\n+\tlsa->l2tp_unused = 0;\n \tif (peer) {\n \t\tif (!lsk->peer_conn_id)\n \t\t\treturn -ENOTCONN;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-8950","CWE_ID":"200","category":"security","commit_id":"6829e274a623187c24f7cfc0e3d35f25d087fcc5","commit_message":"From 6829e274a623187c24f7cfc0e3d35f25d087fcc5 Mon Sep 17 00:00:00 2001\nFrom: Marek Szyprowski <m.szyprowski@samsung.com>\nDate: Thu, 23 Apr 2015 12:46:16 +0100\nSubject: [PATCH] arm64: dma-mapping: always clear allocated buffers\n\nBuffers allocated by dma_alloc_coherent() are always zeroed on Alpha,\nARM (32bit), MIPS, PowerPC, x86\/x86_64 and probably other architectures.\nIt turned out that some drivers rely on this 'feature'. Allocated buffer\nmight be also exposed to userspace with dma_mmap() call, so clearing it\nis desired from security point of view to avoid exposing random memory\nto userspace. This patch unifies dma_alloc_coherent() behavior on ARM64\narchitecture with other implementations by unconditionally zeroing\nallocated buffer.\n\nCc: <stable@vger.kernel.org> # v3.14+\nSigned-off-by: Marek Szyprowski <m.szyprowski@samsung.com>\nSigned-off-by: Will Deacon <will.deacon@arm.com>\n---\n arch\/arm64\/mm\/dma-mapping.c | 6 ++----\n 1 file changed, 2 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/arch\/arm64\/mm\/dma-mapping.c b\/arch\/arm64\/mm\/dma-mapping.c\nindex ef7d112f5ce0d..e0f14ee26b681 100644\n--- a\/arch\/arm64\/mm\/dma-mapping.c\n+++ b\/arch\/arm64\/mm\/dma-mapping.c\n@@ -67,8 +67,7 @@ static void *__alloc_from_pool(size_t size, struct page **ret_page, gfp_t flags)\n \n \t\t*ret_page = phys_to_page(phys);\n \t\tptr = (void *)val;\n-\t\tif (flags & __GFP_ZERO)\n-\t\t\tmemset(ptr, 0, size);\n+\t\tmemset(ptr, 0, size);\n \t}\n \n \treturn ptr;\n@@ -113,8 +112,7 @@ static void *__dma_alloc_coherent(struct device *dev, size_t size,\n \n \t\t*dma_handle = phys_to_dma(dev, page_to_phys(page));\n \t\taddr = page_address(page);\n-\t\tif (flags & __GFP_ZERO)\n-\t\t\tmemset(addr, 0, size);\n+\t\tmemset(addr, 0, size);\n \t\treturn addr;\n \t} else {\n \t\treturn swiotlb_alloc_coherent(dev, size, dma_handle, flags);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-0701","CWE_ID":"200","category":"security","commit_id":"878e2c5b13010329c203f309ed0c8f2113f85648","commit_message":"From 878e2c5b13010329c203f309ed0c8f2113f85648 Mon Sep 17 00:00:00 2001\nFrom: Matt Caswell <matt@openssl.org>\nDate: Mon, 18 Jan 2016 11:31:58 +0000\nSubject: [PATCH] Prevent small subgroup attacks on DH\/DHE\n\nHistorically OpenSSL only ever generated DH parameters based on \"safe\"\nprimes. More recently (in version 1.0.2) support was provided for\ngenerating X9.42 style parameter files such as those required for RFC\n5114 support. The primes used in such files may not be \"safe\". Where an\napplication is using DH configured with parameters based on primes that\nare not \"safe\" then an attacker could use this fact to find a peer's\nprivate DH exponent. This attack requires that the attacker complete\nmultiple handshakes in which the peer uses the same DH exponent.\n\nA simple mitigation is to ensure that y^q (mod p) == 1\n\nCVE-2016-0701 (fix part 1 of 2)\n\nIssue reported by Antonio Sanso.\n\nReviewed-by: Viktor Dukhovni <viktor@openssl.org>\n---\n crypto\/dh\/dh.h       |  1 +\n crypto\/dh\/dh_check.c | 35 +++++++++++++++++++++++++----------\n 2 files changed, 26 insertions(+), 10 deletions(-)\n\n","diff_code":"diff --git a\/crypto\/dh\/dh.h b\/crypto\/dh\/dh.h\nindex b177673281..5498a9dc10 100644\n--- a\/crypto\/dh\/dh.h\n+++ b\/crypto\/dh\/dh.h\n@@ -174,6 +174,7 @@ struct dh_st {\n \/* DH_check_pub_key error codes *\/\n # define DH_CHECK_PUBKEY_TOO_SMALL       0x01\n # define DH_CHECK_PUBKEY_TOO_LARGE       0x02\n+# define DH_CHECK_PUBKEY_INVALID         0x03\n \n \/*\n  * primes p where (p-1)\/2 is prime too are called \"safe\"; we define this for\ndiff --git a\/crypto\/dh\/dh_check.c b\/crypto\/dh\/dh_check.c\nindex 347467c6a4..5adedc0d26 100644\n--- a\/crypto\/dh\/dh_check.c\n+++ b\/crypto\/dh\/dh_check.c\n@@ -151,23 +151,38 @@ int DH_check(const DH *dh, int *ret)\n int DH_check_pub_key(const DH *dh, const BIGNUM *pub_key, int *ret)\n {\n     int ok = 0;\n-    BIGNUM *q = NULL;\n+    BIGNUM *tmp = NULL;\n+    BN_CTX *ctx = NULL;\n \n     *ret = 0;\n-    q = BN_new();\n-    if (q == NULL)\n+    ctx = BN_CTX_new();\n+    if (ctx == NULL)\n         goto err;\n-    BN_set_word(q, 1);\n-    if (BN_cmp(pub_key, q) <= 0)\n+    BN_CTX_start(ctx);\n+    tmp = BN_CTX_get(ctx);\n+    if (tmp == NULL)\n+        goto err;\n+    BN_set_word(tmp, 1);\n+    if (BN_cmp(pub_key, tmp) <= 0)\n         *ret |= DH_CHECK_PUBKEY_TOO_SMALL;\n-    BN_copy(q, dh->p);\n-    BN_sub_word(q, 1);\n-    if (BN_cmp(pub_key, q) >= 0)\n+    BN_copy(tmp, dh->p);\n+    BN_sub_word(tmp, 1);\n+    if (BN_cmp(pub_key, tmp) >= 0)\n         *ret |= DH_CHECK_PUBKEY_TOO_LARGE;\n \n+    if (dh->q != NULL) {\n+        \/* Check pub_key^q == 1 mod p *\/\n+        if (!BN_mod_exp(tmp, pub_key, dh->q, dh->p, ctx))\n+            goto err;\n+        if (!BN_is_one(tmp))\n+            *ret |= DH_CHECK_PUBKEY_INVALID;\n+    }\n+\n     ok = 1;\n  err:\n-    if (q != NULL)\n-        BN_free(q);\n+    if (ctx != NULL) {\n+        BN_CTX_end(ctx);\n+        BN_CTX_free(ctx);\n+    }\n     return (ok);\n }\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-18838","CWE_ID":"200","category":"security","commit_id":"92327c9ec211bd1616315abcb255861b130b97ca","commit_message":"From 92327c9ec211bd1616315abcb255861b130b97ca Mon Sep 17 00:00:00 2001\nFrom: Costa Tsaousis <costa@tsaousis.gr>\nDate: Tue, 30 Oct 2018 02:35:57 +0200\nSubject: [PATCH] fixed vulnerabilities identified by red4sec.com (#4521)\n\n---\n libnetdata\/url\/url.c |  4 +++-\n web\/api\/web_api_v1.c | 17 +++++++++++++++++\n 2 files changed, 20 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/libnetdata\/url\/url.c b\/libnetdata\/url\/url.c\nindex 8a96063a03..07a9f8069e 100644\n--- a\/libnetdata\/url\/url.c\n+++ b\/libnetdata\/url\/url.c\n@@ -60,7 +60,9 @@ char *url_decode_r(char *to, char *url, size_t size) {\n     while(*s && d < e) {\n         if(unlikely(*s == '%')) {\n             if(likely(s[1] && s[2])) {\n-                *d++ = from_hex(s[1]) << 4 | from_hex(s[2]);\n+                char t = from_hex(s[1]) << 4 | from_hex(s[2]);\n+                \/\/ avoid HTTP header injection\n+                *d++ = (char)((isprint(t))? t : ' ');\n                 s += 2;\n             }\n         }\ndiff --git a\/web\/api\/web_api_v1.c b\/web\/api\/web_api_v1.c\nindex 0c0242c3ca..1e03828e40 100644\n--- a\/web\/api\/web_api_v1.c\n+++ b\/web\/api\/web_api_v1.c\n@@ -233,6 +233,15 @@ inline int web_client_api_request_v1_chart(RRDHOST *host, struct web_client *w,\n     return web_client_api_request_single_chart(host, w, url, rrd_stats_api_v1_chart);\n }\n \n+void fix_google_param(char *s) {\n+    if(unlikely(!s)) return;\n+\n+    for( ; *s ;s++) {\n+        if(!isalnum(*s) && *s != '.' && *s != '_' && *s != '-')\n+            *s = '_';\n+    }\n+}\n+\n \/\/ returns the HTTP code\n inline int web_client_api_request_v1_data(RRDHOST *host, struct web_client *w, char *url) {\n     debug(D_WEB_CLIENT, \"%llu: API v1 data with URL '%s'\", w->id, url);\n@@ -332,6 +341,14 @@ inline int web_client_api_request_v1_data(RRDHOST *host, struct web_client *w, c\n         }\n     }\n \n+    \/\/ validate the google parameters given\n+    fix_google_param(google_out);\n+    fix_google_param(google_sig);\n+    fix_google_param(google_reqId);\n+    fix_google_param(google_version);\n+    fix_google_param(responseHandler);\n+    fix_google_param(outFileName);\n+\n     if(!chart || !*chart) {\n         buffer_sprintf(w->response.data, \"No chart id is given at the request.\");\n         goto cleanup;\n","owner":"netdata","repo":"netdata","source":"cve"},{"CVE_ID":"CVE-2010-4079","CWE_ID":"200","category":"security","commit_id":"405707985594169cfd0b1d97d29fcb4b4c6f2ac9","commit_message":"From 405707985594169cfd0b1d97d29fcb4b4c6f2ac9 Mon Sep 17 00:00:00 2001\nFrom: Dan Rosenberg <drosenberg@vsecurity.com>\nDate: Wed, 15 Sep 2010 18:44:22 -0300\nSubject: V4L\/DVB: ivtvfb: prevent reading uninitialized stack memory\n\nThe FBIOGET_VBLANK device ioctl allows unprivileged users to read 16\nbytes of uninitialized stack memory, because the \"reserved\" member of\nthe fb_vblank struct declared on the stack is not altered or zeroed\nbefore being copied back to the user.  This patch takes care of it.\n\nSigned-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>\nSigned-off-by: Andy Walls <awalls@md.metrocast.net>\nSigned-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>\n---\n drivers\/media\/video\/ivtv\/ivtvfb.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/drivers\/media\/video\/ivtv\/ivtvfb.c b\/drivers\/media\/video\/ivtv\/ivtvfb.c\nindex be03a712731c..f0316d02f09f 100644\n--- a\/drivers\/media\/video\/ivtv\/ivtvfb.c\n+++ b\/drivers\/media\/video\/ivtv\/ivtvfb.c\n@@ -466,6 +466,8 @@ static int ivtvfb_ioctl(struct fb_info *info, unsigned int cmd, unsigned long ar\n \t\t\tstruct fb_vblank vblank;\n \t\t\tu32 trace;\n \n+\t\t\tmemset(&vblank, 0, sizeof(struct fb_vblank));\n+\n \t\t\tvblank.flags = FB_VBLANK_HAVE_COUNT |FB_VBLANK_HAVE_VCOUNT |\n \t\t\t\t\tFB_VBLANK_HAVE_VSYNC;\n \t\t\ttrace = read_reg(IVTV_REG_DEC_LINE_FIELD) >> 16;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-10853","CWE_ID":"200","category":"security","commit_id":"129a72a0d3c8e139a04512325384fe5ac119e74d","commit_message":"From 129a72a0d3c8e139a04512325384fe5ac119e74d Mon Sep 17 00:00:00 2001\nFrom: Steve Rutherford <srutherford@google.com>\nDate: Wed, 11 Jan 2017 18:28:29 -0800\nSubject: KVM: x86: Introduce segmented_write_std\n\nIntroduces segemented_write_std.\n\nSwitches from emulated reads\/writes to standard read\/writes in fxsave,\nfxrstor, sgdt, and sidt.  This fixes CVE-2017-2584, a longstanding\nkernel memory leak.\n\nSince commit 283c95d0e389 (\"KVM: x86: emulate FXSAVE and FXRSTOR\",\n2016-11-09), which is luckily not yet in any final release, this would\nalso be an exploitable kernel memory *write*!\n\nReported-by: Dmitry Vyukov <dvyukov@google.com>\nCc: stable@vger.kernel.org\nFixes: 96051572c819194c37a8367624b285be10297eca\nFixes: 283c95d0e3891b64087706b344a4b545d04a6e62\nSuggested-by: Paolo Bonzini <pbonzini@redhat.com>\nSigned-off-by: Steve Rutherford <srutherford@google.com>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>\n---\n arch\/x86\/kvm\/emulate.c | 22 ++++++++++++++++++----\n 1 file changed, 18 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/arch\/x86\/kvm\/emulate.c b\/arch\/x86\/kvm\/emulate.c\nindex 56628a44668b..f36d0fa6b885 100644\n--- a\/arch\/x86\/kvm\/emulate.c\n+++ b\/arch\/x86\/kvm\/emulate.c\n@@ -818,6 +818,20 @@ static int segmented_read_std(struct x86_emulate_ctxt *ctxt,\n \treturn ctxt->ops->read_std(ctxt, linear, data, size, &ctxt->exception);\n }\n \n+static int segmented_write_std(struct x86_emulate_ctxt *ctxt,\n+\t\t\t       struct segmented_address addr,\n+\t\t\t       void *data,\n+\t\t\t       unsigned int size)\n+{\n+\tint rc;\n+\tulong linear;\n+\n+\trc = linearize(ctxt, addr, size, true, &linear);\n+\tif (rc != X86EMUL_CONTINUE)\n+\t\treturn rc;\n+\treturn ctxt->ops->write_std(ctxt, linear, data, size, &ctxt->exception);\n+}\n+\n \/*\n  * Prefetch the remaining bytes of the instruction without crossing page\n  * boundary if they are not in fetch_cache yet.\n@@ -3685,8 +3699,8 @@ static int emulate_store_desc_ptr(struct x86_emulate_ctxt *ctxt,\n \t}\n \t\/* Disable writeback. *\/\n \tctxt->dst.type = OP_NONE;\n-\treturn segmented_write(ctxt, ctxt->dst.addr.mem,\n-\t\t\t       &desc_ptr, 2 + ctxt->op_bytes);\n+\treturn segmented_write_std(ctxt, ctxt->dst.addr.mem,\n+\t\t\t\t   &desc_ptr, 2 + ctxt->op_bytes);\n }\n \n static int em_sgdt(struct x86_emulate_ctxt *ctxt)\n@@ -3932,7 +3946,7 @@ static int em_fxsave(struct x86_emulate_ctxt *ctxt)\n \telse\n \t\tsize = offsetof(struct fxregs_state, xmm_space[0]);\n \n-\treturn segmented_write(ctxt, ctxt->memop.addr.mem, &fx_state, size);\n+\treturn segmented_write_std(ctxt, ctxt->memop.addr.mem, &fx_state, size);\n }\n \n static int fxrstor_fixup(struct x86_emulate_ctxt *ctxt,\n@@ -3974,7 +3988,7 @@ static int em_fxrstor(struct x86_emulate_ctxt *ctxt)\n \tif (rc != X86EMUL_CONTINUE)\n \t\treturn rc;\n \n-\trc = segmented_read(ctxt, ctxt->memop.addr.mem, &fx_state, 512);\n+\trc = segmented_read_std(ctxt, ctxt->memop.addr.mem, &fx_state, 512);\n \tif (rc != X86EMUL_CONTINUE)\n \t\treturn rc;\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-7495","CWE_ID":"200","category":"security","commit_id":"06bd3c36a733ac27962fea7d6f47168841376824","commit_message":"From 06bd3c36a733ac27962fea7d6f47168841376824 Mon Sep 17 00:00:00 2001\nFrom: Jan Kara <jack@suse.cz>\nDate: Sun, 24 Apr 2016 00:56:03 -0400\nSubject: ext4: fix data exposure after a crash\n\nHuang has reported that in his powerfail testing he is seeing stale\nblock contents in some of recently allocated blocks although he mounts\next4 in data=ordered mode. After some investigation I have found out\nthat indeed when delayed allocation is used, we don't add inode to\ntransaction's list of inodes needing flushing before commit. Originally\nwe were doing that but commit f3b59291a69d removed the logic with a\nflawed argument that it is not needed.\n\nThe problem is that although for delayed allocated blocks we write their\ncontents immediately after allocating them, there is no guarantee that\nthe IO scheduler or device doesn't reorder things and thus transaction\nallocating blocks and attaching them to inode can reach stable storage\nbefore actual block contents. Actually whenever we attach freshly\nallocated blocks to inode using a written extent, we should add inode to\ntransaction's ordered inode list to make sure we properly wait for block\ncontents to be written before committing the transaction. So that is\nwhat we do in this patch. This also handles other cases where stale data\nexposure was possible - like filling hole via mmap in\ndata=ordered,nodelalloc mode.\n\nThe only exception to the above rule are extending direct IO writes where\nblkdev_direct_IO() waits for IO to complete before increasing i_size and\nthus stale data exposure is not possible. For now we don't complicate\nthe code with optimizing this special case since the overhead is pretty\nlow. In case this is observed to be a performance problem we can always\nhandle it using a special flag to ext4_map_blocks().\n\nCC: stable@vger.kernel.org\nFixes: f3b59291a69d0b734be1fc8be489fef2dd846d3d\nReported-by: \"HUANG Weller (CM\/ESW12-CN)\" <Weller.Huang@cn.bosch.com>\nTested-by: \"HUANG Weller (CM\/ESW12-CN)\" <Weller.Huang@cn.bosch.com>\nSigned-off-by: Jan Kara <jack@suse.cz>\nSigned-off-by: Theodore Ts'o <tytso@mit.edu>\n---\n fs\/ext4\/inode.c | 24 +++++++++++++++---------\n 1 file changed, 15 insertions(+), 9 deletions(-)\n\n","diff_code":"diff --git a\/fs\/ext4\/inode.c b\/fs\/ext4\/inode.c\nindex 981a1fc30eaa..250c2df04a92 100644\n--- a\/fs\/ext4\/inode.c\n+++ b\/fs\/ext4\/inode.c\n@@ -684,6 +684,21 @@ out_sem:\n \t\tret = check_block_validity(inode, map);\n \t\tif (ret != 0)\n \t\t\treturn ret;\n+\n+\t\t\/*\n+\t\t * Inodes with freshly allocated blocks where contents will be\n+\t\t * visible after transaction commit must be on transaction's\n+\t\t * ordered data list.\n+\t\t *\/\n+\t\tif (map->m_flags & EXT4_MAP_NEW &&\n+\t\t    !(map->m_flags & EXT4_MAP_UNWRITTEN) &&\n+\t\t    !(flags & EXT4_GET_BLOCKS_ZERO) &&\n+\t\t    !IS_NOQUOTA(inode) &&\n+\t\t    ext4_should_order_data(inode)) {\n+\t\t\tret = ext4_jbd2_file_inode(handle, inode);\n+\t\t\tif (ret)\n+\t\t\t\treturn ret;\n+\t\t}\n \t}\n \treturn retval;\n }\n@@ -1289,15 +1304,6 @@ static int ext4_write_end(struct file *file,\n \tint i_size_changed = 0;\n \n \ttrace_ext4_write_end(inode, pos, len, copied);\n-\tif (ext4_test_inode_state(inode, EXT4_STATE_ORDERED_MODE)) {\n-\t\tret = ext4_jbd2_file_inode(handle, inode);\n-\t\tif (ret) {\n-\t\t\tunlock_page(page);\n-\t\t\tput_page(page);\n-\t\t\tgoto errout;\n-\t\t}\n-\t}\n-\n \tif (ext4_has_inline_data(inode)) {\n \t\tret = ext4_write_inline_data_end(inode, pos, len,\n \t\t\t\t\t\t copied, page);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-3231","CWE_ID":"200","category":"security","commit_id":"c77a4b9cffb6215a15196ec499490d116dfad181","commit_message":"From c77a4b9cffb6215a15196ec499490d116dfad181 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:56 +0000\nSubject: llc: Fix missing msg_namelen update in llc_ui_recvmsg()\n\nFor stream sockets the code misses to update the msg_namelen member\nto 0 and therefore makes net\/socket.c leak the local, uninitialized\nsockaddr_storage variable to userland -- 128 bytes of kernel stack\nmemory. The msg_namelen update is also missing for datagram sockets\nin case the socket is shutting down during receive.\n\nFix both issues by setting msg_namelen to 0 early. It will be\nupdated later if we're going to fill the msg_name member.\n\nCc: Arnaldo Carvalho de Melo <acme@ghostprotocols.net>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/llc\/af_llc.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/net\/llc\/af_llc.c b\/net\/llc\/af_llc.c\nindex 88709882c464..48aaa89253e0 100644\n--- a\/net\/llc\/af_llc.c\n+++ b\/net\/llc\/af_llc.c\n@@ -720,6 +720,8 @@ static int llc_ui_recvmsg(struct kiocb *iocb, struct socket *sock,\n \tint target;\t\/* Read at least this many bytes *\/\n \tlong timeo;\n \n+\tmsg->msg_namelen = 0;\n+\n \tlock_sock(sk);\n \tcopied = -ENOTCONN;\n \tif (unlikely(sk->sk_type == SOCK_STREAM && sk->sk_state == TCP_LISTEN))\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-1944","CWE_ID":"200","category":"security","commit_id":"2eb8dcf26cb37f09cffe26909a646e702dbcab66","commit_message":"From 2eb8dcf26cb37f09cffe26909a646e702dbcab66 Mon Sep 17 00:00:00 2001\nFrom: YAMADA Yasuharu <yasuharu.yamada@access-company.com>\nDate: Thu, 11 Apr 2013 00:17:15 +0200\nSubject: [PATCH] cookie: fix tailmatching to prevent cross-domain leakage\n\nCookies set for 'example.com' could accidentaly also be sent by libcurl\nto the 'bexample.com' (ie with a prefix to the first domain name).\n\nThis is a security vulnerabilty, CVE-2013-1944.\n\nBug: http:\/\/curl.haxx.se\/docs\/adv_20130412.html\n---\n lib\/cookie.c | 24 +++++++++++++++++++-----\n 1 file changed, 19 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/lib\/cookie.c b\/lib\/cookie.c\nindex 4b9ec0bdd9..a67204e6e2 100644\n--- a\/lib\/cookie.c\n+++ b\/lib\/cookie.c\n@@ -118,15 +118,29 @@ static void freecookie(struct Cookie *co)\n   free(co);\n }\n \n-static bool tailmatch(const char *little, const char *bigone)\n+static bool tailmatch(const char *cooke_domain, const char *hostname)\n {\n-  size_t littlelen = strlen(little);\n-  size_t biglen = strlen(bigone);\n+  size_t cookie_domain_len = strlen(cooke_domain);\n+  size_t hostname_len = strlen(hostname);\n \n-  if(littlelen > biglen)\n+  if(hostname_len < cookie_domain_len)\n     return FALSE;\n \n-  return Curl_raw_equal(little, bigone+biglen-littlelen) ? TRUE : FALSE;\n+  if(!Curl_raw_equal(cooke_domain, hostname+hostname_len-cookie_domain_len))\n+    return FALSE;\n+\n+  \/* A lead char of cookie_domain is not '.'.\n+     RFC6265 4.1.2.3. The Domain Attribute says:\n+       For example, if the value of the Domain attribute is\n+       \"example.com\", the user agent will include the cookie in the Cookie\n+       header when making HTTP requests to example.com, www.example.com, and\n+       www.corp.example.com.\n+   *\/\n+  if(hostname_len == cookie_domain_len)\n+    return TRUE;\n+  if('.' == *(hostname + hostname_len - cookie_domain_len - 1))\n+    return TRUE;\n+  return FALSE;\n }\n \n \/*\n","owner":"bagder","repo":"curl","source":"cve"},{"CVE_ID":"CVE-2010-2803","CWE_ID":"200","category":"security","commit_id":"b9f0aee83335db1f3915f4e42a5e21b351740afd","commit_message":"From b9f0aee83335db1f3915f4e42a5e21b351740afd Mon Sep 17 00:00:00 2001\nFrom: Dave Airlie <airlied@redhat.com>\nDate: Tue, 17 Aug 2010 14:46:00 +1000\nSubject: drm: stop information leak of old kernel stack.\n\nnon-critical issue, CVE-2010-2803\n\nUserspace controls the amount of memory to be allocate, so it can\nget the ioctl to allocate more memory than the kernel uses, and get\naccess to kernel stack. This can only be done for processes authenticated\nto the X server for DRI access, and if the user has DRI access.\n\nFix is to just memset the data to 0 if the user doesn't copy into\nit in the first place.\n\nReported-by: Kees Cook <kees@ubuntu.com>\nSigned-off-by: Dave Airlie <airlied@redhat.com>\n---\n drivers\/gpu\/drm\/drm_drv.c | 4 +++-\n 1 file changed, 3 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/drivers\/gpu\/drm\/drm_drv.c b\/drivers\/gpu\/drm\/drm_drv.c\nindex 90288ec7c284..3644c94c0a17 100644\n--- a\/drivers\/gpu\/drm\/drm_drv.c\n+++ b\/drivers\/gpu\/drm\/drm_drv.c\n@@ -477,7 +477,9 @@ long drm_ioctl(struct file *filp,\n \t\t\t\tretcode = -EFAULT;\n \t\t\t\tgoto err_i1;\n \t\t\t}\n-\t\t}\n+\t\t} else\n+\t\t\tmemset(kdata, 0, _IOC_SIZE(cmd));\n+\n \t\tif (ioctl->flags & DRM_UNLOCKED)\n \t\t\tretcode = func(dev, kdata, file_priv);\n \t\telse {\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-1870","CWE_ID":"200","category":"security","commit_id":"8939398b82006ba1fec4ed491339fc075f43fc7c","commit_message":"From 8939398b82006ba1fec4ed491339fc075f43fc7c Mon Sep 17 00:00:00 2001\nFrom: Jakub Filak <jfilak@redhat.com>\nDate: Mon, 20 Apr 2015 07:56:34 +0200\nSubject: [PATCH] make the dump directories owned by root by default\n\nIt was discovered that the abrt event scripts create a user-readable\ncopy of a sosreport file in abrt problem directories, and include\nexcerpts of \/var\/log\/messages selected by the user-controlled process\nname, leading to an information disclosure.\n\nThis issue was discovered by Florian Weimer of Red Hat Product Security.\n\nRelated: #1212868\n\nSigned-off-by: Jakub Filak <jfilak@redhat.com>\n---\n src\/daemon\/abrt-server.c     | 34 ++++++++++++++++++++++++++++++++--\n src\/daemon\/abrt.conf         |  5 +++++\n src\/hooks\/abrt-hook-ccpp.c   | 10 +++++++---\n src\/include\/libabrt.h        |  2 ++\n src\/lib\/abrt_conf.c          |  8 ++++++++\n src\/lib\/hooklib.c            |  7 ++++++-\n src\/plugins\/abrt-dump-oops.c |  8 ++++++++\n src\/plugins\/abrt-dump-xorg.c |  8 ++++++++\n 8 files changed, 76 insertions(+), 6 deletions(-)\n\n","diff_code":"diff --git a\/src\/daemon\/abrt-server.c b\/src\/daemon\/abrt-server.c\nindex 307b41b27..5789075ca 100644\n--- a\/src\/daemon\/abrt-server.c\n+++ b\/src\/daemon\/abrt-server.c\n@@ -15,6 +15,7 @@\n   with this program; if not, write to the Free Software Foundation, Inc.,\n   51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.\n *\/\n+#include \"problem_api.h\"\n #include \"libabrt.h\"\n \n \/* Maximal length of backtrace. *\/\n@@ -153,7 +154,36 @@ static int run_post_create(const char *dirname)\n         error_msg(\"Bad problem directory name '%s', should start with: '%s'\", dirname, g_settings_dump_location);\n         return 400; \/* Bad Request *\/\n     }\n-    if (!dump_dir_accessible_by_uid(dirname, client_uid))\n+    if (g_settings_privatereports)\n+    {\n+        struct stat statbuf;\n+        if (lstat(dirname, &statbuf) != 0 || !S_ISDIR(statbuf.st_mode))\n+        {\n+            error_msg(\"Path '%s' isn't directory\", dirname);\n+            return 404; \/* Not Found *\/\n+        }\n+        \/* Get ABRT's group gid *\/\n+        struct group *gr = getgrnam(\"abrt\");\n+        if (!gr)\n+        {\n+            error_msg(\"Group 'abrt' does not exist\");\n+            return 500;\n+        }\n+        if (statbuf.st_uid != 0 || !(statbuf.st_gid == 0 || statbuf.st_gid == gr->gr_gid) || statbuf.st_mode & 07)\n+        {\n+            error_msg(\"Problem directory '%s' isn't owned by root:abrt or others are not restricted from access\", dirname);\n+            return 403;\n+        }\n+        struct dump_dir *dd = dd_opendir(dirname, DD_OPEN_READONLY);\n+        const bool complete = dd && problem_dump_dir_is_complete(dd);\n+        dd_close(dd);\n+        if (complete)\n+        {\n+            error_msg(\"Problem directory '%s' has already been processed\", dirname);\n+            return 403;\n+        }\n+    }\n+    else if (!dump_dir_accessible_by_uid(dirname, client_uid))\n     {\n         if (errno == ENOTDIR)\n         {\n@@ -377,7 +407,7 @@ static int create_problem_dir(GHashTable *problem_info, unsigned pid)\n     \/* No need to check the path length, as all variables used are limited,\n      * and dd_create() fails if the path is too long.\n      *\/\n-    struct dump_dir *dd = dd_create(path, client_uid, DEFAULT_DUMP_DIR_MODE);\n+    struct dump_dir *dd = dd_create(path, g_settings_privatereports ? 0 : client_uid, DEFAULT_DUMP_DIR_MODE);\n     if (!dd)\n     {\n         error_msg_and_die(\"Error creating problem directory '%s'\", path);\ndiff --git a\/src\/daemon\/abrt.conf b\/src\/daemon\/abrt.conf\nindex 59d183186..6c0d6b06f 100644\n--- a\/src\/daemon\/abrt.conf\n+++ b\/src\/daemon\/abrt.conf\n@@ -43,3 +43,8 @@ AutoreportingEnabled = no\n #                session; otherwise No.\n #\n # ShortenedReporting = yes\n+\n+# Disable this if you want to regular users to own the problem data colleted by\n+# abrt.\n+#\n+PrivateReports = yes\ndiff --git a\/src\/hooks\/abrt-hook-ccpp.c b\/src\/hooks\/abrt-hook-ccpp.c\nindex 00ae6214d..3a6d00252 100644\n--- a\/src\/hooks\/abrt-hook-ccpp.c\n+++ b\/src\/hooks\/abrt-hook-ccpp.c\n@@ -682,6 +682,9 @@ int main(int argc, char** argv)\n         }\n     }\n \n+    \/* If PrivateReports is on, root owns all problem directories *\/\n+    const uid_t dduid = g_settings_privatereports ? 0 : fsuid;\n+\n     \/* Open a fd to compat coredump, if requested and is possible *\/\n     if (setting_MakeCompatCore && ulimit_c != 0)\n         \/* note: checks \"user_pwd == NULL\" inside; updates core_basename *\/\n@@ -773,18 +776,19 @@ int main(int argc, char** argv)\n         goto create_user_core;\n     }\n \n-    \/* use fsuid instead of uid, so we don't expose any sensitive\n-     * information of suided app in \/var\/tmp\/abrt\n+    \/* use dduid (either fsuid or 0) instead of uid, so we don't expose any\n+     * sensitive information of suided app in \/var\/tmp\/abrt\n      *\n      * dd_create_skeleton() creates a new directory and leaves ownership to\n      * the current user, hence, we have to call dd_reset_ownership() after the\n      * directory is populated.\n      *\/\n-    dd = dd_create_skeleton(path, fsuid, DEFAULT_DUMP_DIR_MODE, \/*no flags*\/0);\n+    dd = dd_create_skeleton(path, dduid, DEFAULT_DUMP_DIR_MODE, \/*no flags*\/0);\n     if (dd)\n     {\n         char *rootdir = get_rootdir(pid);\n \n+        \/* This function uses fsuid only for its value. The function stores fsuid in a file name 'uid'*\/\n         dd_create_basic_files(dd, fsuid, NULL);\n \n         char source_filename[sizeof(\"\/proc\/%lu\/somewhat_long_name\") + sizeof(long)*3];\ndiff --git a\/src\/include\/libabrt.h b\/src\/include\/libabrt.h\nindex 85a5a5c3a..0320c5b58 100644\n--- a\/src\/include\/libabrt.h\n+++ b\/src\/include\/libabrt.h\n@@ -62,6 +62,8 @@ extern bool          g_settings_autoreporting;\n extern char *        g_settings_autoreporting_event;\n #define g_settings_shortenedreporting abrt_g_settings_shortenedreporting\n extern bool          g_settings_shortenedreporting;\n+#define g_settings_privatereports abrt_g_settings_privatereports\n+extern bool          g_settings_privatereports;\n \n \n #define load_abrt_conf abrt_load_abrt_conf\ndiff --git a\/src\/lib\/abrt_conf.c b\/src\/lib\/abrt_conf.c\nindex 5eb69e2bc..c6aba5813 100644\n--- a\/src\/lib\/abrt_conf.c\n+++ b\/src\/lib\/abrt_conf.c\n@@ -27,6 +27,7 @@ bool          g_settings_delete_uploaded = 0;\n bool          g_settings_autoreporting = 0;\n char *        g_settings_autoreporting_event = NULL;\n bool          g_settings_shortenedreporting = 0;\n+bool          g_settings_privatereports = true;\n \n void free_abrt_conf_data()\n {\n@@ -102,6 +103,13 @@ static void ParseCommon(map_string_t *settings, const char *conf_filename)\n     else\n         g_settings_shortenedreporting = 0;\n \n+    value = get_map_string_item_or_NULL(settings, \"PrivateReports\");\n+    if (value)\n+    {\n+        g_settings_privatereports = string_to_bool(value);\n+        remove_map_string_item(settings, \"PrivateReports\");\n+    }\n+\n     GHashTableIter iter;\n     const char *name;\n     \/*char *value; - already declared *\/\ndiff --git a\/src\/lib\/hooklib.c b\/src\/lib\/hooklib.c\nindex 1d45cdd20..fb7750da8 100644\n--- a\/src\/lib\/hooklib.c\n+++ b\/src\/lib\/hooklib.c\n@@ -410,7 +410,12 @@ char* problem_data_save(problem_data_t *pd)\n {\n     load_abrt_conf();\n \n-    struct dump_dir *dd = create_dump_dir_from_problem_data(pd, g_settings_dump_location);\n+    struct dump_dir *dd = NULL;\n+\n+    if (g_settings_privatereports)\n+        dd = create_dump_dir_from_problem_data_ext(pd, g_settings_dump_location, 0);\n+    else\n+        dd = create_dump_dir_from_problem_data(pd, g_settings_dump_location);\n \n     char *problem_id = NULL;\n     if (dd)\ndiff --git a\/src\/plugins\/abrt-dump-oops.c b\/src\/plugins\/abrt-dump-oops.c\nindex 9f0dc8794..05cb72881 100644\n--- a\/src\/plugins\/abrt-dump-oops.c\n+++ b\/src\/plugins\/abrt-dump-oops.c\n@@ -189,6 +189,14 @@ static unsigned create_oops_dump_dirs(GList *oops_list, unsigned oops_cnt)\n         mode = DEFAULT_DUMP_DIR_MODE;\n         my_euid = geteuid();\n     }\n+    if (g_settings_privatereports)\n+    {\n+        if (world_readable_dump)\n+            log(\"Not going to make dump directories world readable because PrivateReports is on\");\n+\n+        mode = DEFAULT_DUMP_DIR_MODE;\n+        my_euid = 0;\n+    }\n \n     pid_t my_pid = getpid();\n     unsigned idx = 0;\ndiff --git a\/src\/plugins\/abrt-dump-xorg.c b\/src\/plugins\/abrt-dump-xorg.c\nindex 3500629ac..434dc7640 100644\n--- a\/src\/plugins\/abrt-dump-xorg.c\n+++ b\/src\/plugins\/abrt-dump-xorg.c\n@@ -82,6 +82,14 @@ static void save_bt_to_dump_dir(const char *bt, const char *exe, const char *rea\n         mode = DEFAULT_DUMP_DIR_MODE;\n         my_euid = geteuid();\n     }\n+    if (g_settings_privatereports)\n+    {\n+        if ((g_opts & OPT_x))\n+            log(\"Not going to make dump directories world readable because PrivateReports is on\");\n+\n+        mode = DEFAULT_DUMP_DIR_MODE;\n+        my_euid = 0;\n+    }\n \n     pid_t my_pid = getpid();\n \n","owner":"abrt","repo":"abrt","source":"cve"},{"CVE_ID":"CVE-2016-4485","CWE_ID":"200","category":"security","commit_id":"b8670c09f37bdf2847cc44f36511a53afc6161fd","commit_message":"From b8670c09f37bdf2847cc44f36511a53afc6161fd Mon Sep 17 00:00:00 2001\nFrom: Kangjie Lu <kangjielu@gmail.com>\nDate: Tue, 3 May 2016 16:35:05 -0400\nSubject: net: fix infoleak in llc\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nThe stack object \u201cinfo\u201d has a total size of 12 bytes. Its last byte\nis padding which is not initialized and leaked via \u201cput_cmsg\u201d.\n\nSigned-off-by: Kangjie Lu <kjlu@gatech.edu>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/llc\/af_llc.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/llc\/af_llc.c b\/net\/llc\/af_llc.c\nindex b3c52e3f689a..8ae3ed97d95c 100644\n--- a\/net\/llc\/af_llc.c\n+++ b\/net\/llc\/af_llc.c\n@@ -626,6 +626,7 @@ static void llc_cmsg_rcv(struct msghdr *msg, struct sk_buff *skb)\n \tif (llc->cmsg_flags & LLC_CMSG_PKTINFO) {\n \t\tstruct llc_pktinfo info;\n \n+\t\tmemset(&info, 0, sizeof(info));\n \t\tinfo.lpi_ifindex = llc_sk(skb->sk)->dev->ifindex;\n \t\tllc_pdu_decode_dsap(skb, &info.lpi_sap);\n \t\tllc_pdu_decode_da(skb, info.lpi_mac);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2017-2584","CWE_ID":"200","category":"security","commit_id":"129a72a0d3c8e139a04512325384fe5ac119e74d","commit_message":"From 129a72a0d3c8e139a04512325384fe5ac119e74d Mon Sep 17 00:00:00 2001\nFrom: Steve Rutherford <srutherford@google.com>\nDate: Wed, 11 Jan 2017 18:28:29 -0800\nSubject: [PATCH] KVM: x86: Introduce segmented_write_std\n\nIntroduces segemented_write_std.\n\nSwitches from emulated reads\/writes to standard read\/writes in fxsave,\nfxrstor, sgdt, and sidt.  This fixes CVE-2017-2584, a longstanding\nkernel memory leak.\n\nSince commit 283c95d0e389 (\"KVM: x86: emulate FXSAVE and FXRSTOR\",\n2016-11-09), which is luckily not yet in any final release, this would\nalso be an exploitable kernel memory *write*!\n\nReported-by: Dmitry Vyukov <dvyukov@google.com>\nCc: stable@vger.kernel.org\nFixes: 96051572c819194c37a8367624b285be10297eca\nFixes: 283c95d0e3891b64087706b344a4b545d04a6e62\nSuggested-by: Paolo Bonzini <pbonzini@redhat.com>\nSigned-off-by: Steve Rutherford <srutherford@google.com>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>\n---\n arch\/x86\/kvm\/emulate.c | 22 ++++++++++++++++++----\n 1 file changed, 18 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/arch\/x86\/kvm\/emulate.c b\/arch\/x86\/kvm\/emulate.c\nindex 56628a44668b7..f36d0fa6b8854 100644\n--- a\/arch\/x86\/kvm\/emulate.c\n+++ b\/arch\/x86\/kvm\/emulate.c\n@@ -818,6 +818,20 @@ static int segmented_read_std(struct x86_emulate_ctxt *ctxt,\n \treturn ctxt->ops->read_std(ctxt, linear, data, size, &ctxt->exception);\n }\n \n+static int segmented_write_std(struct x86_emulate_ctxt *ctxt,\n+\t\t\t       struct segmented_address addr,\n+\t\t\t       void *data,\n+\t\t\t       unsigned int size)\n+{\n+\tint rc;\n+\tulong linear;\n+\n+\trc = linearize(ctxt, addr, size, true, &linear);\n+\tif (rc != X86EMUL_CONTINUE)\n+\t\treturn rc;\n+\treturn ctxt->ops->write_std(ctxt, linear, data, size, &ctxt->exception);\n+}\n+\n \/*\n  * Prefetch the remaining bytes of the instruction without crossing page\n  * boundary if they are not in fetch_cache yet.\n@@ -3685,8 +3699,8 @@ static int emulate_store_desc_ptr(struct x86_emulate_ctxt *ctxt,\n \t}\n \t\/* Disable writeback. *\/\n \tctxt->dst.type = OP_NONE;\n-\treturn segmented_write(ctxt, ctxt->dst.addr.mem,\n-\t\t\t       &desc_ptr, 2 + ctxt->op_bytes);\n+\treturn segmented_write_std(ctxt, ctxt->dst.addr.mem,\n+\t\t\t\t   &desc_ptr, 2 + ctxt->op_bytes);\n }\n \n static int em_sgdt(struct x86_emulate_ctxt *ctxt)\n@@ -3932,7 +3946,7 @@ static int em_fxsave(struct x86_emulate_ctxt *ctxt)\n \telse\n \t\tsize = offsetof(struct fxregs_state, xmm_space[0]);\n \n-\treturn segmented_write(ctxt, ctxt->memop.addr.mem, &fx_state, size);\n+\treturn segmented_write_std(ctxt, ctxt->memop.addr.mem, &fx_state, size);\n }\n \n static int fxrstor_fixup(struct x86_emulate_ctxt *ctxt,\n@@ -3974,7 +3988,7 @@ static int em_fxrstor(struct x86_emulate_ctxt *ctxt)\n \tif (rc != X86EMUL_CONTINUE)\n \t\treturn rc;\n \n-\trc = segmented_read(ctxt, ctxt->memop.addr.mem, &fx_state, 512);\n+\trc = segmented_read_std(ctxt, ctxt->memop.addr.mem, &fx_state, 512);\n \tif (rc != X86EMUL_CONTINUE)\n \t\treturn rc;\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2019-10639","CWE_ID":"200","category":"security","commit_id":"355b98553789b646ed97ad801a619ff898471b92","commit_message":"From 355b98553789b646ed97ad801a619ff898471b92 Mon Sep 17 00:00:00 2001\nFrom: Eric Dumazet <edumazet@google.com>\nDate: Wed, 27 Mar 2019 08:21:30 -0700\nSubject: netns: provide pure entropy for net_hash_mix()\n\nnet_hash_mix() currently uses kernel address of a struct net,\nand is used in many places that could be used to reveal this\naddress to a patient attacker, thus defeating KASLR, for\nthe typical case (initial net namespace, &init_net is\nnot dynamically allocated)\n\nI believe the original implementation tried to avoid spending\ntoo many cycles in this function, but security comes first.\n\nAlso provide entropy regardless of CONFIG_NET_NS.\n\nFixes: 0b4419162aa6 (\"netns: introduce the net_hash_mix \"salt\" for hashes\")\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nReported-by: Amit Klein <aksecurity@gmail.com>\nReported-by: Benny Pinkas <benny@pinkas.net>\nCc: Pavel Emelyanov <xemul@openvz.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n include\/net\/net_namespace.h |  1 +\n include\/net\/netns\/hash.h    | 10 ++--------\n net\/core\/net_namespace.c    |  1 +\n 3 files changed, 4 insertions(+), 8 deletions(-)\n\n","diff_code":"diff --git a\/include\/net\/net_namespace.h b\/include\/net\/net_namespace.h\nindex a68ced28d8f4..12689ddfc24c 100644\n--- a\/include\/net\/net_namespace.h\n+++ b\/include\/net\/net_namespace.h\n@@ -59,6 +59,7 @@ struct net {\n \t\t\t\t\t\t *\/\n \tspinlock_t\t\trules_mod_lock;\n \n+\tu32\t\t\thash_mix;\n \tatomic64_t\t\tcookie_gen;\n \n \tstruct list_head\tlist;\t\t\/* list of network namespaces *\/\ndiff --git a\/include\/net\/netns\/hash.h b\/include\/net\/netns\/hash.h\nindex 16a842456189..d9b665151f3d 100644\n--- a\/include\/net\/netns\/hash.h\n+++ b\/include\/net\/netns\/hash.h\n@@ -2,16 +2,10 @@\n #ifndef __NET_NS_HASH_H__\n #define __NET_NS_HASH_H__\n \n-#include <asm\/cache.h>\n-\n-struct net;\n+#include <net\/net_namespace.h>\n \n static inline u32 net_hash_mix(const struct net *net)\n {\n-#ifdef CONFIG_NET_NS\n-\treturn (u32)(((unsigned long)net) >> ilog2(sizeof(*net)));\n-#else\n-\treturn 0;\n-#endif\n+\treturn net->hash_mix;\n }\n #endif\ndiff --git a\/net\/core\/net_namespace.c b\/net\/core\/net_namespace.c\nindex 17f36317363d..7e6dcc625701 100644\n--- a\/net\/core\/net_namespace.c\n+++ b\/net\/core\/net_namespace.c\n@@ -304,6 +304,7 @@ static __net_init int setup_net(struct net *net, struct user_namespace *user_ns)\n \n \trefcount_set(&net->count, 1);\n \trefcount_set(&net->passive, 1);\n+\tget_random_bytes(&net->hash_mix, sizeof(u32));\n \tnet->dev_base_seq = 1;\n \tnet->user_ns = user_ns;\n \tidr_init(&net->netns_ids);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-6544","CWE_ID":"200","category":"security","commit_id":"e15ca9a0ef9a86f0477530b0f44a725d67f889ee","commit_message":"From e15ca9a0ef9a86f0477530b0f44a725d67f889ee Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:46 +0000\nSubject: Bluetooth: HCI - Fix info leak in getsockopt(HCI_FILTER)\n\nThe HCI code fails to initialize the two padding bytes of struct\nhci_ufilter before copying it to userland -- that for leaking two\nbytes kernel stack. Add an explicit memset(0) before filling the\nstructure to avoid the info leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Gustavo Padovan <gustavo@padovan.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/bluetooth\/hci_sock.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/bluetooth\/hci_sock.c b\/net\/bluetooth\/hci_sock.c\nindex a7f04de03d79..a27bbc3cd4b7 100644\n--- a\/net\/bluetooth\/hci_sock.c\n+++ b\/net\/bluetooth\/hci_sock.c\n@@ -1009,6 +1009,7 @@ static int hci_sock_getsockopt(struct socket *sock, int level, int optname,\n \t\t{\n \t\t\tstruct hci_filter *f = &hci_pi(sk)->filter;\n \n+\t\t\tmemset(&uf, 0, sizeof(uf));\n \t\t\tuf.type_mask = f->type_mask;\n \t\t\tuf.opcode    = f->opcode;\n \t\t\tuf.event_mask[0] = *((u32 *) f->event_mask + 0);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-7264","CWE_ID":"200","category":"security","commit_id":"bceaa90240b6019ed73b49965eac7d167610be69","commit_message":"From bceaa90240b6019ed73b49965eac7d167610be69 Mon Sep 17 00:00:00 2001\nFrom: Hannes Frederic Sowa <hannes@stressinduktion.org>\nDate: Mon, 18 Nov 2013 04:20:45 +0100\nSubject: inet: prevent leakage of uninitialized memory to user in recv\n syscalls\n\nOnly update *addr_len when we actually fill in sockaddr, otherwise we\ncan return uninitialized memory from the stack to the caller in the\nrecvfrom, recvmmsg and recvmsg syscalls. Drop the the (addr_len == NULL)\nchecks because we only get called with a valid addr_len pointer either\nfrom sock_common_recvmsg or inet_recvmsg.\n\nIf a blocking read waits on a socket which is concurrently shut down we\nnow return zero and set msg_msgnamelen to 0.\n\nReported-by: mpb <mpb.mail@gmail.com>\nSuggested-by: Eric Dumazet <eric.dumazet@gmail.com>\nSigned-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/ieee802154\/dgram.c |  3 +--\n net\/ipv4\/ping.c        | 19 +++++++------------\n net\/ipv4\/raw.c         |  4 +---\n net\/ipv4\/udp.c         |  7 +------\n net\/ipv6\/raw.c         |  4 +---\n net\/ipv6\/udp.c         |  5 +----\n net\/l2tp\/l2tp_ip.c     |  4 +---\n net\/phonet\/datagram.c  |  9 ++++-----\n 8 files changed, 17 insertions(+), 38 deletions(-)\n\n","diff_code":"diff --git a\/net\/ieee802154\/dgram.c b\/net\/ieee802154\/dgram.c\nindex 581a59504bd5..1865fdf5a5a5 100644\n--- a\/net\/ieee802154\/dgram.c\n+++ b\/net\/ieee802154\/dgram.c\n@@ -315,9 +315,8 @@ static int dgram_recvmsg(struct kiocb *iocb, struct sock *sk,\n \tif (saddr) {\n \t\tsaddr->family = AF_IEEE802154;\n \t\tsaddr->addr = mac_cb(skb)->sa;\n-\t}\n-\tif (addr_len)\n \t\t*addr_len = sizeof(*saddr);\n+\t}\n \n \tif (flags & MSG_TRUNC)\n \t\tcopied = skb->len;\ndiff --git a\/net\/ipv4\/ping.c b\/net\/ipv4\/ping.c\nindex 9afbdb19f4a2..aacefa0caa36 100644\n--- a\/net\/ipv4\/ping.c\n+++ b\/net\/ipv4\/ping.c\n@@ -830,8 +830,6 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n {\n \tstruct inet_sock *isk = inet_sk(sk);\n \tint family = sk->sk_family;\n-\tstruct sockaddr_in *sin;\n-\tstruct sockaddr_in6 *sin6;\n \tstruct sk_buff *skb;\n \tint copied, err;\n \n@@ -841,13 +839,6 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \tif (flags & MSG_OOB)\n \t\tgoto out;\n \n-\tif (addr_len) {\n-\t\tif (family == AF_INET)\n-\t\t\t*addr_len = sizeof(*sin);\n-\t\telse if (family == AF_INET6 && addr_len)\n-\t\t\t*addr_len = sizeof(*sin6);\n-\t}\n-\n \tif (flags & MSG_ERRQUEUE) {\n \t\tif (family == AF_INET) {\n \t\t\treturn ip_recv_error(sk, msg, len);\n@@ -877,11 +868,13 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \n \t\/* Copy the address and add cmsg data. *\/\n \tif (family == AF_INET) {\n-\t\tsin = (struct sockaddr_in *) msg->msg_name;\n+\t\tstruct sockaddr_in *sin = (struct sockaddr_in *)msg->msg_name;\n+\n \t\tsin->sin_family = AF_INET;\n \t\tsin->sin_port = 0 \/* skb->h.uh->source *\/;\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tmemset(sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \n \t\tif (isk->cmsg_flags)\n \t\t\tip_cmsg_recv(msg, skb);\n@@ -890,17 +883,19 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \t} else if (family == AF_INET6) {\n \t\tstruct ipv6_pinfo *np = inet6_sk(sk);\n \t\tstruct ipv6hdr *ip6 = ipv6_hdr(skb);\n-\t\tsin6 = (struct sockaddr_in6 *) msg->msg_name;\n+\t\tstruct sockaddr_in6 *sin6 =\n+\t\t\t(struct sockaddr_in6 *)msg->msg_name;\n+\n \t\tsin6->sin6_family = AF_INET6;\n \t\tsin6->sin6_port = 0;\n \t\tsin6->sin6_addr = ip6->saddr;\n-\n \t\tsin6->sin6_flowinfo = 0;\n \t\tif (np->sndflow)\n \t\t\tsin6->sin6_flowinfo = ip6_flowinfo(ip6);\n \n \t\tsin6->sin6_scope_id = ipv6_iface_scope_id(&sin6->sin6_addr,\n \t\t\t\t\t\t\t  IP6CB(skb)->iif);\n+\t\t*addr_len = sizeof(*sin6);\n \n \t\tif (inet6_sk(sk)->rxopt.all)\n \t\t\tpingv6_ops.ip6_datagram_recv_ctl(sk, msg, skb);\ndiff --git a\/net\/ipv4\/raw.c b\/net\/ipv4\/raw.c\nindex 41e1d2845c8f..5cb8ddb505ee 100644\n--- a\/net\/ipv4\/raw.c\n+++ b\/net\/ipv4\/raw.c\n@@ -696,9 +696,6 @@ static int raw_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \tif (flags & MSG_OOB)\n \t\tgoto out;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(*sin);\n-\n \tif (flags & MSG_ERRQUEUE) {\n \t\terr = ip_recv_error(sk, msg, len);\n \t\tgoto out;\n@@ -726,6 +723,7 @@ static int raw_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tsin->sin_port = 0;\n \t\tmemset(&sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \t}\n \tif (inet->cmsg_flags)\n \t\tip_cmsg_recv(msg, skb);\ndiff --git a\/net\/ipv4\/udp.c b\/net\/ipv4\/udp.c\nindex 89909dd730dd..998431cd471a 100644\n--- a\/net\/ipv4\/udp.c\n+++ b\/net\/ipv4\/udp.c\n@@ -1235,12 +1235,6 @@ int udp_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \tint is_udplite = IS_UDPLITE(sk);\n \tbool slow;\n \n-\t\/*\n-\t *\tCheck any passed addresses\n-\t *\/\n-\tif (addr_len)\n-\t\t*addr_len = sizeof(*sin);\n-\n \tif (flags & MSG_ERRQUEUE)\n \t\treturn ip_recv_error(sk, msg, len);\n \n@@ -1302,6 +1296,7 @@ try_again:\n \t\tsin->sin_port = udp_hdr(skb)->source;\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tmemset(sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \t}\n \tif (inet->cmsg_flags)\n \t\tip_cmsg_recv(msg, skb);\ndiff --git a\/net\/ipv6\/raw.c b\/net\/ipv6\/raw.c\nindex 3c00842b0079..e24ff1df0401 100644\n--- a\/net\/ipv6\/raw.c\n+++ b\/net\/ipv6\/raw.c\n@@ -465,9 +465,6 @@ static int rawv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \tif (flags & MSG_OOB)\n \t\treturn -EOPNOTSUPP;\n \n-\tif (addr_len)\n-\t\t*addr_len=sizeof(*sin6);\n-\n \tif (flags & MSG_ERRQUEUE)\n \t\treturn ipv6_recv_error(sk, msg, len);\n \n@@ -506,6 +503,7 @@ static int rawv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \t\tsin6->sin6_flowinfo = 0;\n \t\tsin6->sin6_scope_id = ipv6_iface_scope_id(&sin6->sin6_addr,\n \t\t\t\t\t\t\t  IP6CB(skb)->iif);\n+\t\t*addr_len = sizeof(*sin6);\n \t}\n \n \tsock_recv_ts_and_drops(msg, sk, skb);\ndiff --git a\/net\/ipv6\/udp.c b\/net\/ipv6\/udp.c\nindex f3893e897f72..81eb8cf8389b 100644\n--- a\/net\/ipv6\/udp.c\n+++ b\/net\/ipv6\/udp.c\n@@ -392,9 +392,6 @@ int udpv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \tint is_udp4;\n \tbool slow;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(struct sockaddr_in6);\n-\n \tif (flags & MSG_ERRQUEUE)\n \t\treturn ipv6_recv_error(sk, msg, len);\n \n@@ -480,7 +477,7 @@ try_again:\n \t\t\t\tipv6_iface_scope_id(&sin6->sin6_addr,\n \t\t\t\t\t\t    IP6CB(skb)->iif);\n \t\t}\n-\n+\t\t*addr_len = sizeof(*sin6);\n \t}\n \tif (is_udp4) {\n \t\tif (inet->cmsg_flags)\ndiff --git a\/net\/l2tp\/l2tp_ip.c b\/net\/l2tp\/l2tp_ip.c\nindex 571db8dd2292..da1a1cee1a08 100644\n--- a\/net\/l2tp\/l2tp_ip.c\n+++ b\/net\/l2tp\/l2tp_ip.c\n@@ -518,9 +518,6 @@ static int l2tp_ip_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *m\n \tif (flags & MSG_OOB)\n \t\tgoto out;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(*sin);\n-\n \tskb = skb_recv_datagram(sk, flags, noblock, &err);\n \tif (!skb)\n \t\tgoto out;\n@@ -543,6 +540,7 @@ static int l2tp_ip_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *m\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tsin->sin_port = 0;\n \t\tmemset(&sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \t}\n \tif (inet->cmsg_flags)\n \t\tip_cmsg_recv(msg, skb);\ndiff --git a\/net\/phonet\/datagram.c b\/net\/phonet\/datagram.c\nindex 12c30f3e643e..38946b26e471 100644\n--- a\/net\/phonet\/datagram.c\n+++ b\/net\/phonet\/datagram.c\n@@ -139,9 +139,6 @@ static int pn_recvmsg(struct kiocb *iocb, struct sock *sk,\n \t\t\tMSG_CMSG_COMPAT))\n \t\tgoto out_nofree;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(sa);\n-\n \tskb = skb_recv_datagram(sk, flags, noblock, &rval);\n \tif (skb == NULL)\n \t\tgoto out_nofree;\n@@ -162,8 +159,10 @@ static int pn_recvmsg(struct kiocb *iocb, struct sock *sk,\n \n \trval = (flags & MSG_TRUNC) ? skb->len : copylen;\n \n-\tif (msg->msg_name != NULL)\n-\t\tmemcpy(msg->msg_name, &sa, sizeof(struct sockaddr_pn));\n+\tif (msg->msg_name != NULL) {\n+\t\tmemcpy(msg->msg_name, &sa, sizeof(sa));\n+\t\t*addr_len = sizeof(sa);\n+\t}\n \n out:\n \tskb_free_datagram(sk, skb);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-6541","CWE_ID":"200","category":"security","commit_id":"7b07f8eb75aa3097cdfd4f6eac3da49db787381d","commit_message":"From 7b07f8eb75aa3097cdfd4f6eac3da49db787381d Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:55 +0000\nSubject: [PATCH] dccp: fix info leak via getsockopt(DCCP_SOCKOPT_CCID_TX_INFO)\n\nThe CCID3 code fails to initialize the trailing padding bytes of struct\ntfrc_tx_info added for alignment on 64 bit architectures. It that for\npotentially leaks four bytes kernel stack via the getsockopt() syscall.\nAdd an explicit memset(0) before filling the structure to avoid the\ninfo leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nCc: Gerrit Renker <gerrit@erg.abdn.ac.uk>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/dccp\/ccids\/ccid3.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/dccp\/ccids\/ccid3.c b\/net\/dccp\/ccids\/ccid3.c\nindex d65e98798ecaf..119c04317d48e 100644\n--- a\/net\/dccp\/ccids\/ccid3.c\n+++ b\/net\/dccp\/ccids\/ccid3.c\n@@ -535,6 +535,7 @@ static int ccid3_hc_tx_getsockopt(struct sock *sk, const int optname, int len,\n \tcase DCCP_SOCKOPT_CCID_TX_INFO:\n \t\tif (len < sizeof(tfrc))\n \t\t\treturn -EINVAL;\n+\t\tmemset(&tfrc, 0, sizeof(tfrc));\n \t\ttfrc.tfrctx_x\t   = hc->tx_x;\n \t\ttfrc.tfrctx_x_recv = hc->tx_x_recv;\n \t\ttfrc.tfrctx_x_calc = hc->tx_x_calc;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-2383","CWE_ID":"200","category":"security","commit_id":"a1b14d27ed0965838350f1377ff97c93ee383492","commit_message":"From a1b14d27ed0965838350f1377ff97c93ee383492 Mon Sep 17 00:00:00 2001\nFrom: Daniel Borkmann <daniel@iogearbox.net>\nDate: Wed, 10 Feb 2016 16:47:11 +0100\nSubject: [PATCH] bpf: fix branch offset adjustment on backjumps after patching\n ctx expansion\n\nWhen ctx access is used, the kernel often needs to expand\/rewrite\ninstructions, so after that patching, branch offsets have to be\nadjusted for both forward and backward jumps in the new eBPF program,\nbut for backward jumps it fails to account the delta. Meaning, for\nexample, if the expansion happens exactly on the insn that sits at\nthe jump target, it doesn't fix up the back jump offset.\n\nAnalysis on what the check in adjust_branches() is currently doing:\n\n  \/* adjust offset of jmps if necessary *\/\n  if (i < pos && i + insn->off + 1 > pos)\n    insn->off += delta;\n  else if (i > pos && i + insn->off + 1 < pos)\n    insn->off -= delta;\n\nFirst condition (forward jumps):\n\n  Before:                         After:\n\n  insns[0]                        insns[0]\n  insns[1] <--- i\/insn            insns[1] <--- i\/insn\n  insns[2] <--- pos               insns[P] <--- pos\n  insns[3]                        insns[P]  `------| delta\n  insns[4] <--- target_X          insns[P]   `-----|\n  insns[5]                        insns[3]\n                                  insns[4] <--- target_X\n                                  insns[5]\n\nFirst case is if we cross pos-boundary and the jump instruction was\nbefore pos. This is handeled correctly. I.e. if i == pos, then this\nwould mean our jump that we currently check was the patchlet itself\nthat we just injected. Since such patchlets are self-contained and\nhave no awareness of any insns before or after the patched one, the\ndelta is correctly not adjusted. Also, for the second condition in\ncase of i + insn->off + 1 == pos, means we jump to that newly patched\ninstruction, so no offset adjustment are needed. That part is correct.\n\nSecond condition (backward jumps):\n\n  Before:                         After:\n\n  insns[0]                        insns[0]\n  insns[1] <--- target_X          insns[1] <--- target_X\n  insns[2] <--- pos <-- target_Y  insns[P] <--- pos <-- target_Y\n  insns[3]                        insns[P]  `------| delta\n  insns[4] <--- i\/insn            insns[P]   `-----|\n  insns[5]                        insns[3]\n                                  insns[4] <--- i\/insn\n                                  insns[5]\n\nSecond interesting case is where we cross pos-boundary and the jump\ninstruction was after pos. Backward jump with i == pos would be\nimpossible and pose a bug somewhere in the patchlet, so the first\ncondition checking i > pos is okay only by itself. However, i +\ninsn->off + 1 < pos does not always work as intended to trigger the\nadjustment. It works when jump targets would be far off where the\ndelta wouldn't matter. But, for example, where the fixed insn->off\nbefore pointed to pos (target_Y), it now points to pos + delta, so\nthat additional room needs to be taken into account for the check.\nThis means that i) both tests here need to be adjusted into pos + delta,\nand ii) for the second condition, the test needs to be <= as pos\nitself can be a target in the backjump, too.\n\nFixes: 9bac3d6d548e (\"bpf: allow extended BPF programs access skb fields\")\nSigned-off-by: Daniel Borkmann <daniel@iogearbox.net>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n kernel\/bpf\/verifier.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/kernel\/bpf\/verifier.c b\/kernel\/bpf\/verifier.c\nindex d1d3e8f57de90..2e7f7ab739e41 100644\n--- a\/kernel\/bpf\/verifier.c\n+++ b\/kernel\/bpf\/verifier.c\n@@ -2082,7 +2082,7 @@ static void adjust_branches(struct bpf_prog *prog, int pos, int delta)\n \t\t\/* adjust offset of jmps if necessary *\/\n \t\tif (i < pos && i + insn->off + 1 > pos)\n \t\t\tinsn->off += delta;\n-\t\telse if (i > pos && i + insn->off + 1 < pos)\n+\t\telse if (i > pos + delta && i + insn->off + 1 <= pos + delta)\n \t\t\tinsn->off -= delta;\n \t}\n }\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-6544","CWE_ID":"200","category":"security","commit_id":"792039c73cf176c8e39a6e8beef2c94ff46522ed","commit_message":"From 792039c73cf176c8e39a6e8beef2c94ff46522ed Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:51 +0000\nSubject: [PATCH] Bluetooth: L2CAP - Fix info leak via getsockname()\n\nThe L2CAP code fails to initialize the l2_bdaddr_type member of struct\nsockaddr_l2 and the padding byte added for alignment. It that for leaks\ntwo bytes kernel stack via the getsockname() syscall. Add an explicit\nmemset(0) before filling the structure to avoid the info leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Gustavo Padovan <gustavo@padovan.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/bluetooth\/l2cap_sock.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/bluetooth\/l2cap_sock.c b\/net\/bluetooth\/l2cap_sock.c\nindex b94abd30e6f94..1497edd191a2e 100644\n--- a\/net\/bluetooth\/l2cap_sock.c\n+++ b\/net\/bluetooth\/l2cap_sock.c\n@@ -245,6 +245,7 @@ static int l2cap_sock_getname(struct socket *sock, struct sockaddr *addr, int *l\n \n \tBT_DBG(\"sock %p, sk %p\", sock, sk);\n \n+\tmemset(la, 0, sizeof(struct sockaddr_l2));\n \taddr->sa_family = AF_BLUETOOTH;\n \t*len = sizeof(struct sockaddr_l2);\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-3228","CWE_ID":"200","category":"security","commit_id":"5ae94c0d2f0bed41d6718be743985d61b7f5c47d","commit_message":"From 5ae94c0d2f0bed41d6718be743985d61b7f5c47d Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:53 +0000\nSubject: [PATCH] irda: Fix missing msg_namelen update in irda_recvmsg_dgram()\n\nThe current code does not fill the msg_name member in case it is set.\nIt also does not set the msg_namelen member to 0 and therefore makes\nnet\/socket.c leak the local, uninitialized sockaddr_storage variable\nto userland -- 128 bytes of kernel stack memory.\n\nFix that by simply setting msg_namelen to 0 as obviously nobody cared\nabout irda_recvmsg_dgram() not filling the msg_name in case it was\nset.\n\nCc: Samuel Ortiz <samuel@sortiz.org>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/irda\/af_irda.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/net\/irda\/af_irda.c b\/net\/irda\/af_irda.c\nindex d28e7f014cc63..e493b3397ae33 100644\n--- a\/net\/irda\/af_irda.c\n+++ b\/net\/irda\/af_irda.c\n@@ -1386,6 +1386,8 @@ static int irda_recvmsg_dgram(struct kiocb *iocb, struct socket *sock,\n \n \tIRDA_DEBUG(4, \"%s()\\n\", __func__);\n \n+\tmsg->msg_namelen = 0;\n+\n \tskb = skb_recv_datagram(sk, flags & ~MSG_DONTWAIT,\n \t\t\t\tflags & MSG_DONTWAIT, &err);\n \tif (!skb)\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-4020","CWE_ID":"200","category":"security","commit_id":"691a02e2ce0c413236a78dee6f2651c937b09fb0","commit_message":"From 691a02e2ce0c413236a78dee6f2651c937b09fb0 Mon Sep 17 00:00:00 2001\nFrom: Prasad J Pandit <pjp@fedoraproject.org>\nDate: Thu, 7 Apr 2016 12:50:08 +0530\nSubject: [PATCH] i386: kvmvapic: initialise imm32 variable\n\nWhen processing Task Priorty Register(TPR) access, it could leak\nautomatic stack variable 'imm32' in patch_instruction().\nInitialise the variable to avoid it.\n\nReported by: Donghai Zdh <donghai.zdh@alibaba-inc.com>\nCc: qemu-stable@nongnu.org\nSigned-off-by: Prasad J Pandit <pjp@fedoraproject.org>\nMessage-Id: <1460013608-16670-1-git-send-email-ppandit@redhat.com>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>\n---\n hw\/i386\/kvmvapic.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/hw\/i386\/kvmvapic.c b\/hw\/i386\/kvmvapic.c\nindex 8fd27ba..5b71b1b 100644\n--- a\/hw\/i386\/kvmvapic.c\n+++ b\/hw\/i386\/kvmvapic.c\n@@ -397,7 +397,7 @@ static void patch_instruction(VAPICROMState *s, X86CPU *cpu, target_ulong ip)\n     CPUX86State *env = &cpu->env;\n     VAPICHandlers *handlers;\n     uint8_t opcode[2];\n-    uint32_t imm32;\n+    uint32_t imm32 = 0;\n     target_ulong current_pc = 0;\n     target_ulong current_cs_base = 0;\n     uint32_t current_flags = 0;\n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2009-2691","CWE_ID":"200","category":"security","commit_id":"13f0feafa6b8aead57a2a328e2fca6a5828bf286","commit_message":"From 13f0feafa6b8aead57a2a328e2fca6a5828bf286 Mon Sep 17 00:00:00 2001\nFrom: Oleg Nesterov <oleg@redhat.com>\nDate: Tue, 23 Jun 2009 21:25:32 +0200\nSubject: mm_for_maps: simplify, use ptrace_may_access()\n\nIt would be nice to kill __ptrace_may_access(). It requires task_lock(),\nbut this lock is only needed to read mm->flags in the middle.\n\nConvert mm_for_maps() to use ptrace_may_access(), this also simplifies\nthe code a little bit.\n\nAlso, we do not need to take ->mmap_sem in advance. In fact I think\nmm_for_maps() should not play with ->mmap_sem at all, the caller should\ntake this lock.\n\nWith or without this patch, without ->cred_guard_mutex held we can race\nwith exec() and get the new ->mm but check old creds.\n\nSigned-off-by: Oleg Nesterov <oleg@redhat.com>\nReviewed-by: Serge Hallyn <serue@us.ibm.com>\nSigned-off-by: James Morris <jmorris@namei.org>\n---\n fs\/proc\/base.c | 23 +++++++++++------------\n 1 file changed, 11 insertions(+), 12 deletions(-)\n\n","diff_code":"diff --git a\/fs\/proc\/base.c b\/fs\/proc\/base.c\nindex 3ce5ae9e3d2d..917f338a6739 100644\n--- a\/fs\/proc\/base.c\n+++ b\/fs\/proc\/base.c\n@@ -237,20 +237,19 @@ struct mm_struct *mm_for_maps(struct task_struct *task)\n \tstruct mm_struct *mm = get_task_mm(task);\n \tif (!mm)\n \t\treturn NULL;\n+\tif (mm != current->mm) {\n+\t\t\/*\n+\t\t * task->mm can be changed before security check,\n+\t\t * in that case we must notice the change after.\n+\t\t *\/\n+\t\tif (!ptrace_may_access(task, PTRACE_MODE_READ) ||\n+\t\t    mm != task->mm) {\n+\t\t\tmmput(mm);\n+\t\t\treturn NULL;\n+\t\t}\n+\t}\n \tdown_read(&mm->mmap_sem);\n-\ttask_lock(task);\n-\tif (task->mm != mm)\n-\t\tgoto out;\n-\tif (task->mm != current->mm &&\n-\t    __ptrace_may_access(task, PTRACE_MODE_READ) < 0)\n-\t\tgoto out;\n-\ttask_unlock(task);\n \treturn mm;\n-out:\n-\ttask_unlock(task);\n-\tup_read(&mm->mmap_sem);\n-\tmmput(mm);\n-\treturn NULL;\n }\n \n static int proc_pid_cmdline(struct task_struct *task, char * buffer)\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2019-6976","CWE_ID":"200","category":"security","commit_id":"00622428bda8d7521db8d74260b519fa41d69d0a","commit_message":"From 00622428bda8d7521db8d74260b519fa41d69d0a Mon Sep 17 00:00:00 2001\nFrom: John Cupitt <jcupitt@gmail.com>\nDate: Fri, 18 Jan 2019 10:10:43 +0000\nSubject: [PATCH] zero memory on malloc\n\nto prevent write of uninit memory under some error conditions\n\nthanks Balint\n---\n ChangeLog                | 5 ++++-\n libvips\/iofuncs\/memory.c | 4 ++--\n 2 files changed, 6 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/ChangeLog b\/ChangeLog\nindex e80313a8d..057adf95d 100644\n--- a\/ChangeLog\n+++ b\/ChangeLog\n@@ -1,5 +1,8 @@\n 4\/1\/19 started 8.7.4\n-- magicksave with magick6 API did not chain exceptions correctly [kleisauke]\n+- magicksave with magick6 API did not chain exceptions correctly causing a\n+  memory leak under some conditions [kleisauke]\n+- zero memory on allocate to prevent write of uninitialized memory under some \n+  error conditions [Balint Varga-Perke]\n \n 21\/11\/18 started 8.7.3\n - fix infinite loop for autofit with non-scaleable font \ndiff --git a\/libvips\/iofuncs\/memory.c b\/libvips\/iofuncs\/memory.c\nindex d877e2e0f..9f9b55f83 100644\n--- a\/libvips\/iofuncs\/memory.c\n+++ b\/libvips\/iofuncs\/memory.c\n@@ -173,7 +173,7 @@ vips_malloc( VipsObject *object, size_t size )\n {\n \tvoid *buf;\n \n-\tbuf = g_malloc( size );\n+\tbuf = g_malloc0( size );\n \n         if( object ) {\n \t\tg_signal_connect( object, \"postclose\", \n@@ -317,7 +317,7 @@ vips_tracked_malloc( size_t size )\n \t *\/\n \tsize += 16;\n \n-        if( !(buf = g_try_malloc( size )) ) {\n+        if( !(buf = g_try_malloc0( size )) ) {\n #ifdef DEBUG\n \t\tg_assert_not_reached();\n #endif \/*DEBUG*\/\n","owner":"libvips","repo":"libvips","source":"cve"},{"CVE_ID":"CVE-2019-1010283","CWE_ID":"200","category":"security","commit_id":"a28053045bd2e778c50ed1acaf4e52e1e34f6e34","commit_message":"From a28053045bd2e778c50ed1acaf4e52e1e34f6e34 Mon Sep 17 00:00:00 2001\nFrom: Philipp Hahn <hahn@univention.de>\nDate: Wed, 13 Feb 2019 10:29:39 +0100\nSubject: [PATCH] Bug #48427 UDN: Forbid vulnerable GET_DN for VERSION >= 3\n\nUDL using PROTOCOL_3 must no longer use GET_DN but WAIT_DN - if it is\nstill used this is a protocol violation. UDL simply will not get an\nanswer.\n\nWhen UCRV 'notifier\/protocol\/version is set to 3, any old client still\nusing PROTOCOL_2 will get rejected while negotiating the protocol\nversion, so it is asserted that \"version >= network_procotol_version\".\n---\n management\/univention-directory-notifier\/debian\/changelog | 6 ++++++\n management\/univention-directory-notifier\/src\/callback.c   | 2 +-\n 2 files changed, 7 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/management\/univention-directory-notifier\/debian\/changelog b\/management\/univention-directory-notifier\/debian\/changelog\nindex 80faf0fff8..963a9b34b4 100644\n--- a\/management\/univention-directory-notifier\/debian\/changelog\n+++ b\/management\/univention-directory-notifier\/debian\/changelog\n@@ -1,3 +1,9 @@\n+univention-directory-notifier (12.0.1-11) unstable; urgency=low\n+\n+  * Bug #48427: Forbid vulnerable GET_DN for VERSION >= 3\n+\n+ -- Philipp Hahn <hahn@univention.de>  Wed, 13 Feb 2019 10:23:12 +0100\n+\n univention-directory-notifier (12.0.1-10) unstable; urgency=low\n \n   * Bug #48427: Change import limits\ndiff --git a\/management\/univention-directory-notifier\/src\/callback.c b\/management\/univention-directory-notifier\/src\/callback.c\nindex 151e50e7ce..9c6e80401a 100644\n--- a\/management\/univention-directory-notifier\/src\/callback.c\n+++ b\/management\/univention-directory-notifier\/src\/callback.c\n@@ -199,7 +199,7 @@ int data_on_connection(int fd, callback_remove_handler remove)\n \t\t\tp+=strlen(network_line);\n \n \n-\t\t} else if ( !strncmp(network_line, \"GET_DN \", strlen(\"GET_DN \")) && msg_id != UINT32_MAX && network_client_get_version(fd) > 0) {\n+\t\t} else if ( !strncmp(network_line, \"GET_DN \", strlen(\"GET_DN \")) && msg_id != UINT32_MAX && version > PROTOCOL_UNKNOWN && version < PROTOCOL_3) {\n \n \t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: GET_DN\");\n \n","owner":"univention","repo":"univention-corporate-server","source":"cve"},{"CVE_ID":"CVE-2017-1000380","CWE_ID":"200","category":"security","commit_id":"d11662f4f798b50d8c8743f433842c3e40fe3378","commit_message":"From d11662f4f798b50d8c8743f433842c3e40fe3378 Mon Sep 17 00:00:00 2001\nFrom: Takashi Iwai <tiwai@suse.de>\nDate: Fri, 2 Jun 2017 15:03:38 +0200\nSubject: ALSA: timer: Fix race between read and ioctl\n\nThe read from ALSA timer device, the function snd_timer_user_tread(),\nmay access to an uninitialized struct snd_timer_user fields when the\nread is concurrently performed while the ioctl like\nsnd_timer_user_tselect() is invoked.  We have already fixed the races\namong ioctls via a mutex, but we seem to have forgotten the race\nbetween read vs ioctl.\n\nThis patch simply applies (more exactly extends the already applied\nrange of) tu->ioctl_lock in snd_timer_user_tread() for closing the\nrace window.\n\nReported-by: Alexander Potapenko <glider@google.com>\nTested-by: Alexander Potapenko <glider@google.com>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>\n---\n sound\/core\/timer.c | 6 ++++--\n 1 file changed, 4 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/sound\/core\/timer.c b\/sound\/core\/timer.c\nindex 2f836ca09860..1118bd8e2d3c 100644\n--- a\/sound\/core\/timer.c\n+++ b\/sound\/core\/timer.c\n@@ -1959,6 +1959,7 @@ static ssize_t snd_timer_user_read(struct file *file, char __user *buffer,\n \n \ttu = file->private_data;\n \tunit = tu->tread ? sizeof(struct snd_timer_tread) : sizeof(struct snd_timer_read);\n+\tmutex_lock(&tu->ioctl_lock);\n \tspin_lock_irq(&tu->qlock);\n \twhile ((long)count - result >= unit) {\n \t\twhile (!tu->qused) {\n@@ -1974,7 +1975,9 @@ static ssize_t snd_timer_user_read(struct file *file, char __user *buffer,\n \t\t\tadd_wait_queue(&tu->qchange_sleep, &wait);\n \n \t\t\tspin_unlock_irq(&tu->qlock);\n+\t\t\tmutex_unlock(&tu->ioctl_lock);\n \t\t\tschedule();\n+\t\t\tmutex_lock(&tu->ioctl_lock);\n \t\t\tspin_lock_irq(&tu->qlock);\n \n \t\t\tremove_wait_queue(&tu->qchange_sleep, &wait);\n@@ -1994,7 +1997,6 @@ static ssize_t snd_timer_user_read(struct file *file, char __user *buffer,\n \t\ttu->qused--;\n \t\tspin_unlock_irq(&tu->qlock);\n \n-\t\tmutex_lock(&tu->ioctl_lock);\n \t\tif (tu->tread) {\n \t\t\tif (copy_to_user(buffer, &tu->tqueue[qhead],\n \t\t\t\t\t sizeof(struct snd_timer_tread)))\n@@ -2004,7 +2006,6 @@ static ssize_t snd_timer_user_read(struct file *file, char __user *buffer,\n \t\t\t\t\t sizeof(struct snd_timer_read)))\n \t\t\t\terr = -EFAULT;\n \t\t}\n-\t\tmutex_unlock(&tu->ioctl_lock);\n \n \t\tspin_lock_irq(&tu->qlock);\n \t\tif (err < 0)\n@@ -2014,6 +2015,7 @@ static ssize_t snd_timer_user_read(struct file *file, char __user *buffer,\n \t}\n  _error:\n \tspin_unlock_irq(&tu->qlock);\n+\tmutex_unlock(&tu->ioctl_lock);\n \treturn result > 0 ? result : err;\n }\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-7885","CWE_ID":"200","category":"security","commit_id":"4b6184336ebb5c8dc1eae7f7ab46ee608a748b05","commit_message":"From 4b6184336ebb5c8dc1eae7f7ab46ee608a748b05 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Salva=20Peir=C3=B3?= <speirofr@gmail.com>\nDate: Wed, 14 Oct 2015 17:48:02 +0200\nSubject: staging\/dgnc: fix info leak in ioctl\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nThe dgnc_mgmt_ioctl() code fails to initialize the 16 _reserved bytes of\nstruct digi_dinfo after the ->dinfo_nboards member. Add an explicit\nmemset(0) before filling the structure to avoid the info leak.\n\nSigned-off-by: Salva Peir\u00f3 <speirofr@gmail.com>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\n---\n drivers\/staging\/dgnc\/dgnc_mgmt.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/drivers\/staging\/dgnc\/dgnc_mgmt.c b\/drivers\/staging\/dgnc\/dgnc_mgmt.c\nindex 9ec3efe0a287..518fbd5e2d0e 100644\n--- a\/drivers\/staging\/dgnc\/dgnc_mgmt.c\n+++ b\/drivers\/staging\/dgnc\/dgnc_mgmt.c\n@@ -110,6 +110,7 @@ long dgnc_mgmt_ioctl(struct file *file, unsigned int cmd, unsigned long arg)\n \n \t\tspin_lock_irqsave(&dgnc_global_lock, flags);\n \n+\t\tmemset(&ddi, 0, sizeof(ddi));\n \t\tddi.dinfo_nboards = dgnc_NumBoards;\n \t\tsprintf(ddi.dinfo_version, \"%s\", DG_PART);\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2009-3002","CWE_ID":"200","category":"security","commit_id":"f6b97b29513950bfbf621a83d85b6f86b39ec8db","commit_message":"From f6b97b29513950bfbf621a83d85b6f86b39ec8db Mon Sep 17 00:00:00 2001\nFrom: Eric Dumazet <eric.dumazet@gmail.com>\nDate: Thu, 6 Aug 2009 03:31:07 +0000\nSubject: netrom: Fix nr_getname() leak\n\nnr_getname() can leak kernel memory to user.\n\nSigned-off-by: Eric Dumazet <eric.dumazet@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/netrom\/af_netrom.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/netrom\/af_netrom.c b\/net\/netrom\/af_netrom.c\nindex ce51ce012cda..ce1a34b99c23 100644\n--- a\/net\/netrom\/af_netrom.c\n+++ b\/net\/netrom\/af_netrom.c\n@@ -847,6 +847,7 @@ static int nr_getname(struct socket *sock, struct sockaddr *uaddr,\n \t\tsax->fsa_ax25.sax25_family = AF_NETROM;\n \t\tsax->fsa_ax25.sax25_ndigis = 1;\n \t\tsax->fsa_ax25.sax25_call   = nr->user_addr;\n+\t\tmemset(sax->fsa_digipeater, 0, sizeof(sax->fsa_digipeater));\n \t\tsax->fsa_digipeater[0]     = nr->dest_addr;\n \t\t*uaddr_len = sizeof(struct full_sockaddr_ax25);\n \t} else {\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"mjg59","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-0823","CWE_ID":"200","category":"security","commit_id":"ab676b7d6fbf4b294bf198fb27ade5b0e865c7ce","commit_message":"From ab676b7d6fbf4b294bf198fb27ade5b0e865c7ce Mon Sep 17 00:00:00 2001\nFrom: \"Kirill A. Shutemov\" <kirill.shutemov@linux.intel.com>\nDate: Mon, 9 Mar 2015 23:11:12 +0200\nSubject: [PATCH] pagemap: do not leak physical addresses to non-privileged\n userspace\n\nAs pointed by recent post[1] on exploiting DRAM physical imperfection,\n\/proc\/PID\/pagemap exposes sensitive information which can be used to do\nattacks.\n\nThis disallows anybody without CAP_SYS_ADMIN to read the pagemap.\n\n[1] http:\/\/googleprojectzero.blogspot.com\/2015\/03\/exploiting-dram-rowhammer-bug-to-gain.html\n\n[ Eventually we might want to do anything more finegrained, but for now\n  this is the simple model.   - Linus ]\n\nSigned-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com>\nAcked-by: Konstantin Khlebnikov <khlebnikov@openvz.org>\nAcked-by: Andy Lutomirski <luto@amacapital.net>\nCc: Pavel Emelyanov <xemul@parallels.com>\nCc: Andrew Morton <akpm@linux-foundation.org>\nCc: Mark Seaborn <mseaborn@chromium.org>\nCc: stable@vger.kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n fs\/proc\/task_mmu.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/fs\/proc\/task_mmu.c b\/fs\/proc\/task_mmu.c\nindex 956b75d61809f..6dee68d013ffa 100644\n--- a\/fs\/proc\/task_mmu.c\n+++ b\/fs\/proc\/task_mmu.c\n@@ -1325,6 +1325,9 @@ static ssize_t pagemap_read(struct file *file, char __user *buf,\n \n static int pagemap_open(struct inode *inode, struct file *file)\n {\n+\t\/* do not disclose physical addresses: attack vector *\/\n+\tif (!capable(CAP_SYS_ADMIN))\n+\t\treturn -EPERM;\n \tpr_warn_once(\"Bits 55-60 of \/proc\/PID\/pagemap entries are about \"\n \t\t\t\"to stop being page-shift some time soon. See the \"\n \t\t\t\"linux\/Documentation\/vm\/pagemap.txt for details.\\n\");\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-5967","CWE_ID":"200","category":"security","commit_id":"dfb4357da6ddbdf57d583ba64361c9d792b0e0b1","commit_message":"From dfb4357da6ddbdf57d583ba64361c9d792b0e0b1 Mon Sep 17 00:00:00 2001\nFrom: Kees Cook <keescook@chromium.org>\nDate: Wed, 8 Feb 2017 11:26:59 -0800\nSubject: time: Remove CONFIG_TIMER_STATS\n\nCurrently CONFIG_TIMER_STATS exposes process information across namespaces:\n\nkernel\/time\/timer_list.c print_timer():\n\n        SEQ_printf(m, \", %s\/%d\", tmp, timer->start_pid);\n\n\/proc\/timer_list:\n\n #11: <0000000000000000>, hrtimer_wakeup, S:01, do_nanosleep, cron\/2570\n\nGiven that the tracer can give the same information, this patch entirely\nremoves CONFIG_TIMER_STATS.\n\nSuggested-by: Thomas Gleixner <tglx@linutronix.de>\nSigned-off-by: Kees Cook <keescook@chromium.org>\nAcked-by: John Stultz <john.stultz@linaro.org>\nCc: Nicolas Pitre <nicolas.pitre@linaro.org>\nCc: linux-doc@vger.kernel.org\nCc: Lai Jiangshan <jiangshanlai@gmail.com>\nCc: Shuah Khan <shuah@kernel.org>\nCc: Xing Gao <xgao01@email.wm.edu>\nCc: Jonathan Corbet <corbet@lwn.net>\nCc: Jessica Frazelle <me@jessfraz.com>\nCc: kernel-hardening@lists.openwall.com\nCc: Nicolas Iooss <nicolas.iooss_linux@m4x.org>\nCc: \"Paul E. McKenney\" <paulmck@linux.vnet.ibm.com>\nCc: Petr Mladek <pmladek@suse.com>\nCc: Richard Cochran <richardcochran@gmail.com>\nCc: Tejun Heo <tj@kernel.org>\nCc: Michal Marek <mmarek@suse.com>\nCc: Josh Poimboeuf <jpoimboe@redhat.com>\nCc: Dmitry Vyukov <dvyukov@google.com>\nCc: Oleg Nesterov <oleg@redhat.com>\nCc: \"Eric W. Biederman\" <ebiederm@xmission.com>\nCc: Olof Johansson <olof@lixom.net>\nCc: Andrew Morton <akpm@linux-foundation.org>\nCc: linux-api@vger.kernel.org\nCc: Arjan van de Ven <arjan@linux.intel.com>\nLink: http:\/\/lkml.kernel.org\/r\/20170208192659.GA32582@beast\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\n---\n Documentation\/timers\/timer_stats.txt |  73 ------\n include\/linux\/hrtimer.h              |  11 -\n include\/linux\/timer.h                |  45 ----\n kernel\/kthread.c                     |   1 -\n kernel\/time\/Makefile                 |   1 -\n kernel\/time\/hrtimer.c                |  38 ----\n kernel\/time\/timer.c                  |  48 +---\n kernel\/time\/timer_list.c             |  10 -\n kernel\/time\/timer_stats.c            | 425 -----------------------------------\n kernel\/workqueue.c                   |   2 -\n lib\/Kconfig.debug                    |  14 --\n 11 files changed, 2 insertions(+), 666 deletions(-)\n delete mode 100644 Documentation\/timers\/timer_stats.txt\n delete mode 100644 kernel\/time\/timer_stats.c\n\n","diff_code":"diff --git a\/Documentation\/timers\/timer_stats.txt b\/Documentation\/timers\/timer_stats.txt\ndeleted file mode 100644\nindex de835ee97455..000000000000\n--- a\/Documentation\/timers\/timer_stats.txt\n+++ \/dev\/null\n@@ -1,73 +0,0 @@\n-timer_stats - timer usage statistics\n-------------------------------------\n-\n-timer_stats is a debugging facility to make the timer (ab)usage in a Linux\n-system visible to kernel and userspace developers. If enabled in the config\n-but not used it has almost zero runtime overhead, and a relatively small\n-data structure overhead. Even if collection is enabled runtime all the\n-locking is per-CPU and lookup is hashed.\n-\n-timer_stats should be used by kernel and userspace developers to verify that\n-their code does not make unduly use of timers. This helps to avoid unnecessary\n-wakeups, which should be avoided to optimize power consumption.\n-\n-It can be enabled by CONFIG_TIMER_STATS in the \"Kernel hacking\" configuration\n-section.\n-\n-timer_stats collects information about the timer events which are fired in a\n-Linux system over a sample period:\n-\n-- the pid of the task(process) which initialized the timer\n-- the name of the process which initialized the timer\n-- the function where the timer was initialized\n-- the callback function which is associated to the timer\n-- the number of events (callbacks)\n-\n-timer_stats adds an entry to \/proc: \/proc\/timer_stats\n-\n-This entry is used to control the statistics functionality and to read out the\n-sampled information.\n-\n-The timer_stats functionality is inactive on bootup.\n-\n-To activate a sample period issue:\n-# echo 1 >\/proc\/timer_stats\n-\n-To stop a sample period issue:\n-# echo 0 >\/proc\/timer_stats\n-\n-The statistics can be retrieved by:\n-# cat \/proc\/timer_stats\n-\n-While sampling is enabled, each readout from \/proc\/timer_stats will see\n-newly updated statistics. Once sampling is disabled, the sampled information\n-is kept until a new sample period is started. This allows multiple readouts.\n-\n-Sample output of \/proc\/timer_stats:\n-\n-Timerstats sample period: 3.888770 s\n-  12,     0 swapper          hrtimer_stop_sched_tick (hrtimer_sched_tick)\n-  15,     1 swapper          hcd_submit_urb (rh_timer_func)\n-   4,   959 kedac            schedule_timeout (process_timeout)\n-   1,     0 swapper          page_writeback_init (wb_timer_fn)\n-  28,     0 swapper          hrtimer_stop_sched_tick (hrtimer_sched_tick)\n-  22,  2948 IRQ 4            tty_flip_buffer_push (delayed_work_timer_fn)\n-   3,  3100 bash             schedule_timeout (process_timeout)\n-   1,     1 swapper          queue_delayed_work_on (delayed_work_timer_fn)\n-   1,     1 swapper          queue_delayed_work_on (delayed_work_timer_fn)\n-   1,     1 swapper          neigh_table_init_no_netlink (neigh_periodic_timer)\n-   1,  2292 ip               __netdev_watchdog_up (dev_watchdog)\n-   1,    23 events\/1         do_cache_clean (delayed_work_timer_fn)\n-90 total events, 30.0 events\/sec\n-\n-The first column is the number of events, the second column the pid, the third\n-column is the name of the process. The forth column shows the function which\n-initialized the timer and in parenthesis the callback function which was\n-executed on expiry.\n-\n-    Thomas, Ingo\n-\n-Added flag to indicate 'deferrable timer' in \/proc\/timer_stats. A deferrable\n-timer will appear as follows\n-  10D,     1 swapper          queue_delayed_work_on (delayed_work_timer_fn)\n-\ndiff --git a\/include\/linux\/hrtimer.h b\/include\/linux\/hrtimer.h\nindex cdab81ba29f8..e52b427223ba 100644\n--- a\/include\/linux\/hrtimer.h\n+++ b\/include\/linux\/hrtimer.h\n@@ -88,12 +88,6 @@ enum hrtimer_restart {\n  * @base:\tpointer to the timer base (per cpu and per clock)\n  * @state:\tstate information (See bit values above)\n  * @is_rel:\tSet if the timer was armed relative\n- * @start_pid:  timer statistics field to store the pid of the task which\n- *\t\tstarted the timer\n- * @start_site:\ttimer statistics field to store the site where the timer\n- *\t\twas started\n- * @start_comm: timer statistics field to store the name of the process which\n- *\t\tstarted the timer\n  *\n  * The hrtimer structure must be initialized by hrtimer_init()\n  *\/\n@@ -104,11 +98,6 @@ struct hrtimer {\n \tstruct hrtimer_clock_base\t*base;\n \tu8\t\t\t\tstate;\n \tu8\t\t\t\tis_rel;\n-#ifdef CONFIG_TIMER_STATS\n-\tint\t\t\t\tstart_pid;\n-\tvoid\t\t\t\t*start_site;\n-\tchar\t\t\t\tstart_comm[16];\n-#endif\n };\n \n \/**\ndiff --git a\/include\/linux\/timer.h b\/include\/linux\/timer.h\nindex 51d601f192d4..5a209b84fd9e 100644\n--- a\/include\/linux\/timer.h\n+++ b\/include\/linux\/timer.h\n@@ -20,11 +20,6 @@ struct timer_list {\n \tunsigned long\t\tdata;\n \tu32\t\t\tflags;\n \n-#ifdef CONFIG_TIMER_STATS\n-\tint\t\t\tstart_pid;\n-\tvoid\t\t\t*start_site;\n-\tchar\t\t\tstart_comm[16];\n-#endif\n #ifdef CONFIG_LOCKDEP\n \tstruct lockdep_map\tlockdep_map;\n #endif\n@@ -197,46 +192,6 @@ extern int mod_timer_pending(struct timer_list *timer, unsigned long expires);\n  *\/\n #define NEXT_TIMER_MAX_DELTA\t((1UL << 30) - 1)\n \n-\/*\n- * Timer-statistics info:\n- *\/\n-#ifdef CONFIG_TIMER_STATS\n-\n-extern int timer_stats_active;\n-\n-extern void init_timer_stats(void);\n-\n-extern void timer_stats_update_stats(void *timer, pid_t pid, void *startf,\n-\t\t\t\t     void *timerf, char *comm, u32 flags);\n-\n-extern void __timer_stats_timer_set_start_info(struct timer_list *timer,\n-\t\t\t\t\t       void *addr);\n-\n-static inline void timer_stats_timer_set_start_info(struct timer_list *timer)\n-{\n-\tif (likely(!timer_stats_active))\n-\t\treturn;\n-\t__timer_stats_timer_set_start_info(timer, __builtin_return_address(0));\n-}\n-\n-static inline void timer_stats_timer_clear_start_info(struct timer_list *timer)\n-{\n-\ttimer->start_site = NULL;\n-}\n-#else\n-static inline void init_timer_stats(void)\n-{\n-}\n-\n-static inline void timer_stats_timer_set_start_info(struct timer_list *timer)\n-{\n-}\n-\n-static inline void timer_stats_timer_clear_start_info(struct timer_list *timer)\n-{\n-}\n-#endif\n-\n extern void add_timer(struct timer_list *timer);\n \n extern int try_to_del_timer_sync(struct timer_list *timer);\ndiff --git a\/kernel\/kthread.c b\/kernel\/kthread.c\nindex 2318fba86277..8461a4372e8a 100644\n--- a\/kernel\/kthread.c\n+++ b\/kernel\/kthread.c\n@@ -850,7 +850,6 @@ void __kthread_queue_delayed_work(struct kthread_worker *worker,\n \n \tlist_add(&work->node, &worker->delayed_work_list);\n \twork->worker = worker;\n-\ttimer_stats_timer_set_start_info(&dwork->timer);\n \ttimer->expires = jiffies + delay;\n \tadd_timer(timer);\n }\ndiff --git a\/kernel\/time\/Makefile b\/kernel\/time\/Makefile\nindex 976840d29a71..938dbf33ef49 100644\n--- a\/kernel\/time\/Makefile\n+++ b\/kernel\/time\/Makefile\n@@ -15,6 +15,5 @@ ifeq ($(CONFIG_GENERIC_CLOCKEVENTS_BROADCAST),y)\n endif\n obj-$(CONFIG_GENERIC_SCHED_CLOCK)\t\t+= sched_clock.o\n obj-$(CONFIG_TICK_ONESHOT)\t\t\t+= tick-oneshot.o tick-sched.o\n-obj-$(CONFIG_TIMER_STATS)\t\t\t+= timer_stats.o\n obj-$(CONFIG_DEBUG_FS)\t\t\t\t+= timekeeping_debug.o\n obj-$(CONFIG_TEST_UDELAY)\t\t\t+= test_udelay.o\ndiff --git a\/kernel\/time\/hrtimer.c b\/kernel\/time\/hrtimer.c\nindex c6ecedd3b839..edabde646e58 100644\n--- a\/kernel\/time\/hrtimer.c\n+++ b\/kernel\/time\/hrtimer.c\n@@ -766,34 +766,6 @@ void hrtimers_resume(void)\n \tclock_was_set_delayed();\n }\n \n-static inline void timer_stats_hrtimer_set_start_info(struct hrtimer *timer)\n-{\n-#ifdef CONFIG_TIMER_STATS\n-\tif (timer->start_site)\n-\t\treturn;\n-\ttimer->start_site = __builtin_return_address(0);\n-\tmemcpy(timer->start_comm, current->comm, TASK_COMM_LEN);\n-\ttimer->start_pid = current->pid;\n-#endif\n-}\n-\n-static inline void timer_stats_hrtimer_clear_start_info(struct hrtimer *timer)\n-{\n-#ifdef CONFIG_TIMER_STATS\n-\ttimer->start_site = NULL;\n-#endif\n-}\n-\n-static inline void timer_stats_account_hrtimer(struct hrtimer *timer)\n-{\n-#ifdef CONFIG_TIMER_STATS\n-\tif (likely(!timer_stats_active))\n-\t\treturn;\n-\ttimer_stats_update_stats(timer, timer->start_pid, timer->start_site,\n-\t\t\t\t timer->function, timer->start_comm, 0);\n-#endif\n-}\n-\n \/*\n  * Counterpart to lock_hrtimer_base above:\n  *\/\n@@ -932,7 +904,6 @@ remove_hrtimer(struct hrtimer *timer, struct hrtimer_clock_base *base, bool rest\n \t\t * rare case and less expensive than a smp call.\n \t\t *\/\n \t\tdebug_deactivate(timer);\n-\t\ttimer_stats_hrtimer_clear_start_info(timer);\n \t\treprogram = base->cpu_base == this_cpu_ptr(&hrtimer_bases);\n \n \t\tif (!restart)\n@@ -990,8 +961,6 @@ void hrtimer_start_range_ns(struct hrtimer *timer, ktime_t tim,\n \t\/* Switch the timer base, if necessary: *\/\n \tnew_base = switch_hrtimer_base(timer, base, mode & HRTIMER_MODE_PINNED);\n \n-\ttimer_stats_hrtimer_set_start_info(timer);\n-\n \tleftmost = enqueue_hrtimer(timer, new_base);\n \tif (!leftmost)\n \t\tgoto unlock;\n@@ -1128,12 +1097,6 @@ static void __hrtimer_init(struct hrtimer *timer, clockid_t clock_id,\n \tbase = hrtimer_clockid_to_base(clock_id);\n \ttimer->base = &cpu_base->clock_base[base];\n \ttimerqueue_init(&timer->node);\n-\n-#ifdef CONFIG_TIMER_STATS\n-\ttimer->start_site = NULL;\n-\ttimer->start_pid = -1;\n-\tmemset(timer->start_comm, 0, TASK_COMM_LEN);\n-#endif\n }\n \n \/**\n@@ -1217,7 +1180,6 @@ static void __run_hrtimer(struct hrtimer_cpu_base *cpu_base,\n \traw_write_seqcount_barrier(&cpu_base->seq);\n \n \t__remove_hrtimer(timer, base, HRTIMER_STATE_INACTIVE, 0);\n-\ttimer_stats_account_hrtimer(timer);\n \tfn = timer->function;\n \n \t\/*\ndiff --git a\/kernel\/time\/timer.c b\/kernel\/time\/timer.c\nindex ec33a6933eae..82a6bfa0c307 100644\n--- a\/kernel\/time\/timer.c\n+++ b\/kernel\/time\/timer.c\n@@ -571,38 +571,6 @@ internal_add_timer(struct timer_base *base, struct timer_list *timer)\n \ttrigger_dyntick_cpu(base, timer);\n }\n \n-#ifdef CONFIG_TIMER_STATS\n-void __timer_stats_timer_set_start_info(struct timer_list *timer, void *addr)\n-{\n-\tif (timer->start_site)\n-\t\treturn;\n-\n-\ttimer->start_site = addr;\n-\tmemcpy(timer->start_comm, current->comm, TASK_COMM_LEN);\n-\ttimer->start_pid = current->pid;\n-}\n-\n-static void timer_stats_account_timer(struct timer_list *timer)\n-{\n-\tvoid *site;\n-\n-\t\/*\n-\t * start_site can be concurrently reset by\n-\t * timer_stats_timer_clear_start_info()\n-\t *\/\n-\tsite = READ_ONCE(timer->start_site);\n-\tif (likely(!site))\n-\t\treturn;\n-\n-\ttimer_stats_update_stats(timer, timer->start_pid, site,\n-\t\t\t\t timer->function, timer->start_comm,\n-\t\t\t\t timer->flags);\n-}\n-\n-#else\n-static void timer_stats_account_timer(struct timer_list *timer) {}\n-#endif\n-\n #ifdef CONFIG_DEBUG_OBJECTS_TIMERS\n \n static struct debug_obj_descr timer_debug_descr;\n@@ -789,11 +757,6 @@ static void do_init_timer(struct timer_list *timer, unsigned int flags,\n {\n \ttimer->entry.pprev = NULL;\n \ttimer->flags = flags | raw_smp_processor_id();\n-#ifdef CONFIG_TIMER_STATS\n-\ttimer->start_site = NULL;\n-\ttimer->start_pid = -1;\n-\tmemset(timer->start_comm, 0, TASK_COMM_LEN);\n-#endif\n \tlockdep_init_map(&timer->lockdep_map, name, key, 0);\n }\n \n@@ -1001,8 +964,6 @@ __mod_timer(struct timer_list *timer, unsigned long expires, bool pending_only)\n \t\tbase = lock_timer_base(timer, &flags);\n \t}\n \n-\ttimer_stats_timer_set_start_info(timer);\n-\n \tret = detach_if_pending(timer, base, false);\n \tif (!ret && pending_only)\n \t\tgoto out_unlock;\n@@ -1130,7 +1091,6 @@ void add_timer_on(struct timer_list *timer, int cpu)\n \tstruct timer_base *new_base, *base;\n \tunsigned long flags;\n \n-\ttimer_stats_timer_set_start_info(timer);\n \tBUG_ON(timer_pending(timer) || !timer->function);\n \n \tnew_base = get_timer_cpu_base(timer->flags, cpu);\n@@ -1176,7 +1136,6 @@ int del_timer(struct timer_list *timer)\n \n \tdebug_assert_init(timer);\n \n-\ttimer_stats_timer_clear_start_info(timer);\n \tif (timer_pending(timer)) {\n \t\tbase = lock_timer_base(timer, &flags);\n \t\tret = detach_if_pending(timer, base, true);\n@@ -1204,10 +1163,9 @@ int try_to_del_timer_sync(struct timer_list *timer)\n \n \tbase = lock_timer_base(timer, &flags);\n \n-\tif (base->running_timer != timer) {\n-\t\ttimer_stats_timer_clear_start_info(timer);\n+\tif (base->running_timer != timer)\n \t\tret = detach_if_pending(timer, base, true);\n-\t}\n+\n \tspin_unlock_irqrestore(&base->lock, flags);\n \n \treturn ret;\n@@ -1331,7 +1289,6 @@ static void expire_timers(struct timer_base *base, struct hlist_head *head)\n \t\tunsigned long data;\n \n \t\ttimer = hlist_entry(head->first, struct timer_list, entry);\n-\t\ttimer_stats_account_timer(timer);\n \n \t\tbase->running_timer = timer;\n \t\tdetach_timer(timer, true);\n@@ -1868,7 +1825,6 @@ static void __init init_timer_cpus(void)\n void __init init_timers(void)\n {\n \tinit_timer_cpus();\n-\tinit_timer_stats();\n \topen_softirq(TIMER_SOFTIRQ, run_timer_softirq);\n }\n \ndiff --git a\/kernel\/time\/timer_list.c b\/kernel\/time\/timer_list.c\nindex afe6cd1944fc..387a3a5aa388 100644\n--- a\/kernel\/time\/timer_list.c\n+++ b\/kernel\/time\/timer_list.c\n@@ -62,21 +62,11 @@ static void\n print_timer(struct seq_file *m, struct hrtimer *taddr, struct hrtimer *timer,\n \t    int idx, u64 now)\n {\n-#ifdef CONFIG_TIMER_STATS\n-\tchar tmp[TASK_COMM_LEN + 1];\n-#endif\n \tSEQ_printf(m, \" #%d: \", idx);\n \tprint_name_offset(m, taddr);\n \tSEQ_printf(m, \", \");\n \tprint_name_offset(m, timer->function);\n \tSEQ_printf(m, \", S:%02x\", timer->state);\n-#ifdef CONFIG_TIMER_STATS\n-\tSEQ_printf(m, \", \");\n-\tprint_name_offset(m, timer->start_site);\n-\tmemcpy(tmp, timer->start_comm, TASK_COMM_LEN);\n-\ttmp[TASK_COMM_LEN] = 0;\n-\tSEQ_printf(m, \", %s\/%d\", tmp, timer->start_pid);\n-#endif\n \tSEQ_printf(m, \"\\n\");\n \tSEQ_printf(m, \" # expires at %Lu-%Lu nsecs [in %Ld to %Ld nsecs]\\n\",\n \t\t(unsigned long long)ktime_to_ns(hrtimer_get_softexpires(timer)),\ndiff --git a\/kernel\/time\/timer_stats.c b\/kernel\/time\/timer_stats.c\ndeleted file mode 100644\nindex afddded947df..000000000000\n--- a\/kernel\/time\/timer_stats.c\n+++ \/dev\/null\n@@ -1,425 +0,0 @@\n-\/*\n- * kernel\/time\/timer_stats.c\n- *\n- * Collect timer usage statistics.\n- *\n- * Copyright(C) 2006, Red Hat, Inc., Ingo Molnar\n- * Copyright(C) 2006 Timesys Corp., Thomas Gleixner <tglx@timesys.com>\n- *\n- * timer_stats is based on timer_top, a similar functionality which was part of\n- * Con Kolivas dyntick patch set. It was developed by Daniel Petrini at the\n- * Instituto Nokia de Tecnologia - INdT - Manaus. timer_top's design was based\n- * on dynamic allocation of the statistics entries and linear search based\n- * lookup combined with a global lock, rather than the static array, hash\n- * and per-CPU locking which is used by timer_stats. It was written for the\n- * pre hrtimer kernel code and therefore did not take hrtimers into account.\n- * Nevertheless it provided the base for the timer_stats implementation and\n- * was a helpful source of inspiration. Kudos to Daniel and the Nokia folks\n- * for this effort.\n- *\n- * timer_top.c is\n- *\tCopyright (C) 2005 Instituto Nokia de Tecnologia - INdT - Manaus\n- *\tWritten by Daniel Petrini <d.pensator@gmail.com>\n- *\ttimer_top.c was released under the GNU General Public License version 2\n- *\n- * We export the addresses and counting of timer functions being called,\n- * the pid and cmdline from the owner process if applicable.\n- *\n- * Start\/stop data collection:\n- * # echo [1|0] >\/proc\/timer_stats\n- *\n- * Display the information collected so far:\n- * # cat \/proc\/timer_stats\n- *\n- * This program is free software; you can redistribute it and\/or modify\n- * it under the terms of the GNU General Public License version 2 as\n- * published by the Free Software Foundation.\n- *\/\n-\n-#include <linux\/proc_fs.h>\n-#include <linux\/module.h>\n-#include <linux\/spinlock.h>\n-#include <linux\/sched.h>\n-#include <linux\/seq_file.h>\n-#include <linux\/kallsyms.h>\n-\n-#include <linux\/uaccess.h>\n-\n-\/*\n- * This is our basic unit of interest: a timer expiry event identified\n- * by the timer, its start\/expire functions and the PID of the task that\n- * started the timer. We count the number of times an event happens:\n- *\/\n-struct entry {\n-\t\/*\n-\t * Hash list:\n-\t *\/\n-\tstruct entry\t\t*next;\n-\n-\t\/*\n-\t * Hash keys:\n-\t *\/\n-\tvoid\t\t\t*timer;\n-\tvoid\t\t\t*start_func;\n-\tvoid\t\t\t*expire_func;\n-\tpid_t\t\t\tpid;\n-\n-\t\/*\n-\t * Number of timeout events:\n-\t *\/\n-\tunsigned long\t\tcount;\n-\tu32\t\t\tflags;\n-\n-\t\/*\n-\t * We save the command-line string to preserve\n-\t * this information past task exit:\n-\t *\/\n-\tchar\t\t\tcomm[TASK_COMM_LEN + 1];\n-\n-} ____cacheline_aligned_in_smp;\n-\n-\/*\n- * Spinlock protecting the tables - not taken during lookup:\n- *\/\n-static DEFINE_RAW_SPINLOCK(table_lock);\n-\n-\/*\n- * Per-CPU lookup locks for fast hash lookup:\n- *\/\n-static DEFINE_PER_CPU(raw_spinlock_t, tstats_lookup_lock);\n-\n-\/*\n- * Mutex to serialize state changes with show-stats activities:\n- *\/\n-static DEFINE_MUTEX(show_mutex);\n-\n-\/*\n- * Collection status, active\/inactive:\n- *\/\n-int __read_mostly timer_stats_active;\n-\n-\/*\n- * Beginning\/end timestamps of measurement:\n- *\/\n-static ktime_t time_start, time_stop;\n-\n-\/*\n- * tstat entry structs only get allocated while collection is\n- * active and never freed during that time - this simplifies\n- * things quite a bit.\n- *\n- * They get freed when a new collection period is started.\n- *\/\n-#define MAX_ENTRIES_BITS\t10\n-#define MAX_ENTRIES\t\t(1UL << MAX_ENTRIES_BITS)\n-\n-static unsigned long nr_entries;\n-static struct entry entries[MAX_ENTRIES];\n-\n-static atomic_t overflow_count;\n-\n-\/*\n- * The entries are in a hash-table, for fast lookup:\n- *\/\n-#define TSTAT_HASH_BITS\t\t(MAX_ENTRIES_BITS - 1)\n-#define TSTAT_HASH_SIZE\t\t(1UL << TSTAT_HASH_BITS)\n-#define TSTAT_HASH_MASK\t\t(TSTAT_HASH_SIZE - 1)\n-\n-#define __tstat_hashfn(entry)\t\t\t\t\t\t\\\n-\t(((unsigned long)(entry)->timer       ^\t\t\t\t\\\n-\t  (unsigned long)(entry)->start_func  ^\t\t\t\t\\\n-\t  (unsigned long)(entry)->expire_func ^\t\t\t\t\\\n-\t  (unsigned long)(entry)->pid\t\t) & TSTAT_HASH_MASK)\n-\n-#define tstat_hashentry(entry)\t(tstat_hash_table + __tstat_hashfn(entry))\n-\n-static struct entry *tstat_hash_table[TSTAT_HASH_SIZE] __read_mostly;\n-\n-static void reset_entries(void)\n-{\n-\tnr_entries = 0;\n-\tmemset(entries, 0, sizeof(entries));\n-\tmemset(tstat_hash_table, 0, sizeof(tstat_hash_table));\n-\tatomic_set(&overflow_count, 0);\n-}\n-\n-static struct entry *alloc_entry(void)\n-{\n-\tif (nr_entries >= MAX_ENTRIES)\n-\t\treturn NULL;\n-\n-\treturn entries + nr_entries++;\n-}\n-\n-static int match_entries(struct entry *entry1, struct entry *entry2)\n-{\n-\treturn entry1->timer       == entry2->timer\t  &&\n-\t       entry1->start_func  == entry2->start_func  &&\n-\t       entry1->expire_func == entry2->expire_func &&\n-\t       entry1->pid\t   == entry2->pid;\n-}\n-\n-\/*\n- * Look up whether an entry matching this item is present\n- * in the hash already. Must be called with irqs off and the\n- * lookup lock held:\n- *\/\n-static struct entry *tstat_lookup(struct entry *entry, char *comm)\n-{\n-\tstruct entry **head, *curr, *prev;\n-\n-\thead = tstat_hashentry(entry);\n-\tcurr = *head;\n-\n-\t\/*\n-\t * The fastpath is when the entry is already hashed,\n-\t * we do this with the lookup lock held, but with the\n-\t * table lock not held:\n-\t *\/\n-\twhile (curr) {\n-\t\tif (match_entries(curr, entry))\n-\t\t\treturn curr;\n-\n-\t\tcurr = curr->next;\n-\t}\n-\t\/*\n-\t * Slowpath: allocate, set up and link a new hash entry:\n-\t *\/\n-\tprev = NULL;\n-\tcurr = *head;\n-\n-\traw_spin_lock(&table_lock);\n-\t\/*\n-\t * Make sure we have not raced with another CPU:\n-\t *\/\n-\twhile (curr) {\n-\t\tif (match_entries(curr, entry))\n-\t\t\tgoto out_unlock;\n-\n-\t\tprev = curr;\n-\t\tcurr = curr->next;\n-\t}\n-\n-\tcurr = alloc_entry();\n-\tif (curr) {\n-\t\t*curr = *entry;\n-\t\tcurr->count = 0;\n-\t\tcurr->next = NULL;\n-\t\tmemcpy(curr->comm, comm, TASK_COMM_LEN);\n-\n-\t\tsmp_mb(); \/* Ensure that curr is initialized before insert *\/\n-\n-\t\tif (prev)\n-\t\t\tprev->next = curr;\n-\t\telse\n-\t\t\t*head = curr;\n-\t}\n- out_unlock:\n-\traw_spin_unlock(&table_lock);\n-\n-\treturn curr;\n-}\n-\n-\/**\n- * timer_stats_update_stats - Update the statistics for a timer.\n- * @timer:\tpointer to either a timer_list or a hrtimer\n- * @pid:\tthe pid of the task which set up the timer\n- * @startf:\tpointer to the function which did the timer setup\n- * @timerf:\tpointer to the timer callback function of the timer\n- * @comm:\tname of the process which set up the timer\n- * @tflags:\tThe flags field of the timer\n- *\n- * When the timer is already registered, then the event counter is\n- * incremented. Otherwise the timer is registered in a free slot.\n- *\/\n-void timer_stats_update_stats(void *timer, pid_t pid, void *startf,\n-\t\t\t      void *timerf, char *comm, u32 tflags)\n-{\n-\t\/*\n-\t * It doesn't matter which lock we take:\n-\t *\/\n-\traw_spinlock_t *lock;\n-\tstruct entry *entry, input;\n-\tunsigned long flags;\n-\n-\tif (likely(!timer_stats_active))\n-\t\treturn;\n-\n-\tlock = &per_cpu(tstats_lookup_lock, raw_smp_processor_id());\n-\n-\tinput.timer = timer;\n-\tinput.start_func = startf;\n-\tinput.expire_func = timerf;\n-\tinput.pid = pid;\n-\tinput.flags = tflags;\n-\n-\traw_spin_lock_irqsave(lock, flags);\n-\tif (!timer_stats_active)\n-\t\tgoto out_unlock;\n-\n-\tentry = tstat_lookup(&input, comm);\n-\tif (likely(entry))\n-\t\tentry->count++;\n-\telse\n-\t\tatomic_inc(&overflow_count);\n-\n- out_unlock:\n-\traw_spin_unlock_irqrestore(lock, flags);\n-}\n-\n-static void print_name_offset(struct seq_file *m, unsigned long addr)\n-{\n-\tchar symname[KSYM_NAME_LEN];\n-\n-\tif (lookup_symbol_name(addr, symname) < 0)\n-\t\tseq_printf(m, \"<%p>\", (void *)addr);\n-\telse\n-\t\tseq_printf(m, \"%s\", symname);\n-}\n-\n-static int tstats_show(struct seq_file *m, void *v)\n-{\n-\tstruct timespec64 period;\n-\tstruct entry *entry;\n-\tunsigned long ms;\n-\tlong events = 0;\n-\tktime_t time;\n-\tint i;\n-\n-\tmutex_lock(&show_mutex);\n-\t\/*\n-\t * If still active then calculate up to now:\n-\t *\/\n-\tif (timer_stats_active)\n-\t\ttime_stop = ktime_get();\n-\n-\ttime = ktime_sub(time_stop, time_start);\n-\n-\tperiod = ktime_to_timespec64(time);\n-\tms = period.tv_nsec \/ 1000000;\n-\n-\tseq_puts(m, \"Timer Stats Version: v0.3\\n\");\n-\tseq_printf(m, \"Sample period: %ld.%03ld s\\n\", (long)period.tv_sec, ms);\n-\tif (atomic_read(&overflow_count))\n-\t\tseq_printf(m, \"Overflow: %d entries\\n\", atomic_read(&overflow_count));\n-\tseq_printf(m, \"Collection: %s\\n\", timer_stats_active ? \"active\" : \"inactive\");\n-\n-\tfor (i = 0; i < nr_entries; i++) {\n-\t\tentry = entries + i;\n-\t\tif (entry->flags & TIMER_DEFERRABLE) {\n-\t\t\tseq_printf(m, \"%4luD, %5d %-16s \",\n-\t\t\t\tentry->count, entry->pid, entry->comm);\n-\t\t} else {\n-\t\t\tseq_printf(m, \" %4lu, %5d %-16s \",\n-\t\t\t\tentry->count, entry->pid, entry->comm);\n-\t\t}\n-\n-\t\tprint_name_offset(m, (unsigned long)entry->start_func);\n-\t\tseq_puts(m, \" (\");\n-\t\tprint_name_offset(m, (unsigned long)entry->expire_func);\n-\t\tseq_puts(m, \")\\n\");\n-\n-\t\tevents += entry->count;\n-\t}\n-\n-\tms += period.tv_sec * 1000;\n-\tif (!ms)\n-\t\tms = 1;\n-\n-\tif (events && period.tv_sec)\n-\t\tseq_printf(m, \"%ld total events, %ld.%03ld events\/sec\\n\",\n-\t\t\t   events, events * 1000 \/ ms,\n-\t\t\t   (events * 1000000 \/ ms) % 1000);\n-\telse\n-\t\tseq_printf(m, \"%ld total events\\n\", events);\n-\n-\tmutex_unlock(&show_mutex);\n-\n-\treturn 0;\n-}\n-\n-\/*\n- * After a state change, make sure all concurrent lookup\/update\n- * activities have stopped:\n- *\/\n-static void sync_access(void)\n-{\n-\tunsigned long flags;\n-\tint cpu;\n-\n-\tfor_each_online_cpu(cpu) {\n-\t\traw_spinlock_t *lock = &per_cpu(tstats_lookup_lock, cpu);\n-\n-\t\traw_spin_lock_irqsave(lock, flags);\n-\t\t\/* nothing *\/\n-\t\traw_spin_unlock_irqrestore(lock, flags);\n-\t}\n-}\n-\n-static ssize_t tstats_write(struct file *file, const char __user *buf,\n-\t\t\t    size_t count, loff_t *offs)\n-{\n-\tchar ctl[2];\n-\n-\tif (count != 2 || *offs)\n-\t\treturn -EINVAL;\n-\n-\tif (copy_from_user(ctl, buf, count))\n-\t\treturn -EFAULT;\n-\n-\tmutex_lock(&show_mutex);\n-\tswitch (ctl[0]) {\n-\tcase '0':\n-\t\tif (timer_stats_active) {\n-\t\t\ttimer_stats_active = 0;\n-\t\t\ttime_stop = ktime_get();\n-\t\t\tsync_access();\n-\t\t}\n-\t\tbreak;\n-\tcase '1':\n-\t\tif (!timer_stats_active) {\n-\t\t\treset_entries();\n-\t\t\ttime_start = ktime_get();\n-\t\t\tsmp_mb();\n-\t\t\ttimer_stats_active = 1;\n-\t\t}\n-\t\tbreak;\n-\tdefault:\n-\t\tcount = -EINVAL;\n-\t}\n-\tmutex_unlock(&show_mutex);\n-\n-\treturn count;\n-}\n-\n-static int tstats_open(struct inode *inode, struct file *filp)\n-{\n-\treturn single_open(filp, tstats_show, NULL);\n-}\n-\n-static const struct file_operations tstats_fops = {\n-\t.open\t\t= tstats_open,\n-\t.read\t\t= seq_read,\n-\t.write\t\t= tstats_write,\n-\t.llseek\t\t= seq_lseek,\n-\t.release\t= single_release,\n-};\n-\n-void __init init_timer_stats(void)\n-{\n-\tint cpu;\n-\n-\tfor_each_possible_cpu(cpu)\n-\t\traw_spin_lock_init(&per_cpu(tstats_lookup_lock, cpu));\n-}\n-\n-static int __init init_tstats_procfs(void)\n-{\n-\tstruct proc_dir_entry *pe;\n-\n-\tpe = proc_create(\"timer_stats\", 0644, NULL, &tstats_fops);\n-\tif (!pe)\n-\t\treturn -ENOMEM;\n-\treturn 0;\n-}\n-__initcall(init_tstats_procfs);\ndiff --git a\/kernel\/workqueue.c b\/kernel\/workqueue.c\nindex 1d9fb6543a66..072cbc9b175d 100644\n--- a\/kernel\/workqueue.c\n+++ b\/kernel\/workqueue.c\n@@ -1523,8 +1523,6 @@ static void __queue_delayed_work(int cpu, struct workqueue_struct *wq,\n \t\treturn;\n \t}\n \n-\ttimer_stats_timer_set_start_info(&dwork->timer);\n-\n \tdwork->wq = wq;\n \tdwork->cpu = cpu;\n \ttimer->expires = jiffies + delay;\ndiff --git a\/lib\/Kconfig.debug b\/lib\/Kconfig.debug\nindex eb9e9a7870fa..132af338d6dd 100644\n--- a\/lib\/Kconfig.debug\n+++ b\/lib\/Kconfig.debug\n@@ -980,20 +980,6 @@ config DEBUG_TIMEKEEPING\n \n \t  If unsure, say N.\n \n-config TIMER_STATS\n-\tbool \"Collect kernel timers statistics\"\n-\tdepends on DEBUG_KERNEL && PROC_FS\n-\thelp\n-\t  If you say Y here, additional code will be inserted into the\n-\t  timer routines to collect statistics about kernel timers being\n-\t  reprogrammed. The statistics can be read from \/proc\/timer_stats.\n-\t  The statistics collection is started by writing 1 to \/proc\/timer_stats,\n-\t  writing 0 stops it. This feature is useful to collect information\n-\t  about timer usage patterns in kernel and userspace. This feature\n-\t  is lightweight if enabled in the kernel config but not activated\n-\t  (it defaults to deactivated on bootup and will only be activated\n-\t  if some application like powertop activates it explicitly).\n-\n config DEBUG_PREEMPT\n \tbool \"Debug preemptible kernel\"\n \tdepends on DEBUG_KERNEL && PREEMPT && TRACE_IRQFLAGS_SUPPORT\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2013-1824","CWE_ID":"200","category":"security","commit_id":"188c196d4da60bdde9190d2fc532650d17f7af2d","commit_message":"From 188c196d4da60bdde9190d2fc532650d17f7af2d Mon Sep 17 00:00:00 2001\nFrom: Dmitry Stogov <dmitry@zend.com>\nDate: Wed, 13 Feb 2013 22:06:37 +0400\nSubject: [PATCH] Proper bit reset code\n\n---\n ext\/soap\/php_xml.c | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/ext\/soap\/php_xml.c b\/ext\/soap\/php_xml.c\nindex a69d071..006db85 100644\n--- a\/ext\/soap\/php_xml.c\n+++ b\/ext\/soap\/php_xml.c\n@@ -92,7 +92,7 @@ xmlDocPtr soap_xmlParseFile(const char *filename TSRMLS_DC)\n \tPG(allow_url_fopen) = old_allow_url_fopen;\n \tif (ctxt) {\n \t\tctxt->keepBlanks = 0;\n-\t\tctxt->options -= XML_PARSE_DTDLOAD;\n+\t\tctxt->options &= ~XML_PARSE_DTDLOAD;\n \t\tctxt->sax->ignorableWhitespace = soap_ignorableWhitespace;\n \t\tctxt->sax->comment = soap_Comment;\n \t\tctxt->sax->warning = NULL;\n@@ -134,7 +134,7 @@ xmlDocPtr soap_xmlParseMemory(const void *buf, size_t buf_size)\n *\/\n \tctxt = xmlCreateMemoryParserCtxt(buf, buf_size);\n \tif (ctxt) {\n-\t\tctxt->options -= XML_PARSE_DTDLOAD;\n+\t\tctxt->options &= ~XML_PARSE_DTDLOAD;\n \t\tctxt->sax->ignorableWhitespace = soap_ignorableWhitespace;\n \t\tctxt->sax->comment = soap_Comment;\n \t\tctxt->sax->warning = NULL;\n-- \n2.1.4\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2011-3201","CWE_ID":"200","category":"security","commit_id":"588c410718068388f8ce0004a71c104a4c89cce3","commit_message":"From 588c410718068388f8ce0004a71c104a4c89cce3 Mon Sep 17 00:00:00 2001\nFrom: Matthew Barnes <mbarnes@redhat.com>\nDate: Wed, 30 Nov 2011 07:24:20 -0600\nSubject: [PATCH] Bug 657374 - mailto: attachment parameter can lead to\n accidental data exfiltration\n\n---\n composer\/e-msg-composer.c | 32 ++++++++++++++++++++++++++++++++\n 1 file changed, 32 insertions(+)\n\n","diff_code":"diff --git a\/composer\/e-msg-composer.c b\/composer\/e-msg-composer.c\nindex c41c4019b3..ceff107bdb 100644\n--- a\/composer\/e-msg-composer.c\n+++ b\/composer\/e-msg-composer.c\n@@ -4003,6 +4003,35 @@ merge_always_cc_and_bcc (EComposerHeaderTable *table,\n \te_destination_freev (addrv);\n }\n \n+static const gchar *blacklist[] = { \".\", \"etc\", \"..\" };\n+\n+static gboolean\n+file_is_blacklisted (const gchar *filename)\n+{\n+\tgboolean blacklisted = FALSE;\n+\tguint ii, jj, n_parts;\n+\tgchar **parts;\n+\n+\tparts = g_strsplit (filename, G_DIR_SEPARATOR_S, -1);\n+\tn_parts = g_strv_length (parts);\n+\n+\tfor (ii = 0; ii < G_N_ELEMENTS (blacklist); ii++) {\n+\t\tfor (jj = 0; jj < n_parts; jj++) {\n+\t\t\tif (g_str_has_prefix (parts[jj], blacklist[ii])) {\n+\t\t\t\tblacklisted = TRUE;\n+\t\t\t\tbreak;\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tg_strfreev (parts);\n+\n+\tif (blacklisted)\n+\t\tg_message (\"Skipping suspicious attachment: %s\", filename);\n+\n+\treturn blacklisted;\n+}\n+\n static void\n handle_mailto (EMsgComposer *composer,\n                const gchar *mailto)\n@@ -4096,6 +4125,8 @@ handle_mailto (EMsgComposer *composer,\n \t\t\t\tEAttachment *attachment;\n \n \t\t\t\tcamel_url_decode (content);\n+\t\t\t\tif (file_is_blacklisted (content))\n+\t\t\t\t\tgoto next;\n \t\t\t\tif (g_ascii_strncasecmp (content, \"file:\", 5) == 0)\n \t\t\t\t\tattachment = e_attachment_new_for_uri (content);\n \t\t\t\telse\n@@ -4115,6 +4146,7 @@ handle_mailto (EMsgComposer *composer,\n \t\t\t\te_msg_composer_add_header (composer, header, content);\n \t\t\t}\n \n+next:\n \t\t\tg_free (content);\n \n \t\t\tp += clen;\n-- \n2.21.0\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2013-7265","CWE_ID":"200","category":"security","commit_id":"bceaa90240b6019ed73b49965eac7d167610be69","commit_message":"From bceaa90240b6019ed73b49965eac7d167610be69 Mon Sep 17 00:00:00 2001\nFrom: Hannes Frederic Sowa <hannes@stressinduktion.org>\nDate: Mon, 18 Nov 2013 04:20:45 +0100\nSubject: [PATCH] inet: prevent leakage of uninitialized memory to user in recv\n syscalls\n\nOnly update *addr_len when we actually fill in sockaddr, otherwise we\ncan return uninitialized memory from the stack to the caller in the\nrecvfrom, recvmmsg and recvmsg syscalls. Drop the the (addr_len == NULL)\nchecks because we only get called with a valid addr_len pointer either\nfrom sock_common_recvmsg or inet_recvmsg.\n\nIf a blocking read waits on a socket which is concurrently shut down we\nnow return zero and set msg_msgnamelen to 0.\n\nReported-by: mpb <mpb.mail@gmail.com>\nSuggested-by: Eric Dumazet <eric.dumazet@gmail.com>\nSigned-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/ieee802154\/dgram.c |  3 +--\n net\/ipv4\/ping.c        | 19 +++++++------------\n net\/ipv4\/raw.c         |  4 +---\n net\/ipv4\/udp.c         |  7 +------\n net\/ipv6\/raw.c         |  4 +---\n net\/ipv6\/udp.c         |  5 +----\n net\/l2tp\/l2tp_ip.c     |  4 +---\n net\/phonet\/datagram.c  |  9 ++++-----\n 8 files changed, 17 insertions(+), 38 deletions(-)\n\n","diff_code":"diff --git a\/net\/ieee802154\/dgram.c b\/net\/ieee802154\/dgram.c\nindex 581a59504bd5f..1865fdf5a5a51 100644\n--- a\/net\/ieee802154\/dgram.c\n+++ b\/net\/ieee802154\/dgram.c\n@@ -315,9 +315,8 @@ static int dgram_recvmsg(struct kiocb *iocb, struct sock *sk,\n \tif (saddr) {\n \t\tsaddr->family = AF_IEEE802154;\n \t\tsaddr->addr = mac_cb(skb)->sa;\n-\t}\n-\tif (addr_len)\n \t\t*addr_len = sizeof(*saddr);\n+\t}\n \n \tif (flags & MSG_TRUNC)\n \t\tcopied = skb->len;\ndiff --git a\/net\/ipv4\/ping.c b\/net\/ipv4\/ping.c\nindex 9afbdb19f4a2f..aacefa0caa36a 100644\n--- a\/net\/ipv4\/ping.c\n+++ b\/net\/ipv4\/ping.c\n@@ -830,8 +830,6 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n {\n \tstruct inet_sock *isk = inet_sk(sk);\n \tint family = sk->sk_family;\n-\tstruct sockaddr_in *sin;\n-\tstruct sockaddr_in6 *sin6;\n \tstruct sk_buff *skb;\n \tint copied, err;\n \n@@ -841,13 +839,6 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \tif (flags & MSG_OOB)\n \t\tgoto out;\n \n-\tif (addr_len) {\n-\t\tif (family == AF_INET)\n-\t\t\t*addr_len = sizeof(*sin);\n-\t\telse if (family == AF_INET6 && addr_len)\n-\t\t\t*addr_len = sizeof(*sin6);\n-\t}\n-\n \tif (flags & MSG_ERRQUEUE) {\n \t\tif (family == AF_INET) {\n \t\t\treturn ip_recv_error(sk, msg, len);\n@@ -877,11 +868,13 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \n \t\/* Copy the address and add cmsg data. *\/\n \tif (family == AF_INET) {\n-\t\tsin = (struct sockaddr_in *) msg->msg_name;\n+\t\tstruct sockaddr_in *sin = (struct sockaddr_in *)msg->msg_name;\n+\n \t\tsin->sin_family = AF_INET;\n \t\tsin->sin_port = 0 \/* skb->h.uh->source *\/;\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tmemset(sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \n \t\tif (isk->cmsg_flags)\n \t\t\tip_cmsg_recv(msg, skb);\n@@ -890,17 +883,19 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \t} else if (family == AF_INET6) {\n \t\tstruct ipv6_pinfo *np = inet6_sk(sk);\n \t\tstruct ipv6hdr *ip6 = ipv6_hdr(skb);\n-\t\tsin6 = (struct sockaddr_in6 *) msg->msg_name;\n+\t\tstruct sockaddr_in6 *sin6 =\n+\t\t\t(struct sockaddr_in6 *)msg->msg_name;\n+\n \t\tsin6->sin6_family = AF_INET6;\n \t\tsin6->sin6_port = 0;\n \t\tsin6->sin6_addr = ip6->saddr;\n-\n \t\tsin6->sin6_flowinfo = 0;\n \t\tif (np->sndflow)\n \t\t\tsin6->sin6_flowinfo = ip6_flowinfo(ip6);\n \n \t\tsin6->sin6_scope_id = ipv6_iface_scope_id(&sin6->sin6_addr,\n \t\t\t\t\t\t\t  IP6CB(skb)->iif);\n+\t\t*addr_len = sizeof(*sin6);\n \n \t\tif (inet6_sk(sk)->rxopt.all)\n \t\t\tpingv6_ops.ip6_datagram_recv_ctl(sk, msg, skb);\ndiff --git a\/net\/ipv4\/raw.c b\/net\/ipv4\/raw.c\nindex 41e1d2845c8f6..5cb8ddb505ee8 100644\n--- a\/net\/ipv4\/raw.c\n+++ b\/net\/ipv4\/raw.c\n@@ -696,9 +696,6 @@ static int raw_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \tif (flags & MSG_OOB)\n \t\tgoto out;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(*sin);\n-\n \tif (flags & MSG_ERRQUEUE) {\n \t\terr = ip_recv_error(sk, msg, len);\n \t\tgoto out;\n@@ -726,6 +723,7 @@ static int raw_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tsin->sin_port = 0;\n \t\tmemset(&sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \t}\n \tif (inet->cmsg_flags)\n \t\tip_cmsg_recv(msg, skb);\ndiff --git a\/net\/ipv4\/udp.c b\/net\/ipv4\/udp.c\nindex 89909dd730ddd..998431cd471a2 100644\n--- a\/net\/ipv4\/udp.c\n+++ b\/net\/ipv4\/udp.c\n@@ -1235,12 +1235,6 @@ int udp_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \tint is_udplite = IS_UDPLITE(sk);\n \tbool slow;\n \n-\t\/*\n-\t *\tCheck any passed addresses\n-\t *\/\n-\tif (addr_len)\n-\t\t*addr_len = sizeof(*sin);\n-\n \tif (flags & MSG_ERRQUEUE)\n \t\treturn ip_recv_error(sk, msg, len);\n \n@@ -1302,6 +1296,7 @@ int udp_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \t\tsin->sin_port = udp_hdr(skb)->source;\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tmemset(sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \t}\n \tif (inet->cmsg_flags)\n \t\tip_cmsg_recv(msg, skb);\ndiff --git a\/net\/ipv6\/raw.c b\/net\/ipv6\/raw.c\nindex 3c00842b00792..e24ff1df04012 100644\n--- a\/net\/ipv6\/raw.c\n+++ b\/net\/ipv6\/raw.c\n@@ -465,9 +465,6 @@ static int rawv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \tif (flags & MSG_OOB)\n \t\treturn -EOPNOTSUPP;\n \n-\tif (addr_len)\n-\t\t*addr_len=sizeof(*sin6);\n-\n \tif (flags & MSG_ERRQUEUE)\n \t\treturn ipv6_recv_error(sk, msg, len);\n \n@@ -506,6 +503,7 @@ static int rawv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \t\tsin6->sin6_flowinfo = 0;\n \t\tsin6->sin6_scope_id = ipv6_iface_scope_id(&sin6->sin6_addr,\n \t\t\t\t\t\t\t  IP6CB(skb)->iif);\n+\t\t*addr_len = sizeof(*sin6);\n \t}\n \n \tsock_recv_ts_and_drops(msg, sk, skb);\ndiff --git a\/net\/ipv6\/udp.c b\/net\/ipv6\/udp.c\nindex f3893e897f721..81eb8cf8389b6 100644\n--- a\/net\/ipv6\/udp.c\n+++ b\/net\/ipv6\/udp.c\n@@ -392,9 +392,6 @@ int udpv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \tint is_udp4;\n \tbool slow;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(struct sockaddr_in6);\n-\n \tif (flags & MSG_ERRQUEUE)\n \t\treturn ipv6_recv_error(sk, msg, len);\n \n@@ -480,7 +477,7 @@ int udpv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \t\t\t\tipv6_iface_scope_id(&sin6->sin6_addr,\n \t\t\t\t\t\t    IP6CB(skb)->iif);\n \t\t}\n-\n+\t\t*addr_len = sizeof(*sin6);\n \t}\n \tif (is_udp4) {\n \t\tif (inet->cmsg_flags)\ndiff --git a\/net\/l2tp\/l2tp_ip.c b\/net\/l2tp\/l2tp_ip.c\nindex 571db8dd2292a..da1a1cee1a088 100644\n--- a\/net\/l2tp\/l2tp_ip.c\n+++ b\/net\/l2tp\/l2tp_ip.c\n@@ -518,9 +518,6 @@ static int l2tp_ip_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *m\n \tif (flags & MSG_OOB)\n \t\tgoto out;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(*sin);\n-\n \tskb = skb_recv_datagram(sk, flags, noblock, &err);\n \tif (!skb)\n \t\tgoto out;\n@@ -543,6 +540,7 @@ static int l2tp_ip_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *m\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tsin->sin_port = 0;\n \t\tmemset(&sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \t}\n \tif (inet->cmsg_flags)\n \t\tip_cmsg_recv(msg, skb);\ndiff --git a\/net\/phonet\/datagram.c b\/net\/phonet\/datagram.c\nindex 12c30f3e643e0..38946b26e471c 100644\n--- a\/net\/phonet\/datagram.c\n+++ b\/net\/phonet\/datagram.c\n@@ -139,9 +139,6 @@ static int pn_recvmsg(struct kiocb *iocb, struct sock *sk,\n \t\t\tMSG_CMSG_COMPAT))\n \t\tgoto out_nofree;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(sa);\n-\n \tskb = skb_recv_datagram(sk, flags, noblock, &rval);\n \tif (skb == NULL)\n \t\tgoto out_nofree;\n@@ -162,8 +159,10 @@ static int pn_recvmsg(struct kiocb *iocb, struct sock *sk,\n \n \trval = (flags & MSG_TRUNC) ? skb->len : copylen;\n \n-\tif (msg->msg_name != NULL)\n-\t\tmemcpy(msg->msg_name, &sa, sizeof(struct sockaddr_pn));\n+\tif (msg->msg_name != NULL) {\n+\t\tmemcpy(msg->msg_name, &sa, sizeof(sa));\n+\t\t*addr_len = sizeof(sa);\n+\t}\n \n out:\n \tskb_free_datagram(sk, skb);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-16911","CWE_ID":"200","category":"security","commit_id":"2f2d0088eb93db5c649d2a5e34a3800a8a935fc5","commit_message":"From 2f2d0088eb93db5c649d2a5e34a3800a8a935fc5 Mon Sep 17 00:00:00 2001\nFrom: Shuah Khan <shuahkh@osg.samsung.com>\nDate: Thu, 7 Dec 2017 14:16:49 -0700\nSubject: usbip: prevent vhci_hcd driver from leaking a socket pointer address\n\nWhen a client has a USB device attached over IP, the vhci_hcd driver is\nlocally leaking a socket pointer address via the\n\n\/sys\/devices\/platform\/vhci_hcd\/status file (world-readable) and in debug\noutput when \"usbip --debug port\" is run.\n\nFix it to not leak. The socket pointer address is not used at the moment\nand it was made visible as a convenient way to find IP address from socket\npointer address by looking up \/proc\/net\/{tcp,tcp6}.\n\nAs this opens a security hole, the fix replaces socket pointer address with\nsockfd.\n\nReported-by: Secunia Research <vuln@secunia.com>\nCc: stable <stable@vger.kernel.org>\nSigned-off-by: Shuah Khan <shuahkh@osg.samsung.com>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\n---\n drivers\/usb\/usbip\/usbip_common.h |  1 +\n drivers\/usb\/usbip\/vhci_sysfs.c   | 25 ++++++++++++++++---------\n 2 files changed, 17 insertions(+), 9 deletions(-)\n\n(limited to 'drivers\/usb\/usbip')\n\n","diff_code":"diff --git a\/drivers\/usb\/usbip\/usbip_common.h b\/drivers\/usb\/usbip\/usbip_common.h\nindex e5de35c8c505..473fb8a87289 100644\n--- a\/drivers\/usb\/usbip\/usbip_common.h\n+++ b\/drivers\/usb\/usbip\/usbip_common.h\n@@ -256,6 +256,7 @@ struct usbip_device {\n \t\/* lock for status *\/\n \tspinlock_t lock;\n \n+\tint sockfd;\n \tstruct socket *tcp_socket;\n \n \tstruct task_struct *tcp_rx;\ndiff --git a\/drivers\/usb\/usbip\/vhci_sysfs.c b\/drivers\/usb\/usbip\/vhci_sysfs.c\nindex e78f7472cac4..091f76b7196d 100644\n--- a\/drivers\/usb\/usbip\/vhci_sysfs.c\n+++ b\/drivers\/usb\/usbip\/vhci_sysfs.c\n@@ -17,15 +17,20 @@\n \n \/*\n  * output example:\n- * hub port sta spd dev      socket           local_busid\n- * hs  0000 004 000 00000000         c5a7bb80 1-2.3\n+ * hub port sta spd dev       sockfd    local_busid\n+ * hs  0000 004 000 00000000  3         1-2.3\n  * ................................................\n- * ss  0008 004 000 00000000         d8cee980 2-3.4\n+ * ss  0008 004 000 00000000  4         2-3.4\n  * ................................................\n  *\n- * IP address can be retrieved from a socket pointer address by looking\n- * up \/proc\/net\/{tcp,tcp6}. Also, a userland program may remember a\n- * port number and its peer IP address.\n+ * Output includes socket fd instead of socket pointer address to avoid\n+ * leaking kernel memory address in:\n+ *\t\/sys\/devices\/platform\/vhci_hcd.0\/status and in debug output.\n+ * The socket pointer address is not used at the moment and it was made\n+ * visible as a convenient way to find IP address from socket pointer\n+ * address by looking up \/proc\/net\/{tcp,tcp6}. As this opens a security\n+ * hole, the change is made to use sockfd instead.\n+ *\n  *\/\n static void port_show_vhci(char **out, int hub, int port, struct vhci_device *vdev)\n {\n@@ -39,8 +44,8 @@ static void port_show_vhci(char **out, int hub, int port, struct vhci_device *vd\n \tif (vdev->ud.status == VDEV_ST_USED) {\n \t\t*out += sprintf(*out, \"%03u %08x \",\n \t\t\t\t      vdev->speed, vdev->devid);\n-\t\t*out += sprintf(*out, \"%16p %s\",\n-\t\t\t\t      vdev->ud.tcp_socket,\n+\t\t*out += sprintf(*out, \"%u %s\",\n+\t\t\t\t      vdev->ud.sockfd,\n \t\t\t\t      dev_name(&vdev->udev->dev));\n \n \t} else {\n@@ -160,7 +165,8 @@ static ssize_t nports_show(struct device *dev, struct device_attribute *attr,\n \tchar *s = out;\n \n \t\/*\n-\t * Half the ports are for SPEED_HIGH and half for SPEED_SUPER, thus the * 2.\n+\t * Half the ports are for SPEED_HIGH and half for SPEED_SUPER,\n+\t * thus the * 2.\n \t *\/\n \tout += sprintf(out, \"%d\\n\", VHCI_PORTS * vhci_num_controllers);\n \treturn out - s;\n@@ -366,6 +372,7 @@ static ssize_t store_attach(struct device *dev, struct device_attribute *attr,\n \n \tvdev->devid         = devid;\n \tvdev->speed         = speed;\n+\tvdev->ud.sockfd     = sockfd;\n \tvdev->ud.tcp_socket = socket;\n \tvdev->ud.status     = VDEV_ST_NOTASSIGNED;\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-11472","CWE_ID":"200","category":"security","commit_id":"a23325b2e583556eae88ed3f764e457786bf4df6","commit_message":"From a23325b2e583556eae88ed3f764e457786bf4df6 Mon Sep 17 00:00:00 2001\nFrom: Seunghun Han <kkamagui@gmail.com>\nDate: Wed, 22 Feb 2017 16:32:49 +0800\nSubject: [PATCH] Namespace: fix operand cache leak\n\nI found some ACPI operand cache leaks in ACPI early abort cases.\n\nBoot log of ACPI operand cache leak is as follows:\n>[    0.174332] ACPI: Added _OSI(Module Device)\n>[    0.175504] ACPI: Added _OSI(Processor Device)\n>[    0.176010] ACPI: Added _OSI(3.0 _SCP Extensions)\n>[    0.177032] ACPI: Added _OSI(Processor Aggregator Device)\n>[    0.178284] ACPI: SCI (IRQ16705) allocation failed\n>[    0.179352] ACPI Exception: AE_NOT_ACQUIRED, Unable to install\nSystem Control Interrupt handler (20160930\/evevent-131)\n>[    0.180008] ACPI: Unable to start the ACPI Interpreter\n>[    0.181125] ACPI Error: Could not remove SCI handler\n(20160930\/evmisc-281)\n>[    0.184068] kmem_cache_destroy Acpi-Operand: Slab cache still has\nobjects\n>[    0.185358] CPU: 0 PID: 1 Comm: swapper\/0 Not tainted 4.10.0-rc3 #2\n>[    0.186820] Hardware name: innotek GmbH VirtualBox\/VirtualBox, BIOS\nVirtualBox 12\/01\/2006\n>[    0.188000] Call Trace:\n>[    0.188000]  ? dump_stack+0x5c\/0x7d\n>[    0.188000]  ? kmem_cache_destroy+0x224\/0x230\n>[    0.188000]  ? acpi_sleep_proc_init+0x22\/0x22\n>[    0.188000]  ? acpi_os_delete_cache+0xa\/0xd\n>[    0.188000]  ? acpi_ut_delete_caches+0x3f\/0x7b\n>[    0.188000]  ? acpi_terminate+0x5\/0xf\n>[    0.188000]  ? acpi_init+0x288\/0x32e\n>[    0.188000]  ? __class_create+0x4c\/0x80\n>[    0.188000]  ? video_setup+0x7a\/0x7a\n>[    0.188000]  ? do_one_initcall+0x4e\/0x1b0\n>[    0.188000]  ? kernel_init_freeable+0x194\/0x21a\n>[    0.188000]  ? rest_init+0x80\/0x80\n>[    0.188000]  ? kernel_init+0xa\/0x100\n>[    0.188000]  ? ret_from_fork+0x25\/0x30\n\nWhen early abort is occurred due to invalid ACPI information, Linux kernel\nterminates ACPI by calling AcpiTerminate() function. The function calls\nAcpiNsTerminate() function to delete namespace data and ACPI operand cache\n(AcpiGbl_ModuleCodeList).\n\nBut the deletion code in AcpiNsTerminate() function is wrapped in\nACPI_EXEC_APP definition, therefore the code is only executed when the\ndefinition exists. If the define doesn't exist, ACPI operand cache\n(AcpiGbl_ModuleCodeList) is leaked, and stack dump is shown in kernel log.\n\nThis causes a security threat because the old kernel (<= 4.9) shows memory\nlocations of kernel functions in stack dump, therefore kernel ASLR can be\nneutralized.\n\nTo fix ACPI operand leak for enhancing security, I made a patch which\nremoves the ACPI_EXEC_APP define in AcpiNsTerminate() function for\nexecuting the deletion code unconditionally.\n\nSigned-off-by: Seunghun Han <kkamagui@gmail.com>\nSigned-off-by: Lv Zheng <lv.zheng@intel.com>\n---\n source\/components\/namespace\/nsutils.c | 25 ++++++++++---------------\n 1 file changed, 10 insertions(+), 15 deletions(-)\n\n","diff_code":"diff --git a\/source\/components\/namespace\/nsutils.c b\/source\/components\/namespace\/nsutils.c\nindex 601bc2e04c..b2917e5574 100644\n--- a\/source\/components\/namespace\/nsutils.c\n+++ b\/source\/components\/namespace\/nsutils.c\n@@ -766,28 +766,23 @@ AcpiNsTerminate (\n     void)\n {\n     ACPI_STATUS             Status;\n+    ACPI_OPERAND_OBJECT     *Prev;\n+    ACPI_OPERAND_OBJECT     *Next;\n \n \n     ACPI_FUNCTION_TRACE (NsTerminate);\n \n \n-#ifdef ACPI_EXEC_APP\n-    {\n-        ACPI_OPERAND_OBJECT     *Prev;\n-        ACPI_OPERAND_OBJECT     *Next;\n-\n-        \/* Delete any module-level code blocks *\/\n+    \/* Delete any module-level code blocks *\/\n \n-        Next = AcpiGbl_ModuleCodeList;\n-        while (Next)\n-        {\n-            Prev = Next;\n-            Next = Next->Method.Mutex;\n-            Prev->Method.Mutex = NULL; \/* Clear the Mutex (cheated) field *\/\n-            AcpiUtRemoveReference (Prev);\n-        }\n+    Next = AcpiGbl_ModuleCodeList;\n+    while (Next)\n+    {\n+        Prev = Next;\n+        Next = Next->Method.Mutex;\n+        Prev->Method.Mutex = NULL; \/* Clear the Mutex (cheated) field *\/\n+        AcpiUtRemoveReference (Prev);\n     }\n-#endif\n \n     \/*\n      * Free the entire namespace -- all nodes and all objects\n","owner":"acpica","repo":"acpica","source":"cve"},{"CVE_ID":"CVE-2012-6538","CWE_ID":"200","category":"security","commit_id":"4c87308bdea31a7b4828a51f6156e6f721a1fcc9","commit_message":"From 4c87308bdea31a7b4828a51f6156e6f721a1fcc9 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 19 Sep 2012 11:33:38 +0000\nSubject: [PATCH] xfrm_user: fix info leak in copy_to_user_auth()\n\ncopy_to_user_auth() fails to initialize the remainder of alg_name and\ntherefore discloses up to 54 bytes of heap memory via netlink to\nuserland.\n\nUse strncpy() instead of strcpy() to fill the trailing bytes of alg_name\nwith null bytes.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nAcked-by: Steffen Klassert <steffen.klassert@secunet.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/xfrm\/xfrm_user.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/xfrm\/xfrm_user.c b\/net\/xfrm\/xfrm_user.c\nindex d12b62547ad07..40dd50d6c4cc3 100644\n--- a\/net\/xfrm\/xfrm_user.c\n+++ b\/net\/xfrm\/xfrm_user.c\n@@ -742,7 +742,7 @@ static int copy_to_user_auth(struct xfrm_algo_auth *auth, struct sk_buff *skb)\n \t\treturn -EMSGSIZE;\n \n \talgo = nla_data(nla);\n-\tstrcpy(algo->alg_name, auth->alg_name);\n+\tstrncpy(algo->alg_name, auth->alg_name, sizeof(algo->alg_name));\n \tmemcpy(algo->alg_key, auth->alg_key, (auth->alg_key_len + 7) \/ 8);\n \talgo->alg_key_len = auth->alg_key_len;\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-6545","CWE_ID":"200","category":"security","commit_id":"9344a972961d1a6d2c04d9008b13617bcb6ec2ef","commit_message":"From 9344a972961d1a6d2c04d9008b13617bcb6ec2ef Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:50 +0000\nSubject: [PATCH] Bluetooth: RFCOMM - Fix info leak via getsockname()\n\nThe RFCOMM code fails to initialize the trailing padding byte of struct\nsockaddr_rc added for alignment. It that for leaks one byte kernel stack\nvia the getsockname() syscall. Add an explicit memset(0) before filling\nthe structure to avoid the info leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Gustavo Padovan <gustavo@padovan.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/bluetooth\/rfcomm\/sock.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/bluetooth\/rfcomm\/sock.c b\/net\/bluetooth\/rfcomm\/sock.c\nindex 64f55ca614722..1a17850d093cd 100644\n--- a\/net\/bluetooth\/rfcomm\/sock.c\n+++ b\/net\/bluetooth\/rfcomm\/sock.c\n@@ -528,6 +528,7 @@ static int rfcomm_sock_getname(struct socket *sock, struct sockaddr *addr, int *\n \n \tBT_DBG(\"sock %p, sk %p\", sock, sk);\n \n+\tmemset(sa, 0, sizeof(*sa));\n \tsa->rc_family  = AF_BLUETOOTH;\n \tsa->rc_channel = rfcomm_pi(sk)->channel;\n \tif (peer)\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2010-2943","CWE_ID":"200","category":"security","commit_id":"1920779e67cbf5ea8afef317777c5bf2b8096188","commit_message":"From 1920779e67cbf5ea8afef317777c5bf2b8096188 Mon Sep 17 00:00:00 2001\nFrom: Dave Chinner <dchinner@redhat.com>\nDate: Thu, 24 Jun 2010 11:15:47 +1000\nSubject: xfs: rename XFS_IGET_BULKSTAT to XFS_IGET_UNTRUSTED\n\nInode numbers may come from somewhere external to the filesystem\n(e.g. file handles, bulkstat information) and so are inherently\nuntrusted. Rename the flag we use for these lookups to make it\nobvious we are doing a lookup of an untrusted inode number and need\nto verify it completely before trying to read it from disk.\n\nSigned-off-by: Dave Chinner <dchinner@redhat.com>\nReviewed-by: Christoph Hellwig <hch@lst.de>\n---\n fs\/xfs\/linux-2.6\/xfs_export.c |  9 ++++-----\n fs\/xfs\/xfs_ialloc.c           | 11 +++++++----\n fs\/xfs\/xfs_inode.c            |  2 +-\n fs\/xfs\/xfs_inode.h            |  2 +-\n fs\/xfs\/xfs_itable.c           |  2 +-\n 5 files changed, 14 insertions(+), 12 deletions(-)\n\n","diff_code":"diff --git a\/fs\/xfs\/linux-2.6\/xfs_export.c b\/fs\/xfs\/linux-2.6\/xfs_export.c\nindex 846b75aeb2ab..92c84a19cc9e 100644\n--- a\/fs\/xfs\/linux-2.6\/xfs_export.c\n+++ b\/fs\/xfs\/linux-2.6\/xfs_export.c\n@@ -128,12 +128,11 @@ xfs_nfs_get_inode(\n \t\treturn ERR_PTR(-ESTALE);\n \n \t\/*\n-\t * The XFS_IGET_BULKSTAT means that an invalid inode number is just\n-\t * fine and not an indication of a corrupted filesystem.  Because\n-\t * clients can send any kind of invalid file handle, e.g. after\n-\t * a restore on the server we have to deal with this case gracefully.\n+\t * The XFS_IGET_UNTRUSTED means that an invalid inode number is just\n+\t * fine and not an indication of a corrupted filesystem as clients can\n+\t * send invalid file handles and we have to handle it gracefully..\n \t *\/\n-\terror = xfs_iget(mp, NULL, ino, XFS_IGET_BULKSTAT,\n+\terror = xfs_iget(mp, NULL, ino, XFS_IGET_UNTRUSTED,\n \t\t\t XFS_ILOCK_SHARED, &ip, 0);\n \tif (error) {\n \t\t\/*\ndiff --git a\/fs\/xfs\/xfs_ialloc.c b\/fs\/xfs\/xfs_ialloc.c\nindex 0c946c8e05da..d8fd36685eb9 100644\n--- a\/fs\/xfs\/xfs_ialloc.c\n+++ b\/fs\/xfs\/xfs_ialloc.c\n@@ -1251,7 +1251,7 @@ xfs_imap_lookup(\n \t\treturn error;\n \n \t\/* for untrusted inodes check it is allocated first *\/\n-\tif ((flags & XFS_IGET_BULKSTAT) &&\n+\tif ((flags & XFS_IGET_UNTRUSTED) &&\n \t    (rec.ir_free & XFS_INOBT_MASK(agino - rec.ir_startino)))\n \t\treturn EINVAL;\n \n@@ -1292,8 +1292,11 @@ xfs_imap(\n \tif (agno >= mp->m_sb.sb_agcount || agbno >= mp->m_sb.sb_agblocks ||\n \t    ino != XFS_AGINO_TO_INO(mp, agno, agino)) {\n #ifdef DEBUG\n-\t\t\/* no diagnostics for bulkstat, ino comes from userspace *\/\n-\t\tif (flags & XFS_IGET_BULKSTAT)\n+\t\t\/*\n+\t\t * Don't output diagnostic information for untrusted inodes\n+\t\t * as they can be invalid without implying corruption.\n+\t\t *\/\n+\t\tif (flags & XFS_IGET_UNTRUSTED)\n \t\t\treturn XFS_ERROR(EINVAL);\n \t\tif (agno >= mp->m_sb.sb_agcount) {\n \t\t\txfs_fs_cmn_err(CE_ALERT, mp,\n@@ -1329,7 +1332,7 @@ xfs_imap(\n \t * inodes in stale state on disk. Hence we have to do a btree lookup\n \t * in all cases where an untrusted inode number is passed.\n \t *\/\n-\tif (flags & XFS_IGET_BULKSTAT) {\n+\tif (flags & XFS_IGET_UNTRUSTED) {\n \t\terror = xfs_imap_lookup(mp, tp, agno, agino, agbno,\n \t\t\t\t\t&chunk_agbno, &offset_agbno, flags);\n \t\tif (error)\ndiff --git a\/fs\/xfs\/xfs_inode.c b\/fs\/xfs\/xfs_inode.c\nindex d53c39de7d05..12c277a5e98a 100644\n--- a\/fs\/xfs\/xfs_inode.c\n+++ b\/fs\/xfs\/xfs_inode.c\n@@ -177,7 +177,7 @@ xfs_imap_to_bp(\n \t\tif (unlikely(XFS_TEST_ERROR(!di_ok, mp,\n \t\t\t\t\t\tXFS_ERRTAG_ITOBP_INOTOBP,\n \t\t\t\t\t\tXFS_RANDOM_ITOBP_INOTOBP))) {\n-\t\t\tif (iget_flags & XFS_IGET_BULKSTAT) {\n+\t\t\tif (iget_flags & XFS_IGET_UNTRUSTED) {\n \t\t\t\txfs_trans_brelse(tp, bp);\n \t\t\t\treturn XFS_ERROR(EINVAL);\n \t\t\t}\ndiff --git a\/fs\/xfs\/xfs_inode.h b\/fs\/xfs\/xfs_inode.h\nindex 9965e40a4615..6b31b38244ab 100644\n--- a\/fs\/xfs\/xfs_inode.h\n+++ b\/fs\/xfs\/xfs_inode.h\n@@ -500,7 +500,7 @@ do { \\\n  * Flags for xfs_iget()\n  *\/\n #define XFS_IGET_CREATE\t\t0x1\n-#define XFS_IGET_BULKSTAT\t0x2\n+#define XFS_IGET_UNTRUSTED\t0x2\n \n int\t\txfs_inotobp(struct xfs_mount *, struct xfs_trans *,\n \t\t\t    xfs_ino_t, struct xfs_dinode **,\ndiff --git a\/fs\/xfs\/xfs_itable.c b\/fs\/xfs\/xfs_itable.c\nindex 83d7827793e4..2acd12fd3f25 100644\n--- a\/fs\/xfs\/xfs_itable.c\n+++ b\/fs\/xfs\/xfs_itable.c\n@@ -80,7 +80,7 @@ xfs_bulkstat_one_int(\n \t\treturn XFS_ERROR(ENOMEM);\n \n \terror = xfs_iget(mp, NULL, ino,\n-\t\t\t XFS_IGET_BULKSTAT, XFS_ILOCK_SHARED, &ip, bno);\n+\t\t\t XFS_IGET_UNTRUSTED, XFS_ILOCK_SHARED, &ip, bno);\n \tif (error) {\n \t\t*stat = BULKSTAT_RV_NOTHING;\n \t\tgoto out_free;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"mjg59","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-3224","CWE_ID":"200","category":"security","commit_id":"4683f42fde3977bdb4e8a09622788cc8b5313778","commit_message":"From 4683f42fde3977bdb4e8a09622788cc8b5313778 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:49 +0000\nSubject: Bluetooth: fix possible info leak in bt_sock_recvmsg()\n\nIn case the socket is already shutting down, bt_sock_recvmsg() returns\nwith 0 without updating msg_namelen leading to net\/socket.c leaking the\nlocal, uninitialized sockaddr_storage variable to userland -- 128 bytes\nof kernel stack memory.\n\nFix this by moving the msg_namelen assignment in front of the shutdown\ntest.\n\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Gustavo Padovan <gustavo@padovan.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/bluetooth\/af_bluetooth.c | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/net\/bluetooth\/af_bluetooth.c b\/net\/bluetooth\/af_bluetooth.c\nindex d3ee69b35a78..0d1b08cc76e1 100644\n--- a\/net\/bluetooth\/af_bluetooth.c\n+++ b\/net\/bluetooth\/af_bluetooth.c\n@@ -230,6 +230,8 @@ int bt_sock_recvmsg(struct kiocb *iocb, struct socket *sock,\n \tif (flags & (MSG_OOB))\n \t\treturn -EOPNOTSUPP;\n \n+\tmsg->msg_namelen = 0;\n+\n \tskb = skb_recv_datagram(sk, flags, noblock, &err);\n \tif (!skb) {\n \t\tif (sk->sk_shutdown & RCV_SHUTDOWN)\n@@ -237,8 +239,6 @@ int bt_sock_recvmsg(struct kiocb *iocb, struct socket *sock,\n \t\treturn err;\n \t}\n \n-\tmsg->msg_namelen = 0;\n-\n \tcopied = skb->len;\n \tif (len < copied) {\n \t\tmsg->msg_flags |= MSG_TRUNC;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"mjg59","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-7407","CWE_ID":"200","category":"security","commit_id":"1890d59905414ab84a35892b2e45833654aa5c13","commit_message":"From 1890d59905414ab84a35892b2e45833654aa5c13 Mon Sep 17 00:00:00 2001\nFrom: Dan Fandrich <dan@coneharvesters.com>\nDate: Sat, 11 Mar 2017 10:59:34 +0100\nSubject: [PATCH] tool_writeout: fixed a buffer read overrun on --write-out\n\nIf a % ended the statement, the string's trailing NUL would be skipped\nand memory past the end of the buffer would be accessed and potentially\ndisplayed as part of the --write-out output. Added tests 1440 and 1441\nto check for this kind of condition.\n\nReported-by: Brian Carpenter\n---\n src\/tool_writeout.c     |  2 +-\n tests\/data\/Makefile.inc |  2 +-\n tests\/data\/test1440     | 31 +++++++++++++++++++++++++++++++\n tests\/data\/test1441     | 31 +++++++++++++++++++++++++++++++\n 4 files changed, 64 insertions(+), 2 deletions(-)\n create mode 100644 tests\/data\/test1440\n create mode 100644 tests\/data\/test1441\n\n","diff_code":"diff --git a\/src\/tool_writeout.c b\/src\/tool_writeout.c\nindex 2fb77742ad..7843182f29 100644\n--- a\/src\/tool_writeout.c\n+++ b\/src\/tool_writeout.c\n@@ -113,7 +113,7 @@ void ourWriteOut(CURL *curl, struct OutStruct *outs, const char *writeinfo)\n   double doubleinfo;\n \n   while(ptr && *ptr) {\n-    if('%' == *ptr) {\n+    if('%' == *ptr && ptr[1]) {\n       if('%' == ptr[1]) {\n         \/* an escaped %-letter *\/\n         fputc('%', stream);\ndiff --git a\/tests\/data\/Makefile.inc b\/tests\/data\/Makefile.inc\nindex 7742bcfecf..a6a06b81f2 100644\n--- a\/tests\/data\/Makefile.inc\n+++ b\/tests\/data\/Makefile.inc\n@@ -153,7 +153,7 @@ test1408 test1409 test1410 test1411 test1412 test1413 test1414 test1415 \\\n test1416 test1417 test1418 test1419 test1420 test1421 test1422 test1423 \\\n test1424 \\\n test1428 test1429 test1430 test1431 test1432 test1433 test1434 test1435 \\\n-test1436 test1437 test1438 test1439 \\\n+test1436 test1437 test1438 test1439 test1440 test1441 \\\n \\\n test1500 test1501 test1502 test1503 test1504 test1505 test1506 test1507 \\\n test1508 test1509 test1510 test1511 test1512 test1513 test1514 test1515 \\\ndiff --git a\/tests\/data\/test1440 b\/tests\/data\/test1440\nnew file mode 100644\nindex 0000000000..7ed0c4d5f6\n--- \/dev\/null\n+++ b\/tests\/data\/test1440\n@@ -0,0 +1,31 @@\n+<testcase>\n+<info>\n+<keywords>\n+--write-out\n+<\/keywords>\n+<\/info>\n+# Server-side\n+<reply>\n+<\/reply>\n+\n+# Client-side\n+<client>\n+<server>\n+file\n+<\/server>\n+\n+<name>\n+Check --write-out with trailing %{\n+<\/name>\n+<command>\n+file:\/\/localhost\/%PWD\/log\/ --write-out '%{'\n+<\/command>\n+<\/client>\n+\n+# Verify data\n+<verify>\n+<stdout nonewline=\"yes\">\n+%{\n+<\/stdout>\n+<\/verify>\n+<\/testcase>\ndiff --git a\/tests\/data\/test1441 b\/tests\/data\/test1441\nnew file mode 100644\nindex 0000000000..6e253a690c\n--- \/dev\/null\n+++ b\/tests\/data\/test1441\n@@ -0,0 +1,31 @@\n+<testcase>\n+<info>\n+<keywords>\n+--write-out\n+<\/keywords>\n+<\/info>\n+# Server-side\n+<reply>\n+<\/reply>\n+\n+# Client-side\n+<client>\n+<server>\n+file\n+<\/server>\n+\n+<name>\n+Check --write-out with trailing %\n+<\/name>\n+<command>\n+file:\/\/localhost\/%PWD\/log\/ --write-out '%'\n+<\/command>\n+<\/client>\n+\n+# Verify data\n+<verify>\n+<stdout nonewline=\"yes\">\n+%\n+<\/stdout>\n+<\/verify>\n+<\/testcase>\n","owner":"curl","repo":"curl","source":"cve"},{"CVE_ID":"CVE-2013-4299","CWE_ID":"200","category":"security","commit_id":"e9c6a182649f4259db704ae15a91ac820e63b0ca","commit_message":"From e9c6a182649f4259db704ae15a91ac820e63b0ca Mon Sep 17 00:00:00 2001\nFrom: Mikulas Patocka <mpatocka@redhat.com>\nDate: Wed, 16 Oct 2013 03:17:47 +0100\nSubject: [PATCH] dm snapshot: fix data corruption\n\nThis patch fixes a particular type of data corruption that has been\nencountered when loading a snapshot's metadata from disk.\n\nWhen we allocate a new chunk in persistent_prepare, we increment\nps->next_free and we make sure that it doesn't point to a metadata area\nby further incrementing it if necessary.\n\nWhen we load metadata from disk on device activation, ps->next_free is\npositioned after the last used data chunk. However, if this last used\ndata chunk is followed by a metadata area, ps->next_free is positioned\nerroneously to the metadata area. A newly-allocated chunk is placed at\nthe same location as the metadata area, resulting in data or metadata\ncorruption.\n\nThis patch changes the code so that ps->next_free skips the metadata\narea when metadata are loaded in function read_exceptions.\n\nThe patch also moves a piece of code from persistent_prepare_exception\nto a separate function skip_metadata to avoid code duplication.\n\nCVE-2013-4299\n\nSigned-off-by: Mikulas Patocka <mpatocka@redhat.com>\nCc: stable@vger.kernel.org\nCc: Mike Snitzer <snitzer@redhat.com>\nSigned-off-by: Alasdair G Kergon <agk@redhat.com>\n---\n drivers\/md\/dm-snap-persistent.c | 18 ++++++++++++------\n 1 file changed, 12 insertions(+), 6 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/md\/dm-snap-persistent.c b\/drivers\/md\/dm-snap-persistent.c\nindex 4caa8e6d59d79..2d2b1b7588d7e 100644\n--- a\/drivers\/md\/dm-snap-persistent.c\n+++ b\/drivers\/md\/dm-snap-persistent.c\n@@ -269,6 +269,14 @@ static chunk_t area_location(struct pstore *ps, chunk_t area)\n \treturn NUM_SNAPSHOT_HDR_CHUNKS + ((ps->exceptions_per_area + 1) * area);\n }\n \n+static void skip_metadata(struct pstore *ps)\n+{\n+\tuint32_t stride = ps->exceptions_per_area + 1;\n+\tchunk_t next_free = ps->next_free;\n+\tif (sector_div(next_free, stride) == NUM_SNAPSHOT_HDR_CHUNKS)\n+\t\tps->next_free++;\n+}\n+\n \/*\n  * Read or write a metadata area.  Remembering to skip the first\n  * chunk which holds the header.\n@@ -502,6 +510,8 @@ static int read_exceptions(struct pstore *ps,\n \n \tps->current_area--;\n \n+\tskip_metadata(ps);\n+\n \treturn 0;\n }\n \n@@ -616,8 +626,6 @@ static int persistent_prepare_exception(struct dm_exception_store *store,\n \t\t\t\t\tstruct dm_exception *e)\n {\n \tstruct pstore *ps = get_info(store);\n-\tuint32_t stride;\n-\tchunk_t next_free;\n \tsector_t size = get_dev_size(dm_snap_cow(store->snap)->bdev);\n \n \t\/* Is there enough room ? *\/\n@@ -630,10 +638,8 @@ static int persistent_prepare_exception(struct dm_exception_store *store,\n \t * Move onto the next free pending, making sure to take\n \t * into account the location of the metadata chunks.\n \t *\/\n-\tstride = (ps->exceptions_per_area + 1);\n-\tnext_free = ++ps->next_free;\n-\tif (sector_div(next_free, stride) == 1)\n-\t\tps->next_free++;\n+\tps->next_free++;\n+\tskip_metadata(ps);\n \n \tatomic_inc(&ps->pending_count);\n \treturn 0;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-6542","CWE_ID":"200","category":"security","commit_id":"3592aaeb80290bda0f2cf0b5456c97bfc638b192","commit_message":"From 3592aaeb80290bda0f2cf0b5456c97bfc638b192 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:53 +0000\nSubject: [PATCH] llc: fix info leak via getsockname()\n\nThe LLC code wrongly returns 0, i.e. \"success\", when the socket is\nzapped. Together with the uninitialized uaddrlen pointer argument from\nsys_getsockname this leads to an arbitrary memory leak of up to 128\nbytes kernel stack via the getsockname() syscall.\n\nReturn an error instead when the socket is zapped to prevent the info\nleak. Also remove the unnecessary memset(0). We don't directly write to\nthe memory pointed by uaddr but memcpy() a local structure at the end of\nthe function that is properly initialized.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nCc: Arnaldo Carvalho de Melo <acme@ghostprotocols.net>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/llc\/af_llc.c | 3 +--\n 1 file changed, 1 insertion(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/net\/llc\/af_llc.c b\/net\/llc\/af_llc.c\nindex 8c2919ca36f63..c2190005a1141 100644\n--- a\/net\/llc\/af_llc.c\n+++ b\/net\/llc\/af_llc.c\n@@ -969,14 +969,13 @@ static int llc_ui_getname(struct socket *sock, struct sockaddr *uaddr,\n \tstruct sockaddr_llc sllc;\n \tstruct sock *sk = sock->sk;\n \tstruct llc_sock *llc = llc_sk(sk);\n-\tint rc = 0;\n+\tint rc = -EBADF;\n \n \tmemset(&sllc, 0, sizeof(sllc));\n \tlock_sock(sk);\n \tif (sock_flag(sk, SOCK_ZAPPED))\n \t\tgoto out;\n \t*uaddrlen = sizeof(sllc);\n-\tmemset(uaddr, 0, *uaddrlen);\n \tif (peer) {\n \t\trc = -ENOTCONN;\n \t\tif (sk->sk_state != TCP_ESTABLISHED)\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-3193","CWE_ID":"200","category":"security","commit_id":"d73cc256c8e256c32ed959456101b73ba9842f72","commit_message":"From d73cc256c8e256c32ed959456101b73ba9842f72 Mon Sep 17 00:00:00 2001\nFrom: Andy Polyakov <appro@openssl.org>\nDate: Tue, 1 Dec 2015 09:00:32 +0100\nSubject: [PATCH] bn\/asm\/x86_64-mont5.pl: fix carry propagating bug\n (CVE-2015-3193).\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\n(cherry picked from commit e7c078db57908cbf16074c68034977565ffaf107)\n---\n crypto\/bn\/asm\/x86_64-mont5.pl | 22 +++++++++++++++++++---\n crypto\/bn\/bntest.c            | 18 ++++++++++++++++++\n 2 files changed, 37 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/crypto\/bn\/asm\/x86_64-mont5.pl b\/crypto\/bn\/asm\/x86_64-mont5.pl\nindex 388e3c6911..64e668f140 100755\n--- a\/crypto\/bn\/asm\/x86_64-mont5.pl\n+++ b\/crypto\/bn\/asm\/x86_64-mont5.pl\n@@ -1784,6 +1784,15 @@ sqr8x_reduction:\n .align\t32\n .L8x_tail_done:\n \tadd\t(%rdx),%r8\t\t# can this overflow?\n+\tadc\t\\$0,%r9\n+\tadc\t\\$0,%r10\n+\tadc\t\\$0,%r11\n+\tadc\t\\$0,%r12\n+\tadc\t\\$0,%r13\n+\tadc\t\\$0,%r14\n+\tadc\t\\$0,%r15\t\t# can't overflow, because we\n+\t\t\t\t\t# started with \"overhung\" part\n+\t\t\t\t\t# of multiplication\n \txor\t%rax,%rax\n \n \tneg\t$carry\n@@ -3130,6 +3139,15 @@ sqrx8x_reduction:\n .align\t32\n .Lsqrx8x_tail_done:\n \tadd\t24+8(%rsp),%r8\t\t# can this overflow?\n+\tadc\t\\$0,%r9\n+\tadc\t\\$0,%r10\n+\tadc\t\\$0,%r11\n+\tadc\t\\$0,%r12\n+\tadc\t\\$0,%r13\n+\tadc\t\\$0,%r14\n+\tadc\t\\$0,%r15\t\t# can't overflow, because we\n+\t\t\t\t\t# started with \"overhung\" part\n+\t\t\t\t\t# of multiplication\n \tmov\t$carry,%rax\t\t# xor\t%rax,%rax\n \n \tsub\t16+8(%rsp),$carry\t# mov 16(%rsp),%cf\n@@ -3173,13 +3191,11 @@ my ($rptr,$nptr)=(\"%rdx\",\"%rbp\");\n my @ri=map(\"%r$_\",(10..13));\n my @ni=map(\"%r$_\",(14..15));\n $code.=<<___;\n-\txor\t%rbx,%rbx\n+\txor\t%ebx,%ebx\n \tsub\t%r15,%rsi\t\t# compare top-most words\n \tadc\t%rbx,%rbx\n \tmov\t%rcx,%r10\t\t# -$num\n-\t.byte\t0x67\n \tor\t%rbx,%rax\n-\t.byte\t0x67\n \tmov\t%rcx,%r9\t\t# -$num\n \txor\t\\$1,%rax\n \tsar\t\\$3+2,%rcx\t\t# cf=0\ndiff --git a\/crypto\/bn\/bntest.c b\/crypto\/bn\/bntest.c\nindex 8b8a15220e..1e35988022 100644\n--- a\/crypto\/bn\/bntest.c\n+++ b\/crypto\/bn\/bntest.c\n@@ -1016,6 +1016,24 @@ int test_mod_exp(BIO *bp, BN_CTX *ctx)\n             return 0;\n         }\n     }\n+\n+    \/* Regression test for carry propagation bug in sqr8x_reduction *\/\n+    BN_hex2bn(&a, \"050505050505\");\n+    BN_hex2bn(&b, \"02\");\n+    BN_hex2bn(&c,\n+        \"4141414141414141414141274141414141414141414141414141414141414141\"\n+        \"4141414141414141414141414141414141414141414141414141414141414141\"\n+        \"4141414141414141414141800000000000000000000000000000000000000000\"\n+        \"0000000000000000000000000000000000000000000000000000000000000000\"\n+        \"0000000000000000000000000000000000000000000000000000000000000000\"\n+        \"0000000000000000000000000000000000000000000000000000000001\");\n+    BN_mod_exp(d, a, b, c, ctx);\n+    BN_mul(e, a, a, ctx);\n+    if (BN_cmp(d, e)) {\n+        fprintf(stderr, \"BN_mod_exp and BN_mul produce different results!\\n\");\n+        return 0;\n+    }\n+\n     BN_free(a);\n     BN_free(b);\n     BN_free(c);\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2015-3400","CWE_ID":"200","category":"security","commit_id":"99aa4d2b4fd12c6bef62d02ffd1b375ddd42fcf4","commit_message":"From 99aa4d2b4fd12c6bef62d02ffd1b375ddd42fcf4 Mon Sep 17 00:00:00 2001\nFrom: Turbo Fredriksson <turbo@bayour.com>\nDate: Sun, 26 Oct 2014 14:29:11 +0100\nSubject: [PATCH] Move nfs.c:foreach_nfs_shareopt() to\n libshare.c:foreach_shareopt() so that it can be (re)used in other parts of\n libshare.\n\n---\n lib\/libshare\/libshare.c      | 59 +++++++++++++++++++++++++++++++\n lib\/libshare\/libshare_impl.h |  3 ++\n lib\/libshare\/nfs.c           | 67 ++----------------------------------\n 3 files changed, 64 insertions(+), 65 deletions(-)\n\n","diff_code":"diff --git a\/lib\/libshare\/libshare.c b\/lib\/libshare\/libshare.c\nindex ea59dcdbc60..5eed83ffe3b 100644\n--- a\/lib\/libshare\/libshare.c\n+++ b\/lib\/libshare\/libshare.c\n@@ -56,6 +56,65 @@ static int update_zfs_shares(sa_handle_impl_t impl_handle, const char *proto);\n static int fstypes_count;\n static sa_fstype_t *fstypes;\n \n+\/*\n+ * Invokes the specified callback function for each Solaris share option\n+ * listed in the specified string.\n+ *\/\n+int\n+foreach_shareopt(const char *shareopts,\n+    nfs_shareopt_callback_t callback, void *cookie)\n+{\n+\tchar *shareopts_dup, *opt, *cur, *value;\n+\tint was_nul, rc;\n+\n+\tif (shareopts == NULL)\n+\t\treturn (SA_OK);\n+\n+\tshareopts_dup = strdup(shareopts);\n+\tif (shareopts_dup == NULL)\n+\t\treturn (SA_NO_MEMORY);\n+\n+\topt = shareopts_dup;\n+\twas_nul = 0;\n+\n+\twhile (1) {\n+\t\tcur = opt;\n+\n+\t\twhile (*cur != ',' && *cur != '\\0')\n+\t\t\tcur++;\n+\n+\t\tif (*cur == '\\0')\n+\t\t\twas_nul = 1;\n+\n+\t\t*cur = '\\0';\n+\n+\t\tif (cur > opt) {\n+\t\t\tvalue = strchr(opt, '=');\n+\n+\t\t\tif (value != NULL) {\n+\t\t\t\t*value = '\\0';\n+\t\t\t\tvalue++;\n+\t\t\t}\n+\n+\t\t\trc = callback(opt, value, cookie);\n+\n+\t\t\tif (rc != SA_OK) {\n+\t\t\t\tfree(shareopts_dup);\n+\t\t\t\treturn (rc);\n+\t\t\t}\n+\t\t}\n+\n+\t\topt = cur + 1;\n+\n+\t\tif (was_nul)\n+\t\t\tbreak;\n+\t}\n+\n+\tfree(shareopts_dup);\n+\n+\treturn (SA_OK);\n+}\n+\n sa_fstype_t *\n register_fstype(const char *name, const sa_share_ops_t *ops)\n {\ndiff --git a\/lib\/libshare\/libshare_impl.h b\/lib\/libshare\/libshare_impl.h\nindex 18d619b1070..d03fbd97a42 100644\n--- a\/lib\/libshare\/libshare_impl.h\n+++ b\/lib\/libshare\/libshare_impl.h\n@@ -67,4 +67,7 @@ typedef struct sa_handle_impl {\n \tsa_share_impl_t shares;\n } *sa_handle_impl_t;\n \n+typedef int (*nfs_shareopt_callback_t)(const char *, const char *, void *);\n+\n sa_fstype_t *register_fstype(const char *name, const sa_share_ops_t *ops);\n+int foreach_shareopt(const char *, nfs_shareopt_callback_t, void *);\ndiff --git a\/lib\/libshare\/nfs.c b\/lib\/libshare\/nfs.c\nindex d1b207e6508..bf92893160a 100644\n--- a\/lib\/libshare\/nfs.c\n+++ b\/lib\/libshare\/nfs.c\n@@ -44,72 +44,9 @@ static sa_fstype_t *nfs_fstype;\n  *\/\n static int nfs_exportfs_temp_fd = -1;\n \n-typedef int (*nfs_shareopt_callback_t)(const char *opt, const char *value,\n-    void *cookie);\n-\n typedef int (*nfs_host_callback_t)(const char *sharepath, const char *host,\n     const char *security, const char *access, void *cookie);\n \n-\/*\n- * Invokes the specified callback function for each Solaris share option\n- * listed in the specified string.\n- *\/\n-static int\n-foreach_nfs_shareopt(const char *shareopts,\n-    nfs_shareopt_callback_t callback, void *cookie)\n-{\n-\tchar *shareopts_dup, *opt, *cur, *value;\n-\tint was_nul, rc;\n-\n-\tif (shareopts == NULL)\n-\t\treturn (SA_OK);\n-\n-\tshareopts_dup = strdup(shareopts);\n-\n-\tif (shareopts_dup == NULL)\n-\t\treturn (SA_NO_MEMORY);\n-\n-\topt = shareopts_dup;\n-\twas_nul = 0;\n-\n-\twhile (1) {\n-\t\tcur = opt;\n-\n-\t\twhile (*cur != ',' && *cur != '\\0')\n-\t\t\tcur++;\n-\n-\t\tif (*cur == '\\0')\n-\t\t\twas_nul = 1;\n-\n-\t\t*cur = '\\0';\n-\n-\t\tif (cur > opt) {\n-\t\t\tvalue = strchr(opt, '=');\n-\n-\t\t\tif (value != NULL) {\n-\t\t\t\t*value = '\\0';\n-\t\t\t\tvalue++;\n-\t\t\t}\n-\n-\t\t\trc = callback(opt, value, cookie);\n-\n-\t\t\tif (rc != SA_OK) {\n-\t\t\t\tfree(shareopts_dup);\n-\t\t\t\treturn (rc);\n-\t\t\t}\n-\t\t}\n-\n-\t\topt = cur + 1;\n-\n-\t\tif (was_nul)\n-\t\t\tbreak;\n-\t}\n-\n-\tfree(shareopts_dup);\n-\n-\treturn (0);\n-}\n-\n typedef struct nfs_host_cookie_s {\n \tnfs_host_callback_t callback;\n \tconst char *sharepath;\n@@ -118,7 +55,7 @@ typedef struct nfs_host_cookie_s {\n } nfs_host_cookie_t;\n \n \/*\n- * Helper function for foreach_nfs_host. This function checks whether the\n+ * Helper function for foreach_host. This function checks whether the\n  * current share option is a host specification and invokes a callback\n  * function with information about the host.\n  *\/\n@@ -390,7 +327,7 @@ get_linux_shareopts(const char *shareopts, char **plinux_opts)\n \t(void) add_linux_shareopt(plinux_opts, \"no_root_squash\", NULL);\n \t(void) add_linux_shareopt(plinux_opts, \"mountpoint\", NULL);\n \n-\trc = foreach_nfs_shareopt(shareopts, get_linux_shareopts_cb,\n+\trc = foreach_shareopt(shareopts, get_linux_shareopts_cb,\n \t    plinux_opts);\n \n \tif (rc != SA_OK) {\n","owner":"FransUrbo","repo":"zfs","source":"cve"},{"CVE_ID":"CVE-2016-4578","CWE_ID":"200","category":"security","commit_id":"e4ec8cc8039a7063e24204299b462bd1383184a5","commit_message":"From e4ec8cc8039a7063e24204299b462bd1383184a5 Mon Sep 17 00:00:00 2001\nFrom: Kangjie Lu <kangjielu@gmail.com>\nDate: Tue, 3 May 2016 16:44:32 -0400\nSubject: [PATCH] ALSA: timer: Fix leak in events via snd_timer_user_tinterrupt\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nThe stack object \u201cr1\u201d has a total size of 32 bytes. Its field\n\u201cevent\u201d and \u201cval\u201d both contain 4 bytes padding. These 8 bytes\npadding bytes are sent to user without being initialized.\n\nSigned-off-by: Kangjie Lu <kjlu@gatech.edu>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>\n---\n sound\/core\/timer.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/sound\/core\/timer.c b\/sound\/core\/timer.c\nindex cc3c08d17ab16..e722022d325d7 100644\n--- a\/sound\/core\/timer.c\n+++ b\/sound\/core\/timer.c\n@@ -1266,6 +1266,7 @@ static void snd_timer_user_tinterrupt(struct snd_timer_instance *timeri,\n \t}\n \tif ((tu->filter & (1 << SNDRV_TIMER_EVENT_RESOLUTION)) &&\n \t    tu->last_resolution != resolution) {\n+\t\tmemset(&r1, 0, sizeof(r1));\n \t\tr1.event = SNDRV_TIMER_EVENT_RESOLUTION;\n \t\tr1.tstamp = tstamp;\n \t\tr1.val = resolution;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-14954","CWE_ID":"200","category":"security","commit_id":"6c85501f2fabcfc4fc6ed976543d252c4eaf4be9","commit_message":"From 6c85501f2fabcfc4fc6ed976543d252c4eaf4be9 Mon Sep 17 00:00:00 2001\nFrom: Al Viro <viro@zeniv.linux.org.uk>\nDate: Fri, 29 Sep 2017 13:43:15 -0400\nSubject: fix infoleak in waitid(2)\n\nkernel_waitid() can return a PID, an error or 0.  rusage is filled in the first\ncase and waitid(2) rusage should've been copied out exactly in that case, *not*\nwhenever kernel_waitid() has not returned an error.  Compat variant shares that\nbraino; none of kernel_wait4() callers do, so the below ought to fix it.\n\nReported-and-tested-by: Alexander Potapenko <glider@google.com>\nFixes: ce72a16fa705 (\"wait4(2)\/waitid(2): separate copying rusage to userland\")\nCc: stable@vger.kernel.org # v4.13\nSigned-off-by: Al Viro <viro@zeniv.linux.org.uk>\n---\n kernel\/exit.c | 23 ++++++++++-------------\n 1 file changed, 10 insertions(+), 13 deletions(-)\n\n","diff_code":"diff --git a\/kernel\/exit.c b\/kernel\/exit.c\nindex 3481ababd06a..f2cd53e92147 100644\n--- a\/kernel\/exit.c\n+++ b\/kernel\/exit.c\n@@ -1600,12 +1600,10 @@ SYSCALL_DEFINE5(waitid, int, which, pid_t, upid, struct siginfo __user *,\n \tstruct waitid_info info = {.status = 0};\n \tlong err = kernel_waitid(which, upid, &info, options, ru ? &r : NULL);\n \tint signo = 0;\n+\n \tif (err > 0) {\n \t\tsigno = SIGCHLD;\n \t\terr = 0;\n-\t}\n-\n-\tif (!err) {\n \t\tif (ru && copy_to_user(ru, &r, sizeof(struct rusage)))\n \t\t\treturn -EFAULT;\n \t}\n@@ -1723,16 +1721,15 @@ COMPAT_SYSCALL_DEFINE5(waitid,\n \tif (err > 0) {\n \t\tsigno = SIGCHLD;\n \t\terr = 0;\n-\t}\n-\n-\tif (!err && uru) {\n-\t\t\/* kernel_waitid() overwrites everything in ru *\/\n-\t\tif (COMPAT_USE_64BIT_TIME)\n-\t\t\terr = copy_to_user(uru, &ru, sizeof(ru));\n-\t\telse\n-\t\t\terr = put_compat_rusage(&ru, uru);\n-\t\tif (err)\n-\t\t\treturn -EFAULT;\n+\t\tif (uru) {\n+\t\t\t\/* kernel_waitid() overwrites everything in ru *\/\n+\t\t\tif (COMPAT_USE_64BIT_TIME)\n+\t\t\t\terr = copy_to_user(uru, &ru, sizeof(ru));\n+\t\t\telse\n+\t\t\t\terr = put_compat_rusage(&ru, uru);\n+\t\t\tif (err)\n+\t\t\t\treturn -EFAULT;\n+\t\t}\n \t}\n \n \tif (!infop)\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-16355","CWE_ID":"200","category":"security","commit_id":"4043718264095cde6623c2cbe8c644541036d7bf","commit_message":"From 4043718264095cde6623c2cbe8c644541036d7bf Mon Sep 17 00:00:00 2001\nFrom: \"Daniel Knoppel (Phusion)\" <daniel@phusion.nl>\nDate: Wed, 11 Oct 2017 15:55:07 +0200\nSubject: [PATCH] Disable unused feature.\n\n---\n src\/agent\/Core\/SpawningKit\/Spawner.h | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/src\/agent\/Core\/SpawningKit\/Spawner.h b\/src\/agent\/Core\/SpawningKit\/Spawner.h\nindex e65034ae91..99dedb852f 100644\n--- a\/src\/agent\/Core\/SpawningKit\/Spawner.h\n+++ b\/src\/agent\/Core\/SpawningKit\/Spawner.h\n@@ -721,7 +721,6 @@ class Spawner {\n \t\tprepareChroot(info, options);\n \t\tinfo.userSwitching = prepareUserSwitching(options);\n \t\tprepareSwitchingWorkingDirectory(info, options);\n-\t\tinferApplicationInfo(info);\n \t\treturn info;\n \t}\n \n@@ -775,6 +774,7 @@ class Spawner {\n \t\tassert(info.appRootPathsInsideChroot.back() == info.appRootInsideChroot);\n \t}\n \n+#ifdef false\n \tvoid inferApplicationInfo(SpawnPreparationInfo &info) const {\n \t\tinfo.codeRevision = readFromRevisionFile(info);\n \t\tif (info.codeRevision.empty()) {\n@@ -817,6 +817,7 @@ class Spawner {\n \t\t\treturn string();\n \t\t}\n \t}\n+#endif\n \n \tbool shouldLoadShellEnvvars(const Options &options, const SpawnPreparationInfo &preparation) const {\n \t\tif (options.loadShellEnvvars) {\n","owner":"phusion","repo":"passenger","source":"cve"},{"CVE_ID":"CVE-2013-3234","CWE_ID":"200","category":"security","commit_id":"4a184233f21645cf0b719366210ed445d1024d72","commit_message":"From 4a184233f21645cf0b719366210ed445d1024d72 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:59 +0000\nSubject: [PATCH] rose: fix info leak via msg_name in rose_recvmsg()\n\nThe code in rose_recvmsg() does not initialize all of the members of\nstruct sockaddr_rose\/full_sockaddr_rose when filling the sockaddr info.\nNor does it initialize the padding bytes of the structure inserted by\nthe compiler for alignment. This will lead to leaking uninitialized\nkernel stack bytes in net\/socket.c.\n\nFix the issue by initializing the memory used for sockaddr info with\nmemset(0).\n\nCc: Ralf Baechle <ralf@linux-mips.org>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/rose\/af_rose.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/rose\/af_rose.c b\/net\/rose\/af_rose.c\nindex cf68e6e4054a6..9c83474515978 100644\n--- a\/net\/rose\/af_rose.c\n+++ b\/net\/rose\/af_rose.c\n@@ -1253,6 +1253,7 @@ static int rose_recvmsg(struct kiocb *iocb, struct socket *sock,\n \tskb_copy_datagram_iovec(skb, 0, msg->msg_iov, copied);\n \n \tif (srose != NULL) {\n+\t\tmemset(srose, 0, msg->msg_namelen);\n \t\tsrose->srose_family = AF_ROSE;\n \t\tsrose->srose_addr   = rose->dest_addr;\n \t\tsrose->srose_call   = rose->dest_call;\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2014-9903","CWE_ID":"200","category":"security","commit_id":"4efbc454ba68def5ef285b26ebfcfdb605b52755","commit_message":"From 4efbc454ba68def5ef285b26ebfcfdb605b52755 Mon Sep 17 00:00:00 2001\nFrom: Vegard Nossum <vegard.nossum@oracle.com>\nDate: Sun, 16 Feb 2014 22:24:17 +0100\nSubject: [PATCH] sched: Fix information leak in sys_sched_getattr()\n\nWe're copying the on-stack structure to userspace, but forgot to give\nthe right number of bytes to copy. This allows the calling process to\nobtain up to PAGE_SIZE bytes from the stack (and possibly adjacent\nkernel memory).\n\nThis fix copies only as much as we actually have on the stack\n(attr->size defaults to the size of the struct) and leaves the rest of\nthe userspace-provided buffer untouched.\n\nFound using kmemcheck + trinity.\n\nFixes: d50dde5a10f30 (\"sched: Add new scheduler syscalls to support an extended scheduling parameters ABI\")\nCc: Dario Faggioli <raistlin@linux.it>\nCc: Juri Lelli <juri.lelli@gmail.com>\nCc: Ingo Molnar <mingo@kernel.org>\nSigned-off-by: Vegard Nossum <vegard.nossum@oracle.com>\nSigned-off-by: Peter Zijlstra <peterz@infradead.org>\nLink: http:\/\/lkml.kernel.org\/r\/1392585857-10725-1-git-send-email-vegard.nossum@oracle.com\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\n---\n kernel\/sched\/core.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/kernel\/sched\/core.c b\/kernel\/sched\/core.c\nindex 33d030a133d2b..a6e7470166c7e 100644\n--- a\/kernel\/sched\/core.c\n+++ b\/kernel\/sched\/core.c\n@@ -3786,7 +3786,7 @@ static int sched_read_attr(struct sched_attr __user *uattr,\n \t\tattr->size = usize;\n \t}\n \n-\tret = copy_to_user(uattr, attr, usize);\n+\tret = copy_to_user(uattr, attr, attr->size);\n \tif (ret)\n \t\treturn -EFAULT;\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2011-2492","CWE_ID":"200","category":"security","commit_id":"8d03e971cf403305217b8e62db3a2e5ad2d6263f","commit_message":"From 8d03e971cf403305217b8e62db3a2e5ad2d6263f Mon Sep 17 00:00:00 2001\nFrom: Filip Palian <s3810@pjwstk.edu.pl>\nDate: Thu, 12 May 2011 19:32:46 +0200\nSubject: Bluetooth: l2cap and rfcomm: fix 1 byte infoleak to userspace.\n\nStructures \"l2cap_conninfo\" and \"rfcomm_conninfo\" have one padding\nbyte each. This byte in \"cinfo\" is copied to userspace uninitialized.\n\nSigned-off-by: Filip Palian <filip.palian@pjwstk.edu.pl>\nAcked-by: Marcel Holtmann <marcel@holtmann.org>\nSigned-off-by: Gustavo F. Padovan <padovan@profusion.mobi>\n---\n net\/bluetooth\/l2cap_sock.c  | 1 +\n net\/bluetooth\/rfcomm\/sock.c | 1 +\n 2 files changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/net\/bluetooth\/l2cap_sock.c b\/net\/bluetooth\/l2cap_sock.c\nindex 18dc9888d8c2..8248303f44e8 100644\n--- a\/net\/bluetooth\/l2cap_sock.c\n+++ b\/net\/bluetooth\/l2cap_sock.c\n@@ -413,6 +413,7 @@ static int l2cap_sock_getsockopt_old(struct socket *sock, int optname, char __us\n \t\t\tbreak;\n \t\t}\n \n+\t\tmemset(&cinfo, 0, sizeof(cinfo));\n \t\tcinfo.hci_handle = chan->conn->hcon->handle;\n \t\tmemcpy(cinfo.dev_class, chan->conn->hcon->dev_class, 3);\n \ndiff --git a\/net\/bluetooth\/rfcomm\/sock.c b\/net\/bluetooth\/rfcomm\/sock.c\nindex 386cfaffd4b7..1b10727ce523 100644\n--- a\/net\/bluetooth\/rfcomm\/sock.c\n+++ b\/net\/bluetooth\/rfcomm\/sock.c\n@@ -788,6 +788,7 @@ static int rfcomm_sock_getsockopt_old(struct socket *sock, int optname, char __u\n \n \t\tl2cap_sk = rfcomm_pi(sk)->dlc->session->sock->sk;\n \n+\t\tmemset(&cinfo, 0, sizeof(cinfo));\n \t\tcinfo.hci_handle = conn->hcon->handle;\n \t\tmemcpy(cinfo.dev_class, conn->hcon->dev_class, 3);\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-0703","CWE_ID":"200","category":"security","commit_id":"ae50d8270026edf5b3c7f8aaa0c6677462b33d97","commit_message":"From ae50d8270026edf5b3c7f8aaa0c6677462b33d97 Mon Sep 17 00:00:00 2001\nFrom: Emilia Kasper <emilia@openssl.org>\nDate: Wed, 1 Apr 2015 17:08:45 +0200\nSubject: [PATCH] Harden SSLv2-supporting servers against Bleichenbacher's\n attack.\n\nThere is no indication that the timing differences are exploitable in\nOpenSSL, and indeed there is some indication (Usenix '14) that they\nare too small to be exploitable. Nevertheless, be careful and apply\nthe same countermeasures as in s3_srvr.c\n\nThanks to Nimrod Aviram, Sebastian Schinzel and Yuval Shavitt for\nreporting this issue.\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\n---\n ssl\/s2_srvr.c | 104 +++++++++++++++++++++++++-------------------------\n 1 file changed, 51 insertions(+), 53 deletions(-)\n\n","diff_code":"diff --git a\/ssl\/s2_srvr.c b\/ssl\/s2_srvr.c\nindex 19bb48c9cd..4289272b73 100644\n--- a\/ssl\/s2_srvr.c\n+++ b\/ssl\/s2_srvr.c\n@@ -111,6 +111,7 @@\n \n #include \"ssl_locl.h\"\n #ifndef OPENSSL_NO_SSL2\n+#include \"..\/crypto\/constant_time_locl.h\"\n # include <stdio.h>\n # include <openssl\/bio.h>\n # include <openssl\/rand.h>\n@@ -372,12 +373,15 @@ int ssl2_accept(SSL *s)\n static int get_client_master_key(SSL *s)\n {\n     int is_export, i, n, keya;\n-    unsigned int ek;\n+    unsigned int num_encrypted_key_bytes, key_length;\n     unsigned long len;\n     unsigned char *p;\n     const SSL_CIPHER *cp;\n     const EVP_CIPHER *c;\n     const EVP_MD *md;\n+    unsigned char rand_premaster_secret[SSL_MAX_MASTER_KEY_LENGTH];\n+    unsigned char decrypt_good;\n+    size_t j;\n \n     p = (unsigned char *)s->init_buf->data;\n     if (s->state == SSL2_ST_GET_CLIENT_MASTER_KEY_A) {\n@@ -465,12 +469,6 @@ static int get_client_master_key(SSL *s)\n         return (0);\n     }\n \n-    if (s->session->cipher->algorithm2 & SSL2_CF_8_BYTE_ENC) {\n-        is_export = 1;\n-        ek = 8;\n-    } else\n-        ek = 5;\n-\n     \/*\n      * The format of the CLIENT-MASTER-KEY message is\n      * 1 byte message type\n@@ -484,12 +482,27 @@ static int get_client_master_key(SSL *s)\n      *\n      * If the cipher is an export cipher, then the encrypted key bytes\n      * are a fixed portion of the total key (5 or 8 bytes). The size of\n-     * this portion is in |ek|. If the cipher is not an export cipher,\n-     * then the entire key material is encrypted (i.e., clear key length\n-     * must be zero).\n+     * this portion is in |num_encrypted_key_bytes|. If the cipher is not an\n+     * export cipher, then the entire key material is encrypted (i.e., clear\n+     * key length must be zero).\n      *\/\n-    if ((!is_export && s->s2->tmp.clear != 0) ||\n-        (is_export && s->s2->tmp.clear + ek != (unsigned int)EVP_CIPHER_key_length(c))) {\n+    key_length = (unsigned int)EVP_CIPHER_key_length(c);\n+    if (key_length > SSL_MAX_MASTER_KEY_LENGTH) {\n+        ssl2_return_error(s, SSL2_PE_UNDEFINED_ERROR);\n+        SSLerr(SSL_F_GET_CLIENT_MASTER_KEY, ERR_R_INTERNAL_ERROR);\n+        return -1;\n+    }\n+\n+    if (s->session->cipher->algorithm2 & SSL2_CF_8_BYTE_ENC) {\n+        is_export = 1;\n+        num_encrypted_key_bytes = 8;\n+    } else if (is_export) {\n+        num_encrypted_key_bytes = 5;\n+    } else {\n+        num_encrypted_key_bytes = key_length;\n+    }\n+\n+    if (s->s2->tmp.clear + num_encrypted_key_bytes != key_length) {\n         ssl2_return_error(s, SSL2_PE_UNDEFINED_ERROR);\n         SSLerr(SSL_F_GET_CLIENT_MASTER_KEY,SSL_R_BAD_LENGTH);\n         return -1;\n@@ -499,64 +512,49 @@ static int get_client_master_key(SSL *s)\n      * Decryption can't be expanding, so if we don't have enough encrypted\n      * bytes to fit the key in the buffer, stop now.\n      *\/\n-    if ((is_export && s->s2->tmp.enc < ek) ||\n-        (!is_export && s->s2->tmp.enc < (unsigned int)EVP_CIPHER_key_length(c))) {\n+    if (s->s2->tmp.enc < num_encrypted_key_bytes) {\n         ssl2_return_error(s,SSL2_PE_UNDEFINED_ERROR);\n         SSLerr(SSL_F_GET_CLIENT_MASTER_KEY,SSL_R_LENGTH_TOO_SHORT);\n         return -1;\n     }\n \n+    \/*\n+     * We must not leak whether a decryption failure occurs because of\n+     * Bleichenbacher's attack on PKCS #1 v1.5 RSA padding (see RFC 2246,\n+     * section 7.4.7.1). The code follows that advice of the TLS RFC and\n+     * generates a random premaster secret for the case that the decrypt\n+     * fails. See https:\/\/tools.ietf.org\/html\/rfc5246#section-7.4.7.1\n+     *\/\n+\n+    \/*\n+     * should be RAND_bytes, but we cannot work around a failure.\n+     *\/\n+    if (RAND_pseudo_bytes(rand_premaster_secret,\n+                          (int)num_encrypted_key_bytes) <= 0)\n+        return 0;\n+\n     i = ssl_rsa_private_decrypt(s->cert, s->s2->tmp.enc,\n                                 &(p[s->s2->tmp.clear]),\n                                 &(p[s->s2->tmp.clear]),\n                                 (s->s2->ssl2_rollback) ? RSA_SSLV23_PADDING :\n                                 RSA_PKCS1_PADDING);\n-\n-    \/* bad decrypt *\/\n-# if 1\n+    ERR_clear_error();\n     \/*\n      * If a bad decrypt, continue with protocol but with a random master\n      * secret (Bleichenbacher attack)\n      *\/\n-    if ((i < 0) || ((!is_export && i != EVP_CIPHER_key_length(c))\n-                    || (is_export && i != (int)ek))) {\n-        ERR_clear_error();\n-        if (is_export)\n-            i = ek;\n-        else\n-            i = EVP_CIPHER_key_length(c);\n-        if (RAND_pseudo_bytes(&p[s->s2->tmp.clear], i) <= 0)\n-            return 0;\n-    }\n-# else\n-    if (i < 0) {\n-        error = 1;\n-        SSLerr(SSL_F_GET_CLIENT_MASTER_KEY, SSL_R_BAD_RSA_DECRYPT);\n-    }\n-    \/* incorrect number of key bytes for non export cipher *\/\n-    else if ((!is_export && (i != EVP_CIPHER_key_length(c)))\n-             || (is_export && ((i != ek) || (s->s2->tmp.clear + i !=\n-                                             EVP_CIPHER_key_length(c))))) {\n-        error = 1;\n-        SSLerr(SSL_F_GET_CLIENT_MASTER_KEY, SSL_R_WRONG_NUMBER_OF_KEY_BITS);\n-    }\n-    if (error) {\n-        ssl2_return_error(s, SSL2_PE_UNDEFINED_ERROR);\n-        return (-1);\n+    decrypt_good = constant_time_eq_int_8(i, (int)num_encrypted_key_bytes);\n+    for (j = 0; j < num_encrypted_key_bytes; j++) {\n+        p[s->s2->tmp.clear + j] =\n+                constant_time_select_8(decrypt_good, p[s->s2->tmp.clear + j],\n+                                       rand_premaster_secret[j]);\n     }\n-# endif\n \n-    if (is_export)\n-        i = EVP_CIPHER_key_length(c);\n+    s->session->master_key_length = (int)key_length;\n+    memcpy(s->session->master_key, p, key_length);\n+    OPENSSL_cleanse(p, key_length);\n \n-    if (i > SSL_MAX_MASTER_KEY_LENGTH) {\n-        ssl2_return_error(s, SSL2_PE_UNDEFINED_ERROR);\n-        SSLerr(SSL_F_GET_CLIENT_MASTER_KEY, ERR_R_INTERNAL_ERROR);\n-        return -1;\n-    }\n-    s->session->master_key_length = i;\n-    memcpy(s->session->master_key, p, (unsigned int)i);\n-    return (1);\n+    return 1;\n }\n \n static int get_client_hello(SSL *s)\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-9605","CWE_ID":"200","category":"security","commit_id":"07678eca2cf9c9a18584e546c2b2a0d0c9a3150c","commit_message":"From 07678eca2cf9c9a18584e546c2b2a0d0c9a3150c Mon Sep 17 00:00:00 2001\nFrom: Sinclair Yeh <syeh@vmware.com>\nDate: Fri, 2 Jun 2017 07:50:57 +0200\nSubject: drm\/vmwgfx: Make sure backup_handle is always valid\n\nWhen vmw_gb_surface_define_ioctl() is called with an existing buffer,\nwe end up returning an uninitialized variable in the backup_handle.\n\nThe fix is to first initialize backup_handle to 0 just to be sure, and\nsecond, when a user-provided buffer is found, we will use the\nreq->buffer_handle as the backup_handle.\n\nCc: <stable@vger.kernel.org>\nReported-by: Murray McAllister <murray.mcallister@insomniasec.com>\nSigned-off-by: Sinclair Yeh <syeh@vmware.com>\nReviewed-by: Deepak Rawat <drawat@vmware.com>\n---\n drivers\/gpu\/drm\/vmwgfx\/vmwgfx_surface.c | 18 +++++++++++-------\n 1 file changed, 11 insertions(+), 7 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/gpu\/drm\/vmwgfx\/vmwgfx_surface.c b\/drivers\/gpu\/drm\/vmwgfx\/vmwgfx_surface.c\nindex baf03d4d86d2..834bb10973a2 100644\n--- a\/drivers\/gpu\/drm\/vmwgfx\/vmwgfx_surface.c\n+++ b\/drivers\/gpu\/drm\/vmwgfx\/vmwgfx_surface.c\n@@ -1274,7 +1274,7 @@ int vmw_gb_surface_define_ioctl(struct drm_device *dev, void *data,\n \tstruct ttm_object_file *tfile = vmw_fpriv(file_priv)->tfile;\n \tint ret;\n \tuint32_t size;\n-\tuint32_t backup_handle;\n+\tuint32_t backup_handle = 0;\n \n \tif (req->multisample_count != 0)\n \t\treturn -EINVAL;\n@@ -1317,12 +1317,16 @@ int vmw_gb_surface_define_ioctl(struct drm_device *dev, void *data,\n \t\tret = vmw_user_dmabuf_lookup(tfile, req->buffer_handle,\n \t\t\t\t\t     &res->backup,\n \t\t\t\t\t     &user_srf->backup_base);\n-\t\tif (ret == 0 && res->backup->base.num_pages * PAGE_SIZE <\n-\t\t    res->backup_size) {\n-\t\t\tDRM_ERROR(\"Surface backup buffer is too small.\\n\");\n-\t\t\tvmw_dmabuf_unreference(&res->backup);\n-\t\t\tret = -EINVAL;\n-\t\t\tgoto out_unlock;\n+\t\tif (ret == 0) {\n+\t\t\tif (res->backup->base.num_pages * PAGE_SIZE <\n+\t\t\t    res->backup_size) {\n+\t\t\t\tDRM_ERROR(\"Surface backup buffer is too small.\\n\");\n+\t\t\t\tvmw_dmabuf_unreference(&res->backup);\n+\t\t\t\tret = -EINVAL;\n+\t\t\t\tgoto out_unlock;\n+\t\t\t} else {\n+\t\t\t\tbackup_handle = req->buffer_handle;\n+\t\t\t}\n \t\t}\n \t} else if (req->drm_surface_flags & drm_vmw_surface_flag_create_buffer)\n \t\tret = vmw_user_dmabuf_alloc(dev_priv, tfile,\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2010-4076","CWE_ID":"200","category":"security","commit_id":"d281da7ff6f70efca0553c288bb883e8605b3862","commit_message":"From d281da7ff6f70efca0553c288bb883e8605b3862 Mon Sep 17 00:00:00 2001\nFrom: Alan Cox <alan@linux.intel.com>\nDate: Thu, 16 Sep 2010 18:21:24 +0100\nSubject: tty: Make tiocgicount a handler\n\nDan Rosenberg noted that various drivers return the struct with uncleared\nfields. Instead of spending forever trying to stomp all the drivers that\nget it wrong (and every new driver) do the job in one place.\n\nThis first patch adds the needed operations and hooks them up, including\nthe needed USB midlayer and serial core plumbing.\n\nSigned-off-by: Alan Cox <alan@linux.intel.com>\nSigned-off-by: Greg Kroah-Hartman <gregkh@suse.de>\n---\n drivers\/char\/tty_io.c           | 21 +++++++++++++++++++++\n drivers\/serial\/serial_core.c    | 35 ++++++++++++++++-------------------\n drivers\/usb\/serial\/usb-serial.c | 13 +++++++++++++\n include\/linux\/tty_driver.h      |  9 +++++++++\n include\/linux\/usb\/serial.h      |  2 ++\n 5 files changed, 61 insertions(+), 19 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/char\/tty_io.c b\/drivers\/char\/tty_io.c\nindex e185db36f8ad..c05c5af5aa04 100644\n--- a\/drivers\/char\/tty_io.c\n+++ b\/drivers\/char\/tty_io.c\n@@ -96,6 +96,7 @@\n #include <linux\/bitops.h>\n #include <linux\/delay.h>\n #include <linux\/seq_file.h>\n+#include <linux\/serial.h>\n \n #include <linux\/uaccess.h>\n #include <asm\/system.h>\n@@ -2511,6 +2512,20 @@ static int tty_tiocmset(struct tty_struct *tty, struct file *file, unsigned int\n \treturn tty->ops->tiocmset(tty, file, set, clear);\n }\n \n+static int tty_tiocgicount(struct tty_struct *tty, void __user *arg)\n+{\n+\tint retval = -EINVAL;\n+\tstruct serial_icounter_struct icount;\n+\tmemset(&icount, 0, sizeof(icount));\n+\tif (tty->ops->get_icount)\n+\t\tretval = tty->ops->get_icount(tty, &icount);\n+\tif (retval != 0)\n+\t\treturn retval;\n+\tif (copy_to_user(arg, &icount, sizeof(icount)))\n+\t\treturn -EFAULT;\n+\treturn 0;\n+}\n+\n struct tty_struct *tty_pair_get_tty(struct tty_struct *tty)\n {\n \tif (tty->driver->type == TTY_DRIVER_TYPE_PTY &&\n@@ -2631,6 +2646,12 @@ long tty_ioctl(struct file *file, unsigned int cmd, unsigned long arg)\n \tcase TIOCMBIC:\n \tcase TIOCMBIS:\n \t\treturn tty_tiocmset(tty, file, cmd, p);\n+\tcase TIOCGICOUNT:\n+\t\tretval = tty_tiocgicount(tty, p);\n+\t\t\/* For the moment allow fall through to the old method *\/\n+        \tif (retval != -EINVAL)\n+\t\t\treturn retval;\n+\t\tbreak;\n \tcase TCFLSH:\n \t\tswitch (arg) {\n \t\tcase TCIFLUSH:\ndiff --git a\/drivers\/serial\/serial_core.c b\/drivers\/serial\/serial_core.c\nindex bc6cddd10294..c4ea14670d44 100644\n--- a\/drivers\/serial\/serial_core.c\n+++ b\/drivers\/serial\/serial_core.c\n@@ -1074,10 +1074,10 @@ uart_wait_modem_status(struct uart_state *state, unsigned long arg)\n  * NB: both 1->0 and 0->1 transitions are counted except for\n  *     RI where only 0->1 is counted.\n  *\/\n-static int uart_get_count(struct uart_state *state,\n-\t\t\t  struct serial_icounter_struct __user *icnt)\n+static int uart_get_icount(struct tty_struct *tty,\n+\t\t\t  struct serial_icounter_struct *icount)\n {\n-\tstruct serial_icounter_struct icount;\n+\tstruct uart_state *state = tty->driver_data;\n \tstruct uart_icount cnow;\n \tstruct uart_port *uport = state->uart_port;\n \n@@ -1085,19 +1085,19 @@ static int uart_get_count(struct uart_state *state,\n \tmemcpy(&cnow, &uport->icount, sizeof(struct uart_icount));\n \tspin_unlock_irq(&uport->lock);\n \n-\ticount.cts         = cnow.cts;\n-\ticount.dsr         = cnow.dsr;\n-\ticount.rng         = cnow.rng;\n-\ticount.dcd         = cnow.dcd;\n-\ticount.rx          = cnow.rx;\n-\ticount.tx          = cnow.tx;\n-\ticount.frame       = cnow.frame;\n-\ticount.overrun     = cnow.overrun;\n-\ticount.parity      = cnow.parity;\n-\ticount.brk         = cnow.brk;\n-\ticount.buf_overrun = cnow.buf_overrun;\n+\ticount->cts         = cnow.cts;\n+\ticount->dsr         = cnow.dsr;\n+\ticount->rng         = cnow.rng;\n+\ticount->dcd         = cnow.dcd;\n+\ticount->rx          = cnow.rx;\n+\ticount->tx          = cnow.tx;\n+\ticount->frame       = cnow.frame;\n+\ticount->overrun     = cnow.overrun;\n+\ticount->parity      = cnow.parity;\n+\ticount->brk         = cnow.brk;\n+\ticount->buf_overrun = cnow.buf_overrun;\n \n-\treturn copy_to_user(icnt, &icount, sizeof(icount)) ? -EFAULT : 0;\n+\treturn 0;\n }\n \n \/*\n@@ -1150,10 +1150,6 @@ uart_ioctl(struct tty_struct *tty, struct file *filp, unsigned int cmd,\n \tcase TIOCMIWAIT:\n \t\tret = uart_wait_modem_status(state, arg);\n \t\tbreak;\n-\n-\tcase TIOCGICOUNT:\n-\t\tret = uart_get_count(state, uarg);\n-\t\tbreak;\n \t}\n \n \tif (ret != -ENOIOCTLCMD)\n@@ -2295,6 +2291,7 @@ static const struct tty_operations uart_ops = {\n #endif\n \t.tiocmget\t= uart_tiocmget,\n \t.tiocmset\t= uart_tiocmset,\n+\t.get_icount\t= uart_get_icount,\n #ifdef CONFIG_CONSOLE_POLL\n \t.poll_init\t= uart_poll_init,\n \t.poll_get_char\t= uart_poll_get_char,\ndiff --git a\/drivers\/usb\/serial\/usb-serial.c b\/drivers\/usb\/serial\/usb-serial.c\nindex 7a2177c79bde..e64da74bdcc5 100644\n--- a\/drivers\/usb\/serial\/usb-serial.c\n+++ b\/drivers\/usb\/serial\/usb-serial.c\n@@ -519,6 +519,18 @@ static int serial_tiocmset(struct tty_struct *tty, struct file *file,\n \treturn -EINVAL;\n }\n \n+static int serial_get_icount(struct tty_struct *tty,\n+\t\t\t\tstruct serial_icounter_struct *icount)\n+{\n+\tstruct usb_serial_port *port = tty->driver_data;\n+\n+\tdbg(\"%s - port %d\", __func__, port->number);\n+\n+\tif (port->serial->type->get_icount)\n+\t\treturn port->serial->type->get_icount(tty, icount);\n+\treturn -EINVAL;\n+}\n+\n \/*\n  * We would be calling tty_wakeup here, but unfortunately some line\n  * disciplines have an annoying habit of calling tty->write from\n@@ -1195,6 +1207,7 @@ static const struct tty_operations serial_ops = {\n \t.chars_in_buffer =\tserial_chars_in_buffer,\n \t.tiocmget =\t\tserial_tiocmget,\n \t.tiocmset =\t\tserial_tiocmset,\n+\t.get_icount = \t\tserial_get_icount,\n \t.cleanup = \t\tserial_cleanup,\n \t.install = \t\tserial_install,\n \t.proc_fops =\t\t&serial_proc_fops,\ndiff --git a\/include\/linux\/tty_driver.h b\/include\/linux\/tty_driver.h\nindex b08677982525..db2d227694da 100644\n--- a\/include\/linux\/tty_driver.h\n+++ b\/include\/linux\/tty_driver.h\n@@ -224,6 +224,12 @@\n  *\tunless the tty also has a valid tty->termiox pointer.\n  *\n  *\tOptional: Called under the termios lock\n+ *\n+ * int (*get_icount)(struct tty_struct *tty, struct serial_icounter *icount);\n+ *\n+ *\tCalled when the device receives a TIOCGICOUNT ioctl. Passed a kernel\n+ *\tstructure to complete. This method is optional and will only be called\n+ *\tif provided (otherwise EINVAL will be returned).\n  *\/\n \n #include <linux\/fs.h>\n@@ -232,6 +238,7 @@\n \n struct tty_struct;\n struct tty_driver;\n+struct serial_icounter_struct;\n \n struct tty_operations {\n \tstruct tty_struct * (*lookup)(struct tty_driver *driver,\n@@ -268,6 +275,8 @@ struct tty_operations {\n \t\t\tunsigned int set, unsigned int clear);\n \tint (*resize)(struct tty_struct *tty, struct winsize *ws);\n \tint (*set_termiox)(struct tty_struct *tty, struct termiox *tnew);\n+\tint (*get_icount)(struct tty_struct *tty,\n+\t\t\t\tstruct serial_icounter_struct *icount);\n #ifdef CONFIG_CONSOLE_POLL\n \tint (*poll_init)(struct tty_driver *driver, int line, char *options);\n \tint (*poll_get_char)(struct tty_driver *driver, int line);\ndiff --git a\/include\/linux\/usb\/serial.h b\/include\/linux\/usb\/serial.h\nindex 55675b1efb28..16d682f4f7c3 100644\n--- a\/include\/linux\/usb\/serial.h\n+++ b\/include\/linux\/usb\/serial.h\n@@ -271,6 +271,8 @@ struct usb_serial_driver {\n \tint  (*tiocmget)(struct tty_struct *tty, struct file *file);\n \tint  (*tiocmset)(struct tty_struct *tty, struct file *file,\n \t\t\t unsigned int set, unsigned int clear);\n+\tint  (*get_icount)(struct tty_struct *tty,\n+\t\t\tstruct serial_icounter_struct *icount);\n \t\/* Called by the tty layer for port level work. There may or may not\n \t   be an attached tty at this point *\/\n \tvoid (*dtr_rts)(struct usb_serial_port *port, int on);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-0196","CWE_ID":"200","category":"security","commit_id":"065b7978c40ded35c356ced6cd922a40156c9c46","commit_message":"From 065b7978c40ded35c356ced6cd922a40156c9c46 Mon Sep 17 00:00:00 2001\nFrom: Akrosh Gandhi <akroshg@microsoft.com>\nDate: Thu, 19 Jan 2017 14:17:27 -0800\nSubject: [PATCH] [CVE-2017-0196] Fixing an heap overread during slice.\n\nThe MissingItem check is happening on the array in a loop. It is possible that we get called into script and that mutates the array. So the Array's head is newly created with length.\nHowever the loop is still performing over the old length.\nFixed this by checking the length In IsMissingItem function.\nAdded a unittest.\n---\n lib\/Runtime\/Library\/JavascriptArray.cpp |  7 ++++++-\n test\/Array\/Array_TypeConfusion_bugs.js  | 27 +++++++++++++++++++++++++\n 2 files changed, 33 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/lib\/Runtime\/Library\/JavascriptArray.cpp b\/lib\/Runtime\/Library\/JavascriptArray.cpp\nindex fc6d90b36a5..c344bf8b6f7 100644\n--- a\/lib\/Runtime\/Library\/JavascriptArray.cpp\n+++ b\/lib\/Runtime\/Library\/JavascriptArray.cpp\n@@ -477,6 +477,11 @@ namespace Js\n \n     bool JavascriptArray::IsMissingItem(uint32 index)\n     {\n+        if (this->length <= index)\n+        {\n+            return false;\n+        }\n+\n         bool isIntArray = false, isFloatArray = false;\n         this->GetArrayTypeAndConvert(&isIntArray, &isFloatArray);\n \n@@ -5767,7 +5772,7 @@ namespace Js\n         \/\/ Prototype lookup for missing elements\n         if (!pArr->HasNoMissingValues())\n         {\n-            for (uint32 i = 0; i < newLen; i++)\n+            for (uint32 i = 0; i < newLen && (i + start) < pArr->length; i++)\n             {\n                 \/\/ array type might be changed in the below call to DirectGetItemAtFull\n                 \/\/ need recheck array type before checking array item [i + start]\ndiff --git a\/test\/Array\/Array_TypeConfusion_bugs.js b\/test\/Array\/Array_TypeConfusion_bugs.js\nindex e1867424929..43430fbc33a 100644\n--- a\/test\/Array\/Array_TypeConfusion_bugs.js\n+++ b\/test\/Array\/Array_TypeConfusion_bugs.js\n@@ -593,5 +593,32 @@ var tests = [\n             assert.areEqual(101, arr.length);\n         }\n     },\n+    {\n+        name: \"Heap overread when splice mutates the array when executing slice\",\n+        body: function ()\n+        {\n+            var getterCalled = false;\n+            var a = [1, 2];\n+            for (var i = 0; i < 100 * 1024; i++) {\n+                a.push(i);\n+            }\n+            delete a[0]; \/\/ Make a missing item\n+            var protoObj = [11];\n+            Object.defineProperty(protoObj, '0', {\n+                get : function () {\n+                    getterCalled = true;\n+                    Object.setPrototypeOf(a, Array.prototype);\n+                    a.splice(0); \/\/ head seg is now length=0\n+                    return 42;\n+                },\n+                configurable : true\n+            });\n+            Object.setPrototypeOf(a, protoObj);\n+            var b = a.slice();\n+            assert.isTrue(getterCalled);\n+            assert.areEqual(0, a.length, \"Getter will splice the array to zero length\");\n+            assert.areEqual(100 * 1024 + 2, b.length, \"Validating that slice will return the full array even though splice is deleting the whole array\");\n+        }\n+    },\n ];\n testRunner.runTests(tests, { verbose: WScript.Arguments[0] != \"summary\" });\n","owner":"Microsoft","repo":"ChakraCore","source":"cve"},{"CVE_ID":"CVE-2016-2117","CWE_ID":"200","category":"security","commit_id":"f43bfaeddc79effbf3d0fcb53ca477cca66f3db8","commit_message":"From f43bfaeddc79effbf3d0fcb53ca477cca66f3db8 Mon Sep 17 00:00:00 2001\nFrom: Ben Hutchings <ben@decadent.org.uk>\nDate: Wed, 20 Apr 2016 23:23:08 +0100\nSubject: [PATCH] atl2: Disable unimplemented scatter\/gather feature\n\natl2 includes NETIF_F_SG in hw_features even though it has no support\nfor non-linear skbs.  This bug was originally harmless since the\ndriver does not claim to implement checksum offload and that used to\nbe a requirement for SG.\n\nNow that SG and checksum offload are independent features, if you\nexplicitly enable SG *and* use one of the rare protocols that can use\nSG without checkusm offload, this potentially leaks sensitive\ninformation (before you notice that it just isn't working).  Therefore\nthis obscure bug has been designated CVE-2016-2117.\n\nReported-by: Justin Yackoski <jyackoski@crypto-nite.com>\nSigned-off-by: Ben Hutchings <ben@decadent.org.uk>\nFixes: ec5f06156423 (\"net: Kill link between CSUM and SG features.\")\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n drivers\/net\/ethernet\/atheros\/atlx\/atl2.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/drivers\/net\/ethernet\/atheros\/atlx\/atl2.c b\/drivers\/net\/ethernet\/atheros\/atlx\/atl2.c\nindex 8f76f4558a88c..2ff465848b655 100644\n--- a\/drivers\/net\/ethernet\/atheros\/atlx\/atl2.c\n+++ b\/drivers\/net\/ethernet\/atheros\/atlx\/atl2.c\n@@ -1412,7 +1412,7 @@ static int atl2_probe(struct pci_dev *pdev, const struct pci_device_id *ent)\n \n \terr = -EIO;\n \n-\tnetdev->hw_features = NETIF_F_SG | NETIF_F_HW_VLAN_CTAG_RX;\n+\tnetdev->hw_features = NETIF_F_HW_VLAN_CTAG_RX;\n \tnetdev->features |= (NETIF_F_HW_VLAN_CTAG_TX | NETIF_F_HW_VLAN_CTAG_RX);\n \n \t\/* Init PHY as early as possible due to power saving issue  *\/\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-5330","CWE_ID":"200","category":"security","commit_id":"538d305de91e34a2938f5f219f18bf0e1918763f","commit_message":"From 538d305de91e34a2938f5f219f18bf0e1918763f Mon Sep 17 00:00:00 2001\nFrom: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>\nDate: Tue, 24 Nov 2015 13:54:09 +1300\nSubject: [PATCH] CVE-2015-5330: next_codepoint_handle_ext: don't short-circuit\n UTF16 low bytes\n\nUTF16 contains zero bytes when it is encoding ASCII (for example), so we\ncan't assume the absense of the 0x80 bit means a one byte encoding. No\ncurrent callers use UTF16.\n\nBug: https:\/\/bugzilla.samba.org\/show_bug.cgi?id=11599\n\nSigned-off-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>\nPair-programmed-with: Andrew Bartlett <abartlet@samba.org>\nReviewed-by: Ralph Boehme <slow@samba.org>\n---\n lib\/util\/charset\/codepoints.c | 5 ++++-\n 1 file changed, 4 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/lib\/util\/charset\/codepoints.c b\/lib\/util\/charset\/codepoints.c\nindex 99d209ff1c3..3d444a6df31 100644\n--- a\/lib\/util\/charset\/codepoints.c\n+++ b\/lib\/util\/charset\/codepoints.c\n@@ -16669,7 +16669,10 @@ _PUBLIC_ codepoint_t next_codepoint_handle_ext(\n \tsize_t olen;\n \tchar *outbuf;\n \n-\tif ((str[0] & 0x80) == 0) {\n+\n+\tif (((str[0] & 0x80) == 0) && (src_charset == CH_DOS ||\n+\t\t\t\t       src_charset == CH_UNIX ||\n+\t\t\t\t       src_charset == CH_UTF8)) {\n \t\t*bytes_consumed = 1;\n \t\treturn (codepoint_t)str[0];\n \t}\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2013-3233","CWE_ID":"200","category":"security","commit_id":"d26d6504f23e803824e8ebd14e52d4fc0a0b09cb","commit_message":"From d26d6504f23e803824e8ebd14e52d4fc0a0b09cb Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:58 +0000\nSubject: [PATCH] NFC: llcp: fix info leaks via msg_name in llcp_sock_recvmsg()\n\nThe code in llcp_sock_recvmsg() does not initialize all the members of\nstruct sockaddr_nfc_llcp when filling the sockaddr info. Nor does it\ninitialize the padding bytes of the structure inserted by the compiler\nfor alignment.\n\nAlso, if the socket is in state LLCP_CLOSED or is shutting down during\nreceive the msg_namelen member is not updated to 0 while otherwise\nreturning with 0, i.e. \"success\". The msg_namelen update is also\nmissing for stream and seqpacket sockets which don't fill the sockaddr\ninfo.\n\nBoth issues lead to the fact that the code will leak uninitialized\nkernel stack bytes in net\/socket.c.\n\nFix the first issue by initializing the memory used for sockaddr info\nwith memset(0). Fix the second one by setting msg_namelen to 0 early.\nIt will be updated later if we're going to fill the msg_name member.\n\nCc: Lauro Ramos Venancio <lauro.venancio@openbossa.org>\nCc: Aloisio Almeida Jr <aloisio.almeida@openbossa.org>\nCc: Samuel Ortiz <sameo@linux.intel.com>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/nfc\/llcp\/sock.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/net\/nfc\/llcp\/sock.c b\/net\/nfc\/llcp\/sock.c\nindex 8f025746f3370..6c94447ec414c 100644\n--- a\/net\/nfc\/llcp\/sock.c\n+++ b\/net\/nfc\/llcp\/sock.c\n@@ -646,6 +646,8 @@ static int llcp_sock_recvmsg(struct kiocb *iocb, struct socket *sock,\n \n \tpr_debug(\"%p %zu\\n\", sk, len);\n \n+\tmsg->msg_namelen = 0;\n+\n \tlock_sock(sk);\n \n \tif (sk->sk_state == LLCP_CLOSED &&\n@@ -691,6 +693,7 @@ static int llcp_sock_recvmsg(struct kiocb *iocb, struct socket *sock,\n \n \t\tpr_debug(\"Datagram socket %d %d\\n\", ui_cb->dsap, ui_cb->ssap);\n \n+\t\tmemset(sockaddr, 0, sizeof(*sockaddr));\n \t\tsockaddr->sa_family = AF_NFC;\n \t\tsockaddr->nfc_protocol = NFC_PROTO_NFC_DEP;\n \t\tsockaddr->dsap = ui_cb->dsap;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-0349","CWE_ID":"200","category":"security","commit_id":"0a9ab9bdb3e891762553f667066190c1d22ad62b","commit_message":"From 0a9ab9bdb3e891762553f667066190c1d22ad62b Mon Sep 17 00:00:00 2001\nFrom: Anderson Lizardo <anderson.lizardo@openbossa.org>\nDate: Sun, 6 Jan 2013 18:28:53 -0400\nSubject: Bluetooth: Fix incorrect strncpy() in hidp_setup_hid()\n\nThe length parameter should be sizeof(req->name) - 1 because there is no\nguarantee that string provided by userspace will contain the trailing\n'\\0'.\n\nCan be easily reproduced by manually setting req->name to 128 non-zero\nbytes prior to ioctl(HIDPCONNADD) and checking the device name setup on\ninput subsystem:\n\n$ cat \/sys\/devices\/pnp0\/00\\:04\/tty\/ttyS0\/hci0\/hci0\\:1\/input8\/name\nAAAAAA[...]AAAAAAAAf0:af:f0:af:f0:af\n\n(\"f0:af:f0:af:f0:af\" is the device bluetooth address, taken from \"phys\"\nfield in struct hid_device due to overflow.)\n\nCc: stable@vger.kernel.org\nSigned-off-by: Anderson Lizardo <anderson.lizardo@openbossa.org>\nAcked-by: Marcel Holtmann <marcel@holtmann.org>\nSigned-off-by: Gustavo Padovan <gustavo.padovan@collabora.co.uk>\n---\n net\/bluetooth\/hidp\/core.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/bluetooth\/hidp\/core.c b\/net\/bluetooth\/hidp\/core.c\nindex b2bcbe2dc328..a7352ff3fd1e 100644\n--- a\/net\/bluetooth\/hidp\/core.c\n+++ b\/net\/bluetooth\/hidp\/core.c\n@@ -931,7 +931,7 @@ static int hidp_setup_hid(struct hidp_session *session,\n \thid->version = req->version;\n \thid->country = req->country;\n \n-\tstrncpy(hid->name, req->name, 128);\n+\tstrncpy(hid->name, req->name, sizeof(req->name) - 1);\n \n \tsnprintf(hid->phys, sizeof(hid->phys), \"%pMR\",\n \t\t &bt_sk(session->ctrl_sock->sk)->src);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2013-3076","CWE_ID":"200","category":"security","commit_id":"72a763d805a48ac8c0bf48fdb510e84c12de51fe","commit_message":"From 72a763d805a48ac8c0bf48fdb510e84c12de51fe Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 14:05:39 +0200\nSubject: [PATCH] crypto: algif - suppress sending source address information\n in recvmsg\n\nThe current code does not set the msg_namelen member to 0 and therefore\nmakes net\/socket.c leak the local sockaddr_storage variable to userland\n-- 128 bytes of kernel stack memory. Fix that.\n\nCc: <stable@vger.kernel.org> # 2.6.38\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>\n---\n crypto\/algif_hash.c     | 2 ++\n crypto\/algif_skcipher.c | 1 +\n 2 files changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/crypto\/algif_hash.c b\/crypto\/algif_hash.c\nindex ef5356cd280a5..0262210cad386 100644\n--- a\/crypto\/algif_hash.c\n+++ b\/crypto\/algif_hash.c\n@@ -161,6 +161,8 @@ static int hash_recvmsg(struct kiocb *unused, struct socket *sock,\n \telse if (len < ds)\n \t\tmsg->msg_flags |= MSG_TRUNC;\n \n+\tmsg->msg_namelen = 0;\n+\n \tlock_sock(sk);\n \tif (ctx->more) {\n \t\tctx->more = 0;\ndiff --git a\/crypto\/algif_skcipher.c b\/crypto\/algif_skcipher.c\nindex 6a6dfc062d2a4..a1c4f0a555832 100644\n--- a\/crypto\/algif_skcipher.c\n+++ b\/crypto\/algif_skcipher.c\n@@ -432,6 +432,7 @@ static int skcipher_recvmsg(struct kiocb *unused, struct socket *sock,\n \tlong copied = 0;\n \n \tlock_sock(sk);\n+\tmsg->msg_namelen = 0;\n \tfor (iov = msg->msg_iov, iovlen = msg->msg_iovlen; iovlen > 0;\n \t     iovlen--, iov++) {\n \t\tunsigned long seglen = iov->iov_len;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-0701","CWE_ID":"200","category":"security","commit_id":"c5b831f21d0d29d1e517d139d9d101763f60c9a2","commit_message":"From c5b831f21d0d29d1e517d139d9d101763f60c9a2 Mon Sep 17 00:00:00 2001\nFrom: Matt Caswell <matt@openssl.org>\nDate: Thu, 17 Dec 2015 02:57:20 +0000\nSubject: [PATCH] Always generate DH keys for ephemeral DH cipher suites\n\nModified version of the commit ffaef3f15 in the master branch by Stephen\nHenson. This makes the SSL_OP_SINGLE_DH_USE option a no-op and always\ngenerates a new DH key for every handshake regardless.\n\nCVE-2016-0701 (fix part 2 or 2)\n\nIssue reported by Antonio Sanso\n\nReviewed-by: Viktor Dukhovni <viktor@openssl.org>\n---\n doc\/ssl\/SSL_CTX_set_tmp_dh_callback.pod | 29 +++++--------------------\n ssl\/s3_lib.c                            | 14 ------------\n ssl\/s3_srvr.c                           | 17 +++------------\n ssl\/ssl.h                               |  2 +-\n 4 files changed, 9 insertions(+), 53 deletions(-)\n\n","diff_code":"diff --git a\/doc\/ssl\/SSL_CTX_set_tmp_dh_callback.pod b\/doc\/ssl\/SSL_CTX_set_tmp_dh_callback.pod\nindex b754c16a86..234fbc8450 100644\n--- a\/doc\/ssl\/SSL_CTX_set_tmp_dh_callback.pod\n+++ b\/doc\/ssl\/SSL_CTX_set_tmp_dh_callback.pod\n@@ -48,25 +48,8 @@ even if he gets hold of the normal (certified) key, as this key was\n only used for signing.\n \n In order to perform a DH key exchange the server must use a DH group\n-(DH parameters) and generate a DH key.\n-The server will always generate a new DH key during the negotiation\n-if either the DH parameters are supplied via callback or the\n-SSL_OP_SINGLE_DH_USE option of SSL_CTX_set_options(3) is set (or both).\n-It will  immediately create a DH key if DH parameters are supplied via\n-SSL_CTX_set_tmp_dh() and SSL_OP_SINGLE_DH_USE is not set.\n-In this case,\n-it may happen that a key is generated on initialization without later\n-being needed, while on the other hand the computer time during the\n-negotiation is being saved.\n-\n-If \"strong\" primes were used to generate the DH parameters, it is not strictly\n-necessary to generate a new key for each handshake but it does improve forward\n-secrecy. If it is not assured that \"strong\" primes were used,\n-SSL_OP_SINGLE_DH_USE must be used in order to prevent small subgroup\n-attacks. Always using SSL_OP_SINGLE_DH_USE has an impact on the\n-computer time needed during negotiation, but it is not very large, so\n-application authors\/users should consider always enabling this option.\n-The option is required to implement perfect forward secrecy (PFS).\n+(DH parameters) and generate a DH key. The server will always generate\n+a new DH key during the negotiation.\n \n As generating DH parameters is extremely time consuming, an application\n should not generate the parameters on the fly but supply the parameters.\n@@ -93,10 +76,9 @@ can supply the DH parameters via a callback function.\n Previous versions of the callback used B<is_export> and B<keylength>\n parameters to control parameter generation for export and non-export\n cipher suites. Modern servers that do not support export ciphersuites\n-are advised to either use SSL_CTX_set_tmp_dh() in combination with\n-SSL_OP_SINGLE_DH_USE, or alternatively, use the callback but ignore\n-B<keylength> and B<is_export> and simply supply at least 2048-bit\n-parameters in the callback.\n+are advised to either use SSL_CTX_set_tmp_dh() or alternatively, use\n+the callback but ignore B<keylength> and B<is_export> and simply\n+supply at least 2048-bit parameters in the callback.\n \n =head1 EXAMPLES\n \n@@ -128,7 +110,6 @@ partly left out.)\n  if (SSL_CTX_set_tmp_dh(ctx, dh_2048) != 1) {\n    \/* Error. *\/\n  }\n- SSL_CTX_set_options(ctx, SSL_OP_SINGLE_DH_USE);\n  ...\n \n =head1 RETURN VALUES\ndiff --git a\/ssl\/s3_lib.c b\/ssl\/s3_lib.c\nindex b7c5db3aa5..f846cb5b7b 100644\n--- a\/ssl\/s3_lib.c\n+++ b\/ssl\/s3_lib.c\n@@ -3206,13 +3206,6 @@ long ssl3_ctrl(SSL *s, int cmd, long larg, void *parg)\n                 SSLerr(SSL_F_SSL3_CTRL, ERR_R_DH_LIB);\n                 return (ret);\n             }\n-            if (!(s->options & SSL_OP_SINGLE_DH_USE)) {\n-                if (!DH_generate_key(dh)) {\n-                    DH_free(dh);\n-                    SSLerr(SSL_F_SSL3_CTRL, ERR_R_DH_LIB);\n-                    return (ret);\n-                }\n-            }\n             if (s->cert->dh_tmp != NULL)\n                 DH_free(s->cert->dh_tmp);\n             s->cert->dh_tmp = dh;\n@@ -3713,13 +3706,6 @@ long ssl3_ctx_ctrl(SSL_CTX *ctx, int cmd, long larg, void *parg)\n                 SSLerr(SSL_F_SSL3_CTX_CTRL, ERR_R_DH_LIB);\n                 return 0;\n             }\n-            if (!(ctx->options & SSL_OP_SINGLE_DH_USE)) {\n-                if (!DH_generate_key(new)) {\n-                    SSLerr(SSL_F_SSL3_CTX_CTRL, ERR_R_DH_LIB);\n-                    DH_free(new);\n-                    return 0;\n-                }\n-            }\n             if (cert->dh_tmp != NULL)\n                 DH_free(cert->dh_tmp);\n             cert->dh_tmp = new;\ndiff --git a\/ssl\/s3_srvr.c b\/ssl\/s3_srvr.c\nindex 9b05f189d5..ab28702ee9 100644\n--- a\/ssl\/s3_srvr.c\n+++ b\/ssl\/s3_srvr.c\n@@ -1687,20 +1687,9 @@ int ssl3_send_server_key_exchange(SSL *s)\n             }\n \n             s->s3->tmp.dh = dh;\n-            if ((dhp->pub_key == NULL ||\n-                 dhp->priv_key == NULL ||\n-                 (s->options & SSL_OP_SINGLE_DH_USE))) {\n-                if (!DH_generate_key(dh)) {\n-                    SSLerr(SSL_F_SSL3_SEND_SERVER_KEY_EXCHANGE, ERR_R_DH_LIB);\n-                    goto err;\n-                }\n-            } else {\n-                dh->pub_key = BN_dup(dhp->pub_key);\n-                dh->priv_key = BN_dup(dhp->priv_key);\n-                if ((dh->pub_key == NULL) || (dh->priv_key == NULL)) {\n-                    SSLerr(SSL_F_SSL3_SEND_SERVER_KEY_EXCHANGE, ERR_R_DH_LIB);\n-                    goto err;\n-                }\n+            if (!DH_generate_key(dh)) {\n+                SSLerr(SSL_F_SSL3_SEND_SERVER_KEY_EXCHANGE, ERR_R_DH_LIB);\n+                goto err;\n             }\n             r[0] = dh->p;\n             r[1] = dh->g;\ndiff --git a\/ssl\/ssl.h b\/ssl\/ssl.h\nindex a31c085711..ae8c92575e 100644\n--- a\/ssl\/ssl.h\n+++ b\/ssl\/ssl.h\n@@ -625,7 +625,7 @@ struct ssl_session_st {\n # define SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION        0x00040000L\n \/* If set, always create a new key when using tmp_ecdh parameters *\/\n # define SSL_OP_SINGLE_ECDH_USE                          0x00080000L\n-\/* If set, always create a new key when using tmp_dh parameters *\/\n+\/* Does nothing: retained for compatibility *\/\n # define SSL_OP_SINGLE_DH_USE                            0x00100000L\n \/* Does nothing: retained for compatibiity *\/\n # define SSL_OP_EPHEMERAL_RSA                            0x0\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2012-6539","CWE_ID":"200","category":"security","commit_id":"43da5f2e0d0c69ded3d51907d9552310a6b545e8","commit_message":"From 43da5f2e0d0c69ded3d51907d9552310a6b545e8 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:57 +0000\nSubject: [PATCH] net: fix info leak in compat dev_ifconf()\n\nThe implementation of dev_ifconf() for the compat ioctl interface uses\nan intermediate ifc structure allocated in userland for the duration of\nthe syscall. Though, it fails to initialize the padding bytes inserted\nfor alignment and that for leaks four bytes of kernel stack. Add an\nexplicit memset(0) before filling the structure to avoid the info leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/socket.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/socket.c b\/net\/socket.c\nindex dfe5b66c97e0b..a5471f804d994 100644\n--- a\/net\/socket.c\n+++ b\/net\/socket.c\n@@ -2657,6 +2657,7 @@ static int dev_ifconf(struct net *net, struct compat_ifconf __user *uifc32)\n \tif (copy_from_user(&ifc32, uifc32, sizeof(struct compat_ifconf)))\n \t\treturn -EFAULT;\n \n+\tmemset(&ifc, 0, sizeof(ifc));\n \tif (ifc32.ifcbuf == 0) {\n \t\tifc32.ifc_len = 0;\n \t\tifc.ifc_len = 0;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2009-3002","CWE_ID":"200","category":"security","commit_id":"3d392475c873c10c10d6d96b94d092a34ebd4791","commit_message":"From 3d392475c873c10c10d6d96b94d092a34ebd4791 Mon Sep 17 00:00:00 2001\nFrom: Eric Dumazet <eric.dumazet@gmail.com>\nDate: Thu, 6 Aug 2009 02:27:43 +0000\nSubject: appletalk: fix atalk_getname() leak\n\natalk_getname() can leak 8 bytes of kernel memory to user\n\nSigned-off-by: Eric Dumazet <eric.dumazet@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/appletalk\/ddp.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/appletalk\/ddp.c b\/net\/appletalk\/ddp.c\nindex 590b83963622..9ef6ff26eb0c 100644\n--- a\/net\/appletalk\/ddp.c\n+++ b\/net\/appletalk\/ddp.c\n@@ -1237,6 +1237,7 @@ static int atalk_getname(struct socket *sock, struct sockaddr *uaddr,\n \t\t\treturn -ENOBUFS;\n \n \t*uaddr_len = sizeof(struct sockaddr_at);\n+\tmemset(&sat.sat_zero, 0, sizeof(sat.sat_zero));\n \n \tif (peer) {\n \t\tif (sk->sk_state != TCP_ESTABLISHED)\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2016-7977","CWE_ID":"200","category":"security","commit_id":"8abd22010eb4db0fb1b10e430d5f5d83e015ef70","commit_message":"From 8abd22010eb4db0fb1b10e430d5f5d83e015ef70 Mon Sep 17 00:00:00 2001\nFrom: Chris Liddell <chris.liddell@artifex.com>\nDate: Mon, 3 Oct 2016 01:46:28 +0100\nSubject: [PATCH] Bug 697169: Be rigorous with SAFER permissions\n\nOnce we've opened our input file from the command line, enforce the SAFER\nrules.\n---\n psi\/zfile.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/psi\/zfile.c b\/psi\/zfile.c\nindex b6caea2..2c6c958 100644\n--- a\/psi\/zfile.c\n+++ b\/psi\/zfile.c\n@@ -1081,6 +1081,9 @@ lib_file_open(gs_file_path_ptr  lib_path, const gs_memory_t *mem, i_ctx_t *i_ctx\n     gs_main_instance *minst = get_minst_from_memory(mem);\n     int code;\n \n+    if (i_ctx_p && starting_arg_file)\n+        i_ctx_p->starting_arg_file = false;\n+\n     \/* when starting arg files (@ files) iodev_default is not yet set *\/\n     if (iodev == 0)\n         iodev = (gx_io_device *)gx_io_device_table[0];\n-- \n2.9.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-18836","CWE_ID":"200","category":"security","commit_id":"92327c9ec211bd1616315abcb255861b130b97ca","commit_message":"From 92327c9ec211bd1616315abcb255861b130b97ca Mon Sep 17 00:00:00 2001\nFrom: Costa Tsaousis <costa@tsaousis.gr>\nDate: Tue, 30 Oct 2018 02:35:57 +0200\nSubject: [PATCH] fixed vulnerabilities identified by red4sec.com (#4521)\n\n---\n libnetdata\/url\/url.c |  4 +++-\n web\/api\/web_api_v1.c | 17 +++++++++++++++++\n 2 files changed, 20 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/libnetdata\/url\/url.c b\/libnetdata\/url\/url.c\nindex 8a96063a03..07a9f8069e 100644\n--- a\/libnetdata\/url\/url.c\n+++ b\/libnetdata\/url\/url.c\n@@ -60,7 +60,9 @@ char *url_decode_r(char *to, char *url, size_t size) {\n     while(*s && d < e) {\n         if(unlikely(*s == '%')) {\n             if(likely(s[1] && s[2])) {\n-                *d++ = from_hex(s[1]) << 4 | from_hex(s[2]);\n+                char t = from_hex(s[1]) << 4 | from_hex(s[2]);\n+                \/\/ avoid HTTP header injection\n+                *d++ = (char)((isprint(t))? t : ' ');\n                 s += 2;\n             }\n         }\ndiff --git a\/web\/api\/web_api_v1.c b\/web\/api\/web_api_v1.c\nindex 0c0242c3ca..1e03828e40 100644\n--- a\/web\/api\/web_api_v1.c\n+++ b\/web\/api\/web_api_v1.c\n@@ -233,6 +233,15 @@ inline int web_client_api_request_v1_chart(RRDHOST *host, struct web_client *w,\n     return web_client_api_request_single_chart(host, w, url, rrd_stats_api_v1_chart);\n }\n \n+void fix_google_param(char *s) {\n+    if(unlikely(!s)) return;\n+\n+    for( ; *s ;s++) {\n+        if(!isalnum(*s) && *s != '.' && *s != '_' && *s != '-')\n+            *s = '_';\n+    }\n+}\n+\n \/\/ returns the HTTP code\n inline int web_client_api_request_v1_data(RRDHOST *host, struct web_client *w, char *url) {\n     debug(D_WEB_CLIENT, \"%llu: API v1 data with URL '%s'\", w->id, url);\n@@ -332,6 +341,14 @@ inline int web_client_api_request_v1_data(RRDHOST *host, struct web_client *w, c\n         }\n     }\n \n+    \/\/ validate the google parameters given\n+    fix_google_param(google_out);\n+    fix_google_param(google_sig);\n+    fix_google_param(google_reqId);\n+    fix_google_param(google_version);\n+    fix_google_param(responseHandler);\n+    fix_google_param(outFileName);\n+\n     if(!chart || !*chart) {\n         buffer_sprintf(w->response.data, \"No chart id is given at the request.\");\n         goto cleanup;\n","owner":"netdata","repo":"netdata","source":"cve"},{"CVE_ID":"CVE-2014-7284","CWE_ID":"200","category":"security","commit_id":"3d4405226d27b3a215e4d03cfa51f536244e5de7","commit_message":"From 3d4405226d27b3a215e4d03cfa51f536244e5de7 Mon Sep 17 00:00:00 2001\nFrom: Hannes Frederic Sowa <hannes@stressinduktion.org>\nDate: Sun, 11 May 2014 22:59:30 +0200\nSubject: net: avoid dependency of net_get_random_once on nop patching\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nnet_get_random_once depends on the static keys infrastructure to patch up\nthe branch to the slow path during boot. This was realized by abusing the\nstatic keys api and defining a new initializer to not enable the call\nsite while still indicating that the branch point should get patched\nup. This was needed to have the fast path considered likely by gcc.\n\nThe static key initialization during boot up normally walks through all\nthe registered keys and either patches in ideal nops or enables the jump\nsite but omitted that step on x86 if ideal nops where already placed at\nstatic_key branch points. Thus net_get_random_once branches not always\nbecame active.\n\nThis patch switches net_get_random_once to the ordinary static_key\napi and thus places the kernel fast path in the - by gcc considered -\nunlikely path.  Microbenchmarks on Intel and AMD x86-64 showed that\nthe unlikely path actually beats the likely path in terms of cycle cost\nand that different nop patterns did not make much difference, thus this\nswitch should not be noticeable.\n\nFixes: a48e42920ff38b (\"net: introduce new macro net_get_random_once\")\nReported-by: Tuomas R\u00e4s\u00e4nen <tuomasjjrasanen@tjjr.fi>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nSigned-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n include\/linux\/net.h | 15 ++++-----------\n net\/core\/utils.c    |  8 ++++----\n 2 files changed, 8 insertions(+), 15 deletions(-)\n\n","diff_code":"diff --git a\/include\/linux\/net.h b\/include\/linux\/net.h\nindex 94734a6259a4..17d83393afcc 100644\n--- a\/include\/linux\/net.h\n+++ b\/include\/linux\/net.h\n@@ -248,24 +248,17 @@ do {\t\t\t\t\t\t\t\t\\\n bool __net_get_random_once(void *buf, int nbytes, bool *done,\n \t\t\t   struct static_key *done_key);\n \n-#ifdef HAVE_JUMP_LABEL\n-#define ___NET_RANDOM_STATIC_KEY_INIT ((struct static_key) \\\n-\t\t{ .enabled = ATOMIC_INIT(0), .entries = (void *)1 })\n-#else \/* !HAVE_JUMP_LABEL *\/\n-#define ___NET_RANDOM_STATIC_KEY_INIT STATIC_KEY_INIT_FALSE\n-#endif \/* HAVE_JUMP_LABEL *\/\n-\n #define net_get_random_once(buf, nbytes)\t\t\t\t\\\n \t({\t\t\t\t\t\t\t\t\\\n \t\tbool ___ret = false;\t\t\t\t\t\\\n \t\tstatic bool ___done = false;\t\t\t\t\\\n-\t\tstatic struct static_key ___done_key =\t\t\t\\\n-\t\t\t___NET_RANDOM_STATIC_KEY_INIT;\t\t\t\\\n-\t\tif (!static_key_true(&___done_key))\t\t\t\\\n+\t\tstatic struct static_key ___once_key =\t\t\t\\\n+\t\t\tSTATIC_KEY_INIT_TRUE;\t\t\t\t\\\n+\t\tif (static_key_true(&___once_key))\t\t\t\\\n \t\t\t___ret = __net_get_random_once(buf,\t\t\\\n \t\t\t\t\t\t       nbytes,\t\t\\\n \t\t\t\t\t\t       &___done,\t\\\n-\t\t\t\t\t\t       &___done_key);\t\\\n+\t\t\t\t\t\t       &___once_key);\t\\\n \t\t___ret;\t\t\t\t\t\t\t\\\n \t})\n \ndiff --git a\/net\/core\/utils.c b\/net\/core\/utils.c\nindex 2f737bf90b3f..eed34338736c 100644\n--- a\/net\/core\/utils.c\n+++ b\/net\/core\/utils.c\n@@ -348,8 +348,8 @@ static void __net_random_once_deferred(struct work_struct *w)\n {\n \tstruct __net_random_once_work *work =\n \t\tcontainer_of(w, struct __net_random_once_work, work);\n-\tif (!static_key_enabled(work->key))\n-\t\tstatic_key_slow_inc(work->key);\n+\tBUG_ON(!static_key_enabled(work->key));\n+\tstatic_key_slow_dec(work->key);\n \tkfree(work);\n }\n \n@@ -367,7 +367,7 @@ static void __net_random_once_disable_jump(struct static_key *key)\n }\n \n bool __net_get_random_once(void *buf, int nbytes, bool *done,\n-\t\t\t   struct static_key *done_key)\n+\t\t\t   struct static_key *once_key)\n {\n \tstatic DEFINE_SPINLOCK(lock);\n \tunsigned long flags;\n@@ -382,7 +382,7 @@ bool __net_get_random_once(void *buf, int nbytes, bool *done,\n \t*done = true;\n \tspin_unlock_irqrestore(&lock, flags);\n \n-\t__net_random_once_disable_jump(done_key);\n+\t__net_random_once_disable_jump(once_key);\n \n \treturn true;\n }\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2009-2691","CWE_ID":"200","category":"security","commit_id":"704b836cbf19e885f8366bccb2e4b0474346c02d","commit_message":"From 704b836cbf19e885f8366bccb2e4b0474346c02d Mon Sep 17 00:00:00 2001\nFrom: Oleg Nesterov <oleg@redhat.com>\nDate: Fri, 10 Jul 2009 03:27:40 +0200\nSubject: mm_for_maps: take ->cred_guard_mutex to fix the race with exec\n\nThe problem is minor, but without ->cred_guard_mutex held we can race\nwith exec() and get the new ->mm but check old creds.\n\nNow we do not need to re-check task->mm after ptrace_may_access(), it\ncan't be changed to the new mm under us.\n\nStrictly speaking, this also fixes another very minor problem. Unless\nsecurity check fails or the task exits mm_for_maps() should never\nreturn NULL, the caller should get either old or new ->mm.\n\nSigned-off-by: Oleg Nesterov <oleg@redhat.com>\nAcked-by: Serge Hallyn <serue@us.ibm.com>\nSigned-off-by: James Morris <jmorris@namei.org>\n---\n fs\/proc\/base.c | 22 +++++++++++-----------\n 1 file changed, 11 insertions(+), 11 deletions(-)\n\n","diff_code":"diff --git a\/fs\/proc\/base.c b\/fs\/proc\/base.c\nindex f3c2e4085fed..175db258942f 100644\n--- a\/fs\/proc\/base.c\n+++ b\/fs\/proc\/base.c\n@@ -234,19 +234,19 @@ static int check_mem_permission(struct task_struct *task)\n \n struct mm_struct *mm_for_maps(struct task_struct *task)\n {\n-\tstruct mm_struct *mm = get_task_mm(task);\n+\tstruct mm_struct *mm;\n \n-\tif (mm && mm != current->mm) {\n-\t\t\/*\n-\t\t * task->mm can be changed before security check,\n-\t\t * in that case we must notice the change after.\n-\t\t *\/\n-\t\tif (!ptrace_may_access(task, PTRACE_MODE_READ) ||\n-\t\t    mm != task->mm) {\n-\t\t\tmmput(mm);\n-\t\t\tmm = NULL;\n-\t\t}\n+\tif (mutex_lock_killable(&task->cred_guard_mutex))\n+\t\treturn NULL;\n+\n+\tmm = get_task_mm(task);\n+\tif (mm && mm != current->mm &&\n+\t\t\t!ptrace_may_access(task, PTRACE_MODE_READ)) {\n+\t\tmmput(mm);\n+\t\tmm = NULL;\n \t}\n+\tmutex_unlock(&task->cred_guard_mutex);\n+\n \treturn mm;\n }\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2015-7884","CWE_ID":"200","category":"security","commit_id":"eda98796aff0d9bf41094b06811f5def3b4c333c","commit_message":"From eda98796aff0d9bf41094b06811f5def3b4c333c Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Salva=20Peir=C3=B3?= <speirofr@gmail.com>\nDate: Wed, 7 Oct 2015 07:09:26 -0300\nSubject: [media] media\/vivid-osd: fix info leak in ioctl\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nThe vivid_fb_ioctl() code fails to initialize the 16 _reserved bytes of\nstruct fb_vblank after the ->hcount member. Add an explicit\nmemset(0) before filling the structure to avoid the info leak.\n\nSigned-off-by: Salva Peir\u00f3 <speirofr@gmail.com>\nSigned-off-by: Hans Verkuil <hans.verkuil@cisco.com>\nSigned-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>\n---\n drivers\/media\/platform\/vivid\/vivid-osd.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/drivers\/media\/platform\/vivid\/vivid-osd.c b\/drivers\/media\/platform\/vivid\/vivid-osd.c\nindex 084d346fb4c4..e15eef6a94e5 100644\n--- a\/drivers\/media\/platform\/vivid\/vivid-osd.c\n+++ b\/drivers\/media\/platform\/vivid\/vivid-osd.c\n@@ -85,6 +85,7 @@ static int vivid_fb_ioctl(struct fb_info *info, unsigned cmd, unsigned long arg)\n \tcase FBIOGET_VBLANK: {\n \t\tstruct fb_vblank vblank;\n \n+\t\tmemset(&vblank, 0, sizeof(vblank));\n \t\tvblank.flags = FB_VBLANK_HAVE_COUNT | FB_VBLANK_HAVE_VCOUNT |\n \t\t\tFB_VBLANK_HAVE_VSYNC;\n \t\tvblank.count = 0;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-11472","CWE_ID":"200","category":"security","commit_id":"3b2d69114fefa474fca542e51119036dceb4aa6f","commit_message":"From 3b2d69114fefa474fca542e51119036dceb4aa6f Mon Sep 17 00:00:00 2001\nFrom: Seunghun Han <kkamagui@gmail.com>\nDate: Wed, 26 Apr 2017 16:18:08 +0800\nSubject: [PATCH] ACPICA: Namespace: fix operand cache leak\n\nACPICA commit a23325b2e583556eae88ed3f764e457786bf4df6\n\nI found some ACPI operand cache leaks in ACPI early abort cases.\n\nBoot log of ACPI operand cache leak is as follows:\n>[    0.174332] ACPI: Added _OSI(Module Device)\n>[    0.175504] ACPI: Added _OSI(Processor Device)\n>[    0.176010] ACPI: Added _OSI(3.0 _SCP Extensions)\n>[    0.177032] ACPI: Added _OSI(Processor Aggregator Device)\n>[    0.178284] ACPI: SCI (IRQ16705) allocation failed\n>[    0.179352] ACPI Exception: AE_NOT_ACQUIRED, Unable to install\nSystem Control Interrupt handler (20160930\/evevent-131)\n>[    0.180008] ACPI: Unable to start the ACPI Interpreter\n>[    0.181125] ACPI Error: Could not remove SCI handler\n(20160930\/evmisc-281)\n>[    0.184068] kmem_cache_destroy Acpi-Operand: Slab cache still has\nobjects\n>[    0.185358] CPU: 0 PID: 1 Comm: swapper\/0 Not tainted 4.10.0-rc3 #2\n>[    0.186820] Hardware name: innotek gmb_h virtual_box\/virtual_box, BIOS\nvirtual_box 12\/01\/2006\n>[    0.188000] Call Trace:\n>[    0.188000]  ? dump_stack+0x5c\/0x7d\n>[    0.188000]  ? kmem_cache_destroy+0x224\/0x230\n>[    0.188000]  ? acpi_sleep_proc_init+0x22\/0x22\n>[    0.188000]  ? acpi_os_delete_cache+0xa\/0xd\n>[    0.188000]  ? acpi_ut_delete_caches+0x3f\/0x7b\n>[    0.188000]  ? acpi_terminate+0x5\/0xf\n>[    0.188000]  ? acpi_init+0x288\/0x32e\n>[    0.188000]  ? __class_create+0x4c\/0x80\n>[    0.188000]  ? video_setup+0x7a\/0x7a\n>[    0.188000]  ? do_one_initcall+0x4e\/0x1b0\n>[    0.188000]  ? kernel_init_freeable+0x194\/0x21a\n>[    0.188000]  ? rest_init+0x80\/0x80\n>[    0.188000]  ? kernel_init+0xa\/0x100\n>[    0.188000]  ? ret_from_fork+0x25\/0x30\n\nWhen early abort is occurred due to invalid ACPI information, Linux kernel\nterminates ACPI by calling acpi_terminate() function. The function calls\nacpi_ns_terminate() function to delete namespace data and ACPI operand cache\n(acpi_gbl_module_code_list).\n\nBut the deletion code in acpi_ns_terminate() function is wrapped in\nACPI_EXEC_APP definition, therefore the code is only executed when the\ndefinition exists. If the define doesn't exist, ACPI operand cache\n(acpi_gbl_module_code_list) is leaked, and stack dump is shown in kernel log.\n\nThis causes a security threat because the old kernel (<= 4.9) shows memory\nlocations of kernel functions in stack dump, therefore kernel ASLR can be\nneutralized.\n\nTo fix ACPI operand leak for enhancing security, I made a patch which\nremoves the ACPI_EXEC_APP define in acpi_ns_terminate() function for\nexecuting the deletion code unconditionally.\n\nLink: https:\/\/github.com\/acpica\/acpica\/commit\/a23325b2\nSigned-off-by: Seunghun Han <kkamagui@gmail.com>\nSigned-off-by: Lv Zheng <lv.zheng@intel.com>\nSigned-off-by: Bob Moore <robert.moore@intel.com>\nSigned-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>\n---\n drivers\/acpi\/acpica\/nsutils.c | 23 +++++++++--------------\n 1 file changed, 9 insertions(+), 14 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/acpi\/acpica\/nsutils.c b\/drivers\/acpi\/acpica\/nsutils.c\nindex 661676714f7b82..b5a291488e3fc2 100644\n--- a\/drivers\/acpi\/acpica\/nsutils.c\n+++ b\/drivers\/acpi\/acpica\/nsutils.c\n@@ -594,25 +594,20 @@ struct acpi_namespace_node *acpi_ns_validate_handle(acpi_handle handle)\n void acpi_ns_terminate(void)\n {\n \tacpi_status status;\n+\tunion acpi_operand_object *prev;\n+\tunion acpi_operand_object *next;\n \n \tACPI_FUNCTION_TRACE(ns_terminate);\n \n-#ifdef ACPI_EXEC_APP\n-\t{\n-\t\tunion acpi_operand_object *prev;\n-\t\tunion acpi_operand_object *next;\n+\t\/* Delete any module-level code blocks *\/\n \n-\t\t\/* Delete any module-level code blocks *\/\n-\n-\t\tnext = acpi_gbl_module_code_list;\n-\t\twhile (next) {\n-\t\t\tprev = next;\n-\t\t\tnext = next->method.mutex;\n-\t\t\tprev->method.mutex = NULL;\t\/* Clear the Mutex (cheated) field *\/\n-\t\t\tacpi_ut_remove_reference(prev);\n-\t\t}\n+\tnext = acpi_gbl_module_code_list;\n+\twhile (next) {\n+\t\tprev = next;\n+\t\tnext = next->method.mutex;\n+\t\tprev->method.mutex = NULL;\t\/* Clear the Mutex (cheated) field *\/\n+\t\tacpi_ut_remove_reference(prev);\n \t}\n-#endif\n \n \t\/*\n \t * Free the entire namespace -- all nodes and all objects\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-9756","CWE_ID":"200","category":"security","commit_id":"2117d5398c81554fbf803f5fd1dc55eb78216c0c","commit_message":"From 2117d5398c81554fbf803f5fd1dc55eb78216c0c Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Radim=20Kr=C4=8Dm=C3=A1=C5=99?= <rkrcmar@redhat.com>\nDate: Wed, 23 Nov 2016 21:15:00 +0100\nSubject: [PATCH] KVM: x86: drop error recovery in em_jmp_far and em_ret_far\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nem_jmp_far and em_ret_far assumed that setting IP can only fail in 64\nbit mode, but syzkaller proved otherwise (and SDM agrees).\nCode segment was restored upon failure, but it was left uninitialized\noutside of long mode, which could lead to a leak of host kernel stack.\nWe could have fixed that by always saving and restoring the CS, but we\ntake a simpler approach and just break any guest that manages to fail\nas the error recovery is error-prone and modern CPUs don't need emulator\nfor this.\n\nFound by syzkaller:\n\n  WARNING: CPU: 2 PID: 3668 at arch\/x86\/kvm\/emulate.c:2217 em_ret_far+0x428\/0x480\n  Kernel panic - not syncing: panic_on_warn set ...\n\n  CPU: 2 PID: 3668 Comm: syz-executor Not tainted 4.9.0-rc4+ #49\n  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01\/01\/2011\n   [...]\n  Call Trace:\n   [...] __dump_stack lib\/dump_stack.c:15\n   [...] dump_stack+0xb3\/0x118 lib\/dump_stack.c:51\n   [...] panic+0x1b7\/0x3a3 kernel\/panic.c:179\n   [...] __warn+0x1c4\/0x1e0 kernel\/panic.c:542\n   [...] warn_slowpath_null+0x2c\/0x40 kernel\/panic.c:585\n   [...] em_ret_far+0x428\/0x480 arch\/x86\/kvm\/emulate.c:2217\n   [...] em_ret_far_imm+0x17\/0x70 arch\/x86\/kvm\/emulate.c:2227\n   [...] x86_emulate_insn+0x87a\/0x3730 arch\/x86\/kvm\/emulate.c:5294\n   [...] x86_emulate_instruction+0x520\/0x1ba0 arch\/x86\/kvm\/x86.c:5545\n   [...] emulate_instruction arch\/x86\/include\/asm\/kvm_host.h:1116\n   [...] complete_emulated_io arch\/x86\/kvm\/x86.c:6870\n   [...] complete_emulated_mmio+0x4e9\/0x710 arch\/x86\/kvm\/x86.c:6934\n   [...] kvm_arch_vcpu_ioctl_run+0x3b7a\/0x5a90 arch\/x86\/kvm\/x86.c:6978\n   [...] kvm_vcpu_ioctl+0x61e\/0xdd0 arch\/x86\/kvm\/..\/..\/..\/virt\/kvm\/kvm_main.c:2557\n   [...] vfs_ioctl fs\/ioctl.c:43\n   [...] do_vfs_ioctl+0x18c\/0x1040 fs\/ioctl.c:679\n   [...] SYSC_ioctl fs\/ioctl.c:694\n   [...] SyS_ioctl+0x8f\/0xc0 fs\/ioctl.c:685\n   [...] entry_SYSCALL_64_fastpath+0x1f\/0xc2\n\nReported-by: Dmitry Vyukov <dvyukov@google.com>\nCc: stable@vger.kernel.org\nFixes: d1442d85cc30 (\"KVM: x86: Handle errors when RIP is set during far jumps\")\nSigned-off-by: Radim Kr\u010dm\u00e1\u0159 <rkrcmar@redhat.com>\n---\n arch\/x86\/kvm\/emulate.c | 36 +++++++++++-------------------------\n 1 file changed, 11 insertions(+), 25 deletions(-)\n\n","diff_code":"diff --git a\/arch\/x86\/kvm\/emulate.c b\/arch\/x86\/kvm\/emulate.c\nindex cbd7b92585bbb..a3ce9d260d687 100644\n--- a\/arch\/x86\/kvm\/emulate.c\n+++ b\/arch\/x86\/kvm\/emulate.c\n@@ -2105,16 +2105,10 @@ static int em_iret(struct x86_emulate_ctxt *ctxt)\n static int em_jmp_far(struct x86_emulate_ctxt *ctxt)\n {\n \tint rc;\n-\tunsigned short sel, old_sel;\n-\tstruct desc_struct old_desc, new_desc;\n-\tconst struct x86_emulate_ops *ops = ctxt->ops;\n+\tunsigned short sel;\n+\tstruct desc_struct new_desc;\n \tu8 cpl = ctxt->ops->cpl(ctxt);\n \n-\t\/* Assignment of RIP may only fail in 64-bit mode *\/\n-\tif (ctxt->mode == X86EMUL_MODE_PROT64)\n-\t\tops->get_segment(ctxt, &old_sel, &old_desc, NULL,\n-\t\t\t\t VCPU_SREG_CS);\n-\n \tmemcpy(&sel, ctxt->src.valptr + ctxt->op_bytes, 2);\n \n \trc = __load_segment_descriptor(ctxt, sel, VCPU_SREG_CS, cpl,\n@@ -2124,12 +2118,10 @@ static int em_jmp_far(struct x86_emulate_ctxt *ctxt)\n \t\treturn rc;\n \n \trc = assign_eip_far(ctxt, ctxt->src.val, &new_desc);\n-\tif (rc != X86EMUL_CONTINUE) {\n-\t\tWARN_ON(ctxt->mode != X86EMUL_MODE_PROT64);\n-\t\t\/* assigning eip failed; restore the old cs *\/\n-\t\tops->set_segment(ctxt, old_sel, &old_desc, 0, VCPU_SREG_CS);\n-\t\treturn rc;\n-\t}\n+\t\/* Error handling is not implemented. *\/\n+\tif (rc != X86EMUL_CONTINUE)\n+\t\treturn X86EMUL_UNHANDLEABLE;\n+\n \treturn rc;\n }\n \n@@ -2189,14 +2181,8 @@ static int em_ret_far(struct x86_emulate_ctxt *ctxt)\n {\n \tint rc;\n \tunsigned long eip, cs;\n-\tu16 old_cs;\n \tint cpl = ctxt->ops->cpl(ctxt);\n-\tstruct desc_struct old_desc, new_desc;\n-\tconst struct x86_emulate_ops *ops = ctxt->ops;\n-\n-\tif (ctxt->mode == X86EMUL_MODE_PROT64)\n-\t\tops->get_segment(ctxt, &old_cs, &old_desc, NULL,\n-\t\t\t\t VCPU_SREG_CS);\n+\tstruct desc_struct new_desc;\n \n \trc = emulate_pop(ctxt, &eip, ctxt->op_bytes);\n \tif (rc != X86EMUL_CONTINUE)\n@@ -2213,10 +2199,10 @@ static int em_ret_far(struct x86_emulate_ctxt *ctxt)\n \tif (rc != X86EMUL_CONTINUE)\n \t\treturn rc;\n \trc = assign_eip_far(ctxt, eip, &new_desc);\n-\tif (rc != X86EMUL_CONTINUE) {\n-\t\tWARN_ON(ctxt->mode != X86EMUL_MODE_PROT64);\n-\t\tops->set_segment(ctxt, old_cs, &old_desc, 0, VCPU_SREG_CS);\n-\t}\n+\t\/* Error handling is not implemented. *\/\n+\tif (rc != X86EMUL_CONTINUE)\n+\t\treturn X86EMUL_UNHANDLEABLE;\n+\n \treturn rc;\n }\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-5069","CWE_ID":"200","category":"security","commit_id":"f8914468182e8d0a1551b430c0879ba236fe4d6d","commit_message":"From f8914468182e8d0a1551b430c0879ba236fe4d6d Mon Sep 17 00:00:00 2001\nFrom: \"Ignacio R. Morelle\" <shadowm@wesnoth.org>\nDate: Tue, 9 Jun 2015 06:12:09 -0300\nSubject: [PATCH] Disallow inclusion of .pbl files from WML (bug #23504)\n\nNote that this will also cause Lua wesnoth.have_file() to return false\non .pbl files.\n---\n changelog                | 1 +\n src\/filesystem.cpp       | 5 +++++\n src\/filesystem_boost.cpp | 5 +++++\n 3 files changed, 11 insertions(+)\n\n","diff_code":"diff --git a\/changelog b\/changelog\nindex e1ea3fe2b685..606ad814b8a4 100644\n--- a\/changelog\n+++ b\/changelog\n@@ -65,6 +65,7 @@ Version 1.13.0+dev:\n    * Made silence.ogg larger to work around a crash involving the multiplayer\n      lobby with music and sound enabled (bug #23633, possibly also bug #23599,\n      bug #23203, bug #23026).\n+   * Disallowed inclusion of .pbl files from WML (bug #23504).\n \n Version 1.13.0:\n  * Security fixes:\ndiff --git a\/src\/filesystem.cpp b\/src\/filesystem.cpp\nindex b76e07fe1231..7d5adb60d78c 100644\n--- a\/src\/filesystem.cpp\n+++ b\/src\/filesystem.cpp\n@@ -1008,6 +1008,11 @@ std::string get_wml_location(const std::string &filename, const std::string &cur\n \t\treturn result;\n \t}\n \n+\tif (ends_with(filename, \".pbl\")) {\n+\t\tERR_FS << \"Illegal path '\" << filename << \"' (.pbl files are not allowed).\" << std::endl;\n+\t\treturn result;\n+\t}\n+\n \tbool already_found = false;\n \n \tif (filename[0] == '~')\ndiff --git a\/src\/filesystem_boost.cpp b\/src\/filesystem_boost.cpp\nindex 9a8722eafa1f..21b582159e11 100644\n--- a\/src\/filesystem_boost.cpp\n+++ b\/src\/filesystem_boost.cpp\n@@ -1000,6 +1000,11 @@ static bool is_legal_file(const std::string &filename)\n \t\treturn false;\n \t}\n \n+\tif (ends_with(filename, \".pbl\")) {\n+\t\tERR_FS << \"Illegal path '\" << filename << \"' (.pbl files are not allowed).\" << std::endl;\n+\t\treturn false;\n+\t}\n+\n \treturn true;\n }\n \n","owner":"wesnoth","repo":"wesnoth","source":"cve"},{"CVE_ID":"CVE-2012-6113","CWE_ID":"200","category":"security","commit_id":"270a406ac94b5fc5cc9ef59fc61e3b4b95648a3e","commit_message":"From 270a406ac94b5fc5cc9ef59fc61e3b4b95648a3e Mon Sep 17 00:00:00 2001\nFrom: Anatoliy Belsky <ab@php.net>\nDate: Tue, 24 Apr 2012 14:05:35 +0200\nSubject: [PATCH] Fix bug #61413 ext\\openssl\\tests\\openssl_encrypt_crash.phpt\n fails 5.3 only\n\n---\n ext\/openssl\/openssl.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/ext\/openssl\/openssl.c b\/ext\/openssl\/openssl.c\nindex 7c5afc5..779a91d 100644\n--- a\/ext\/openssl\/openssl.c\n+++ b\/ext\/openssl\/openssl.c\n@@ -4677,7 +4677,7 @@ PHP_FUNCTION(openssl_encrypt)\n \tint data_len, method_len, password_len, iv_len = 0, max_iv_len;\n \tconst EVP_CIPHER *cipher_type;\n \tEVP_CIPHER_CTX cipher_ctx;\n-\tint i, outlen, keylen;\n+\tint i = 0, outlen, keylen;\n \tunsigned char *outbuf, *key;\n \tzend_bool free_iv;\n \n-- \n2.1.4\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2010-4083","CWE_ID":"200","category":"security","commit_id":"982f7c2b2e6a28f8f266e075d92e19c0dd4c6e56","commit_message":"From 982f7c2b2e6a28f8f266e075d92e19c0dd4c6e56 Mon Sep 17 00:00:00 2001\nFrom: Dan Rosenberg <drosenberg@vsecurity.com>\nDate: Thu, 30 Sep 2010 15:15:31 -0700\nSubject: sys_semctl: fix kernel stack leakage\n\nThe semctl syscall has several code paths that lead to the leakage of\nuninitialized kernel stack memory (namely the IPC_INFO, SEM_INFO,\nIPC_STAT, and SEM_STAT commands) during the use of the older, obsolete\nversion of the semid_ds struct.\n\nThe copy_semid_to_user() function declares a semid_ds struct on the stack\nand copies it back to the user without initializing or zeroing the\n\"sem_base\", \"sem_pending\", \"sem_pending_last\", and \"undo\" pointers,\nallowing the leakage of 16 bytes of kernel stack memory.\n\nThe code is still reachable on 32-bit systems - when calling semctl()\nnewer glibc's automatically OR the IPC command with the IPC_64 flag, but\ninvoking the syscall directly allows users to use the older versions of\nthe struct.\n\nSigned-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>\nCc: Manfred Spraul <manfred@colorfullife.com>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n ipc\/sem.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/ipc\/sem.c b\/ipc\/sem.c\nindex 40a8f462a822..0e0d49bbb867 100644\n--- a\/ipc\/sem.c\n+++ b\/ipc\/sem.c\n@@ -743,6 +743,8 @@ static unsigned long copy_semid_to_user(void __user *buf, struct semid64_ds *in,\n \t    {\n \t\tstruct semid_ds out;\n \n+\t\tmemset(&out, 0, sizeof(out));\n+\n \t\tipc64_perm_to_ipc_perm(&in->sem_perm, &out.sem_perm);\n \n \t\tout.sem_otime\t= in->sem_otime;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2015-3411","CWE_ID":"200","category":"security","commit_id":"4435b9142ff9813845d5c97ab29a5d637bedb257","commit_message":"From 4435b9142ff9813845d5c97ab29a5d637bedb257 Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Sun, 5 Apr 2015 16:01:24 -0700\nSubject: [PATCH] Fixed bug #69353 (Missing null byte checks for paths in\n various PHP extensions)\n\n---\n ext\/dom\/document.c                                 | 5 ++++-\n ext\/dom\/tests\/DOMDocument_loadHTMLfile_error2.phpt | 5 +++++\n ext\/fileinfo\/fileinfo.c                            | 5 +++++\n ext\/fileinfo\/tests\/finfo_file_basic.phpt           | 4 ++++\n ext\/gd\/gd.c                                        | 8 ++++----\n ext\/hash\/hash.c                                    | 7 ++++++-\n ext\/hash\/tests\/hash_hmac_file_error.phpt           | 7 +++++++\n ext\/pgsql\/pgsql.c                                  | 2 +-\n ext\/standard\/link.c                                | 2 +-\n ext\/standard\/streamsfuncs.c                        | 2 +-\n ext\/xmlwriter\/php_xmlwriter.c                      | 4 ++--\n ext\/zlib\/zlib.c                                    | 4 ++--\n 12 files changed, 42 insertions(+), 13 deletions(-)\n\n","diff_code":"diff --git a\/ext\/dom\/document.c b\/ext\/dom\/document.c\nindex f105f6d..4666746 100644\n--- a\/ext\/dom\/document.c\n+++ b\/ext\/dom\/document.c\n@@ -1580,6 +1580,9 @@ static xmlDocPtr dom_document_parser(zval *id, int mode, char *source, int sourc\n \txmlInitParser();\n \n \tif (mode == DOM_LOAD_FILE) {\n+\t\tif (CHECK_NULL_PATH(source, source_len)) {\n+\t\t\treturn NULL;\n+\t\t}\n \t\tchar *file_dest = _dom_get_valid_file_path(source, resolved_path, MAXPATHLEN  TSRMLS_CC);\n \t\tif (file_dest) {\n \t\t\tctxt = xmlCreateFileParserCtxt(file_dest);\n@@ -2168,7 +2171,7 @@ static void dom_load_html(INTERNAL_FUNCTION_PARAMETERS, int mode) \/* {{{ *\/\n \t\n \tid = getThis();\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s|l\", &source, &source_len, &options) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p|l\", &source, &source_len, &options) == FAILURE) {\n \t\treturn;\n \t}\n \ndiff --git a\/ext\/dom\/tests\/DOMDocument_loadHTMLfile_error2.phpt b\/ext\/dom\/tests\/DOMDocument_loadHTMLfile_error2.phpt\nindex e59ff56..75004e2 100644\n--- a\/ext\/dom\/tests\/DOMDocument_loadHTMLfile_error2.phpt\n+++ b\/ext\/dom\/tests\/DOMDocument_loadHTMLfile_error2.phpt\n@@ -13,6 +13,11 @@ assert.bail=true\n $doc = new DOMDocument();\n $result = $doc->loadHTMLFile(\"\");\n assert('$result === false');\n+$doc = new DOMDocument();\n+$result = $doc->loadHTMLFile(\"text.html\\0something\");\n+assert('$result === null');\n ?>\n --EXPECTF--\n %r(PHP ){0,1}%rWarning: DOMDocument::loadHTMLFile(): Empty string supplied as input %s\n+\n+%r(PHP ){0,1}%rWarning: DOMDocument::loadHTMLFile() expects parameter 1 to be a valid path, string given %s\ndiff --git a\/ext\/fileinfo\/fileinfo.c b\/ext\/fileinfo\/fileinfo.c\nindex 2d523ab..5fd9511 100644\n--- a\/ext\/fileinfo\/fileinfo.c\n+++ b\/ext\/fileinfo\/fileinfo.c\n@@ -506,6 +506,11 @@ static void _php_finfo_get_type(INTERNAL_FUNCTION_PARAMETERS, int mode, int mime\n \t\t\t\tRETVAL_FALSE;\n \t\t\t\tgoto clean;\n \t\t\t}\n+\t\t\tif (CHECK_NULL_PATH(buffer, buffer_len)) {\n+\t\t\t\tphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"Invalid path\");\n+\t\t\t\tRETVAL_FALSE;\n+\t\t\t\tgoto clean;\n+\t\t\t}\n \n \t\t\twrap = php_stream_locate_url_wrapper(buffer, &tmp2, 0 TSRMLS_CC);\n \ndiff --git a\/ext\/fileinfo\/tests\/finfo_file_basic.phpt b\/ext\/fileinfo\/tests\/finfo_file_basic.phpt\nindex 20223fd..ee70e2e 100644\n--- a\/ext\/fileinfo\/tests\/finfo_file_basic.phpt\n+++ b\/ext\/fileinfo\/tests\/finfo_file_basic.phpt\n@@ -19,6 +19,7 @@ echo \"*** Testing finfo_file() : basic functionality ***\\n\";\n var_dump( finfo_file( $finfo, __FILE__) );\n var_dump( finfo_file( $finfo, __FILE__, FILEINFO_CONTINUE ) );\n var_dump( finfo_file( $finfo, $magicFile ) );\n+var_dump( finfo_file( $finfo, $magicFile.chr(0).$magicFile) );\n \n ?>\n ===DONE===\n@@ -27,4 +28,7 @@ var_dump( finfo_file( $finfo, $magicFile ) );\n string(28) \"text\/x-php; charset=us-ascii\"\n string(22) \"PHP script, ASCII text\"\n string(25) \"text\/plain; charset=utf-8\"\n+\n+Warning: finfo_file(): Invalid path in %s\/finfo_file_basic.php on line %d\n+bool(false)\n ===DONE===\ndiff --git a\/ext\/gd\/gd.c b\/ext\/gd\/gd.c\nindex e5657f7..d258c3d 100644\n--- a\/ext\/gd\/gd.c\n+++ b\/ext\/gd\/gd.c\n@@ -1495,7 +1495,7 @@ PHP_FUNCTION(imageloadfont)\n \tgdFontPtr font;\n \tphp_stream *stream;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &file, &file_name) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p\", &file, &file_name) == FAILURE) {\n \t\treturn;\n \t}\n \n@@ -2438,7 +2438,7 @@ static void _php_image_create_from(INTERNAL_FUNCTION_PARAMETERS, int image_type,\n \tlong ignore_warning;\n #endif\n \tif (image_type == PHP_GDIMG_TYPE_GD2PART) {\n-\t\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"sllll\", &file, &file_len, &srcx, &srcy, &width, &height) == FAILURE) {\n+\t\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"pllll\", &file, &file_len, &srcx, &srcy, &width, &height) == FAILURE) {\n \t\t\treturn;\n \t\t}\n \t\tif (width < 1 || height < 1) {\n@@ -2446,7 +2446,7 @@ static void _php_image_create_from(INTERNAL_FUNCTION_PARAMETERS, int image_type,\n \t\t\tRETURN_FALSE;\n \t\t}\n \t} else {\n-\t\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &file, &file_len) == FAILURE) {\n+\t\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p\", &file, &file_len) == FAILURE) {\n \t\t\treturn;\n \t\t}\n \t}\n@@ -4178,7 +4178,7 @@ PHP_FUNCTION(imagepsencodefont)\n \tchar *enc, **enc_vector;\n \tint enc_len, *f_ind;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"rs\", &fnt, &enc, &enc_len) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"rp\", &fnt, &enc, &enc_len) == FAILURE) {\n \t\treturn;\n \t}\n \ndiff --git a\/ext\/hash\/hash.c b\/ext\/hash\/hash.c\nindex bd9dcca..f5988c9 100644\n--- a\/ext\/hash\/hash.c\n+++ b\/ext\/hash\/hash.c\n@@ -142,6 +142,7 @@ static void php_hash_do_hash(INTERNAL_FUNCTION_PARAMETERS, int isfilename, zend_\n \t}\n \tif (isfilename) {\n \t\tif (CHECK_NULL_PATH(data, data_len)) {\n+\t\t\tphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"Invalid path\");\n \t\t\tRETURN_FALSE;\n \t\t}\n \t\tstream = php_stream_open_wrapper_ex(data, \"rb\", REPORT_ERRORS, NULL, DEFAULT_CONTEXT);\n@@ -222,6 +223,10 @@ static void php_hash_do_hash_hmac(INTERNAL_FUNCTION_PARAMETERS, int isfilename,\n \t\tRETURN_FALSE;\n \t}\n \tif (isfilename) {\n+\t\tif (CHECK_NULL_PATH(data, data_len)) {\n+\t\t\tphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"Invalid path\");\n+\t\t\tRETURN_FALSE;\n+\t\t}\n \t\tstream = php_stream_open_wrapper_ex(data, \"rb\", REPORT_ERRORS, NULL, DEFAULT_CONTEXT);\n \t\tif (!stream) {\n \t\t\t\/* Stream will report errors opening file *\/\n@@ -449,7 +454,7 @@ PHP_FUNCTION(hash_update_file)\n \tchar *filename, buf[1024];\n \tint filename_len, n;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"rs|r\", &zhash, &filename, &filename_len, &zcontext) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"rp|r\", &zhash, &filename, &filename_len, &zcontext) == FAILURE) {\n \t\treturn;\n \t}\n \ndiff --git a\/ext\/hash\/tests\/hash_hmac_file_error.phpt b\/ext\/hash\/tests\/hash_hmac_file_error.phpt\nindex 42ab122..26ba8aa 100644\n--- a\/ext\/hash\/tests\/hash_hmac_file_error.phpt\n+++ b\/ext\/hash\/tests\/hash_hmac_file_error.phpt\n@@ -28,6 +28,9 @@ hash_hmac_file('crc32', $file, $key, TRUE, $extra_arg);\n echo \"\\n-- Testing hash_hmac_file() function with invalid hash algorithm --\\n\";\n hash_hmac_file('foo', $file, $key, TRUE);\n \n+echo \"\\n-- Testing hash_hmac_file() function with bad path --\\n\";\n+hash_hmac_file('crc32', $file.chr(0).$file, $key, TRUE);\n+\n ?>\n ===Done===\n --EXPECTF--\n@@ -51,4 +54,8 @@ Warning: hash_hmac_file() expects at most 4 parameters, 5 given in %s on line %d\n -- Testing hash_hmac_file() function with invalid hash algorithm --\n \n Warning: hash_hmac_file(): Unknown hashing algorithm: foo in %s on line %d\n+\n+-- Testing hash_hmac_file() function with bad path --\n+\n+Warning: hash_hmac_file(): Invalid path in %s on line %d\n ===Done===\n\\ No newline at end of file\ndiff --git a\/ext\/pgsql\/pgsql.c b\/ext\/pgsql\/pgsql.c\nindex eb55777..cd51143 100644\n--- a\/ext\/pgsql\/pgsql.c\n+++ b\/ext\/pgsql\/pgsql.c\n@@ -3014,7 +3014,7 @@ PHP_FUNCTION(pg_trace)\n \tphp_stream *stream;\n \tid = PGG(default_link);\n \n-\tif (zend_parse_parameters(argc TSRMLS_CC, \"s|sr\", &z_filename, &z_filename_len, &mode, &mode_len, &pgsql_link) == FAILURE) {\n+\tif (zend_parse_parameters(argc TSRMLS_CC, \"p|sr\", &z_filename, &z_filename_len, &mode, &mode_len, &pgsql_link) == FAILURE) {\n \t\treturn;\n \t}\n \ndiff --git a\/ext\/standard\/link.c b\/ext\/standard\/link.c\nindex c57484e..686dd3e 100644\n--- a\/ext\/standard\/link.c\n+++ b\/ext\/standard\/link.c\n@@ -59,7 +59,7 @@ PHP_FUNCTION(readlink)\n \tchar buff[MAXPATHLEN];\n \tint ret;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &link, &link_len) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p\", &link, &link_len) == FAILURE) {\n \t\treturn;\n \t}\n \ndiff --git a\/ext\/standard\/streamsfuncs.c b\/ext\/standard\/streamsfuncs.c\nindex b1b3180..b8f15e3 100644\n--- a\/ext\/standard\/streamsfuncs.c\n+++ b\/ext\/standard\/streamsfuncs.c\n@@ -1549,7 +1549,7 @@ PHP_FUNCTION(stream_resolve_include_path)\n \tchar *filename, *resolved_path;\n \tint filename_len;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &filename, &filename_len) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p\", &filename, &filename_len) == FAILURE) {\n \t\treturn;\n \t}\n \ndiff --git a\/ext\/xmlwriter\/php_xmlwriter.c b\/ext\/xmlwriter\/php_xmlwriter.c\nindex 7bc35da..acb8754 100644\n--- a\/ext\/xmlwriter\/php_xmlwriter.c\n+++ b\/ext\/xmlwriter\/php_xmlwriter.c\n@@ -1738,7 +1738,7 @@ static PHP_FUNCTION(xmlwriter_write_dtd_entity)\n \/* }}} *\/\n #endif\n \n-\/* {{{ proto resource xmlwriter_open_uri(resource xmlwriter, string source)\n+\/* {{{ proto resource xmlwriter_open_uri(string source)\n Create new xmlwriter using source uri for output *\/\n static PHP_FUNCTION(xmlwriter_open_uri)\n {\n@@ -1759,7 +1759,7 @@ static PHP_FUNCTION(xmlwriter_open_uri)\n \tvoid *ioctx;\n #endif\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &source, &source_len) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p\", &source, &source_len) == FAILURE) {\n \t\treturn;\n \t}\n \t\ndiff --git a\/ext\/zlib\/zlib.c b\/ext\/zlib\/zlib.c\nindex 705fb5d..431dfde 100644\n--- a\/ext\/zlib\/zlib.c\n+++ b\/ext\/zlib\/zlib.c\n@@ -581,7 +581,7 @@ static PHP_FUNCTION(gzopen)\n \tphp_stream *stream;\n \tlong use_include_path = 0;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"ss|l\", &filename, &filename_len, &mode, &mode_len, &use_include_path) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"ps|l\", &filename, &filename_len, &mode, &mode_len, &use_include_path) == FAILURE) {\n \t\treturn;\n \t}\n \n@@ -609,7 +609,7 @@ static PHP_FUNCTION(readgzfile)\n \tint size;\n \tlong use_include_path = 0;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s|l\", &filename, &filename_len, &use_include_path) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p|l\", &filename, &filename_len, &use_include_path) == FAILURE) {\n \t\treturn;\n \t}\n \n-- \n2.1.4\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-6200","CWE_ID":"200","category":"security","commit_id":"6e8572ea8bb56d0216bb1b410e5040edc051b120","commit_message":"From 6e8572ea8bb56d0216bb1b410e5040edc051b120 Mon Sep 17 00:00:00 2001\nFrom: Kenton Varda <kenton@sandstorm.io>\nDate: Wed, 1 Mar 2017 12:24:53 -0800\nSubject: [PATCH] Fix newline detection in zip paths.\n\n---\n src\/sandstorm\/backup.c++ | 26 +++++++++++++-------------\n 1 file changed, 13 insertions(+), 13 deletions(-)\n\n","diff_code":"diff --git a\/src\/sandstorm\/backup.c++ b\/src\/sandstorm\/backup.c++\nindex 16d3cf455..20349e61c 100644\n--- a\/src\/sandstorm\/backup.c++\n+++ b\/src\/sandstorm\/backup.c++\n@@ -252,23 +252,23 @@ void BackupMain::pump(kj::InputStream& in, kj::OutputStream& out) {\n }\n \n bool BackupMain::findFilesToZip(kj::StringPtr path, kj::OutputStream& out) {\n+  \/\/ If the path contains a newline, we cannot correctly pass it to `zip` since `zip` expects\n+  \/\/ one file per line. For security reasons, we must detect and filter out these files.\n+  \/\/ Hopefully this never happens legitimately?\n+  if (path.findFirst('\\n') != nullptr) {\n+    KJ_LOG(ERROR, \"tried to backup file containing newlines\", path);\n+    return false;\n+  }\n+\n   struct stat stats;\n   KJ_SYSCALL(lstat(path.cStr(), &stats));\n   if (S_ISREG(stats.st_mode) || S_ISLNK(stats.st_mode)) {\n     \/\/ Regular file or link can be zipped; write to file stream.\n-    \/\/ If the path contains a newline, we cannot correctly pass it to `zip` since `zip` expects\n-    \/\/ one file per line. For security reasons, we must detect and filter out these files.\n-    \/\/ Hopefully this never happens legitimately?\n-    if (path.findFirst('\\n') == nullptr) {\n-      kj::ArrayPtr<const byte> pieces[2];\n-      pieces[0] = path.asBytes();\n-      pieces[1] = kj::StringPtr(\"\\n\").asBytes();\n-      out.write(pieces);\n-      return true;\n-    } else {\n-      KJ_LOG(ERROR, \"tried to backup file containing newlines\", path);\n-      return false;\n-    }\n+    kj::ArrayPtr<const byte> pieces[2];\n+    pieces[0] = path.asBytes();\n+    pieces[1] = kj::StringPtr(\"\\n\").asBytes();\n+    out.write(pieces);\n+    return true;\n   } else if (S_ISDIR(stats.st_mode)) {\n     \/\/ Subdirectory; enumerate contents.\n     bool packedAny = false;\n","owner":"sandstorm-io","repo":"sandstorm","source":"cve"},{"CVE_ID":"CVE-2019-3569","CWE_ID":"200","category":"security","commit_id":"97ef580ec2cca9a54da6f9bd9fdd9a455f6d74ed","commit_message":"From 97ef580ec2cca9a54da6f9bd9fdd9a455f6d74ed Mon Sep 17 00:00:00 2001\nFrom: Fred Emmott <fe@fb.com>\nDate: Tue, 11 Jun 2019 11:44:59 -0700\nSubject: [PATCH] Fix default FastCGI interface\n\nReviewed By: alexeyt\n\nDifferential Revision: D15567393\n\nfbshipit-source-id: ffab228f689d4ddca9ea4835c70aecf16da2aa9f\n---\n hphp\/runtime\/server\/fastcgi\/fastcgi-server.cpp            | 3 ++-\n hphp\/test\/server\/debugger\/tests\/runTest1.php              | 3 +--\n hphp\/test\/server\/fastcgi\/tests\/authDigestTest.php         | 4 ++--\n ...\/test\/server\/fastcgi\/tests\/disable_ini_zend_compat.php | 2 +-\n ...\/test\/server\/fastcgi\/tests\/global_variables_server.php | 2 +-\n hphp\/test\/server\/fastcgi\/tests\/headerTest.php             | 2 +-\n hphp\/test\/server\/fastcgi\/tests\/httpsTest.php              | 2 +-\n hphp\/test\/server\/fastcgi\/tests\/invalid.php                | 2 +-\n hphp\/test\/server\/util\/server_tests.inc                    | 8 ++++----\n 9 files changed, 14 insertions(+), 14 deletions(-)\n\n","diff_code":"diff --git a\/hphp\/runtime\/server\/fastcgi\/fastcgi-server.cpp b\/hphp\/runtime\/server\/fastcgi\/fastcgi-server.cpp\nindex bce9f3195cb..32d7bf67503 100644\n--- a\/hphp\/runtime\/server\/fastcgi\/fastcgi-server.cpp\n+++ b\/hphp\/runtime\/server\/fastcgi\/fastcgi-server.cpp\n@@ -80,7 +80,8 @@ FastCGIServer::FastCGIServer(const std::string &address,\n   if (useFileSocket) {\n     sock_addr.setFromPath(address);\n   } else if (address.empty()) {\n-    sock_addr.setFromLocalPort(port);\n+    sock_addr.setFromHostPort(\"localhost\", port);\n+    assert(sock_addr.isLoopbackAddress());\n   } else {\n     sock_addr.setFromHostPort(address, port);\n   }\ndiff --git a\/hphp\/test\/server\/debugger\/tests\/runTest1.php b\/hphp\/test\/server\/debugger\/tests\/runTest1.php\nindex b4b506b9155..1c290e7c1d0 100644\n--- a\/hphp\/test\/server\/debugger\/tests\/runTest1.php\n+++ b\/hphp\/test\/server\/debugger\/tests\/runTest1.php\n@@ -5,9 +5,8 @@\n function test1Controller($hphpdOutput, $hphpdProcessId, $serverPort) {\n   \/\/ Request a page so that the client can debug it.\n   waitForClientToOutput($hphpdOutput, \"Waiting for server response\");\n-  $url = \"http:\/\/\".php_uname('n').':'.$serverPort.'\/test1.php';\n   echo \"Requesting test1.php\\n\";\n-  request(php_uname('n'), $serverPort, 'test1.php', 10); \/\/ ignore response\n+  request('localhost', $serverPort, 'test1.php', 10); \/\/ ignore response\n \n   \/\/ Let client run until script quits\n   waitForClientToOutput($hphpdOutput, \"quit\");\ndiff --git a\/hphp\/test\/server\/fastcgi\/tests\/authDigestTest.php b\/hphp\/test\/server\/fastcgi\/tests\/authDigestTest.php\nindex f32eba113f5..42a4c89476a 100644\n--- a\/hphp\/test\/server\/fastcgi\/tests\/authDigestTest.php\n+++ b\/hphp\/test\/server\/fastcgi\/tests\/authDigestTest.php\n@@ -8,7 +8,7 @@ function BadAuthDigestTestController($serverPort) {\n     'uri=\"\/test_auth_digest.php\", cnonce=\"MjIyMTg2\", nc=00000001, ' .\n     'qop=\"auth\", response=\"6dfbea52fbf13016476c1879e6436004\", ' .\n     'opaque=\"cdce8a5c95a1427d74df7acbf41c9ce0\"');\n-  var_dump(request(php_uname('n'), $serverPort, \"test_auth_digest.php\",\n+  var_dump(request('localhost', $serverPort, \"test_auth_digest.php\",\n                   [], [], $args));\n }\n \n@@ -18,7 +18,7 @@ function GoodAuthDigestTestController($serverPort) {\n     'uri=\"\/test_auth_digest.php\", cnonce=\"MjIyMTg1\", nc=00000001, ' .\n     'qop=\"auth\", response=\"e544aaed06917adea3e5c74dd49f0e32\", ' .\n     'opaque=\"cdce8a5c95a1427d74df7acbf41c9ce0\"');\n-  var_dump(request(php_uname('n'), $serverPort, \"test_auth_digest.php\",\n+  var_dump(request('localhost', $serverPort, \"test_auth_digest.php\",\n                   [], [], $args));\n }\n \ndiff --git a\/hphp\/test\/server\/fastcgi\/tests\/disable_ini_zend_compat.php b\/hphp\/test\/server\/fastcgi\/tests\/disable_ini_zend_compat.php\nindex 86b8fe226c4..e55c60c45a2 100644\n--- a\/hphp\/test\/server\/fastcgi\/tests\/disable_ini_zend_compat.php\n+++ b\/hphp\/test\/server\/fastcgi\/tests\/disable_ini_zend_compat.php\n@@ -6,7 +6,7 @@\n require_once('test_base.inc');\n \n function disableIniZendCompatController($port) {\n-  echo request(php_uname('n'), $port, 'test_disable_ini_zend_compat.php');\n+  echo request('localhost', $port, 'test_disable_ini_zend_compat.php');\n }\n \n echo \"---Enable Ini Zend Compat ON---\\n\";\ndiff --git a\/hphp\/test\/server\/fastcgi\/tests\/global_variables_server.php b\/hphp\/test\/server\/fastcgi\/tests\/global_variables_server.php\nindex f364dd14527..b9f84bf076f 100644\n--- a\/hphp\/test\/server\/fastcgi\/tests\/global_variables_server.php\n+++ b\/hphp\/test\/server\/fastcgi\/tests\/global_variables_server.php\n@@ -23,6 +23,6 @@\n     $path = 'global_variables.php?var=GET&get=1';\n     $post = array('var' => 'POST', 'post' => 2);\n     $headers = array('Cookie' => 'var=COOKIE;cookie=3;');\n-    echo request(php_uname('n'), $port, $path, $post, $headers, $extra) . \"\\n\";\n+    echo request('localhost', $port, $path, $post, $headers, $extra) . \"\\n\";\n   }, $request[0]);\n }\ndiff --git a\/hphp\/test\/server\/fastcgi\/tests\/headerTest.php b\/hphp\/test\/server\/fastcgi\/tests\/headerTest.php\nindex 9bc9cf7ef41..91da6e5e1f1 100644\n--- a\/hphp\/test\/server\/fastcgi\/tests\/headerTest.php\n+++ b\/hphp\/test\/server\/fastcgi\/tests\/headerTest.php\n@@ -4,7 +4,7 @@\n \n function headerTestController($serverPort) {\n   $args = array('Authorization' => 'foo');\n-  var_dump(request(php_uname('n'), $serverPort, \"test_headers.php\",\n+  var_dump(request('localhost', $serverPort, \"test_headers.php\",\n                   [], ['PROXY' => 'foobar'], $args));\n }\n \ndiff --git a\/hphp\/test\/server\/fastcgi\/tests\/httpsTest.php b\/hphp\/test\/server\/fastcgi\/tests\/httpsTest.php\nindex 51ef72dc3cb..7db48a7077d 100644\n--- a\/hphp\/test\/server\/fastcgi\/tests\/httpsTest.php\n+++ b\/hphp\/test\/server\/fastcgi\/tests\/httpsTest.php\n@@ -4,7 +4,7 @@\n \n function httpsTestController($serverPort) {\n   $args = array('HTTPS' => '');\n-  var_dump(request(php_uname('n'), $serverPort, \"test_https.php\",\n+  var_dump(request('localhost', $serverPort, \"test_https.php\",\n                   [], [], $args));\n }\n \ndiff --git a\/hphp\/test\/server\/fastcgi\/tests\/invalid.php b\/hphp\/test\/server\/fastcgi\/tests\/invalid.php\nindex 462fce0312f..e36eaac31df 100644\n--- a\/hphp\/test\/server\/fastcgi\/tests\/invalid.php\n+++ b\/hphp\/test\/server\/fastcgi\/tests\/invalid.php\n@@ -3,7 +3,7 @@\n require_once('test_base.inc');\n \n function invalidTestController($port) {\n-  $host = php_uname('n');\n+  $host = 'localhost';\n \n   $filename = __DIR__.'\/request-doesnotexist.dat';\n   $file = fopen($filename, 'rb');\ndiff --git a\/hphp\/test\/server\/util\/server_tests.inc b\/hphp\/test\/server\/util\/server_tests.inc\nindex 28b8d8ce42c..55366c55f3c 100644\n--- a\/hphp\/test\/server\/util\/server_tests.inc\n+++ b\/hphp\/test\/server\/util\/server_tests.inc\n@@ -179,7 +179,7 @@ function startServer(&$serverPort, &$adminPort, &$debugPort, $home, $root,\n \n \/\/ Check if the server id is in the expected list of ids.\n function checkServerId($serverPort, $expectedIds) {\n-  $host = php_uname('n');\n+  $host = 'localhost';\n   $r = request($host, $serverPort, \"hello.php\");\n   if (preg_match('\/Hello, World!(.*+)\/', $r ?? '', &$matches)) {\n     foreach ((array)$expectedIds as $id) {\n@@ -217,7 +217,7 @@ function stopServer($adminPort, $serverProc) {\n \n   $r = \"\";\n   for ($i = 1; $i <= 10; $i++) {\n-    $r = request(php_uname('n'), $adminPort, 'stop?instance-id='.$test_run_id);\n+    $r = request('localhost', $adminPort, 'stop?instance-id='.$test_run_id);\n     if ($r === \"OK\") break;\n     usleep(100000);\n   }\n@@ -286,7 +286,7 @@ function http_request($host, $port, $path, $timeout = 1200, $curl_opts = '') {\n     $headers = implode(\" \", $s);\n   }\n   $url = \"http:\/\/$host:$port\/$path\";\n-  $host_name = \"hphpd.debugger.\".php_uname('n');\n+  $host_name = \"hphpd.debugger.\".\\php_uname('n');\n \n   $LOG_ROOT = ServerUtilServerTests::$LOG_ROOT;\n   $test_run_id = ServerUtilServerTests::$test_run_id;\n@@ -304,7 +304,7 @@ function requestAll(array $requests, $customArgs = '', $repoArgs = '') {\n       foreach ($requests as $request) {\n         $r = is_array($request) ? $request[0] : $request;\n         echo \"Requesting '$r'\\n\";\n-        var_dump(request(php_uname('n'), $serverPort, $request));\n+        var_dump(request('localhost', $serverPort, $request));\n       }\n     },\n     $customArgs,\n","owner":"facebook","repo":"hhvm","source":"cve"},{"CVE_ID":"CVE-2013-4515","CWE_ID":"200","category":"security","commit_id":"8d1e72250c847fa96498ec029891de4dc638a5ba","commit_message":"From 8d1e72250c847fa96498ec029891de4dc638a5ba Mon Sep 17 00:00:00 2001\nFrom: Dan Carpenter <dan.carpenter@oracle.com>\nDate: Tue, 29 Oct 2013 23:01:11 +0300\nSubject: [PATCH] Staging: bcm: info leak in ioctl\n\nThe DevInfo.u32Reserved[] array isn't initialized so it leaks kernel\ninformation to user space.\n\nReported-by: Nico Golde <nico@ngolde.de>\nReported-by: Fabian Yamaguchi <fabs@goesec.de>\nSigned-off-by: Dan Carpenter <dan.carpenter@oracle.com>\nCc: stable@kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n drivers\/staging\/bcm\/Bcmchar.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/drivers\/staging\/bcm\/Bcmchar.c b\/drivers\/staging\/bcm\/Bcmchar.c\nindex f91bc1fdd895e..639ba96adb36b 100644\n--- a\/drivers\/staging\/bcm\/Bcmchar.c\n+++ b\/drivers\/staging\/bcm\/Bcmchar.c\n@@ -1960,6 +1960,7 @@ static long bcm_char_ioctl(struct file *filp, UINT cmd, ULONG arg)\n \n \t\tBCM_DEBUG_PRINT(Adapter, DBG_TYPE_OTHERS, OSAL_DBG, DBG_LVL_ALL, \"Called IOCTL_BCM_GET_DEVICE_DRIVER_INFO\\n\");\n \n+\t\tmemset(&DevInfo, 0, sizeof(DevInfo));\n \t\tDevInfo.MaxRDMBufferSize = BUFFER_4K;\n \t\tDevInfo.u32DSDStartOffset = EEPROM_CALPARAM_START;\n \t\tDevInfo.u32RxAlignmentCorrection = 0;\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2012-6547","CWE_ID":"200","category":"security","commit_id":"a117dacde0288f3ec60b6e5bcedae8fa37ee0dfc","commit_message":"From a117dacde0288f3ec60b6e5bcedae8fa37ee0dfc Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 29 Jul 2012 19:45:14 +0000\nSubject: net\/tun: fix ioctl() based info leaks\n\nThe tun module leaks up to 36 bytes of memory by not fully initializing\na structure located on the stack that gets copied to user memory by the\nTUNGETIFF and SIOCGIFHWADDR ioctl()s.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n drivers\/net\/tun.c | 4 +++-\n 1 file changed, 3 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/drivers\/net\/tun.c b\/drivers\/net\/tun.c\nindex c62163e272cd..f55c46222613 100644\n--- a\/drivers\/net\/tun.c\n+++ b\/drivers\/net\/tun.c\n@@ -1379,9 +1379,11 @@ static long __tun_chr_ioctl(struct file *file, unsigned int cmd,\n \tint vnet_hdr_sz;\n \tint ret;\n \n-\tif (cmd == TUNSETIFF || _IOC_TYPE(cmd) == 0x89)\n+\tif (cmd == TUNSETIFF || _IOC_TYPE(cmd) == 0x89) {\n \t\tif (copy_from_user(&ifr, argp, ifreq_len))\n \t\t\treturn -EFAULT;\n+\t} else\n+\t\tmemset(&ifr, 0, sizeof(ifr));\n \n \tif (cmd == TUNGETFEATURES) {\n \t\t\/* Currently this just means: \"what IFF flags are valid?\".\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2018-11469","CWE_ID":"200","category":"security","commit_id":"17514045e5d934dede62116216c1b016fe23dd06","commit_message":"From 17514045e5d934dede62116216c1b016fe23dd06 Mon Sep 17 00:00:00 2001\nFrom: William Lallemand <wlallemand@haproxy.com>\nDate: Tue, 22 May 2018 11:04:33 +0200\nSubject: [PATCH] BUG\/MEDIUM: cache: don't cache when an Authorization header\n is present\n\nRFC 7234 says:\n\nA cache MUST NOT store a response to any request, unless:\n[...] the Authorization header field (see Section 4.2 of [RFC7235]) does\n      not appear in the request, if the cache is shared, unless the\n      response explicitly allows it (see Section 3.2), [...]\n\nIn this patch we completely disable the cache upon the receipt of an\nAuthorization header in the request. In this case it's not possible to\neither use the cache or store into the cache anymore.\n\nThanks to Adam Eijdenberg of Digital Transformation Agency for raising\nthis issue.\n\nThis patch must be backported to 1.8.\n\n(cherry picked from commit 8a16fe0d053b93c00a8bcf86159135f98ca1377e)\nSigned-off-by: William Lallemand <wlallemand@haproxy.org>\n---\n doc\/configuration.txt |    1 +\n src\/proto_http.c      |    9 +++++++++\n 2 files changed, 10 insertions(+)\n\n","diff_code":"diff --git a\/doc\/configuration.txt b\/doc\/configuration.txt\nindex 0c6b408..cb022f9 100644\n--- a\/doc\/configuration.txt\n+++ b\/doc\/configuration.txt\n@@ -17021,6 +17021,7 @@ The cache won't store and won't deliver objects in these cases:\n \n - If the request is not a GET\n - If the HTTP version of the request is smaller than 1.1\n+- If the request contains an Authorization header\n \n Caution!: Due to the current limitation of the filters, it is not recommended\n to use the cache with other filters. Using them can cause undefined behavior\ndiff --git a\/src\/proto_http.c b\/src\/proto_http.c\nindex b384cef..beb012b 100644\n--- a\/src\/proto_http.c\n+++ b\/src\/proto_http.c\n@@ -7724,6 +7724,15 @@ void check_request_for_cacheability(struct stream *s, struct channel *chn)\n \t\t\t}\n \t\t}\n \n+\t\t\/* Don't use the cache and don't try to store if we found the\n+\t\t * Authorization header *\/\n+\t\tval = http_header_match2(cur_ptr, cur_end, \"Authorization\", 13);\n+\t\tif (val) {\n+\t\t\ttxn->flags &= ~TX_CACHEABLE & ~TX_CACHE_COOK;\n+\t\t\ttxn->flags |= TX_CACHE_IGNORE;\n+\t\t\tcontinue;\n+\t\t}\n+\n \t\tval = http_header_match2(cur_ptr, cur_end, \"Cache-control\", 13);\n \t\tif (!val)\n \t\t\tcontinue;\n-- \n1.7.10.4\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-20511","CWE_ID":"200","category":"security","commit_id":"9824dfae5741275473a23a7ed5756c7b6efacc9d","commit_message":"From 9824dfae5741275473a23a7ed5756c7b6efacc9d Mon Sep 17 00:00:00 2001\nFrom: Willy Tarreau <w@1wt.eu>\nDate: Wed, 12 Sep 2018 07:36:35 +0200\nSubject: net\/appletalk: fix minor pointer leak to userspace in SIOCFINDIPDDPRT\n\nFields ->dev and ->next of struct ipddp_route may be copied to\nuserspace on the SIOCFINDIPDDPRT ioctl. This is only accessible\nto CAP_NET_ADMIN though. Let's manually copy the relevant fields\ninstead of using memcpy().\n\nBugLink: http:\/\/blog.infosectcbr.com.au\/2018\/09\/linux-kernel-infoleaks.html\nCc: Jann Horn <jannh@google.com>\nSigned-off-by: Willy Tarreau <w@1wt.eu>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n drivers\/net\/appletalk\/ipddp.c | 8 ++++++--\n 1 file changed, 6 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/net\/appletalk\/ipddp.c b\/drivers\/net\/appletalk\/ipddp.c\nindex 9375cef22420..3d27616d9c85 100644\n--- a\/drivers\/net\/appletalk\/ipddp.c\n+++ b\/drivers\/net\/appletalk\/ipddp.c\n@@ -283,8 +283,12 @@ static int ipddp_ioctl(struct net_device *dev, struct ifreq *ifr, int cmd)\n                 case SIOCFINDIPDDPRT:\n \t\t\tspin_lock_bh(&ipddp_route_lock);\n \t\t\trp = __ipddp_find_route(&rcp);\n-\t\t\tif (rp)\n-\t\t\t\tmemcpy(&rcp2, rp, sizeof(rcp2));\n+\t\t\tif (rp) {\n+\t\t\t\tmemset(&rcp2, 0, sizeof(rcp2));\n+\t\t\t\trcp2.ip    = rp->ip;\n+\t\t\t\trcp2.at    = rp->at;\n+\t\t\t\trcp2.flags = rp->flags;\n+\t\t\t}\n \t\t\tspin_unlock_bh(&ipddp_route_lock);\n \n \t\t\tif (rp) {\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-7299","CWE_ID":"200","category":"security","commit_id":"9bd3b14042e12d84f39ea9f55731705ba516f525","commit_message":"From 9bd3b14042e12d84f39ea9f55731705ba516f525 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Tommi=20M=C3=A4kitalo?= <tommi@tntnet.org>\nDate: Wed, 11 Dec 2013 14:59:32 +0100\nSubject: [PATCH] fix possible information leak\n\n---\n framework\/common\/messageheaderparser.cpp | 4 ++++\n 1 file changed, 4 insertions(+)\n\n","diff_code":"diff --git a\/framework\/common\/messageheaderparser.cpp b\/framework\/common\/messageheaderparser.cpp\nindex 0c74c705..7bb5d6c2 100644\n--- a\/framework\/common\/messageheaderparser.cpp\n+++ b\/framework\/common\/messageheaderparser.cpp\n@@ -204,6 +204,7 @@ namespace tnt\n                    break;\n       }\n \n+      *headerdataPtr = '\\0';\n       return true;\n     }\n     else if (std::isspace(ch))\n@@ -259,7 +260,10 @@ namespace tnt\n   void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n   {\n     if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n+    {\n+      header.rawdata[sizeof(header.rawdata) - 1] = '\\0';\n       throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n+    }\n   }\n \n   void Messageheader::Parser::reset()\n","owner":"maekitalo","repo":"tntnet","source":"cve"},{"CVE_ID":"CVE-2015-5330","CWE_ID":"200","category":"security","commit_id":"0454b95657846fcecf0f51b6f1194faac02518bd","commit_message":"From 0454b95657846fcecf0f51b6f1194faac02518bd Mon Sep 17 00:00:00 2001\nFrom: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>\nDate: Tue, 24 Nov 2015 13:09:36 +1300\nSubject: [PATCH] CVE-2015-5330: ldb_dn_escape_value: use known string length,\n not strlen()\n\nldb_dn_escape_internal() reports the number of bytes it copied, so\nlets use that number, rather than using strlen() and hoping a zero got\nin the right place.\n\nBug: https:\/\/bugzilla.samba.org\/show_bug.cgi?id=11599\n\nSigned-off-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>\nPair-programmed-with: Andrew Bartlett <abartlet@samba.org>\nReviewed-by: Ralph Boehme <slow@samba.org>\n---\n lib\/ldb\/common\/ldb_dn.c | 12 ++++++++----\n 1 file changed, 8 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/lib\/ldb\/common\/ldb_dn.c b\/lib\/ldb\/common\/ldb_dn.c\nindex d39eb8caec1..6f9903e3e65 100644\n--- a\/lib\/ldb\/common\/ldb_dn.c\n+++ b\/lib\/ldb\/common\/ldb_dn.c\n@@ -250,7 +250,7 @@ static int ldb_dn_escape_internal(char *dst, const char *src, int len)\n char *ldb_dn_escape_value(TALLOC_CTX *mem_ctx, struct ldb_val value)\n {\n \tchar *dst;\n-\n+\tsize_t len;\n \tif (!value.length)\n \t\treturn NULL;\n \n@@ -261,10 +261,14 @@ char *ldb_dn_escape_value(TALLOC_CTX *mem_ctx, struct ldb_val value)\n \t\treturn NULL;\n \t}\n \n-\tldb_dn_escape_internal(dst, (const char *)value.data, value.length);\n-\n-\tdst = talloc_realloc(mem_ctx, dst, char, strlen(dst) + 1);\n+\tlen = ldb_dn_escape_internal(dst, (const char *)value.data, value.length);\n \n+\tdst = talloc_realloc(mem_ctx, dst, char, len + 1);\n+\tif ( ! dst) {\n+\t\ttalloc_free(dst);\n+\t\treturn NULL;\n+\t}\n+\tdst[len] = '\\0';\n \treturn dst;\n }\n \n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2014-3615","CWE_ID":"200","category":"security","commit_id":"c1b886c45dc70f247300f549dce9833f3fa2def5","commit_message":"From c1b886c45dc70f247300f549dce9833f3fa2def5 Mon Sep 17 00:00:00 2001\nFrom: Gerd Hoffmann <kraxel@redhat.com>\nDate: Tue, 26 Aug 2014 15:35:23 +0200\nSubject: [PATCH] vbe: rework sanity checks\n\nPlug a bunch of holes in the bochs dispi interface parameter checking.\nAdd a function doing verification on all registers.  Call that\nunconditionally on every register write.  That way we should catch\neverything, even changing one register affecting the valid range of\nanother register.\n\nSome of the holes have been added by commit\ne9c6149f6ae6873f14a12eea554925b6aa4c4dec.  Before that commit the\nmaximum possible framebuffer (VBE_DISPI_MAX_XRES * VBE_DISPI_MAX_YRES *\n32 bpp) has been smaller than the qemu vga memory (8MB) and the checking\nfor VBE_DISPI_MAX_XRES + VBE_DISPI_MAX_YRES + VBE_DISPI_MAX_BPP was ok.\n\nSome of the holes have been there forever, such as\nVBE_DISPI_INDEX_X_OFFSET and VBE_DISPI_INDEX_Y_OFFSET register writes\nlacking any verification.\n\nSecurity impact:\n\n(1) Guest can make the ui (gtk\/vnc\/...) use memory rages outside the vga\nframe buffer as source  ->  host memory leak.  Memory isn't leaked to\nthe guest but to the vnc client though.\n\n(2) Qemu will segfault in case the memory range happens to include\nunmapped areas  ->  Guest can DoS itself.\n\nThe guest can not modify host memory, so I don't think this can be used\nby the guest to escape.\n\nCVE-2014-3615\n\nCc: qemu-stable@nongnu.org\nCc: secalert@redhat.com\nSigned-off-by: Gerd Hoffmann <kraxel@redhat.com>\nReviewed-by: Laszlo Ersek <lersek@redhat.com>\n---\n hw\/display\/vga.c | 154 ++++++++++++++++++++++++++++++++++---------------------\n 1 file changed, 95 insertions(+), 59 deletions(-)\n\n","diff_code":"diff --git a\/hw\/display\/vga.c b\/hw\/display\/vga.c\nindex 99251d7..62e6243 100644\n--- a\/hw\/display\/vga.c\n+++ b\/hw\/display\/vga.c\n@@ -576,6 +576,93 @@ void vga_ioport_write(void *opaque, uint32_t addr, uint32_t val)\n     }\n }\n \n+\/*\n+ * Sanity check vbe register writes.\n+ *\n+ * As we don't have a way to signal errors to the guest in the bochs\n+ * dispi interface we'll go adjust the registers to the closest valid\n+ * value.\n+ *\/\n+static void vbe_fixup_regs(VGACommonState *s)\n+{\n+    uint16_t *r = s->vbe_regs;\n+    uint32_t bits, linelength, maxy, offset;\n+\n+    if (!(r[VBE_DISPI_INDEX_ENABLE] & VBE_DISPI_ENABLED)) {\n+        \/* vbe is turned off -- nothing to do *\/\n+        return;\n+    }\n+\n+    \/* check depth *\/\n+    switch (r[VBE_DISPI_INDEX_BPP]) {\n+    case 4:\n+    case 8:\n+    case 16:\n+    case 24:\n+    case 32:\n+        bits = r[VBE_DISPI_INDEX_BPP];\n+        break;\n+    case 15:\n+        bits = 16;\n+        break;\n+    default:\n+        bits = r[VBE_DISPI_INDEX_BPP] = 8;\n+        break;\n+    }\n+\n+    \/* check width *\/\n+    r[VBE_DISPI_INDEX_XRES] &= ~7u;\n+    if (r[VBE_DISPI_INDEX_XRES] == 0) {\n+        r[VBE_DISPI_INDEX_XRES] = 8;\n+    }\n+    if (r[VBE_DISPI_INDEX_XRES] > VBE_DISPI_MAX_XRES) {\n+        r[VBE_DISPI_INDEX_XRES] = VBE_DISPI_MAX_XRES;\n+    }\n+    r[VBE_DISPI_INDEX_VIRT_WIDTH] &= ~7u;\n+    if (r[VBE_DISPI_INDEX_VIRT_WIDTH] > VBE_DISPI_MAX_XRES) {\n+        r[VBE_DISPI_INDEX_VIRT_WIDTH] = VBE_DISPI_MAX_XRES;\n+    }\n+    if (r[VBE_DISPI_INDEX_VIRT_WIDTH] < r[VBE_DISPI_INDEX_XRES]) {\n+        r[VBE_DISPI_INDEX_VIRT_WIDTH] = r[VBE_DISPI_INDEX_XRES];\n+    }\n+\n+    \/* check height *\/\n+    linelength = r[VBE_DISPI_INDEX_VIRT_WIDTH] * bits \/ 8;\n+    maxy = s->vbe_size \/ linelength;\n+    if (r[VBE_DISPI_INDEX_YRES] == 0) {\n+        r[VBE_DISPI_INDEX_YRES] = 1;\n+    }\n+    if (r[VBE_DISPI_INDEX_YRES] > VBE_DISPI_MAX_YRES) {\n+        r[VBE_DISPI_INDEX_YRES] = VBE_DISPI_MAX_YRES;\n+    }\n+    if (r[VBE_DISPI_INDEX_YRES] > maxy) {\n+        r[VBE_DISPI_INDEX_YRES] = maxy;\n+    }\n+\n+    \/* check offset *\/\n+    if (r[VBE_DISPI_INDEX_X_OFFSET] > VBE_DISPI_MAX_XRES) {\n+        r[VBE_DISPI_INDEX_X_OFFSET] = VBE_DISPI_MAX_XRES;\n+    }\n+    if (r[VBE_DISPI_INDEX_Y_OFFSET] > VBE_DISPI_MAX_YRES) {\n+        r[VBE_DISPI_INDEX_Y_OFFSET] = VBE_DISPI_MAX_YRES;\n+    }\n+    offset = r[VBE_DISPI_INDEX_X_OFFSET] * bits \/ 8;\n+    offset += r[VBE_DISPI_INDEX_Y_OFFSET] * linelength;\n+    if (offset + r[VBE_DISPI_INDEX_YRES] * linelength > s->vbe_size) {\n+        r[VBE_DISPI_INDEX_Y_OFFSET] = 0;\n+        offset = r[VBE_DISPI_INDEX_X_OFFSET] * bits \/ 8;\n+        if (offset + r[VBE_DISPI_INDEX_YRES] * linelength > s->vbe_size) {\n+            r[VBE_DISPI_INDEX_X_OFFSET] = 0;\n+            offset = 0;\n+        }\n+    }\n+\n+    \/* update vga state *\/\n+    r[VBE_DISPI_INDEX_VIRT_HEIGHT] = maxy;\n+    s->vbe_line_offset = linelength;\n+    s->vbe_start_addr  = offset \/ 4;\n+}\n+\n static uint32_t vbe_ioport_read_index(void *opaque, uint32_t addr)\n {\n     VGACommonState *s = opaque;\n@@ -645,22 +732,13 @@ void vbe_ioport_write_data(void *opaque, uint32_t addr, uint32_t val)\n             }\n             break;\n         case VBE_DISPI_INDEX_XRES:\n-            if ((val <= VBE_DISPI_MAX_XRES) && ((val & 7) == 0)) {\n-                s->vbe_regs[s->vbe_index] = val;\n-            }\n-            break;\n         case VBE_DISPI_INDEX_YRES:\n-            if (val <= VBE_DISPI_MAX_YRES) {\n-                s->vbe_regs[s->vbe_index] = val;\n-            }\n-            break;\n         case VBE_DISPI_INDEX_BPP:\n-            if (val == 0)\n-                val = 8;\n-            if (val == 4 || val == 8 || val == 15 ||\n-                val == 16 || val == 24 || val == 32) {\n-                s->vbe_regs[s->vbe_index] = val;\n-            }\n+        case VBE_DISPI_INDEX_VIRT_WIDTH:\n+        case VBE_DISPI_INDEX_X_OFFSET:\n+        case VBE_DISPI_INDEX_Y_OFFSET:\n+            s->vbe_regs[s->vbe_index] = val;\n+            vbe_fixup_regs(s);\n             break;\n         case VBE_DISPI_INDEX_BANK:\n             if (s->vbe_regs[VBE_DISPI_INDEX_BPP] == 4) {\n@@ -677,19 +755,11 @@ void vbe_ioport_write_data(void *opaque, uint32_t addr, uint32_t val)\n                 !(s->vbe_regs[VBE_DISPI_INDEX_ENABLE] & VBE_DISPI_ENABLED)) {\n                 int h, shift_control;\n \n-                s->vbe_regs[VBE_DISPI_INDEX_VIRT_WIDTH] =\n-                    s->vbe_regs[VBE_DISPI_INDEX_XRES];\n-                s->vbe_regs[VBE_DISPI_INDEX_VIRT_HEIGHT] =\n-                    s->vbe_regs[VBE_DISPI_INDEX_YRES];\n+                s->vbe_regs[VBE_DISPI_INDEX_VIRT_WIDTH] = 0;\n                 s->vbe_regs[VBE_DISPI_INDEX_X_OFFSET] = 0;\n                 s->vbe_regs[VBE_DISPI_INDEX_Y_OFFSET] = 0;\n-\n-                if (s->vbe_regs[VBE_DISPI_INDEX_BPP] == 4)\n-                    s->vbe_line_offset = s->vbe_regs[VBE_DISPI_INDEX_XRES] >> 1;\n-                else\n-                    s->vbe_line_offset = s->vbe_regs[VBE_DISPI_INDEX_XRES] *\n-                        ((s->vbe_regs[VBE_DISPI_INDEX_BPP] + 7) >> 3);\n-                s->vbe_start_addr = 0;\n+                s->vbe_regs[VBE_DISPI_INDEX_ENABLE] |= VBE_DISPI_ENABLED;\n+                vbe_fixup_regs(s);\n \n                 \/* clear the screen (should be done in BIOS) *\/\n                 if (!(val & VBE_DISPI_NOCLEARMEM)) {\n@@ -738,40 +808,6 @@ void vbe_ioport_write_data(void *opaque, uint32_t addr, uint32_t val)\n             s->vbe_regs[s->vbe_index] = val;\n             vga_update_memory_access(s);\n             break;\n-        case VBE_DISPI_INDEX_VIRT_WIDTH:\n-            {\n-                int w, h, line_offset;\n-\n-                if (val < s->vbe_regs[VBE_DISPI_INDEX_XRES])\n-                    return;\n-                w = val;\n-                if (s->vbe_regs[VBE_DISPI_INDEX_BPP] == 4)\n-                    line_offset = w >> 1;\n-                else\n-                    line_offset = w * ((s->vbe_regs[VBE_DISPI_INDEX_BPP] + 7) >> 3);\n-                h = s->vbe_size \/ line_offset;\n-                \/* XXX: support weird bochs semantics ? *\/\n-                if (h < s->vbe_regs[VBE_DISPI_INDEX_YRES])\n-                    return;\n-                s->vbe_regs[VBE_DISPI_INDEX_VIRT_WIDTH] = w;\n-                s->vbe_regs[VBE_DISPI_INDEX_VIRT_HEIGHT] = h;\n-                s->vbe_line_offset = line_offset;\n-            }\n-            break;\n-        case VBE_DISPI_INDEX_X_OFFSET:\n-        case VBE_DISPI_INDEX_Y_OFFSET:\n-            {\n-                int x;\n-                s->vbe_regs[s->vbe_index] = val;\n-                s->vbe_start_addr = s->vbe_line_offset * s->vbe_regs[VBE_DISPI_INDEX_Y_OFFSET];\n-                x = s->vbe_regs[VBE_DISPI_INDEX_X_OFFSET];\n-                if (s->vbe_regs[VBE_DISPI_INDEX_BPP] == 4)\n-                    s->vbe_start_addr += x >> 1;\n-                else\n-                    s->vbe_start_addr += x * ((s->vbe_regs[VBE_DISPI_INDEX_BPP] + 7) >> 3);\n-                s->vbe_start_addr >>= 2;\n-            }\n-            break;\n         default:\n             break;\n         }\n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2014-3508","CWE_ID":"200","category":"security","commit_id":"0042fb5fd1c9d257d713b15a1f45da05cf5c1c87","commit_message":"From 0042fb5fd1c9d257d713b15a1f45da05cf5c1c87 Mon Sep 17 00:00:00 2001\nFrom: Emilia Kasper <emilia@openssl.org>\nDate: Wed, 2 Jul 2014 19:02:33 +0200\nSubject: [PATCH] Fix OID handling:\n\n- Upon parsing, reject OIDs with invalid base-128 encoding.\n- Always NUL-terminate the destination buffer in OBJ_obj2txt printing function.\n\nCVE-2014-3508\n\nReviewed-by: Dr. Stephen Henson <steve@openssl.org>\nReviewed-by: Kurt Roeckx <kurt@openssl.org>\nReviewed-by: Tim Hudson <tjh@openssl.org>\n---\n crypto\/asn1\/a_object.c   | 30 +++++++++++++++++++++---------\n crypto\/objects\/obj_dat.c | 16 +++++++++-------\n 2 files changed, 30 insertions(+), 16 deletions(-)\n\n","diff_code":"diff --git a\/crypto\/asn1\/a_object.c b\/crypto\/asn1\/a_object.c\nindex ca73a281f5..84db02551e 100644\n--- a\/crypto\/asn1\/a_object.c\n+++ b\/crypto\/asn1\/a_object.c\n@@ -287,17 +287,29 @@ err:\n \tASN1err(ASN1_F_D2I_ASN1_OBJECT,i);\n \treturn(NULL);\n }\n+\n ASN1_OBJECT *c2i_ASN1_OBJECT(ASN1_OBJECT **a, const unsigned char **pp,\n \t     long len)\n \t{\n \tASN1_OBJECT *ret=NULL;\n \tconst unsigned char *p;\n \tunsigned char *data;\n-\tint i;\n-\t\/* Sanity check OID encoding: can't have leading 0x80 in\n-\t * subidentifiers, see: X.690 8.19.2\n+\tint i, length;\n+\n+\t\/* Sanity check OID encoding.\n+\t * Need at least one content octet.\n+\t * MSB must be clear in the last octet.\n+\t * can't have leading 0x80 in subidentifiers, see: X.690 8.19.2\n \t *\/\n-\tfor (i = 0, p = *pp; i < len; i++, p++)\n+\tif (len <= 0 || len > INT_MAX || pp == NULL || (p = *pp) == NULL ||\n+\t    p[len - 1] & 0x80)\n+\t\t{\n+\t\tASN1err(ASN1_F_C2I_ASN1_OBJECT,ASN1_R_INVALID_OBJECT_ENCODING);\n+\t\treturn NULL;\n+\t\t}\n+\t\/* Now 0 < len <= INT_MAX, so the cast is safe. *\/\n+\tlength = (int)len;\n+\tfor (i = 0; i < length; i++, p++)\n \t\t{\n \t\tif (*p == 0x80 && (!i || !(p[-1] & 0x80)))\n \t\t\t{\n@@ -320,23 +332,23 @@ ASN1_OBJECT *c2i_ASN1_OBJECT(ASN1_OBJECT **a, const unsigned char **pp,\n \tdata = (unsigned char *)ret->data;\n \tret->data = NULL;\n \t\/* once detached we can change it *\/\n-\tif ((data == NULL) || (ret->length < len))\n+\tif ((data == NULL) || (ret->length < length))\n \t\t{\n \t\tret->length=0;\n \t\tif (data != NULL) OPENSSL_free(data);\n-\t\tdata=(unsigned char *)OPENSSL_malloc(len ? (int)len : 1);\n+\t\tdata=(unsigned char *)OPENSSL_malloc(length);\n \t\tif (data == NULL)\n \t\t\t{ i=ERR_R_MALLOC_FAILURE; goto err; }\n \t\tret->flags|=ASN1_OBJECT_FLAG_DYNAMIC_DATA;\n \t\t}\n-\tmemcpy(data,p,(int)len);\n+\tmemcpy(data,p,length);\n \t\/* reattach data to object, after which it remains const *\/\n \tret->data  =data;\n-\tret->length=(int)len;\n+\tret->length=length;\n \tret->sn=NULL;\n \tret->ln=NULL;\n \t\/* ret->flags=ASN1_OBJECT_FLAG_DYNAMIC; we know it is dynamic *\/\n-\tp+=len;\n+\tp+=length;\n \n \tif (a != NULL) (*a)=ret;\n \t*pp=p;\ndiff --git a\/crypto\/objects\/obj_dat.c b\/crypto\/objects\/obj_dat.c\nindex e515160d72..bf89bc7b16 100644\n--- a\/crypto\/objects\/obj_dat.c\n+++ b\/crypto\/objects\/obj_dat.c\n@@ -471,11 +471,12 @@ int OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name)\n \tconst unsigned char *p;\n \tchar tbuf[DECIMAL_SIZE(i)+DECIMAL_SIZE(l)+2];\n \n-\tif ((a == NULL) || (a->data == NULL)) {\n-\t\tbuf[0]='\\0';\n-\t\treturn(0);\n-\t}\n+\t\/* Ensure that, at every state, |buf| is NUL-terminated. *\/\n+\tif (buf && buf_len > 0)\n+\t\tbuf[0] = '\\0';\n \n+\tif ((a == NULL) || (a->data == NULL))\n+\t\treturn(0);\n \n \tif (!no_name && (nid=OBJ_obj2nid(a)) != NID_undef)\n \t\t{\n@@ -554,9 +555,10 @@ int OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name)\n \t\t\t\ti=(int)(l\/40);\n \t\t\t\tl-=(long)(i*40);\n \t\t\t\t}\n-\t\t\tif (buf && (buf_len > 0))\n+\t\t\tif (buf && (buf_len > 1))\n \t\t\t\t{\n \t\t\t\t*buf++ = i + '0';\n+\t\t\t\t*buf = '\\0';\n \t\t\t\tbuf_len--;\n \t\t\t\t}\n \t\t\tn++;\n@@ -571,9 +573,10 @@ int OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name)\n \t\t\ti = strlen(bndec);\n \t\t\tif (buf)\n \t\t\t\t{\n-\t\t\t\tif (buf_len > 0)\n+\t\t\t\tif (buf_len > 1)\n \t\t\t\t\t{\n \t\t\t\t\t*buf++ = '.';\n+\t\t\t\t\t*buf = '\\0';\n \t\t\t\t\tbuf_len--;\n \t\t\t\t\t}\n \t\t\t\tBUF_strlcpy(buf,bndec,buf_len);\n@@ -807,4 +810,3 @@ err:\n \tOPENSSL_free(buf);\n \treturn(ok);\n \t}\n-\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2013-3226","CWE_ID":"200","category":"security","commit_id":"c8c499175f7d295ef867335bceb9a76a2c3cdc38","commit_message":"From c8c499175f7d295ef867335bceb9a76a2c3cdc38 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:51 +0000\nSubject: Bluetooth: SCO - Fix missing msg_namelen update in sco_sock_recvmsg()\n\nIf the socket is in state BT_CONNECT2 and BT_SK_DEFER_SETUP is set in\nthe flags, sco_sock_recvmsg() returns early with 0 without updating the\npossibly set msg_namelen member. This, in turn, leads to a 128 byte\nkernel stack leak in net\/socket.c.\n\nFix this by updating msg_namelen in this case. For all other cases it\nwill be handled in bt_sock_recvmsg().\n\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Gustavo Padovan <gustavo@padovan.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/bluetooth\/sco.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/bluetooth\/sco.c b\/net\/bluetooth\/sco.c\nindex fad0302bdb32..fb6192c9812e 100644\n--- a\/net\/bluetooth\/sco.c\n+++ b\/net\/bluetooth\/sco.c\n@@ -665,6 +665,7 @@ static int sco_sock_recvmsg(struct kiocb *iocb, struct socket *sock,\n \t    test_bit(BT_SK_DEFER_SETUP, &bt_sk(sk)->flags)) {\n \t\thci_conn_accept(pi->conn->hcon, 0);\n \t\tsk->sk_state = BT_CONFIG;\n+\t\tmsg->msg_namelen = 0;\n \n \t\trelease_sock(sk);\n \t\treturn 0;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-1928","CWE_ID":"200","category":"security","commit_id":"12176503366885edd542389eed3aaf94be163fdb","commit_message":"From 12176503366885edd542389eed3aaf94be163fdb Mon Sep 17 00:00:00 2001\nFrom: Kees Cook <keescook@chromium.org>\nDate: Thu, 25 Oct 2012 13:38:16 -0700\nSubject: fs\/compat_ioctl.c: VIDEO_SET_SPU_PALETTE missing error check\n\nThe compat ioctl for VIDEO_SET_SPU_PALETTE was missing an error check\nwhile converting ioctl arguments.  This could lead to leaking kernel\nstack contents into userspace.\n\nPatch extracted from existing fix in grsecurity.\n\nSigned-off-by: Kees Cook <keescook@chromium.org>\nCc: David Miller <davem@davemloft.net>\nCc: Brad Spengler <spender@grsecurity.net>\nCc: PaX Team <pageexec@freemail.hu>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n fs\/compat_ioctl.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/fs\/compat_ioctl.c b\/fs\/compat_ioctl.c\nindex f5054025f9da..4c6285fff598 100644\n--- a\/fs\/compat_ioctl.c\n+++ b\/fs\/compat_ioctl.c\n@@ -210,6 +210,8 @@ static int do_video_set_spu_palette(unsigned int fd, unsigned int cmd,\n \n \terr  = get_user(palp, &up->palette);\n \terr |= get_user(length, &up->length);\n+\tif (err)\n+\t\treturn -EFAULT;\n \n \tup_native = compat_alloc_user_space(sizeof(struct video_spu_palette));\n \terr  = put_user(compat_ptr(palp), &up_native->palette);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2014-3615","CWE_ID":"200","category":"security","commit_id":"ab9509cceabef28071e41bdfa073083859c949a7","commit_message":"From ab9509cceabef28071e41bdfa073083859c949a7 Mon Sep 17 00:00:00 2001\nFrom: Gerd Hoffmann <kraxel@redhat.com>\nDate: Wed, 3 Sep 2014 15:50:08 +0200\nSubject: [PATCH] spice: make sure we don't overflow ssd->buf\n\nRelated spice-only bug.  We have a fixed 16 MB buffer here, being\npresented to the spice-server as qxl video memory in case spice is\nused with a non-qxl card.  It's also used with qxl in vga mode.\n\nWhen using display resolutions requiring more than 16 MB of memory we\nare going to overflow that buffer.  In theory the guest can write,\nindirectly via spice-server.  The spice-server clears the memory after\nsetting a new video mode though, triggering a segfault in the overflow\ncase, so qemu crashes before the guest has a chance to do something\nevil.\n\nFix that by switching to dynamic allocation for the buffer.\n\nCVE-2014-3615\n\nCc: qemu-stable@nongnu.org\nCc: secalert@redhat.com\nSigned-off-by: Gerd Hoffmann <kraxel@redhat.com>\nReviewed-by: Laszlo Ersek <lersek@redhat.com>\n---\n ui\/spice-display.c | 20 +++++++++++++++-----\n 1 file changed, 15 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/ui\/spice-display.c b\/ui\/spice-display.c\nindex 66e2578..def7b52 100644\n--- a\/ui\/spice-display.c\n+++ b\/ui\/spice-display.c\n@@ -334,11 +334,23 @@ void qemu_spice_create_host_memslot(SimpleSpiceDisplay *ssd)\n void qemu_spice_create_host_primary(SimpleSpiceDisplay *ssd)\n {\n     QXLDevSurfaceCreate surface;\n+    uint64_t surface_size;\n \n     memset(&surface, 0, sizeof(surface));\n \n-    dprint(1, \"%s\/%d: %dx%d\\n\", __func__, ssd->qxl.id,\n-           surface_width(ssd->ds), surface_height(ssd->ds));\n+    surface_size = (uint64_t) surface_width(ssd->ds) *\n+        surface_height(ssd->ds) * 4;\n+    assert(surface_size > 0);\n+    assert(surface_size < INT_MAX);\n+    if (ssd->bufsize < surface_size) {\n+        ssd->bufsize = surface_size;\n+        g_free(ssd->buf);\n+        ssd->buf = g_malloc(ssd->bufsize);\n+    }\n+\n+    dprint(1, \"%s\/%d: %ux%u (size %\" PRIu64 \"\/%d)\\n\", __func__, ssd->qxl.id,\n+           surface_width(ssd->ds), surface_height(ssd->ds),\n+           surface_size, ssd->bufsize);\n \n     surface.format     = SPICE_SURFACE_FMT_32_xRGB;\n     surface.width      = surface_width(ssd->ds);\n@@ -369,8 +381,6 @@ void qemu_spice_display_init_common(SimpleSpiceDisplay *ssd)\n     if (ssd->num_surfaces == 0) {\n         ssd->num_surfaces = 1024;\n     }\n-    ssd->bufsize = (16 * 1024 * 1024);\n-    ssd->buf = g_malloc(ssd->bufsize);\n }\n \n \/* display listener callbacks *\/\n@@ -495,7 +505,7 @@ static void interface_get_init_info(QXLInstance *sin, QXLDevInitInfo *info)\n     info->num_memslots = NUM_MEMSLOTS;\n     info->num_memslots_groups = NUM_MEMSLOTS_GROUPS;\n     info->internal_groupslot_id = 0;\n-    info->qxl_ram_size = ssd->bufsize;\n+    info->qxl_ram_size = 16 * 1024 * 1024;\n     info->n_surfaces = ssd->num_surfaces;\n }\n \n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-2107","CWE_ID":"200","category":"security","commit_id":"68595c0c2886e7942a14f98c17a55a88afb6c292","commit_message":"From 68595c0c2886e7942a14f98c17a55a88afb6c292 Mon Sep 17 00:00:00 2001\nFrom: Kurt Roeckx <kurt@roeckx.be>\nDate: Sat, 16 Apr 2016 23:08:56 +0200\nSubject: [PATCH] Check that we have enough padding characters.\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=utf8\nContent-Transfer-Encoding: 8bit\n\nReviewed-by: Emilia K\u00c3\u00a4sper <emilia@openssl.org>\n\nCVE-2016-2107\n\nMR: #2572\n---\n crypto\/evp\/e_aes_cbc_hmac_sha1.c   | 3 +++\n crypto\/evp\/e_aes_cbc_hmac_sha256.c | 3 +++\n 2 files changed, 6 insertions(+)\n\n","diff_code":"diff --git a\/crypto\/evp\/e_aes_cbc_hmac_sha1.c b\/crypto\/evp\/e_aes_cbc_hmac_sha1.c\nindex 8330964ee1..6dfd590a4a 100644\n--- a\/crypto\/evp\/e_aes_cbc_hmac_sha1.c\n+++ b\/crypto\/evp\/e_aes_cbc_hmac_sha1.c\n@@ -60,6 +60,7 @@\n # include <openssl\/sha.h>\n # include <openssl\/rand.h>\n # include \"modes_lcl.h\"\n+# include \"constant_time_locl.h\"\n \n # ifndef EVP_CIPH_FLAG_AEAD_CIPHER\n #  define EVP_CIPH_FLAG_AEAD_CIPHER       0x200000\n@@ -578,6 +579,8 @@ static int aesni_cbc_hmac_sha1_cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,\n             maxpad |= (255 - maxpad) >> (sizeof(maxpad) * 8 - 8);\n             maxpad &= 255;\n \n+            ret &= constant_time_ge(maxpad, pad);\n+\n             inp_len = len - (SHA_DIGEST_LENGTH + pad + 1);\n             mask = (0 - ((inp_len - len) >> (sizeof(inp_len) * 8 - 1)));\n             inp_len &= mask;\ndiff --git a\/crypto\/evp\/e_aes_cbc_hmac_sha256.c b\/crypto\/evp\/e_aes_cbc_hmac_sha256.c\nindex 37800213c7..46c9d03389 100644\n--- a\/crypto\/evp\/e_aes_cbc_hmac_sha256.c\n+++ b\/crypto\/evp\/e_aes_cbc_hmac_sha256.c\n@@ -60,6 +60,7 @@\n # include <openssl\/sha.h>\n # include <openssl\/rand.h>\n # include \"modes_lcl.h\"\n+# include \"constant_time_locl.h\"\n \n # ifndef EVP_CIPH_FLAG_AEAD_CIPHER\n #  define EVP_CIPH_FLAG_AEAD_CIPHER       0x200000\n@@ -589,6 +590,8 @@ static int aesni_cbc_hmac_sha256_cipher(EVP_CIPHER_CTX *ctx,\n             maxpad |= (255 - maxpad) >> (sizeof(maxpad) * 8 - 8);\n             maxpad &= 255;\n \n+            ret &= constant_time_ge(maxpad, pad);\n+\n             inp_len = len - (SHA256_DIGEST_LENGTH + pad + 1);\n             mask = (0 - ((inp_len - len) >> (sizeof(inp_len) * 8 - 1)));\n             inp_len &= mask;\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2009-2691","CWE_ID":"200","category":"security","commit_id":"00f89d218523b9bf6b522349c039d5ac80aa536d","commit_message":"From 00f89d218523b9bf6b522349c039d5ac80aa536d Mon Sep 17 00:00:00 2001\nFrom: Oleg Nesterov <oleg@redhat.com>\nDate: Fri, 10 Jul 2009 03:27:38 +0200\nSubject: mm_for_maps: shift down_read(mmap_sem) to the caller\n\nmm_for_maps() takes ->mmap_sem after security checks, this looks\nstrange and obfuscates the locking rules. Move this lock to its\nsingle caller, m_start().\n\nSigned-off-by: Oleg Nesterov <oleg@redhat.com>\nAcked-by: Serge Hallyn <serue@us.ibm.com>\nSigned-off-by: James Morris <jmorris@namei.org>\n---\n fs\/proc\/base.c       | 8 +++-----\n fs\/proc\/task_mmu.c   | 1 +\n fs\/proc\/task_nommu.c | 1 +\n 3 files changed, 5 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/fs\/proc\/base.c b\/fs\/proc\/base.c\nindex 917f338a6739..f3c2e4085fed 100644\n--- a\/fs\/proc\/base.c\n+++ b\/fs\/proc\/base.c\n@@ -235,9 +235,8 @@ static int check_mem_permission(struct task_struct *task)\n struct mm_struct *mm_for_maps(struct task_struct *task)\n {\n \tstruct mm_struct *mm = get_task_mm(task);\n-\tif (!mm)\n-\t\treturn NULL;\n-\tif (mm != current->mm) {\n+\n+\tif (mm && mm != current->mm) {\n \t\t\/*\n \t\t * task->mm can be changed before security check,\n \t\t * in that case we must notice the change after.\n@@ -245,10 +244,9 @@ struct mm_struct *mm_for_maps(struct task_struct *task)\n \t\tif (!ptrace_may_access(task, PTRACE_MODE_READ) ||\n \t\t    mm != task->mm) {\n \t\t\tmmput(mm);\n-\t\t\treturn NULL;\n+\t\t\tmm = NULL;\n \t\t}\n \t}\n-\tdown_read(&mm->mmap_sem);\n \treturn mm;\n }\n \ndiff --git a\/fs\/proc\/task_mmu.c b\/fs\/proc\/task_mmu.c\nindex 6f61b7cc32e0..9bd8be1d235c 100644\n--- a\/fs\/proc\/task_mmu.c\n+++ b\/fs\/proc\/task_mmu.c\n@@ -119,6 +119,7 @@ static void *m_start(struct seq_file *m, loff_t *pos)\n \tmm = mm_for_maps(priv->task);\n \tif (!mm)\n \t\treturn NULL;\n+\tdown_read(&mm->mmap_sem);\n \n \ttail_vma = get_gate_vma(priv->task);\n \tpriv->tail_vma = tail_vma;\ndiff --git a\/fs\/proc\/task_nommu.c b\/fs\/proc\/task_nommu.c\nindex 64a72e2e7650..8f5c05d3dbd3 100644\n--- a\/fs\/proc\/task_nommu.c\n+++ b\/fs\/proc\/task_nommu.c\n@@ -189,6 +189,7 @@ static void *m_start(struct seq_file *m, loff_t *pos)\n \t\tpriv->task = NULL;\n \t\treturn NULL;\n \t}\n+\tdown_read(&mm->mmap_sem);\n \n \t\/* start from the Nth VMA *\/\n \tfor (p = rb_first(&mm->mm_rb); p; p = rb_next(p))\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2009-3002","CWE_ID":"200","category":"security","commit_id":"e84b90ae5eb3c112d1f208964df1d8156a538289","commit_message":"From e84b90ae5eb3c112d1f208964df1d8156a538289 Mon Sep 17 00:00:00 2001\nFrom: Eric Dumazet <eric.dumazet@gmail.com>\nDate: Thu, 6 Aug 2009 20:27:04 +0000\nSubject: can: Fix raw_getname() leak\n\nraw_getname() can leak 10 bytes of kernel memory to user\n\n(two bytes hole between can_family and can_ifindex,\n8 bytes at the end of sockaddr_can structure)\n\nSigned-off-by: Eric Dumazet <eric.dumazet@gmail.com>\nAcked-by: Oliver Hartkopp <oliver@hartkopp.net>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/can\/raw.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/can\/raw.c b\/net\/can\/raw.c\nindex f4cc44548bda..db3152df7d2b 100644\n--- a\/net\/can\/raw.c\n+++ b\/net\/can\/raw.c\n@@ -401,6 +401,7 @@ static int raw_getname(struct socket *sock, struct sockaddr *uaddr,\n \tif (peer)\n \t\treturn -EOPNOTSUPP;\n \n+\tmemset(addr, 0, sizeof(*addr));\n \taddr->can_family  = AF_CAN;\n \taddr->can_ifindex = ro->ifindex;\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-9098","CWE_ID":"200","category":"security","commit_id":"1c358ffe0049f768dd49a8a889c1cbf99ac9849b","commit_message":"From 1c358ffe0049f768dd49a8a889c1cbf99ac9849b Mon Sep 17 00:00:00 2001\nFrom: Cristy <urban-warrior@imagemagick.org>\nDate: Thu, 9 Mar 2017 07:27:42 -0500\nSubject: [PATCH] Reset memory for RLE decoder (patch provided by scarybeasts)\n\n---\n coders\/rle.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/coders\/rle.c b\/coders\/rle.c\nindex 6e27f41f15..2318901ec4 100644\n--- a\/coders\/rle.c\n+++ b\/coders\/rle.c\n@@ -328,6 +328,7 @@ static Image *ReadRLEImage(const ImageInfo *image_info,ExceptionInfo *exception)\n     pixel_info_length=image->columns*image->rows*\n       MagickMax(number_planes_filled,4);\n     pixels=(unsigned char *) GetVirtualMemoryBlob(pixel_info);\n+    (void) ResetMagickMemory(pixels,0,pixel_info_length);\n     if ((flags & 0x01) && !(flags & 0x02))\n       {\n         ssize_t\n","owner":"ImageMagick","repo":"ImageMagick","source":"cve"},{"CVE_ID":"CVE-2013-3235","CWE_ID":"200","category":"security","commit_id":"60085c3d009b0df252547adb336d1ccca5ce52ec","commit_message":"From 60085c3d009b0df252547adb336d1ccca5ce52ec Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:52:00 +0000\nSubject: [PATCH] tipc: fix info leaks via msg_name in recv_msg\/recv_stream\n\nThe code in set_orig_addr() does not initialize all of the members of\nstruct sockaddr_tipc when filling the sockaddr info -- namely the union\nis only partly filled. This will make recv_msg() and recv_stream() --\nthe only users of this function -- leak kernel stack memory as the\nmsg_name member is a local variable in net\/socket.c.\n\nAdditionally to that both recv_msg() and recv_stream() fail to update\nthe msg_namelen member to 0 while otherwise returning with 0, i.e.\n\"success\". This is the case for, e.g., non-blocking sockets. This will\nlead to a 128 byte kernel stack leak in net\/socket.c.\n\nFix the first issue by initializing the memory of the union with\nmemset(0). Fix the second one by setting msg_namelen to 0 early as it\nwill be updated later if we're going to fill the msg_name member.\n\nCc: Jon Maloy <jon.maloy@ericsson.com>\nCc: Allan Stephens <allan.stephens@windriver.com>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/tipc\/socket.c | 7 +++++++\n 1 file changed, 7 insertions(+)\n\n","diff_code":"diff --git a\/net\/tipc\/socket.c b\/net\/tipc\/socket.c\nindex a9622b6cd9168..515ce38e4f4c7 100644\n--- a\/net\/tipc\/socket.c\n+++ b\/net\/tipc\/socket.c\n@@ -790,6 +790,7 @@ static void set_orig_addr(struct msghdr *m, struct tipc_msg *msg)\n \tif (addr) {\n \t\taddr->family = AF_TIPC;\n \t\taddr->addrtype = TIPC_ADDR_ID;\n+\t\tmemset(&addr->addr, 0, sizeof(addr->addr));\n \t\taddr->addr.id.ref = msg_origport(msg);\n \t\taddr->addr.id.node = msg_orignode(msg);\n \t\taddr->addr.name.domain = 0;\t\/* could leave uninitialized *\/\n@@ -904,6 +905,9 @@ static int recv_msg(struct kiocb *iocb, struct socket *sock,\n \t\tgoto exit;\n \t}\n \n+\t\/* will be updated in set_orig_addr() if needed *\/\n+\tm->msg_namelen = 0;\n+\n \ttimeout = sock_rcvtimeo(sk, flags & MSG_DONTWAIT);\n restart:\n \n@@ -1013,6 +1017,9 @@ static int recv_stream(struct kiocb *iocb, struct socket *sock,\n \t\tgoto exit;\n \t}\n \n+\t\/* will be updated in set_orig_addr() if needed *\/\n+\tm->msg_namelen = 0;\n+\n \ttarget = sock_rcvlowat(sk, flags & MSG_WAITALL, buf_len);\n \ttimeout = sock_rcvtimeo(sk, flags & MSG_DONTWAIT);\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2018-18710","CWE_ID":"200","category":"security","commit_id":"e4f3aa2e1e67bb48dfbaaf1cad59013d5a5bc276","commit_message":"From e4f3aa2e1e67bb48dfbaaf1cad59013d5a5bc276 Mon Sep 17 00:00:00 2001\nFrom: Young_X <YangX92@hotmail.com>\nDate: Wed, 3 Oct 2018 12:54:29 +0000\nSubject: cdrom: fix improper type cast, which can leat to information leak.\n\nThere is another cast from unsigned long to int which causes\na bounds check to fail with specially crafted input. The value is\nthen used as an index in the slot array in cdrom_slot_status().\n\nThis issue is similar to CVE-2018-16658 and CVE-2018-10940.\n\nSigned-off-by: Young_X <YangX92@hotmail.com>\nSigned-off-by: Jens Axboe <axboe@kernel.dk>\n---\n drivers\/cdrom\/cdrom.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/drivers\/cdrom\/cdrom.c b\/drivers\/cdrom\/cdrom.c\nindex a5d5a96479bf..10802d1fc554 100644\n--- a\/drivers\/cdrom\/cdrom.c\n+++ b\/drivers\/cdrom\/cdrom.c\n@@ -2445,7 +2445,7 @@ static int cdrom_ioctl_select_disc(struct cdrom_device_info *cdi,\n \t\treturn -ENOSYS;\n \n \tif (arg != CDSL_CURRENT && arg != CDSL_NONE) {\n-\t\tif ((int)arg >= cdi->capacity)\n+\t\tif (arg >= cdi->capacity)\n \t\t\treturn -EINVAL;\n \t}\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2019-5489","CWE_ID":"200","category":"security","commit_id":"574823bfab82d9d8fa47f422778043fbb4b4f50e","commit_message":"From 574823bfab82d9d8fa47f422778043fbb4b4f50e Mon Sep 17 00:00:00 2001\nFrom: Linus Torvalds <torvalds@linux-foundation.org>\nDate: Sat, 5 Jan 2019 17:50:59 -0800\nSubject: Change mincore() to count \"mapped\" pages rather than \"cached\" pages\n\nThe semantics of what \"in core\" means for the mincore() system call are\nsomewhat unclear, but Linux has always (since 2.3.52, which is when\nmincore() was initially done) treated it as \"page is available in page\ncache\" rather than \"page is mapped in the mapping\".\n\nThe problem with that traditional semantic is that it exposes a lot of\nsystem cache state that it really probably shouldn't, and that users\nshouldn't really even care about.\n\nSo let's try to avoid that information leak by simply changing the\nsemantics to be that mincore() counts actual mapped pages, not pages\nthat might be cheaply mapped if they were faulted (note the \"might be\"\npart of the old semantics: being in the cache doesn't actually guarantee\nthat you can access them without IO anyway, since things like network\nfilesystems may have to revalidate the cache before use).\n\nIn many ways the old semantics were somewhat insane even aside from the\ninformation leak issue.  From the very beginning (and that beginning is\na long time ago: 2.3.52 was released in March 2000, I think), the code\nhad a comment saying\n\n  Later we can get more picky about what \"in core\" means precisely.\n\nand this is that \"later\".  Admittedly it is much later than is really\ncomfortable.\n\nNOTE! This is a real semantic change, and it is for example known to\nchange the output of \"fincore\", since that program literally does a\nmmmap without populating it, and then doing \"mincore()\" on that mapping\nthat doesn't actually have any pages in it.\n\nI'm hoping that nobody actually has any workflow that cares, and the\ninfo leak is real.\n\nWe may have to do something different if it turns out that people have\nvalid reasons to want the old semantics, and if we can limit the\ninformation leak sanely.\n\nCc: Kevin Easton <kevin@guarana.org>\nCc: Jiri Kosina <jikos@kernel.org>\nCc: Masatake YAMATO <yamato@redhat.com>\nCc: Andrew Morton <akpm@linux-foundation.org>\nCc: Greg KH <gregkh@linuxfoundation.org>\nCc: Peter Zijlstra <peterz@infradead.org>\nCc: Michal Hocko <mhocko@suse.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n mm\/mincore.c | 94 +++++++++---------------------------------------------------\n 1 file changed, 13 insertions(+), 81 deletions(-)\n\n","diff_code":"diff --git a\/mm\/mincore.c b\/mm\/mincore.c\nindex 218099b5ed31..f0f91461a9f4 100644\n--- a\/mm\/mincore.c\n+++ b\/mm\/mincore.c\n@@ -42,72 +42,14 @@ static int mincore_hugetlb(pte_t *pte, unsigned long hmask, unsigned long addr,\n \treturn 0;\n }\n \n-\/*\n- * Later we can get more picky about what \"in core\" means precisely.\n- * For now, simply check to see if the page is in the page cache,\n- * and is up to date; i.e. that no page-in operation would be required\n- * at this time if an application were to map and access this page.\n- *\/\n-static unsigned char mincore_page(struct address_space *mapping, pgoff_t pgoff)\n-{\n-\tunsigned char present = 0;\n-\tstruct page *page;\n-\n-\t\/*\n-\t * When tmpfs swaps out a page from a file, any process mapping that\n-\t * file will not get a swp_entry_t in its pte, but rather it is like\n-\t * any other file mapping (ie. marked !present and faulted in with\n-\t * tmpfs's .fault). So swapped out tmpfs mappings are tested here.\n-\t *\/\n-#ifdef CONFIG_SWAP\n-\tif (shmem_mapping(mapping)) {\n-\t\tpage = find_get_entry(mapping, pgoff);\n-\t\t\/*\n-\t\t * shmem\/tmpfs may return swap: account for swapcache\n-\t\t * page too.\n-\t\t *\/\n-\t\tif (xa_is_value(page)) {\n-\t\t\tswp_entry_t swp = radix_to_swp_entry(page);\n-\t\t\tpage = find_get_page(swap_address_space(swp),\n-\t\t\t\t\t     swp_offset(swp));\n-\t\t}\n-\t} else\n-\t\tpage = find_get_page(mapping, pgoff);\n-#else\n-\tpage = find_get_page(mapping, pgoff);\n-#endif\n-\tif (page) {\n-\t\tpresent = PageUptodate(page);\n-\t\tput_page(page);\n-\t}\n-\n-\treturn present;\n-}\n-\n-static int __mincore_unmapped_range(unsigned long addr, unsigned long end,\n-\t\t\t\tstruct vm_area_struct *vma, unsigned char *vec)\n-{\n-\tunsigned long nr = (end - addr) >> PAGE_SHIFT;\n-\tint i;\n-\n-\tif (vma->vm_file) {\n-\t\tpgoff_t pgoff;\n-\n-\t\tpgoff = linear_page_index(vma, addr);\n-\t\tfor (i = 0; i < nr; i++, pgoff++)\n-\t\t\tvec[i] = mincore_page(vma->vm_file->f_mapping, pgoff);\n-\t} else {\n-\t\tfor (i = 0; i < nr; i++)\n-\t\t\tvec[i] = 0;\n-\t}\n-\treturn nr;\n-}\n-\n static int mincore_unmapped_range(unsigned long addr, unsigned long end,\n \t\t\t\t   struct mm_walk *walk)\n {\n-\twalk->private += __mincore_unmapped_range(addr, end,\n-\t\t\t\t\t\t  walk->vma, walk->private);\n+\tunsigned char *vec = walk->private;\n+\tunsigned long nr = (end - addr) >> PAGE_SHIFT;\n+\n+\tmemset(vec, 0, nr);\n+\twalk->private += nr;\n \treturn 0;\n }\n \n@@ -127,8 +69,9 @@ static int mincore_pte_range(pmd_t *pmd, unsigned long addr, unsigned long end,\n \t\tgoto out;\n \t}\n \n+\t\/* We'll consider a THP page under construction to be there *\/\n \tif (pmd_trans_unstable(pmd)) {\n-\t\t__mincore_unmapped_range(addr, end, vma, vec);\n+\t\tmemset(vec, 1, nr);\n \t\tgoto out;\n \t}\n \n@@ -137,28 +80,17 @@ static int mincore_pte_range(pmd_t *pmd, unsigned long addr, unsigned long end,\n \t\tpte_t pte = *ptep;\n \n \t\tif (pte_none(pte))\n-\t\t\t__mincore_unmapped_range(addr, addr + PAGE_SIZE,\n-\t\t\t\t\t\t vma, vec);\n+\t\t\t*vec = 0;\n \t\telse if (pte_present(pte))\n \t\t\t*vec = 1;\n \t\telse { \/* pte is a swap entry *\/\n \t\t\tswp_entry_t entry = pte_to_swp_entry(pte);\n \n-\t\t\tif (non_swap_entry(entry)) {\n-\t\t\t\t\/*\n-\t\t\t\t * migration or hwpoison entries are always\n-\t\t\t\t * uptodate\n-\t\t\t\t *\/\n-\t\t\t\t*vec = 1;\n-\t\t\t} else {\n-#ifdef CONFIG_SWAP\n-\t\t\t\t*vec = mincore_page(swap_address_space(entry),\n-\t\t\t\t\t\t    swp_offset(entry));\n-#else\n-\t\t\t\tWARN_ON(1);\n-\t\t\t\t*vec = 1;\n-#endif\n-\t\t\t}\n+\t\t\t\/*\n+\t\t\t * migration or hwpoison entries are always\n+\t\t\t * uptodate\n+\t\t\t *\/\n+\t\t\t*vec = !!non_swap_entry(entry);\n \t\t}\n \t\tvec++;\n \t}\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2010-3877","CWE_ID":"200","category":"security","commit_id":"88f8a5e3e7defccd3925cabb1ee4d3994e5cdb52","commit_message":"From 88f8a5e3e7defccd3925cabb1ee4d3994e5cdb52 Mon Sep 17 00:00:00 2001\nFrom: Kulikov Vasiliy <segooon@gmail.com>\nDate: Sun, 31 Oct 2010 07:10:32 +0000\nSubject: net: tipc: fix information leak to userland\n\nStructure sockaddr_tipc is copied to userland with padding bytes after\n\"id\" field in union field \"name\" unitialized.  It leads to leaking of\ncontents of kernel stack memory.  We have to initialize them to zero.\n\nSigned-off-by: Vasiliy Kulikov <segooon@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/tipc\/socket.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/tipc\/socket.c b\/net\/tipc\/socket.c\nindex 33217fc3d697..e9f0d5004483 100644\n--- a\/net\/tipc\/socket.c\n+++ b\/net\/tipc\/socket.c\n@@ -396,6 +396,7 @@ static int get_name(struct socket *sock, struct sockaddr *uaddr,\n \tstruct sockaddr_tipc *addr = (struct sockaddr_tipc *)uaddr;\n \tstruct tipc_sock *tsock = tipc_sk(sock->sk);\n \n+\tmemset(addr, 0, sizeof(*addr));\n \tif (peer) {\n \t\tif ((sock->state != SS_CONNECTED) &&\n \t\t\t((peer != 2) || (sock->state != SS_DISCONNECTING)))\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2013-3229","CWE_ID":"200","category":"security","commit_id":"a5598bd9c087dc0efc250a5221e5d0e6f584ee88","commit_message":"From a5598bd9c087dc0efc250a5221e5d0e6f584ee88 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:54 +0000\nSubject: [PATCH] iucv: Fix missing msg_namelen update in iucv_sock_recvmsg()\n\nThe current code does not fill the msg_name member in case it is set.\nIt also does not set the msg_namelen member to 0 and therefore makes\nnet\/socket.c leak the local, uninitialized sockaddr_storage variable\nto userland -- 128 bytes of kernel stack memory.\n\nFix that by simply setting msg_namelen to 0 as obviously nobody cared\nabout iucv_sock_recvmsg() not filling the msg_name in case it was set.\n\nCc: Ursula Braun <ursula.braun@de.ibm.com>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/iucv\/af_iucv.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/net\/iucv\/af_iucv.c b\/net\/iucv\/af_iucv.c\nindex a7d11ffe42842..bf69358200019 100644\n--- a\/net\/iucv\/af_iucv.c\n+++ b\/net\/iucv\/af_iucv.c\n@@ -1328,6 +1328,8 @@ static int iucv_sock_recvmsg(struct kiocb *iocb, struct socket *sock,\n \tstruct sk_buff *skb, *rskb, *cskb;\n \tint err = 0;\n \n+\tmsg->msg_namelen = 0;\n+\n \tif ((sk->sk_state == IUCV_DISCONN) &&\n \t    skb_queue_empty(&iucv->backlog_skb_q) &&\n \t    skb_queue_empty(&sk->sk_receive_queue) &&\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-6537","CWE_ID":"200","category":"security","commit_id":"f778a636713a435d3a922c60b1622a91136560c1","commit_message":"From f778a636713a435d3a922c60b1622a91136560c1 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 19 Sep 2012 11:33:39 +0000\nSubject: xfrm_user: fix info leak in copy_to_user_state()\n\nThe memory reserved to dump the xfrm state includes the padding bytes of\nstruct xfrm_usersa_info added by the compiler for alignment (7 for\namd64, 3 for i386). Add an explicit memset(0) before filling the buffer\nto avoid the info leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nAcked-by: Steffen Klassert <steffen.klassert@secunet.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/xfrm\/xfrm_user.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/xfrm\/xfrm_user.c b\/net\/xfrm\/xfrm_user.c\nindex 40dd50d6c4cc..d585459dc8bb 100644\n--- a\/net\/xfrm\/xfrm_user.c\n+++ b\/net\/xfrm\/xfrm_user.c\n@@ -689,6 +689,7 @@ out:\n \n static void copy_to_user_state(struct xfrm_state *x, struct xfrm_usersa_info *p)\n {\n+\tmemset(p, 0, sizeof(*p));\n \tmemcpy(&p->id, &x->id, sizeof(p->id));\n \tmemcpy(&p->sel, &x->sel, sizeof(p->sel));\n \tmemcpy(&p->lft, &x->lft, sizeof(p->lft));\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2018-18073","CWE_ID":"200","category":"security","commit_id":"34cc326eb2c5695833361887fe0b32e8d987741c","commit_message":"From 34cc326eb2c5695833361887fe0b32e8d987741c Mon Sep 17 00:00:00 2001\nFrom: Chris Liddell <chris.liddell@artifex.com>\nDate: Wed, 10 Oct 2018 15:38:10 +0100\nSubject: [PATCH] Bug 699927: don't include operator arrays in execstack output\n\nWhen we transfer the contents of the execution stack into the array, take the\nextra step of replacing any operator arrays on the stack with the operator\nthat reference them.\n\nThis prevents the contents of Postscript defined, internal only operators (those\ncreated with .makeoperator) being exposed via execstack (and thus, via error\nhandling).\n\nThis necessitates a change in the resource remapping 'resource', which contains\na procedure which relies on the contents of the operators arrays being present.\nAs we already had internal-only variants of countexecstack and execstack\n(.countexecstack and .execstack) - using those, and leaving thier operation\nincluding the operator arrays means the procedure continues to work correctly.\n\nBoth .countexecstack and .execstack are undefined after initialization.\n\nAlso, when we store the execstack (or part thereof) for an execstackoverflow\nerror, make the same oparray\/operator substitution as above for execstack.\n---\n Resource\/Init\/gs_init.ps  |  4 ++--\n Resource\/Init\/gs_resmp.ps |  2 +-\n psi\/int.mak               |  2 +-\n psi\/interp.c              | 14 +++++++++++---\n psi\/interp.h              |  2 ++\n psi\/zcontrol.c            | 13 ++++++++++---\n 6 files changed, 27 insertions(+), 10 deletions(-)\n\n","diff_code":"diff --git a\/Resource\/Init\/gs_init.ps b\/Resource\/Init\/gs_init.ps\nindex 521cc65..e1fc6d2 100644\n--- a\/Resource\/Init\/gs_init.ps\n+++ b\/Resource\/Init\/gs_init.ps\n@@ -2215,7 +2215,7 @@ SAFER { .setsafeglobal } if\n   % but can be easily restored (just delete the name from the list in the array). In future\n   % we may remove the operator and the code implementation entirely.\n   [\n-  \/.bitadd \/.charboxpath \/.cond \/.countexecstack \/.execstack \/.runandhide \/.popdevicefilter\n+  \/.bitadd \/.charboxpath \/.cond \/.runandhide \/.popdevicefilter\n   \/.execfile \/.filenamesplit \/.file_name_parent\n   \/.setdefaultmatrix \/.isprocfilter \/.unread \/.psstringencode\n   \/.buildsampledfunction \/.isencapfunction \/.currentaccuratecurves \/.currentcurvejoin \/.currentdashadapt \/.currentdotlength\n@@ -2254,7 +2254,7 @@ SAFER { .setsafeglobal } if\n   \/.localvmarray \/.localvmdict \/.localvmpackedarray \/.localvmstring \/.systemvmarray \/.systemvmdict \/.systemvmpackedarray \/.systemvmstring \/.systemvmfile \/.systemvmlibfile\n   \/.systemvmSFD \/.settrapparams \/.currentsystemparams \/.currentuserparams \/.getsystemparam \/.getuserparam \/.setsystemparams \/.setuserparams\n   \/.checkpassword \/.locale_to_utf8 \/.currentglobal \/.gcheck \/.imagepath \/.currentoutputdevice\n-  \/.type \/.writecvs \/.setSMask \/.currentSMask \/.needinput\n+  \/.type \/.writecvs \/.setSMask \/.currentSMask \/.needinput \/.countexecstack \/.execstack\n \n   % Used by a free user in the Library of Congress. Apparently this is used to\n   % draw a partial page, which is then filled in by the results of a barcode\ndiff --git a\/Resource\/Init\/gs_resmp.ps b\/Resource\/Init\/gs_resmp.ps\nindex 7cacaf8..9bb4263 100644\n--- a\/Resource\/Init\/gs_resmp.ps\n+++ b\/Resource\/Init\/gs_resmp.ps\n@@ -183,7 +183,7 @@ setpacking\n   % We don't check them.\n \n   currentglobal \/\/false setglobal                  % <object> bGlobal\n-  countexecstack array execstack                   % <object> bGlobal [execstack]\n+  \/\/false .countexecstack array \/\/false .execstack % <object> bGlobal [execstack]\n   dup \/\/null exch                                  % <object> bGlobal [execstack] null [execstack]\n   length 3 sub -1 0 {                              % <object> bGlobal [execstack] null i\n     2 index exch get                               % <object> bGlobal [execstack] null proc\ndiff --git a\/psi\/int.mak b\/psi\/int.mak\nindex 5d9b3d5..6ab5bf0 100644\n--- a\/psi\/int.mak\n+++ b\/psi\/int.mak\n@@ -323,7 +323,7 @@ $(PSOBJ)zarray.$(OBJ) : $(PSSRC)zarray.c $(OP) $(memory__h)\\\n \n $(PSOBJ)zcontrol.$(OBJ) : $(PSSRC)zcontrol.c $(OP) $(string__h)\\\n  $(estack_h) $(files_h) $(ipacked_h) $(iutil_h) $(store_h) $(stream_h)\\\n- $(INT_MAK) $(MAKEDIRS)\n+ $(interp_h) $(INT_MAK) $(MAKEDIRS)\n \t$(PSCC) $(PSO_)zcontrol.$(OBJ) $(C_) $(PSSRC)zcontrol.c\n \n $(PSOBJ)zdict.$(OBJ) : $(PSSRC)zdict.c $(OP)\\\ndiff --git a\/psi\/interp.c b\/psi\/interp.c\nindex b70769d..6dc0dda 100644\n--- a\/psi\/interp.c\n+++ b\/psi\/interp.c\n@@ -142,7 +142,6 @@ static int oparray_pop(i_ctx_t *);\n static int oparray_cleanup(i_ctx_t *);\n static int zerrorexec(i_ctx_t *);\n static int zfinderrorobject(i_ctx_t *);\n-static int errorexec_find(i_ctx_t *, ref *);\n static int errorexec_pop(i_ctx_t *);\n static int errorexec_cleanup(i_ctx_t *);\n static int zsetstackprotect(i_ctx_t *);\n@@ -761,7 +760,7 @@ copy_stack(i_ctx_t *i_ctx_p, const ref_stack_t * pstack, int skip, ref * arr)\n {\n     uint size = ref_stack_count(pstack) - skip;\n     uint save_space = ialloc_space(idmemory);\n-    int code;\n+    int code, i;\n \n     if (size > 65535)\n         size = 65535;\n@@ -770,6 +769,15 @@ copy_stack(i_ctx_t *i_ctx_p, const ref_stack_t * pstack, int skip, ref * arr)\n     if (code >= 0)\n         code = ref_stack_store(pstack, arr, size, 0, 1, true, idmemory,\n                                \"copy_stack\");\n+    \/* If we are copying the exec stack, try to replace any oparrays with\n+     * with the operator than references them\n+     *\/\n+    if (pstack == &e_stack) {\n+        for (i = 0; i < size; i++) {\n+            if (errorexec_find(i_ctx_p, &arr->value.refs[i]) < 0)\n+                make_null(&arr->value.refs[i]);\n+        }\n+    }\n     ialloc_set_space(idmemory, save_space);\n     return code;\n }\n@@ -1934,7 +1942,7 @@ zfinderrorobject(i_ctx_t *i_ctx_p)\n  * .errorexec with errobj != null, store it in *perror_object and return 1,\n  * otherwise return 0;\n  *\/\n-static int\n+int\n errorexec_find(i_ctx_t *i_ctx_p, ref *perror_object)\n {\n     long i;\ndiff --git a\/psi\/interp.h b\/psi\/interp.h\nindex e9275b9..4f551d1 100644\n--- a\/psi\/interp.h\n+++ b\/psi\/interp.h\n@@ -91,5 +91,7 @@ void gs_interp_reset(i_ctx_t *i_ctx_p);\n \/* Define the top-level interface to the interpreter. *\/\n int gs_interpret(i_ctx_t **pi_ctx_p, ref * pref, int user_errors,\n                  int *pexit_code, ref * perror_object);\n+int\n+errorexec_find(i_ctx_t *i_ctx_p, ref *perror_object);\n \n #endif \/* interp_INCLUDED *\/\ndiff --git a\/psi\/zcontrol.c b\/psi\/zcontrol.c\nindex 36da22c..0362cf4 100644\n--- a\/psi\/zcontrol.c\n+++ b\/psi\/zcontrol.c\n@@ -24,6 +24,7 @@\n #include \"ipacked.h\"\n #include \"iutil.h\"\n #include \"store.h\"\n+#include \"interp.h\"\n \n \/* Forward references *\/\n static int check_for_exec(const_os_ptr);\n@@ -787,7 +788,7 @@ zexecstack2(i_ctx_t *i_ctx_p)\n \/* Continuation operator to do the actual transfer. *\/\n \/* r_size(op1) was set just above. *\/\n static int\n-do_execstack(i_ctx_t *i_ctx_p, bool include_marks, os_ptr op1)\n+do_execstack(i_ctx_t *i_ctx_p, bool include_marks, bool include_oparrays, os_ptr op1)\n {\n     os_ptr op = osp;\n     ref *arefs = op1->value.refs;\n@@ -829,6 +830,12 @@ do_execstack(i_ctx_t *i_ctx_p, bool include_marks, os_ptr op1)\n                                   strlen(tname), (const byte *)tname);\n                 break;\n             }\n+            case t_array:\n+            case t_shortarray:\n+            case t_mixedarray:\n+                if (!include_oparrays && errorexec_find(i_ctx_p, rq) < 0)\n+                    make_null(rq);\n+                break;\n             default:\n                 ;\n         }\n@@ -841,14 +848,14 @@ execstack_continue(i_ctx_t *i_ctx_p)\n {\n     os_ptr op = osp;\n \n-    return do_execstack(i_ctx_p, false, op);\n+    return do_execstack(i_ctx_p, false, false, op);\n }\n static int\n execstack2_continue(i_ctx_t *i_ctx_p)\n {\n     os_ptr op = osp;\n \n-    return do_execstack(i_ctx_p, op->value.boolval, op - 1);\n+    return do_execstack(i_ctx_p, op->value.boolval, true, op - 1);\n }\n \n \/* - .needinput - *\/\n-- \n2.9.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2015-8964","CWE_ID":"200","category":"security","commit_id":"dd42bf1197144ede075a9d4793123f7689e164bc","commit_message":"From dd42bf1197144ede075a9d4793123f7689e164bc Mon Sep 17 00:00:00 2001\nFrom: Peter Hurley <peter@hurleysoftware.com>\nDate: Fri, 27 Nov 2015 14:30:21 -0500\nSubject: [PATCH] tty: Prevent ldisc drivers from re-using stale tty fields\n\nLine discipline drivers may mistakenly misuse ldisc-related fields\nwhen initializing. For example, a failure to initialize tty->receive_room\nin the N_GIGASET_M101 line discipline was recently found and fixed [1].\nNow, the N_X25 line discipline has been discovered accessing the previous\nline discipline's already-freed private data [2].\n\nHarden the ldisc interface against misuse by initializing revelant\ntty fields before instancing the new line discipline.\n\n[1]\n    commit fd98e9419d8d622a4de91f76b306af6aa627aa9c\n    Author: Tilman Schmidt <tilman@imap.cc>\n    Date:   Tue Jul 14 00:37:13 2015 +0200\n\n    isdn\/gigaset: reset tty->receive_room when attaching ser_gigaset\n\n[2] Report from Sasha Levin <sasha.levin@oracle.com>\n    [  634.336761] ==================================================================\n    [  634.338226] BUG: KASAN: use-after-free in x25_asy_open_tty+0x13d\/0x490 at addr ffff8800a743efd0\n    [  634.339558] Read of size 4 by task syzkaller_execu\/8981\n    [  634.340359] =============================================================================\n    [  634.341598] BUG kmalloc-512 (Not tainted): kasan: bad access detected\n    ...\n    [  634.405018] Call Trace:\n    [  634.405277] dump_stack (lib\/dump_stack.c:52)\n    [  634.405775] print_trailer (mm\/slub.c:655)\n    [  634.406361] object_err (mm\/slub.c:662)\n    [  634.406824] kasan_report_error (mm\/kasan\/report.c:138 mm\/kasan\/report.c:236)\n    [  634.409581] __asan_report_load4_noabort (mm\/kasan\/report.c:279)\n    [  634.411355] x25_asy_open_tty (drivers\/net\/wan\/x25_asy.c:559 (discriminator 1))\n    [  634.413997] tty_ldisc_open.isra.2 (drivers\/tty\/tty_ldisc.c:447)\n    [  634.414549] tty_set_ldisc (drivers\/tty\/tty_ldisc.c:567)\n    [  634.415057] tty_ioctl (drivers\/tty\/tty_io.c:2646 drivers\/tty\/tty_io.c:2879)\n    [  634.423524] do_vfs_ioctl (fs\/ioctl.c:43 fs\/ioctl.c:607)\n    [  634.427491] SyS_ioctl (fs\/ioctl.c:622 fs\/ioctl.c:613)\n    [  634.427945] entry_SYSCALL_64_fastpath (arch\/x86\/entry\/entry_64.S:188)\n\nCc: Tilman Schmidt <tilman@imap.cc>\nCc: Sasha Levin <sasha.levin@oracle.com>\nSigned-off-by: Peter Hurley <peter@hurleysoftware.com>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\n---\n drivers\/tty\/tty_ldisc.c | 7 +++++++\n 1 file changed, 7 insertions(+)\n\n","diff_code":"diff --git a\/drivers\/tty\/tty_ldisc.c b\/drivers\/tty\/tty_ldisc.c\nindex 9ec1250463436..a054d03c22e7b 100644\n--- a\/drivers\/tty\/tty_ldisc.c\n+++ b\/drivers\/tty\/tty_ldisc.c\n@@ -417,6 +417,10 @@ EXPORT_SYMBOL_GPL(tty_ldisc_flush);\n  *\tthey are not on hot paths so a little discipline won't do\n  *\tany harm.\n  *\n+ *\tThe line discipline-related tty_struct fields are reset to\n+ *\tprevent the ldisc driver from re-using stale information for\n+ *\tthe new ldisc instance.\n+ *\n  *\tLocking: takes termios_rwsem\n  *\/\n \n@@ -425,6 +429,9 @@ static void tty_set_termios_ldisc(struct tty_struct *tty, int num)\n \tdown_write(&tty->termios_rwsem);\n \ttty->termios.c_line = num;\n \tup_write(&tty->termios_rwsem);\n+\n+\ttty->disc_data = NULL;\n+\ttty->receive_room = 0;\n }\n \n \/**\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-4482","CWE_ID":"200","category":"security","commit_id":"681fef8380eb818c0b845fca5d2ab1dcbab114ee","commit_message":"From 681fef8380eb818c0b845fca5d2ab1dcbab114ee Mon Sep 17 00:00:00 2001\nFrom: Kangjie Lu <kangjielu@gmail.com>\nDate: Tue, 3 May 2016 16:32:16 -0400\nSubject: USB: usbfs: fix potential infoleak in devio\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nThe stack object \u201cci\u201d has a total size of 8 bytes. Its last 3 bytes\nare padding bytes which are not initialized and leaked to userland\nvia \u201ccopy_to_user\u201d.\n\nSigned-off-by: Kangjie Lu <kjlu@gatech.edu>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\n---\n drivers\/usb\/core\/devio.c | 9 +++++----\n 1 file changed, 5 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/usb\/core\/devio.c b\/drivers\/usb\/core\/devio.c\nindex 73ce87166401..e9f5043a2167 100644\n--- a\/drivers\/usb\/core\/devio.c\n+++ b\/drivers\/usb\/core\/devio.c\n@@ -1316,10 +1316,11 @@ static int proc_getdriver(struct usb_dev_state *ps, void __user *arg)\n \n static int proc_connectinfo(struct usb_dev_state *ps, void __user *arg)\n {\n-\tstruct usbdevfs_connectinfo ci = {\n-\t\t.devnum = ps->dev->devnum,\n-\t\t.slow = ps->dev->speed == USB_SPEED_LOW\n-\t};\n+\tstruct usbdevfs_connectinfo ci;\n+\n+\tmemset(&ci, 0, sizeof(ci));\n+\tci.devnum = ps->dev->devnum;\n+\tci.slow = ps->dev->speed == USB_SPEED_LOW;\n \n \tif (copy_to_user(arg, &ci, sizeof(ci)))\n \t\treturn -EFAULT;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-8791","CWE_ID":"200","category":"security","commit_id":"24e5cd7c666b1ddd85619d60486db0a5481c1b90","commit_message":"From 24e5cd7c666b1ddd85619d60486db0a5481c1b90 Mon Sep 17 00:00:00 2001\nFrom: Moritz Bunkus <moritz@bunkus.org>\nDate: Tue, 20 Oct 2015 14:49:44 +0200\nSubject: [PATCH] EbmlElement: don't read beyond end of buffer when reading\n variable length integers\n\n---\n ChangeLog           | 6 ++++++\n src\/EbmlElement.cpp | 5 +++++\n 2 files changed, 11 insertions(+)\n\n","diff_code":"diff --git a\/ChangeLog b\/ChangeLog\nindex a5139c4..3fb53d4 100644\n--- a\/ChangeLog\n+++ b\/ChangeLog\n@@ -1,5 +1,11 @@\n 2015-10-20  Moritz Bunkus  <moritz@bunkus.org>\n \n+        * EbmlElement::ReadCodedSizeValue(): Fixed an invalid memory\n+        access. When reading a EBML variable length integer value a read\n+        access beyond the end of the available buffer was possible if\n+        fewer bytes were available than indicated by the first byte\n+        resulting in a heap information leak.\n+\n         * EbmlUnicodeString::UpdateFromUTF8(): Fixed an invalid memory\n         access. When reading from a UTF-8 string in which the length\n         indicated by a UTF-8 character's first byte exceeds the string's\ndiff --git a\/src\/EbmlElement.cpp b\/src\/EbmlElement.cpp\nindex 39eb6f0..d25abe8 100644\n--- a\/src\/EbmlElement.cpp\n+++ b\/src\/EbmlElement.cpp\n@@ -150,6 +150,11 @@ uint64 ReadCodedSizeValue(const binary * InBuffer, uint32 & BufferSize, uint64 &\n       \/\/ ID found\n       PossibleSizeLength = SizeIdx + 1;\n       SizeBitMask >>= SizeIdx;\n+\n+      \/\/ Guard against invalid memory accesses with incomplete IDs.\n+      if (PossibleSizeLength > BufferSize)\n+        break;\n+\n       for (SizeIdx = 0; SizeIdx < PossibleSizeLength; SizeIdx++) {\n         PossibleSize[SizeIdx] = InBuffer[SizeIdx];\n       }\n","owner":"Matroska-Org","repo":"libebml","source":"cve"},{"CVE_ID":"CVE-2010-4075","CWE_ID":"200","category":"security","commit_id":"d281da7ff6f70efca0553c288bb883e8605b3862","commit_message":"From d281da7ff6f70efca0553c288bb883e8605b3862 Mon Sep 17 00:00:00 2001\nFrom: Alan Cox <alan@linux.intel.com>\nDate: Thu, 16 Sep 2010 18:21:24 +0100\nSubject: tty: Make tiocgicount a handler\n\nDan Rosenberg noted that various drivers return the struct with uncleared\nfields. Instead of spending forever trying to stomp all the drivers that\nget it wrong (and every new driver) do the job in one place.\n\nThis first patch adds the needed operations and hooks them up, including\nthe needed USB midlayer and serial core plumbing.\n\nSigned-off-by: Alan Cox <alan@linux.intel.com>\nSigned-off-by: Greg Kroah-Hartman <gregkh@suse.de>\n---\n drivers\/char\/tty_io.c           | 21 +++++++++++++++++++++\n drivers\/serial\/serial_core.c    | 35 ++++++++++++++++-------------------\n drivers\/usb\/serial\/usb-serial.c | 13 +++++++++++++\n include\/linux\/tty_driver.h      |  9 +++++++++\n include\/linux\/usb\/serial.h      |  2 ++\n 5 files changed, 61 insertions(+), 19 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/char\/tty_io.c b\/drivers\/char\/tty_io.c\nindex e185db36f8ad..c05c5af5aa04 100644\n--- a\/drivers\/char\/tty_io.c\n+++ b\/drivers\/char\/tty_io.c\n@@ -96,6 +96,7 @@\n #include <linux\/bitops.h>\n #include <linux\/delay.h>\n #include <linux\/seq_file.h>\n+#include <linux\/serial.h>\n \n #include <linux\/uaccess.h>\n #include <asm\/system.h>\n@@ -2511,6 +2512,20 @@ static int tty_tiocmset(struct tty_struct *tty, struct file *file, unsigned int\n \treturn tty->ops->tiocmset(tty, file, set, clear);\n }\n \n+static int tty_tiocgicount(struct tty_struct *tty, void __user *arg)\n+{\n+\tint retval = -EINVAL;\n+\tstruct serial_icounter_struct icount;\n+\tmemset(&icount, 0, sizeof(icount));\n+\tif (tty->ops->get_icount)\n+\t\tretval = tty->ops->get_icount(tty, &icount);\n+\tif (retval != 0)\n+\t\treturn retval;\n+\tif (copy_to_user(arg, &icount, sizeof(icount)))\n+\t\treturn -EFAULT;\n+\treturn 0;\n+}\n+\n struct tty_struct *tty_pair_get_tty(struct tty_struct *tty)\n {\n \tif (tty->driver->type == TTY_DRIVER_TYPE_PTY &&\n@@ -2631,6 +2646,12 @@ long tty_ioctl(struct file *file, unsigned int cmd, unsigned long arg)\n \tcase TIOCMBIC:\n \tcase TIOCMBIS:\n \t\treturn tty_tiocmset(tty, file, cmd, p);\n+\tcase TIOCGICOUNT:\n+\t\tretval = tty_tiocgicount(tty, p);\n+\t\t\/* For the moment allow fall through to the old method *\/\n+        \tif (retval != -EINVAL)\n+\t\t\treturn retval;\n+\t\tbreak;\n \tcase TCFLSH:\n \t\tswitch (arg) {\n \t\tcase TCIFLUSH:\ndiff --git a\/drivers\/serial\/serial_core.c b\/drivers\/serial\/serial_core.c\nindex bc6cddd10294..c4ea14670d44 100644\n--- a\/drivers\/serial\/serial_core.c\n+++ b\/drivers\/serial\/serial_core.c\n@@ -1074,10 +1074,10 @@ uart_wait_modem_status(struct uart_state *state, unsigned long arg)\n  * NB: both 1->0 and 0->1 transitions are counted except for\n  *     RI where only 0->1 is counted.\n  *\/\n-static int uart_get_count(struct uart_state *state,\n-\t\t\t  struct serial_icounter_struct __user *icnt)\n+static int uart_get_icount(struct tty_struct *tty,\n+\t\t\t  struct serial_icounter_struct *icount)\n {\n-\tstruct serial_icounter_struct icount;\n+\tstruct uart_state *state = tty->driver_data;\n \tstruct uart_icount cnow;\n \tstruct uart_port *uport = state->uart_port;\n \n@@ -1085,19 +1085,19 @@ static int uart_get_count(struct uart_state *state,\n \tmemcpy(&cnow, &uport->icount, sizeof(struct uart_icount));\n \tspin_unlock_irq(&uport->lock);\n \n-\ticount.cts         = cnow.cts;\n-\ticount.dsr         = cnow.dsr;\n-\ticount.rng         = cnow.rng;\n-\ticount.dcd         = cnow.dcd;\n-\ticount.rx          = cnow.rx;\n-\ticount.tx          = cnow.tx;\n-\ticount.frame       = cnow.frame;\n-\ticount.overrun     = cnow.overrun;\n-\ticount.parity      = cnow.parity;\n-\ticount.brk         = cnow.brk;\n-\ticount.buf_overrun = cnow.buf_overrun;\n+\ticount->cts         = cnow.cts;\n+\ticount->dsr         = cnow.dsr;\n+\ticount->rng         = cnow.rng;\n+\ticount->dcd         = cnow.dcd;\n+\ticount->rx          = cnow.rx;\n+\ticount->tx          = cnow.tx;\n+\ticount->frame       = cnow.frame;\n+\ticount->overrun     = cnow.overrun;\n+\ticount->parity      = cnow.parity;\n+\ticount->brk         = cnow.brk;\n+\ticount->buf_overrun = cnow.buf_overrun;\n \n-\treturn copy_to_user(icnt, &icount, sizeof(icount)) ? -EFAULT : 0;\n+\treturn 0;\n }\n \n \/*\n@@ -1150,10 +1150,6 @@ uart_ioctl(struct tty_struct *tty, struct file *filp, unsigned int cmd,\n \tcase TIOCMIWAIT:\n \t\tret = uart_wait_modem_status(state, arg);\n \t\tbreak;\n-\n-\tcase TIOCGICOUNT:\n-\t\tret = uart_get_count(state, uarg);\n-\t\tbreak;\n \t}\n \n \tif (ret != -ENOIOCTLCMD)\n@@ -2295,6 +2291,7 @@ static const struct tty_operations uart_ops = {\n #endif\n \t.tiocmget\t= uart_tiocmget,\n \t.tiocmset\t= uart_tiocmset,\n+\t.get_icount\t= uart_get_icount,\n #ifdef CONFIG_CONSOLE_POLL\n \t.poll_init\t= uart_poll_init,\n \t.poll_get_char\t= uart_poll_get_char,\ndiff --git a\/drivers\/usb\/serial\/usb-serial.c b\/drivers\/usb\/serial\/usb-serial.c\nindex 7a2177c79bde..e64da74bdcc5 100644\n--- a\/drivers\/usb\/serial\/usb-serial.c\n+++ b\/drivers\/usb\/serial\/usb-serial.c\n@@ -519,6 +519,18 @@ static int serial_tiocmset(struct tty_struct *tty, struct file *file,\n \treturn -EINVAL;\n }\n \n+static int serial_get_icount(struct tty_struct *tty,\n+\t\t\t\tstruct serial_icounter_struct *icount)\n+{\n+\tstruct usb_serial_port *port = tty->driver_data;\n+\n+\tdbg(\"%s - port %d\", __func__, port->number);\n+\n+\tif (port->serial->type->get_icount)\n+\t\treturn port->serial->type->get_icount(tty, icount);\n+\treturn -EINVAL;\n+}\n+\n \/*\n  * We would be calling tty_wakeup here, but unfortunately some line\n  * disciplines have an annoying habit of calling tty->write from\n@@ -1195,6 +1207,7 @@ static const struct tty_operations serial_ops = {\n \t.chars_in_buffer =\tserial_chars_in_buffer,\n \t.tiocmget =\t\tserial_tiocmget,\n \t.tiocmset =\t\tserial_tiocmset,\n+\t.get_icount = \t\tserial_get_icount,\n \t.cleanup = \t\tserial_cleanup,\n \t.install = \t\tserial_install,\n \t.proc_fops =\t\t&serial_proc_fops,\ndiff --git a\/include\/linux\/tty_driver.h b\/include\/linux\/tty_driver.h\nindex b08677982525..db2d227694da 100644\n--- a\/include\/linux\/tty_driver.h\n+++ b\/include\/linux\/tty_driver.h\n@@ -224,6 +224,12 @@\n  *\tunless the tty also has a valid tty->termiox pointer.\n  *\n  *\tOptional: Called under the termios lock\n+ *\n+ * int (*get_icount)(struct tty_struct *tty, struct serial_icounter *icount);\n+ *\n+ *\tCalled when the device receives a TIOCGICOUNT ioctl. Passed a kernel\n+ *\tstructure to complete. This method is optional and will only be called\n+ *\tif provided (otherwise EINVAL will be returned).\n  *\/\n \n #include <linux\/fs.h>\n@@ -232,6 +238,7 @@\n \n struct tty_struct;\n struct tty_driver;\n+struct serial_icounter_struct;\n \n struct tty_operations {\n \tstruct tty_struct * (*lookup)(struct tty_driver *driver,\n@@ -268,6 +275,8 @@ struct tty_operations {\n \t\t\tunsigned int set, unsigned int clear);\n \tint (*resize)(struct tty_struct *tty, struct winsize *ws);\n \tint (*set_termiox)(struct tty_struct *tty, struct termiox *tnew);\n+\tint (*get_icount)(struct tty_struct *tty,\n+\t\t\t\tstruct serial_icounter_struct *icount);\n #ifdef CONFIG_CONSOLE_POLL\n \tint (*poll_init)(struct tty_driver *driver, int line, char *options);\n \tint (*poll_get_char)(struct tty_driver *driver, int line);\ndiff --git a\/include\/linux\/usb\/serial.h b\/include\/linux\/usb\/serial.h\nindex 55675b1efb28..16d682f4f7c3 100644\n--- a\/include\/linux\/usb\/serial.h\n+++ b\/include\/linux\/usb\/serial.h\n@@ -271,6 +271,8 @@ struct usb_serial_driver {\n \tint  (*tiocmget)(struct tty_struct *tty, struct file *file);\n \tint  (*tiocmset)(struct tty_struct *tty, struct file *file,\n \t\t\t unsigned int set, unsigned int clear);\n+\tint  (*get_icount)(struct tty_struct *tty,\n+\t\t\tstruct serial_icounter_struct *icount);\n \t\/* Called by the tty layer for port level work. There may or may not\n \t   be an attached tty at this point *\/\n \tvoid (*dtr_rts)(struct usb_serial_port *port, int on);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2015-2141","CWE_ID":"200","category":"security","commit_id":"9425e16437439e68c7d96abef922167d68fafaff","commit_message":"From 9425e16437439e68c7d96abef922167d68fafaff Mon Sep 17 00:00:00 2001\nFrom: Jeffrey Walton <noloader@gmail.com>\nDate: Sat, 27 Jun 2015 17:56:01 -0400\nSubject: [PATCH] Fix for CVE-2015-2141. Thanks to Evgeny Sidorov for\n reporting. Squaring to satisfy Jacobi requirements suggested by JPM.\n\n---\n rw.cpp | 8 +++++++-\n 1 file changed, 7 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/rw.cpp b\/rw.cpp\nindex cdd9f2d2..0b9318bf 100644\n--- a\/rw.cpp\n+++ b\/rw.cpp\n@@ -126,10 +126,16 @@ Integer InvertibleRWFunction::CalculateInverse(RandomNumberGenerator &rng, const\n \tDoQuickSanityCheck();\n \tModularArithmetic modn(m_n);\n \tInteger r, rInv;\n-\tdo {\t\/\/ do this in a loop for people using small numbers for testing\n+\n+\t\/\/ do this in a loop for people using small numbers for testing\n+\tdo {\n \t\tr.Randomize(rng, Integer::One(), m_n - Integer::One());\n+\t\t\/\/ Fix for CVE-2015-2141. Thanks to Evgeny Sidorov for reporting.\n+\t\t\/\/ Squaring to satisfy Jacobi requirements suggested by JPM.\n+\t\tr = modn.Square(r);\n \t\trInv = modn.MultiplicativeInverse(r);\n \t} while (rInv.IsZero());\n+\n \tInteger re = modn.Square(r);\n \tre = modn.Multiply(re, x);\t\t\t\/\/ blind\n \n","owner":"weidai11","repo":"cryptopp","source":"cve"},{"CVE_ID":"CVE-2011-3177","CWE_ID":"200","category":"security","commit_id":"7fe2e3df308b8b6a901cb2cfd60f398df53219de","commit_message":"From 7fe2e3df308b8b6a901cb2cfd60f398df53219de Mon Sep 17 00:00:00 2001\nFrom: Martin Vidner <mvidner@suse.cz>\nDate: Thu, 5 Jan 2012 17:03:40 +0000\nSubject: [PATCH] - ini-agent: added Write(.section_private.SECTION, BOOLEAN)\n (bnc#713661, CVE-2011-3177) - system agent: added  Write(.target.string,\n [filename, mode],  content)\n\nsvn merge -r66758:66764 http:\/\/svn.opensuse.org\/svn\/yast\/branches\/SuSE-Code-11-SP2-Branch\/core\n\nsvn path=\/trunk\/core\/; revision=67117\n---\n VERSION                                 |  2 +-\n agent-ini\/doc\/ag_ini.html               | 13 ++++--\n agent-ini\/src\/IniAgent.cc               |  2 +-\n agent-ini\/src\/IniFile.cc                | 24 ++++++++++-\n agent-ini\/src\/IniFile.h                 | 20 +++++++--\n agent-ini\/src\/IniParser.cc              | 55 +++++++++++++------------\n agent-ini\/src\/IniParser.h               |  4 ++\n agent-ini\/testsuite\/multi\/private.err   | 11 +++++\n agent-ini\/testsuite\/multi\/private.in.1  | 10 +++++\n agent-ini\/testsuite\/multi\/private.in.2  | 11 +++++\n agent-ini\/testsuite\/multi\/private.out   | 25 +++++++++++\n agent-ini\/testsuite\/multi\/private.scr   | 24 +++++++++++\n agent-ini\/testsuite\/multi\/private.ycp   | 26 ++++++++++++\n agent-system\/src\/SystemAgent.cc         | 35 +++++++++++++---\n agent-system\/testsuite\/tests\/string.out |  1 +\n agent-system\/testsuite\/tests\/string.ycp | 10 +++++\n package\/yast2-core.changes              |  8 ++++\n 17 files changed, 239 insertions(+), 42 deletions(-)\n create mode 100644 agent-ini\/testsuite\/multi\/private.err\n create mode 100644 agent-ini\/testsuite\/multi\/private.in.1\n create mode 100644 agent-ini\/testsuite\/multi\/private.in.2\n create mode 100644 agent-ini\/testsuite\/multi\/private.out\n create mode 100644 agent-ini\/testsuite\/multi\/private.scr\n create mode 100644 agent-ini\/testsuite\/multi\/private.ycp\n\n","diff_code":"diff --git a\/VERSION b\/VERSION\nindex f48f82fa..d93847fa 100644\n--- a\/VERSION\n+++ b\/VERSION\n@@ -1 +1 @@\n-2.22.0\n+2.22.1\ndiff --git a\/agent-ini\/doc\/ag_ini.html b\/agent-ini\/doc\/ag_ini.html\nindex dbc02b16..b710acf5 100644\n--- a\/agent-ini\/doc\/ag_ini.html\n+++ b\/agent-ini\/doc\/ag_ini.html\n@@ -280,7 +280,7 @@ <h4 id=\"params\">Params:<\/h4>\n <p>Then begin regexp is: ([^=]+)=\"([^\"]*) and end regexp is\n ([^\"]\"). These are compared at the end so they are the last\n possibility. But once we get into this \"divided line\" by accident,\n-it becomes greedy, so be carefull to forgotten \". If \"multiline\" is\n+it becomes greedy, so be carefull to forgotten &quot;. If \"multiline\" is\n not present, this mechanism does not take in effect of course.<\/p>\n \n <p>See also the option <a\n@@ -473,7 +473,7 @@ <h3 id=\"sysconfig\">Configuration file for sysconfig files (former rc files)<\/h3>\n         \"comments\": [ \"^[ \\t]*#.*$\", \"#.*\", \"^[ \\t]*$\", ],\n         \"params\" : [\n             $[\n-                \"match\" : [ \"([a-zA-Z0-9_]+)[ \\t]*=[ \\t]*\\\"([^\\\"]*)\\\"\", \"%s=\\\"%s\\\"\" ],\n+                \"match\" : [ \"([a-zA-Z0-9_]+)[ \\t]*=[ \\t]*\\\"([^\\&quot;]*)\\\"\", \"%s=\\\"%s\\\"\" ],\n                 \"multiline\" : [ \"([a-zA-Z0-9_]+)[ \\t]*=[ \\t]*\\\"([^\\\"]*)\", \"([^\\\"]*)\\\"\", ],\n             ],\n             $[\n@@ -533,6 +533,13 @@ <h3 id=\"access\">Accessing keys<\/h3>\n section was read by.<\/td>\n <\/tr>\n \n+<tr>\n+<td>\n+<tt>.ini.section_private.<i>sectionname<\/i><\/tt><\/td>\n+<td>a boolean write-only property for sections corresponding to files.\n+If true, the file will not be readable by group and others.<\/td>\n+<\/tr>\n+\n <tr class=\"notimpl\">\n <td>\n <tt>.ini.section_file.<i>sectionname<\/i>.<i>sectionname<\/i><\/tt><\/td>\n@@ -694,7 +701,7 @@ <h3 id=\"ex.providers\">Dialup providers (package providers)<\/h3>\n       ],\n       \"params\" : [\n         $[\n-        \"match\" : [ \"^[ \\t]*([^=]*[^ \\t=])[ \\t]*=[ \\t]*(.*[^ \\t]|)[ \\t]*$\" , \"%s =       ],\n+        \"match\" : [ \"^[ \\t]*([^=]*[^ \\t=])[ \\t]*=[ \\t]*(.*[^ \\t]|)[ \\t]*$\" , \"%s = %s\"   ],\n     ],\n     ]\n   )\ndiff --git a\/agent-ini\/src\/IniAgent.cc b\/agent-ini\/src\/IniAgent.cc\nindex a2883ffb..66d2c7e3 100644\n--- a\/agent-ini\/src\/IniAgent.cc\n+++ b\/agent-ini\/src\/IniAgent.cc\n@@ -98,7 +98,7 @@ YCPBoolean IniAgent::Write(const YCPPath &path, const YCPValue& value, const YCP\n     else\n     {\n \tif (( parser.repeatNames () && value->isList ()) ||\n-\t    (!parser.repeatNames () &&  (value->isString () || value->isInteger())) ||\n+\t    (!parser.repeatNames () &&  (value->isString () || value->isBoolean() || value->isInteger())) ||\n \t    path->component_str(0) == \"all\"\n \t    )\n \t    {\ndiff --git a\/agent-ini\/src\/IniFile.cc b\/agent-ini\/src\/IniFile.cc\nindex 7fe9fda2..23bbec66 100644\n--- a\/agent-ini\/src\/IniFile.cc\n+++ b\/agent-ini\/src\/IniFile.cc\n@@ -75,6 +75,19 @@ YCPInteger as_integer (const YCPValue& v, const char * context)\n     return YCPNull ();\n }\n \n+\/**\n+ * Return the YCPBoolean or YCPNull if it is not one. Log an error.\n+ *\/\n+static\n+YCPBoolean as_boolean (const YCPValue& v, const char * context)\n+{\n+    if (v->isBoolean ())\n+\treturn v->asBoolean ();\n+    ycp2error (\"Expected a boolean for %s, got %s %s\",\n+\t       context, v->valuetype_str(), v->toString().c_str());\n+    return YCPNull ();\n+}\n+\n void IniSection::initValue (const string&key,const string&val,const string&comment,int rb)\n {\n     string k = ip->changeCase (key);\n@@ -486,6 +499,9 @@ int IniSection::Write (const YCPPath&p, const YCPValue&v, bool rewrite)\n       return setSectionProp (p, v, 0, 1);\n     if (s == \"st\" || s == \"section_type\" || s == \"sectiontype\")\n       return setSectionProp (p, v, rewrite? 1:2, 1);\n+    if (s == \"section_private\")\n+      return setSectionProp (p, v, 3, 1);\n+\n     return -1;\n }\n \n@@ -591,12 +607,18 @@ int IniSection::setSectionProp (const YCPPath&p,const YCPValue&in, int what, int\n \t\t\treturn -1;\n \t\t    s.setRewriteBy (i->value());\n \t\t}\n-\t\telse {\n+\t\telse if (what == 2) {\n \t\t    YCPInteger i = as_integer (prop, \"section_type\");\n \t\t    if (i.isNull())\n \t\t\treturn -1;\n \t\t    s.setReadBy (i->value());\n \t\t}\n+\t\telse if (what == 3) {\n+\t\t    YCPBoolean b = as_boolean (prop, \"section_private\");\n+\t\t    if (b.isNull())\n+\t\t\treturn -1;\n+\t\t    s.setPrivate (b->value());\n+\t\t}\n \n \t\tif (xi != xe)\n \t\t{\ndiff --git a\/agent-ini\/src\/IniFile.h b\/agent-ini\/src\/IniFile.h\nindex 6a56c9ee..70c290d7 100644\n--- a\/agent-ini\/src\/IniFile.h\n+++ b\/agent-ini\/src\/IniFile.h\n@@ -241,6 +241,13 @@ class IniSection : public IniBase\n      *\/\n     string end_comment;\n \n+    \/**\n+     * It is effective only when the section corresponds to a file.\n+     * The file will not be readable by group and others.\n+     * bnc#713661\n+     *\/\n+    bool is_private;\n+\n     \/** index to IniParser::rewrites for filename - section name mapping\n      * It appears that read_by was used for both purposes,\n      * causing bug (#19066).\n@@ -435,7 +442,7 @@ class IniSection : public IniBase\n     IniSection (const IniParser *p)\n \t: IniBase (-1),\n \t  ip (p),\n-\t  end_comment (), rewrite_by(-1),\n+\t  end_comment (), is_private(false), rewrite_by(-1),\n \t  container (), ivalues (), isections ()\n \t    {}\n \n@@ -446,7 +453,7 @@ class IniSection : public IniBase\n     IniSection (const IniSection &s) :\n \tIniBase (s),\n \t  ip (s.ip),\n-\t  end_comment (s.end_comment), rewrite_by (s.rewrite_by),\n+          end_comment (s.end_comment), is_private(s.is_private), rewrite_by (s.rewrite_by),\n \t  container (s.container)\n \t{ reindex (); }\n \n@@ -458,7 +465,9 @@ class IniSection : public IniBase\n \t    } \n \t    IniBase::operator = (s);\n \t    ip = s.ip;\n-\t    end_comment = s.end_comment; rewrite_by = s.rewrite_by;\n+\t    end_comment = s.end_comment;\n+            is_private = s.is_private;\n+            rewrite_by = s.rewrite_by;\n \t    container = s.container;\n \n \t    reindex ();\n@@ -474,7 +483,7 @@ class IniSection : public IniBase\n     IniSection (const IniParser *p, string n)\n \t: IniBase (n),\n \t  ip (p),\n-\t  end_comment (), rewrite_by(0),\n+\t  end_comment (), is_private(false), rewrite_by(0),\n \t  container(), ivalues (), isections ()\n \t    {}\n     \/**\n@@ -511,6 +520,9 @@ class IniSection : public IniBase\n      *\/\n     int getSubSectionRewriteBy (const char*name);\n \n+    void setPrivate(bool p) { is_private = p; }\n+    bool isPrivate() const { return is_private; }\n+\n     \/** \n      * If there is no comment at the beginning and no values and no\n      * sections, it is better to set is as comment at the beginning.\ndiff --git a\/agent-ini\/src\/IniParser.cc b\/agent-ini\/src\/IniParser.cc\nindex e68f091a..cdddea9d 100644\n--- a\/agent-ini\/src\/IniParser.cc\n+++ b\/agent-ini\/src\/IniParser.cc\n@@ -965,19 +965,7 @@ int IniParser::write()\n \t\t\t    continue;\n \t\t\t}\n \t\t\ts.initReadBy ();\n-\t\t\t\/\/ ensure that the directories exist\n-\t\t\tPathname pn (filename);\n-\t\t\tPathInfo::assert_dir (pn.dirname ());\n-\t\t\tofstream of(filename.c_str());\n-\t\t\tif (!of.good())\n-\t\t\t{\n-\t\t\t    bugs++;\n-\t\t\t    y2error (\"Can not open file %s for write\", filename.c_str());\n-\t\t\t    continue;\n-\t\t\t}\n-\t\t\twrite_helper (s, of, 0);\n-\t\t\ts.clean();\n-\t\t\tof.close ();\n+                        bugs += write_file(filename, s);\n \t\t    }\n \t\telse\n \t\t    {\n@@ -997,24 +985,37 @@ int IniParser::write()\n     }\n     else\n     {\n-\t\/\/ ensure that the directories exist\n-\tPathname pn (file);\n-\tPathInfo::assert_dir (pn.dirname ());\n-\tofstream of(file.c_str());\n-\tif (!of.good())\n-\t{\n-\t    y2error (\"Can not open file %s for write\", file.c_str());\n-\t    return -1;\n-\t}\n-\n-\twrite_helper (inifile, of, 0);\n-\n-\tof.close();\n+        bugs += write_file(file, inifile);\n \ttimestamp = getTimeStamp ();\n     }\n-    inifile.clean ();\n     return bugs ? -1 : 0;\n }\n+\n+\/\/ return 0 on success, like write\n+int IniParser::write_file(const string & filename, IniSection & section)\n+{\n+    \/\/ ensure that the directories exist\n+    Pathname pn(filename);\n+    PathInfo::assert_dir (pn.dirname ());\n+\n+    mode_t file_umask = section.isPrivate()? 0077: 0022;\n+    mode_t orig_umask = umask(file_umask);\n+    \/\/ rewriting an existing file wouldnt change its mode\n+    unlink(filename.c_str());\n+\n+    ofstream of(filename.c_str());\n+    if (!of.good()) {\n+        y2error (\"Can not open file %s for write\", filename.c_str());\n+        return -1;\n+    }\n+\n+    write_helper (section, of, 0);\n+\n+    of.close();\n+    umask(orig_umask);\n+    return 0;\n+}\n+\n int IniParser::write_helper(IniSection&ini, ofstream&of, int depth)\n {\n     char * out_buffer;\ndiff --git a\/agent-ini\/src\/IniParser.h b\/agent-ini\/src\/IniParser.h\nindex ab954b64..22c9fec5 100644\n--- a\/agent-ini\/src\/IniParser.h\n+++ b\/agent-ini\/src\/IniParser.h\n@@ -369,6 +369,10 @@ class IniParser\n      * Parse one ini file and build a structure of IniSection.\n      *\/\n     int parse_helper(IniSection&ini);\n+    \/**\n+     * Write one ini file.\n+     *\/\n+    int write_file(const string & filename, IniSection & section);\n     \/**\n      * Write one ini file.\n      *\/\ndiff --git a\/agent-ini\/testsuite\/multi\/private.err b\/agent-ini\/testsuite\/multi\/private.err\nnew file mode 100644\nindex 00000000..22a57fa3\n--- \/dev\/null\n+++ b\/agent-ini\/testsuite\/multi\/private.err\n@@ -0,0 +1,11 @@\n+[agent-ini] IniParser.cc(parse):XXX Rewriting multi\/private.in.1.test to 1\n+[agent-ini] IniParser.cc(parse):XXX Rewriting multi\/private.in.2.test to 2\n+[agent-ini] IniFile.cc(setMyValue):XXX Adding value .v.\"1\".\"Totalise\".\"Password\" = \"Secret password\"\n+[agent-ini] IniFile.cc(setMyValue):XXX Adding value .v.\"2\".\"arcor\".\"Password\" = \"Public password\"\n+[agent-ini] IniParser.cc(parse):XXX Rewriting multi\/private.in.1.test to 1\n+[agent-ini] IniParser.cc(parse):XXX Rewriting multi\/private.in.2.test to 2\n+[agent-ini] IniParser.cc(getFileName):XXX Rewriting 1 to multi\/private.in.1.test\n+[agent-ini] IniParser.cc(getFileName):XXX Rewriting 2 to multi\/private.in.2.test\n+[YCP] multi\/private.ycp:XXX secret file mode: $[\"exit\":0, \"stderr\":\"\", \"stdout\":\"600\\n\"]\n+[YCP] multi\/private.ycp:XXX public file mode: $[\"exit\":0, \"stderr\":\"\", \"stdout\":\"644\\n\"]\n+[agent-ini] IniParser.cc(write):XXX File multi\/private.in.*.test did not change. Not saving.\ndiff --git a\/agent-ini\/testsuite\/multi\/private.in.1 b\/agent-ini\/testsuite\/multi\/private.in.1\nnew file mode 100644\nindex 00000000..6e0ae8d3\n--- \/dev\/null\n+++ b\/agent-ini\/testsuite\/multi\/private.in.1\n@@ -0,0 +1,10 @@\n+[Dialer Totalise]\n+Compuserve = 0\n+Provider = Totalise\n+Phone = 08453001470\n+[End]\n+\n+[Dialer force9]\n+Provider = Force9\n+Phone = 08451424000\n+[End]\ndiff --git a\/agent-ini\/testsuite\/multi\/private.in.2 b\/agent-ini\/testsuite\/multi\/private.in.2\nnew file mode 100644\nindex 00000000..9b363770\n--- \/dev\/null\n+++ b\/agent-ini\/testsuite\/multi\/private.in.2\n@@ -0,0 +1,11 @@\n+[Dialer arcor]\n+Compuserve = 0\n+Provider = Arcor\n+[End]\n+\n+[Dialer mobilcom]\n+Compuserve = 0\n+Provider = Mobilcom\n+Phone = 0101901929\n+[End]\n+\ndiff --git a\/agent-ini\/testsuite\/multi\/private.out b\/agent-ini\/testsuite\/multi\/private.out\nnew file mode 100644\nindex 00000000..33d74784\n--- \/dev\/null\n+++ b\/agent-ini\/testsuite\/multi\/private.out\n@@ -0,0 +1,25 @@\n+(nil)\n+multi\/private.in.1.test  -------------------------------\n+[Dialer Totalise]\n+  Compuserve = 0\n+  Provider = Totalise\n+  Phone = 08453001470\n+  Password = Secret password\n+[End]\n+\n+[Dialer force9]\n+  Provider = Force9\n+  Phone = 08451424000\n+[End]\n+multi\/private.in.2.test  -------------------------------\n+[Dialer arcor]\n+  Compuserve = 0\n+  Provider = Arcor\n+  Password = Public password\n+[End]\n+\n+[Dialer mobilcom]\n+  Compuserve = 0\n+  Provider = Mobilcom\n+  Phone = 0101901929\n+[End]\ndiff --git a\/agent-ini\/testsuite\/multi\/private.scr b\/agent-ini\/testsuite\/multi\/private.scr\nnew file mode 100644\nindex 00000000..3c61b906\n--- \/dev\/null\n+++ b\/agent-ini\/testsuite\/multi\/private.scr\n@@ -0,0 +1,24 @@\n+.\n+\n+`ag_ini(\n+  `IniAgent( [ \"multi\/private.in.*.test\" ],\n+    $[\n+      \"rewrite\" : [\n+\t[ \"multi\/private\\.in\\.(.)\\.test$\", \"multi\/private.in.%s.test\"],\n+      ],\n+      \"subindent\" : \"  \",\n+      \"comments\": [ \"^[ \\t]*#.*\", \"^[ \\t]*$\" ],\n+      \"sections\" : [\n+        $[\n+        \"begin\" : [ \"[ \\t]*\\\\[Dialer[ \\t]+(.*[^ \\t])[ \\t]*\\\\][ \\t]*\", \"[Dialer %s]\" ],\n+\t\"end\" : [ \"^[ \\t]*\\\\[End\\\\][ \\t]*$\", \"[End]\", ],\n+        ],\n+      ],\n+      \"params\" : [\n+        $[\n+        \"match\" : [ \"^[ \\t]*([^=]*[^ \\t=])[ \\t]*=[ \\t]*(.*[^ \\t]|)[ \\t]*$\" , \"%s = %s\"],\n+      ],\n+    ],\n+    ]\n+  )\n+)\ndiff --git a\/agent-ini\/testsuite\/multi\/private.ycp b\/agent-ini\/testsuite\/multi\/private.ycp\nnew file mode 100644\nindex 00000000..c7b2c77f\n--- \/dev\/null\n+++ b\/agent-ini\/testsuite\/multi\/private.ycp\n@@ -0,0 +1,26 @@\n+\/\/\n+\/\/ Multiple files test\n+\/\/\n+\/\/ providers.rpm\n+\/\/\n+\n+\n+{\n+    SCR::RegisterAgent (.target, `ag_system ());\n+    any out = nil;\n+\n+    SCR::Write (.v.\"1\".\"Totalise\".\"Password\", \"Secret password\");\n+    SCR::Write (.section_private.\"1\", true);\n+\n+    SCR::Write (.v.\"2\".\"arcor\".\"Password\", \"Public password\");\n+\n+    SCR::Write (., nil); \/\/flush\n+\n+    out = SCR::Execute (.target.bash_output, \"stat -c %a multi\/private.in.1.test\");\n+    y2milestone(\"secret file mode: %1\", out);\n+\n+    out = SCR::Execute (.target.bash_output, \"stat -c %a multi\/private.in.2.test\");\n+    y2milestone(\"public file mode: %1\", out);\n+\n+    return nil;\n+}\ndiff --git a\/agent-system\/src\/SystemAgent.cc b\/agent-system\/src\/SystemAgent.cc\nindex 4441f4d4..d34b2419 100644\n--- a\/agent-system\/src\/SystemAgent.cc\n+++ b\/agent-system\/src\/SystemAgent.cc\n@@ -709,25 +709,50 @@ SystemAgent::Write (const YCPPath& path, const YCPValue& value,\n     {\n \t\/**\n \t * @builtin Write (.target.string, string filename, string value) -> boolean\n+\t * @builtin Write (.target.string, [string filename, integer filemode] , string value) -> boolean\n \t * Writes the string <tt>value<\/tt> into a file. If the file already\n \t * exists, the existing file is overwritten. The return value is\n \t * true, if the file has been written successfully.\n+         *\n+         * @example Write(.target.string, \"\/etc\/papersize\", \"a4\") -> true\n+         * @example Write(.target.string, [\"\/etc\/rsyncd.secrets\", 0600], \"user:passwd\") -> true\n \t *\/\n \n-\tif (value.isNull() || !value->isString())\n+\tif (value.isNull() || !(value->isString() || value->isList()))\n \t{\n \t    ycp2error (\"Bad filename arg for Write (.string ...)\");\n \t    return YCPBoolean (false);\n \t}\n \n+\tstring filename;\n+\tmode_t filemode = 0644;\n+\n+\tif (value->isString())\n+\t{\n+\t    filename = value->asString()->value();\n+\t}\n+\telse\n+\t{\t\t\t\/\/ value is list\n+\t    YCPList flist = value->asList();\n+\t    if ((flist->size() != 2)\n+\t\t|| (!flist->value(0)->isString())\n+\t\t|| (!flist->value(1)->isInteger()))\n+\t    {\n+\t\tycp2error (\"Bad [filename, mode] list in call to Write (%s, [ string filename, integer mode ], ...)\",\n+\t\t    cmd.c_str ());\n+\t\treturn YCPBoolean (false);\n+\t    }\n+\t    filename = flist->value(0)->asString()->value();\n+\t    filemode = (int)(flist->value(1)->asInteger()->value());\n+\t}\n+\n \tif (arg.isNull() || !arg->isString())\n \t{\n \t    ycp2error (\"Bad string value for Write (.string ...)\");\n \t    return YCPBoolean (false);\n \t}\n \n-\tstring filename = value->asString()->value();\n-\tint fd = open(filename.c_str(), O_WRONLY | O_CREAT | O_TRUNC, 0644);\n+\tint fd = open(filename.c_str(), O_WRONLY | O_CREAT | O_TRUNC, filemode);\n \tif (fd >= 0)\n \t{\n \t    string cont = arg->asString()->value();\n@@ -1039,8 +1064,8 @@ SystemAgent::Execute (const YCPPath& path, const YCPValue& value,\n \t * Creates a symbolic link named newpath which contains the\n \t * string oldpath.\n \t *\n-\t * Symbolic links are interpreted at run-time as if the  con\n-\t * tents of the link had been substituted into the path being\n+\t * Symbolic links are interpreted at run-time as if the contents\n+\t * of the link had been substituted into the path being\n \t * followed to find a file or directory.\n \t *\n \t * The return value is true or false, depending of the success.\ndiff --git a\/agent-system\/testsuite\/tests\/string.out b\/agent-system\/testsuite\/tests\/string.out\nindex 00128e28..e76e1a80 100644\n--- a\/agent-system\/testsuite\/tests\/string.out\n+++ b\/agent-system\/testsuite\/tests\/string.out\n@@ -3,3 +3,4 @@\n (true)\n (nil)\n (\"never mind\")\n+(\"secret file mode: 600\\n\")\ndiff --git a\/agent-system\/testsuite\/tests\/string.ycp b\/agent-system\/testsuite\/tests\/string.ycp\nindex 96893a15..2b71cf10 100644\n--- a\/agent-system\/testsuite\/tests\/string.ycp\n+++ b\/agent-system\/testsuite\/tests\/string.ycp\n@@ -24,3 +24,13 @@\n     \/\/ this must not produce a error in the log\n     return SCR::Read (.string, [\"not-here.txt\", \"never mind\"]);\n }\n+\n+{\n+    map out = nil;\n+    string filename = \"tmp.secret.string\";\n+\n+    SCR::Write (.string, [filename, 0600], \"This is secret\\n\");\n+\n+    out = (map) SCR::Execute (.bash_output, \"stat -c %a \" + filename);\n+    return \"secret file mode: \" + out[\"stdout\"]:\"\";\n+}\ndiff --git a\/package\/yast2-core.changes b\/package\/yast2-core.changes\nindex 33ac13c0..82a7b217 100644\n--- a\/package\/yast2-core.changes\n+++ b\/package\/yast2-core.changes\n@@ -1,3 +1,11 @@\n+-------------------------------------------------------------------\n+Mon Nov  7 18:19:27 CET 2011 - mvidner@suse.cz\n+\n+- ini-agent: added Write(.section_private.SECTION, BOOLEAN)\n+  (bnc#713661, CVE-2011-3177)\n+- system agent: added  Write(.target.string, [filename, mode], content)\n+- 2.22.1\n+\n -------------------------------------------------------------------\n Fri Dec  2 11:49:56 UTC 2011 - lslezak@suse.cz\n \n","owner":"yast","repo":"yast-core","source":"cve"},{"CVE_ID":"CVE-2011-2909","CWE_ID":"200","category":"security","commit_id":"819cbb120eaec7e014e5abd029260db1ca8c5735","commit_message":"From 819cbb120eaec7e014e5abd029260db1ca8c5735 Mon Sep 17 00:00:00 2001\nFrom: Vasiliy Kulikov <segoon@openwall.com>\nDate: Sun, 26 Jun 2011 12:56:22 +0400\nSubject: staging: comedi: fix infoleak to userspace\n\ndriver_name and board_name are pointers to strings, not buffers of size\nCOMEDI_NAMELEN.  Copying COMEDI_NAMELEN bytes of a string containing\nless than COMEDI_NAMELEN-1 bytes would leak some unrelated bytes.\n\nSigned-off-by: Vasiliy Kulikov <segoon@openwall.com>\nCc: stable <stable@kernel.org>\nSigned-off-by: Greg Kroah-Hartman <gregkh@suse.de>\n---\n drivers\/staging\/comedi\/comedi_fops.c | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/staging\/comedi\/comedi_fops.c b\/drivers\/staging\/comedi\/comedi_fops.c\nindex 15a209f5b486..419976b40bf4 100644\n--- a\/drivers\/staging\/comedi\/comedi_fops.c\n+++ b\/drivers\/staging\/comedi\/comedi_fops.c\n@@ -383,8 +383,8 @@ static int do_devinfo_ioctl(struct comedi_device *dev,\n \t\/* fill devinfo structure *\/\n \tdevinfo.version_code = COMEDI_VERSION_CODE;\n \tdevinfo.n_subdevs = dev->n_subdevices;\n-\tmemcpy(devinfo.driver_name, dev->driver->driver_name, COMEDI_NAMELEN);\n-\tmemcpy(devinfo.board_name, dev->board_name, COMEDI_NAMELEN);\n+\tstrlcpy(devinfo.driver_name, dev->driver->driver_name, COMEDI_NAMELEN);\n+\tstrlcpy(devinfo.board_name, dev->board_name, COMEDI_NAMELEN);\n \n \tif (read_subdev)\n \t\tdevinfo.read_subdevice = read_subdev - dev->subdevices;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2019-12209","CWE_ID":"200","category":"security","commit_id":"7db3386fcdb454e33a3ea30dcfb8e8960d4c3aa3","commit_message":"From 7db3386fcdb454e33a3ea30dcfb8e8960d4c3aa3 Mon Sep 17 00:00:00 2001\nFrom: Gabriel Kihlman <g.kihlman@yubico.com>\nDate: Tue, 4 Jun 2019 10:06:41 +0200\nSubject: [PATCH] Drop privileges by default when opening user-related files\n\nThe module is typically executed as root and would sometimes\nopen files or follow symlinks that could be controlled from the\noutside.\n\nDrop privileges to the target user before opening any files.\n\nFixes CVE-2019-12209.\n\nThanks to Matthias Gerstner of the SUSE Security Team for reporting\nthe issue.\n---\n Makefile.am  |   1 +\n README       |  18 +++++++\n configure.ac |   4 ++\n drop_privs.c | 129 +++++++++++++++++++++++++++++++++++++++++++++++++++\n drop_privs.h |  64 +++++++++++++++++++++++++\n pam-u2f.c    |  31 +++++++++----\n 6 files changed, 238 insertions(+), 9 deletions(-)\n create mode 100644 drop_privs.c\n create mode 100644 drop_privs.h\n\n","diff_code":"diff --git a\/Makefile.am b\/Makefile.am\nindex c0d2d1e..d761939 100644\n--- a\/Makefile.am\n+++ b\/Makefile.am\n@@ -13,6 +13,7 @@ lib_LTLIBRARIES = pam_u2f.la\n \n pam_u2f_la_SOURCES = pam-u2f.c\n pam_u2f_la_SOURCES += util.c util.h\n+pam_u2f_la_SOURCES += drop_privs.h drop_privs.c\n \n pam_u2f_la_LIBADD = -lpam\n pam_u2f_la_LIBADD += $(LIBU2FHOST_LIBS) $(LIBU2FSERVER_LIBS)\ndiff --git a\/README b\/README\nindex a6247a3..04f9541 100644\n--- a\/README\n+++ b\/README\n@@ -114,6 +114,8 @@ openasuser::\n Setuid to the authenticating user when opening the authfile. Useful when the\n user's home is stored on an NFS volume mounted with the root_squash option\n (which maps root to nobody which will not be able to read the file).\n+Note that after release 1.0.8 this is done by default when no global\n+authfile or XDG_CONFIG_HOME environment variable has been set.\n \n alwaysok::\n Set to enable all authentication attempts to succeed (aka presentation mode).\n@@ -164,6 +166,11 @@ mappings will not be used and the opposite applies if user home directory\n mappings are being used, the central authorization mappings file will not\n be used.\n \n+By default the mapping file inside a home directory will be opened as\n+the target user, whereas the central file will be opened as `root`. If\n+the `XDG_CONFIG_HOME` variable is set, privileges will not be dropped\n+unless the `openasuser` configuration setting is set.\n+\n IMPORTANT: Using pam-u2f to secure the login to a computer while\n storing the mapping file in an encrypted home directory, will result\n in the impossibility of logging into the system. The partition is\n@@ -184,6 +191,10 @@ looks like:\n \n  auth sufficient pam_u2f.so authfile=\/etc\/u2f_mappings\n \n+If you do not set the `openasuser` setting, the authfile will be opened\n+and parsed as `root` so make sure it has the correct owner and\n+permissions set.\n+\n IMPORTANT: On dynamics networks (e.g. where hostnames are set by DHCP),\n users should not rely on the default origin and appid (\"pam:\/\/$HOSTNAME\")\n but set those parameters explicitly to the same value.\n@@ -197,6 +208,13 @@ line:\n \n This is much the same concept as the SSH authorized_keys file.\n \n+In this case, pam-u2f will drop privileges and read the mapping file\n+as that user. This happens regardless of the `openasuser` option being\n+set.\n+\n+Note that if you set the XDG_CONFIG_HOME variable, privileges will not\n+be dropped by default. Consider also setting `openasuser` in that case.\n+\n [[registration]]\n Obtaining key-handles and public keys\n -------------------------------------\ndiff --git a\/configure.ac b\/configure.ac\nindex 58fedcc..1ec2566 100644\n--- a\/configure.ac\n+++ b\/configure.ac\n@@ -37,6 +37,8 @@ AC_CHECK_HEADERS([security\/pam_modules.h security\/_pam_macros.h security\/pam_mod\n    #include <security\/pam_appl.h>])\n AC_CHECK_LIB([pam], [pam_start])\n \n+AC_SEARCH_LIBS([pam_modutil_drop_priv], [\"pam\"], [AC_DEFINE([HAVE_PAM_MODUTIL_DROP_PRIV], [1])])\n+\n case \"$host\" in\n      *darwin*)  PAMDIR=\"\/usr\/lib\/pam\";;\n      *linux*)   PAMDIR=\"\/lib\/x86_64-linux-gnu\/security\";;\n@@ -71,6 +73,8 @@ AC_ARG_VAR([CWFLAGS], [Warning flags])\n AX_CHECK_COMPILE_FLAG([-Wall], [CWFLAGS=\"-Wall\"])\n AX_CHECK_COMPILE_FLAG([-Wextra], [CWFLAGS=\"$CWFLAGS -Wextra\"])\n AX_CHECK_COMPILE_FLAG([-Wconversion], [CWFLAGS=\"$CWFLAGS -Wconversion\"])\n+# Because pam headers are doing sign-conversion, see PAM_MODUTIL_DEF_PRIVS in pam_modutil.h\n+AX_CHECK_COMPILE_FLAG([-Wconversion], [CWFLAGS=\"$CWFLAGS -Wno-sign-conversion\"])\n AX_CHECK_COMPILE_FLAG([-Wpedantic], [CWFLAGS=\"$CWFLAGS -Wpedantic\"])\n AX_CHECK_COMPILE_FLAG([-Wformat=2], [CWFLAGS=\"$CWFLAGS -Wformat=2\"])\n AX_CHECK_COMPILE_FLAG([-Wstrict-prototypes], [CWFLAGS=\"$CWFLAGS -Wstrict-prototypes\"])\ndiff --git a\/drop_privs.c b\/drop_privs.c\nnew file mode 100644\nindex 0000000..7fe35c5\n--- \/dev\/null\n+++ b\/drop_privs.c\n@@ -0,0 +1,129 @@\n+\/* Written by Ricky Zhou <ricky@fedoraproject.org>\n+ * Fredrik Thulin <fredrik@yubico.com> implemented pam_modutil_drop_priv\n+ *\n+ * Copyright (c) 2011-2014 Yubico AB\n+ * Copyright (c) 2011 Ricky Zhou <ricky@fedoraproject.org>\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are\n+ * met:\n+ *\n+ *     * Redistributions of source code must retain the above copyright\n+ *       notice, this list of conditions and the following disclaimer.\n+ *\n+ *     * Redistributions in binary form must reproduce the above\n+ *       copyright notice, this list of conditions and the following\n+ *       disclaimer in the documentation and\/or other materials provided\n+ *       with the distribution.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n+ * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n+ * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n+ * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n+ * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n+ * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n+ * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ *\/\n+\n+#ifndef HAVE_PAM_MODUTIL_DROP_PRIV\n+\n+#include <unistd.h>\n+#include <pwd.h>\n+#include <grp.h>\n+#include <errno.h>\n+#include <string.h>\n+#include <stdlib.h>\n+\n+#include \"drop_privs.h\"\n+#include \"util.h\"\n+\n+#ifdef HAVE_SECURITY_PAM_APPL_H\n+#include <security\/pam_appl.h>\n+#endif\n+#ifdef HAVE_SECURITY_PAM_MODULES_H\n+#include <security\/pam_modules.h>\n+#endif\n+\n+\n+int pam_modutil_drop_priv(pam_handle_t *pamh, struct _ykpam_privs *privs, struct passwd *pw) {\n+    privs->saved_euid = geteuid();\n+    privs->saved_egid = getegid();\n+\n+    if ((privs->saved_euid == pw->pw_uid) && (privs->saved_egid == pw->pw_gid)) {\n+        D (privs->debug_file, \"Privilges already dropped, pretend it is all right\");\n+        return 0;\n+    }\n+\n+    privs->saved_groups_length = getgroups(0, NULL);\n+    if (privs->saved_groups_length < 0) {\n+        D (privs->debug_file, \"getgroups: %s\", strerror(errno));\n+        return -1;\n+    }\n+\n+    if (privs->saved_groups_length > SAVED_GROUPS_MAX_LEN) {\n+        D (privs->debug_file, \"too many groups, limiting.\");\n+        privs->saved_groups_length = SAVED_GROUPS_MAX_LEN;\n+    }\n+\n+    if (privs->saved_groups_length > 0) {\n+        if (getgroups(privs->saved_groups_length, privs->saved_groups) < 0) {\n+            D (privs->debug_file, \"getgroups: %s\", strerror(errno));\n+            goto free_out;\n+        }\n+    }\n+\n+    if (initgroups(pw->pw_name, pw->pw_gid) < 0) {\n+        D (privs->debug_file, \"initgroups: %s\", strerror(errno));\n+        goto free_out;\n+    }\n+\n+    if (setegid(pw->pw_gid) < 0) {\n+        D (privs->debug_file, \"setegid: %s\", strerror(errno));\n+        goto free_out;\n+    }\n+\n+    if (seteuid(pw->pw_uid) < 0) {\n+        D (privs->debug_file, \"seteuid: %s\", strerror(errno));\n+        goto free_out;\n+    }\n+\n+    return 0;\n+free_out:\n+    return -1;\n+}\n+\n+int pam_modutil_regain_priv(pam_handle_t *pamh, struct _ykpam_privs *privs) {\n+    if ((privs->saved_euid == geteuid()) && (privs->saved_egid == getegid())) {\n+        D (privs->debug_file, \"Privilges already as requested, pretend it is all right\");\n+        return 0;\n+    }\n+\n+    if (seteuid(privs->saved_euid) < 0) {\n+        D (privs->debug_file, \"seteuid: %s\", strerror(errno));\n+        return -1;\n+    }\n+\n+    if (setegid(privs->saved_egid) < 0) {\n+        D (privs->debug_file, \"setegid: %s\", strerror(errno));\n+        return -1;\n+    }\n+\n+    if (setgroups(privs->saved_groups_length, privs->saved_groups) < 0) {\n+        D (privs->debug_file, \"setgroups: %s\", strerror(errno));\n+        return -1;\n+    }\n+\n+    return 0;\n+}\n+\n+#else\n+\n+\/\/ drop_privs.c:124: warning: ISO C forbids an empty translation unit [-Wpedantic]\n+typedef int make_iso_compilers_happy;\n+\n+#endif \/\/ HAVE_PAM_MODUTIL_DROP_PRIV\ndiff --git a\/drop_privs.h b\/drop_privs.h\nnew file mode 100644\nindex 0000000..2d25a19\n--- \/dev\/null\n+++ b\/drop_privs.h\n@@ -0,0 +1,64 @@\n+\/* Copyright (c) 2011-2014 Yubico AB\n+ * All rights reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions are\n+ * met:\n+ *\n+ *     * Redistributions of source code must retain the above copyright\n+ *       notice, this list of conditions and the following disclaimer.\n+ *\n+ *     * Redistributions in binary form must reproduce the above\n+ *       copyright notice, this list of conditions and the following\n+ *       disclaimer in the documentation and\/or other materials provided\n+ *       with the distribution.\n+ *\n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n+ * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n+ * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n+ * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n+ * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n+ * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n+ * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ *\/\n+\n+#ifndef __PAM_U2F_DROP_PRIVS_H_INCLUDED__\n+#define __PAM_U2F_DROP_PRIVS_H_INCLUDED__\n+\n+#ifdef HAVE_PAM_MODUTIL_DROP_PRIV\n+#include <security\/pam_modutil.h>\n+#else\n+\n+#include <pwd.h>\n+#include <stdio.h>\n+\n+#ifdef HAVE_SECURITY_PAM_APPL_H\n+#include <security\/pam_appl.h>\n+#endif\n+#ifdef HAVE_SECURITY_PAM_MODULES_H\n+#include <security\/pam_modules.h>\n+#endif\n+\n+#define SAVED_GROUPS_MAX_LEN 64 \/* as pam_modutil.. *\/\n+\n+struct _ykpam_privs {\n+  uid_t saved_euid;\n+  gid_t saved_egid;\n+  gid_t *saved_groups;\n+  int saved_groups_length;\n+  FILE *debug_file;\n+};\n+\n+#define PAM_MODUTIL_DEF_PRIVS(n) \\\n+  gid_t n##_saved_groups[SAVED_GROUPS_MAX_LEN]; \\\n+  struct _ykpam_privs n = {-1, -1, n##_saved_groups, SAVED_GROUPS_MAX_LEN, cfg->debug_file}\n+\n+int pam_modutil_drop_priv(pam_handle_t *, struct _ykpam_privs *, struct passwd *);\n+int pam_modutil_regain_priv(pam_handle_t *, struct _ykpam_privs *);\n+\n+#endif\n+#endif\ndiff --git a\/pam-u2f.c b\/pam-u2f.c\nindex 071d005..b01697c 100644\n--- a\/pam-u2f.c\n+++ b\/pam-u2f.c\n@@ -20,6 +20,7 @@\n #include <errno.h>\n \n #include \"util.h\"\n+#include \"drop_privs.h\"\n \n \/* If secure_getenv is not defined, define it here *\/\n #ifndef HAVE_SECURE_GETENV\n@@ -148,11 +149,12 @@ int pam_sm_authenticate(pam_handle_t *pamh, int flags, int argc,\n   int retval = PAM_IGNORE;\n   device_t *devices = NULL;\n   unsigned n_devices = 0;\n-  int openasuser;\n+  int openasuser = 0;\n   int should_free_origin = 0;\n   int should_free_appid = 0;\n   int should_free_auth_file = 0;\n   int should_free_authpending_file = 0;\n+  PAM_MODUTIL_DEF_PRIVS(privs);\n \n   parse_cfg(flags, argc, argv, cfg);\n \n@@ -235,6 +237,9 @@ int pam_sm_authenticate(pam_handle_t *pamh, int flags, int argc,\n         goto done;\n       }\n \n+      \/* Opening a file in a users $HOME, need to drop privs for security *\/\n+      openasuser = geteuid() == 0 ? 1 : 0;\n+\n       snprintf(buf, authfile_dir_len,\n                \"%s\/.config%s\", pw->pw_dir, DEFAULT_AUTHFILE);\n     } else {\n@@ -250,9 +255,14 @@ int pam_sm_authenticate(pam_handle_t *pamh, int flags, int argc,\n \n       snprintf(buf, authfile_dir_len,\n                \"%s%s\", authfile_dir, DEFAULT_AUTHFILE);\n+\n+      if (!openasuser) {\n+\tDBG(\"WARNING: not dropping privileges when reading %s, please \"\n+\t    \"consider setting openasuser=1 in the module configuration\", buf);\n+      }\n     }\n \n-    DBG(\"Using default authentication file %s\", buf);\n+    DBG(\"Using authentication file %s\", buf);\n \n     cfg->auth_file = buf; \/* cfg takes ownership *\/\n     should_free_auth_file = 1;\n@@ -261,25 +271,28 @@ int pam_sm_authenticate(pam_handle_t *pamh, int flags, int argc,\n     DBG(\"Using authentication file %s\", cfg->auth_file);\n   }\n \n-  openasuser = geteuid() == 0 && cfg->openasuser;\n+  if (!openasuser) {\n+    openasuser = geteuid() == 0 && cfg->openasuser;\n+  }\n   if (openasuser) {\n-    if (seteuid(pw_s.pw_uid)) {\n-      DBG(\"Unable to switch user to uid %i\", pw_s.pw_uid);\n+    DBG(\"Dropping privileges\");\n+    if (pam_modutil_drop_priv(pamh, &privs, pw)) {\n+      DBG(\"Unable to switch user to uid %i\", pw->pw_uid);\n       retval = PAM_IGNORE;\n       goto done;\n     }\n-    DBG(\"Switched to uid %i\", pw_s.pw_uid);\n+    DBG(\"Switched to uid %i\", pw->pw_uid);\n   }\n   retval = get_devices_from_authfile(cfg->auth_file, user, cfg->max_devs,\n                                      cfg->debug, cfg->debug_file,\n                                      devices, &n_devices);\n   if (openasuser) {\n-    if (seteuid(0)) {\n-      DBG(\"Unable to switch back to uid 0\");\n+    if (pam_modutil_regain_priv(pamh, &privs)) {\n+      DBG(\"could not restore privileges\");\n       retval = PAM_IGNORE;\n       goto done;\n     }\n-    DBG(\"Switched back to uid 0\");\n+    DBG(\"Restored privileges\");\n   }\n \n   if (retval != 1) {\n","owner":"Yubico","repo":"pam-u2f","source":"cve"},{"CVE_ID":"CVE-2016-4913","CWE_ID":"200","category":"security","commit_id":"99d825822eade8d827a1817357cbf3f889a552d6","commit_message":"From 99d825822eade8d827a1817357cbf3f889a552d6 Mon Sep 17 00:00:00 2001\nFrom: Al Viro <viro@zeniv.linux.org.uk>\nDate: Thu, 5 May 2016 16:25:35 -0400\nSubject: [PATCH] get_rock_ridge_filename(): handle malformed NM entries\n\nPayloads of NM entries are not supposed to contain NUL.  When we run\ninto such, only the part prior to the first NUL goes into the\nconcatenation (i.e. the directory entry name being encoded by a bunch\nof NM entries).  We do stop when the amount collected so far + the\nclaimed amount in the current NM entry exceed 254.  So far, so good,\nbut what we return as the total length is the sum of *claimed*\nsizes, not the actual amount collected.  And that can grow pretty\nlarge - not unlimited, since you'd need to put CE entries in\nbetween to be able to get more than the maximum that could be\ncontained in one isofs directory entry \/ continuation chunk and\nwe are stop once we'd encountered 32 CEs, but you can get about 8Kb\neasily.  And that's what will be passed to readdir callback as the\nname length.  8Kb __copy_to_user() from a buffer allocated by\n__get_free_page()\n\nCc: stable@vger.kernel.org # 0.98pl6+ (yes, really)\nSigned-off-by: Al Viro <viro@zeniv.linux.org.uk>\n---\n fs\/isofs\/rock.c | 13 ++++++++++---\n 1 file changed, 10 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/fs\/isofs\/rock.c b\/fs\/isofs\/rock.c\nindex 5384ceb35b1cc..98b3eb7d8eaf6 100644\n--- a\/fs\/isofs\/rock.c\n+++ b\/fs\/isofs\/rock.c\n@@ -203,6 +203,8 @@ int get_rock_ridge_filename(struct iso_directory_record *de,\n \tint retnamlen = 0;\n \tint truncate = 0;\n \tint ret = 0;\n+\tchar *p;\n+\tint len;\n \n \tif (!ISOFS_SB(inode->i_sb)->s_rock)\n \t\treturn 0;\n@@ -267,12 +269,17 @@ int get_rock_ridge_filename(struct iso_directory_record *de,\n \t\t\t\t\trr->u.NM.flags);\n \t\t\t\tbreak;\n \t\t\t}\n-\t\t\tif ((strlen(retname) + rr->len - 5) >= 254) {\n+\t\t\tlen = rr->len - 5;\n+\t\t\tif (retnamlen + len >= 254) {\n \t\t\t\ttruncate = 1;\n \t\t\t\tbreak;\n \t\t\t}\n-\t\t\tstrncat(retname, rr->u.NM.name, rr->len - 5);\n-\t\t\tretnamlen += rr->len - 5;\n+\t\t\tp = memchr(rr->u.NM.name, '\\0', len);\n+\t\t\tif (unlikely(p))\n+\t\t\t\tlen = p - rr->u.NM.name;\n+\t\t\tmemcpy(retname + retnamlen, rr->u.NM.name, len);\n+\t\t\tretnamlen += len;\n+\t\t\tretname[retnamlen] = '\\0';\n \t\t\tbreak;\n \t\tcase SIG('R', 'E'):\n \t\t\tkfree(rs.buffer);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2018-19854","CWE_ID":"200","category":"security","commit_id":"f43f39958beb206b53292801e216d9b8a660f087","commit_message":"From f43f39958beb206b53292801e216d9b8a660f087 Mon Sep 17 00:00:00 2001\nFrom: Eric Biggers <ebiggers@google.com>\nDate: Sat, 3 Nov 2018 14:56:00 -0700\nSubject: crypto: user - fix leaking uninitialized memory to userspace\n\nAll bytes of the NETLINK_CRYPTO report structures must be initialized,\nsince they are copied to userspace.  The change from strncpy() to\nstrlcpy() broke this.  As a minimal fix, change it back.\n\nFixes: 4473710df1f8 (\"crypto: user - Prepare for CRYPTO_MAX_ALG_NAME expansion\")\nCc: <stable@vger.kernel.org> # v4.12+\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>\n---\n crypto\/crypto_user_base.c | 18 +++++++++---------\n 1 file changed, 9 insertions(+), 9 deletions(-)\n\n","diff_code":"diff --git a\/crypto\/crypto_user_base.c b\/crypto\/crypto_user_base.c\nindex e41f6cc33fff..784748dbb19f 100644\n--- a\/crypto\/crypto_user_base.c\n+++ b\/crypto\/crypto_user_base.c\n@@ -84,7 +84,7 @@ static int crypto_report_cipher(struct sk_buff *skb, struct crypto_alg *alg)\n {\n \tstruct crypto_report_cipher rcipher;\n \n-\tstrlcpy(rcipher.type, \"cipher\", sizeof(rcipher.type));\n+\tstrncpy(rcipher.type, \"cipher\", sizeof(rcipher.type));\n \n \trcipher.blocksize = alg->cra_blocksize;\n \trcipher.min_keysize = alg->cra_cipher.cia_min_keysize;\n@@ -103,7 +103,7 @@ static int crypto_report_comp(struct sk_buff *skb, struct crypto_alg *alg)\n {\n \tstruct crypto_report_comp rcomp;\n \n-\tstrlcpy(rcomp.type, \"compression\", sizeof(rcomp.type));\n+\tstrncpy(rcomp.type, \"compression\", sizeof(rcomp.type));\n \tif (nla_put(skb, CRYPTOCFGA_REPORT_COMPRESS,\n \t\t    sizeof(struct crypto_report_comp), &rcomp))\n \t\tgoto nla_put_failure;\n@@ -117,7 +117,7 @@ static int crypto_report_acomp(struct sk_buff *skb, struct crypto_alg *alg)\n {\n \tstruct crypto_report_acomp racomp;\n \n-\tstrlcpy(racomp.type, \"acomp\", sizeof(racomp.type));\n+\tstrncpy(racomp.type, \"acomp\", sizeof(racomp.type));\n \n \tif (nla_put(skb, CRYPTOCFGA_REPORT_ACOMP,\n \t\t    sizeof(struct crypto_report_acomp), &racomp))\n@@ -132,7 +132,7 @@ static int crypto_report_akcipher(struct sk_buff *skb, struct crypto_alg *alg)\n {\n \tstruct crypto_report_akcipher rakcipher;\n \n-\tstrlcpy(rakcipher.type, \"akcipher\", sizeof(rakcipher.type));\n+\tstrncpy(rakcipher.type, \"akcipher\", sizeof(rakcipher.type));\n \n \tif (nla_put(skb, CRYPTOCFGA_REPORT_AKCIPHER,\n \t\t    sizeof(struct crypto_report_akcipher), &rakcipher))\n@@ -147,7 +147,7 @@ static int crypto_report_kpp(struct sk_buff *skb, struct crypto_alg *alg)\n {\n \tstruct crypto_report_kpp rkpp;\n \n-\tstrlcpy(rkpp.type, \"kpp\", sizeof(rkpp.type));\n+\tstrncpy(rkpp.type, \"kpp\", sizeof(rkpp.type));\n \n \tif (nla_put(skb, CRYPTOCFGA_REPORT_KPP,\n \t\t    sizeof(struct crypto_report_kpp), &rkpp))\n@@ -161,10 +161,10 @@ nla_put_failure:\n static int crypto_report_one(struct crypto_alg *alg,\n \t\t\t     struct crypto_user_alg *ualg, struct sk_buff *skb)\n {\n-\tstrlcpy(ualg->cru_name, alg->cra_name, sizeof(ualg->cru_name));\n-\tstrlcpy(ualg->cru_driver_name, alg->cra_driver_name,\n+\tstrncpy(ualg->cru_name, alg->cra_name, sizeof(ualg->cru_name));\n+\tstrncpy(ualg->cru_driver_name, alg->cra_driver_name,\n \t\tsizeof(ualg->cru_driver_name));\n-\tstrlcpy(ualg->cru_module_name, module_name(alg->cra_module),\n+\tstrncpy(ualg->cru_module_name, module_name(alg->cra_module),\n \t\tsizeof(ualg->cru_module_name));\n \n \tualg->cru_type = 0;\n@@ -177,7 +177,7 @@ static int crypto_report_one(struct crypto_alg *alg,\n \tif (alg->cra_flags & CRYPTO_ALG_LARVAL) {\n \t\tstruct crypto_report_larval rl;\n \n-\t\tstrlcpy(rl.type, \"larval\", sizeof(rl.type));\n+\t\tstrncpy(rl.type, \"larval\", sizeof(rl.type));\n \t\tif (nla_put(skb, CRYPTOCFGA_REPORT_LARVAL,\n \t\t\t    sizeof(struct crypto_report_larval), &rl))\n \t\t\tgoto nla_put_failure;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2010-4158","CWE_ID":"200","category":"security","commit_id":"57fe93b374a6b8711995c2d466c502af9f3a08bb","commit_message":"From 57fe93b374a6b8711995c2d466c502af9f3a08bb Mon Sep 17 00:00:00 2001\nFrom: \"David S. Miller\" <davem@davemloft.net>\nDate: Wed, 10 Nov 2010 10:38:24 -0800\nSubject: filter: make sure filters dont read uninitialized memory\n\nThere is a possibility malicious users can get limited information about\nuninitialized stack mem array. Even if sk_run_filter() result is bound\nto packet length (0 .. 65535), we could imagine this can be used by\nhostile user.\n\nInitializing mem[] array, like Dan Rosenberg suggested in his patch is\nexpensive since most filters dont even use this array.\n\nIts hard to make the filter validation in sk_chk_filter(), because of\nthe jumps. This might be done later.\n\nIn this patch, I use a bitmap (a single long var) so that only filters\nusing mem[] loads\/stores pay the price of added security checks.\n\nFor other filters, additional cost is a single instruction.\n\n[ Since we access fentry->k a lot now, cache it in a local variable\n  and mark filter entry pointer as const. -DaveM ]\n\nReported-by: Dan Rosenberg <drosenberg@vsecurity.com>\nSigned-off-by: Eric Dumazet <eric.dumazet@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/core\/filter.c | 64 ++++++++++++++++++++++++++++++-------------------------\n 1 file changed, 35 insertions(+), 29 deletions(-)\n\n","diff_code":"diff --git a\/net\/core\/filter.c b\/net\/core\/filter.c\nindex 7beaec36b541..23e9b2a6b4c8 100644\n--- a\/net\/core\/filter.c\n+++ b\/net\/core\/filter.c\n@@ -112,39 +112,41 @@ EXPORT_SYMBOL(sk_filter);\n  *\/\n unsigned int sk_run_filter(struct sk_buff *skb, struct sock_filter *filter, int flen)\n {\n-\tstruct sock_filter *fentry;\t\/* We walk down these *\/\n \tvoid *ptr;\n \tu32 A = 0;\t\t\t\/* Accumulator *\/\n \tu32 X = 0;\t\t\t\/* Index Register *\/\n \tu32 mem[BPF_MEMWORDS];\t\t\/* Scratch Memory Store *\/\n+\tunsigned long memvalid = 0;\n \tu32 tmp;\n \tint k;\n \tint pc;\n \n+\tBUILD_BUG_ON(BPF_MEMWORDS > BITS_PER_LONG);\n \t\/*\n \t * Process array of filter instructions.\n \t *\/\n \tfor (pc = 0; pc < flen; pc++) {\n-\t\tfentry = &filter[pc];\n+\t\tconst struct sock_filter *fentry = &filter[pc];\n+\t\tu32 f_k = fentry->k;\n \n \t\tswitch (fentry->code) {\n \t\tcase BPF_S_ALU_ADD_X:\n \t\t\tA += X;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_ADD_K:\n-\t\t\tA += fentry->k;\n+\t\t\tA += f_k;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_SUB_X:\n \t\t\tA -= X;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_SUB_K:\n-\t\t\tA -= fentry->k;\n+\t\t\tA -= f_k;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_MUL_X:\n \t\t\tA *= X;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_MUL_K:\n-\t\t\tA *= fentry->k;\n+\t\t\tA *= f_k;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_DIV_X:\n \t\t\tif (X == 0)\n@@ -152,49 +154,49 @@ unsigned int sk_run_filter(struct sk_buff *skb, struct sock_filter *filter, int\n \t\t\tA \/= X;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_DIV_K:\n-\t\t\tA \/= fentry->k;\n+\t\t\tA \/= f_k;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_AND_X:\n \t\t\tA &= X;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_AND_K:\n-\t\t\tA &= fentry->k;\n+\t\t\tA &= f_k;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_OR_X:\n \t\t\tA |= X;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_OR_K:\n-\t\t\tA |= fentry->k;\n+\t\t\tA |= f_k;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_LSH_X:\n \t\t\tA <<= X;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_LSH_K:\n-\t\t\tA <<= fentry->k;\n+\t\t\tA <<= f_k;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_RSH_X:\n \t\t\tA >>= X;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_RSH_K:\n-\t\t\tA >>= fentry->k;\n+\t\t\tA >>= f_k;\n \t\t\tcontinue;\n \t\tcase BPF_S_ALU_NEG:\n \t\t\tA = -A;\n \t\t\tcontinue;\n \t\tcase BPF_S_JMP_JA:\n-\t\t\tpc += fentry->k;\n+\t\t\tpc += f_k;\n \t\t\tcontinue;\n \t\tcase BPF_S_JMP_JGT_K:\n-\t\t\tpc += (A > fentry->k) ? fentry->jt : fentry->jf;\n+\t\t\tpc += (A > f_k) ? fentry->jt : fentry->jf;\n \t\t\tcontinue;\n \t\tcase BPF_S_JMP_JGE_K:\n-\t\t\tpc += (A >= fentry->k) ? fentry->jt : fentry->jf;\n+\t\t\tpc += (A >= f_k) ? fentry->jt : fentry->jf;\n \t\t\tcontinue;\n \t\tcase BPF_S_JMP_JEQ_K:\n-\t\t\tpc += (A == fentry->k) ? fentry->jt : fentry->jf;\n+\t\t\tpc += (A == f_k) ? fentry->jt : fentry->jf;\n \t\t\tcontinue;\n \t\tcase BPF_S_JMP_JSET_K:\n-\t\t\tpc += (A & fentry->k) ? fentry->jt : fentry->jf;\n+\t\t\tpc += (A & f_k) ? fentry->jt : fentry->jf;\n \t\t\tcontinue;\n \t\tcase BPF_S_JMP_JGT_X:\n \t\t\tpc += (A > X) ? fentry->jt : fentry->jf;\n@@ -209,7 +211,7 @@ unsigned int sk_run_filter(struct sk_buff *skb, struct sock_filter *filter, int\n \t\t\tpc += (A & X) ? fentry->jt : fentry->jf;\n \t\t\tcontinue;\n \t\tcase BPF_S_LD_W_ABS:\n-\t\t\tk = fentry->k;\n+\t\t\tk = f_k;\n load_w:\n \t\t\tptr = load_pointer(skb, k, 4, &tmp);\n \t\t\tif (ptr != NULL) {\n@@ -218,7 +220,7 @@ load_w:\n \t\t\t}\n \t\t\tbreak;\n \t\tcase BPF_S_LD_H_ABS:\n-\t\t\tk = fentry->k;\n+\t\t\tk = f_k;\n load_h:\n \t\t\tptr = load_pointer(skb, k, 2, &tmp);\n \t\t\tif (ptr != NULL) {\n@@ -227,7 +229,7 @@ load_h:\n \t\t\t}\n \t\t\tbreak;\n \t\tcase BPF_S_LD_B_ABS:\n-\t\t\tk = fentry->k;\n+\t\t\tk = f_k;\n load_b:\n \t\t\tptr = load_pointer(skb, k, 1, &tmp);\n \t\t\tif (ptr != NULL) {\n@@ -242,32 +244,34 @@ load_b:\n \t\t\tX = skb->len;\n \t\t\tcontinue;\n \t\tcase BPF_S_LD_W_IND:\n-\t\t\tk = X + fentry->k;\n+\t\t\tk = X + f_k;\n \t\t\tgoto load_w;\n \t\tcase BPF_S_LD_H_IND:\n-\t\t\tk = X + fentry->k;\n+\t\t\tk = X + f_k;\n \t\t\tgoto load_h;\n \t\tcase BPF_S_LD_B_IND:\n-\t\t\tk = X + fentry->k;\n+\t\t\tk = X + f_k;\n \t\t\tgoto load_b;\n \t\tcase BPF_S_LDX_B_MSH:\n-\t\t\tptr = load_pointer(skb, fentry->k, 1, &tmp);\n+\t\t\tptr = load_pointer(skb, f_k, 1, &tmp);\n \t\t\tif (ptr != NULL) {\n \t\t\t\tX = (*(u8 *)ptr & 0xf) << 2;\n \t\t\t\tcontinue;\n \t\t\t}\n \t\t\treturn 0;\n \t\tcase BPF_S_LD_IMM:\n-\t\t\tA = fentry->k;\n+\t\t\tA = f_k;\n \t\t\tcontinue;\n \t\tcase BPF_S_LDX_IMM:\n-\t\t\tX = fentry->k;\n+\t\t\tX = f_k;\n \t\t\tcontinue;\n \t\tcase BPF_S_LD_MEM:\n-\t\t\tA = mem[fentry->k];\n+\t\t\tA = (memvalid & (1UL << f_k)) ?\n+\t\t\t\tmem[f_k] : 0;\n \t\t\tcontinue;\n \t\tcase BPF_S_LDX_MEM:\n-\t\t\tX = mem[fentry->k];\n+\t\t\tX = (memvalid & (1UL << f_k)) ?\n+\t\t\t\tmem[f_k] : 0;\n \t\t\tcontinue;\n \t\tcase BPF_S_MISC_TAX:\n \t\t\tX = A;\n@@ -276,14 +280,16 @@ load_b:\n \t\t\tA = X;\n \t\t\tcontinue;\n \t\tcase BPF_S_RET_K:\n-\t\t\treturn fentry->k;\n+\t\t\treturn f_k;\n \t\tcase BPF_S_RET_A:\n \t\t\treturn A;\n \t\tcase BPF_S_ST:\n-\t\t\tmem[fentry->k] = A;\n+\t\t\tmemvalid |= 1UL << f_k;\n+\t\t\tmem[f_k] = A;\n \t\t\tcontinue;\n \t\tcase BPF_S_STX:\n-\t\t\tmem[fentry->k] = X;\n+\t\t\tmemvalid |= 1UL << f_k;\n+\t\t\tmem[f_k] = X;\n \t\t\tcontinue;\n \t\tdefault:\n \t\t\tWARN_ON(1);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2010-3876","CWE_ID":"200","category":"security","commit_id":"67286640f638f5ad41a946b9a3dc75327950248f","commit_message":"From 67286640f638f5ad41a946b9a3dc75327950248f Mon Sep 17 00:00:00 2001\nFrom: Vasiliy Kulikov <segooon@gmail.com>\nDate: Wed, 10 Nov 2010 12:09:10 -0800\nSubject: net: packet: fix information leak to userland\n\npacket_getname_spkt() doesn't initialize all members of sa_data field of\nsockaddr struct if strlen(dev->name) < 13.  This structure is then copied\nto userland.  It leads to leaking of contents of kernel stack memory.\nWe have to fully fill sa_data with strncpy() instead of strlcpy().\n\nThe same with packet_getname(): it doesn't initialize sll_pkttype field of\nsockaddr_ll.  Set it to zero.\n\nSigned-off-by: Vasiliy Kulikov <segooon@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/packet\/af_packet.c | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/packet\/af_packet.c b\/net\/packet\/af_packet.c\nindex 3616f27b9d46..0856a13cb53d 100644\n--- a\/net\/packet\/af_packet.c\n+++ b\/net\/packet\/af_packet.c\n@@ -1719,7 +1719,7 @@ static int packet_getname_spkt(struct socket *sock, struct sockaddr *uaddr,\n \trcu_read_lock();\n \tdev = dev_get_by_index_rcu(sock_net(sk), pkt_sk(sk)->ifindex);\n \tif (dev)\n-\t\tstrlcpy(uaddr->sa_data, dev->name, 15);\n+\t\tstrncpy(uaddr->sa_data, dev->name, 14);\n \telse\n \t\tmemset(uaddr->sa_data, 0, 14);\n \trcu_read_unlock();\n@@ -1742,6 +1742,7 @@ static int packet_getname(struct socket *sock, struct sockaddr *uaddr,\n \tsll->sll_family = AF_PACKET;\n \tsll->sll_ifindex = po->ifindex;\n \tsll->sll_protocol = po->num;\n+\tsll->sll_pkttype = 0;\n \trcu_read_lock();\n \tdev = dev_get_by_index_rcu(sock_net(sk), po->ifindex);\n \tif (dev) {\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2010-4655","CWE_ID":"200","category":"security","commit_id":"b00916b189d13a615ff05c9242201135992fcda3","commit_message":"From b00916b189d13a615ff05c9242201135992fcda3 Mon Sep 17 00:00:00 2001\nFrom: Kees Cook <kees.cook@canonical.com>\nDate: Mon, 11 Oct 2010 12:23:25 -0700\nSubject: net: clear heap allocations for privileged ethtool actions\n\nSeveral other ethtool functions leave heap uncleared (potentially) by\ndrivers. Some interfaces appear safe (eeprom, etc), in that the sizes\nare well controlled. In some situations (e.g. unchecked error conditions),\nthe heap will remain unchanged in areas before copying back to userspace.\nNote that these are less of an issue since these all require CAP_NET_ADMIN.\n\nCc: stable@kernel.org\nSigned-off-by: Kees Cook <kees.cook@canonical.com>\nAcked-by: Ben Hutchings <bhutchings@solarflare.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/core\/ethtool.c | 6 +++---\n 1 file changed, 3 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/net\/core\/ethtool.c b\/net\/core\/ethtool.c\nindex 4016ac6bdd5e..8451ab481095 100644\n--- a\/net\/core\/ethtool.c\n+++ b\/net\/core\/ethtool.c\n@@ -397,7 +397,7 @@ static noinline_for_stack int ethtool_get_rxfh_indir(struct net_device *dev,\n \t    (KMALLOC_MAX_SIZE - sizeof(*indir)) \/ sizeof(*indir->ring_index))\n \t\treturn -ENOMEM;\n \tfull_size = sizeof(*indir) + sizeof(*indir->ring_index) * table_size;\n-\tindir = kmalloc(full_size, GFP_USER);\n+\tindir = kzalloc(full_size, GFP_USER);\n \tif (!indir)\n \t\treturn -ENOMEM;\n \n@@ -538,7 +538,7 @@ static int ethtool_get_rx_ntuple(struct net_device *dev, void __user *useraddr)\n \n \tgstrings.len = ret;\n \n-\tdata = kmalloc(gstrings.len * ETH_GSTRING_LEN, GFP_USER);\n+\tdata = kzalloc(gstrings.len * ETH_GSTRING_LEN, GFP_USER);\n \tif (!data)\n \t\treturn -ENOMEM;\n \n@@ -775,7 +775,7 @@ static int ethtool_get_regs(struct net_device *dev, char __user *useraddr)\n \tif (regs.len > reglen)\n \t\tregs.len = reglen;\n \n-\tregbuf = kmalloc(reglen, GFP_USER);\n+\tregbuf = kzalloc(reglen, GFP_USER);\n \tif (!regbuf)\n \t\treturn -ENOMEM;\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2010-3861","CWE_ID":"200","category":"security","commit_id":"ae6df5f96a51818d6376da5307d773baeece4014","commit_message":"From ae6df5f96a51818d6376da5307d773baeece4014 Mon Sep 17 00:00:00 2001\nFrom: Kees Cook <kees.cook@canonical.com>\nDate: Thu, 7 Oct 2010 10:03:48 +0000\nSubject: net: clear heap allocation for ETHTOOL_GRXCLSRLALL\n\nCalling ETHTOOL_GRXCLSRLALL with a large rule_cnt will allocate kernel\nheap without clearing it. For the one driver (niu) that implements it,\nit will leave the unused portion of heap unchanged and copy the full\ncontents back to userspace.\n\nSigned-off-by: Kees Cook <kees.cook@canonical.com>\nAcked-by: Ben Hutchings <bhutchings@solarflare.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/core\/ethtool.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/core\/ethtool.c b\/net\/core\/ethtool.c\nindex 7a85367b3c2f..4016ac6bdd5e 100644\n--- a\/net\/core\/ethtool.c\n+++ b\/net\/core\/ethtool.c\n@@ -348,7 +348,7 @@ static noinline_for_stack int ethtool_get_rxnfc(struct net_device *dev,\n \tif (info.cmd == ETHTOOL_GRXCLSRLALL) {\n \t\tif (info.rule_cnt > 0) {\n \t\t\tif (info.rule_cnt <= KMALLOC_MAX_SIZE \/ sizeof(u32))\n-\t\t\t\trule_buf = kmalloc(info.rule_cnt * sizeof(u32),\n+\t\t\t\trule_buf = kzalloc(info.rule_cnt * sizeof(u32),\n \t\t\t\t\t\t   GFP_USER);\n \t\t\tif (!rule_buf)\n \t\t\t\treturn -ENOMEM;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-5696","CWE_ID":"200","category":"security","commit_id":"75ff39ccc1bd5d3c455b6822ab09e533c551f758","commit_message":"From 75ff39ccc1bd5d3c455b6822ab09e533c551f758 Mon Sep 17 00:00:00 2001\nFrom: Eric Dumazet <edumazet@google.com>\nDate: Sun, 10 Jul 2016 10:04:02 +0200\nSubject: tcp: make challenge acks less predictable\n\nYue Cao claims that current host rate limiting of challenge ACKS\n(RFC 5961) could leak enough information to allow a patient attacker\nto hijack TCP sessions. He will soon provide details in an academic\npaper.\n\nThis patch increases the default limit from 100 to 1000, and adds\nsome randomization so that the attacker can no longer hijack\nsessions without spending a considerable amount of probes.\n\nBased on initial analysis and patch from Linus.\n\nNote that we also have per socket rate limiting, so it is tempting\nto remove the host limit in the future.\n\nv2: randomize the count of challenge acks per second, not the period.\n\nFixes: 282f23c6ee34 (\"tcp: implement RFC 5961 3.2\")\nReported-by: Yue Cao <ycao009@ucr.edu>\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nSuggested-by: Linus Torvalds <torvalds@linux-foundation.org>\nCc: Yuchung Cheng <ycheng@google.com>\nCc: Neal Cardwell <ncardwell@google.com>\nAcked-by: Neal Cardwell <ncardwell@google.com>\nAcked-by: Yuchung Cheng <ycheng@google.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/ipv4\/tcp_input.c | 15 ++++++++++-----\n 1 file changed, 10 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/net\/ipv4\/tcp_input.c b\/net\/ipv4\/tcp_input.c\nindex d6c8f4cd0800..91868bb17818 100644\n--- a\/net\/ipv4\/tcp_input.c\n+++ b\/net\/ipv4\/tcp_input.c\n@@ -87,7 +87,7 @@ int sysctl_tcp_adv_win_scale __read_mostly = 1;\n EXPORT_SYMBOL(sysctl_tcp_adv_win_scale);\n \n \/* rfc5961 challenge ack rate limiting *\/\n-int sysctl_tcp_challenge_ack_limit = 100;\n+int sysctl_tcp_challenge_ack_limit = 1000;\n \n int sysctl_tcp_stdurg __read_mostly;\n int sysctl_tcp_rfc1337 __read_mostly;\n@@ -3458,7 +3458,7 @@ static void tcp_send_challenge_ack(struct sock *sk, const struct sk_buff *skb)\n \tstatic u32 challenge_timestamp;\n \tstatic unsigned int challenge_count;\n \tstruct tcp_sock *tp = tcp_sk(sk);\n-\tu32 now;\n+\tu32 count, now;\n \n \t\/* First check our per-socket dupack rate limit. *\/\n \tif (tcp_oow_rate_limited(sock_net(sk), skb,\n@@ -3466,13 +3466,18 @@ static void tcp_send_challenge_ack(struct sock *sk, const struct sk_buff *skb)\n \t\t\t\t &tp->last_oow_ack_time))\n \t\treturn;\n \n-\t\/* Then check the check host-wide RFC 5961 rate limit. *\/\n+\t\/* Then check host-wide RFC 5961 rate limit. *\/\n \tnow = jiffies \/ HZ;\n \tif (now != challenge_timestamp) {\n+\t\tu32 half = (sysctl_tcp_challenge_ack_limit + 1) >> 1;\n+\n \t\tchallenge_timestamp = now;\n-\t\tchallenge_count = 0;\n+\t\tWRITE_ONCE(challenge_count, half +\n+\t\t\t   prandom_u32_max(sysctl_tcp_challenge_ack_limit));\n \t}\n-\tif (++challenge_count <= sysctl_tcp_challenge_ack_limit) {\n+\tcount = READ_ONCE(challenge_count);\n+\tif (count > 0) {\n+\t\tWRITE_ONCE(challenge_count, count - 1);\n \t\tNET_INC_STATS(sock_net(sk), LINUX_MIB_TCPCHALLENGEACK);\n \t\ttcp_send_ack(sk);\n \t}\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-5550","CWE_ID":"200","category":"security","commit_id":"b9dc6f65bc5e232d1c05fe34b5daadc7e8bbf1fb","commit_message":"From b9dc6f65bc5e232d1c05fe34b5daadc7e8bbf1fb Mon Sep 17 00:00:00 2001\nFrom: Al Viro <viro@zeniv.linux.org.uk>\nDate: Sat, 14 Jan 2017 19:33:08 -0500\nSubject: fix a fencepost error in pipe_advance()\n\nThe logics in pipe_advance() used to release all buffers past the new\nposition failed in cases when the number of buffers to release was equal\nto pipe->buffers.  If that happened, none of them had been released,\nleaving pipe full.  Worse, it was trivial to trigger and we end up with\npipe full of uninitialized pages.  IOW, it's an infoleak.\n\nCc: stable@vger.kernel.org # v4.9\nReported-by: \"Alan J. Wylie\" <alan@wylie.me.uk>\nTested-by: \"Alan J. Wylie\" <alan@wylie.me.uk>\nSigned-off-by: Al Viro <viro@zeniv.linux.org.uk>\n---\n lib\/iov_iter.c | 54 +++++++++++++++++++++++++++++++-----------------------\n 1 file changed, 31 insertions(+), 23 deletions(-)\n\n","diff_code":"diff --git a\/lib\/iov_iter.c b\/lib\/iov_iter.c\nindex 25f572303801..e68604ae3ced 100644\n--- a\/lib\/iov_iter.c\n+++ b\/lib\/iov_iter.c\n@@ -730,43 +730,50 @@ size_t iov_iter_copy_from_user_atomic(struct page *page,\n }\n EXPORT_SYMBOL(iov_iter_copy_from_user_atomic);\n \n+static inline void pipe_truncate(struct iov_iter *i)\n+{\n+\tstruct pipe_inode_info *pipe = i->pipe;\n+\tif (pipe->nrbufs) {\n+\t\tsize_t off = i->iov_offset;\n+\t\tint idx = i->idx;\n+\t\tint nrbufs = (idx - pipe->curbuf) & (pipe->buffers - 1);\n+\t\tif (off) {\n+\t\t\tpipe->bufs[idx].len = off - pipe->bufs[idx].offset;\n+\t\t\tidx = next_idx(idx, pipe);\n+\t\t\tnrbufs++;\n+\t\t}\n+\t\twhile (pipe->nrbufs > nrbufs) {\n+\t\t\tpipe_buf_release(pipe, &pipe->bufs[idx]);\n+\t\t\tidx = next_idx(idx, pipe);\n+\t\t\tpipe->nrbufs--;\n+\t\t}\n+\t}\n+}\n+\n static void pipe_advance(struct iov_iter *i, size_t size)\n {\n \tstruct pipe_inode_info *pipe = i->pipe;\n-\tstruct pipe_buffer *buf;\n-\tint idx = i->idx;\n-\tsize_t off = i->iov_offset, orig_sz;\n-\t\n \tif (unlikely(i->count < size))\n \t\tsize = i->count;\n-\torig_sz = size;\n-\n \tif (size) {\n+\t\tstruct pipe_buffer *buf;\n+\t\tsize_t off = i->iov_offset, left = size;\n+\t\tint idx = i->idx;\n \t\tif (off) \/* make it relative to the beginning of buffer *\/\n-\t\t\tsize += off - pipe->bufs[idx].offset;\n+\t\t\tleft += off - pipe->bufs[idx].offset;\n \t\twhile (1) {\n \t\t\tbuf = &pipe->bufs[idx];\n-\t\t\tif (size <= buf->len)\n+\t\t\tif (left <= buf->len)\n \t\t\t\tbreak;\n-\t\t\tsize -= buf->len;\n+\t\t\tleft -= buf->len;\n \t\t\tidx = next_idx(idx, pipe);\n \t\t}\n-\t\tbuf->len = size;\n \t\ti->idx = idx;\n-\t\toff = i->iov_offset = buf->offset + size;\n-\t}\n-\tif (off)\n-\t\tidx = next_idx(idx, pipe);\n-\tif (pipe->nrbufs) {\n-\t\tint unused = (pipe->curbuf + pipe->nrbufs) & (pipe->buffers - 1);\n-\t\t\/* [curbuf,unused) is in use.  Free [idx,unused) *\/\n-\t\twhile (idx != unused) {\n-\t\t\tpipe_buf_release(pipe, &pipe->bufs[idx]);\n-\t\t\tidx = next_idx(idx, pipe);\n-\t\t\tpipe->nrbufs--;\n-\t\t}\n+\t\ti->iov_offset = buf->offset + left;\n \t}\n-\ti->count -= orig_sz;\n+\ti->count -= size;\n+\t\/* ... and discard everything past that point *\/\n+\tpipe_truncate(i);\n }\n \n void iov_iter_advance(struct iov_iter *i, size_t size)\n@@ -826,6 +833,7 @@ void iov_iter_pipe(struct iov_iter *i, int direction,\n \t\t\tsize_t count)\n {\n \tBUG_ON(direction != ITER_PIPE);\n+\tWARN_ON(pipe->nrbufs == pipe->buffers);\n \ti->type = direction;\n \ti->pipe = pipe;\n \ti->idx = (pipe->curbuf + pipe->nrbufs) & (pipe->buffers - 1);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-7281","CWE_ID":"200","category":"security","commit_id":"bceaa90240b6019ed73b49965eac7d167610be69","commit_message":"From bceaa90240b6019ed73b49965eac7d167610be69 Mon Sep 17 00:00:00 2001\nFrom: Hannes Frederic Sowa <hannes@stressinduktion.org>\nDate: Mon, 18 Nov 2013 04:20:45 +0100\nSubject: [PATCH] inet: prevent leakage of uninitialized memory to user in recv\n syscalls\n\nOnly update *addr_len when we actually fill in sockaddr, otherwise we\ncan return uninitialized memory from the stack to the caller in the\nrecvfrom, recvmmsg and recvmsg syscalls. Drop the the (addr_len == NULL)\nchecks because we only get called with a valid addr_len pointer either\nfrom sock_common_recvmsg or inet_recvmsg.\n\nIf a blocking read waits on a socket which is concurrently shut down we\nnow return zero and set msg_msgnamelen to 0.\n\nReported-by: mpb <mpb.mail@gmail.com>\nSuggested-by: Eric Dumazet <eric.dumazet@gmail.com>\nSigned-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/ieee802154\/dgram.c |  3 +--\n net\/ipv4\/ping.c        | 19 +++++++------------\n net\/ipv4\/raw.c         |  4 +---\n net\/ipv4\/udp.c         |  7 +------\n net\/ipv6\/raw.c         |  4 +---\n net\/ipv6\/udp.c         |  5 +----\n net\/l2tp\/l2tp_ip.c     |  4 +---\n net\/phonet\/datagram.c  |  9 ++++-----\n 8 files changed, 17 insertions(+), 38 deletions(-)\n\n","diff_code":"diff --git a\/net\/ieee802154\/dgram.c b\/net\/ieee802154\/dgram.c\nindex 581a59504bd5f..1865fdf5a5a51 100644\n--- a\/net\/ieee802154\/dgram.c\n+++ b\/net\/ieee802154\/dgram.c\n@@ -315,9 +315,8 @@ static int dgram_recvmsg(struct kiocb *iocb, struct sock *sk,\n \tif (saddr) {\n \t\tsaddr->family = AF_IEEE802154;\n \t\tsaddr->addr = mac_cb(skb)->sa;\n-\t}\n-\tif (addr_len)\n \t\t*addr_len = sizeof(*saddr);\n+\t}\n \n \tif (flags & MSG_TRUNC)\n \t\tcopied = skb->len;\ndiff --git a\/net\/ipv4\/ping.c b\/net\/ipv4\/ping.c\nindex 9afbdb19f4a2f..aacefa0caa36a 100644\n--- a\/net\/ipv4\/ping.c\n+++ b\/net\/ipv4\/ping.c\n@@ -830,8 +830,6 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n {\n \tstruct inet_sock *isk = inet_sk(sk);\n \tint family = sk->sk_family;\n-\tstruct sockaddr_in *sin;\n-\tstruct sockaddr_in6 *sin6;\n \tstruct sk_buff *skb;\n \tint copied, err;\n \n@@ -841,13 +839,6 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \tif (flags & MSG_OOB)\n \t\tgoto out;\n \n-\tif (addr_len) {\n-\t\tif (family == AF_INET)\n-\t\t\t*addr_len = sizeof(*sin);\n-\t\telse if (family == AF_INET6 && addr_len)\n-\t\t\t*addr_len = sizeof(*sin6);\n-\t}\n-\n \tif (flags & MSG_ERRQUEUE) {\n \t\tif (family == AF_INET) {\n \t\t\treturn ip_recv_error(sk, msg, len);\n@@ -877,11 +868,13 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \n \t\/* Copy the address and add cmsg data. *\/\n \tif (family == AF_INET) {\n-\t\tsin = (struct sockaddr_in *) msg->msg_name;\n+\t\tstruct sockaddr_in *sin = (struct sockaddr_in *)msg->msg_name;\n+\n \t\tsin->sin_family = AF_INET;\n \t\tsin->sin_port = 0 \/* skb->h.uh->source *\/;\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tmemset(sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \n \t\tif (isk->cmsg_flags)\n \t\t\tip_cmsg_recv(msg, skb);\n@@ -890,17 +883,19 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \t} else if (family == AF_INET6) {\n \t\tstruct ipv6_pinfo *np = inet6_sk(sk);\n \t\tstruct ipv6hdr *ip6 = ipv6_hdr(skb);\n-\t\tsin6 = (struct sockaddr_in6 *) msg->msg_name;\n+\t\tstruct sockaddr_in6 *sin6 =\n+\t\t\t(struct sockaddr_in6 *)msg->msg_name;\n+\n \t\tsin6->sin6_family = AF_INET6;\n \t\tsin6->sin6_port = 0;\n \t\tsin6->sin6_addr = ip6->saddr;\n-\n \t\tsin6->sin6_flowinfo = 0;\n \t\tif (np->sndflow)\n \t\t\tsin6->sin6_flowinfo = ip6_flowinfo(ip6);\n \n \t\tsin6->sin6_scope_id = ipv6_iface_scope_id(&sin6->sin6_addr,\n \t\t\t\t\t\t\t  IP6CB(skb)->iif);\n+\t\t*addr_len = sizeof(*sin6);\n \n \t\tif (inet6_sk(sk)->rxopt.all)\n \t\t\tpingv6_ops.ip6_datagram_recv_ctl(sk, msg, skb);\ndiff --git a\/net\/ipv4\/raw.c b\/net\/ipv4\/raw.c\nindex 41e1d2845c8f6..5cb8ddb505ee8 100644\n--- a\/net\/ipv4\/raw.c\n+++ b\/net\/ipv4\/raw.c\n@@ -696,9 +696,6 @@ static int raw_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \tif (flags & MSG_OOB)\n \t\tgoto out;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(*sin);\n-\n \tif (flags & MSG_ERRQUEUE) {\n \t\terr = ip_recv_error(sk, msg, len);\n \t\tgoto out;\n@@ -726,6 +723,7 @@ static int raw_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tsin->sin_port = 0;\n \t\tmemset(&sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \t}\n \tif (inet->cmsg_flags)\n \t\tip_cmsg_recv(msg, skb);\ndiff --git a\/net\/ipv4\/udp.c b\/net\/ipv4\/udp.c\nindex 89909dd730ddd..998431cd471a2 100644\n--- a\/net\/ipv4\/udp.c\n+++ b\/net\/ipv4\/udp.c\n@@ -1235,12 +1235,6 @@ int udp_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \tint is_udplite = IS_UDPLITE(sk);\n \tbool slow;\n \n-\t\/*\n-\t *\tCheck any passed addresses\n-\t *\/\n-\tif (addr_len)\n-\t\t*addr_len = sizeof(*sin);\n-\n \tif (flags & MSG_ERRQUEUE)\n \t\treturn ip_recv_error(sk, msg, len);\n \n@@ -1302,6 +1296,7 @@ int udp_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \t\tsin->sin_port = udp_hdr(skb)->source;\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tmemset(sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \t}\n \tif (inet->cmsg_flags)\n \t\tip_cmsg_recv(msg, skb);\ndiff --git a\/net\/ipv6\/raw.c b\/net\/ipv6\/raw.c\nindex 3c00842b00792..e24ff1df04012 100644\n--- a\/net\/ipv6\/raw.c\n+++ b\/net\/ipv6\/raw.c\n@@ -465,9 +465,6 @@ static int rawv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \tif (flags & MSG_OOB)\n \t\treturn -EOPNOTSUPP;\n \n-\tif (addr_len)\n-\t\t*addr_len=sizeof(*sin6);\n-\n \tif (flags & MSG_ERRQUEUE)\n \t\treturn ipv6_recv_error(sk, msg, len);\n \n@@ -506,6 +503,7 @@ static int rawv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \t\tsin6->sin6_flowinfo = 0;\n \t\tsin6->sin6_scope_id = ipv6_iface_scope_id(&sin6->sin6_addr,\n \t\t\t\t\t\t\t  IP6CB(skb)->iif);\n+\t\t*addr_len = sizeof(*sin6);\n \t}\n \n \tsock_recv_ts_and_drops(msg, sk, skb);\ndiff --git a\/net\/ipv6\/udp.c b\/net\/ipv6\/udp.c\nindex f3893e897f721..81eb8cf8389b6 100644\n--- a\/net\/ipv6\/udp.c\n+++ b\/net\/ipv6\/udp.c\n@@ -392,9 +392,6 @@ int udpv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \tint is_udp4;\n \tbool slow;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(struct sockaddr_in6);\n-\n \tif (flags & MSG_ERRQUEUE)\n \t\treturn ipv6_recv_error(sk, msg, len);\n \n@@ -480,7 +477,7 @@ int udpv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \t\t\t\tipv6_iface_scope_id(&sin6->sin6_addr,\n \t\t\t\t\t\t    IP6CB(skb)->iif);\n \t\t}\n-\n+\t\t*addr_len = sizeof(*sin6);\n \t}\n \tif (is_udp4) {\n \t\tif (inet->cmsg_flags)\ndiff --git a\/net\/l2tp\/l2tp_ip.c b\/net\/l2tp\/l2tp_ip.c\nindex 571db8dd2292a..da1a1cee1a088 100644\n--- a\/net\/l2tp\/l2tp_ip.c\n+++ b\/net\/l2tp\/l2tp_ip.c\n@@ -518,9 +518,6 @@ static int l2tp_ip_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *m\n \tif (flags & MSG_OOB)\n \t\tgoto out;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(*sin);\n-\n \tskb = skb_recv_datagram(sk, flags, noblock, &err);\n \tif (!skb)\n \t\tgoto out;\n@@ -543,6 +540,7 @@ static int l2tp_ip_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *m\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tsin->sin_port = 0;\n \t\tmemset(&sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \t}\n \tif (inet->cmsg_flags)\n \t\tip_cmsg_recv(msg, skb);\ndiff --git a\/net\/phonet\/datagram.c b\/net\/phonet\/datagram.c\nindex 12c30f3e643e0..38946b26e471c 100644\n--- a\/net\/phonet\/datagram.c\n+++ b\/net\/phonet\/datagram.c\n@@ -139,9 +139,6 @@ static int pn_recvmsg(struct kiocb *iocb, struct sock *sk,\n \t\t\tMSG_CMSG_COMPAT))\n \t\tgoto out_nofree;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(sa);\n-\n \tskb = skb_recv_datagram(sk, flags, noblock, &rval);\n \tif (skb == NULL)\n \t\tgoto out_nofree;\n@@ -162,8 +159,10 @@ static int pn_recvmsg(struct kiocb *iocb, struct sock *sk,\n \n \trval = (flags & MSG_TRUNC) ? skb->len : copylen;\n \n-\tif (msg->msg_name != NULL)\n-\t\tmemcpy(msg->msg_name, &sa, sizeof(struct sockaddr_pn));\n+\tif (msg->msg_name != NULL) {\n+\t\tmemcpy(msg->msg_name, &sa, sizeof(sa));\n+\t\t*addr_len = sizeof(sa);\n+\t}\n \n out:\n \tskb_free_datagram(sk, skb);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-11448","CWE_ID":"200","category":"security","commit_id":"1737ac82b335e53376382c07b9a500d73dd2aa11","commit_message":"From 1737ac82b335e53376382c07b9a500d73dd2aa11 Mon Sep 17 00:00:00 2001\nFrom: Cristy <urban-warrior@imagemagick.org>\nDate: Sun, 9 Jul 2017 09:06:26 -0400\nSubject: [PATCH] Zero pixel buffer\n\n---\n coders\/jpeg.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/coders\/jpeg.c b\/coders\/jpeg.c\nindex 9b94e7252c..3c093c1173 100644\n--- a\/coders\/jpeg.c\n+++ b\/coders\/jpeg.c\n@@ -1293,6 +1293,8 @@ static Image *ReadJPEGImage(const ImageInfo *image_info,\n       ThrowReaderException(ResourceLimitError,\"MemoryAllocationFailed\");\n     }\n   jpeg_pixels=(JSAMPLE *) GetVirtualMemoryBlob(memory_info);\n+  (void) ResetMagickMemory(jpeg_pixels,0,image->columns* \n+    jpeg_info.output_components*sizeof(*jpeg_pixels));\n   \/*\n     Convert JPEG pixels to pixel packets.\n   *\/\n","owner":"ImageMagick","repo":"ImageMagick","source":"cve"},{"CVE_ID":"CVE-2018-1116","CWE_ID":"200","category":"security","commit_id":"bc7ffad53643a9c80231fc41f5582d6a8931c32c","commit_message":"From bc7ffad53643a9c80231fc41f5582d6a8931c32c Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Miloslav=20Trma=C4=8D?= <mitr@redhat.com>\nDate: Mon, 25 Jun 2018 19:24:06 +0200\nSubject: Fix CVE-2018-1116: Trusting client-supplied UID\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nAs part of CVE-2013-4288, the D-Bus clients were allowed (and\nencouraged) to submit the UID of the subject of authorization checks\nto avoid races against UID changes (notably using executables\nset-UID to root).\n\nHowever, that also allowed any client to submit an arbitrary UID, and\nthat could be used to bypass \"can only ask about \/ affect the same UID\"\nchecks in CheckAuthorization \/ RegisterAuthenticationAgent \/\nUnregisterAuthenticationAgent.  This allowed an attacker:\n\n- With CheckAuthorization, to cause the registered authentication\n  agent in victim's session to pop up a dialog, or to determine whether\n  the victim currently has a temporary authorization to perform an\n  operation.\n\n  (In principle, the attacker can also determine whether JavaScript\n  rules allow the victim process to perform an operation; however,\n  usually rules base their decisions on information determined from\n  the supplied UID, so the attacker usually won't learn anything new.)\n\n- With RegisterAuthenticationAgent, to prevent the victim's\n  authentication agent to work (for a specific victim process),\n  or to learn about which operations requiring authorization\n  the victim is attempting.\n\nTo fix this, expose internal _polkit_unix_process_get_owner() \/\nobsolete polkit_unix_process_get_owner() as a private\npolkit_unix_process_get_racy_uid__() (being more explicit about the\ndangers on relying on it), and use it in\npolkit_backend_session_monitor_get_user_for_subject() to return\na boolean indicating whether the subject UID may be caller-chosen.\n\nThen, in the permission checks that require the subject to be\nequal to the caller, fail on caller-chosen UIDs (and continue\nthrough the pre-existing code paths which allow root, or root-designated\nserver processes, to ask about arbitrary subjects.)\n\nSigned-off-by: Miloslav Trma\u010d <mitr@redhat.com>\n---\n src\/polkit\/polkitprivate.h                         |  2 +\n src\/polkit\/polkitunixprocess.c                     | 61 ++++++++++++++++++----\n ...\/polkitbackendinteractiveauthority.c            | 39 +++++++++-----\n ...\/polkitbackendsessionmonitor-systemd.c          | 38 ++++++++++++--\n src\/polkitbackend\/polkitbackendsessionmonitor.c    | 40 ++++++++++++--\n src\/polkitbackend\/polkitbackendsessionmonitor.h    |  1 +\n 6 files changed, 148 insertions(+), 33 deletions(-)\n\n","diff_code":"diff --git a\/src\/polkit\/polkitprivate.h b\/src\/polkit\/polkitprivate.h\nindex 9f07063..c80142d 100644\n--- a\/src\/polkit\/polkitprivate.h\n+++ b\/src\/polkit\/polkitprivate.h\n@@ -44,6 +44,8 @@ GVariant *polkit_action_description_to_gvariant (PolkitActionDescription *action\n GVariant *polkit_subject_to_gvariant (PolkitSubject *subject);\n GVariant *polkit_identity_to_gvariant (PolkitIdentity *identity);\n \n+gint polkit_unix_process_get_racy_uid__ (PolkitUnixProcess *process, GError **error);\n+\n PolkitSubject  *polkit_subject_new_for_gvariant (GVariant *variant, GError **error);\n PolkitIdentity *polkit_identity_new_for_gvariant (GVariant *variant, GError **error);\n \ndiff --git a\/src\/polkit\/polkitunixprocess.c b\/src\/polkit\/polkitunixprocess.c\nindex d4ebf50..972b777 100644\n--- a\/src\/polkit\/polkitunixprocess.c\n+++ b\/src\/polkit\/polkitunixprocess.c\n@@ -56,6 +56,14 @@\n  * To uniquely identify processes, both the process id and the start\n  * time of the process (a monotonic increasing value representing the\n  * time since the kernel was started) is used.\n+ *\n+ * NOTE: This object stores, and provides access to, the real UID of the\n+ * process.  That value can change over time (with set*uid*(2) and exec*(2)).\n+ * Checks whether an operation is allowed need to take care to use the UID\n+ * value as of the time when the operation was made (or, following the open()\n+ * privilege check model, when the connection making the operation possible\n+ * was initiated).  That is usually done by initializing this with\n+ * polkit_unix_process_new_for_owner() with trusted data.\n  *\/\n \n \/**\n@@ -90,9 +98,6 @@ static void subject_iface_init (PolkitSubjectIface *subject_iface);\n static guint64 get_start_time_for_pid (gint    pid,\n                                        GError **error);\n \n-static gint _polkit_unix_process_get_owner (PolkitUnixProcess  *process,\n-                                            GError            **error);\n-\n #if defined(HAVE_FREEBSD) || defined(HAVE_NETBSD) || defined(HAVE_OPENBSD)\n static gboolean get_kinfo_proc (gint pid,\n #if defined(HAVE_NETBSD)\n@@ -182,7 +187,7 @@ polkit_unix_process_constructed (GObject *object)\n     {\n       GError *error;\n       error = NULL;\n-      process->uid = _polkit_unix_process_get_owner (process, &error);\n+      process->uid = polkit_unix_process_get_racy_uid__ (process, &error);\n       if (error != NULL)\n         {\n           process->uid = -1;\n@@ -271,6 +276,12 @@ polkit_unix_process_class_init (PolkitUnixProcessClass *klass)\n  * Gets the user id for @process. Note that this is the real user-id,\n  * not the effective user-id.\n  *\n+ * NOTE: The UID may change over time, so the returned value may not match the\n+ * current state of the underlying process; or the UID may have been set by\n+ * polkit_unix_process_new_for_owner() or polkit_unix_process_set_uid(),\n+ * in which case it may not correspond to the actual UID of the referenced\n+ * process at all (at any point in time).\n+ *\n  * Returns: The user id for @process or -1 if unknown.\n  *\/\n gint\n@@ -708,13 +719,20 @@ out:\n   return start_time;\n }\n \n-static gint\n-_polkit_unix_process_get_owner (PolkitUnixProcess  *process,\n-                                GError            **error)\n+\/*\n+ * Private: Return the \"current\" UID.  Note that this is inherently racy,\n+ * and the value may already be obsolete by the time this function returns;\n+ * this function only guarantees that the UID was valid at some point during\n+ * its execution.\n+ *\/\n+gint\n+polkit_unix_process_get_racy_uid__ (PolkitUnixProcess  *process,\n+                                    GError            **error)\n {\n   gint result;\n   gchar *contents;\n   gchar **lines;\n+  guint64 start_time;\n #if defined(HAVE_FREEBSD) || defined(HAVE_OPENBSD)\n   struct kinfo_proc p;\n #elif defined(HAVE_NETBSD)\n@@ -722,6 +740,7 @@ _polkit_unix_process_get_owner (PolkitUnixProcess  *process,\n #else\n   gchar filename[64];\n   guint n;\n+  GError *local_error;\n #endif\n \n   g_return_val_if_fail (POLKIT_IS_UNIX_PROCESS (process), 0);\n@@ -745,8 +764,10 @@ _polkit_unix_process_get_owner (PolkitUnixProcess  *process,\n \n #if defined(HAVE_FREEBSD)\n   result = p.ki_uid;\n+  start_time = (guint64) p.ki_start.tv_sec;\n #else\n   result = p.p_uid;\n+  start_time = (guint64) p.p_ustart_sec;\n #endif\n #else\n \n@@ -781,17 +802,37 @@ _polkit_unix_process_get_owner (PolkitUnixProcess  *process,\n       else\n         {\n           result = real_uid;\n-          goto out;\n+          goto found;\n         }\n     }\n-\n   g_set_error (error,\n                POLKIT_ERROR,\n                POLKIT_ERROR_FAILED,\n                \"Didn't find any line starting with `Uid:' in file %s\",\n                filename);\n+  goto out;\n+\n+found:\n+  \/* The UID and start time are, sadly, not available in a single file.  So,\n+   * read the UID first, and then the start time; if the start time is the same\n+   * before and after reading the UID, it couldn't have changed.\n+   *\/\n+  local_error = NULL;\n+  start_time = get_start_time_for_pid (process->pid, &local_error);\n+  if (local_error != NULL)\n+    {\n+      g_propagate_error (error, local_error);\n+      goto out;\n+    }\n #endif\n \n+  if (process->start_time != start_time)\n+    {\n+      g_set_error (error, POLKIT_ERROR, POLKIT_ERROR_FAILED,\n+\t\t   \"process with PID %d has been replaced\", process->pid);\n+      goto out;\n+    }\n+\n out:\n   g_strfreev (lines);\n   g_free (contents);\n@@ -810,5 +851,5 @@ gint\n polkit_unix_process_get_owner (PolkitUnixProcess  *process,\n                                GError            **error)\n {\n-  return _polkit_unix_process_get_owner (process, error);\n+  return polkit_unix_process_get_racy_uid__ (process, error);\n }\ndiff --git a\/src\/polkitbackend\/polkitbackendinteractiveauthority.c b\/src\/polkitbackend\/polkitbackendinteractiveauthority.c\nindex 1cd60d3..cb6fdab 100644\n--- a\/src\/polkitbackend\/polkitbackendinteractiveauthority.c\n+++ b\/src\/polkitbackend\/polkitbackendinteractiveauthority.c\n@@ -575,7 +575,7 @@ log_result (PolkitBackendInteractiveAuthority    *authority,\n   if (polkit_authorization_result_get_is_authorized (result))\n     log_result_str = \"ALLOWING\";\n \n-  user_of_subject = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor, subject, NULL);\n+  user_of_subject = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor, subject, NULL, NULL);\n \n   subject_str = polkit_subject_to_string (subject);\n \n@@ -847,6 +847,7 @@ polkit_backend_interactive_authority_check_authorization (PolkitBackendAuthority\n   gchar *subject_str;\n   PolkitIdentity *user_of_caller;\n   PolkitIdentity *user_of_subject;\n+  gboolean user_of_subject_matches;\n   gchar *user_of_caller_str;\n   gchar *user_of_subject_str;\n   PolkitAuthorizationResult *result;\n@@ -892,7 +893,7 @@ polkit_backend_interactive_authority_check_authorization (PolkitBackendAuthority\n            action_id);\n \n   user_of_caller = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor,\n-                                                                        caller,\n+                                                                        caller, NULL,\n                                                                         &error);\n   if (error != NULL)\n     {\n@@ -907,7 +908,7 @@ polkit_backend_interactive_authority_check_authorization (PolkitBackendAuthority\n   g_debug (\" user of caller is %s\", user_of_caller_str);\n \n   user_of_subject = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor,\n-                                                                         subject,\n+                                                                         subject, &user_of_subject_matches,\n                                                                          &error);\n   if (error != NULL)\n     {\n@@ -937,7 +938,10 @@ polkit_backend_interactive_authority_check_authorization (PolkitBackendAuthority\n    * We only allow this if, and only if,\n    *\n    *  - processes may check for another process owned by the *same* user but not\n-   *    if details are passed (otherwise you'd be able to spoof the dialog)\n+   *    if details are passed (otherwise you'd be able to spoof the dialog);\n+   *    the caller supplies the user_of_subject value, so we additionally\n+   *    require it to match at least at one point in time (via\n+   *    user_of_subject_matches).\n    *\n    *  - processes running as uid 0 may check anything and pass any details\n    *\n@@ -945,7 +949,9 @@ polkit_backend_interactive_authority_check_authorization (PolkitBackendAuthority\n    *    then any uid referenced by that annotation is also allowed to check\n    *    to check anything and pass any details\n    *\/\n-  if (!polkit_identity_equal (user_of_caller, user_of_subject) || has_details)\n+  if (!user_of_subject_matches\n+      || !polkit_identity_equal (user_of_caller, user_of_subject)\n+      || has_details)\n     {\n       if (!may_identity_check_authorization (interactive_authority, action_id, user_of_caller))\n         {\n@@ -1110,9 +1116,10 @@ check_authorization_sync (PolkitBackendAuthority         *authority,\n       goto out;\n     }\n \n-  \/* every subject has a user *\/\n+  \/* every subject has a user; this is supplied by the client, so we rely\n+   * on the caller to validate its acceptability. *\/\n   user_of_subject = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor,\n-                                                                         subject,\n+                                                                         subject, NULL,\n                                                                          error);\n   if (user_of_subject == NULL)\n       goto out;\n@@ -2480,6 +2487,7 @@ polkit_backend_interactive_authority_register_authentication_agent (PolkitBacken\n   PolkitSubject *session_for_caller;\n   PolkitIdentity *user_of_caller;\n   PolkitIdentity *user_of_subject;\n+  gboolean user_of_subject_matches;\n   AuthenticationAgent *agent;\n   gboolean ret;\n   gchar *caller_cmdline;\n@@ -2532,7 +2540,7 @@ polkit_backend_interactive_authority_register_authentication_agent (PolkitBacken\n       goto out;\n     }\n \n-  user_of_caller = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor, caller, NULL);\n+  user_of_caller = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor, caller, NULL, NULL);\n   if (user_of_caller == NULL)\n     {\n       g_set_error (error,\n@@ -2541,7 +2549,7 @@ polkit_backend_interactive_authority_register_authentication_agent (PolkitBacken\n                    \"Cannot determine user of caller\");\n       goto out;\n     }\n-  user_of_subject = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor, subject, NULL);\n+  user_of_subject = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor, subject, &user_of_subject_matches, NULL);\n   if (user_of_subject == NULL)\n     {\n       g_set_error (error,\n@@ -2550,7 +2558,8 @@ polkit_backend_interactive_authority_register_authentication_agent (PolkitBacken\n                    \"Cannot determine user of subject\");\n       goto out;\n     }\n-  if (!polkit_identity_equal (user_of_caller, user_of_subject))\n+  if (!user_of_subject_matches\n+      || !polkit_identity_equal (user_of_caller, user_of_subject))\n     {\n       if (identity_is_root_user (user_of_caller))\n         {\n@@ -2643,6 +2652,7 @@ polkit_backend_interactive_authority_unregister_authentication_agent (PolkitBack\n   PolkitSubject *session_for_caller;\n   PolkitIdentity *user_of_caller;\n   PolkitIdentity *user_of_subject;\n+  gboolean user_of_subject_matches;\n   AuthenticationAgent *agent;\n   gboolean ret;\n   gchar *scope_str;\n@@ -2691,7 +2701,7 @@ polkit_backend_interactive_authority_unregister_authentication_agent (PolkitBack\n       goto out;\n     }\n \n-  user_of_caller = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor, caller, NULL);\n+  user_of_caller = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor, caller, NULL, NULL);\n   if (user_of_caller == NULL)\n     {\n       g_set_error (error,\n@@ -2700,7 +2710,7 @@ polkit_backend_interactive_authority_unregister_authentication_agent (PolkitBack\n                    \"Cannot determine user of caller\");\n       goto out;\n     }\n-  user_of_subject = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor, subject, NULL);\n+  user_of_subject = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor, subject, &user_of_subject_matches, NULL);\n   if (user_of_subject == NULL)\n     {\n       g_set_error (error,\n@@ -2709,7 +2719,8 @@ polkit_backend_interactive_authority_unregister_authentication_agent (PolkitBack\n                    \"Cannot determine user of subject\");\n       goto out;\n     }\n-  if (!polkit_identity_equal (user_of_caller, user_of_subject))\n+  if (!user_of_subject_matches\n+      || !polkit_identity_equal (user_of_caller, user_of_subject))\n     {\n       if (identity_is_root_user (user_of_caller))\n         {\n@@ -2819,7 +2830,7 @@ polkit_backend_interactive_authority_authentication_agent_response (PolkitBacken\n            identity_str);\n \n   user_of_caller = polkit_backend_session_monitor_get_user_for_subject (priv->session_monitor,\n-                                                                        caller,\n+                                                                        caller, NULL,\n                                                                         error);\n   if (user_of_caller == NULL)\n     goto out;\ndiff --git a\/src\/polkitbackend\/polkitbackendsessionmonitor-systemd.c b\/src\/polkitbackend\/polkitbackendsessionmonitor-systemd.c\nindex 2a6c739..b00cdbd 100644\n--- a\/src\/polkitbackend\/polkitbackendsessionmonitor-systemd.c\n+++ b\/src\/polkitbackend\/polkitbackendsessionmonitor-systemd.c\n@@ -29,6 +29,7 @@\n #include <stdlib.h>\n \n #include <polkit\/polkit.h>\n+#include <polkit\/polkitprivate.h>\n #include \"polkitbackendsessionmonitor.h\"\n \n \/* <internal>\n@@ -246,26 +247,40 @@ polkit_backend_session_monitor_get_sessions (PolkitBackendSessionMonitor *monito\n  * polkit_backend_session_monitor_get_user:\n  * @monitor: A #PolkitBackendSessionMonitor.\n  * @subject: A #PolkitSubject.\n+ * @result_matches: If not %NULL, set to indicate whether the return value matches current (RACY) state.\n  * @error: Return location for error.\n  *\n  * Gets the user corresponding to @subject or %NULL if no user exists.\n  *\n+ * NOTE: For a #PolkitUnixProcess, the UID is read from @subject (which may\n+ * come from e.g. a D-Bus client), so it may not correspond to the actual UID\n+ * of the referenced process (at any point in time).  This is indicated by\n+ * setting @result_matches to %FALSE; the caller may reject such subjects or\n+ * require additional privileges. @result_matches == %TRUE only indicates that\n+ * the UID matched the underlying process at ONE point in time, it may not match\n+ * later.\n+ *\n  * Returns: %NULL if @error is set otherwise a #PolkitUnixUser that should be freed with g_object_unref().\n  *\/\n PolkitIdentity *\n polkit_backend_session_monitor_get_user_for_subject (PolkitBackendSessionMonitor  *monitor,\n                                                      PolkitSubject                *subject,\n+                                                     gboolean                     *result_matches,\n                                                      GError                      **error)\n {\n   PolkitIdentity *ret;\n-  guint32 uid;\n+  gboolean matches;\n \n   ret = NULL;\n+  matches = FALSE;\n \n   if (POLKIT_IS_UNIX_PROCESS (subject))\n     {\n-      uid = polkit_unix_process_get_uid (POLKIT_UNIX_PROCESS (subject));\n-      if ((gint) uid == -1)\n+      gint subject_uid, current_uid;\n+      GError *local_error;\n+\n+      subject_uid = polkit_unix_process_get_uid (POLKIT_UNIX_PROCESS (subject));\n+      if (subject_uid == -1)\n         {\n           g_set_error (error,\n                        POLKIT_ERROR,\n@@ -273,14 +288,24 @@ polkit_backend_session_monitor_get_user_for_subject (PolkitBackendSessionMonitor\n                        \"Unix process subject does not have uid set\");\n           goto out;\n         }\n-      ret = polkit_unix_user_new (uid);\n+      local_error = NULL;\n+      current_uid = polkit_unix_process_get_racy_uid__ (POLKIT_UNIX_PROCESS (subject), &local_error);\n+      if (local_error != NULL)\n+\t{\n+\t  g_propagate_error (error, local_error);\n+\t  goto out;\n+\t}\n+      ret = polkit_unix_user_new (subject_uid);\n+      matches = (subject_uid == current_uid);\n     }\n   else if (POLKIT_IS_SYSTEM_BUS_NAME (subject))\n     {\n       ret = (PolkitIdentity*)polkit_system_bus_name_get_user_sync (POLKIT_SYSTEM_BUS_NAME (subject), NULL, error);\n+      matches = TRUE;\n     }\n   else if (POLKIT_IS_UNIX_SESSION (subject))\n     {\n+      uid_t uid;\n \n       if (sd_session_get_uid (polkit_unix_session_get_session_id (POLKIT_UNIX_SESSION (subject)), &uid) < 0)\n         {\n@@ -292,9 +317,14 @@ polkit_backend_session_monitor_get_user_for_subject (PolkitBackendSessionMonitor\n         }\n \n       ret = polkit_unix_user_new (uid);\n+      matches = TRUE;\n     }\n \n  out:\n+  if (result_matches != NULL)\n+    {\n+      *result_matches = matches;\n+    }\n   return ret;\n }\n \ndiff --git a\/src\/polkitbackend\/polkitbackendsessionmonitor.c b\/src\/polkitbackend\/polkitbackendsessionmonitor.c\nindex e1a9ab3..ed30755 100644\n--- a\/src\/polkitbackend\/polkitbackendsessionmonitor.c\n+++ b\/src\/polkitbackend\/polkitbackendsessionmonitor.c\n@@ -27,6 +27,7 @@\n #include <glib\/gstdio.h>\n \n #include <polkit\/polkit.h>\n+#include <polkit\/polkitprivate.h>\n #include \"polkitbackendsessionmonitor.h\"\n \n #define CKDB_PATH \"\/var\/run\/ConsoleKit\/database\"\n@@ -273,28 +274,40 @@ polkit_backend_session_monitor_get_sessions (PolkitBackendSessionMonitor *monito\n  * polkit_backend_session_monitor_get_user:\n  * @monitor: A #PolkitBackendSessionMonitor.\n  * @subject: A #PolkitSubject.\n+ * @result_matches: If not %NULL, set to indicate whether the return value matches current (RACY) state.\n  * @error: Return location for error.\n  *\n  * Gets the user corresponding to @subject or %NULL if no user exists.\n  *\n+ * NOTE: For a #PolkitUnixProcess, the UID is read from @subject (which may\n+ * come from e.g. a D-Bus client), so it may not correspond to the actual UID\n+ * of the referenced process (at any point in time).  This is indicated by\n+ * setting @result_matches to %FALSE; the caller may reject such subjects or\n+ * require additional privileges. @result_matches == %TRUE only indicates that\n+ * the UID matched the underlying process at ONE point in time, it may not match\n+ * later.\n+ *\n  * Returns: %NULL if @error is set otherwise a #PolkitUnixUser that should be freed with g_object_unref().\n  *\/\n PolkitIdentity *\n polkit_backend_session_monitor_get_user_for_subject (PolkitBackendSessionMonitor  *monitor,\n                                                      PolkitSubject                *subject,\n+                                                     gboolean                     *result_matches,\n                                                      GError                      **error)\n {\n   PolkitIdentity *ret;\n+  gboolean matches;\n   GError *local_error;\n-  gchar *group;\n-  guint32 uid;\n \n   ret = NULL;\n+  matches = FALSE;\n \n   if (POLKIT_IS_UNIX_PROCESS (subject))\n     {\n-      uid = polkit_unix_process_get_uid (POLKIT_UNIX_PROCESS (subject));\n-      if ((gint) uid == -1)\n+      gint subject_uid, current_uid;\n+\n+      subject_uid = polkit_unix_process_get_uid (POLKIT_UNIX_PROCESS (subject));\n+      if (subject_uid == -1)\n         {\n           g_set_error (error,\n                        POLKIT_ERROR,\n@@ -302,14 +315,26 @@ polkit_backend_session_monitor_get_user_for_subject (PolkitBackendSessionMonitor\n                        \"Unix process subject does not have uid set\");\n           goto out;\n         }\n-      ret = polkit_unix_user_new (uid);\n+      local_error = NULL;\n+      current_uid = polkit_unix_process_get_racy_uid__ (POLKIT_UNIX_PROCESS (subject), &local_error);\n+      if (local_error != NULL)\n+\t{\n+\t  g_propagate_error (error, local_error);\n+\t  goto out;\n+\t}\n+      ret = polkit_unix_user_new (subject_uid);\n+      matches = (subject_uid == current_uid);\n     }\n   else if (POLKIT_IS_SYSTEM_BUS_NAME (subject))\n     {\n       ret = (PolkitIdentity*)polkit_system_bus_name_get_user_sync (POLKIT_SYSTEM_BUS_NAME (subject), NULL, error);\n+      matches = TRUE;\n     }\n   else if (POLKIT_IS_UNIX_SESSION (subject))\n     {\n+      gint uid;\n+      gchar *group;\n+\n       if (!ensure_database (monitor, error))\n         {\n           g_prefix_error (error, \"Error getting user for session: Error ensuring CK database at \" CKDB_PATH \": \");\n@@ -328,9 +353,14 @@ polkit_backend_session_monitor_get_user_for_subject (PolkitBackendSessionMonitor\n       g_free (group);\n \n       ret = polkit_unix_user_new (uid);\n+      matches = TRUE;\n     }\n \n  out:\n+  if (result_matches != NULL)\n+    {\n+      *result_matches = matches;\n+    }\n   return ret;\n }\n \ndiff --git a\/src\/polkitbackend\/polkitbackendsessionmonitor.h b\/src\/polkitbackend\/polkitbackendsessionmonitor.h\nindex 8f8a2ca..3972326 100644\n--- a\/src\/polkitbackend\/polkitbackendsessionmonitor.h\n+++ b\/src\/polkitbackend\/polkitbackendsessionmonitor.h\n@@ -47,6 +47,7 @@ GList                       *polkit_backend_session_monitor_get_sessions (Polkit\n \n PolkitIdentity              *polkit_backend_session_monitor_get_user_for_subject (PolkitBackendSessionMonitor *monitor,\n                                                                                   PolkitSubject               *subject,\n+                                                                                  gboolean                    *result_matches,\n                                                                                   GError                     **error);\n \n PolkitSubject               *polkit_backend_session_monitor_get_session_for_subject (PolkitBackendSessionMonitor *monitor,\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2011-1078","CWE_ID":"200","category":"security","commit_id":"c4c896e1471aec3b004a693c689f60be3b17ac86","commit_message":"From c4c896e1471aec3b004a693c689f60be3b17ac86 Mon Sep 17 00:00:00 2001\nFrom: Vasiliy Kulikov <segoon@openwall.com>\nDate: Mon, 14 Feb 2011 13:54:26 +0300\nSubject: [PATCH] Bluetooth: sco: fix information leak to userspace\n\nstruct sco_conninfo has one padding byte in the end.  Local variable\ncinfo of type sco_conninfo is copied to userspace with this uninizialized\none byte, leading to old stack contents leak.\n\nSigned-off-by: Vasiliy Kulikov <segoon@openwall.com>\nSigned-off-by: Gustavo F. Padovan <padovan@profusion.mobi>\n---\n net\/bluetooth\/sco.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/bluetooth\/sco.c b\/net\/bluetooth\/sco.c\nindex 960c6d1637da0..926ed39912ea7 100644\n--- a\/net\/bluetooth\/sco.c\n+++ b\/net\/bluetooth\/sco.c\n@@ -703,6 +703,7 @@ static int sco_sock_getsockopt_old(struct socket *sock, int optname, char __user\n \t\t\tbreak;\n \t\t}\n \n+\t\tmemset(&cinfo, 0, sizeof(cinfo));\n \t\tcinfo.hci_handle = sco_pi(sk)->conn->hcon->handle;\n \t\tmemcpy(cinfo.dev_class, sco_pi(sk)->conn->hcon->dev_class, 3);\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-6537","CWE_ID":"200","category":"security","commit_id":"7b789836f434c87168eab067cfbed1ec4783dffd","commit_message":"From 7b789836f434c87168eab067cfbed1ec4783dffd Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 19 Sep 2012 11:33:40 +0000\nSubject: xfrm_user: fix info leak in copy_to_user_policy()\n\nThe memory reserved to dump the xfrm policy includes multiple padding\nbytes added by the compiler for alignment (padding bytes in struct\nxfrm_selector and struct xfrm_userpolicy_info). Add an explicit\nmemset(0) before filling the buffer to avoid the heap info leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nAcked-by: Steffen Klassert <steffen.klassert@secunet.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/xfrm\/xfrm_user.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/xfrm\/xfrm_user.c b\/net\/xfrm\/xfrm_user.c\nindex d585459dc8bb..84dd85ceeeea 100644\n--- a\/net\/xfrm\/xfrm_user.c\n+++ b\/net\/xfrm\/xfrm_user.c\n@@ -1320,6 +1320,7 @@ static void copy_from_user_policy(struct xfrm_policy *xp, struct xfrm_userpolicy\n \n static void copy_to_user_policy(struct xfrm_policy *xp, struct xfrm_userpolicy_info *p, int dir)\n {\n+\tmemset(p, 0, sizeof(*p));\n \tmemcpy(&p->sel, &xp->selector, sizeof(p->sel));\n \tmemcpy(&p->lft, &xp->lft, sizeof(p->lft));\n \tmemcpy(&p->curlft, &xp->curlft, sizeof(p->curlft));\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2018-12435","CWE_ID":"200","category":"security","commit_id":"48fc8df51d99f9d8ba251219367b3d629cc848e3","commit_message":"From 48fc8df51d99f9d8ba251219367b3d629cc848e3 Mon Sep 17 00:00:00 2001\nFrom: Jack Lloyd <jack@randombit.net>\nDate: Tue, 5 Jun 2018 18:40:14 -0400\nSubject: [PATCH] Address DSA\/ECDSA side channel\n\n---\n doc\/security.rst                     |  8 ++++++\n src\/lib\/pubkey\/dsa\/dsa.cpp           | 38 ++++++++++++++++++++--------\n src\/lib\/pubkey\/ec_group\/ec_group.cpp | 20 +++++++++++++++\n src\/lib\/pubkey\/ec_group\/ec_group.h   | 10 ++++++++\n src\/lib\/pubkey\/ecdsa\/ecdsa.cpp       | 29 ++++++++++++++++-----\n 5 files changed, 88 insertions(+), 17 deletions(-)\n\n","diff_code":"diff --git a\/doc\/security.rst b\/doc\/security.rst\nindex 8e661c0ad7..cd84997ccc 100644\n--- a\/doc\/security.rst\n+++ b\/doc\/security.rst\n@@ -18,6 +18,14 @@ https:\/\/keybase.io\/jacklloyd and on most PGP keyservers.\n 2018\n ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n+* 2018-06-13 (CVE-2018-0495): ECDSA side channel\n+\n+  A side channel in the ECDSA signature operation could allow a local attacker\n+  to recover the secret key. Found by Keegan Ryan of NCC Group.\n+\n+  Fixed in 2.7.0. Due to a slight difference in code structure, versions before\n+  2.5.0 are not affected by this issue.\n+\n * 2018-04-10 (CVE-2018-9860): Memory overread in TLS CBC decryption\n \n   An off by one error in TLS CBC decryption meant that for a particular\ndiff --git a\/src\/lib\/pubkey\/dsa\/dsa.cpp b\/src\/lib\/pubkey\/dsa\/dsa.cpp\nindex 1728049727..7142e47880 100644\n--- a\/src\/lib\/pubkey\/dsa\/dsa.cpp\n+++ b\/src\/lib\/pubkey\/dsa\/dsa.cpp\n@@ -74,7 +74,9 @@ namespace {\n class DSA_Signature_Operation final : public PK_Ops::Signature_with_EMSA\n    {\n    public:\n-      DSA_Signature_Operation(const DSA_PrivateKey& dsa, const std::string& emsa) :\n+      DSA_Signature_Operation(const DSA_PrivateKey& dsa,\n+                              const std::string& emsa,\n+                              RandomNumberGenerator& rng) :\n          PK_Ops::Signature_with_EMSA(emsa),\n          m_group(dsa.get_group()),\n          m_x(dsa.get_x()),\n@@ -83,6 +85,9 @@ class DSA_Signature_Operation final : public PK_Ops::Signature_with_EMSA\n #if defined(BOTAN_HAS_RFC6979_GENERATOR)\n          m_rfc6979_hash = hash_for_emsa(emsa);\n #endif\n+\n+         m_b = BigInt::random_integer(rng, 2, dsa.group_q());\n+         m_b_inv = inverse_mod(m_b, dsa.group_q());\n          }\n \n       size_t max_input_bits() const override { return m_group.get_q().bits(); }\n@@ -96,6 +101,8 @@ class DSA_Signature_Operation final : public PK_Ops::Signature_with_EMSA\n #if defined(BOTAN_HAS_RFC6979_GENERATOR)\n       std::string m_rfc6979_hash;\n #endif\n+\n+      BigInt m_b, m_b_inv;\n    };\n \n secure_vector<uint8_t>\n@@ -104,22 +111,32 @@ DSA_Signature_Operation::raw_sign(const uint8_t msg[], size_t msg_len,\n    {\n    const BigInt& q = m_group.get_q();\n \n-   BigInt i(msg, msg_len, q.bits());\n+   BigInt m(msg, msg_len, q.bits());\n \n-   while(i >= q)\n-      i -= q;\n+   while(m >= q)\n+      m -= q;\n \n #if defined(BOTAN_HAS_RFC6979_GENERATOR)\n    BOTAN_UNUSED(rng);\n-   const BigInt k = generate_rfc6979_nonce(m_x, q, i, m_rfc6979_hash);\n+   const BigInt k = generate_rfc6979_nonce(m_x, q, m, m_rfc6979_hash);\n #else\n    const BigInt k = BigInt::random_integer(rng, 1, q);\n #endif\n \n-   BigInt s = inverse_mod(k, q);\n+   const BigInt k_inv = inverse_mod(k, q);\n+\n    const BigInt r = m_mod_q.reduce(m_group.power_g_p(k));\n \n-   s = m_mod_q.multiply(s, mul_add(m_x, r, i));\n+   \/*\n+   * Blind the input message and compute x*r+m as (x*r*b + m*b)\/b\n+   *\/\n+   m_b = m_mod_q.square(m_b);\n+   m_b_inv = m_mod_q.square(m_b_inv);\n+\n+   m = m_mod_q.multiply(m_b, m);\n+   const BigInt xr = m_mod_q.multiply(m_mod_q.multiply(m_x, m_b), r);\n+\n+   const BigInt s = m_mod_q.multiply(m_b_inv, m_mod_q.multiply(k_inv, xr + m));\n \n    \/\/ With overwhelming probability, a bug rather than actual zero r\/s\n    if(r.is_zero() || s.is_zero())\n@@ -140,7 +157,8 @@ class DSA_Verification_Operation final : public PK_Ops::Verification_with_EMSA\n          m_group(dsa.get_group()),\n          m_y(dsa.get_y()),\n          m_mod_q(dsa.group_q())\n-         {}\n+         {\n+         }\n \n       size_t max_input_bits() const override { return m_group.get_q().bits(); }\n \n@@ -193,12 +211,12 @@ DSA_PublicKey::create_verification_op(const std::string& params,\n    }\n \n std::unique_ptr<PK_Ops::Signature>\n-DSA_PrivateKey::create_signature_op(RandomNumberGenerator& \/*rng*\/,\n+DSA_PrivateKey::create_signature_op(RandomNumberGenerator& rng,\n                                     const std::string& params,\n                                     const std::string& provider) const\n    {\n    if(provider == \"base\" || provider.empty())\n-      return std::unique_ptr<PK_Ops::Signature>(new DSA_Signature_Operation(*this, params));\n+      return std::unique_ptr<PK_Ops::Signature>(new DSA_Signature_Operation(*this, params, rng));\n    throw Provider_Not_Found(algo_name(), provider);\n    }\n \ndiff --git a\/src\/lib\/pubkey\/ec_group\/ec_group.cpp b\/src\/lib\/pubkey\/ec_group\/ec_group.cpp\nindex 004708c7cc..2dfcdc0d94 100644\n--- a\/src\/lib\/pubkey\/ec_group\/ec_group.cpp\n+++ b\/src\/lib\/pubkey\/ec_group\/ec_group.cpp\n@@ -84,11 +84,21 @@ class EC_Group_Data final\n \n       BigInt mod_order(const BigInt& x) const { return m_mod_order.reduce(x); }\n \n+      BigInt square_mod_order(const BigInt& x) const\n+         {\n+         return m_mod_order.square(x);\n+         }\n+\n       BigInt multiply_mod_order(const BigInt& x, const BigInt& y) const\n          {\n          return m_mod_order.multiply(x, y);\n          }\n \n+      BigInt multiply_mod_order(const BigInt& x, const BigInt& y, const BigInt& z) const\n+         {\n+         return m_mod_order.multiply(m_mod_order.multiply(x, y), z);\n+         }\n+\n       BigInt inverse_mod_order(const BigInt& x) const\n          {\n          return inverse_mod(x, m_order);\n@@ -477,11 +487,21 @@ BigInt EC_Group::mod_order(const BigInt& k) const\n    return data().mod_order(k);\n    }\n \n+BigInt EC_Group::square_mod_order(const BigInt& x) const\n+   {\n+   return data().square_mod_order(x);\n+   }\n+\n BigInt EC_Group::multiply_mod_order(const BigInt& x, const BigInt& y) const\n    {\n    return data().multiply_mod_order(x, y);\n    }\n \n+BigInt EC_Group::multiply_mod_order(const BigInt& x, const BigInt& y, const BigInt& z) const\n+   {\n+   return data().multiply_mod_order(x, y, z);\n+   }\n+\n BigInt EC_Group::inverse_mod_order(const BigInt& x) const\n    {\n    return data().inverse_mod_order(x);\ndiff --git a\/src\/lib\/pubkey\/ec_group\/ec_group.h b\/src\/lib\/pubkey\/ec_group\/ec_group.h\nindex f273108d2b..f8c1c1a123 100644\n--- a\/src\/lib\/pubkey\/ec_group\/ec_group.h\n+++ b\/src\/lib\/pubkey\/ec_group\/ec_group.h\n@@ -203,11 +203,21 @@ class BOTAN_PUBLIC_API(2,0) EC_Group final\n       *\/\n       BigInt inverse_mod_order(const BigInt& x) const;\n \n+      \/*\n+      * Reduce (x*x) modulo the order\n+      *\/\n+      BigInt square_mod_order(const BigInt& x) const;\n+\n       \/*\n       * Reduce (x*y) modulo the order\n       *\/\n       BigInt multiply_mod_order(const BigInt& x, const BigInt& y) const;\n \n+      \/*\n+      * Reduce (x*y*z) modulo the order\n+      *\/\n+      BigInt multiply_mod_order(const BigInt& x, const BigInt& y, const BigInt& z) const;\n+\n       \/**\n       * Return the cofactor\n       * @result the cofactor\ndiff --git a\/src\/lib\/pubkey\/ecdsa\/ecdsa.cpp b\/src\/lib\/pubkey\/ecdsa\/ecdsa.cpp\nindex 6e104f1641..2409d8f0d2 100644\n--- a\/src\/lib\/pubkey\/ecdsa\/ecdsa.cpp\n+++ b\/src\/lib\/pubkey\/ecdsa\/ecdsa.cpp\n@@ -51,7 +51,8 @@ class ECDSA_Signature_Operation final : public PK_Ops::Signature_with_EMSA\n    public:\n \n       ECDSA_Signature_Operation(const ECDSA_PrivateKey& ecdsa,\n-                                const std::string& emsa) :\n+                                const std::string& emsa,\n+                                RandomNumberGenerator& rng) :\n          PK_Ops::Signature_with_EMSA(emsa),\n          m_group(ecdsa.domain()),\n          m_x(ecdsa.private_value())\n@@ -59,6 +60,9 @@ class ECDSA_Signature_Operation final : public PK_Ops::Signature_with_EMSA\n #if defined(BOTAN_HAS_RFC6979_GENERATOR)\n          m_rfc6979_hash = hash_for_emsa(emsa);\n #endif\n+\n+         m_b = m_group.random_scalar(rng);\n+         m_b_inv = m_group.inverse_mod_order(m_b);\n          }\n \n       size_t max_input_bits() const override { return m_group.get_order_bits(); }\n@@ -75,6 +79,8 @@ class ECDSA_Signature_Operation final : public PK_Ops::Signature_with_EMSA\n #endif\n \n       std::vector<BigInt> m_ws;\n+\n+      BigInt m_b, m_b_inv;\n    };\n \n secure_vector<uint8_t>\n@@ -89,12 +95,21 @@ ECDSA_Signature_Operation::raw_sign(const uint8_t msg[], size_t msg_len,\n    const BigInt k = m_group.random_scalar(rng);\n #endif\n \n-   const BigInt k_inv = m_group.inverse_mod_order(k);\n    const BigInt r = m_group.mod_order(\n       m_group.blinded_base_point_multiply_x(k, rng, m_ws));\n \n-   const BigInt xrm = m_group.mod_order(m_group.multiply_mod_order(m_x, r) + m);\n-   const BigInt s = m_group.multiply_mod_order(k_inv, xrm);\n+   const BigInt k_inv = m_group.inverse_mod_order(k);\n+\n+   \/*\n+   * Blind the input message and compute x*r+m as (x*r*b + m*b)\/b\n+   *\/\n+   m_b = m_group.square_mod_order(m_b);\n+   m_b_inv = m_group.square_mod_order(m_b_inv);\n+\n+   m = m_group.multiply_mod_order(m_b, m);\n+   const BigInt xr = m_group.multiply_mod_order(m_x, m_b, r);\n+\n+   const BigInt s = m_group.multiply_mod_order(k_inv, xr + m, m_b_inv);\n \n    \/\/ With overwhelming probability, a bug rather than actual zero r\/s\n    if(r.is_zero() || s.is_zero())\n@@ -144,7 +159,7 @@ bool ECDSA_Verification_Operation::verify(const uint8_t msg[], size_t msg_len,\n \n    const BigInt w = m_group.inverse_mod_order(s);\n \n-   const BigInt u1 = m_group.multiply_mod_order(e, w);\n+   const BigInt u1 = m_group.multiply_mod_order(m_group.mod_order(e), w);\n    const BigInt u2 = m_group.multiply_mod_order(r, w);\n    const PointGFp R = m_gy_mul.multi_exp(u1, u2);\n \n@@ -198,7 +213,7 @@ ECDSA_PublicKey::create_verification_op(const std::string& params,\n    }\n \n std::unique_ptr<PK_Ops::Signature>\n-ECDSA_PrivateKey::create_signature_op(RandomNumberGenerator& \/*rng*\/,\n+ECDSA_PrivateKey::create_signature_op(RandomNumberGenerator& rng,\n                                       const std::string& params,\n                                       const std::string& provider) const\n    {\n@@ -233,7 +248,7 @@ ECDSA_PrivateKey::create_signature_op(RandomNumberGenerator& \/*rng*\/,\n #endif\n \n    if(provider == \"base\" || provider.empty())\n-      return std::unique_ptr<PK_Ops::Signature>(new ECDSA_Signature_Operation(*this, params));\n+      return std::unique_ptr<PK_Ops::Signature>(new ECDSA_Signature_Operation(*this, params, rng));\n \n    throw Provider_Not_Found(algo_name(), provider);\n    }\n","owner":"randombit","repo":"botan","source":"cve"},{"CVE_ID":"CVE-2013-3223","CWE_ID":"200","category":"security","commit_id":"ef3313e84acbf349caecae942ab3ab731471f1a1","commit_message":"From ef3313e84acbf349caecae942ab3ab731471f1a1 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:48 +0000\nSubject: [PATCH] ax25: fix info leak via msg_name in ax25_recvmsg()\n\nWhen msg_namelen is non-zero the sockaddr info gets filled out, as\nrequested, but the code fails to initialize the padding bytes of struct\nsockaddr_ax25 inserted by the compiler for alignment. Additionally the\nmsg_namelen value is updated to sizeof(struct full_sockaddr_ax25) but is\nnot always filled up to this size.\n\nBoth issues lead to the fact that the code will leak uninitialized\nkernel stack bytes in net\/socket.c.\n\nFix both issues by initializing the memory with memset(0).\n\nCc: Ralf Baechle <ralf@linux-mips.org>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/ax25\/af_ax25.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/ax25\/af_ax25.c b\/net\/ax25\/af_ax25.c\nindex 7b11f8bc5071c..e277e38f736b9 100644\n--- a\/net\/ax25\/af_ax25.c\n+++ b\/net\/ax25\/af_ax25.c\n@@ -1642,6 +1642,7 @@ static int ax25_recvmsg(struct kiocb *iocb, struct socket *sock,\n \t\tax25_address src;\n \t\tconst unsigned char *mac = skb_mac_header(skb);\n \n+\t\tmemset(sax, 0, sizeof(struct full_sockaddr_ax25));\n \t\tax25_addr_parse(mac + 1, skb->data - mac - 1, &src, NULL,\n \t\t\t\t&digi, NULL, NULL);\n \t\tsax->sax25_family = AF_AX25;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2008-2729","CWE_ID":"200","category":"security","commit_id":"3022d734a54cbd2b65eea9a024564821101b4a9a","commit_message":"From 3022d734a54cbd2b65eea9a024564821101b4a9a Mon Sep 17 00:00:00 2001\nFrom: Andi Kleen <ak@suse.de>\nDate: Tue, 26 Sep 2006 10:52:39 +0200\nSubject: [PATCH] Fix zeroing on exception in copy_*_user\n\n- Don't zero for __copy_from_user_inatomic following i386.\nThis will prevent spurious zeros for parallel file system writers when\none does a exception\n- The string instruction version didn't zero the output on\nexception. Oops.\n\nAlso I cleaned up the code a bit while I was at it and added a minor\noptimization to the string instruction path.\n\nSigned-off-by: Andi Kleen <ak@suse.de>\n---\n arch\/x86_64\/kernel\/x8664_ksyms.c |   1 +\n arch\/x86_64\/lib\/copy_user.S      | 124 +++++++++++++++++++++++++--------------\n include\/asm-x86_64\/uaccess.h     |   6 +-\n 3 files changed, 83 insertions(+), 48 deletions(-)\n\n","diff_code":"diff --git a\/arch\/x86_64\/kernel\/x8664_ksyms.c b\/arch\/x86_64\/kernel\/x8664_ksyms.c\nindex 370952c4ff22..c3454af5e3a2 100644\n--- a\/arch\/x86_64\/kernel\/x8664_ksyms.c\n+++ b\/arch\/x86_64\/kernel\/x8664_ksyms.c\n@@ -29,6 +29,7 @@ EXPORT_SYMBOL(__put_user_8);\n EXPORT_SYMBOL(copy_user_generic);\n EXPORT_SYMBOL(copy_from_user);\n EXPORT_SYMBOL(copy_to_user);\n+EXPORT_SYMBOL(__copy_from_user_inatomic);\n \n EXPORT_SYMBOL(copy_page);\n EXPORT_SYMBOL(clear_page);\ndiff --git a\/arch\/x86_64\/lib\/copy_user.S b\/arch\/x86_64\/lib\/copy_user.S\nindex 962f3a693c5e..70bebd310408 100644\n--- a\/arch\/x86_64\/lib\/copy_user.S\n+++ b\/arch\/x86_64\/lib\/copy_user.S\n@@ -9,10 +9,29 @@\n \n #define FIX_ALIGNMENT 1\n \n-\t#include <asm\/current.h>\n-\t#include <asm\/asm-offsets.h>\n-\t#include <asm\/thread_info.h>\n-\t#include <asm\/cpufeature.h>\n+#include <asm\/current.h>\n+#include <asm\/asm-offsets.h>\n+#include <asm\/thread_info.h>\n+#include <asm\/cpufeature.h>\n+\n+\t.macro ALTERNATIVE_JUMP feature,orig,alt\n+0:\n+\t.byte 0xe9\t\/* 32bit jump *\/\n+\t.long \\orig-1f\t\/* by default jump to orig *\/\n+1:\n+\t.section .altinstr_replacement,\"ax\"\n+2:\t.byte 0xe9\t             \/* near jump with 32bit immediate *\/\n+\t.long \\alt-1b \/* offset *\/   \/* or alternatively to alt *\/\n+\t.previous\n+\t.section .altinstructions,\"a\"\n+\t.align 8\n+\t.quad  0b\n+\t.quad  2b\n+\t.byte  \\feature\t\t     \/* when feature is set *\/\n+\t.byte  5\n+\t.byte  5\n+\t.previous\n+\t.endm\n \n \/* Standard copy_to_user with segment limit checking *\/\t\t\n ENTRY(copy_to_user)\n@@ -23,25 +42,21 @@ ENTRY(copy_to_user)\n \tjc  bad_to_user\n \tcmpq threadinfo_addr_limit(%rax),%rcx\n \tjae bad_to_user\n-2:\n-\t.byte 0xe9\t\/* 32bit jump *\/\n-\t.long .Lcug-1f\n-1:\n+\txorl %eax,%eax\t\/* clear zero flag *\/\n+\tALTERNATIVE_JUMP X86_FEATURE_REP_GOOD,copy_user_generic_unrolled,copy_user_generic_string\n \tCFI_ENDPROC\n-ENDPROC(copy_to_user)\n \n-\t.section .altinstr_replacement,\"ax\"\n-3:\t.byte 0xe9\t\t\t\/* replacement jmp with 32 bit immediate *\/\n-\t.long copy_user_generic_c-1b\t\/* offset *\/\n-\t.previous\n-\t.section .altinstructions,\"a\"\n-\t.align 8\n-\t.quad  2b\n-\t.quad  3b\n-\t.byte  X86_FEATURE_REP_GOOD\n-\t.byte  5\n-\t.byte  5\n-\t.previous\n+ENTRY(copy_user_generic)\n+\tCFI_STARTPROC\n+\tmovl $1,%ecx\t\/* set zero flag *\/\n+\tALTERNATIVE_JUMP X86_FEATURE_REP_GOOD,copy_user_generic_unrolled,copy_user_generic_string\n+\tCFI_ENDPROC\n+\n+ENTRY(__copy_from_user_inatomic)\n+\tCFI_STARTPROC\n+\txorl %ecx,%ecx\t\/* clear zero flag *\/\n+\tALTERNATIVE_JUMP X86_FEATURE_REP_GOOD,copy_user_generic_unrolled,copy_user_generic_string\n+\tCFI_ENDPROC\n \n \/* Standard copy_from_user with segment limit checking *\/\t\n ENTRY(copy_from_user)\n@@ -52,7 +67,8 @@ ENTRY(copy_from_user)\n \tjc  bad_from_user\n \tcmpq threadinfo_addr_limit(%rax),%rcx\n \tjae  bad_from_user\n-\t\/* FALL THROUGH to copy_user_generic *\/\n+\tmovl $1,%ecx\t\/* set zero flag *\/\n+\tALTERNATIVE_JUMP X86_FEATURE_REP_GOOD,copy_user_generic_unrolled,copy_user_generic_string\n \tCFI_ENDPROC\n ENDPROC(copy_from_user)\n \t\n@@ -73,37 +89,26 @@ END(bad_from_user)\n \t\n \t\t\n \/*\n- * copy_user_generic - memory copy with exception handling.\n+ * copy_user_generic_unrolled - memory copy with exception handling.\n+ * This version is for CPUs like P4 that don't have efficient micro code for rep movsq\n  * \t\n  * Input:\t\n  * rdi destination\n  * rsi source\n  * rdx count\n+ * ecx zero flag -- if true zero destination on error\n  *\n  * Output:\t\t\n  * eax uncopied bytes or 0 if successful.\n  *\/\n-ENTRY(copy_user_generic)\n+ENTRY(copy_user_generic_unrolled)\n \tCFI_STARTPROC\n-\t.byte 0x66,0x66,0x90\t\/* 5 byte nop for replacement jump *\/\n-\t.byte 0x66,0x90\n-1:\n-\t.section .altinstr_replacement,\"ax\"\n-2:\t.byte 0xe9\t             \/* near jump with 32bit immediate *\/\n-\t.long copy_user_generic_c-1b \/* offset *\/\n-\t.previous\n-\t.section .altinstructions,\"a\"\n-\t.align 8\n-\t.quad  copy_user_generic\n-\t.quad  2b\n-\t.byte  X86_FEATURE_REP_GOOD\n-\t.byte  5\n-\t.byte  5\n-\t.previous\n-.Lcug:\n \tpushq %rbx\n \tCFI_ADJUST_CFA_OFFSET 8\n \tCFI_REL_OFFSET rbx, 0\n+\tpushq %rcx\n+\tCFI_ADJUST_CFA_OFFSET 8\n+\tCFI_REL_OFFSET rcx, 0\n \txorl %eax,%eax\t\t\/*zero for the exception handler *\/\n \n #ifdef FIX_ALIGNMENT\n@@ -179,6 +184,9 @@ ENTRY(copy_user_generic)\n \n \tCFI_REMEMBER_STATE\n .Lende:\n+\tpopq %rcx\n+\tCFI_ADJUST_CFA_OFFSET -8\n+\tCFI_RESTORE rcx\n \tpopq %rbx\n \tCFI_ADJUST_CFA_OFFSET -8\n \tCFI_RESTORE rbx\n@@ -265,6 +273,8 @@ ENTRY(copy_user_generic)\n \taddl %ecx,%edx\n \t\/* edx: bytes to zero, rdi: dest, eax:zero *\/\n .Lzero_rest:\n+\tcmpl $0,(%rsp)\n+\tjz   .Le_zero\n \tmovq %rdx,%rcx\n .Le_byte:\n \txorl %eax,%eax\n@@ -286,6 +296,7 @@ ENDPROC(copy_user_generic)\n  \/* rdi\tdestination\n   * rsi source\n   * rdx count\n+  * ecx zero flag\n   *\n   * Output:\n   * eax uncopied bytes or 0 if successfull.\n@@ -296,25 +307,48 @@ ENDPROC(copy_user_generic)\n   * And more would be dangerous because both Intel and AMD have\n   * errata with rep movsq > 4GB. If someone feels the need to fix\n   * this please consider this.\n-   *\/\n-copy_user_generic_c:\n+  *\/\n+ENTRY(copy_user_generic_string)\n \tCFI_STARTPROC\n+\tmovl %ecx,%r8d\t\t\/* save zero flag *\/\n \tmovl %edx,%ecx\n \tshrl $3,%ecx\n \tandl $7,%edx\t\n+\tjz   10f\n 1:\trep \n \tmovsq \n \tmovl %edx,%ecx\n 2:\trep\n \tmovsb\n-4:\tmovl %ecx,%eax\n+9:\tmovl %ecx,%eax\n \tret\n-3:\tlea (%rdx,%rcx,8),%rax\n+\n+\t\/* multiple of 8 byte *\/\n+10:\trep\n+\tmovsq\n+\txor %eax,%eax\n \tret\n+\n+\t\/* exception handling *\/\n+3:      lea (%rdx,%rcx,8),%rax\t\/* exception on quad loop *\/\n+\tjmp 6f\n+5:\tmovl %ecx,%eax\t\t\/* exception on byte loop *\/\n+\t\/* eax: left over bytes *\/\n+6:\ttestl %r8d,%r8d\t\t\/* zero flag set? *\/\n+\tjz 7f\n+\tmovl %eax,%ecx\t\t\/* initialize x86 loop counter *\/\n+\tpush %rax\n+\txorl %eax,%eax\n+8:\trep\n+\tstosb \t\t\t\/* zero the rest *\/\n+11:\tpop %rax\n+7:\tret\n \tCFI_ENDPROC\n END(copy_user_generic_c)\n \n \t.section __ex_table,\"a\"\n \t.quad 1b,3b\n-\t.quad 2b,4b\n+\t.quad 2b,5b\n+\t.quad 8b,11b\n+\t.quad 10b,3b\n \t.previous\ndiff --git a\/include\/asm-x86_64\/uaccess.h b\/include\/asm-x86_64\/uaccess.h\nindex 1e1fa003daa3..bc6812009bd7 100644\n--- a\/include\/asm-x86_64\/uaccess.h\n+++ b\/include\/asm-x86_64\/uaccess.h\n@@ -238,6 +238,7 @@ do {\t\t\t\t\t\t\t\t\t\\\n \n \/* Handles exceptions in both to and from, but doesn't do access_ok *\/\n extern unsigned long copy_user_generic(void *to, const void *from, unsigned len); \n+extern unsigned long copy_user_generic_dontzero(void *to, const void *from, unsigned len);\n \n extern unsigned long copy_to_user(void __user *to, const void *from, unsigned len); \n extern unsigned long copy_from_user(void *to, const void __user *from, unsigned len); \n@@ -303,7 +304,6 @@ static __always_inline int __copy_to_user(void __user *dst, const void *src, uns\n \t}\n }\t\n \n-\n static __always_inline int __copy_in_user(void __user *dst, const void __user *src, unsigned size)\n { \n        int ret = 0;\n@@ -352,7 +352,7 @@ long strlen_user(const char __user *str);\n unsigned long clear_user(void __user *mem, unsigned long len);\n unsigned long __clear_user(void __user *mem, unsigned long len);\n \n-#define __copy_to_user_inatomic __copy_to_user\n-#define __copy_from_user_inatomic __copy_from_user\n+extern long __copy_from_user_inatomic(void *dst, const void __user *src, unsigned size);\n+#define __copy_to_user_inatomic copy_user_generic\n \n #endif \/* __X86_64_UACCESS_H *\/\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-17087","CWE_ID":"200","category":"security","commit_id":"5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8","commit_message":"From 5a73e0ca54c77e067c3b12ea6f35e3e8681e8cf8 Mon Sep 17 00:00:00 2001\nFrom: Bram Moolenaar <Bram@vim.org>\nDate: Sat, 4 Nov 2017 21:35:01 +0100\nSubject: [PATCH] patch 8.0.1263: others can read the swap file if a user is\n careless\n\nProblem:    Others can read the swap file if a user is careless with his\n            primary group.\nSolution:   If the group permission allows for reading but the world\n            permissions doesn't, make sure the group is right.\n---\n src\/Makefile              |   1 +\n src\/fileio.c              |  24 +++++++-\n src\/testdir\/test_swap.vim | 112 +++++++++++++++++++++++++-------------\n src\/version.c             |   2 +\n 4 files changed, 99 insertions(+), 40 deletions(-)\n\n","diff_code":"diff --git a\/src\/Makefile b\/src\/Makefile\nindex e55e830ef5..48487aad53 100644\n--- a\/src\/Makefile\n+++ b\/src\/Makefile\n@@ -2259,6 +2259,7 @@ test_arglist \\\n \ttest_stat \\\n \ttest_statusline \\\n \ttest_substitute \\\n+\ttest_swap \\\n \ttest_syn_attr \\\n \ttest_syntax \\\n \ttest_system \\\ndiff --git a\/src\/fileio.c b\/src\/fileio.c\nindex 87b85cf386..34dcdb6b59 100644\n--- a\/src\/fileio.c\n+++ b\/src\/fileio.c\n@@ -716,7 +716,29 @@ readfile(\n \t\/* Set swap file protection bits after creating it. *\/\n \tif (swap_mode > 0 && curbuf->b_ml.ml_mfp != NULL\n \t\t\t  && curbuf->b_ml.ml_mfp->mf_fname != NULL)\n-\t    (void)mch_setperm(curbuf->b_ml.ml_mfp->mf_fname, (long)swap_mode);\n+\t{\n+\t    char_u *swap_fname = curbuf->b_ml.ml_mfp->mf_fname;\n+\n+\t    \/*\n+\t     * If the group-read bit is set but not the world-read bit, then\n+\t     * the group must be equal to the group of the original file.  If\n+\t     * we can't make that happen then reset the group-read bit.  This\n+\t     * avoids making the swap file readable to more users when the\n+\t     * primary group of the user is too permissive.\n+\t     *\/\n+\t    if ((swap_mode & 044) == 040)\n+\t    {\n+\t\tstat_T\tswap_st;\n+\n+\t\tif (mch_stat((char *)swap_fname, &swap_st) >= 0\n+\t\t\t&& st.st_gid != swap_st.st_gid\n+\t\t\t&& fchown(curbuf->b_ml.ml_mfp->mf_fd, -1, st.st_gid)\n+\t\t\t\t\t\t\t\t\t == -1)\n+\t\t    swap_mode &= 0600;\n+\t    }\n+\n+\t    (void)mch_setperm(swap_fname, (long)swap_mode);\n+\t}\n #endif\n     }\n \ndiff --git a\/src\/testdir\/test_swap.vim b\/src\/testdir\/test_swap.vim\nindex 245e1f18bb..d11c124d0a 100644\n--- a\/src\/testdir\/test_swap.vim\n+++ b\/src\/testdir\/test_swap.vim\n@@ -1,48 +1,82 @@\n \" Tests for the swap feature\n \n-\" Tests for 'directory' option.\n-func Test_swap_directory()\n+\"\" Tests for 'directory' option.\n+\"func Test_swap_directory()\n+\"  if !has(\"unix\")\n+\"    return\n+\"  endif\n+\"  let content = ['start of testfile',\n+\"\t      \\ 'line 2 Abcdefghij',\n+\"\t      \\ 'line 3 Abcdefghij',\n+\"\t      \\ 'end of testfile']\n+\"  call writefile(content, 'Xtest1')\n+\"\n+\"  \"  '.', swap file in the same directory as file\n+\"  set dir=.,~\n+\"\n+\"  \" Verify that the swap file doesn't exist in the current directory\n+\"  call assert_equal([], glob(\".Xtest1*.swp\", 1, 1, 1))\n+\"  edit Xtest1\n+\"  let swfname = split(execute(\"swapname\"))[0]\n+\"  call assert_equal([swfname], glob(swfname, 1, 1, 1))\n+\"\n+\"  \" '.\/dir', swap file in a directory relative to the file\n+\"  set dir=.\/Xtest2,.,~\n+\"\n+\"  call mkdir(\"Xtest2\")\n+\"  edit Xtest1\n+\"  call assert_equal([], glob(swfname, 1, 1, 1))\n+\"  let swfname = \"Xtest2\/Xtest1.swp\"\n+\"  call assert_equal(swfname, split(execute(\"swapname\"))[0])\n+\"  call assert_equal([swfname], glob(\"Xtest2\/*\", 1, 1, 1))\n+\"\n+\"  \" 'dir', swap file in directory relative to the current dir\n+\"  set dir=Xtest.je,~\n+\"\n+\"  call mkdir(\"Xtest.je\")\n+\"  call writefile(content, 'Xtest2\/Xtest3')\n+\"  edit Xtest2\/Xtest3\n+\"  call assert_equal([\"Xtest2\/Xtest3\"], glob(\"Xtest2\/*\", 1, 1, 1))\n+\"  let swfname = \"Xtest.je\/Xtest3.swp\"\n+\"  call assert_equal(swfname, split(execute(\"swapname\"))[0])\n+\"  call assert_equal([swfname], glob(\"Xtest.je\/*\", 1, 1, 1))\n+\"\n+\"  set dir&\n+\"  call delete(\"Xtest1\")\n+\"  call delete(\"Xtest2\", \"rf\")\n+\"  call delete(\"Xtest.je\", \"rf\")\n+\"endfunc\n+\n+func Test_swap_group()\n   if !has(\"unix\")\n     return\n   endif\n-  let content = ['start of testfile',\n-\t      \\ 'line 2 Abcdefghij',\n-\t      \\ 'line 3 Abcdefghij',\n-\t      \\ 'end of testfile']\n-  call writefile(content, 'Xtest1')\n-\n-  \"  '.', swap file in the same directory as file\n-  set dir=.,~\n-\n-  \" Verify that the swap file doesn't exist in the current directory\n-  call assert_equal([], glob(\".Xtest1*.swp\", 1, 1, 1))\n-  edit Xtest1\n-  let swfname = split(execute(\"swapname\"))[0]\n-  call assert_equal([swfname], glob(swfname, 1, 1, 1))\n-\n-  \" '.\/dir', swap file in a directory relative to the file\n-  set dir=.\/Xtest2,.,~\n-\n-  call mkdir(\"Xtest2\")\n-  edit Xtest1\n-  call assert_equal([], glob(swfname, 1, 1, 1))\n-  let swfname = \"Xtest2\/Xtest1.swp\"\n-  call assert_equal(swfname, split(execute(\"swapname\"))[0])\n-  call assert_equal([swfname], glob(\"Xtest2\/*\", 1, 1, 1))\n+  let groups = split(system('groups'))\n+  if len(groups) <= 1\n+    throw 'Skipped: need at least two groups, got ' . groups\n+  endif\n \n-  \" 'dir', swap file in directory relative to the current dir\n-  set dir=Xtest.je,~\n+  call delete('Xtest')\n+  split Xtest\n+  call setline(1, 'just some text')\n+  wq\n+  if system('ls -l Xtest') !~ ' ' . groups[0] . ' \\d'\n+    throw 'Skipped: test file does not have the first group'\n+  else\n+    silent !chmod 640 Xtest\n+    call system('chgrp ' . groups[1] . ' Xtest')\n+    if system('ls -l Xtest') !~ ' ' . groups[1] . ' \\d'\n+      throw 'Skipped: cannot set second group on test file'\n+    else\n+      split Xtest\n+      let swapname = substitute(execute('swapname'), '[[:space:]]', '', 'g')\n+      call assert_match('Xtest', swapname)\n+      \" Group of swapfile must now match original file.\n+      call assert_match(' ' . groups[1] . ' \\d', system('ls -l ' . swapname))\n \n-  call mkdir(\"Xtest.je\")\n-  call writefile(content, 'Xtest2\/Xtest3')\n-  edit Xtest2\/Xtest3\n-  call assert_equal([\"Xtest2\/Xtest3\"], glob(\"Xtest2\/*\", 1, 1, 1))\n-  let swfname = \"Xtest.je\/Xtest3.swp\"\n-  call assert_equal(swfname, split(execute(\"swapname\"))[0])\n-  call assert_equal([swfname], glob(\"Xtest.je\/*\", 1, 1, 1))\n+      bwipe!\n+    endif\n+  endif\n \n-  set dir&\n-  call delete(\"Xtest1\")\n-  call delete(\"Xtest2\", \"rf\")\n-  call delete(\"Xtest.je\", \"rf\")\n+  call delete('Xtest')\n endfunc\ndiff --git a\/src\/version.c b\/src\/version.c\nindex b7cb58be4a..2a2cefe3d1 100644\n--- a\/src\/version.c\n+++ b\/src\/version.c\n@@ -761,6 +761,8 @@ static char *(features[]) =\n \n static int included_patches[] =\n {   \/* Add new patch number below this line *\/\n+\/**\/\n+    1263,\n \/**\/\n     1262,\n \/**\/\n","owner":"vim","repo":"vim","source":"cve"},{"CVE_ID":"CVE-2013-3232","CWE_ID":"200","category":"security","commit_id":"c802d759623acbd6e1ee9fbdabae89159a513913","commit_message":"From c802d759623acbd6e1ee9fbdabae89159a513913 Mon Sep 17 00:00:00 2001\nFrom: Wei Yongjun <yongjun_wei@trendmicro.com.cn>\nDate: Tue, 9 Apr 2013 10:07:19 +0800\nSubject: [PATCH] netrom: fix invalid use of sizeof in nr_recvmsg()\n\nsizeof() when applied to a pointer typed expression gives the size of the\npointer, not that of the pointed data.\nIntroduced by commit 3ce5ef(netrom: fix info leak via msg_name in nr_recvmsg)\n\nSigned-off-by: Wei Yongjun <yongjun_wei@trendmicro.com.cn>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/netrom\/af_netrom.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/netrom\/af_netrom.c b\/net\/netrom\/af_netrom.c\nindex 7fcb307dea475..103bd704b5fc3 100644\n--- a\/net\/netrom\/af_netrom.c\n+++ b\/net\/netrom\/af_netrom.c\n@@ -1173,7 +1173,7 @@ static int nr_recvmsg(struct kiocb *iocb, struct socket *sock,\n \t}\n \n \tif (sax != NULL) {\n-\t\tmemset(sax, 0, sizeof(sax));\n+\t\tmemset(sax, 0, sizeof(*sax));\n \t\tsax->sax25_family = AF_NETROM;\n \t\tskb_copy_from_linear_data_offset(skb, 7, sax->sax25_call.ax25_call,\n \t\t\t      AX25_ADDR_LEN);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2014-9419","CWE_ID":"200","category":"security","commit_id":"f647d7c155f069c1a068030255c300663516420e","commit_message":"From f647d7c155f069c1a068030255c300663516420e Mon Sep 17 00:00:00 2001\nFrom: Andy Lutomirski <luto@amacapital.net>\nDate: Mon, 8 Dec 2014 13:55:20 -0800\nSubject: x86_64, switch_to(): Load TLS descriptors before switching DS and ES\n\nOtherwise, if buggy user code points DS or ES into the TLS\narray, they would be corrupted after a context switch.\n\nThis also significantly improves the comments and documents some\ngotchas in the code.\n\nBefore this patch, the both tests below failed.  With this\npatch, the es test passes, although the gsbase test still fails.\n\n ----- begin es test -----\n\n\/*\n * Copyright (c) 2014 Andy Lutomirski\n * GPL v2\n *\/\n\nstatic unsigned short GDT3(int idx)\n{\n\treturn (idx << 3) | 3;\n}\n\nstatic int create_tls(int idx, unsigned int base)\n{\n\tstruct user_desc desc = {\n\t\t.entry_number    = idx,\n\t\t.base_addr       = base,\n\t\t.limit           = 0xfffff,\n\t\t.seg_32bit       = 1,\n\t\t.contents        = 0, \/* Data, grow-up *\/\n\t\t.read_exec_only  = 0,\n\t\t.limit_in_pages  = 1,\n\t\t.seg_not_present = 0,\n\t\t.useable         = 0,\n\t};\n\n\tif (syscall(SYS_set_thread_area, &desc) != 0)\n\t\terr(1, \"set_thread_area\");\n\n\treturn desc.entry_number;\n}\n\nint main()\n{\n\tint idx = create_tls(-1, 0);\n\tprintf(\"Allocated GDT index %d\\n\", idx);\n\n\tunsigned short orig_es;\n\tasm volatile (\"mov %%es,%0\" : \"=rm\" (orig_es));\n\n\tint errors = 0;\n\tint total = 1000;\n\tfor (int i = 0; i < total; i++) {\n\t\tasm volatile (\"mov %0,%%es\" : : \"rm\" (GDT3(idx)));\n\t\tusleep(100);\n\n\t\tunsigned short es;\n\t\tasm volatile (\"mov %%es,%0\" : \"=rm\" (es));\n\t\tasm volatile (\"mov %0,%%es\" : : \"rm\" (orig_es));\n\t\tif (es != GDT3(idx)) {\n\t\t\tif (errors == 0)\n\t\t\t\tprintf(\"[FAIL]\\tES changed from 0x%hx to 0x%hx\\n\",\n\t\t\t\t       GDT3(idx), es);\n\t\t\terrors++;\n\t\t}\n\t}\n\n\tif (errors) {\n\t\tprintf(\"[FAIL]\\tES was corrupted %d\/%d times\\n\", errors, total);\n\t\treturn 1;\n\t} else {\n\t\tprintf(\"[OK]\\tES was preserved\\n\");\n\t\treturn 0;\n\t}\n}\n\n ----- end es test -----\n\n ----- begin gsbase test -----\n\n\/*\n * gsbase.c, a gsbase test\n * Copyright (c) 2014 Andy Lutomirski\n * GPL v2\n *\/\n\nstatic unsigned char *testptr, *testptr2;\n\nstatic unsigned char read_gs_testvals(void)\n{\n\tunsigned char ret;\n\tasm volatile (\"movb %%gs:%1, %0\" : \"=r\" (ret) : \"m\" (*testptr));\n\treturn ret;\n}\n\nint main()\n{\n\tint errors = 0;\n\n\ttestptr = mmap((void *)0x200000000UL, 1, PROT_READ | PROT_WRITE,\n\t\t       MAP_PRIVATE | MAP_FIXED | MAP_ANONYMOUS, -1, 0);\n\tif (testptr == MAP_FAILED)\n\t\terr(1, \"mmap\");\n\n\ttestptr2 = mmap((void *)0x300000000UL, 1, PROT_READ | PROT_WRITE,\n\t\t       MAP_PRIVATE | MAP_FIXED | MAP_ANONYMOUS, -1, 0);\n\tif (testptr2 == MAP_FAILED)\n\t\terr(1, \"mmap\");\n\n\t*testptr = 0;\n\t*testptr2 = 1;\n\n\tif (syscall(SYS_arch_prctl, ARCH_SET_GS,\n\t\t    (unsigned long)testptr2 - (unsigned long)testptr) != 0)\n\t\terr(1, \"ARCH_SET_GS\");\n\n\tusleep(100);\n\n\tif (read_gs_testvals() == 1) {\n\t\tprintf(\"[OK]\\tARCH_SET_GS worked\\n\");\n\t} else {\n\t\tprintf(\"[FAIL]\\tARCH_SET_GS failed\\n\");\n\t\terrors++;\n\t}\n\n\tasm volatile (\"mov %0,%%gs\" : : \"r\" (0));\n\n\tif (read_gs_testvals() == 0) {\n\t\tprintf(\"[OK]\\tWriting 0 to gs worked\\n\");\n\t} else {\n\t\tprintf(\"[FAIL]\\tWriting 0 to gs failed\\n\");\n\t\terrors++;\n\t}\n\n\tusleep(100);\n\n\tif (read_gs_testvals() == 0) {\n\t\tprintf(\"[OK]\\tgsbase is still zero\\n\");\n\t} else {\n\t\tprintf(\"[FAIL]\\tgsbase was corrupted\\n\");\n\t\terrors++;\n\t}\n\n\treturn errors == 0 ? 0 : 1;\n}\n\n ----- end gsbase test -----\n\nSigned-off-by: Andy Lutomirski <luto@amacapital.net>\nCc: <stable@vger.kernel.org>\nCc: Andi Kleen <andi@firstfloor.org>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nLink: http:\/\/lkml.kernel.org\/r\/509d27c9fec78217691c3dad91cec87e1006b34a.1418075657.git.luto@amacapital.net\nSigned-off-by: Ingo Molnar <mingo@kernel.org>\n---\n arch\/x86\/kernel\/process_64.c | 101 +++++++++++++++++++++++++++++++------------\n 1 file changed, 73 insertions(+), 28 deletions(-)\n\n","diff_code":"diff --git a\/arch\/x86\/kernel\/process_64.c b\/arch\/x86\/kernel\/process_64.c\nindex 3ed4a68d4013..5a2c02913af3 100644\n--- a\/arch\/x86\/kernel\/process_64.c\n+++ b\/arch\/x86\/kernel\/process_64.c\n@@ -283,24 +283,9 @@ __switch_to(struct task_struct *prev_p, struct task_struct *next_p)\n \n \tfpu = switch_fpu_prepare(prev_p, next_p, cpu);\n \n-\t\/*\n-\t * Reload esp0, LDT and the page table pointer:\n-\t *\/\n+\t\/* Reload esp0 and ss1. *\/\n \tload_sp0(tss, next);\n \n-\t\/*\n-\t * Switch DS and ES.\n-\t * This won't pick up thread selector changes, but I guess that is ok.\n-\t *\/\n-\tsavesegment(es, prev->es);\n-\tif (unlikely(next->es | prev->es))\n-\t\tloadsegment(es, next->es);\n-\n-\tsavesegment(ds, prev->ds);\n-\tif (unlikely(next->ds | prev->ds))\n-\t\tloadsegment(ds, next->ds);\n-\n-\n \t\/* We must save %fs and %gs before load_TLS() because\n \t * %fs and %gs may be cleared by load_TLS().\n \t *\n@@ -309,41 +294,101 @@ __switch_to(struct task_struct *prev_p, struct task_struct *next_p)\n \tsavesegment(fs, fsindex);\n \tsavesegment(gs, gsindex);\n \n+\t\/*\n+\t * Load TLS before restoring any segments so that segment loads\n+\t * reference the correct GDT entries.\n+\t *\/\n \tload_TLS(next, cpu);\n \n \t\/*\n-\t * Leave lazy mode, flushing any hypercalls made here.\n-\t * This must be done before restoring TLS segments so\n-\t * the GDT and LDT are properly updated, and must be\n-\t * done before math_state_restore, so the TS bit is up\n-\t * to date.\n+\t * Leave lazy mode, flushing any hypercalls made here.  This\n+\t * must be done after loading TLS entries in the GDT but before\n+\t * loading segments that might reference them, and and it must\n+\t * be done before math_state_restore, so the TS bit is up to\n+\t * date.\n \t *\/\n \tarch_end_context_switch(next_p);\n \n+\t\/* Switch DS and ES.\n+\t *\n+\t * Reading them only returns the selectors, but writing them (if\n+\t * nonzero) loads the full descriptor from the GDT or LDT.  The\n+\t * LDT for next is loaded in switch_mm, and the GDT is loaded\n+\t * above.\n+\t *\n+\t * We therefore need to write new values to the segment\n+\t * registers on every context switch unless both the new and old\n+\t * values are zero.\n+\t *\n+\t * Note that we don't need to do anything for CS and SS, as\n+\t * those are saved and restored as part of pt_regs.\n+\t *\/\n+\tsavesegment(es, prev->es);\n+\tif (unlikely(next->es | prev->es))\n+\t\tloadsegment(es, next->es);\n+\n+\tsavesegment(ds, prev->ds);\n+\tif (unlikely(next->ds | prev->ds))\n+\t\tloadsegment(ds, next->ds);\n+\n \t\/*\n \t * Switch FS and GS.\n \t *\n-\t * Segment register != 0 always requires a reload.  Also\n-\t * reload when it has changed.  When prev process used 64bit\n-\t * base always reload to avoid an information leak.\n+\t * These are even more complicated than FS and GS: they have\n+\t * 64-bit bases are that controlled by arch_prctl.  Those bases\n+\t * only differ from the values in the GDT or LDT if the selector\n+\t * is 0.\n+\t *\n+\t * Loading the segment register resets the hidden base part of\n+\t * the register to 0 or the value from the GDT \/ LDT.  If the\n+\t * next base address zero, writing 0 to the segment register is\n+\t * much faster than using wrmsr to explicitly zero the base.\n+\t *\n+\t * The thread_struct.fs and thread_struct.gs values are 0\n+\t * if the fs and gs bases respectively are not overridden\n+\t * from the values implied by fsindex and gsindex.  They\n+\t * are nonzero, and store the nonzero base addresses, if\n+\t * the bases are overridden.\n+\t *\n+\t * (fs != 0 && fsindex != 0) || (gs != 0 && gsindex != 0) should\n+\t * be impossible.\n+\t *\n+\t * Therefore we need to reload the segment registers if either\n+\t * the old or new selector is nonzero, and we need to override\n+\t * the base address if next thread expects it to be overridden.\n+\t *\n+\t * This code is unnecessarily slow in the case where the old and\n+\t * new indexes are zero and the new base is nonzero -- it will\n+\t * unnecessarily write 0 to the selector before writing the new\n+\t * base address.\n+\t *\n+\t * Note: This all depends on arch_prctl being the only way that\n+\t * user code can override the segment base.  Once wrfsbase and\n+\t * wrgsbase are enabled, most of this code will need to change.\n \t *\/\n \tif (unlikely(fsindex | next->fsindex | prev->fs)) {\n \t\tloadsegment(fs, next->fsindex);\n+\n \t\t\/*\n-\t\t * Check if the user used a selector != 0; if yes\n-\t\t *  clear 64bit base, since overloaded base is always\n-\t\t *  mapped to the Null selector\n+\t\t * If user code wrote a nonzero value to FS, then it also\n+\t\t * cleared the overridden base address.\n+\t\t *\n+\t\t * XXX: if user code wrote 0 to FS and cleared the base\n+\t\t * address itself, we won't notice and we'll incorrectly\n+\t\t * restore the prior base address next time we reschdule\n+\t\t * the process.\n \t\t *\/\n \t\tif (fsindex)\n \t\t\tprev->fs = 0;\n \t}\n-\t\/* when next process has a 64bit base use it *\/\n \tif (next->fs)\n \t\twrmsrl(MSR_FS_BASE, next->fs);\n \tprev->fsindex = fsindex;\n \n \tif (unlikely(gsindex | next->gsindex | prev->gs)) {\n \t\tload_gs_index(next->gsindex);\n+\n+\t\t\/* This works (and fails) the same way as fsindex above. *\/\n \t\tif (gsindex)\n \t\t\tprev->gs = 0;\n \t}\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2009-3002","CWE_ID":"200","category":"security","commit_id":"17ac2e9c58b69a1e25460a568eae1b0dc0188c25","commit_message":"From 17ac2e9c58b69a1e25460a568eae1b0dc0188c25 Mon Sep 17 00:00:00 2001\nFrom: Eric Dumazet <eric.dumazet@gmail.com>\nDate: Thu, 6 Aug 2009 03:34:06 +0000\nSubject: rose: Fix rose_getname() leak\n\nrose_getname() can leak kernel memory to user.\n\nSigned-off-by: Eric Dumazet <eric.dumazet@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/rose\/af_rose.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/rose\/af_rose.c b\/net\/rose\/af_rose.c\nindex f0a76f6bca71..e5f478ca3d61 100644\n--- a\/net\/rose\/af_rose.c\n+++ b\/net\/rose\/af_rose.c\n@@ -954,6 +954,7 @@ static int rose_getname(struct socket *sock, struct sockaddr *uaddr,\n \tstruct rose_sock *rose = rose_sk(sk);\n \tint n;\n \n+\tmemset(srose, 0, sizeof(*srose));\n \tif (peer != 0) {\n \t\tif (sk->sk_state != TCP_ESTABLISHED)\n \t\t\treturn -ENOTCONN;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2014-8709","CWE_ID":"200","category":"security","commit_id":"338f977f4eb441e69bb9a46eaa0ac715c931a67f","commit_message":"From 338f977f4eb441e69bb9a46eaa0ac715c931a67f Mon Sep 17 00:00:00 2001\nFrom: Johannes Berg <johannes.berg@intel.com>\nDate: Sat, 1 Feb 2014 00:16:23 +0100\nSubject: [PATCH] mac80211: fix fragmentation code, particularly for encryption\n\nThe \"new\" fragmentation code (since my rewrite almost 5 years ago)\nerroneously sets skb->len rather than using skb_trim() to adjust\nthe length of the first fragment after copying out all the others.\nThis leaves the skb tail pointer pointing to after where the data\noriginally ended, and thus causes the encryption MIC to be written\nat that point, rather than where it belongs: immediately after the\ndata.\n\nThe impact of this is that if software encryption is done, then\n a) encryption doesn't work for the first fragment, the connection\n    becomes unusable as the first fragment will never be properly\n    verified at the receiver, the MIC is practically guaranteed to\n    be wrong\n b) we leak up to 8 bytes of plaintext (!) of the packet out into\n    the air\n\nThis is only mitigated by the fact that many devices are capable\nof doing encryption in hardware, in which case this can't happen\nas the tail pointer is irrelevant in that case. Additionally,\nfragmentation is not used very frequently and would normally have\nto be configured manually.\n\nFix this by using skb_trim() properly.\n\nCc: stable@vger.kernel.org\nFixes: 2de8e0d999b8 (\"mac80211: rewrite fragmentation\")\nReported-by: Jouni Malinen <j@w1.fi>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>\n---\n net\/mac80211\/tx.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/mac80211\/tx.c b\/net\/mac80211\/tx.c\nindex 27c990bf23202..97a02d3f7d877 100644\n--- a\/net\/mac80211\/tx.c\n+++ b\/net\/mac80211\/tx.c\n@@ -878,7 +878,7 @@ static int ieee80211_fragment(struct ieee80211_tx_data *tx,\n \t}\n \n \t\/* adjust first fragment's length *\/\n-\tskb->len = hdrlen + per_fragm;\n+\tskb_trim(skb, hdrlen + per_fragm);\n \treturn 0;\n }\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-6546","CWE_ID":"200","category":"security","commit_id":"e862f1a9b7df4e8196ebec45ac62295138aa3fc2","commit_message":"From e862f1a9b7df4e8196ebec45ac62295138aa3fc2 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:44 +0000\nSubject: [PATCH] atm: fix info leak in getsockopt(SO_ATMPVC)\n\nThe ATM code fails to initialize the two padding bytes of struct\nsockaddr_atmpvc inserted for alignment. Add an explicit memset(0)\nbefore filling the structure to avoid the info leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/atm\/common.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/atm\/common.c b\/net\/atm\/common.c\nindex b4b44dbed645f..0c0ad930a632f 100644\n--- a\/net\/atm\/common.c\n+++ b\/net\/atm\/common.c\n@@ -812,6 +812,7 @@ int vcc_getsockopt(struct socket *sock, int level, int optname,\n \n \t\tif (!vcc->dev || !test_bit(ATM_VF_ADDR, &vcc->flags))\n \t\t\treturn -ENOTCONN;\n+\t\tmemset(&pvc, 0, sizeof(pvc));\n \t\tpvc.sap_family = AF_ATMPVC;\n \t\tpvc.sap_addr.itf = vcc->dev->number;\n \t\tpvc.sap_addr.vpi = vcc->vpi;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-5330","CWE_ID":"200","category":"security","commit_id":"ba5dbda6d0174a59d221c45cca52ecd232820d48","commit_message":"From ba5dbda6d0174a59d221c45cca52ecd232820d48 Mon Sep 17 00:00:00 2001\nFrom: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>\nDate: Tue, 24 Nov 2015 13:47:16 +1300\nSubject: [PATCH] CVE-2015-5330: Fix handling of unicode near string endings\n\nUntil now next_codepoint_ext() and next_codepoint_handle_ext() were\nusing strnlen(str, 5) to determine how much string they should try to\ndecode. This ended up looking past the end of the string when it was not\nnull terminated and the final character looked like a multi-byte encoding.\nThe fix is to let the caller say how long the string can be.\n\nBug: https:\/\/bugzilla.samba.org\/show_bug.cgi?id=11599\n\nSigned-off-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>\nPair-programmed-with: Andrew Bartlett <abartlet@samba.org>\nReviewed-by: Ralph Boehme <slow@samba.org>\n---\n lib\/util\/charset\/charset.h     |  9 +++++----\n lib\/util\/charset\/codepoints.c  | 24 ++++++++++++++++--------\n lib\/util\/charset\/util_str.c    |  3 ++-\n lib\/util\/charset\/util_unistr.c |  3 ++-\n 4 files changed, 25 insertions(+), 14 deletions(-)\n\n","diff_code":"diff --git a\/lib\/util\/charset\/charset.h b\/lib\/util\/charset\/charset.h\nindex 0d69d315b4a..ca7a4377455 100644\n--- a\/lib\/util\/charset\/charset.h\n+++ b\/lib\/util\/charset\/charset.h\n@@ -174,15 +174,16 @@ smb_iconv_t get_conv_handle(struct smb_iconv_handle *ic,\n \t\t\t    charset_t from, charset_t to);\n const char *charset_name(struct smb_iconv_handle *ic, charset_t ch);\n \n-codepoint_t next_codepoint_ext(const char *str, charset_t src_charset,\n-\t\t\t       size_t *size);\n+codepoint_t next_codepoint_ext(const char *str, size_t len,\n+\t\t\t       charset_t src_charset, size_t *size);\n codepoint_t next_codepoint(const char *str, size_t *size);\n ssize_t push_codepoint(char *str, codepoint_t c);\n \n \/* codepoints *\/\n codepoint_t next_codepoint_handle_ext(struct smb_iconv_handle *ic,\n-\t\t\t    const char *str, charset_t src_charset,\n-\t\t\t    size_t *size);\n+\t\t\t\t      const char *str, size_t len,\n+\t\t\t\t      charset_t src_charset,\n+\t\t\t\t      size_t *size);\n codepoint_t next_codepoint_handle(struct smb_iconv_handle *ic,\n \t\t\t    const char *str, size_t *size);\n ssize_t push_codepoint_handle(struct smb_iconv_handle *ic,\ndiff --git a\/lib\/util\/charset\/codepoints.c b\/lib\/util\/charset\/codepoints.c\nindex 19319ba75ce..99d209ff1c3 100644\n--- a\/lib\/util\/charset\/codepoints.c\n+++ b\/lib\/util\/charset\/codepoints.c\n@@ -16657,7 +16657,8 @@ smb_iconv_t get_conv_handle(struct smb_iconv_handle *ic,\n  *\/\n _PUBLIC_ codepoint_t next_codepoint_handle_ext(\n \t\t\tstruct smb_iconv_handle *ic,\n-\t\t\tconst char *str, charset_t src_charset,\n+\t\t\tconst char *str, size_t len,\n+\t\t\tcharset_t src_charset,\n \t\t\tsize_t *bytes_consumed)\n {\n \t\/* it cannot occupy more than 4 bytes in UTF16 format *\/\n@@ -16677,7 +16678,7 @@ _PUBLIC_ codepoint_t next_codepoint_handle_ext(\n \t * we assume that no multi-byte character can take more than 5 bytes.\n \t * This is OK as we only support codepoints up to 1M (U+100000)\n \t *\/\n-\tilen_orig = strnlen(str, 5);\n+\tilen_orig = MIN(len, 5);\n \tilen = ilen_orig;\n \n \tdescriptor = get_conv_handle(ic, src_charset, CH_UTF16);\n@@ -16733,9 +16734,16 @@ _PUBLIC_ codepoint_t next_codepoint_handle_ext(\n   return INVALID_CODEPOINT if the next character cannot be converted\n *\/\n _PUBLIC_ codepoint_t next_codepoint_handle(struct smb_iconv_handle *ic,\n-\t\t\t\t    const char *str, size_t *size)\n+\t\t\t\t\t   const char *str, size_t *size)\n {\n-\treturn next_codepoint_handle_ext(ic, str, CH_UNIX, size);\n+\t\/*\n+\t * We assume that no multi-byte character can take more than 5 bytes\n+\t * thus avoiding walking all the way down a long string. This is OK as\n+\t * Unicode codepoints only go up to (U+10ffff), which can always be\n+\t * encoded in 4 bytes or less.\n+\t *\/\n+\treturn next_codepoint_handle_ext(ic, str, strnlen(str, 5), CH_UNIX,\n+\t\t\t\t\t size);\n }\n \n \/*\n@@ -16797,11 +16805,11 @@ _PUBLIC_ ssize_t push_codepoint_handle(struct smb_iconv_handle *ic,\n \treturn 5 - olen;\n }\n \n-_PUBLIC_ codepoint_t next_codepoint_ext(const char *str, charset_t src_charset,\n-\t\t\t\t\tsize_t *size)\n+_PUBLIC_ codepoint_t next_codepoint_ext(const char *str, size_t len,\n+\t\t\t\t\tcharset_t src_charset, size_t *size)\n {\n-\treturn next_codepoint_handle_ext(get_iconv_handle(), str,\n-\t\t\t\t\t      src_charset, size);\n+\treturn next_codepoint_handle_ext(get_iconv_handle(), str, len,\n+\t\t\t\t\t src_charset, size);\n }\n \n _PUBLIC_ codepoint_t next_codepoint(const char *str, size_t *size)\ndiff --git a\/lib\/util\/charset\/util_str.c b\/lib\/util\/charset\/util_str.c\nindex ef8a82af767..550fba3ed64 100644\n--- a\/lib\/util\/charset\/util_str.c\n+++ b\/lib\/util\/charset\/util_str.c\n@@ -210,7 +210,8 @@ _PUBLIC_ size_t strlen_m_ext_handle(struct smb_iconv_handle *ic,\n \n \twhile (*s) {\n \t\tsize_t c_size;\n-\t\tcodepoint_t c = next_codepoint_handle_ext(ic, s, src_charset, &c_size);\n+\t\tcodepoint_t c = next_codepoint_handle_ext(ic, s, strnlen(s, 5),\n+\t\t\t\t\t\t\t  src_charset, &c_size);\n \t\ts += c_size;\n \n \t\tswitch (dst_charset) {\ndiff --git a\/lib\/util\/charset\/util_unistr.c b\/lib\/util\/charset\/util_unistr.c\nindex e4ae65053c7..f2992695f65 100644\n--- a\/lib\/util\/charset\/util_unistr.c\n+++ b\/lib\/util\/charset\/util_unistr.c\n@@ -112,7 +112,8 @@ _PUBLIC_ char *strupper_talloc_n_handle(struct smb_iconv_handle *iconv_handle,\n \n \twhile (n-- && *src) {\n \t\tsize_t c_size;\n-\t\tcodepoint_t c = next_codepoint_handle(iconv_handle, src, &c_size);\n+\t\tcodepoint_t c = next_codepoint_handle_ext(iconv_handle, src, n,\n+\t\t\t\t\t\t\t  CH_UNIX, &c_size);\n \t\tsrc += c_size;\n \n \t\tc = toupper_m(c);\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-15277","CWE_ID":"200","category":"security","commit_id":"9fd10cf630832b36a588c1545d8736539b2f1fb5","commit_message":"From 9fd10cf630832b36a588c1545d8736539b2f1fb5 Mon Sep 17 00:00:00 2001\nFrom: Cristy <urban-warrior@imagemagick.org>\nDate: Fri, 21 Jul 2017 07:54:50 -0400\nSubject: [PATCH] https:\/\/github.com\/ImageMagick\/ImageMagick\/issues\/592\n\n---\n coders\/gif.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/coders\/gif.c b\/coders\/gif.c\nindex 7a353ffd0a..bbfd5b2067 100644\n--- a\/coders\/gif.c\n+++ b\/coders\/gif.c\n@@ -1018,6 +1018,8 @@ static Image *ReadGIFImage(const ImageInfo *image_info,ExceptionInfo *exception)\n     MagickMax(global_colors,256),3UL*sizeof(*global_colormap));\n   if (global_colormap == (unsigned char *) NULL)\n     ThrowReaderException(ResourceLimitError,\"MemoryAllocationFailed\");\n+  (void) ResetMagickMemory(global_colormap,0,3*MagickMax(global_colors,256)*\n+    sizeof(*global_colormap));\n   if (BitSet((int) flag,0x80) != 0)\n     {\n       count=ReadBlob(image,(size_t) (3*global_colors),global_colormap);\n","owner":"ImageMagick","repo":"ImageMagick","source":"cve"},{"CVE_ID":"CVE-2018-9275","CWE_ID":"200","category":"security","commit_id":"0f6ceabab0a8849b47f67d727aa526c2656089ba","commit_message":"From 0f6ceabab0a8849b47f67d727aa526c2656089ba Mon Sep 17 00:00:00 2001\nFrom: Klas Lindfors <klas@yubico.com>\nDate: Tue, 3 Apr 2018 09:19:53 +0200\nSubject: [PATCH] util: make sure to close the authfile before returning\n success\n\nfixes #136\n---\n util.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/util.c b\/util.c\nindex 6cb4a79..32bca06 100644\n--- a\/util.c\n+++ b\/util.c\n@@ -167,6 +167,8 @@ check_user_token (const char *authfile,\n \t\t{\n \t\t  if(verbose)\n \t\t      D (debug_file, \"Match user\/token as %s\/%s\", username, otp_id);\n+\n+\t\t  fclose(opwfile);\n \t\t  return AUTH_FOUND;\n \t\t}\n \t    }\n","owner":"Yubico","repo":"yubico-pam","source":"cve"},{"CVE_ID":"CVE-2010-1636","CWE_ID":"200","category":"security","commit_id":"5dc6416414fb3ec6e2825fd4d20c8bf1d7fe0395","commit_message":"From 5dc6416414fb3ec6e2825fd4d20c8bf1d7fe0395 Mon Sep 17 00:00:00 2001\nFrom: Dan Rosenberg <dan.j.rosenberg@gmail.com>\nDate: Sat, 15 May 2010 11:27:37 -0400\nSubject: Btrfs: check for read permission on src file in the clone ioctl\n\nThe existing code would have allowed you to clone a file that was\nonly open for writing\n\nSigned-off-by: Chris Mason <chris.mason@oracle.com>\n---\n fs\/btrfs\/ioctl.c | 5 +++++\n 1 file changed, 5 insertions(+)\n\n","diff_code":"diff --git a\/fs\/btrfs\/ioctl.c b\/fs\/btrfs\/ioctl.c\nindex 2b7dd88fc54f..9de6c3a75bfb 100644\n--- a\/fs\/btrfs\/ioctl.c\n+++ b\/fs\/btrfs\/ioctl.c\n@@ -1480,12 +1480,17 @@ static noinline long btrfs_ioctl_clone(struct file *file, unsigned long srcfd,\n \t\tret = -EBADF;\n \t\tgoto out_drop_write;\n \t}\n+\n \tsrc = src_file->f_dentry->d_inode;\n \n \tret = -EINVAL;\n \tif (src == inode)\n \t\tgoto out_fput;\n \n+\t\/* the src must be open for reading *\/\n+\tif (!(src_file->f_mode & FMODE_READ))\n+\t\tgoto out_fput;\n+\n \tret = -EISDIR;\n \tif (S_ISDIR(src->i_mode) || S_ISDIR(inode->i_mode))\n \t\tgoto out_fput;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"mjg59","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2018-12436","CWE_ID":"200","category":"security","commit_id":"9b9568d500f31f964af26ba8d01e542e1f27e5ca","commit_message":"From 9b9568d500f31f964af26ba8d01e542e1f27e5ca Mon Sep 17 00:00:00 2001\nFrom: Sean Parkinson <sean@wolfssl.com>\nDate: Mon, 28 May 2018 08:32:45 +1000\nSubject: [PATCH] Change ECDSA signing to use blinding.\n\n---\n wolfcrypt\/src\/ecc.c | 68 +++++++++++++++++++++++++++++++++++----------\n 1 file changed, 54 insertions(+), 14 deletions(-)\n\n","diff_code":"diff --git a\/wolfcrypt\/src\/ecc.c b\/wolfcrypt\/src\/ecc.c\nindex ee271da8f4..6bfd210581 100644\n--- a\/wolfcrypt\/src\/ecc.c\n+++ b\/wolfcrypt\/src\/ecc.c\n@@ -3139,12 +3139,6 @@ static int wc_ecc_gen_k(WC_RNG* rng, int size, mp_int* k, mp_int* order)\n     if (err == 0)\n         err = mp_read_unsigned_bin(k, (byte*)buf, size);\n \n-    \/* quick sanity check to make sure we're not dealing with a 0 key *\/\n-    if (err == MP_OKAY) {\n-        if (mp_iszero(k) == MP_YES)\n-          err = MP_ZERO_E;\n-    }\n-\n     \/* the key should be smaller than the order of base point *\/\n     if (err == MP_OKAY) {\n         if (mp_cmp(k, order) != MP_LT) {\n@@ -3152,6 +3146,12 @@ static int wc_ecc_gen_k(WC_RNG* rng, int size, mp_int* k, mp_int* order)\n         }\n     }\n \n+    \/* quick sanity check to make sure we're not dealing with a 0 key *\/\n+    if (err == MP_OKAY) {\n+        if (mp_iszero(k) == MP_YES)\n+          err = MP_ZERO_E;\n+    }\n+\n     ForceZero(buf, ECC_MAXSIZE);\n #ifdef WOLFSSL_SMALL_STACK\n     XFREE(buf, NULL, DYNAMIC_TYPE_ECC_BUFFER);\n@@ -3924,20 +3924,40 @@ int wc_ecc_sign_hash_ex(const byte* in, word32 inlen, WC_RNG* rng,\n \n        \/* don't use async for key, since we don't support async return here *\/\n        if ((err = wc_ecc_init_ex(&pubkey, key->heap, INVALID_DEVID)) == MP_OKAY) {\n+           mp_int b;\n+\n+           if (err == MP_OKAY) {\n+               err = mp_init(&b);\n+           }\n+\n        #ifdef WOLFSSL_CUSTOM_CURVES\n            \/* if custom curve, apply params to pubkey *\/\n-           if (key->idx == ECC_CUSTOM_IDX) {\n+           if (err == MP_OKAY && key->idx == ECC_CUSTOM_IDX) {\n                err = wc_ecc_set_custom_curve(&pubkey, key->dp);\n            }\n        #endif\n \n+           if (err == MP_OKAY) {\n+               \/* Generate blinding value - non-zero value. *\/\n+               do {\n+                   if (++loop_check > 64) {\n+                        err = RNG_FAILURE_E;\n+                        break;\n+                   }\n+\n+                   err = wc_ecc_gen_k(rng, key->dp->size, &b, curve->order);\n+               }\n+               while (err == MP_ZERO_E);\n+               loop_check = 0;\n+           }\n+\n            for (; err == MP_OKAY;) {\n                if (++loop_check > 64) {\n                     err = RNG_FAILURE_E;\n                     break;\n                }\n                err = wc_ecc_make_key_ex(rng, key->dp->size, &pubkey,\n-                                                              key->dp->id);\n+                                                                   key->dp->id);\n                if (err != MP_OKAY) break;\n \n                \/* find r = x1 mod n *\/\n@@ -3953,30 +3973,50 @@ int wc_ecc_sign_hash_ex(const byte* in, word32 inlen, WC_RNG* rng,\n                    mp_forcezero(&pubkey.k);\n                }\n                else {\n-                   \/* find s = (e + xr)\/k *\/\n+                   \/* find s = (e + xr)\/k\n+                             = b.(e\/k.b + x.r\/k.b) *\/\n+\n+                   \/* k = k.b *\/\n+                   err = mp_mulmod(&pubkey.k, &b, curve->order, &pubkey.k);\n+                   if (err != MP_OKAY) break;\n+\n+                   \/* k = 1\/k.b *\/\n                    err = mp_invmod(&pubkey.k, curve->order, &pubkey.k);\n                    if (err != MP_OKAY) break;\n \n-                   \/* s = xr *\/\n+                   \/* s = x.r *\/\n                    err = mp_mulmod(&key->k, r, curve->order, s);\n                    if (err != MP_OKAY) break;\n \n-                   \/* s = e +  xr *\/\n+                   \/* s = x.r\/k.b *\/\n+                   err = mp_mulmod(&pubkey.k, s, curve->order, s);\n+                   if (err != MP_OKAY) break;\n+\n+                   \/* e = e\/k.b *\/\n+                   err = mp_mulmod(&pubkey.k, e, curve->order, e);\n+                   if (err != MP_OKAY) break;\n+\n+                   \/* s = e\/k.b + x.r\/k.b\n+                        = (e + x.r)\/k.b *\/\n                    err = mp_add(e, s, s);\n                    if (err != MP_OKAY) break;\n \n-                   \/* s = e +  xr *\/\n-                   err = mp_mod(s, curve->order, s);\n+                   \/* s = b.(e + x.r)\/k.b\n+                        = (e + x.r)\/k *\/\n+                   err = mp_mulmod(s, &b, curve->order, s);\n                    if (err != MP_OKAY) break;\n \n                    \/* s = (e + xr)\/k *\/\n-                   err = mp_mulmod(s, &pubkey.k, curve->order, s);\n+                   err = mp_mod(s, curve->order, s);\n+                   if (err != MP_OKAY) break;\n \n                    if (mp_iszero(s) == MP_NO)\n                        break;\n                 }\n            }\n            wc_ecc_free(&pubkey);\n+           mp_clear(&b);\n+           mp_free(&b);\n        }\n    }\n \n","owner":"wolfSSL","repo":"wolfssl","source":"cve"},{"CVE_ID":"CVE-2019-11833","CWE_ID":"200","category":"security","commit_id":"592acbf16821288ecdc4192c47e3774a4c48bb64","commit_message":"From 592acbf16821288ecdc4192c47e3774a4c48bb64 Mon Sep 17 00:00:00 2001\nFrom: Sriram Rajagopalan <sriramr@arista.com>\nDate: Fri, 10 May 2019 19:28:06 -0400\nSubject: [PATCH] ext4: zero out the unused memory region in the extent tree\n block\n\nThis commit zeroes out the unused memory region in the buffer_head\ncorresponding to the extent metablock after writing the extent header\nand the corresponding extent node entries.\n\nThis is done to prevent random uninitialized data from getting into\nthe filesystem when the extent block is synced.\n\nThis fixes CVE-2019-11833.\n\nSigned-off-by: Sriram Rajagopalan <sriramr@arista.com>\nSigned-off-by: Theodore Ts'o <tytso@mit.edu>\nCc: stable@kernel.org\n---\n fs\/ext4\/extents.c | 17 +++++++++++++++--\n 1 file changed, 15 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/fs\/ext4\/extents.c b\/fs\/ext4\/extents.c\nindex 0f89f5190cd72..f2c62e2a0c982 100644\n--- a\/fs\/ext4\/extents.c\n+++ b\/fs\/ext4\/extents.c\n@@ -1035,6 +1035,7 @@ static int ext4_ext_split(handle_t *handle, struct inode *inode,\n \t__le32 border;\n \text4_fsblk_t *ablocks = NULL; \/* array of allocated blocks *\/\n \tint err = 0;\n+\tsize_t ext_size = 0;\n \n \t\/* make decision: where to split? *\/\n \t\/* FIXME: now decision is simplest: at current extent *\/\n@@ -1126,6 +1127,10 @@ static int ext4_ext_split(handle_t *handle, struct inode *inode,\n \t\tle16_add_cpu(&neh->eh_entries, m);\n \t}\n \n+\t\/* zero out unused area in the extent block *\/\n+\text_size = sizeof(struct ext4_extent_header) +\n+\t\tsizeof(struct ext4_extent) * le16_to_cpu(neh->eh_entries);\n+\tmemset(bh->b_data + ext_size, 0, inode->i_sb->s_blocksize - ext_size);\n \text4_extent_block_csum_set(inode, neh);\n \tset_buffer_uptodate(bh);\n \tunlock_buffer(bh);\n@@ -1205,6 +1210,11 @@ static int ext4_ext_split(handle_t *handle, struct inode *inode,\n \t\t\t\tsizeof(struct ext4_extent_idx) * m);\n \t\t\tle16_add_cpu(&neh->eh_entries, m);\n \t\t}\n+\t\t\/* zero out unused area in the extent block *\/\n+\t\text_size = sizeof(struct ext4_extent_header) +\n+\t\t   (sizeof(struct ext4_extent) * le16_to_cpu(neh->eh_entries));\n+\t\tmemset(bh->b_data + ext_size, 0,\n+\t\t\tinode->i_sb->s_blocksize - ext_size);\n \t\text4_extent_block_csum_set(inode, neh);\n \t\tset_buffer_uptodate(bh);\n \t\tunlock_buffer(bh);\n@@ -1270,6 +1280,7 @@ static int ext4_ext_grow_indepth(handle_t *handle, struct inode *inode,\n \text4_fsblk_t newblock, goal = 0;\n \tstruct ext4_super_block *es = EXT4_SB(inode->i_sb)->s_es;\n \tint err = 0;\n+\tsize_t ext_size = 0;\n \n \t\/* Try to prepend new index to old one *\/\n \tif (ext_depth(inode))\n@@ -1295,9 +1306,11 @@ static int ext4_ext_grow_indepth(handle_t *handle, struct inode *inode,\n \t\tgoto out;\n \t}\n \n+\text_size = sizeof(EXT4_I(inode)->i_data);\n \t\/* move top-level index\/leaf into new block *\/\n-\tmemmove(bh->b_data, EXT4_I(inode)->i_data,\n-\t\tsizeof(EXT4_I(inode)->i_data));\n+\tmemmove(bh->b_data, EXT4_I(inode)->i_data, ext_size);\n+\t\/* zero out unused area in the extent block *\/\n+\tmemset(bh->b_data + ext_size, 0, inode->i_sb->s_blocksize - ext_size);\n \n \t\/* set size of new block *\/\n \tneh = ext_block_hdr(bh);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2009-3002","CWE_ID":"200","category":"security","commit_id":"09384dfc76e526c3993c09c42e016372dc9dd22c","commit_message":"From 09384dfc76e526c3993c09c42e016372dc9dd22c Mon Sep 17 00:00:00 2001\nFrom: Eric Dumazet <eric.dumazet@gmail.com>\nDate: Thu, 6 Aug 2009 03:55:04 +0000\nSubject: irda: Fix irda_getname() leak\n\nirda_getname() can leak kernel memory to user.\n\nSigned-off-by: Eric Dumazet <eric.dumazet@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/irda\/af_irda.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/irda\/af_irda.c b\/net\/irda\/af_irda.c\nindex cb762c8723ea..3ec2b434ea75 100644\n--- a\/net\/irda\/af_irda.c\n+++ b\/net\/irda\/af_irda.c\n@@ -714,6 +714,7 @@ static int irda_getname(struct socket *sock, struct sockaddr *uaddr,\n \tstruct sock *sk = sock->sk;\n \tstruct irda_sock *self = irda_sk(sk);\n \n+\tmemset(&saddr, 0, sizeof(saddr));\n \tif (peer) {\n \t\tif (sk->sk_state != TCP_ESTABLISHED)\n \t\t\treturn -ENOTCONN;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"mjg59","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-6200","CWE_ID":"200","category":"security","commit_id":"4ea8df7403381d9b657b121b3c98d8081b27414d","commit_message":"From 4ea8df7403381d9b657b121b3c98d8081b27414d Mon Sep 17 00:00:00 2001\nFrom: Kenton Varda <kenton@sandstorm.io>\nDate: Wed, 1 Mar 2017 12:03:35 -0800\nSubject: [PATCH] Improve security of zip\/unzip sandbox by switching the\n sandboxed filesystem from blacklisting directories to whitelisting them.\n\n---\n src\/sandstorm\/backup.c++ | 27 ++++++++++++++-------------\n 1 file changed, 14 insertions(+), 13 deletions(-)\n\n","diff_code":"diff --git a\/src\/sandstorm\/backup.c++ b\/src\/sandstorm\/backup.c++\nindex 5d836611b..16d3cf455 100644\n--- a\/src\/sandstorm\/backup.c++\n+++ b\/src\/sandstorm\/backup.c++\n@@ -144,21 +144,22 @@ bool BackupMain::run(kj::StringPtr grainDir) {\n   \/\/ are undocumented.  :(\n   KJ_SYSCALL(mount(\"none\", \"\/\", nullptr, MS_REC | MS_PRIVATE, nullptr));\n \n-  \/\/ Mount root read-only.\n-  bind(kj::str(root, \"\/\"), \"\/tmp\", MS_BIND | MS_NOSUID | MS_RDONLY);\n-\n-  if (access(\"\/tmp\/dev\/null\", F_OK) != 0) {\n-    \/\/ Looks like we need to bind in \/dev.\n-    KJ_SYSCALL(mount(\"\/dev\", \"\/tmp\/dev\", nullptr, MS_BIND, nullptr));\n+  \/\/ Create tmpfs root to whitelist directories that we want to bind in.\n+  KJ_SYSCALL(mount(\"tmpfs\", \"\/tmp\", \"tmpfs\", 0, \"size=8m,nr_inodes=128,mode=755\"));\n+\n+  \/\/ Bind in whitelisted directories.\n+  const char* WHITELIST[] = { \"dev\", \"bin\", \"lib\", \"lib64\", \"usr\" };\n+  for (const char* dir: WHITELIST) {\n+    auto src = kj::str(root, \"\/\", dir);\n+    auto dst = kj::str(\"\/tmp\/\", dir);\n+    if (access(src.cStr(), F_OK) == 0) {\n+      KJ_SYSCALL(mkdir(dst.cStr(), 0755));\n+      bind(src, dst, MS_BIND | MS_NOSUID | MS_RDONLY);\n+    }\n   }\n \n-  \/\/ Hide sensitive directories.\n-  KJ_SYSCALL(mount(\"tmpfs\", \"\/tmp\/proc\", \"tmpfs\", 0, \"size=32k,nr_inodes=8,mode=000\"));\n-  KJ_SYSCALL(mount(\"tmpfs\", \"\/tmp\/var\", \"tmpfs\", 0, \"size=32k,nr_inodes=8,mode=000\"));\n-  KJ_SYSCALL(mount(\"tmpfs\", \"\/tmp\/etc\", \"tmpfs\", 0, \"size=32k,nr_inodes=8,mode=000\"));\n-\n-  \/\/ Mount inner tmpfs.\n-  KJ_SYSCALL(mount(\"tmpfs\", \"\/tmp\/tmp\", \"tmpfs\", 0, \"size=8m,nr_inodes=128,mode=777\"));\n+  \/\/ Make sandboxed \/tmp.\n+  KJ_SYSCALL(mkdir(\"\/tmp\/tmp\", 0777));\n \n   \/\/ Bind in the grain's `data` (=`sandbox`).\n   KJ_SYSCALL(mkdir(\"\/tmp\/tmp\/data\", 0777));\n","owner":"sandstorm-io","repo":"sandstorm","source":"cve"},{"CVE_ID":"CVE-2010-4080","CWE_ID":"200","category":"security","commit_id":"e68d3b316ab7b02a074edc4f770e6a746390cb7d","commit_message":"From e68d3b316ab7b02a074edc4f770e6a746390cb7d Mon Sep 17 00:00:00 2001\nFrom: Dan Rosenberg <drosenberg@vsecurity.com>\nDate: Sat, 25 Sep 2010 11:07:27 -0400\nSubject: ALSA: sound\/pci\/rme9652: prevent reading uninitialized stack memory\n\nThe SNDRV_HDSP_IOCTL_GET_CONFIG_INFO and\nSNDRV_HDSP_IOCTL_GET_CONFIG_INFO ioctls in hdspm.c and hdsp.c allow\nunprivileged users to read uninitialized kernel stack memory, because\nseveral fields of the hdsp{m}_config_info structs declared on the stack\nare not altered or zeroed before being copied back to the user.  This\npatch takes care of it.\n\nSigned-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>\nCc: <stable@kernel.org>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>\n---\n sound\/pci\/rme9652\/hdsp.c  | 1 +\n sound\/pci\/rme9652\/hdspm.c | 1 +\n 2 files changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/sound\/pci\/rme9652\/hdsp.c b\/sound\/pci\/rme9652\/hdsp.c\nindex b92adef8e81e..d6fa7bfd9aa1 100644\n--- a\/sound\/pci\/rme9652\/hdsp.c\n+++ b\/sound\/pci\/rme9652\/hdsp.c\n@@ -4609,6 +4609,7 @@ static int snd_hdsp_hwdep_ioctl(struct snd_hwdep *hw, struct file *file, unsigne\n \t\tif (err < 0)\n \t\t\treturn err;\n \n+\t\tmemset(&info, 0, sizeof(info));\n \t\tspin_lock_irqsave(&hdsp->lock, flags);\n \t\tinfo.pref_sync_ref = (unsigned char)hdsp_pref_sync_ref(hdsp);\n \t\tinfo.wordclock_sync_check = (unsigned char)hdsp_wc_sync_check(hdsp);\ndiff --git a\/sound\/pci\/rme9652\/hdspm.c b\/sound\/pci\/rme9652\/hdspm.c\nindex 547b713d7204..0c98ef9156d8 100644\n--- a\/sound\/pci\/rme9652\/hdspm.c\n+++ b\/sound\/pci\/rme9652\/hdspm.c\n@@ -4127,6 +4127,7 @@ static int snd_hdspm_hwdep_ioctl(struct snd_hwdep * hw, struct file *file,\n \n \tcase SNDRV_HDSPM_IOCTL_GET_CONFIG_INFO:\n \n+\t\tmemset(&info, 0, sizeof(info));\n \t\tspin_lock_irq(&hdspm->lock);\n \t\tinfo.pref_sync_ref = hdspm_pref_sync_ref(hdspm);\n \t\tinfo.wordclock_sync_check = hdspm_wc_sync_check(hdspm);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2010-4077","CWE_ID":"200","category":"security","commit_id":"d281da7ff6f70efca0553c288bb883e8605b3862","commit_message":"From d281da7ff6f70efca0553c288bb883e8605b3862 Mon Sep 17 00:00:00 2001\nFrom: Alan Cox <alan@linux.intel.com>\nDate: Thu, 16 Sep 2010 18:21:24 +0100\nSubject: tty: Make tiocgicount a handler\n\nDan Rosenberg noted that various drivers return the struct with uncleared\nfields. Instead of spending forever trying to stomp all the drivers that\nget it wrong (and every new driver) do the job in one place.\n\nThis first patch adds the needed operations and hooks them up, including\nthe needed USB midlayer and serial core plumbing.\n\nSigned-off-by: Alan Cox <alan@linux.intel.com>\nSigned-off-by: Greg Kroah-Hartman <gregkh@suse.de>\n---\n drivers\/char\/tty_io.c           | 21 +++++++++++++++++++++\n drivers\/serial\/serial_core.c    | 35 ++++++++++++++++-------------------\n drivers\/usb\/serial\/usb-serial.c | 13 +++++++++++++\n include\/linux\/tty_driver.h      |  9 +++++++++\n include\/linux\/usb\/serial.h      |  2 ++\n 5 files changed, 61 insertions(+), 19 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/char\/tty_io.c b\/drivers\/char\/tty_io.c\nindex e185db36f8ad..c05c5af5aa04 100644\n--- a\/drivers\/char\/tty_io.c\n+++ b\/drivers\/char\/tty_io.c\n@@ -96,6 +96,7 @@\n #include <linux\/bitops.h>\n #include <linux\/delay.h>\n #include <linux\/seq_file.h>\n+#include <linux\/serial.h>\n \n #include <linux\/uaccess.h>\n #include <asm\/system.h>\n@@ -2511,6 +2512,20 @@ static int tty_tiocmset(struct tty_struct *tty, struct file *file, unsigned int\n \treturn tty->ops->tiocmset(tty, file, set, clear);\n }\n \n+static int tty_tiocgicount(struct tty_struct *tty, void __user *arg)\n+{\n+\tint retval = -EINVAL;\n+\tstruct serial_icounter_struct icount;\n+\tmemset(&icount, 0, sizeof(icount));\n+\tif (tty->ops->get_icount)\n+\t\tretval = tty->ops->get_icount(tty, &icount);\n+\tif (retval != 0)\n+\t\treturn retval;\n+\tif (copy_to_user(arg, &icount, sizeof(icount)))\n+\t\treturn -EFAULT;\n+\treturn 0;\n+}\n+\n struct tty_struct *tty_pair_get_tty(struct tty_struct *tty)\n {\n \tif (tty->driver->type == TTY_DRIVER_TYPE_PTY &&\n@@ -2631,6 +2646,12 @@ long tty_ioctl(struct file *file, unsigned int cmd, unsigned long arg)\n \tcase TIOCMBIC:\n \tcase TIOCMBIS:\n \t\treturn tty_tiocmset(tty, file, cmd, p);\n+\tcase TIOCGICOUNT:\n+\t\tretval = tty_tiocgicount(tty, p);\n+\t\t\/* For the moment allow fall through to the old method *\/\n+        \tif (retval != -EINVAL)\n+\t\t\treturn retval;\n+\t\tbreak;\n \tcase TCFLSH:\n \t\tswitch (arg) {\n \t\tcase TCIFLUSH:\ndiff --git a\/drivers\/serial\/serial_core.c b\/drivers\/serial\/serial_core.c\nindex bc6cddd10294..c4ea14670d44 100644\n--- a\/drivers\/serial\/serial_core.c\n+++ b\/drivers\/serial\/serial_core.c\n@@ -1074,10 +1074,10 @@ uart_wait_modem_status(struct uart_state *state, unsigned long arg)\n  * NB: both 1->0 and 0->1 transitions are counted except for\n  *     RI where only 0->1 is counted.\n  *\/\n-static int uart_get_count(struct uart_state *state,\n-\t\t\t  struct serial_icounter_struct __user *icnt)\n+static int uart_get_icount(struct tty_struct *tty,\n+\t\t\t  struct serial_icounter_struct *icount)\n {\n-\tstruct serial_icounter_struct icount;\n+\tstruct uart_state *state = tty->driver_data;\n \tstruct uart_icount cnow;\n \tstruct uart_port *uport = state->uart_port;\n \n@@ -1085,19 +1085,19 @@ static int uart_get_count(struct uart_state *state,\n \tmemcpy(&cnow, &uport->icount, sizeof(struct uart_icount));\n \tspin_unlock_irq(&uport->lock);\n \n-\ticount.cts         = cnow.cts;\n-\ticount.dsr         = cnow.dsr;\n-\ticount.rng         = cnow.rng;\n-\ticount.dcd         = cnow.dcd;\n-\ticount.rx          = cnow.rx;\n-\ticount.tx          = cnow.tx;\n-\ticount.frame       = cnow.frame;\n-\ticount.overrun     = cnow.overrun;\n-\ticount.parity      = cnow.parity;\n-\ticount.brk         = cnow.brk;\n-\ticount.buf_overrun = cnow.buf_overrun;\n+\ticount->cts         = cnow.cts;\n+\ticount->dsr         = cnow.dsr;\n+\ticount->rng         = cnow.rng;\n+\ticount->dcd         = cnow.dcd;\n+\ticount->rx          = cnow.rx;\n+\ticount->tx          = cnow.tx;\n+\ticount->frame       = cnow.frame;\n+\ticount->overrun     = cnow.overrun;\n+\ticount->parity      = cnow.parity;\n+\ticount->brk         = cnow.brk;\n+\ticount->buf_overrun = cnow.buf_overrun;\n \n-\treturn copy_to_user(icnt, &icount, sizeof(icount)) ? -EFAULT : 0;\n+\treturn 0;\n }\n \n \/*\n@@ -1150,10 +1150,6 @@ uart_ioctl(struct tty_struct *tty, struct file *filp, unsigned int cmd,\n \tcase TIOCMIWAIT:\n \t\tret = uart_wait_modem_status(state, arg);\n \t\tbreak;\n-\n-\tcase TIOCGICOUNT:\n-\t\tret = uart_get_count(state, uarg);\n-\t\tbreak;\n \t}\n \n \tif (ret != -ENOIOCTLCMD)\n@@ -2295,6 +2291,7 @@ static const struct tty_operations uart_ops = {\n #endif\n \t.tiocmget\t= uart_tiocmget,\n \t.tiocmset\t= uart_tiocmset,\n+\t.get_icount\t= uart_get_icount,\n #ifdef CONFIG_CONSOLE_POLL\n \t.poll_init\t= uart_poll_init,\n \t.poll_get_char\t= uart_poll_get_char,\ndiff --git a\/drivers\/usb\/serial\/usb-serial.c b\/drivers\/usb\/serial\/usb-serial.c\nindex 7a2177c79bde..e64da74bdcc5 100644\n--- a\/drivers\/usb\/serial\/usb-serial.c\n+++ b\/drivers\/usb\/serial\/usb-serial.c\n@@ -519,6 +519,18 @@ static int serial_tiocmset(struct tty_struct *tty, struct file *file,\n \treturn -EINVAL;\n }\n \n+static int serial_get_icount(struct tty_struct *tty,\n+\t\t\t\tstruct serial_icounter_struct *icount)\n+{\n+\tstruct usb_serial_port *port = tty->driver_data;\n+\n+\tdbg(\"%s - port %d\", __func__, port->number);\n+\n+\tif (port->serial->type->get_icount)\n+\t\treturn port->serial->type->get_icount(tty, icount);\n+\treturn -EINVAL;\n+}\n+\n \/*\n  * We would be calling tty_wakeup here, but unfortunately some line\n  * disciplines have an annoying habit of calling tty->write from\n@@ -1195,6 +1207,7 @@ static const struct tty_operations serial_ops = {\n \t.chars_in_buffer =\tserial_chars_in_buffer,\n \t.tiocmget =\t\tserial_tiocmget,\n \t.tiocmset =\t\tserial_tiocmset,\n+\t.get_icount = \t\tserial_get_icount,\n \t.cleanup = \t\tserial_cleanup,\n \t.install = \t\tserial_install,\n \t.proc_fops =\t\t&serial_proc_fops,\ndiff --git a\/include\/linux\/tty_driver.h b\/include\/linux\/tty_driver.h\nindex b08677982525..db2d227694da 100644\n--- a\/include\/linux\/tty_driver.h\n+++ b\/include\/linux\/tty_driver.h\n@@ -224,6 +224,12 @@\n  *\tunless the tty also has a valid tty->termiox pointer.\n  *\n  *\tOptional: Called under the termios lock\n+ *\n+ * int (*get_icount)(struct tty_struct *tty, struct serial_icounter *icount);\n+ *\n+ *\tCalled when the device receives a TIOCGICOUNT ioctl. Passed a kernel\n+ *\tstructure to complete. This method is optional and will only be called\n+ *\tif provided (otherwise EINVAL will be returned).\n  *\/\n \n #include <linux\/fs.h>\n@@ -232,6 +238,7 @@\n \n struct tty_struct;\n struct tty_driver;\n+struct serial_icounter_struct;\n \n struct tty_operations {\n \tstruct tty_struct * (*lookup)(struct tty_driver *driver,\n@@ -268,6 +275,8 @@ struct tty_operations {\n \t\t\tunsigned int set, unsigned int clear);\n \tint (*resize)(struct tty_struct *tty, struct winsize *ws);\n \tint (*set_termiox)(struct tty_struct *tty, struct termiox *tnew);\n+\tint (*get_icount)(struct tty_struct *tty,\n+\t\t\t\tstruct serial_icounter_struct *icount);\n #ifdef CONFIG_CONSOLE_POLL\n \tint (*poll_init)(struct tty_driver *driver, int line, char *options);\n \tint (*poll_get_char)(struct tty_driver *driver, int line);\ndiff --git a\/include\/linux\/usb\/serial.h b\/include\/linux\/usb\/serial.h\nindex 55675b1efb28..16d682f4f7c3 100644\n--- a\/include\/linux\/usb\/serial.h\n+++ b\/include\/linux\/usb\/serial.h\n@@ -271,6 +271,8 @@ struct usb_serial_driver {\n \tint  (*tiocmget)(struct tty_struct *tty, struct file *file);\n \tint  (*tiocmset)(struct tty_struct *tty, struct file *file,\n \t\t\t unsigned int set, unsigned int clear);\n+\tint  (*get_icount)(struct tty_struct *tty,\n+\t\t\tstruct serial_icounter_struct *icount);\n \t\/* Called by the tty layer for port level work. There may or may not\n \t   be an attached tty at this point *\/\n \tvoid (*dtr_rts)(struct usb_serial_port *port, int on);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-11508","CWE_ID":"200","category":"security","commit_id":"0a0b98734479aa5b3c671d5190e86273372cab95","commit_message":"From 0a0b98734479aa5b3c671d5190e86273372cab95 Mon Sep 17 00:00:00 2001\nFrom: Jann Horn <jannh@google.com>\nDate: Fri, 11 May 2018 02:19:01 +0200\nSubject: compat: fix 4-byte infoleak via uninitialized struct field\n\nCommit 3a4d44b61625 (\"ntp: Move adjtimex related compat syscalls to\nnative counterparts\") removed the memset() in compat_get_timex().  Since\nthen, the compat adjtimex syscall can invoke do_adjtimex() with an\nuninitialized ->tai.\n\nIf do_adjtimex() doesn't write to ->tai (e.g.  because the arguments are\ninvalid), compat_put_timex() then copies the uninitialized ->tai field\nto userspace.\n\nFix it by adding the memset() back.\n\nFixes: 3a4d44b61625 (\"ntp: Move adjtimex related compat syscalls to native counterparts\")\nSigned-off-by: Jann Horn <jannh@google.com>\nAcked-by: Kees Cook <keescook@chromium.org>\nAcked-by: Al Viro <viro@zeniv.linux.org.uk>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n kernel\/compat.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/kernel\/compat.c b\/kernel\/compat.c\nindex 6d21894806b4..92d8c98c0f57 100644\n--- a\/kernel\/compat.c\n+++ b\/kernel\/compat.c\n@@ -34,6 +34,7 @@ int compat_get_timex(struct timex *txc, const struct compat_timex __user *utp)\n {\n \tstruct compat_timex tx32;\n \n+\tmemset(txc, 0, sizeof(struct timex));\n \tif (copy_from_user(&tx32, utp, sizeof(struct compat_timex)))\n \t\treturn -EFAULT;\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2011-0710","CWE_ID":"200","category":"security","commit_id":"261cd298a8c363d7985e3482946edb4bfedacf98","commit_message":"From 261cd298a8c363d7985e3482946edb4bfedacf98 Mon Sep 17 00:00:00 2001\nFrom: Martin Schwidefsky <schwidefsky@de.ibm.com>\nDate: Tue, 15 Feb 2011 09:43:32 +0100\nSubject: s390: remove task_show_regs\n\ntask_show_regs used to be a debugging aid in the early bringup days\nof Linux on s390. \/proc\/<pid>\/status is a world readable file, it\nis not a good idea to show the registers of a process. The only\ncorrect fix is to remove task_show_regs.\n\nReported-by: Al Viro <viro@zeniv.linux.org.uk>\nSigned-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n arch\/s390\/include\/asm\/processor.h |  5 -----\n arch\/s390\/kernel\/traps.c          | 37 -------------------------------------\n fs\/proc\/array.c                   |  3 ---\n 3 files changed, 45 deletions(-)\n\n","diff_code":"diff --git a\/arch\/s390\/include\/asm\/processor.h b\/arch\/s390\/include\/asm\/processor.h\nindex bf3de04170a7..2c79b6416271 100644\n--- a\/arch\/s390\/include\/asm\/processor.h\n+++ b\/arch\/s390\/include\/asm\/processor.h\n@@ -148,11 +148,6 @@ extern int kernel_thread(int (*fn)(void *), void * arg, unsigned long flags);\n  *\/\n extern unsigned long thread_saved_pc(struct task_struct *t);\n \n-\/*\n- * Print register of task into buffer. Used in fs\/proc\/array.c.\n- *\/\n-extern void task_show_regs(struct seq_file *m, struct task_struct *task);\n-\n extern void show_code(struct pt_regs *regs);\n \n unsigned long get_wchan(struct task_struct *p);\ndiff --git a\/arch\/s390\/kernel\/traps.c b\/arch\/s390\/kernel\/traps.c\nindex 5eb78dd584ce..b5a4a739b477 100644\n--- a\/arch\/s390\/kernel\/traps.c\n+++ b\/arch\/s390\/kernel\/traps.c\n@@ -237,43 +237,6 @@ void show_regs(struct pt_regs *regs)\n \tshow_last_breaking_event(regs);\n }\n \n-\/* This is called from fs\/proc\/array.c *\/\n-void task_show_regs(struct seq_file *m, struct task_struct *task)\n-{\n-\tstruct pt_regs *regs;\n-\n-\tregs = task_pt_regs(task);\n-\tseq_printf(m, \"task: %p, ksp: %p\\n\",\n-\t\t       task, (void *)task->thread.ksp);\n-\tseq_printf(m, \"User PSW : %p %p\\n\",\n-\t\t       (void *) regs->psw.mask, (void *)regs->psw.addr);\n-\n-\tseq_printf(m, \"User GPRS: \" FOURLONG,\n-\t\t\t  regs->gprs[0], regs->gprs[1],\n-\t\t\t  regs->gprs[2], regs->gprs[3]);\n-\tseq_printf(m, \"           \" FOURLONG,\n-\t\t\t  regs->gprs[4], regs->gprs[5],\n-\t\t\t  regs->gprs[6], regs->gprs[7]);\n-\tseq_printf(m, \"           \" FOURLONG,\n-\t\t\t  regs->gprs[8], regs->gprs[9],\n-\t\t\t  regs->gprs[10], regs->gprs[11]);\n-\tseq_printf(m, \"           \" FOURLONG,\n-\t\t\t  regs->gprs[12], regs->gprs[13],\n-\t\t\t  regs->gprs[14], regs->gprs[15]);\n-\tseq_printf(m, \"User ACRS: %08x %08x %08x %08x\\n\",\n-\t\t\t  task->thread.acrs[0], task->thread.acrs[1],\n-\t\t\t  task->thread.acrs[2], task->thread.acrs[3]);\n-\tseq_printf(m, \"           %08x %08x %08x %08x\\n\",\n-\t\t\t  task->thread.acrs[4], task->thread.acrs[5],\n-\t\t\t  task->thread.acrs[6], task->thread.acrs[7]);\n-\tseq_printf(m, \"           %08x %08x %08x %08x\\n\",\n-\t\t\t  task->thread.acrs[8], task->thread.acrs[9],\n-\t\t\t  task->thread.acrs[10], task->thread.acrs[11]);\n-\tseq_printf(m, \"           %08x %08x %08x %08x\\n\",\n-\t\t\t  task->thread.acrs[12], task->thread.acrs[13],\n-\t\t\t  task->thread.acrs[14], task->thread.acrs[15]);\n-}\n-\n static DEFINE_SPINLOCK(die_lock);\n \n void die(const char * str, struct pt_regs * regs, long err)\ndiff --git a\/fs\/proc\/array.c b\/fs\/proc\/array.c\nindex df2b703b9d0f..7c99c1cf7e5c 100644\n--- a\/fs\/proc\/array.c\n+++ b\/fs\/proc\/array.c\n@@ -353,9 +353,6 @@ int proc_pid_status(struct seq_file *m, struct pid_namespace *ns,\n \ttask_cap(m, task);\n \ttask_cpus_allowed(m, task);\n \tcpuset_task_status_allowed(m, task);\n-#if defined(CONFIG_S390)\n-\ttask_show_regs(m, task);\n-#endif\n \ttask_context_switch_counts(m, task);\n \treturn 0;\n }\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2013-1643","CWE_ID":"200","category":"security","commit_id":"8e76d0404b7f664ee6719fd98f0483f0ac4669d6","commit_message":"From 8e76d0404b7f664ee6719fd98f0483f0ac4669d6 Mon Sep 17 00:00:00 2001\nFrom: Dmitry Stogov <dmitry@zend.com>\nDate: Wed, 20 Feb 2013 22:14:59 +0400\nSubject: [PATCH] Fixed external entity loading\n\n---\n ext\/libxml\/libxml.c     | 33 +++++++++++++++------------------\n ext\/libxml\/php_libxml.h |  2 ++\n ext\/soap\/php_xml.c      | 11 +++++++++--\n 3 files changed, 26 insertions(+), 20 deletions(-)\n\n","diff_code":"diff --git a\/ext\/libxml\/libxml.c b\/ext\/libxml\/libxml.c\nindex 5db1f31..920a90c 100644\n--- a\/ext\/libxml\/libxml.c\n+++ b\/ext\/libxml\/libxml.c\n@@ -261,6 +261,7 @@ static PHP_GINIT_FUNCTION(libxml)\n \tlibxml_globals->stream_context = NULL;\n \tlibxml_globals->error_buffer.c = NULL;\n \tlibxml_globals->error_list = NULL;\n+\tlibxml_globals->entity_loader_disabled = 0;\n }\n \n \/* Channel libxml file io layer through the PHP streams subsystem.\n@@ -348,16 +349,15 @@ static int php_libxml_streams_IO_close(void *context)\n }\n \n static xmlParserInputBufferPtr\n-php_libxml_input_buffer_noload(const char *URI, xmlCharEncoding enc)\n-{\n-\treturn NULL;\n-}\n-\n-static xmlParserInputBufferPtr\n php_libxml_input_buffer_create_filename(const char *URI, xmlCharEncoding enc)\n {\n \txmlParserInputBufferPtr ret;\n \tvoid *context = NULL;\n+\tTSRMLS_FETCH();\n+\n+\tif (LIBXML(entity_loader_disabled)) {\n+\t\treturn NULL;\n+\t}\n \n \tif (URI == NULL)\n \t\treturn(NULL);\n@@ -834,28 +834,25 @@ static PHP_FUNCTION(libxml_clear_errors)\n }\n \/* }}} *\/\n \n+PHP_LIBXML_API zend_bool php_libxml_disable_entity_loader(zend_bool disable TSRMLS_DC)\n+{\n+\tzend_bool old = LIBXML(entity_loader_disabled);\n+\n+\tLIBXML(entity_loader_disabled) = disable;\n+\treturn old;\n+}\n+\n \/* {{{ proto bool libxml_disable_entity_loader([boolean disable]) \n    Disable\/Enable ability to load external entities *\/\n static PHP_FUNCTION(libxml_disable_entity_loader)\n {\n \tzend_bool disable = 1;\n-\txmlParserInputBufferCreateFilenameFunc old;\n \n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|b\", &disable) == FAILURE) {\n \t\treturn;\n \t}\n \n-\tif (disable == 0) {\n-\t\told = xmlParserInputBufferCreateFilenameDefault(php_libxml_input_buffer_create_filename);\n-\t} else {\n-\t\told = xmlParserInputBufferCreateFilenameDefault(php_libxml_input_buffer_noload);\n-\t}\n-\n-\tif (old == php_libxml_input_buffer_noload) {\n-\t\tRETURN_TRUE;\n-\t}\n-\n-\tRETURN_FALSE;\n+\tRETURN_BOOL(php_libxml_disable_entity_loader(disable TSRMLS_CC));\n }\n \/* }}} *\/\n \ndiff --git a\/ext\/libxml\/php_libxml.h b\/ext\/libxml\/php_libxml.h\nindex 91a6d24..a7d8466 100644\n--- a\/ext\/libxml\/php_libxml.h\n+++ b\/ext\/libxml\/php_libxml.h\n@@ -43,6 +43,7 @@ ZEND_BEGIN_MODULE_GLOBALS(libxml)\n \tzval *stream_context;\n \tsmart_str error_buffer;\n \tzend_llist *error_list;\n+\tzend_bool entity_loader_disabled;\n ZEND_END_MODULE_GLOBALS(libxml)\n \n typedef struct _libxml_doc_props {\n@@ -93,6 +94,7 @@ PHP_LIBXML_API void php_libxml_ctx_error(void *ctx, const char *msg, ...);\n PHP_LIBXML_API int php_libxml_xmlCheckUTF8(const unsigned char *s);\n PHP_LIBXML_API zval *php_libxml_switch_context(zval *context TSRMLS_DC);\n PHP_LIBXML_API void php_libxml_issue_error(int level, const char *msg TSRMLS_DC);\n+PHP_LIBXML_API zend_bool php_libxml_disable_entity_loader(zend_bool disable TSRMLS_DC);\n \n \/* Init\/shutdown functions*\/\n PHP_LIBXML_API void php_libxml_initialize(void);\ndiff --git a\/ext\/soap\/php_xml.c b\/ext\/soap\/php_xml.c\nindex 006db85..7823100 100644\n--- a\/ext\/soap\/php_xml.c\n+++ b\/ext\/soap\/php_xml.c\n@@ -20,6 +20,7 @@\n \/* $Id$ *\/\n \n #include \"php_soap.h\"\n+#include \"ext\/libxml\/php_libxml.h\"\n #include \"libxml\/parser.h\"\n #include \"libxml\/parserInternals.h\"\n \n@@ -91,14 +92,17 @@ xmlDocPtr soap_xmlParseFile(const char *filename TSRMLS_DC)\n \tctxt = xmlCreateFileParserCtxt(filename);\n \tPG(allow_url_fopen) = old_allow_url_fopen;\n \tif (ctxt) {\n+\t\tzend_bool old;\n+\n \t\tctxt->keepBlanks = 0;\n-\t\tctxt->options &= ~XML_PARSE_DTDLOAD;\n \t\tctxt->sax->ignorableWhitespace = soap_ignorableWhitespace;\n \t\tctxt->sax->comment = soap_Comment;\n \t\tctxt->sax->warning = NULL;\n \t\tctxt->sax->error = NULL;\n \t\t\/*ctxt->sax->fatalError = NULL;*\/\n+\t\told = php_libxml_disable_entity_loader(1);\n \t\txmlParseDocument(ctxt);\n+\t\tphp_libxml_disable_entity_loader(old);\n \t\tif (ctxt->wellFormed) {\n \t\t\tret = ctxt->myDoc;\n \t\t\tif (ret->URL == NULL && ctxt->directory != NULL) {\n@@ -134,7 +138,8 @@ xmlDocPtr soap_xmlParseMemory(const void *buf, size_t buf_size)\n *\/\n \tctxt = xmlCreateMemoryParserCtxt(buf, buf_size);\n \tif (ctxt) {\n-\t\tctxt->options &= ~XML_PARSE_DTDLOAD;\n+\t\tzend_bool old;\n+\n \t\tctxt->sax->ignorableWhitespace = soap_ignorableWhitespace;\n \t\tctxt->sax->comment = soap_Comment;\n \t\tctxt->sax->warning = NULL;\n@@ -143,7 +148,9 @@ xmlDocPtr soap_xmlParseMemory(const void *buf, size_t buf_size)\n #if LIBXML_VERSION >= 20703\n \t\tctxt->options |= XML_PARSE_HUGE;\n #endif\n+\t\told = php_libxml_disable_entity_loader(1);\n \t\txmlParseDocument(ctxt);\n+\t\tphp_libxml_disable_entity_loader(old);\n \t\tif (ctxt->wellFormed) {\n \t\t\tret = ctxt->myDoc;\n \t\t\tif (ret->URL == NULL && ctxt->directory != NULL) {\n-- \n2.1.4\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2019-10638","CWE_ID":"200","category":"security","commit_id":"355b98553789b646ed97ad801a619ff898471b92","commit_message":"From 355b98553789b646ed97ad801a619ff898471b92 Mon Sep 17 00:00:00 2001\nFrom: Eric Dumazet <edumazet@google.com>\nDate: Wed, 27 Mar 2019 08:21:30 -0700\nSubject: netns: provide pure entropy for net_hash_mix()\n\nnet_hash_mix() currently uses kernel address of a struct net,\nand is used in many places that could be used to reveal this\naddress to a patient attacker, thus defeating KASLR, for\nthe typical case (initial net namespace, &init_net is\nnot dynamically allocated)\n\nI believe the original implementation tried to avoid spending\ntoo many cycles in this function, but security comes first.\n\nAlso provide entropy regardless of CONFIG_NET_NS.\n\nFixes: 0b4419162aa6 (\"netns: introduce the net_hash_mix \"salt\" for hashes\")\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nReported-by: Amit Klein <aksecurity@gmail.com>\nReported-by: Benny Pinkas <benny@pinkas.net>\nCc: Pavel Emelyanov <xemul@openvz.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n include\/net\/net_namespace.h |  1 +\n include\/net\/netns\/hash.h    | 10 ++--------\n net\/core\/net_namespace.c    |  1 +\n 3 files changed, 4 insertions(+), 8 deletions(-)\n\n","diff_code":"diff --git a\/include\/net\/net_namespace.h b\/include\/net\/net_namespace.h\nindex a68ced28d8f4..12689ddfc24c 100644\n--- a\/include\/net\/net_namespace.h\n+++ b\/include\/net\/net_namespace.h\n@@ -59,6 +59,7 @@ struct net {\n \t\t\t\t\t\t *\/\n \tspinlock_t\t\trules_mod_lock;\n \n+\tu32\t\t\thash_mix;\n \tatomic64_t\t\tcookie_gen;\n \n \tstruct list_head\tlist;\t\t\/* list of network namespaces *\/\ndiff --git a\/include\/net\/netns\/hash.h b\/include\/net\/netns\/hash.h\nindex 16a842456189..d9b665151f3d 100644\n--- a\/include\/net\/netns\/hash.h\n+++ b\/include\/net\/netns\/hash.h\n@@ -2,16 +2,10 @@\n #ifndef __NET_NS_HASH_H__\n #define __NET_NS_HASH_H__\n \n-#include <asm\/cache.h>\n-\n-struct net;\n+#include <net\/net_namespace.h>\n \n static inline u32 net_hash_mix(const struct net *net)\n {\n-#ifdef CONFIG_NET_NS\n-\treturn (u32)(((unsigned long)net) >> ilog2(sizeof(*net)));\n-#else\n-\treturn 0;\n-#endif\n+\treturn net->hash_mix;\n }\n #endif\ndiff --git a\/net\/core\/net_namespace.c b\/net\/core\/net_namespace.c\nindex 17f36317363d..7e6dcc625701 100644\n--- a\/net\/core\/net_namespace.c\n+++ b\/net\/core\/net_namespace.c\n@@ -304,6 +304,7 @@ static __net_init int setup_net(struct net *net, struct user_namespace *user_ns)\n \n \trefcount_set(&net->count, 1);\n \trefcount_set(&net->passive, 1);\n+\tget_random_bytes(&net->hash_mix, sizeof(u32));\n \tnet->dev_base_seq = 1;\n \tnet->user_ns = user_ns;\n \tidr_init(&net->netns_ids);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2018-6790","CWE_ID":"200","category":"security","commit_id":"8164beac15ea34ec0d1564f0557fe3e742bdd938","commit_message":"From 8164beac15ea34ec0d1564f0557fe3e742bdd938 Mon Sep 17 00:00:00 2001\nFrom: Kai Uwe Broulik <kde@privat.broulik.de>\nDate: Mon, 5 Feb 2018 13:53:17 +0100\nSubject: [Notifications] Fix grouping\n\nSanitize the body before doing anything else.\nCleanup grouping logic.\n\nDifferential Revision: https:\/\/phabricator.kde.org\/D10315\n---\n dataengines\/notifications\/notificationsengine.cpp | 18 ++++++++----------\n 1 file changed, 8 insertions(+), 10 deletions(-)\n\n","diff_code":"diff --git a\/dataengines\/notifications\/notificationsengine.cpp b\/dataengines\/notifications\/notificationsengine.cpp\nindex 9fbd361..4c1854e 100644\n--- a\/dataengines\/notifications\/notificationsengine.cpp\n+++ b\/dataengines\/notifications\/notificationsengine.cpp\n@@ -202,18 +202,19 @@ uint NotificationsEngine::Notify(const QString &app_name, uint replaces_id,\n     qDebug() << \"Currrent active notifications:\" << m_activeNotifications;\n     qDebug() << \"Guessing partOf as:\" << partOf;\n     qDebug() << \" New Notification: \" << summary << body << timeout << \"& Part of:\" << partOf;\n-    QString _body;\n+    QString bodyFinal = NotificationSanitizer::parse(body);\n \n     if (partOf > 0) {\n         const QString source = QStringLiteral(\"notification %1\").arg(partOf);\n         Plasma::DataContainer *container = containerForSource(source);\n         if (container) {\n             \/\/ append the body text\n-            _body = container->data()[QStringLiteral(\"body\")].toString();\n-            if (_body != body) {\n-                _body.append(\"\\n\").append(body);\n-            } else {\n-                _body = body;\n+            const QString previousBody = container->data()[QStringLiteral(\"body\")].toString();\n+            if (previousBody != bodyFinal) {\n+                \/\/ FIXME: This will just append the entire old XML document to another one, leading to:\n+                \/\/ <?xml><html>old<\/html><br><?xml><html>new<\/html>\n+                \/\/ It works but is not very clean.\n+                bodyFinal = previousBody + QStringLiteral(\"<br\/>\") + bodyFinal;\n             }\n \n             replaces_id = partOf;\n@@ -246,7 +247,7 @@ uint NotificationsEngine::Notify(const QString &app_name, uint replaces_id,\n \n     const int AVERAGE_WORD_LENGTH = 6;\n     const int WORD_PER_MINUTE = 250;\n-    int count = summary.length() + body.length();\n+    int count = summary.length() + body.length() - strlen(\"<?xml version=\\\"1.0\\\"><html><\/html>\");\n \n     \/\/ -1 is \"server default\", 0 is persistent with \"server default\" display time,\n     \/\/ anything more should honor the setting\n@@ -261,9 +262,6 @@ uint NotificationsEngine::Notify(const QString &app_name, uint replaces_id,\n \n     const QString source = QStringLiteral(\"notification %1\").arg(id);\n \n-    QString bodyFinal = (partOf == 0 ? body : _body);\n-    bodyFinal = NotificationSanitizer::parse(bodyFinal);\n-\n     Plasma::DataEngine::Data notificationData;\n     notificationData.insert(QStringLiteral(\"id\"), QString::number(id));\n     notificationData.insert(QStringLiteral(\"eventId\"), eventId);\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2010-4081","CWE_ID":"200","category":"security","commit_id":"e68d3b316ab7b02a074edc4f770e6a746390cb7d","commit_message":"From e68d3b316ab7b02a074edc4f770e6a746390cb7d Mon Sep 17 00:00:00 2001\nFrom: Dan Rosenberg <drosenberg@vsecurity.com>\nDate: Sat, 25 Sep 2010 11:07:27 -0400\nSubject: ALSA: sound\/pci\/rme9652: prevent reading uninitialized stack memory\n\nThe SNDRV_HDSP_IOCTL_GET_CONFIG_INFO and\nSNDRV_HDSP_IOCTL_GET_CONFIG_INFO ioctls in hdspm.c and hdsp.c allow\nunprivileged users to read uninitialized kernel stack memory, because\nseveral fields of the hdsp{m}_config_info structs declared on the stack\nare not altered or zeroed before being copied back to the user.  This\npatch takes care of it.\n\nSigned-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>\nCc: <stable@kernel.org>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>\n---\n sound\/pci\/rme9652\/hdsp.c  | 1 +\n sound\/pci\/rme9652\/hdspm.c | 1 +\n 2 files changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/sound\/pci\/rme9652\/hdsp.c b\/sound\/pci\/rme9652\/hdsp.c\nindex b92adef8e81e..d6fa7bfd9aa1 100644\n--- a\/sound\/pci\/rme9652\/hdsp.c\n+++ b\/sound\/pci\/rme9652\/hdsp.c\n@@ -4609,6 +4609,7 @@ static int snd_hdsp_hwdep_ioctl(struct snd_hwdep *hw, struct file *file, unsigne\n \t\tif (err < 0)\n \t\t\treturn err;\n \n+\t\tmemset(&info, 0, sizeof(info));\n \t\tspin_lock_irqsave(&hdsp->lock, flags);\n \t\tinfo.pref_sync_ref = (unsigned char)hdsp_pref_sync_ref(hdsp);\n \t\tinfo.wordclock_sync_check = (unsigned char)hdsp_wc_sync_check(hdsp);\ndiff --git a\/sound\/pci\/rme9652\/hdspm.c b\/sound\/pci\/rme9652\/hdspm.c\nindex 547b713d7204..0c98ef9156d8 100644\n--- a\/sound\/pci\/rme9652\/hdspm.c\n+++ b\/sound\/pci\/rme9652\/hdspm.c\n@@ -4127,6 +4127,7 @@ static int snd_hdspm_hwdep_ioctl(struct snd_hwdep * hw, struct file *file,\n \n \tcase SNDRV_HDSPM_IOCTL_GET_CONFIG_INFO:\n \n+\t\tmemset(&info, 0, sizeof(info));\n \t\tspin_lock_irq(&hdspm->lock);\n \t\tinfo.pref_sync_ref = hdspm_pref_sync_ref(hdspm);\n \t\tinfo.wordclock_sync_check = hdspm_wc_sync_check(hdspm);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-19045","CWE_ID":"200","category":"security","commit_id":"c6247a9ef2c7b33244ab1d3aa5d629ec49f0a067","commit_message":"From c6247a9ef2c7b33244ab1d3aa5d629ec49f0a067 Mon Sep 17 00:00:00 2001\nFrom: Quentin Armitage <quentin@armitage.org.uk>\nDate: Wed, 31 Oct 2018 17:08:51 +0000\nSubject: [PATCH] Add command line and configuration option to set umask\n\nIssue #1048 identified that files created by keepalived are created\nwith mode 0666. This commit changes the default to 0644, and also\nallows the umask to be specified in the configuration or as a command\nline option.\n\nSigned-off-by: Quentin Armitage <quentin@armitage.org.uk>\n---\n doc\/keepalived.conf.SYNOPSIS     |  4 ++\n doc\/man\/man5\/keepalived.conf.5   |  6 +++\n doc\/man\/man8\/keepalived.8        |  4 ++\n keepalived\/core\/global_data.c    |  1 +\n keepalived\/core\/global_parser.c  | 73 ++++++++++++++++++++++++++++++++\n keepalived\/core\/main.c           | 44 +++++++++++++++++--\n keepalived\/include\/global_data.h |  1 +\n keepalived\/include\/main.h        |  1 +\n 8 files changed, 130 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/doc\/keepalived.conf.SYNOPSIS b\/doc\/keepalived.conf.SYNOPSIS\nindex a33ed4ec5..807adf0bc 100644\n--- a\/doc\/keepalived.conf.SYNOPSIS\n+++ b\/doc\/keepalived.conf.SYNOPSIS\n@@ -529,6 +529,10 @@ global_defs {                                 # Block identification\n     rs_init_notifies\t\t\t      # Send notifies at startup for real servers that are starting up\n     no_checker_emails                         # Don't send an email every time a real server checker changes state;\n                                               #   only send email when a real server is added or removed\n+    umask [NUMBER|BITS]                       # The umask to use for creating files. The number can be specified in hex, octal\n+                                              #   or decimal. BITS are I{R|W|X}{USR|GRP|OTH}, e.g. IRGRP, separated by '|'s.\n+                                              #   The default umask is IWGRP | IWOTH. This option cannot override the\n+                                              #   command-line option.\n }\n \n net_namespace NAME                            # Set the network namespace to run in\ndiff --git a\/doc\/man\/man5\/keepalived.conf.5 b\/doc\/man\/man5\/keepalived.conf.5\nindex 6ed6c396f..412a23f33 100644\n--- a\/doc\/man\/man5\/keepalived.conf.5\n+++ b\/doc\/man\/man5\/keepalived.conf.5\n@@ -499,6 +499,12 @@ and\n     # Don't send an email every time a real server checker changes state;\n     # only send email when a real server is added or removed\n     \\fBno_checker_emails\\fR\n+\n+    # The umask to use for creating files. The number can be specified in hex, octal\n+    #   or decimal. BITS are I{R|W|X}{USR|GRP|OTH}, e.g. IRGRP, separated by '|'s.\n+    #   The default umask is IWGRP | IWOTH. This option cannot override the\n+    #   command-line option.\n+    \\fBumask \\fR[NUMBER|BITS]\n }\n .fi\n .SH Static track groups\ndiff --git a\/doc\/man\/man8\/keepalived.8 b\/doc\/man\/man8\/keepalived.8\nindex e4941f907..12cd1325c 100644\n--- a\/doc\/man\/man8\/keepalived.8\n+++ b\/doc\/man\/man8\/keepalived.8\n@@ -34,6 +34,7 @@ keepalived \\- load\\-balancing and high\\-availability service\n [\\fB\\-i\\fP|\\fB\\-\\-config-id\\fP id]\n [\\fB\\-x\\fP|\\fB\\-\\-snmp\\fP]\n [\\fB\\-A\\fP|\\fB\\-\\-snmp-agent-socket\\fP=FILE]\n+[\\fB\\-u\\fP|\\fB\\-\\-umask\\fP=NUMBER]\n [\\fB\\-m\\fP|\\fB\\-\\-core\\-dump\\fP]\n [\\fB\\-M\\fP|\\fB\\-\\-core\\-dump\\-pattern\\fP[=PATTERN]]\n [\\fB\\-\\-signum\\fP=SIGFUNC]\n@@ -158,6 +159,9 @@ Enable the SNMP subsystem.\n \\fB -A, --snmp-agent-socket\\fP=FILE\n Use the specified socket for connection to SNMP master agent.\n .TP\n+\\fB -u, --umask\\fP=NUMBER\n+The umask specified in the usual numeric way - see man umask(2)\n+.TP\n \\fB -m, --core-dump\\fP\n Override the RLIMIT_CORE hard and soft limits to enable keepalived to\n produce a coredump in the event of a segfault or other failure.\ndiff --git a\/keepalived\/core\/global_data.c b\/keepalived\/core\/global_data.c\nindex b0365e7ae..6e872dcf8 100644\n--- a\/keepalived\/core\/global_data.c\n+++ b\/keepalived\/core\/global_data.c\n@@ -571,5 +571,6 @@ dump_global_data(FILE *fp, data_t * data)\n \tif (buf[0])\n \t\tconf_write(fp, \"%s\", buf);\n \tconf_write(fp, \" rx_bufs_multiples = %u\", global_data->vrrp_rx_bufs_multiples);\n+\tconf_write(fp, \" umask = 0%o\", global_data->umask);\n #endif\n }\ndiff --git a\/keepalived\/core\/global_parser.c b\/keepalived\/core\/global_parser.c\nindex cf91a93ac..0be016858 100644\n--- a\/keepalived\/core\/global_parser.c\n+++ b\/keepalived\/core\/global_parser.c\n@@ -35,6 +35,8 @@\n #include <sched.h>\n #endif\n #include <strings.h>\n+#include <sys\/types.h>\n+#include <sys\/stat.h>\n \n #ifdef _WITH_SNMP_\n #include \"snmp.h\"\n@@ -1341,6 +1343,76 @@ no_checker_emails_handler(vector_t *strvec)\n }\n #endif\n \n+static void\n+umask_handler(vector_t *strvec)\n+{\n+\tlong umask_long;\n+\tmode_t umask_val = 0;\n+\tchar *mask = strvec_slot(strvec, 1);\n+\tchar *endptr;\n+\tunsigned i;\n+\tchar *p;\n+\n+\tif (umask_cmdline) {\n+\t\tlog_message(LOG_INFO, \"umask command line option specified, ignoring config option\");\n+\t\treturn;\n+\t}\n+\n+\tif (isdigit(mask[0])) {\n+\t\tif (vector_size(strvec) != 2) {\n+\t\t\treport_config_error(CONFIG_GENERAL_ERROR, \"%s parameter(s) to umask option\", vector_size(strvec) == 1 ? \"Missing\" : \"Extra\");\n+\t\t\treturn;\n+\t\t}\n+\t\tumask_long = strtol(mask, &endptr, 0);\n+\t\tif (*endptr || umask_long < 0 || umask_long & ~0777L) {\n+\t\t\treport_config_error(CONFIG_GENERAL_ERROR, \"invalid umask value %s\", mask);\n+\t\t\treturn;\n+\t\t}\n+\t\tumask_val = umask_long & 0777;\n+\t}\n+\telse {\n+\t\tbool need_or = false;\n+\t\tfor (i = 1; i < vector_size(strvec); i++) {\n+\t\t\tfor (p = strvec_slot(strvec, i); *p; ) {\n+\t\t\t\tif (need_or) {\n+\t\t\t\t\tif (*p == '|') {\n+\t\t\t\t\t\tneed_or = false;\n+\t\t\t\t\t\tp++;\n+\t\t\t\t\t\tcontinue;\n+\t\t\t\t\t}\n+\n+\t\t\t\t\treport_config_error(CONFIG_GENERAL_ERROR, \"Invalid umask syntax %s\", FMT_STR_VSLOT(strvec, i));\n+\t\t\t\t\treturn;\n+\t\t\t\t}\n+\n+\t\t\t\tif      (!strncmp(p, \"IRUSR\", 5)) umask_val |= S_IRUSR;\n+\t\t\t\telse if (!strncmp(p, \"IWUSR\", 5)) umask_val |= S_IWUSR;\n+\t\t\t\telse if (!strncmp(p, \"IXUSR\", 5)) umask_val |= S_IXUSR;\n+\t\t\t\telse if (!strncmp(p, \"IRGRP\", 5)) umask_val |= S_IRGRP;\n+\t\t\t\telse if (!strncmp(p, \"IWGRP\", 5)) umask_val |= S_IWGRP;\n+\t\t\t\telse if (!strncmp(p, \"IXGRP\", 5)) umask_val |= S_IXGRP;\n+\t\t\t\telse if (!strncmp(p, \"IROTH\", 5)) umask_val |= S_IROTH;\n+\t\t\t\telse if (!strncmp(p, \"IWOTH\", 5)) umask_val |= S_IWOTH;\n+\t\t\t\telse if (!strncmp(p, \"IXOTH\", 5)) umask_val |= S_IXOTH;\n+\t\t\t\telse {\n+\t\t\t\t\treport_config_error(CONFIG_GENERAL_ERROR, \"Unknown umask bit %s\", p);\n+\t\t\t\t\treturn;\n+\t\t\t\t}\n+\n+\t\t\t\tp += 5;\n+\t\t\t\tneed_or = true;\n+\t\t\t}\n+\t\t}\n+\t\tif (!need_or) {\n+\t\t\treport_config_error(CONFIG_GENERAL_ERROR, \"umask missing bit value\");\n+\t\t\treturn;\n+\t\t}\n+\t}\n+\n+\tglobal_data->umask = umask_val;\n+\tumask(umask_val);\n+}\n+\n void\n init_global_keywords(bool global_active)\n {\n@@ -1483,4 +1555,5 @@ init_global_keywords(bool global_active)\n \tinstall_keyword(\"vrrp_rx_bufs_policy\", &vrrp_rx_bufs_policy_handler);\n \tinstall_keyword(\"vrrp_rx_bufs_multiplier\", &vrrp_rx_bufs_multiplier_handler);\n #endif\n+\tinstall_keyword(\"umask\", &umask_handler);\n }\ndiff --git a\/keepalived\/core\/main.c b\/keepalived\/core\/main.c\nindex 2d524f0a9..6670ada28 100644\n--- a\/keepalived\/core\/main.c\n+++ b\/keepalived\/core\/main.c\n@@ -33,6 +33,7 @@\n #include <signal.h>\n #include <fcntl.h>\n #include <sys\/wait.h>\n+#include <sys\/types.h>\n #include <sys\/stat.h>\n #include <unistd.h>\n #include <getopt.h>\n@@ -155,6 +156,10 @@ static struct {\n };\n #define\tLOG_FACILITY_MAX\t((sizeof(LOG_FACILITY) \/ sizeof(LOG_FACILITY[0])) - 1)\n \n+\/* umask settings *\/\n+bool umask_cmdline;\n+static mode_t umask_val = S_IXUSR | S_IWGRP | S_IXGRP | S_IWOTH | S_IXOTH;\n+\n \/* Control producing core dumps *\/\n static bool set_core_dump_pattern = false;\n static bool create_core_dump = false;\n@@ -866,6 +871,28 @@ core_dump_init(void)\n \t}\n }\n \n+static mode_t\n+set_umask(const char *optarg)\n+{\n+\tlong umask_long;\n+\tmode_t umask_val;\n+\tchar *endptr;\n+\n+\tumask_long = strtoll(optarg, &endptr, 0);\n+\n+\tif (*endptr || umask_long < 0 || umask_long & ~0777L) {\n+\t\tfprintf(stderr, \"Invalid --umask option %s\", optarg);\n+\t\treturn;\n+\t}\n+\n+\tumask_val = umask_long & 0777;\n+\tumask(umask_val);\n+\n+\tumask_cmdline = true;\n+\n+\treturn umask_val;\n+}\n+\n void\n initialise_debug_options(void)\n {\n@@ -1090,6 +1117,7 @@ usage(const char *prog)\n \tfprintf(stderr, \"  -g, --log-file=FILE          Also log to FILE (default \/tmp\/keepalived.log)\\n\");\n \tfprintf(stderr, \"      --flush-log-file         Flush log file on write\\n\");\n \tfprintf(stderr, \"  -G, --no-syslog              Don't log via syslog\\n\");\n+\tfprintf(stderr, \"  -u, --umask=MASK             umask for file creation (in numeric form)\\n\");\n #ifdef _WITH_VRRP_\n \tfprintf(stderr, \"  -X, --release-vips           Drop VIP on transition from signal.\\n\");\n \tfprintf(stderr, \"  -V, --dont-release-vrrp      Don't remove VRRP VIPs and VROUTEs on daemon stop\\n\");\n@@ -1183,6 +1211,7 @@ parse_cmdline(int argc, char **argv)\n \tint curind;\n \tbool bad_option = false;\n \tunsigned facility;\n+\tmode_t new_umask_val;\n \n \tstruct option long_options[] = {\n \t\t{\"use-file\",\t\trequired_argument,\tNULL, 'f'},\n@@ -1200,6 +1229,7 @@ parse_cmdline(int argc, char **argv)\n \t\t{\"log-file\",\t\toptional_argument,\tNULL, 'g'},\n \t\t{\"flush-log-file\",\tno_argument,\t\tNULL,  2 },\n \t\t{\"no-syslog\",\t\tno_argument,\t\tNULL, 'G'},\n+\t\t{\"umask\",\t\trequired_argument,\tNULL, 'u'},\n #ifdef _WITH_VRRP_\n \t\t{\"release-vips\",\tno_argument,\t\tNULL, 'X'},\n \t\t{\"dont-release-vrrp\",\tno_argument,\t\tNULL, 'V'},\n@@ -1252,7 +1282,7 @@ parse_cmdline(int argc, char **argv)\n \t * of longindex, so we need to ensure that before calling getopt_long(), longindex\n \t * is set to a known invalid value *\/\n \tcurind = optind;\n-\twhile (longindex = -1, (c = getopt_long(argc, argv, \":vhlndDRS:f:p:i:mM::g::Gt::\"\n+\twhile (longindex = -1, (c = getopt_long(argc, argv, \":vhlndu:DRS:f:p:i:mM::g::Gt::\"\n #if defined _WITH_VRRP_ && defined _WITH_LVS_\n \t\t\t\t\t    \"PC\"\n #endif\n@@ -1358,6 +1388,11 @@ parse_cmdline(int argc, char **argv)\n \t\t\t__set_bit(NO_SYSLOG_BIT, &debug);\n \t\t\treopen_log = true;\n \t\t\tbreak;\n+\t\tcase 'u':\n+\t\t\tnew_umask_val = set_umask(optarg);\n+\t\t\tif (umask_cmdline)\n+\t\t\t\tumask_val = new_umask_val;\n+\t\t\tbreak;\n \t\tcase 't':\n \t\t\t__set_bit(CONFIG_TEST_BIT, &debug);\n \t\t\t__set_bit(DONT_RESPAWN_BIT, &debug);\n@@ -1582,6 +1617,9 @@ keepalived_main(int argc, char **argv)\n \t__set_bit(DAEMON_BFD, &daemon_mode);\n #endif\n \n+\t\/* Set default file creation mask *\/\n+\tumask(022);\n+\n \t\/* Open log with default settings so we can log initially *\/\n \topenlog(PACKAGE_NAME, LOG_PID, log_facility);\n \n@@ -1678,6 +1716,7 @@ keepalived_main(int argc, char **argv)\n \t}\n \n \tglobal_data = alloc_global_data();\n+\tglobal_data->umask = umask_val;\n \n \tread_config_file();\n \n@@ -1809,9 +1848,6 @@ keepalived_main(int argc, char **argv)\n \t\texit(0);\n \t}\n \n-\t\/* Set file creation mask *\/\n-\tumask(0);\n-\n #ifdef _MEM_CHECK_\n \tenable_mem_log_termination();\n #endif\ndiff --git a\/keepalived\/include\/global_data.h b\/keepalived\/include\/global_data.h\nindex fe533bf45..fd8858161 100644\n--- a\/keepalived\/include\/global_data.h\n+++ b\/keepalived\/include\/global_data.h\n@@ -213,6 +213,7 @@ typedef struct _data {\n \tsize_t\t\t\t\tvrrp_rx_bufs_size;\n \tint\t\t\t\tvrrp_rx_bufs_multiples;\n #endif\n+\tmode_t\t\t\t\tumask;\t\t\t\/* mask for file creation *\/\n } data_t;\n \n \/* Global vars exported *\/\ndiff --git a\/keepalived\/include\/main.h b\/keepalived\/include\/main.h\nindex 35b2b0733..06255d296 100644\n--- a\/keepalived\/include\/main.h\n+++ b\/keepalived\/include\/main.h\n@@ -96,5 +96,6 @@ extern void initialise_debug_options(void);\n extern int keepalived_main(int, char**); \/* The \"real\" main function *\/\n \n extern unsigned child_wait_time;\n+extern bool umask_cmdline;\n \n #endif\n","owner":"acassen","repo":"keepalived","source":"cve"},{"CVE_ID":"CVE-2018-1281","CWE_ID":"200","category":"security","commit_id":"4be817e8b03e7e92517e91f2dfcc50865e91c6ea","commit_message":"From 4be817e8b03e7e92517e91f2dfcc50865e91c6ea Mon Sep 17 00:00:00 2001\nFrom: Madan Jampani <madan.jampani@gmail.com>\nDate: Tue, 21 Nov 2017 12:07:36 -0800\nSubject: [PATCH] Avoid listening on all interfaces by default\n\n---\n src\/zmq_van.h | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/src\/zmq_van.h b\/src\/zmq_van.h\nindex c54d650..f6a14cc 100644\n--- a\/src\/zmq_van.h\n+++ b\/src\/zmq_van.h\n@@ -63,7 +63,8 @@ class ZMQVan : public Van {\n     CHECK(receiver_ != NULL)\n         << \"create receiver socket failed: \" << zmq_strerror(errno);\n     int local = GetEnv(\"DMLC_LOCAL\", 0);\n-    std::string addr = local ? \"ipc:\/\/\/tmp\/\" : \"tcp:\/\/*:\";\n+    std::string hostname = node.hostname.empty() ? \"*\" : node.hostname;\n+    std::string addr = local ? \"ipc:\/\/\/tmp\/\" : \"tcp:\/\/\" + hostname + \":\";\n     int port = node.port;\n     unsigned seed = static_cast<unsigned>(time(NULL)+port);\n     for (int i = 0; i < max_retry+1; ++i) {\n","owner":"dmlc","repo":"ps-lite","source":"cve"},{"CVE_ID":"CVE-2012-4530","CWE_ID":"200","category":"security","commit_id":"b66c5984017533316fd1951770302649baf1aa33","commit_message":"From b66c5984017533316fd1951770302649baf1aa33 Mon Sep 17 00:00:00 2001\nFrom: Kees Cook <keescook@chromium.org>\nDate: Thu, 20 Dec 2012 15:05:16 -0800\nSubject: exec: do not leave bprm->interp on stack\n\nIf a series of scripts are executed, each triggering module loading via\nunprintable bytes in the script header, kernel stack contents can leak\ninto the command line.\n\nNormally execution of binfmt_script and binfmt_misc happens recursively.\nHowever, when modules are enabled, and unprintable bytes exist in the\nbprm->buf, execution will restart after attempting to load matching\nbinfmt modules.  Unfortunately, the logic in binfmt_script and\nbinfmt_misc does not expect to get restarted.  They leave bprm->interp\npointing to their local stack.  This means on restart bprm->interp is\nleft pointing into unused stack memory which can then be copied into the\nuserspace argv areas.\n\nAfter additional study, it seems that both recursion and restart remains\nthe desirable way to handle exec with scripts, misc, and modules.  As\nsuch, we need to protect the changes to interp.\n\nThis changes the logic to require allocation for any changes to the\nbprm->interp.  To avoid adding a new kmalloc to every exec, the default\nvalue is left as-is.  Only when passing through binfmt_script or\nbinfmt_misc does an allocation take place.\n\nFor a proof of concept, see DoTest.sh from:\n\n   http:\/\/www.halfdog.net\/Security\/2012\/LinuxKernelBinfmtScriptStackDataDisclosure\/\n\nSigned-off-by: Kees Cook <keescook@chromium.org>\nCc: halfdog <me@halfdog.net>\nCc: P J P <ppandit@redhat.com>\nCc: Alexander Viro <viro@zeniv.linux.org.uk>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n fs\/binfmt_misc.c        |  5 ++++-\n fs\/binfmt_script.c      |  4 +++-\n fs\/exec.c               | 15 +++++++++++++++\n include\/linux\/binfmts.h |  1 +\n 4 files changed, 23 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/fs\/binfmt_misc.c b\/fs\/binfmt_misc.c\nindex 9be335fb8a7c..0c8869fdd14e 100644\n--- a\/fs\/binfmt_misc.c\n+++ b\/fs\/binfmt_misc.c\n@@ -172,7 +172,10 @@ static int load_misc_binary(struct linux_binprm *bprm)\n \t\tgoto _error;\n \tbprm->argc ++;\n \n-\tbprm->interp = iname;\t\/* for binfmt_script *\/\n+\t\/* Update interp in case binfmt_script needs it. *\/\n+\tretval = bprm_change_interp(iname, bprm);\n+\tif (retval < 0)\n+\t\tgoto _error;\n \n \tinterp_file = open_exec (iname);\n \tretval = PTR_ERR (interp_file);\ndiff --git a\/fs\/binfmt_script.c b\/fs\/binfmt_script.c\nindex 1610a91637e5..5027a3e14922 100644\n--- a\/fs\/binfmt_script.c\n+++ b\/fs\/binfmt_script.c\n@@ -80,7 +80,9 @@ static int load_script(struct linux_binprm *bprm)\n \tretval = copy_strings_kernel(1, &i_name, bprm);\n \tif (retval) return retval; \n \tbprm->argc++;\n-\tbprm->interp = interp;\n+\tretval = bprm_change_interp(interp, bprm);\n+\tif (retval < 0)\n+\t\treturn retval;\n \n \t\/*\n \t * OK, now restart the process with the interpreter's dentry.\ndiff --git a\/fs\/exec.c b\/fs\/exec.c\nindex d8e1191cb112..237d5342786c 100644\n--- a\/fs\/exec.c\n+++ b\/fs\/exec.c\n@@ -1175,9 +1175,24 @@ void free_bprm(struct linux_binprm *bprm)\n \t\tmutex_unlock(&current->signal->cred_guard_mutex);\n \t\tabort_creds(bprm->cred);\n \t}\n+\t\/* If a binfmt changed the interp, free it. *\/\n+\tif (bprm->interp != bprm->filename)\n+\t\tkfree(bprm->interp);\n \tkfree(bprm);\n }\n \n+int bprm_change_interp(char *interp, struct linux_binprm *bprm)\n+{\n+\t\/* If a binfmt changed the interp, free it first. *\/\n+\tif (bprm->interp != bprm->filename)\n+\t\tkfree(bprm->interp);\n+\tbprm->interp = kstrdup(interp, GFP_KERNEL);\n+\tif (!bprm->interp)\n+\t\treturn -ENOMEM;\n+\treturn 0;\n+}\n+EXPORT_SYMBOL(bprm_change_interp);\n+\n \/*\n  * install the new credentials for this executable\n  *\/\ndiff --git a\/include\/linux\/binfmts.h b\/include\/linux\/binfmts.h\nindex a4c2b565c835..bdf3965f0a29 100644\n--- a\/include\/linux\/binfmts.h\n+++ b\/include\/linux\/binfmts.h\n@@ -112,6 +112,7 @@ extern int setup_arg_pages(struct linux_binprm * bprm,\n \t\t\t   unsigned long stack_top,\n \t\t\t   int executable_stack);\n extern int bprm_mm_init(struct linux_binprm *bprm);\n+extern int bprm_change_interp(char *interp, struct linux_binprm *bprm);\n extern int copy_strings_kernel(int argc, const char *const *argv,\n \t\t\t       struct linux_binprm *bprm);\n extern int prepare_bprm_creds(struct linux_binprm *bprm);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2018-0495","CWE_ID":"200","category":"security","commit_id":"9010d1576e278a4274ad3f4aa15776c28f6ba965","commit_message":"From 9010d1576e278a4274ad3f4aa15776c28f6ba965 Mon Sep 17 00:00:00 2001\nFrom: NIIBE Yutaka <gniibe@fsij.org>\nDate: Wed, 13 Jun 2018 15:28:58 +0900\nSubject: [PATCH] ecc: Add blinding for ECDSA.\n\n* cipher\/ecc-ecdsa.c (_gcry_ecc_ecdsa_sign): Blind secret D with\nrandomized nonce B.\n\n--\n\nReported-by: Keegan Ryan <Keegan.Ryan@nccgroup.trust>\nCVE-id: CVE-2018-0495\nSigned-off-by: NIIBE Yutaka <gniibe@fsij.org>\n---\n cipher\/ecc-ecdsa.c | 20 ++++++++++++++++++--\n 1 file changed, 18 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/cipher\/ecc-ecdsa.c b\/cipher\/ecc-ecdsa.c\nindex 1484830b..140e8c09 100644\n--- a\/cipher\/ecc-ecdsa.c\n+++ b\/cipher\/ecc-ecdsa.c\n@@ -50,6 +50,8 @@ _gcry_ecc_ecdsa_sign (gcry_mpi_t input, ECC_secret_key *skey,\n   const void *abuf;\n   unsigned int abits, qbits;\n   mpi_ec_t ctx;\n+  gcry_mpi_t b;                \/* Random number needed for blinding.  *\/\n+  gcry_mpi_t bi;               \/* multiplicative inverse of B.        *\/\n \n   if (DBG_CIPHER)\n     log_mpidump (\"ecdsa sign hash  \", input );\n@@ -61,6 +63,15 @@ _gcry_ecc_ecdsa_sign (gcry_mpi_t input, ECC_secret_key *skey,\n   if (rc)\n     return rc;\n \n+  b  = mpi_snew (qbits);\n+  bi = mpi_snew (qbits);\n+  do\n+    {\n+      _gcry_mpi_randomize (b, qbits, GCRY_WEAK_RANDOM);\n+      mpi_mod (b, b, skey->E.n);\n+    }\n+  while (!mpi_invm (bi, b, skey->E.n));\n+\n   k = NULL;\n   dr = mpi_alloc (0);\n   sum = mpi_alloc (0);\n@@ -115,8 +126,11 @@ _gcry_ecc_ecdsa_sign (gcry_mpi_t input, ECC_secret_key *skey,\n         }\n       while (!mpi_cmp_ui (r, 0));\n \n-      mpi_mulm (dr, skey->d, r, skey->E.n); \/* dr = d*r mod n  *\/\n-      mpi_addm (sum, hash, dr, skey->E.n);  \/* sum = hash + (d*r) mod n  *\/\n+      mpi_mulm (dr, b, skey->d, skey->E.n);\n+      mpi_mulm (dr, dr, r, skey->E.n);      \/* dr = d*r mod n (blinded with b) *\/\n+      mpi_mulm (sum, b, hash, skey->E.n);\n+      mpi_addm (sum, sum, dr, skey->E.n);   \/* sum = hash + (d*r) mod n  (blinded with b) *\/\n+      mpi_mulm (sum, bi, sum, skey->E.n);   \/* undo blinding by b^-1 *\/\n       mpi_invm (k_1, k, skey->E.n);         \/* k_1 = k^(-1) mod n  *\/\n       mpi_mulm (s, k_1, sum, skey->E.n);    \/* s = k^(-1)*(hash+(d*r)) mod n *\/\n     }\n@@ -129,6 +143,8 @@ _gcry_ecc_ecdsa_sign (gcry_mpi_t input, ECC_secret_key *skey,\n     }\n \n  leave:\n+  mpi_free (b);\n+  mpi_free (bi);\n   _gcry_mpi_ec_free (ctx);\n   point_free (&I);\n   mpi_free (x);\n-- \n2.11.0\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-16658","CWE_ID":"200","category":"security","commit_id":"8f3fafc9c2f0ece10832c25f7ffcb07c97a32ad4","commit_message":"From 8f3fafc9c2f0ece10832c25f7ffcb07c97a32ad4 Mon Sep 17 00:00:00 2001\nFrom: Scott Bauer <scott.bauer@intel.com>\nDate: Thu, 26 Apr 2018 11:51:08 -0600\nSubject: cdrom: Fix info leak\/OOB read in cdrom_ioctl_drive_status\n\nLike d88b6d04: \"cdrom: information leak in cdrom_ioctl_media_changed()\"\n\nThere is another cast from unsigned long to int which causes\na bounds check to fail with specially crafted input. The value is\nthen used as an index in the slot array in cdrom_slot_status().\n\nSigned-off-by: Scott Bauer <scott.bauer@intel.com>\nSigned-off-by: Scott Bauer <sbauer@plzdonthack.me>\nCc: stable@vger.kernel.org\nSigned-off-by: Jens Axboe <axboe@kernel.dk>\n---\n drivers\/cdrom\/cdrom.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/drivers\/cdrom\/cdrom.c b\/drivers\/cdrom\/cdrom.c\nindex 113fc6edb2b0..a5d5a96479bf 100644\n--- a\/drivers\/cdrom\/cdrom.c\n+++ b\/drivers\/cdrom\/cdrom.c\n@@ -2546,7 +2546,7 @@ static int cdrom_ioctl_drive_status(struct cdrom_device_info *cdi,\n \tif (!CDROM_CAN(CDC_SELECT_DISC) ||\n \t    (arg == CDSL_CURRENT || arg == CDSL_NONE))\n \t\treturn cdi->ops->drive_status(cdi, CDSL_CURRENT);\n-\tif (((int)arg >= cdi->capacity))\n+\tif (arg >= cdi->capacity)\n \t\treturn -EINVAL;\n \treturn cdrom_slot_status(cdi, arg);\n }\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-3197","CWE_ID":"200","category":"security","commit_id":"d81a1600588b726c2bdccda7efad3cc7a87d6245","commit_message":"From d81a1600588b726c2bdccda7efad3cc7a87d6245 Mon Sep 17 00:00:00 2001\nFrom: Viktor Dukhovni <openssl-users@dukhovni.org>\nDate: Wed, 30 Dec 2015 22:44:51 -0500\nSubject: [PATCH] Better SSLv2 cipher-suite enforcement\n\nBased on patch by: Nimrod Aviram <nimrod.aviram@gmail.com>\n\nCVE-2015-3197\n\nReviewed-by: Tim Hudson <tjh@openssl.org>\nReviewed-by: Richard Levitte <levitte@openssl.org>\n---\n ssl\/s2_srvr.c | 15 +++++++++++++--\n 1 file changed, 13 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/ssl\/s2_srvr.c b\/ssl\/s2_srvr.c\nindex 5e2e0acc35..07e9df8282 100644\n--- a\/ssl\/s2_srvr.c\n+++ b\/ssl\/s2_srvr.c\n@@ -402,7 +402,7 @@ static int get_client_master_key(SSL *s)\n         }\n \n         cp = ssl2_get_cipher_by_char(p);\n-        if (cp == NULL) {\n+        if (cp == NULL || sk_SSL_CIPHER_find(s->session->ciphers, cp) < 0) {\n             ssl2_return_error(s, SSL2_PE_NO_CIPHER);\n             SSLerr(SSL_F_GET_CLIENT_MASTER_KEY, SSL_R_NO_CIPHER_MATCH);\n             return (-1);\n@@ -692,8 +692,12 @@ static int get_client_hello(SSL *s)\n             prio = cs;\n             allow = cl;\n         }\n+\n+        \/* Generate list of SSLv2 ciphers shared between client and server *\/\n         for (z = 0; z < sk_SSL_CIPHER_num(prio); z++) {\n-            if (sk_SSL_CIPHER_find(allow, sk_SSL_CIPHER_value(prio, z)) < 0) {\n+            const SSL_CIPHER *cp = sk_SSL_CIPHER_value(prio, z);\n+            if ((cp->algorithm_ssl & SSL_SSLV2) == 0 ||\n+                sk_SSL_CIPHER_find(allow, cp) < 0) {\n                 (void)sk_SSL_CIPHER_delete(prio, z);\n                 z--;\n             }\n@@ -702,6 +706,13 @@ static int get_client_hello(SSL *s)\n             sk_SSL_CIPHER_free(s->session->ciphers);\n             s->session->ciphers = prio;\n         }\n+\n+        \/* Make sure we have at least one cipher in common *\/\n+        if (sk_SSL_CIPHER_num(s->session->ciphers) == 0) {\n+            ssl2_return_error(s, SSL2_PE_NO_CIPHER);\n+            SSLerr(SSL_F_GET_CLIENT_HELLO, SSL_R_NO_CIPHER_MATCH);\n+            return -1;\n+        }\n         \/*\n          * s->session->ciphers should now have a list of ciphers that are on\n          * both the client and server. This list is ordered by the order the\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2019-1559","CWE_ID":"200","category":"security","commit_id":"e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e","commit_message":"From e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e Mon Sep 17 00:00:00 2001\nFrom: Matt Caswell <matt@openssl.org>\nDate: Fri, 14 Dec 2018 07:28:30 +0000\nSubject: [PATCH] Go into the error state if a fatal alert is sent or received\n\nIf an application calls SSL_shutdown after a fatal alert has occured and\nthen behaves different based on error codes from that function then the\napplication may be vulnerable to a padding oracle.\n\nCVE-2019-1559\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\n---\n ssl\/d1_pkt.c |  1 +\n ssl\/s3_pkt.c | 10 +++++++---\n 2 files changed, 8 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/ssl\/d1_pkt.c b\/ssl\/d1_pkt.c\nindex 23aa9dbce4..c7fe97727b 100644\n--- a\/ssl\/d1_pkt.c\n+++ b\/ssl\/d1_pkt.c\n@@ -1309,6 +1309,7 @@ int dtls1_read_bytes(SSL *s, int type, unsigned char *buf, int len, int peek)\n             ERR_add_error_data(2, \"SSL alert number \", tmp);\n             s->shutdown |= SSL_RECEIVED_SHUTDOWN;\n             SSL_CTX_remove_session(s->session_ctx, s->session);\n+            s->state = SSL_ST_ERR;\n             return (0);\n         } else {\n             al = SSL_AD_ILLEGAL_PARAMETER;\ndiff --git a\/ssl\/s3_pkt.c b\/ssl\/s3_pkt.c\nindex 6527df8ce2..830b7237a2 100644\n--- a\/ssl\/s3_pkt.c\n+++ b\/ssl\/s3_pkt.c\n@@ -1500,6 +1500,7 @@ int ssl3_read_bytes(SSL *s, int type, unsigned char *buf, int len, int peek)\n             ERR_add_error_data(2, \"SSL alert number \", tmp);\n             s->shutdown |= SSL_RECEIVED_SHUTDOWN;\n             SSL_CTX_remove_session(s->session_ctx, s->session);\n+            s->state = SSL_ST_ERR;\n             return (0);\n         } else {\n             al = SSL_AD_ILLEGAL_PARAMETER;\n@@ -1719,9 +1720,12 @@ int ssl3_send_alert(SSL *s, int level, int desc)\n                                           * protocol_version alerts *\/\n     if (desc < 0)\n         return -1;\n-    \/* If a fatal one, remove from cache *\/\n-    if ((level == 2) && (s->session != NULL))\n-        SSL_CTX_remove_session(s->session_ctx, s->session);\n+    \/* If a fatal one, remove from cache and go into the error state *\/\n+    if (level == SSL3_AL_FATAL) {\n+        if (s->session != NULL)\n+            SSL_CTX_remove_session(s->session_ctx, s->session);\n+        s->state = SSL_ST_ERR;\n+    }\n \n     s->s3->alert_dispatch = 1;\n     s->s3->send_alert[0] = level;\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-6790","CWE_ID":"200","category":"security","commit_id":"5bc696b5abcdb460c1017592e80b2d7f6ed3107c","commit_message":"From 5bc696b5abcdb460c1017592e80b2d7f6ed3107c Mon Sep 17 00:00:00 2001\nFrom: David Edmundson <kde@davidedmundson.co.uk>\nDate: Wed, 31 Jan 2018 14:28:17 +0000\nSubject: Sanitise notification HTML\n\nSummary:\nQt labels support a HTML subset, using a completely internal parser in\nQTextDocument.\n\nThe Notification spec support an even smaller subset of notification\nelements.\n\nIt's important to strip out irrelevant tags that could potentially load\nremote information without user interaction, such as img\nsrc or even <b style=\"background:url...\n\nBut we want to maintain the basic rich text formatting of bold and\nitalics and links.\n\nThis parser iterates reads the XML, copying only permissable tags and\nattributes.\n\nA future obvious improvement would be to merge the original regular\nexpressions into this stream parser, but I'm trying to minimise\nbreakages to get this into 5.12.\n\nTest Plan:\nMoved code into it's own class for easy unit testing\nTried a bunch of things, including what the old regexes were doing\n\nAlso ran notify send with a few options to make sure things worked\n\nReviewers: #plasma, fvogt\n\nReviewed By: fvogt\n\nSubscribers: aacid, fvogt, plasma-devel\n\nTags: #plasma\n\nDifferential Revision: https:\/\/phabricator.kde.org\/D10188\n---\n dataengines\/notifications\/CMakeLists.txt           |   8 ++\n dataengines\/notifications\/notifications_test.cpp   |  68 +++++++++++++\n ...\/notifications\/notificationsanitizer.cpp        | 106 +++++++++++++++++++++\n dataengines\/notifications\/notificationsanitizer.h  |  35 +++++++\n dataengines\/notifications\/notificationsengine.cpp  |  19 +---\n 5 files changed, 219 insertions(+), 17 deletions(-)\n create mode 100644 dataengines\/notifications\/notifications_test.cpp\n create mode 100644 dataengines\/notifications\/notificationsanitizer.cpp\n create mode 100644 dataengines\/notifications\/notificationsanitizer.h\n\n","diff_code":"diff --git a\/dataengines\/notifications\/CMakeLists.txt b\/dataengines\/notifications\/CMakeLists.txt\nindex 4fd3ee7..ad6e212 100644\n--- a\/dataengines\/notifications\/CMakeLists.txt\n+++ b\/dataengines\/notifications\/CMakeLists.txt\n@@ -4,6 +4,7 @@ set(notifications_engine_SRCS\n     notificationsengine.cpp\n     notificationservice.cpp\n     notificationaction.cpp\n+    notificationsanitizer.cpp\n )\n \n qt5_add_dbus_adaptor( notifications_engine_SRCS org.freedesktop.Notifications.xml notificationsengine.h  NotificationsEngine )\n@@ -26,3 +27,10 @@ kcoreaddons_desktop_to_json(plasma_engine_notifications plasma-dataengine-notifi\n install(TARGETS plasma_engine_notifications DESTINATION ${KDE_INSTALL_PLUGINDIR}\/plasma\/dataengine)\n install(FILES plasma-dataengine-notifications.desktop DESTINATION ${KDE_INSTALL_KSERVICES5DIR} )\n install(FILES notifications.operations DESTINATION ${PLASMA_DATA_INSTALL_DIR}\/services)\n+\n+\n+#unit test\n+\n+add_executable(notification_test  notificationsanitizer.cpp notifications_test.cpp)\n+target_link_libraries(notification_test Qt5::Test Qt5::Core)\n+ecm_mark_as_test(notification_test)\ndiff --git a\/dataengines\/notifications\/notifications_test.cpp b\/dataengines\/notifications\/notifications_test.cpp\nnew file mode 100644\nindex 0000000..5839974\n--- \/dev\/null\n+++ b\/dataengines\/notifications\/notifications_test.cpp\n@@ -0,0 +1,68 @@\n+#include <QtTest>\n+#include <QObject>\n+#include <QDebug>\n+#include \"notificationsanitizer.h\"\n+\n+class NotificationTest : public QObject\n+{\n+    Q_OBJECT\n+public:\n+    NotificationTest() {}\n+private Q_SLOTS:\n+    void parse_data();\n+    void parse();\n+};\n+\n+void NotificationTest::parse_data()\n+{\n+    QTest::addColumn<QString>(\"messageIn\");\n+    QTest::addColumn<QString>(\"expectedOut\");\n+\n+    QTest::newRow(\"basic no HTML\") << \"I am a notification\" << \"I am a notification\";\n+    QTest::newRow(\"whitespace\") << \"      I am a   notification  \" << \"I am a notification\";\n+\n+    QTest::newRow(\"basic html\") << \"I am <b>the<\/b> notification\" << \"I am <b>the<\/b> notification\";\n+    QTest::newRow(\"nested html\") << \"I am <i><b>the<\/b><\/i> notification\" << \"I am <i><b>the<\/b><\/i> notification\";\n+\n+    QTest::newRow(\"no extra tags\") << \"I am <blink>the<\/blink> notification\" << \"I am the notification\";\n+    QTest::newRow(\"no extra attrs\") << \"I am <b style=\\\"font-weight:20\\\">the<\/b> notification\" << \"I am <b>the<\/b> notification\";\n+\n+    QTest::newRow(\"newlines\") << \"I am\\nthe\\nnotification\" << \"I am<br\/>the<br\/>notification\";\n+    QTest::newRow(\"multinewlines\") << \"I am\\n\\nthe\\n\\n\\nnotification\" << \"I am<br\/>the<br\/>notification\";\n+\n+    QTest::newRow(\"amp\") << \"me&you\" << \"me&amp;you\";\n+    QTest::newRow(\"double escape\") << \"foo &amp; &lt;bar&gt;\" << \"foo &amp; &lt;bar&gt;\";\n+\n+    QTest::newRow(\"quotes\") << \"&apos;foo&apos;\" << \"'foo'\";\/\/as label can't handle this normally valid entity\n+\n+    QTest::newRow(\"image normal\") << \"This is <img src=\\\"file::\/\/foo\/boo.png\\\" alt=\\\"cheese\\\"\/> and more text\" << \"This is <img src=\\\"file::\/\/foo\/boo.png\\\" alt=\\\"cheese\\\"\/> and more text\";\n+\n+    \/\/this input is technically wrong, so the output is also wrong, but QTextHtmlParser does the \"right\" thing\n+    QTest::newRow(\"image normal no close\") << \"This is <img src=\\\"file::\/\/foo\/boo.png\\\" alt=\\\"cheese\\\"> and more text\" << \"This is <img src=\\\"file::\/\/foo\/boo.png\\\" alt=\\\"cheese\\\"> and more text<\/img>\";\n+\n+    QTest::newRow(\"image remote URL\") << \"This is <img src=\\\"http:\/\/foo.com\/boo.png\\\" alt=\\\"cheese\\\" \/> and more text\" << \"This is <img alt=\\\"cheese\\\"\/> and more text\";\n+\n+    \/\/more bad formatted options. To some extent actual output doesn't matter. Garbage in, garbabe out.\n+    \/\/the important thing is that it doesn't contain anything that could be parsed as the remote URL\n+    QTest::newRow(\"image remote URL no close\") << \"This is <img src=\\\"http:\/\/foo.com\/boo.png>\\\" alt=\\\"cheese\\\">  and more text\" << \"This is <img alt=\\\"cheese\\\"> and more text<\/img>\";\n+    QTest::newRow(\"image remote URL double open\") << \"This is <<img src=\\\"http:\/\/foo.com\/boo.png>\\\"  and more text\" << \"This is \";\n+    QTest::newRow(\"image remote URL no entitiy close\") << \"This is <img src=\\\"http:\/\/foo.com\/boo.png\\\"  and more text\" << \"This is \";\n+    QTest::newRow(\"image remote URL space in element name\") << \"This is < img src=\\\"http:\/\/foo.com\/boo.png\\\" alt=\\\"cheese\\\" \/> and more text\" << \"This is \";\n+\n+    QTest::newRow(\"link\") << \"This is a link <a href=\\\"http:\/\/foo.com\/boo\\\"\/> and more text\" << \"This is a link <a href=\\\"http:\/\/foo.com\/boo\\\"\/> and more text\";\n+}\n+\n+void NotificationTest::parse()\n+{\n+    QFETCH(QString, messageIn);\n+    QFETCH(QString, expectedOut);\n+\n+    const QString out = NotificationSanitizer::parse(messageIn);\n+    expectedOut = \"<?xml version=\\\"1.0\\\"?><html>\"  + expectedOut + \"<\/html>\\n\";\n+    QCOMPARE(out, expectedOut);\n+}\n+\n+\n+QTEST_GUILESS_MAIN(NotificationTest)\n+\n+#include \"notifications_test.moc\"\ndiff --git a\/dataengines\/notifications\/notificationsanitizer.cpp b\/dataengines\/notifications\/notificationsanitizer.cpp\nnew file mode 100644\nindex 0000000..5410132\n--- \/dev\/null\n+++ b\/dataengines\/notifications\/notificationsanitizer.cpp\n@@ -0,0 +1,106 @@\n+\/*\n+ *   Copyright (C) 2017 David Edmundson <davidedmundson@kde.org>\n+ *\n+ * This program is free software you can redistribute it and\/or\n+ * modify it under the terms of the GNU Library General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 2 of the License, or (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Library General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Library General Public License\n+ * along with this library; see the file COPYING.LIB.  If not, write to\n+ * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,\n+ * Boston, MA 02110-1301, USA.\n+*\/\n+\n+#include \"notificationsanitizer.h\"\n+\n+#include <QXmlStreamReader>\n+#include <QXmlStreamWriter>\n+#include <QRegularExpression>\n+#include <QDebug>\n+#include <QUrl>\n+\n+QString NotificationSanitizer::parse(const QString &text)\n+{\n+    \/\/ replace all \\ns with <br\/>\n+    QString t = text;\n+\n+    t.replace(QLatin1String(\"\\n\"), QStringLiteral(\"<br\/>\"));\n+    \/\/ Now remove all inner whitespace (\\ns are already <br\/>s)\n+    t = t.simplified();\n+    \/\/ Finally, check if we don't have multiple <br\/>s following,\n+    \/\/ can happen for example when \"\\n       \\n\" is sent, this replaces\n+    \/\/ all <br\/>s in succsession with just one\n+    t.replace(QRegularExpression(QStringLiteral(\"<br\/>\\\\s*<br\/>(\\\\s|<br\/>)*\")), QLatin1String(\"<br\/>\"));\n+    \/\/ This fancy RegExp escapes every occurence of & since QtQuick Text will blatantly cut off\n+    \/\/ text where it finds a stray ampersand.\n+    \/\/ Only &{apos, quot, gt, lt, amp}; as well as &#123 character references will be allowed\n+    t.replace(QRegularExpression(QStringLiteral(\"&(?!(?:apos|quot|[gl]t|amp);|#)\")), QLatin1String(\"&amp;\"));\n+\n+    QXmlStreamReader r(QStringLiteral(\"<html>\") + t + QStringLiteral(\"<\/html>\"));\n+    QString result;\n+    QXmlStreamWriter out(&result);\n+\n+    const QVector<QString> allowedTags = {\"b\", \"i\", \"u\", \"img\", \"a\", \"html\", \"br\"};\n+\n+    out.writeStartDocument();\n+    while (!r.atEnd()) {\n+        r.readNext();\n+\n+        if (r.tokenType() == QXmlStreamReader::StartElement) {\n+            const QString name = r.name().toString();\n+            if (!allowedTags.contains(name)) {\n+                continue;\n+            }\n+            out.writeStartElement(name);\n+            if (name == QLatin1String(\"img\")) {\n+                auto src = r.attributes().value(\"src\").toString();\n+                auto alt = r.attributes().value(\"alt\").toString();\n+\n+                const QUrl url(src);\n+                if (url.isLocalFile()) {\n+                    out.writeAttribute(QStringLiteral(\"src\"), src);\n+                } else {\n+                    \/\/image denied for security reasons! Do not copy the image src here!\n+                }\n+\n+                out.writeAttribute(QStringLiteral(\"alt\"), alt);\n+            }\n+            if (name == QLatin1String(\"a\")) {\n+                out.writeAttribute(QStringLiteral(\"href\"), r.attributes().value(\"href\").toString());\n+            }\n+        }\n+\n+        if (r.tokenType() == QXmlStreamReader::EndElement) {\n+            const QString name = r.name().toString();\n+            if (!allowedTags.contains(name)) {\n+                continue;\n+            }\n+            out.writeEndElement();\n+        }\n+\n+        if (r.tokenType() == QXmlStreamReader::Characters) {\n+            const auto text = r.text().toString();\n+            out.writeCharacters(text); \/\/this auto escapes chars -> HTML entities\n+        }\n+    }\n+    out.writeEndDocument();\n+\n+    if (r.hasError()) {\n+        qWarning() << \"Notification to send to backend contains invalid XML: \"\n+                      << r.errorString() << \"line\" << r.lineNumber()\n+                      << \"col\" << r.columnNumber();\n+    }\n+\n+    \/\/ The Text.StyledText format handles only html3.2 stuff and &apos; is html4 stuff\n+    \/\/ so we need to replace it here otherwise it will not render at all.\n+    result = result.replace(QLatin1String(\"&apos;\"), QChar('\\''));\n+\n+\n+    return result;\n+}\ndiff --git a\/dataengines\/notifications\/notificationsanitizer.h b\/dataengines\/notifications\/notificationsanitizer.h\nnew file mode 100644\nindex 0000000..561a84b\n--- \/dev\/null\n+++ b\/dataengines\/notifications\/notificationsanitizer.h\n@@ -0,0 +1,35 @@\n+\/*\n+ *   Copyright (C) 2017 David Edmundson <davidedmundson@kde.org>\n+ *\n+ * This program is free software you can redistribute it and\/or\n+ * modify it under the terms of the GNU Library General Public\n+ * License as published by the Free Software Foundation; either\n+ * version 2 of the License, or (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Library General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Library General Public License\n+ * along with this library; see the file COPYING.LIB.  If not, write to\n+ * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,\n+ * Boston, MA 02110-1301, USA.\n+*\/\n+\n+#include <QString>\n+\n+namespace NotificationSanitizer\n+{\n+    \/*\n+     * This turns generic random text of either plain text of any degree of faux-HTML into HTML allowed\n+     * in the notification spec namely:\n+     * a, img, b, i, u  and br\n+     * All other tags and attributes are stripped\n+     * Whitespace is stripped and converted to <br\/>\n+     * Double newlines are compressed\n+     *\n+     * Image src is only copied when referring to a local file\n+     *\/\n+    QString parse(const QString &in);\n+}\ndiff --git a\/dataengines\/notifications\/notificationsengine.cpp b\/dataengines\/notifications\/notificationsengine.cpp\nindex 2bc4dc2..9fbd361 100644\n--- a\/dataengines\/notifications\/notificationsengine.cpp\n+++ b\/dataengines\/notifications\/notificationsengine.cpp\n@@ -20,6 +20,7 @@\n #include \"notificationsengine.h\"\n #include \"notificationservice.h\"\n #include \"notificationsadaptor.h\"\n+#include \"notificationsanitizer.h\"\n \n #include <QDebug>\n #include <KConfigGroup>\n@@ -261,23 +262,7 @@ uint NotificationsEngine::Notify(const QString &app_name, uint replaces_id,\n     const QString source = QStringLiteral(\"notification %1\").arg(id);\n \n     QString bodyFinal = (partOf == 0 ? body : _body);\n-    \/\/ First trim whitespace from beginning and end\n-    bodyFinal = bodyFinal.trimmed();\n-    \/\/ Now replace all \\ns with <br\/>\n-    bodyFinal = bodyFinal.replace(QLatin1String(\"\\n\"), QLatin1String(\"<br\/>\"));\n-    \/\/ Now remove all inner whitespace (\\ns are already <br\/>s\n-    bodyFinal = bodyFinal.simplified();\n-    \/\/ Finally, check if we don't have multiple <br\/>s following,\n-    \/\/ can happen for example when \"\\n       \\n\" is sent, this replaces\n-    \/\/ all <br\/>s in succsession with just one\n-    bodyFinal.replace(QRegularExpression(QStringLiteral(\"<br\/>\\\\s*<br\/>(\\\\s|<br\/>)*\")), QLatin1String(\"<br\/>\"));\n-    \/\/ This fancy RegExp escapes every occurence of & since QtQuick Text will blatantly cut off\n-    \/\/ text where it finds a stray ampersand.\n-    \/\/ Only &{apos, quot, gt, lt, amp}; as well as &#123 character references will be allowed\n-    bodyFinal.replace(QRegularExpression(QStringLiteral(\"&(?!(?:apos|quot|[gl]t|amp);|#)\")), QLatin1String(\"&amp;\"));\n-    \/\/ The Text.StyledText format handles only html3.2 stuff and &apos; is html4 stuff\n-    \/\/ so we need to replace it here otherwise it will not render at all.\n-    bodyFinal.replace(QLatin1String(\"&apos;\"), QChar('\\''));\n+    bodyFinal = NotificationSanitizer::parse(bodyFinal);\n \n     Plasma::DataEngine::Data notificationData;\n     notificationData.insert(QStringLiteral(\"id\"), QString::number(id));\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2013-4516","CWE_ID":"200","category":"security","commit_id":"a8b33654b1e3b0c74d4a1fed041c9aae50b3c427","commit_message":"From a8b33654b1e3b0c74d4a1fed041c9aae50b3c427 Mon Sep 17 00:00:00 2001\nFrom: Dan Carpenter <dan.carpenter@oracle.com>\nDate: Tue, 29 Oct 2013 23:01:43 +0300\nSubject: [PATCH] Staging: sb105x: info leak in mp_get_count()\n\nThe icount.reserved[] array isn't initialized so it leaks stack\ninformation to userspace.\n\nReported-by: Nico Golde <nico@ngolde.de>\nReported-by: Fabian Yamaguchi <fabs@goesec.de>\nSigned-off-by: Dan Carpenter <dan.carpenter@oracle.com>\nCc: stable@kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n drivers\/staging\/sb105x\/sb_pci_mp.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/drivers\/staging\/sb105x\/sb_pci_mp.c b\/drivers\/staging\/sb105x\/sb_pci_mp.c\nindex 23db32f07fd53..a10cdb17038bf 100644\n--- a\/drivers\/staging\/sb105x\/sb_pci_mp.c\n+++ b\/drivers\/staging\/sb105x\/sb_pci_mp.c\n@@ -1063,7 +1063,7 @@ static int mp_wait_modem_status(struct sb_uart_state *state, unsigned long arg)\n \n static int mp_get_count(struct sb_uart_state *state, struct serial_icounter_struct *icnt)\n {\n-\tstruct serial_icounter_struct icount;\n+\tstruct serial_icounter_struct icount = {};\n \tstruct sb_uart_icount cnow;\n \tstruct sb_uart_port *port = state->port;\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2019-12107","CWE_ID":"200","category":"security","commit_id":"bec6ccec63cadc95655721bc0e1dd49dac759d94","commit_message":"From bec6ccec63cadc95655721bc0e1dd49dac759d94 Mon Sep 17 00:00:00 2001\nFrom: Thomas Bernard <miniupnp@free.fr>\nDate: Tue, 18 Dec 2018 22:37:14 +0100\nSubject: [PATCH] upnp_event_prepare(): check the return value of snprintf()\n\n---\n miniupnpd\/upnpevents.c | 37 ++++++++++++++++++++++++++-----------\n 1 file changed, 26 insertions(+), 11 deletions(-)\n\n","diff_code":"diff --git a\/miniupnpd\/upnpevents.c b\/miniupnpd\/upnpevents.c\nindex d96bccbe..3bc402f3 100644\n--- a\/miniupnpd\/upnpevents.c\n+++ b\/miniupnpd\/upnpevents.c\n@@ -443,19 +443,34 @@ static void upnp_event_prepare(struct upnp_event_notify * obj)\n \t\tl = 0;\n \t}\n \tobj->buffersize = 1024;\n-\tobj->buffer = malloc(obj->buffersize);\n-\tif(!obj->buffer) {\n-\t\tsyslog(LOG_ERR, \"%s: malloc returned NULL\", \"upnp_event_prepare\");\n-\t\tif(xml) {\n-\t\t\tfree(xml);\n+\tfor (;;) {\n+\t\tobj->buffer = malloc(obj->buffersize);\n+\t\tif(!obj->buffer) {\n+\t\t\tsyslog(LOG_ERR, \"%s: malloc returned NULL\", \"upnp_event_prepare\");\n+\t\t\tif(xml) {\n+\t\t\t\tfree(xml);\n+\t\t\t}\n+\t\t\tobj->state = EError;\n+\t\t\treturn;\n \t\t}\n-\t\tobj->state = EError;\n-\t\treturn;\n+\t\tobj->tosend = snprintf(obj->buffer, obj->buffersize, notifymsg,\n+\t\t                       obj->path, obj->addrstr, obj->portstr, l+2,\n+\t\t                       obj->sub->uuid, obj->sub->seq,\n+\t\t                       l, xml);\n+\t\tif (obj->tosend < 0) {\n+\t\t\tsyslog(LOG_ERR, \"%s: snprintf() failed\", \"upnp_event_prepare\");\n+\t\t\tif(xml) {\n+\t\t\t\tfree(xml);\n+\t\t\t}\n+\t\t\tobj->state = EError;\n+\t\t\treturn;\n+\t\t} else if (obj->tosend < obj->buffersize) {\n+\t\t\tbreak; \/* the buffer was large enough *\/\n+\t\t}\n+\t\t\/* Try again with a buffer big enough *\/\n+\t\tfree(obj->buffer);\n+\t\tobj->buffersize = obj->tosend + 1;\t\/* reserve space for the final 0 *\/\n \t}\n-\tobj->tosend = snprintf(obj->buffer, obj->buffersize, notifymsg,\n-\t                       obj->path, obj->addrstr, obj->portstr, l+2,\n-\t                       obj->sub->uuid, obj->sub->seq,\n-\t                       l, xml);\n \tif(xml) {\n \t\tfree(xml);\n \t\txml = NULL;\n","owner":"miniupnp","repo":"miniupnp","source":"cve"},{"CVE_ID":"CVE-2010-2943","CWE_ID":"200","category":"security","commit_id":"7124fe0a5b619d65b739477b3b55a20bf805b06d","commit_message":"From 7124fe0a5b619d65b739477b3b55a20bf805b06d Mon Sep 17 00:00:00 2001\nFrom: Dave Chinner <dchinner@redhat.com>\nDate: Thu, 24 Jun 2010 11:15:33 +1000\nSubject: xfs: validate untrusted inode numbers during lookup\n\nWhen we decode a handle or do a bulkstat lookup, we are using an\ninode number we cannot trust to be valid. If we are deleting inode\nchunks from disk (default noikeep mode), then we cannot trust the on\ndisk inode buffer for any given inode number to correctly reflect\nwhether the inode has been unlinked as the di_mode nor the\ngeneration number may have been updated on disk.\n\nThis is due to the fact that when we delete an inode chunk, we do\nnot write the clusters back to disk when they are removed - instead\nwe mark them stale to avoid them being written back potentially over\nthe top of something that has been subsequently allocated at that\nlocation. The result is that we can have locations of disk that look\nlike they contain valid inodes but in reality do not. Hence we\ncannot simply convert the inode number to a block number and read\nthe location from disk to determine if the inode is valid or not.\n\nAs a result, and XFS_IGET_BULKSTAT lookup needs to actually look the\ninode up in the inode allocation btree to determine if the inode\nnumber is valid or not.\n\nIt should be noted even on ikeep filesystems, there is the\npossibility that blocks on disk may look like valid inode clusters.\ne.g. if there are filesystem images hosted on the filesystem. Hence\neven for ikeep filesystems we really need to validate that the inode\nnumber is valid before issuing the inode buffer read.\n\nSigned-off-by: Dave Chinner <dchinner@redhat.com>\nReviewed-by: Christoph Hellwig <hch@lst.de>\n---\n fs\/xfs\/xfs_ialloc.c | 121 +++++++++++++++++++++++++++++++++-------------------\n 1 file changed, 78 insertions(+), 43 deletions(-)\n\n","diff_code":"diff --git a\/fs\/xfs\/xfs_ialloc.c b\/fs\/xfs\/xfs_ialloc.c\nindex 9d884c127bb9..0c946c8e05da 100644\n--- a\/fs\/xfs\/xfs_ialloc.c\n+++ b\/fs\/xfs\/xfs_ialloc.c\n@@ -1203,6 +1203,63 @@ error0:\n \treturn error;\n }\n \n+STATIC int\n+xfs_imap_lookup(\n+\tstruct xfs_mount\t*mp,\n+\tstruct xfs_trans\t*tp,\n+\txfs_agnumber_t\t\tagno,\n+\txfs_agino_t\t\tagino,\n+\txfs_agblock_t\t\tagbno,\n+\txfs_agblock_t\t\t*chunk_agbno,\n+\txfs_agblock_t\t\t*offset_agbno,\n+\tint\t\t\tflags)\n+{\n+\tstruct xfs_inobt_rec_incore rec;\n+\tstruct xfs_btree_cur\t*cur;\n+\tstruct xfs_buf\t\t*agbp;\n+\txfs_agino_t\t\tstartino;\n+\tint\t\t\terror;\n+\tint\t\t\ti;\n+\n+\terror = xfs_ialloc_read_agi(mp, tp, agno, &agbp);\n+\tif (error) {\n+\t\txfs_fs_cmn_err(CE_ALERT, mp, \"xfs_imap: \"\n+\t\t\t\t\"xfs_ialloc_read_agi() returned \"\n+\t\t\t\t\"error %d, agno %d\",\n+\t\t\t\terror, agno);\n+\t\treturn error;\n+\t}\n+\n+\t\/*\n+\t * derive and lookup the exact inode record for the given agino. If the\n+\t * record cannot be found, then it's an invalid inode number and we\n+\t * should abort.\n+\t *\/\n+\tcur = xfs_inobt_init_cursor(mp, tp, agbp, agno);\n+\tstartino = agino & ~(XFS_IALLOC_INODES(mp) - 1);\n+\terror = xfs_inobt_lookup(cur, startino, XFS_LOOKUP_EQ, &i);\n+\tif (!error) {\n+\t\tif (i)\n+\t\t\terror = xfs_inobt_get_rec(cur, &rec, &i);\n+\t\tif (!error && i == 0)\n+\t\t\terror = EINVAL;\n+\t}\n+\n+\txfs_trans_brelse(tp, agbp);\n+\txfs_btree_del_cursor(cur, XFS_BTREE_NOERROR);\n+\tif (error)\n+\t\treturn error;\n+\n+\t\/* for untrusted inodes check it is allocated first *\/\n+\tif ((flags & XFS_IGET_BULKSTAT) &&\n+\t    (rec.ir_free & XFS_INOBT_MASK(agino - rec.ir_startino)))\n+\t\treturn EINVAL;\n+\n+\t*chunk_agbno = XFS_AGINO_TO_AGBNO(mp, rec.ir_startino);\n+\t*offset_agbno = agbno - *chunk_agbno;\n+\treturn 0;\n+}\n+\n \/*\n  * Return the location of the inode in imap, for mapping it into a buffer.\n  *\/\n@@ -1263,6 +1320,23 @@ xfs_imap(\n \t\treturn XFS_ERROR(EINVAL);\n \t}\n \n+\tblks_per_cluster = XFS_INODE_CLUSTER_SIZE(mp) >> mp->m_sb.sb_blocklog;\n+\n+\t\/*\n+\t * For bulkstat and handle lookups, we have an untrusted inode number\n+\t * that we have to verify is valid. We cannot do this just by reading\n+\t * the inode buffer as it may have been unlinked and removed leaving\n+\t * inodes in stale state on disk. Hence we have to do a btree lookup\n+\t * in all cases where an untrusted inode number is passed.\n+\t *\/\n+\tif (flags & XFS_IGET_BULKSTAT) {\n+\t\terror = xfs_imap_lookup(mp, tp, agno, agino, agbno,\n+\t\t\t\t\t&chunk_agbno, &offset_agbno, flags);\n+\t\tif (error)\n+\t\t\treturn error;\n+\t\tgoto out_map;\n+\t}\n+\n \t\/*\n \t * If the inode cluster size is the same as the blocksize or\n \t * smaller we get to the buffer by simple arithmetics.\n@@ -1277,10 +1351,8 @@ xfs_imap(\n \t\treturn 0;\n \t}\n \n-\tblks_per_cluster = XFS_INODE_CLUSTER_SIZE(mp) >> mp->m_sb.sb_blocklog;\n-\n \t\/*\n-\t * If we get a block number passed from bulkstat we can use it to\n+\t * If we get a block number passed we can use it to\n \t * find the buffer easily.\n \t *\/\n \tif (imap->im_blkno) {\n@@ -1304,50 +1376,13 @@ xfs_imap(\n \t\toffset_agbno = agbno & mp->m_inoalign_mask;\n \t\tchunk_agbno = agbno - offset_agbno;\n \t} else {\n-\t\txfs_btree_cur_t\t*cur;\t\/* inode btree cursor *\/\n-\t\txfs_inobt_rec_incore_t chunk_rec;\n-\t\txfs_buf_t\t*agbp;\t\/* agi buffer *\/\n-\t\tint\t\ti;\t\/* temp state *\/\n-\n-\t\terror = xfs_ialloc_read_agi(mp, tp, agno, &agbp);\n-\t\tif (error) {\n-\t\t\txfs_fs_cmn_err(CE_ALERT, mp, \"xfs_imap: \"\n-\t\t\t\t\t\"xfs_ialloc_read_agi() returned \"\n-\t\t\t\t\t\"error %d, agno %d\",\n-\t\t\t\t\terror, agno);\n-\t\t\treturn error;\n-\t\t}\n-\n-\t\tcur = xfs_inobt_init_cursor(mp, tp, agbp, agno);\n-\t\terror = xfs_inobt_lookup(cur, agino, XFS_LOOKUP_LE, &i);\n-\t\tif (error) {\n-\t\t\txfs_fs_cmn_err(CE_ALERT, mp, \"xfs_imap: \"\n-\t\t\t\t\t\"xfs_inobt_lookup() failed\");\n-\t\t\tgoto error0;\n-\t\t}\n-\n-\t\terror = xfs_inobt_get_rec(cur, &chunk_rec, &i);\n-\t\tif (error) {\n-\t\t\txfs_fs_cmn_err(CE_ALERT, mp, \"xfs_imap: \"\n-\t\t\t\t\t\"xfs_inobt_get_rec() failed\");\n-\t\t\tgoto error0;\n-\t\t}\n-\t\tif (i == 0) {\n-#ifdef DEBUG\n-\t\t\txfs_fs_cmn_err(CE_ALERT, mp, \"xfs_imap: \"\n-\t\t\t\t\t\"xfs_inobt_get_rec() failed\");\n-#endif \/* DEBUG *\/\n-\t\t\terror = XFS_ERROR(EINVAL);\n-\t\t}\n- error0:\n-\t\txfs_trans_brelse(tp, agbp);\n-\t\txfs_btree_del_cursor(cur, XFS_BTREE_NOERROR);\n+\t\terror = xfs_imap_lookup(mp, tp, agno, agino, agbno,\n+\t\t\t\t\t&chunk_agbno, &offset_agbno, flags);\n \t\tif (error)\n \t\t\treturn error;\n-\t\tchunk_agbno = XFS_AGINO_TO_AGBNO(mp, chunk_rec.ir_startino);\n-\t\toffset_agbno = agbno - chunk_agbno;\n \t}\n \n+out_map:\n \tASSERT(agbno >= chunk_agbno);\n \tcluster_agbno = chunk_agbno +\n \t\t((offset_agbno \/ blks_per_cluster) * blks_per_cluster);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-3237","CWE_ID":"200","category":"security","commit_id":"d5e0d0f607a7a029c6563a0470d88255c89a8d11","commit_message":"From d5e0d0f607a7a029c6563a0470d88255c89a8d11 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:52:02 +0000\nSubject: [PATCH] VSOCK: Fix missing msg_namelen update in\n vsock_stream_recvmsg()\n\nThe code misses to update the msg_namelen member to 0 and therefore\nmakes net\/socket.c leak the local, uninitialized sockaddr_storage\nvariable to userland -- 128 bytes of kernel stack memory.\n\nCc: Andy King <acking@vmware.com>\nCc: Dmitry Torokhov <dtor@vmware.com>\nCc: George Zhang <georgezhang@vmware.com>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/vmw_vsock\/af_vsock.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/net\/vmw_vsock\/af_vsock.c b\/net\/vmw_vsock\/af_vsock.c\nindex d8079daf1bdea..7f93e2a42d7a5 100644\n--- a\/net\/vmw_vsock\/af_vsock.c\n+++ b\/net\/vmw_vsock\/af_vsock.c\n@@ -1670,6 +1670,8 @@ vsock_stream_recvmsg(struct kiocb *kiocb,\n \tvsk = vsock_sk(sk);\n \terr = 0;\n \n+\tmsg->msg_namelen = 0;\n+\n \tlock_sock(sk);\n \n \tif (sk->sk_state != SS_CONNECTED) {\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-5243","CWE_ID":"200","category":"security","commit_id":"5d2be1422e02ccd697ccfcd45c85b4a26e6178e2","commit_message":"From 5d2be1422e02ccd697ccfcd45c85b4a26e6178e2 Mon Sep 17 00:00:00 2001\nFrom: Kangjie Lu <kangjielu@gmail.com>\nDate: Thu, 2 Jun 2016 04:04:56 -0400\nSubject: [PATCH] tipc: fix an infoleak in tipc_nl_compat_link_dump\n\nlink_info.str is a char array of size 60. Memory after the NULL\nbyte is not initialized. Sending the whole object out can cause\na leak.\n\nSigned-off-by: Kangjie Lu <kjlu@gatech.edu>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/tipc\/netlink_compat.c | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/tipc\/netlink_compat.c b\/net\/tipc\/netlink_compat.c\nindex f795b1dd0ccdf..3ad9fab1985f1 100644\n--- a\/net\/tipc\/netlink_compat.c\n+++ b\/net\/tipc\/netlink_compat.c\n@@ -604,7 +604,8 @@ static int tipc_nl_compat_link_dump(struct tipc_nl_compat_msg *msg,\n \n \tlink_info.dest = nla_get_flag(link[TIPC_NLA_LINK_DEST]);\n \tlink_info.up = htonl(nla_get_flag(link[TIPC_NLA_LINK_UP]));\n-\tstrcpy(link_info.str, nla_data(link[TIPC_NLA_LINK_NAME]));\n+\tnla_strlcpy(link_info.str, nla_data(link[TIPC_NLA_LINK_NAME]),\n+\t\t    TIPC_MAX_LINK_NAME);\n \n \treturn tipc_add_tlv(msg->rep, TIPC_TLV_LINK_INFO,\n \t\t\t    &link_info, sizeof(link_info));\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-4580","CWE_ID":"200","category":"security","commit_id":"79e48650320e6fba48369fccf13fd045315b19b8","commit_message":"From 79e48650320e6fba48369fccf13fd045315b19b8 Mon Sep 17 00:00:00 2001\nFrom: Kangjie Lu <kangjielu@gmail.com>\nDate: Sun, 8 May 2016 12:10:14 -0400\nSubject: net: fix a kernel infoleak in x25 module\n\nStack object \"dte_facilities\" is allocated in x25_rx_call_request(),\nwhich is supposed to be initialized in x25_negotiate_facilities.\nHowever, 5 fields (8 bytes in total) are not initialized. This\nobject is then copied to userland via copy_to_user, thus infoleak\noccurs.\n\nSigned-off-by: Kangjie Lu <kjlu@gatech.edu>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/x25\/x25_facilities.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/x25\/x25_facilities.c b\/net\/x25\/x25_facilities.c\nindex 7ecd04c21360..997ff7b2509b 100644\n--- a\/net\/x25\/x25_facilities.c\n+++ b\/net\/x25\/x25_facilities.c\n@@ -277,6 +277,7 @@ int x25_negotiate_facilities(struct sk_buff *skb, struct sock *sk,\n \n \tmemset(&theirs, 0, sizeof(theirs));\n \tmemcpy(new, ours, sizeof(*new));\n+\tmemset(dte, 0, sizeof(*dte));\n \n \tlen = x25_parse_facilities(skb, &theirs, dte, &x25->vc_facil_mask);\n \tif (len < 0)\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2015-5330","CWE_ID":"200","category":"security","commit_id":"f36cb71c330a52106e36028b3029d952257baf15","commit_message":"From f36cb71c330a52106e36028b3029d952257baf15 Mon Sep 17 00:00:00 2001\nFrom: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>\nDate: Thu, 26 Nov 2015 11:17:11 +1300\nSubject: [PATCH] CVE-2015-5330: ldb_dn_explode: copy strings by length, not\n terminators\n\nThat is, memdup(), not strdup(). The terminators might not be there.\n\nBut, we have to make sure we put the terminator on, because we tend to\nassume the terminator is there in other places.\n\nUse talloc_set_name_const() on the resulting chunk so talloc_report()\nremains unchanged.\n\nBug: https:\/\/bugzilla.samba.org\/show_bug.cgi?id=11599\n\nSigned-off-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>\nPair-programmed-with: Andrew Bartlett <abartlet@samba.org>\nPair-programmed-with: Garming Sam <garming@catalyst.net.nz>\nPair-programmed-with: Stefan Metzmacher <metze@samba.org>\nPair-programmed-with: Ralph Boehme <slow@samba.org>\n---\n lib\/ldb\/common\/ldb_dn.c | 9 +++++++--\n 1 file changed, 7 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/lib\/ldb\/common\/ldb_dn.c b\/lib\/ldb\/common\/ldb_dn.c\nindex 6f9903e3e65..dfd3b5844cf 100644\n--- a\/lib\/ldb\/common\/ldb_dn.c\n+++ b\/lib\/ldb\/common\/ldb_dn.c\n@@ -586,12 +586,15 @@ static bool ldb_dn_explode(struct ldb_dn *dn)\n \n \t\t\t\tp++;\n \t\t\t\t*d++ = '\\0';\n-\t\t\t\tdn->components[dn->comp_num].value.data = (uint8_t *)talloc_strdup(dn->components, dt);\n+\t\t\t\tdn->components[dn->comp_num].value.data = \\\n+\t\t\t\t\t(uint8_t *)talloc_memdup(dn->components, dt, l + 1);\n \t\t\t\tdn->components[dn->comp_num].value.length = l;\n \t\t\t\tif ( ! dn->components[dn->comp_num].value.data) {\n \t\t\t\t\t\/* ouch ! *\/\n \t\t\t\t\tgoto failed;\n \t\t\t\t}\n+\t\t\t\ttalloc_set_name_const(dn->components[dn->comp_num].value.data,\n+\t\t\t\t\t\t      (const char *)dn->components[dn->comp_num].value.data);\n \n \t\t\t\tdt = d;\n \n@@ -707,11 +710,13 @@ static bool ldb_dn_explode(struct ldb_dn *dn)\n \t*d++ = '\\0';\n \tdn->components[dn->comp_num].value.length = l;\n \tdn->components[dn->comp_num].value.data =\n-\t\t\t\t(uint8_t *)talloc_strdup(dn->components, dt);\n+\t\t(uint8_t *)talloc_memdup(dn->components, dt, l + 1);\n \tif ( ! dn->components[dn->comp_num].value.data) {\n \t\t\/* ouch *\/\n \t\tgoto failed;\n \t}\n+\ttalloc_set_name_const(dn->components[dn->comp_num].value.data,\n+\t\t\t      (const char *)dn->components[dn->comp_num].value.data);\n \n \tdn->comp_num++;\n \n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-6836","CWE_ID":"200","category":"security","commit_id":"fdda170e50b8af062cf5741e12c4fb5e57a2eacf","commit_message":"From fdda170e50b8af062cf5741e12c4fb5e57a2eacf Mon Sep 17 00:00:00 2001\nFrom: Li Qiang <liqiang6-s@360.cn>\nDate: Thu, 11 Aug 2016 00:42:20 +0530\nSubject: [PATCH] net: vmxnet: initialise local tx descriptor\n\nIn Vmxnet3 device emulator while processing transmit(tx) queue,\nwhen it reaches end of packet, it calls vmxnet3_complete_packet.\nIn that local 'txcq_descr' object is not initialised, which could\nleak host memory bytes a guest.\n\nReported-by: Li Qiang <liqiang6-s@360.cn>\nSigned-off-by: Prasad J Pandit <pjp@fedoraproject.org>\nReviewed-by: Dmitry Fleytman <dmitry@daynix.com>\nSigned-off-by: Jason Wang <jasowang@redhat.com>\n---\n hw\/net\/vmxnet3.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/hw\/net\/vmxnet3.c b\/hw\/net\/vmxnet3.c\nindex 90f6943..92f6af9 100644\n--- a\/hw\/net\/vmxnet3.c\n+++ b\/hw\/net\/vmxnet3.c\n@@ -531,6 +531,7 @@ static void vmxnet3_complete_packet(VMXNET3State *s, int qidx, uint32_t tx_ridx)\n \n     VMXNET3_RING_DUMP(VMW_RIPRN, \"TXC\", qidx, &s->txq_descr[qidx].comp_ring);\n \n+    memset(&txcq_descr, 0, sizeof(txcq_descr));\n     txcq_descr.txdIdx = tx_ridx;\n     txcq_descr.gen = vmxnet3_ring_curr_gen(&s->txq_descr[qidx].comp_ring);\n \n-- \n1.8.3.1\n\n","owner":"qemu","repo":"qemu","source":"cve"},{"CVE_ID":"CVE-2005-4881","CWE_ID":"200","category":"security","commit_id":"8a47077a0b5aa2649751c46e7a27884e6686ccbf","commit_message":"From 8a47077a0b5aa2649751c46e7a27884e6686ccbf Mon Sep 17 00:00:00 2001\nFrom: Patrick McHardy <kaber@trash.net>\nDate: Tue, 28 Jun 2005 12:56:45 -0700\nSubject: [NETLINK]: Missing padding fields in dumped structures\n\nPlug holes with padding fields and initialized them to zero.\n\nSigned-off-by: Patrick McHardy <kaber@trash.net>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n include\/linux\/pkt_cls.h   | 1 +\n include\/linux\/pkt_sched.h | 9 ++++++---\n include\/linux\/rtnetlink.h | 5 +++++\n net\/ipv6\/addrconf.c       | 3 +++\n net\/sched\/cls_rsvp.h      | 1 +\n net\/sched\/sch_cbq.c       | 1 +\n 6 files changed, 17 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/include\/linux\/pkt_cls.h b\/include\/linux\/pkt_cls.h\nindex 25d2d67c1faf..bd2c5a2bbbf5 100644\n--- a\/include\/linux\/pkt_cls.h\n+++ b\/include\/linux\/pkt_cls.h\n@@ -276,6 +276,7 @@ struct tc_rsvp_pinfo\n \t__u8\tprotocol;\n \t__u8\ttunnelid;\n \t__u8\ttunnelhdr;\n+\t__u8\tpad;\n };\n \n \/* ROUTE filter *\/\ndiff --git a\/include\/linux\/pkt_sched.h b\/include\/linux\/pkt_sched.h\nindex 1d9da36eb9db..60ffcb9c5791 100644\n--- a\/include\/linux\/pkt_sched.h\n+++ b\/include\/linux\/pkt_sched.h\n@@ -221,9 +221,11 @@ struct tc_gred_qopt\n \/* gred setup *\/\n struct tc_gred_sopt\n {\n-       __u32           DPs;\n-       __u32           def_DP;\n-       __u8            grio;\n+       __u32\t\tDPs;\n+       __u32\t\tdef_DP;\n+       __u8\t\tgrio;\n+       __u8\t\tpad1;\n+       __u16\t\tpad2;\n };\n \n \/* HTB section *\/\n@@ -351,6 +353,7 @@ struct tc_cbq_ovl\n #define\tTC_CBQ_OVL_DROP\t\t3\n #define\tTC_CBQ_OVL_RCLASSIC\t4\n \tunsigned char\tpriority2;\n+\t__u16\t\tpad;\n \t__u32\t\tpenalty;\n };\n \ndiff --git a\/include\/linux\/rtnetlink.h b\/include\/linux\/rtnetlink.h\nindex dc26e82ba0fd..657c05ab8f9e 100644\n--- a\/include\/linux\/rtnetlink.h\n+++ b\/include\/linux\/rtnetlink.h\n@@ -363,6 +363,8 @@ enum\n struct rta_session\n {\n \t__u8\tproto;\n+\t__u8\tpad1;\n+\t__u16\tpad2;\n \n \tunion {\n \t\tstruct {\n@@ -635,10 +637,13 @@ struct ifinfomsg\n struct prefixmsg\n {\n \tunsigned char\tprefix_family;\n+\tunsigned char\tprefix_pad1;\n+\tunsigned short\tprefix_pad2;\n \tint\t\tprefix_ifindex;\n \tunsigned char\tprefix_type;\n \tunsigned char\tprefix_len;\n \tunsigned char\tprefix_flags;\n+\tunsigned char\tprefix_pad3;\n };\n \n enum \ndiff --git a\/net\/ipv6\/addrconf.c b\/net\/ipv6\/addrconf.c\nindex 8140bed78a26..1b2902d8eb98 100644\n--- a\/net\/ipv6\/addrconf.c\n+++ b\/net\/ipv6\/addrconf.c\n@@ -3031,9 +3031,12 @@ static int inet6_fill_prefix(struct sk_buff *skb, struct inet6_dev *idev,\n \tnlh = NLMSG_NEW(skb, pid, seq, event, sizeof(*pmsg), flags);\n \tpmsg = NLMSG_DATA(nlh);\n \tpmsg->prefix_family = AF_INET6;\n+\tpmsg->prefix_pad1 = 0;\n+\tpmsg->prefix_pad2 = 0;\n \tpmsg->prefix_ifindex = idev->dev->ifindex;\n \tpmsg->prefix_len = pinfo->prefix_len;\n \tpmsg->prefix_type = pinfo->type;\n+\tpmsg->prefix_pad3 = 0;\n \t\n \tpmsg->prefix_flags = 0;\n \tif (pinfo->onlink)\ndiff --git a\/net\/sched\/cls_rsvp.h b\/net\/sched\/cls_rsvp.h\nindex 232fb9196810..006168d69376 100644\n--- a\/net\/sched\/cls_rsvp.h\n+++ b\/net\/sched\/cls_rsvp.h\n@@ -618,6 +618,7 @@ static int rsvp_dump(struct tcf_proto *tp, unsigned long fh,\n \tpinfo.protocol = s->protocol;\n \tpinfo.tunnelid = s->tunnelid;\n \tpinfo.tunnelhdr = f->tunnelhdr;\n+\tpinfo.pad = 0;\n \tRTA_PUT(skb, TCA_RSVP_PINFO, sizeof(pinfo), &pinfo);\n \tif (f->res.classid)\n \t\tRTA_PUT(skb, TCA_RSVP_CLASSID, 4, &f->res.classid);\ndiff --git a\/net\/sched\/sch_cbq.c b\/net\/sched\/sch_cbq.c\nindex baeb3111f75e..09453f997d8c 100644\n--- a\/net\/sched\/sch_cbq.c\n+++ b\/net\/sched\/sch_cbq.c\n@@ -1528,6 +1528,7 @@ static __inline__ int cbq_dump_ovl(struct sk_buff *skb, struct cbq_class *cl)\n \n \topt.strategy = cl->ovl_strategy;\n \topt.priority2 = cl->priority2+1;\n+\topt.pad = 0;\n \topt.penalty = (cl->penalty*1000)\/HZ;\n \tRTA_PUT(skb, TCA_CBQ_OVL_STRATEGY, sizeof(opt), &opt);\n \treturn skb->len;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-16323","CWE_ID":"200","category":"security","commit_id":"216d117f05bff87b9dc4db55a1b1fadb38bcb786","commit_message":"From 216d117f05bff87b9dc4db55a1b1fadb38bcb786 Mon Sep 17 00:00:00 2001\nFrom: Cristy <urban-warrior@imagemagick.org>\nDate: Tue, 24 Jul 2018 17:31:33 -0400\nSubject: [PATCH] XBM coder leaves the hex image data uninitialized if hex\n value of the pixel is negative\n\n---\n coders\/xbm.c | 10 ++++++++--\n 1 file changed, 8 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/coders\/xbm.c b\/coders\/xbm.c\nindex 34344b735e..bae47c8e59 100644\n--- a\/coders\/xbm.c\n+++ b\/coders\/xbm.c\n@@ -351,7 +351,10 @@ static Image *ReadXBMImage(const ImageInfo *image_info,ExceptionInfo *exception)\n     {\n       c=XBMInteger(image,hex_digits);\n       if (c < 0)\n-        break;\n+        {\n+          data=(unsigned char *) RelinquishMagickMemory(data);\n+          ThrowReaderException(CorruptImageError,\"ImproperImageHeader\");\n+        }\n       *p++=(unsigned char) c;\n       if ((padding == 0) || (((i+2) % bytes_per_line) != 0))\n         *p++=(unsigned char) (c >> 8);\n@@ -361,7 +364,10 @@ static Image *ReadXBMImage(const ImageInfo *image_info,ExceptionInfo *exception)\n     {\n       c=XBMInteger(image,hex_digits);\n       if (c < 0)\n-        break;\n+        {\n+          data=(unsigned char *) RelinquishMagickMemory(data);\n+          ThrowReaderException(CorruptImageError,\"ImproperImageHeader\");\n+        }\n       *p++=(unsigned char) c;\n     }\n   if (EOFBlob(image) != MagickFalse)\n","owner":"ImageMagick","repo":"ImageMagick","source":"cve"},{"CVE_ID":"CVE-2010-0003","CWE_ID":"200","category":"security","commit_id":"b45c6e76bc2c72f6426c14bed64fdcbc9bf37cb0","commit_message":"From b45c6e76bc2c72f6426c14bed64fdcbc9bf37cb0 Mon Sep 17 00:00:00 2001\nFrom: Andi Kleen <andi@firstfloor.org>\nDate: Fri, 8 Jan 2010 14:42:52 -0800\nSubject: kernel\/signal.c: fix kernel information leak with\n print-fatal-signals=1\n\nWhen print-fatal-signals is enabled it's possible to dump any memory\nreachable by the kernel to the log by simply jumping to that address from\nuser space.\n\nOr crash the system if there's some hardware with read side effects.\n\nThe fatal signals handler will dump 16 bytes at the execution address,\nwhich is fully controlled by ring 3.\n\nIn addition when something jumps to a unmapped address there will be up to\n16 additional useless page faults, which might be potentially slow (and at\nleast is not very efficient)\n\nFortunately this option is off by default and only there on i386.\n\nBut fix it by checking for kernel addresses and also stopping when there's\na page fault.\n\nSigned-off-by: Andi Kleen <ak@linux.intel.com>\nCc: Ingo Molnar <mingo@elte.hu>\nCc: Oleg Nesterov <oleg@redhat.com>\nCc: <stable@kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n kernel\/signal.c | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/kernel\/signal.c b\/kernel\/signal.c\nindex d09692b40376..934ae5e687b9 100644\n--- a\/kernel\/signal.c\n+++ b\/kernel\/signal.c\n@@ -979,7 +979,8 @@ static void print_fatal_signal(struct pt_regs *regs, int signr)\n \t\tfor (i = 0; i < 16; i++) {\n \t\t\tunsigned char insn;\n \n-\t\t\t__get_user(insn, (unsigned char *)(regs->ip + i));\n+\t\t\tif (get_user(insn, (unsigned char *)(regs->ip + i)))\n+\t\t\t\tbreak;\n \t\t\tprintk(\"%02x \", insn);\n \t\t}\n \t}\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-7524","CWE_ID":"200","category":"security","commit_id":"c5d72beaab1cbbbe68271f4bc4b6670d69985157","commit_message":"From c5d72beaab1cbbbe68271f4bc4b6670d69985157 Mon Sep 17 00:00:00 2001\nFrom: William Roberts <william.c.roberts@intel.com>\nDate: Wed, 21 Jun 2017 09:32:32 -0700\nSubject: [PATCH] kdfa: use openssl for hmac not tpm\n\nWhile not reachable in the current code base tools, a potential\nsecurity bug lurked in tpm_kdfa().\n\nIf using that routine for an hmac authorization, the hmac was\ncalculated using the tpm. A user of an object wishing to\nauthenticate via hmac, would expect that the password is never\nsent to the tpm. However, since the hmac calculation relies on\npassword, and is performed by the tpm, the password ends up\nbeing sent in plain text to the tpm.\n\nThe fix is to use openssl to generate the hmac on the host.\n\nFixes: CVE-2017-7524\n\nSigned-off-by: William Roberts <william.c.roberts@intel.com>\n---\n Makefile.am       |  4 +--\n configure.ac      |  3 +-\n lib\/tpm_kdfa.c    | 76 ++++++++++++++++++++++++++++++++++++++++-------\n lib\/tpm_kdfa.h    |  2 +-\n lib\/tpm_session.c |  2 +-\n 5 files changed, 72 insertions(+), 15 deletions(-)\n\n","diff_code":"diff --git a\/Makefile.am b\/Makefile.am\nindex a3c43f874..c40c24bd3 100644\n--- a\/Makefile.am\n+++ b\/Makefile.am\n@@ -35,10 +35,10 @@ ACLOCAL_AMFLAGS = -I m4\n INCLUDE_DIRS = -I$(srcdir)\/src -I$(srcdir)\/lib\n LIB_COMMON := lib\/libcommon.a\n \n-AM_CFLAGS    := $(INCLUDE_DIRS) $(TPM20_TSS_CFLAGS) $(EXTRA_CFLAGS) $(TCTI_TABRMD_CFLAGS)\n+AM_CFLAGS    := $(INCLUDE_DIRS) $(TPM20_TSS_CFLAGS) $(EXTRA_CFLAGS) $(TCTI_TABRMD_CFLAGS) $(CRYPTO_CFLAGS)\n AM_LDFLAGS   := $(EXTRA_LDFLAGS)\n \n-LDADD = $(LIB_COMMON) $(TPM20_TSS_LIBS) $(TCTI_SOCK_LIBS) $(TCTI_DEV_LIBS) $(TCTI_TABRMD_LIBS)\n+LDADD = $(LIB_COMMON) $(TPM20_TSS_LIBS) $(TCTI_SOCK_LIBS) $(TCTI_DEV_LIBS) $(TCTI_TABRMD_LIBS) $(CRYPTO_LIBS)\n \n sbin_PROGRAMS = \\\n     tools\/tpm2_create \\\ndiff --git a\/configure.ac b\/configure.ac\nindex ce781ea9f..8ef3b173b 100644\n--- a\/configure.ac\n+++ b\/configure.ac\n@@ -69,7 +69,8 @@ AS_IF(\n     [AC_MSG_ERROR(\n         [no TCTIs: at least one TCTI library must be enabled],\n         [1])])\n-PKG_CHECK_MODULES([CURL],[libcurl libcrypto])\n+PKG_CHECK_MODULES([CRYPTO],[libcrypto])\n+PKG_CHECK_MODULES([CURL],[libcurl])\n AC_ARG_ENABLE([unit],\n             [AS_HELP_STRING([--enable-unit],\n                             [build cmocka unit tests (default is no)])],\ndiff --git a\/lib\/tpm_kdfa.c b\/lib\/tpm_kdfa.c\nindex 0ba8679e1..8198c9bbf 100644\n--- a\/lib\/tpm_kdfa.c\n+++ b\/lib\/tpm_kdfa.c\n@@ -27,20 +27,40 @@\n \n #include <sapi\/tpm20.h>\n \n+ #include <openssl\/err.h>\n+#include <openssl\/hmac.h>\n+\n #include \"string-bytes.h\"\n #include \"tpm_hmac.h\"\n+#include \"log.h\"\n+\n+static const EVP_MD *tpm_algorithm_to_openssl_digest(TPMI_ALG_HASH algorithm) {\n+\n+    switch(algorithm) {\n+    case TPM_ALG_SHA1:\n+        return EVP_sha1();\n+    case ALG_SHA256_VALUE:\n+        return EVP_sha256();\n+    case TPM_ALG_SHA384:\n+        return EVP_sha384();\n+    case TPM_ALG_SHA512:\n+        return EVP_sha512();\n+    default:\n+        return NULL;\n+    }\n+    \/* no return, not possible *\/\n+}\n \n-TPM_RC tpm_kdfa(TSS2_SYS_CONTEXT *sapi_context, TPMI_ALG_HASH hashAlg,\n+TPM_RC tpm_kdfa(TPMI_ALG_HASH hashAlg,\n         TPM2B *key, char *label, TPM2B *contextU, TPM2B *contextV, UINT16 bits,\n         TPM2B_MAX_BUFFER  *resultKey )\n {\n-    TPM2B_DIGEST tmpResult;\n     TPM2B_DIGEST tpm2bLabel, tpm2bBits, tpm2b_i_2;\n     UINT8 *tpm2bBitsPtr = &tpm2bBits.t.buffer[0];\n     UINT8 *tpm2b_i_2Ptr = &tpm2b_i_2.t.buffer[0];\n     TPM2B_DIGEST *bufferList[8];\n     UINT32 bitsSwizzled, i_Swizzled;\n-    TPM_RC rval;\n+    TPM_RC rval = TPM_RC_SUCCESS;\n     int i, j;\n     UINT16 bytes = bits \/ 8;\n \n@@ -64,8 +84,24 @@ TPM_RC tpm_kdfa(TSS2_SYS_CONTEXT *sapi_context, TPMI_ALG_HASH hashAlg,\n \n     i = 1;\n \n+    const EVP_MD *md = tpm_algorithm_to_openssl_digest(hashAlg);\n+    if (!md) {\n+        LOG_ERR(\"Algorithm not supported for hmac: %x\", hashAlg);\n+        return TPM_RC_HASH;\n+    }\n+\n+    HMAC_CTX ctx;\n+    HMAC_CTX_init(&ctx);\n+    int rc = HMAC_Init_ex(&ctx, key->buffer, key->size, md, NULL);\n+    if (!rc) {\n+        LOG_ERR(\"HMAC Init failed: %s\", ERR_error_string(rc, NULL));\n+        return TPM_RC_MEMORY;\n+    }\n+\n+    \/\/ TODO Why is this a loop? It appears to only execute once.\n     while( resultKey->t.size < bytes )\n     {\n+        TPM2B_DIGEST tmpResult;\n         \/\/ Inner loop\n \n         i_Swizzled = string_bytes_endian_convert_32( i );\n@@ -77,21 +113,41 @@ TPM_RC tpm_kdfa(TSS2_SYS_CONTEXT *sapi_context, TPMI_ALG_HASH hashAlg,\n         bufferList[j++] = (TPM2B_DIGEST *)contextU;\n         bufferList[j++] = (TPM2B_DIGEST *)contextV;\n         bufferList[j++] = (TPM2B_DIGEST *)&(tpm2bBits.b);\n-        bufferList[j++] = (TPM2B_DIGEST *)0;\n-        rval = tpm_hmac(sapi_context, hashAlg, key, (TPM2B **)&( bufferList[0] ), &tmpResult );\n-        if( rval != TPM_RC_SUCCESS )\n-        {\n-            return( rval );\n+        bufferList[j] = (TPM2B_DIGEST *)0;\n+\n+        int c;\n+        for(c=0; c < j; c++) {\n+            TPM2B_DIGEST *digest = bufferList[c];\n+            int rc =  HMAC_Update(&ctx, digest->b.buffer, digest->b.size);\n+            if (!rc) {\n+                LOG_ERR(\"HMAC Update failed: %s\", ERR_error_string(rc, NULL));\n+                rval = TPM_RC_MEMORY;\n+                goto err;\n+            }\n+        }\n+\n+        unsigned size = sizeof(tmpResult.t.buffer);\n+        int rc = HMAC_Final(&ctx, tmpResult.t.buffer, &size);\n+        if (!rc) {\n+            LOG_ERR(\"HMAC Final failed: %s\", ERR_error_string(rc, NULL));\n+            rval = TPM_RC_MEMORY;\n+            goto err;\n         }\n \n+        tmpResult.t.size = size;\n+\n         bool res = string_bytes_concat_buffer(resultKey, &(tmpResult.b));\n         if (!res) {\n-            return TSS2_SYS_RC_BAD_VALUE;\n+            rval = TSS2_SYS_RC_BAD_VALUE;\n+            goto err;\n         }\n     }\n \n     \/\/ Truncate the result to the desired size.\n     resultKey->t.size = bytes;\n \n-    return TPM_RC_SUCCESS;\n+err:\n+    HMAC_CTX_cleanup(&ctx);\n+\n+    return rval;\n }\ndiff --git a\/lib\/tpm_kdfa.h b\/lib\/tpm_kdfa.h\nindex 68413bd88..e26b111ca 100644\n--- a\/lib\/tpm_kdfa.h\n+++ b\/lib\/tpm_kdfa.h\n@@ -42,7 +42,7 @@\n  * @param resultKey\n  * @return\n  *\/\n-TPM_RC tpm_kdfa(TSS2_SYS_CONTEXT *sapi_context, TPMI_ALG_HASH hashAlg,\n+TPM_RC tpm_kdfa(TPMI_ALG_HASH hashAlg,\n         TPM2B *key, char *label, TPM2B *contextU, TPM2B *contextV,\n         UINT16 bits, TPM2B_MAX_BUFFER *resultKey );\n \ndiff --git a\/lib\/tpm_session.c b\/lib\/tpm_session.c\nindex 414f1f74a..f13e7efcc 100644\n--- a\/lib\/tpm_session.c\n+++ b\/lib\/tpm_session.c\n@@ -198,7 +198,7 @@ static TPM_RC StartAuthSession(TSS2_SYS_CONTEXT *sapi_context, SESSION *session\n             }\n             else\n             {\n-                rval = tpm_kdfa(sapi_context, session->authHash, &(key.b), label, &( session->nonceNewer.b ),\n+                rval = tpm_kdfa(session->authHash, &(key.b), label, &( session->nonceNewer.b ),\n                         &( session->nonceOlder.b ), bytes * 8, (TPM2B_MAX_BUFFER *)&( session->sessionKey ) );\n             }\n \n","owner":"01org","repo":"tpm2.0-tools","source":"cve"},{"CVE_ID":"CVE-2010-4074","CWE_ID":"200","category":"security","commit_id":"a0846f1868b11cd827bdfeaf4527d8b1b1c0b098","commit_message":"From a0846f1868b11cd827bdfeaf4527d8b1b1c0b098 Mon Sep 17 00:00:00 2001\nFrom: Dan Rosenberg <drosenberg@vsecurity.com>\nDate: Wed, 15 Sep 2010 17:44:16 -0400\nSubject: USB: serial\/mos*: prevent reading uninitialized stack memory\n\nThe TIOCGICOUNT device ioctl in both mos7720.c and mos7840.c allows\nunprivileged users to read uninitialized stack memory, because the\n\"reserved\" member of the serial_icounter_struct struct declared on the\nstack is not altered or zeroed before being copied back to the user.\nThis patch takes care of it.\n\nSigned-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>\nCc: stable <stable@kernel.org>\nSigned-off-by: Greg Kroah-Hartman <gregkh@suse.de>\n---\n drivers\/usb\/serial\/mos7720.c | 3 +++\n drivers\/usb\/serial\/mos7840.c | 3 +++\n 2 files changed, 6 insertions(+)\n\n","diff_code":"diff --git a\/drivers\/usb\/serial\/mos7720.c b\/drivers\/usb\/serial\/mos7720.c\nindex 30922a7e3347..aa665817a272 100644\n--- a\/drivers\/usb\/serial\/mos7720.c\n+++ b\/drivers\/usb\/serial\/mos7720.c\n@@ -2024,6 +2024,9 @@ static int mos7720_ioctl(struct tty_struct *tty, struct file *file,\n \n \tcase TIOCGICOUNT:\n \t\tcnow = mos7720_port->icount;\n+\n+\t\tmemset(&icount, 0, sizeof(struct serial_icounter_struct));\n+\n \t\ticount.cts = cnow.cts;\n \t\ticount.dsr = cnow.dsr;\n \t\ticount.rng = cnow.rng;\ndiff --git a\/drivers\/usb\/serial\/mos7840.c b\/drivers\/usb\/serial\/mos7840.c\nindex 1c9b6e9b2386..1a42bc213799 100644\n--- a\/drivers\/usb\/serial\/mos7840.c\n+++ b\/drivers\/usb\/serial\/mos7840.c\n@@ -2285,6 +2285,9 @@ static int mos7840_ioctl(struct tty_struct *tty, struct file *file,\n \tcase TIOCGICOUNT:\n \t\tcnow = mos7840_port->icount;\n \t\tsmp_rmb();\n+\n+\t\tmemset(&icount, 0, sizeof(struct serial_icounter_struct));\n+\n \t\ticount.cts = cnow.cts;\n \t\ticount.dsr = cnow.dsr;\n \t\ticount.rng = cnow.rng;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2013-3230","CWE_ID":"200","category":"security","commit_id":"b860d3cc62877fad02863e2a08efff69a19382d2","commit_message":"From b860d3cc62877fad02863e2a08efff69a19382d2 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:55 +0000\nSubject: [PATCH] l2tp: fix info leak in l2tp_ip6_recvmsg()\n\nThe L2TP code for IPv6 fails to initialize the l2tp_conn_id member of\nstruct sockaddr_l2tpip6 and therefore leaks four bytes kernel stack\nin l2tp_ip6_recvmsg() in case msg_name is set.\n\nInitialize l2tp_conn_id with 0 to avoid the info leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/l2tp\/l2tp_ip6.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/l2tp\/l2tp_ip6.c b\/net\/l2tp\/l2tp_ip6.c\nindex c74f5a91ff6a3..b8a6039314e86 100644\n--- a\/net\/l2tp\/l2tp_ip6.c\n+++ b\/net\/l2tp\/l2tp_ip6.c\n@@ -690,6 +690,7 @@ static int l2tp_ip6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \t\tlsa->l2tp_addr = ipv6_hdr(skb)->saddr;\n \t\tlsa->l2tp_flowinfo = 0;\n \t\tlsa->l2tp_scope_id = 0;\n+\t\tlsa->l2tp_conn_id = 0;\n \t\tif (ipv6_addr_type(&lsa->l2tp_addr) & IPV6_ADDR_LINKLOCAL)\n \t\t\tlsa->l2tp_scope_id = IP6CB(skb)->iif;\n \t}\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-0723","CWE_ID":"200","category":"security","commit_id":"5c17c861a357e9458001f021a7afa7aab9937439","commit_message":"From 5c17c861a357e9458001f021a7afa7aab9937439 Mon Sep 17 00:00:00 2001\nFrom: Peter Hurley <peter@hurleysoftware.com>\nDate: Sun, 10 Jan 2016 22:40:55 -0800\nSubject: [PATCH] tty: Fix unsafe ldisc reference via ioctl(TIOCGETD)\n\nioctl(TIOCGETD) retrieves the line discipline id directly from the\nldisc because the line discipline id (c_line) in termios is untrustworthy;\nuserspace may have set termios via ioctl(TCSETS*) without actually\nchanging the line discipline via ioctl(TIOCSETD).\n\nHowever, directly accessing the current ldisc via tty->ldisc is\nunsafe; the ldisc ptr dereferenced may be stale if the line discipline\nis changing via ioctl(TIOCSETD) or hangup.\n\nWait for the line discipline reference (just like read() or write())\nto retrieve the \"current\" line discipline id.\n\nCc: <stable@vger.kernel.org>\nSigned-off-by: Peter Hurley <peter@hurleysoftware.com>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\n---\n drivers\/tty\/tty_io.c | 24 +++++++++++++++++++++++-\n 1 file changed, 23 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/drivers\/tty\/tty_io.c b\/drivers\/tty\/tty_io.c\nindex a1b36bf545e82..5cec01c75691a 100644\n--- a\/drivers\/tty\/tty_io.c\n+++ b\/drivers\/tty\/tty_io.c\n@@ -2658,6 +2658,28 @@ static int tiocsetd(struct tty_struct *tty, int __user *p)\n \treturn ret;\n }\n \n+\/**\n+ *\ttiocgetd\t-\tget line discipline\n+ *\t@tty: tty device\n+ *\t@p: pointer to user data\n+ *\n+ *\tRetrieves the line discipline id directly from the ldisc.\n+ *\n+ *\tLocking: waits for ldisc reference (in case the line discipline\n+ *\t\tis changing or the tty is being hungup)\n+ *\/\n+\n+static int tiocgetd(struct tty_struct *tty, int __user *p)\n+{\n+\tstruct tty_ldisc *ld;\n+\tint ret;\n+\n+\tld = tty_ldisc_ref_wait(tty);\n+\tret = put_user(ld->ops->num, p);\n+\ttty_ldisc_deref(ld);\n+\treturn ret;\n+}\n+\n \/**\n  *\tsend_break\t-\tperformed time break\n  *\t@tty: device to break on\n@@ -2884,7 +2906,7 @@ long tty_ioctl(struct file *file, unsigned int cmd, unsigned long arg)\n \tcase TIOCGSID:\n \t\treturn tiocgsid(tty, real_tty, p);\n \tcase TIOCGETD:\n-\t\treturn put_user(tty->ldisc->ops->num, (int __user *)p);\n+\t\treturn tiocgetd(tty, p);\n \tcase TIOCSETD:\n \t\treturn tiocsetd(tty, p);\n \tcase TIOCVHANGUP:\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-5337","CWE_ID":"200","category":"security","commit_id":"844864fbae66935951529408831c2f22367a57b6","commit_message":"From 844864fbae66935951529408831c2f22367a57b6 Mon Sep 17 00:00:00 2001\nFrom: Prasad J Pandit <pjp@fedoraproject.org>\nDate: Tue, 7 Jun 2016 16:44:03 +0530\nSubject: [PATCH] scsi: megasas: null terminate bios version buffer\n\nWhile reading information via 'megasas_ctrl_get_info' routine,\na local bios version buffer isn't null terminated. Add the\nterminating null byte to avoid any OOB access.\n\nReported-by: Li Qiang <liqiang6-s@360.cn>\nReviewed-by: Peter Maydell <peter.maydell@linaro.org>\nSigned-off-by: Prasad J Pandit <pjp@fedoraproject.org>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>\n---\n hw\/scsi\/megasas.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/hw\/scsi\/megasas.c b\/hw\/scsi\/megasas.c\nindex cc66d36..a9ffc32 100644\n--- a\/hw\/scsi\/megasas.c\n+++ b\/hw\/scsi\/megasas.c\n@@ -773,6 +773,7 @@ static int megasas_ctrl_get_info(MegasasState *s, MegasasCmd *cmd)\n \n         ptr = memory_region_get_ram_ptr(&pci_dev->rom);\n         memcpy(biosver, ptr + 0x41, 31);\n+        biosver[31] = 0;\n         memcpy(info.image_component[1].name, \"BIOS\", 4);\n         memcpy(info.image_component[1].version, biosver,\n                strlen((const char *)biosver));\n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2012-0037","CWE_ID":"200","category":"security","commit_id":"a676f235309a59d4aa78eeffd2574ae5d341fcb0","commit_message":"From a676f235309a59d4aa78eeffd2574ae5d341fcb0 Mon Sep 17 00:00:00 2001\nFrom: Dave Beckett <dave@dajobe.org>\nDate: Sun, 29 Jan 2012 12:34:59 -0800\nSubject: [PATCH] CVE-2012-0037\n\nEnforce entity loading policy in raptor_libxml_resolveEntity\nand raptor_libxml_getEntity by checking for file URIs and network URIs.\n\nAdd RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES \/ loadExternalEntities for\nturning on loading of XML external entity loading, disabled by default.\n\nThis affects all the parsers that use SAX2: rdfxml, rss-tag-soup (and\naliases) and rdfa.\n---\n ChangeLog                  |  17 ++++++\n NEWS.html                  |  13 +++--\n RELEASE.html               |  24 ++++++--\n docs\/raptor-1-to-2-map.tsv |   1 +\n librdfa\/rdfa.c             |   3 +\n src\/raptor2.h.in           |   4 +-\n src\/raptor_libxml.c        | 109 +++++++++++++++++++++++++++++++++++--\n src\/raptor_option.c        |   6 ++\n src\/raptor_rdfxml.c        |   3 +\n src\/raptor_rss.c           |   3 +\n src\/raptor_turtle_writer.c |   2 +\n 11 files changed, 169 insertions(+), 16 deletions(-)\n\n","diff_code":"diff --git a\/ChangeLog b\/ChangeLog\nindex a7f549fd..ca5f4856 100644\n--- a\/ChangeLog\n+++ b\/ChangeLog\n@@ -1,3 +1,20 @@\n+2012-01-29  Dave Beckett <dave@dajobe.org>\n+\n+\t* librdfa\/rdfa.c, src\/raptor2.h.in, src\/raptor_libxml.c,\n+\tsrc\/raptor_option.c, src\/raptor_rdfxml.c, src\/raptor_rss.c,\n+\tsrc\/raptor_turtle_writer.c: CVE-2012-0037\n+\n+\tEnforce entity loading policy in raptor_libxml_resolveEntity and\n+\traptor_libxml_getEntity by checking for file URIs and network\n+\tURIs.\n+\n+\tAdd RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES \/ loadExternalEntities\n+\tfor turning on loading of XML external entity loading, disabled by\n+\tdefault.\n+\n+\tThis affects all the parsers that use SAX2: rdfxml, rdfa,\n+\trss-tag-soup (and aliases).\n+\n 2012-03-15  Dave Beckett <dave@dajobe.org>\n \n \t* librdfa\/rdfa.c: Pass on options NO_NET and NO_FILE to RDFA SAX2\ndiff --git a\/NEWS.html b\/NEWS.html\nindex 9ce54571..4cc90186 100644\n--- a\/NEWS.html\n+++ b\/NEWS.html\n@@ -8,20 +8,21 @@\n \n <h1 style=\"text-align:center\">Raptor RDF Syntax Library - News<\/h1>\n \n-<h2 id=\"D2012-XX-XX-V2.0.7\">2012-XX-XX Raptor2 Version 2.0.7 Released<\/h2>\n+<h2 id=\"D2012-03-22-V2.0.7\">2012-03-22 Raptor2 Version 2.0.7 Released<\/h2>\n \n-<p>Not yet released.\n-<\/p>\n-\n-<p>\n+<p>CVE-2012-0037 fixed<br \/>\n Removed Expat support<br \/>\n Removed internal Unicode NFC code for better and optional <a href=\"http:\/\/www.icu-project.org\/\">ICU<\/a><br \/>\n-Added new options for denying file requests and SSL certificate verifying<br \/>\n+Added options for denying file requests and XML entity loading<br \/>\n+Added options for SSL certificate verifying<br \/>\n Fixed reported <a href=\"http:\/\/bugs.librdf.org\/\">issues<\/a>:\n <a href=\"http:\/\/bugs.librdf.org\/mantis\/view.php?id=448\">0000448<\/a> and\n <a href=\"http:\/\/bugs.librdf.org\/mantis\/view.php?id=469\">0000469<\/a>\n <\/p>\n \n+<p>See the <a href=\"RELEASE.html#rel2_0_7\">Raptor2 2.0.7 Release Notes<\/a>\n+for the full details of the changes.<\/p>\n+\n \n <h2 id=\"D2011-11-27-V2.0.6\">2011-11-27 Raptor2 Version 2.0.6 Released<\/h2>\n \ndiff --git a\/RELEASE.html b\/RELEASE.html\nindex 6f539f7c..31f64c82 100644\n--- a\/RELEASE.html\n+++ b\/RELEASE.html\n@@ -11,8 +11,7 @@ <h1 style=\"text-align:center\">Raptor RDF Syntax Library - Release Notes<\/h1>\n \n <h2 id=\"rel2_0_7\"><a name=\"rel2_0_7\">Raptor2 2.0.7 changes<\/a><\/h2>\n \n-<p>Not yet released.\n-<\/p>\n+<p>CVE-2012-0037 fixed<\/p>\n \n <p>Issues Fixed:<\/p>\n <ul>\n@@ -39,6 +38,10 @@ <h3>Options changes<\/h3>\n   <dt><code>RAPTOR_OPTION_NO_FILE<\/code><br\/><\/dt>\n   <dd>Deny file requests during parsing.<\/dd>\n \n+  <dt><code>RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES<\/code><br\/><\/dt>\n+  <dd>Deny loading of XML external entity loading. Disabled by\n+  default.<\/dd>\n+\n   <dt><code>RAPTOR_OPTION_WWW_SSL_VERIFY_PEER<\/code><br\/><\/dt>\n   <dd>Controls verifying an SSL peer during parsing \/ WWW.  Takes an\n   integer value: non-0 to verify peer SSL certificate (default\n@@ -53,6 +56,10 @@ <h3>Options changes<\/h3>\n \n <h3>Parser class changes<\/h3>\n \n+<p>The RDF\/XML, RSS Tag Soup and RDFa parsers now pass on network,\n+file and entity loading parser options to the internal SAX2 to enable\n+enforcing of network, file and entity loading policy.<\/p>\n+\n <p>RDF\/JSON parser handles an API change between YAJL V1 and V2.\n <\/p>\n \n@@ -64,11 +71,18 @@ <h3>Parser class changes<\/h3>\n \n <h3>SAX2 class changes<\/h3>\n \n-<p>\n-Added <code>raptor_sax2_set_uri_filter()<\/code> to set a URI filter\n-for any SAX2 calls that do internal lookups of URIs.\n+<p>Added <code>raptor_sax2_set_uri_filter()<\/code> to set a URI\n+filter for any SAX2 calls that do internal lookups of URIs.\n <\/p>\n \n+<p>Control file and network loading inside SAX2.  Option\n+<code>RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES<\/code> now enforces\n+loading external XML entities and is by default enabled.  If enabled,\n+<code>RAPTOR_OPTION_NO_FILE<\/code> and\n+<code>RAPTOR_OPTION_NO_NET<\/code> are also checked.  All URIs loaded\n+are also passed through any URI filter, if set by\n+<code>raptor_sax2_set_uri_filter()<\/code>.\n+<\/p>\n \n <h3>URI class changes<\/h3>\n \ndiff --git a\/docs\/raptor-1-to-2-map.tsv b\/docs\/raptor-1-to-2-map.tsv\nindex fc624442..01ef8f78 100644\n--- a\/docs\/raptor-1-to-2-map.tsv\n+++ b\/docs\/raptor-1-to-2-map.tsv\n@@ -560,3 +560,4 @@\n 2.0.6\tenum\t-\t-\t2.0.7\tenum\tRAPTOR_OPTION_NO_FILE\t-\t-\n 2.0.6\tenum\t-\t-\t2.0.7\tenum\tRAPTOR_OPTION_WWW_SSL_VERIFY_PEER\t-\t-\n 2.0.6\tenum\t-\t-\t2.0.7\tenum\tRAPTOR_OPTION_WWW_SSL_VERIFY_HOST\t-\t-\n+2.0.6\tenum\t-\t-\t2.0.7\tenum\tRAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES\t-\t-\ndiff --git a\/librdfa\/rdfa.c b\/librdfa\/rdfa.c\nindex 8ec11144..be68b954 100644\n--- a\/librdfa\/rdfa.c\n+++ b\/librdfa\/rdfa.c\n@@ -1230,6 +1230,9 @@ int rdfa_parse_start(rdfacontext* context)\n      raptor_sax2_set_option(context->sax2,\n                             RAPTOR_OPTION_NO_FILE, NULL,\n                             RAPTOR_OPTIONS_GET_NUMERIC(rdf_parser, RAPTOR_OPTION_NO_FILE));\n+     raptor_sax2_set_option(context->sax2,\n+                            RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES, NULL,\n+                            RAPTOR_OPTIONS_GET_NUMERIC(rdf_parser, RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES));\n      if(rdf_parser->uri_filter)\n        raptor_sax2_set_uri_filter(context->sax2, rdf_parser->uri_filter,\n                                   rdf_parser->uri_filter_user_data);\ndiff --git a\/src\/raptor2.h.in b\/src\/raptor2.h.in\nindex 88d2d637..6da99ca9 100644\n--- a\/src\/raptor2.h.in\n+++ b\/src\/raptor2.h.in\n@@ -528,6 +528,7 @@ typedef struct {\n  * @RAPTOR_OPTION_WWW_SSL_VERIFY_PEER:  Integer. SSL verify peer - non-0 to verify peer SSL certificate (default)\n  * @RAPTOR_OPTION_WWW_SSL_VERIFY_HOST: Integer. SSL verify host - 0 none, 1 CN match, 2 host match (default). Other values are ignored.\n  * @RAPTOR_OPTION_NO_FILE: Deny file reading requests inside other requests.\n+ * @RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES: When reading XML, load external entities.\n  * @RAPTOR_OPTION_LAST: Internal\n  *\n  * Raptor parser, serializer or XML writer options.\n@@ -574,7 +575,8 @@ typedef enum {\n   RAPTOR_OPTION_NO_FILE,\n   RAPTOR_OPTION_WWW_SSL_VERIFY_PEER,\n   RAPTOR_OPTION_WWW_SSL_VERIFY_HOST,\n-  RAPTOR_OPTION_LAST = RAPTOR_OPTION_WWW_SSL_VERIFY_HOST\n+  RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES,\n+  RAPTOR_OPTION_LAST = RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES\n } raptor_option;\n \n \ndiff --git a\/src\/raptor_libxml.c b\/src\/raptor_libxml.c\nindex f6a96a43..b60e7480 100644\n--- a\/src\/raptor_libxml.c\n+++ b\/src\/raptor_libxml.c\n@@ -145,16 +145,117 @@ raptor_libxml_hasExternalSubset (void* user_data)\n \n static xmlParserInputPtr\n raptor_libxml_resolveEntity(void* user_data, \n-                            const xmlChar *publicId, const xmlChar *systemId) {\n+                            const xmlChar *publicId, const xmlChar *systemId)\n+{\n   raptor_sax2* sax2 = (raptor_sax2*)user_data;\n-  return libxml2_resolveEntity(sax2->xc, publicId, systemId);\n+  xmlParserCtxtPtr ctxt = sax2->xc;\n+  const unsigned char *uri_string = NULL;\n+  xmlParserInputPtr entity_input;\n+  int load_entity = 0;\n+\n+  if(ctxt->input)\n+    uri_string = RAPTOR_GOOD_CAST(const unsigned char *, ctxt->input->filename);\n+\n+  if(!uri_string)\n+    uri_string = RAPTOR_GOOD_CAST(const unsigned char *, ctxt->directory);\n+\n+  load_entity = RAPTOR_OPTIONS_GET_NUMERIC(sax2, RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES);\n+  if(load_entity)\n+    load_entity = raptor_sax2_check_load_uri_string(sax2, uri_string);\n+\n+  if(load_entity) {\n+    entity_input = xmlLoadExternalEntity(RAPTOR_GOOD_CAST(const char*, uri_string),\n+                                         RAPTOR_GOOD_CAST(const char*, publicId),\n+                                         ctxt);\n+  } else {\n+    RAPTOR_DEBUG4(\"Not loading entity URI %s by policy for publicId '%s' systemId '%s'\\n\", uri_string, publicId, systemId);\n+  }\n+  \n+  return entity_input;\n }\n \n \n static xmlEntityPtr\n-raptor_libxml_getEntity(void* user_data, const xmlChar *name) {\n+raptor_libxml_getEntity(void* user_data, const xmlChar *name)\n+{\n   raptor_sax2* sax2 = (raptor_sax2*)user_data;\n-  return libxml2_getEntity(sax2->xc, name);\n+  xmlParserCtxtPtr xc = sax2->xc;\n+  xmlEntityPtr ret = NULL;\n+\n+  if(!xc)\n+    return NULL;\n+\n+  if(!xc->inSubset) {\n+    \/* looks for hardcoded set of entity names - lt, gt etc. *\/\n+    ret = xmlGetPredefinedEntity(name);\n+    if(ret) {\n+      RAPTOR_DEBUG2(\"Entity '%s' found in predefined set\\n\", name);\n+      return ret;\n+    }\n+  }\n+\n+  \/* This section uses xmlGetDocEntity which looks for entities in\n+   * memory only, never from a file or URI \n+   *\/\n+  if(xc->myDoc && (xc->myDoc->standalone == 1)) {\n+    RAPTOR_DEBUG2(\"Entity '%s' document is standalone\\n\", name);\n+    \/* Document is standalone: no entities are required to interpret doc *\/\n+    if(xc->inSubset == 2) {\n+      xc->myDoc->standalone = 0;\n+      ret = xmlGetDocEntity(xc->myDoc, name);\n+      xc->myDoc->standalone = 1;\n+    } else {\n+      ret = xmlGetDocEntity(xc->myDoc, name);\n+      if(!ret) {\n+        xc->myDoc->standalone = 0;\n+        ret = xmlGetDocEntity(xc->myDoc, name);\n+        xc->myDoc->standalone = 1;\n+      }\n+    }\n+  } else {\n+    ret = xmlGetDocEntity(xc->myDoc, name);\n+  }\n+\n+  if(ret && !ret->children &&\n+    (ret->etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY)) {\n+    \/* Entity is an external general parsed entity. It may be in a\n+     * catalog file, user file or user URI\n+     *\/\n+    int val = 0;\n+    xmlNodePtr children;\n+    int load_entity = 0;\n+\n+    load_entity = RAPTOR_OPTIONS_GET_NUMERIC(sax2, RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES);\n+    if(load_entity)\n+      load_entity = raptor_sax2_check_load_uri_string(sax2, ret->URI);\n+\n+    if(!load_entity) {\n+      RAPTOR_DEBUG2(\"Not getting entity URI %s by policy\\n\", ret->URI);\n+      children = xmlNewText((const xmlChar*)\"\");\n+    } else {\n+      \/* Disable SAX2 handlers so that the SAX2 events do not all get\n+       * sent to callbacks during dealing with the entity parsing.\n+       *\/\n+      sax2->enabled = 0;\n+      val = xmlParseCtxtExternalEntity(xc, ret->URI, ret->ExternalID, &children);\n+      sax2->enabled = 1;\n+    }\n+    \n+    if(!val) {\n+      xmlAddChildList((xmlNodePtr)ret, children);\n+    } else {\n+      xc->validate = 0;\n+      return NULL;\n+    }\n+    \n+    ret->owner = 1;\n+\n+    \/* Mark this entity as having been checked - never do this again *\/\n+    if(!ret->checked)\n+      ret->checked = 1;\n+  }\n+\n+  return ret;\n }\n \n \ndiff --git a\/src\/raptor_option.c b\/src\/raptor_option.c\nindex 460d0d79..834c1c65 100644\n--- a\/src\/raptor_option.c\n+++ b\/src\/raptor_option.c\n@@ -295,6 +295,12 @@ static const struct\n     RAPTOR_OPTION_VALUE_TYPE_INT,\n     \"wwwSslVerifyHost\",\n     \"SSL verify host matching\"\n+  },\n+  { RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES,\n+    (raptor_option_area)(RAPTOR_OPTION_AREA_PARSER | RAPTOR_OPTION_AREA_SAX2),\n+    RAPTOR_OPTION_VALUE_TYPE_BOOL,\n+    \"loadExternalEntities\",\n+    \"Parsers and SAX2 should load external entities.\"\n   }\n };\n \ndiff --git a\/src\/raptor_rdfxml.c b\/src\/raptor_rdfxml.c\nindex 53b1ab7e..7d06299f 100644\n--- a\/src\/raptor_rdfxml.c\n+++ b\/src\/raptor_rdfxml.c\n@@ -1004,6 +1004,9 @@ raptor_rdfxml_parse_start(raptor_parser* rdf_parser)\n   raptor_sax2_set_option(rdf_xml_parser->sax2, \n                          RAPTOR_OPTION_NO_FILE, NULL,\n                          RAPTOR_OPTIONS_GET_NUMERIC(rdf_parser, RAPTOR_OPTION_NO_FILE));\n+  raptor_sax2_set_option(rdf_xml_parser->sax2, \n+                         RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES, NULL,\n+                         RAPTOR_OPTIONS_GET_NUMERIC(rdf_parser, RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES));\n   if(rdf_parser->uri_filter)\n     raptor_sax2_set_uri_filter(rdf_xml_parser->sax2, rdf_parser->uri_filter,\n                                rdf_parser->uri_filter_user_data);\ndiff --git a\/src\/raptor_rss.c b\/src\/raptor_rss.c\nindex 46286848..d66ade01 100644\n--- a\/src\/raptor_rss.c\n+++ b\/src\/raptor_rss.c\n@@ -252,6 +252,9 @@ raptor_rss_parse_start(raptor_parser *rdf_parser)\n   raptor_sax2_set_option(rss_parser->sax2, \n                          RAPTOR_OPTION_NO_FILE, NULL,\n                          RAPTOR_OPTIONS_GET_NUMERIC(rdf_parser, RAPTOR_OPTION_NO_FILE));\n+  raptor_sax2_set_option(rss_parser->sax2, \n+                         RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES, NULL,\n+                         RAPTOR_OPTIONS_GET_NUMERIC(rdf_parser, RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES));\n   if(rdf_parser->uri_filter)\n     raptor_sax2_set_uri_filter(rss_parser->sax2, rdf_parser->uri_filter,\n                                rdf_parser->uri_filter_user_data);\ndiff --git a\/src\/raptor_turtle_writer.c b\/src\/raptor_turtle_writer.c\nindex 7701d314..6eb1c275 100644\n--- a\/src\/raptor_turtle_writer.c\n+++ b\/src\/raptor_turtle_writer.c\n@@ -705,6 +705,7 @@ raptor_turtle_writer_set_option(raptor_turtle_writer *turtle_writer,\n     \/* Shared *\/\n     case RAPTOR_OPTION_NO_NET:\n     case RAPTOR_OPTION_NO_FILE:\n+    case RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES:\n \n     \/* XML writer options *\/\n     case RAPTOR_OPTION_RELATIVE_URIS:\n@@ -829,6 +830,7 @@ raptor_turtle_writer_get_option(raptor_turtle_writer *turtle_writer,\n     \/* Shared *\/\n     case RAPTOR_OPTION_NO_NET:\n     case RAPTOR_OPTION_NO_FILE:\n+    case RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES:\n \n     \/* XML writer options *\/\n     case RAPTOR_OPTION_RELATIVE_URIS:\n","owner":"dajobe","repo":"raptor","source":"cve"},{"CVE_ID":"CVE-2010-1149","CWE_ID":"200","category":"security","commit_id":"0fcc7cb3b66f23fac53ae08647aa0007a2bd56c4","commit_message":"From 0fcc7cb3b66f23fac53ae08647aa0007a2bd56c4 Mon Sep 17 00:00:00 2001\nFrom: Martin Pitt <martin.pitt@ubuntu.com>\nDate: Wed, 7 Apr 2010 08:12:42 +0200\nSubject: =?UTF-8?q?Bug=2027494=20=E2=80=94=20publicly=20exports=20dm=20key?=\n =?UTF-8?q?=20information?=\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nChange udisks-dm-export to only export UDISKS_DM_TARGETS_PARAMS for \"linear\"\ntypes. It is the only one we care about for now and know how to interpret.\n\"crypto\" types have information about the encryption key in the target\nparameters, which we must not leak.\n\nAlso add appropriate comments to the two places which currently evaluate\nUDISKS_DM_TARGETS_PARAMS.\n---\n src\/device.c                   | 2 ++\n src\/probers\/part-id.c          | 2 ++\n src\/probers\/udisks-dm-export.c | 5 ++++-\n 3 files changed, 8 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/src\/device.c b\/src\/device.c\nindex bac971d..12cab7c 100644\n--- a\/src\/device.c\n+++ b\/src\/device.c\n@@ -3336,6 +3336,8 @@ update_info_partition_on_linux_dmmp (Device *device)\n     goto out;\n \n   targets_type = g_udev_device_get_property_as_strv (device->priv->d, \"UDISKS_DM_TARGETS_TYPE\");\n+  \/* If we ever need this for other types than \"linear\", remember to update\n+     udisks-dm-export.c as well. *\/\n   if (targets_type == NULL || g_strcmp0 (targets_type[0], \"linear\") != 0)\n     goto out;\n \ndiff --git a\/src\/probers\/part-id.c b\/src\/probers\/part-id.c\nindex b61ea07..306eb44 100644\n--- a\/src\/probers\/part-id.c\n+++ b\/src\/probers\/part-id.c\n@@ -246,6 +246,8 @@ get_part_table_device_file (struct udev_device *given_device,\n       \/\/g_printerr (\"targets_type=`%s'\\n\", targets_type);\n       \/\/g_printerr (\"encoded_targets_params=`%s'\\n\", encoded_targets_params);\n \n+      \/* If we ever need this for other types than \"linear\", remember to update\n+         udisks-dm-export.c as well. *\/\n       if (g_strcmp0 (targets_type, \"linear\") == 0)\n         {\n           gint partition_slave_major;\ndiff --git a\/src\/probers\/udisks-dm-export.c b\/src\/probers\/udisks-dm-export.c\nindex b950c32..8fff4f9 100644\n--- a\/src\/probers\/udisks-dm-export.c\n+++ b\/src\/probers\/udisks-dm-export.c\n@@ -287,7 +287,10 @@ dm_export (int major, int minor)\n           g_string_append (target_types_str, target_type);\n           g_string_append_printf (start_str, \"%\" G_GUINT64_FORMAT, start);\n           g_string_append_printf (length_str, \"%\" G_GUINT64_FORMAT, length);\n-          if (params != NULL && strlen (params) > 0)\n+          \/* Set target_params for known-safe and known-needed target types only. In particular,\n+           * we must not export it for \"crypto\", since that would expose\n+           * information about the key. *\/\n+          if (g_strcmp0 (target_type, \"linear\") == 0 && params != NULL && strlen (params) > 0)\n             {\n               _udev_util_encode_string (params, buf, sizeof (buf));\n               g_string_append (params_str, buf);\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2015-3195","CWE_ID":"200","category":"security","commit_id":"cc598f321fbac9c04da5766243ed55d55948637d","commit_message":"From cc598f321fbac9c04da5766243ed55d55948637d Mon Sep 17 00:00:00 2001\nFrom: \"Dr. Stephen Henson\" <steve@openssl.org>\nDate: Tue, 10 Nov 2015 19:03:07 +0000\nSubject: [PATCH] Fix leak with ASN.1 combine.\n\nWhen parsing a combined structure pass a flag to the decode routine\nso on error a pointer to the parent structure is not zeroed as\nthis will leak any additional components in the parent.\n\nThis can leak memory in any application parsing PKCS#7 or CMS structures.\n\nCVE-2015-3195.\n\nThanks to Adam Langley (Google\/BoringSSL) for discovering this bug using\nlibFuzzer.\n\nPR#4131\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\n---\n crypto\/asn1\/tasn_dec.c | 7 +++++--\n 1 file changed, 5 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/crypto\/asn1\/tasn_dec.c b\/crypto\/asn1\/tasn_dec.c\nindex febf6059cb..9256049d15 100644\n--- a\/crypto\/asn1\/tasn_dec.c\n+++ b\/crypto\/asn1\/tasn_dec.c\n@@ -180,6 +180,8 @@ int ASN1_item_ex_d2i(ASN1_VALUE **pval, const unsigned char **in, long len,\n     int otag;\n     int ret = 0;\n     ASN1_VALUE **pchptr, *ptmpval;\n+    int combine = aclass & ASN1_TFLG_COMBINE;\n+    aclass &= ~ASN1_TFLG_COMBINE;\n     if (!pval)\n         return 0;\n     if (aux && aux->asn1_cb)\n@@ -500,7 +502,8 @@ int ASN1_item_ex_d2i(ASN1_VALUE **pval, const unsigned char **in, long len,\n  auxerr:\n     ASN1err(ASN1_F_ASN1_ITEM_EX_D2I, ASN1_R_AUX_ERROR);\n  err:\n-    ASN1_item_ex_free(pval, it);\n+    if (combine == 0)\n+        ASN1_item_ex_free(pval, it);\n     if (errtt)\n         ERR_add_error_data(4, \"Field=\", errtt->field_name,\n                            \", Type=\", it->sname);\n@@ -689,7 +692,7 @@ static int asn1_template_noexp_d2i(ASN1_VALUE **val,\n     } else {\n         \/* Nothing special *\/\n         ret = ASN1_item_ex_d2i(val, &p, len, ASN1_ITEM_ptr(tt->item),\n-                               -1, 0, opt, ctx);\n+                               -1, tt->flags & ASN1_TFLG_COMBINE, opt, ctx);\n         if (!ret) {\n             ASN1err(ASN1_F_ASN1_TEMPLATE_NOEXP_D2I, ERR_R_NESTED_ASN1_ERROR);\n             goto err;\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2011-1171","CWE_ID":"200","category":"security","commit_id":"78b79876761b86653df89c48a7010b5cbd41a84a","commit_message":"From 78b79876761b86653df89c48a7010b5cbd41a84a Mon Sep 17 00:00:00 2001\nFrom: Vasiliy Kulikov <segoon@openwall.com>\nDate: Tue, 15 Mar 2011 13:36:05 +0100\nSubject: netfilter: ip_tables: fix infoleak to userspace\n\nStructures ipt_replace, compat_ipt_replace, and xt_get_revision are\ncopied from userspace.  Fields of these structs that are\nzero-terminated strings are not checked.  When they are used as argument\nto a format string containing \"%s\" in request_module(), some sensitive\ninformation is leaked to userspace via argument of spawned modprobe\nprocess.\n\nThe first and the third bugs were introduced before the git epoch; the\nsecond was introduced in 2722971c (v2.6.17-rc1).  To trigger the bug\none should have CAP_NET_ADMIN.\n\nSigned-off-by: Vasiliy Kulikov <segoon@openwall.com>\nSigned-off-by: Patrick McHardy <kaber@trash.net>\n---\n net\/ipv4\/netfilter\/ip_tables.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/net\/ipv4\/netfilter\/ip_tables.c b\/net\/ipv4\/netfilter\/ip_tables.c\nindex ef7d7b9680ea..b09ed0d080f9 100644\n--- a\/net\/ipv4\/netfilter\/ip_tables.c\n+++ b\/net\/ipv4\/netfilter\/ip_tables.c\n@@ -1262,6 +1262,7 @@ do_replace(struct net *net, const void __user *user, unsigned int len)\n \t\/* overflow check *\/\n \tif (tmp.num_counters >= INT_MAX \/ sizeof(struct xt_counters))\n \t\treturn -ENOMEM;\n+\ttmp.name[sizeof(tmp.name)-1] = 0;\n \n \tnewinfo = xt_alloc_table_info(tmp.size);\n \tif (!newinfo)\n@@ -1807,6 +1808,7 @@ compat_do_replace(struct net *net, void __user *user, unsigned int len)\n \t\treturn -ENOMEM;\n \tif (tmp.num_counters >= INT_MAX \/ sizeof(struct xt_counters))\n \t\treturn -ENOMEM;\n+\ttmp.name[sizeof(tmp.name)-1] = 0;\n \n \tnewinfo = xt_alloc_table_info(tmp.size);\n \tif (!newinfo)\n@@ -2036,6 +2038,7 @@ do_ipt_get_ctl(struct sock *sk, int cmd, void __user *user, int *len)\n \t\t\tret = -EFAULT;\n \t\t\tbreak;\n \t\t}\n+\t\trev.name[sizeof(rev.name)-1] = 0;\n \n \t\tif (cmd == IPT_SO_GET_REVISION_TARGET)\n \t\t\ttarget = 1;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2019-7222","CWE_ID":"200","category":"security","commit_id":"353c0956a618a07ba4bbe7ad00ff29fe70e8412a","commit_message":"From 353c0956a618a07ba4bbe7ad00ff29fe70e8412a Mon Sep 17 00:00:00 2001\nFrom: Paolo Bonzini <pbonzini@redhat.com>\nDate: Tue, 29 Jan 2019 18:41:16 +0100\nSubject: KVM: x86: work around leak of uninitialized stack contents\n (CVE-2019-7222)\n\nBugzilla: 1671930\n\nEmulation of certain instructions (VMXON, VMCLEAR, VMPTRLD, VMWRITE with\nmemory operand, INVEPT, INVVPID) can incorrectly inject a page fault\nwhen passed an operand that points to an MMIO address.  The page fault\nwill use uninitialized kernel stack memory as the CR2 and error code.\n\nThe right behavior would be to abort the VM with a KVM_EXIT_INTERNAL_ERROR\nexit to userspace; however, it is not an easy fix, so for now just\nensure that the error code and CR2 are zero.\n\nEmbargoed until Feb 7th 2019.\n\nReported-by: Felix Wilhelm <fwilhelm@google.com>\nCc: stable@kernel.org\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>\n---\n arch\/x86\/kvm\/x86.c | 7 +++++++\n 1 file changed, 7 insertions(+)\n\n","diff_code":"diff --git a\/arch\/x86\/kvm\/x86.c b\/arch\/x86\/kvm\/x86.c\nindex 3d27206f6c01..e67ecf25e690 100644\n--- a\/arch\/x86\/kvm\/x86.c\n+++ b\/arch\/x86\/kvm\/x86.c\n@@ -5116,6 +5116,13 @@ int kvm_read_guest_virt(struct kvm_vcpu *vcpu,\n {\n \tu32 access = (kvm_x86_ops->get_cpl(vcpu) == 3) ? PFERR_USER_MASK : 0;\n \n+\t\/*\n+\t * FIXME: this should call handle_emulation_failure if X86EMUL_IO_NEEDED\n+\t * is returned, but our callers are not ready for that and they blindly\n+\t * call kvm_inject_page_fault.  Ensure that they at least do not leak\n+\t * uninitialized kernel stack memory into cr2 and error code.\n+\t *\/\n+\tmemset(exception, 0, sizeof(*exception));\n \treturn kvm_read_guest_virt_helper(addr, val, bytes, vcpu, access,\n \t\t\t\t\t  exception);\n }\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-9526","CWE_ID":"200","category":"security","commit_id":"f9494b3f258e01b6af8bd3941ce436bcc00afc56","commit_message":"From f9494b3f258e01b6af8bd3941ce436bcc00afc56 Mon Sep 17 00:00:00 2001\nFrom: Jo Van Bulck <jo.vanbulck@cs.kuleuven.be>\nDate: Thu, 19 Jan 2017 17:00:15 +0100\nSubject: [PATCH] ecc: Store EdDSA session key in secure memory.\n\n* cipher\/ecc-eddsa.c (_gcry_ecc_eddsa_sign): use mpi_snew to allocate\nsession key.\n--\n\nAn attacker who learns the EdDSA session key from side-channel\nobservation during the signing process, can easily revover the long-\nterm secret key. Storing the session key in secure memory ensures that\nconstant time point operations are used in the MPI library.\n\nSigned-off-by: Jo Van Bulck <jo.vanbulck@cs.kuleuven.be>\n---\n cipher\/ecc-eddsa.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/cipher\/ecc-eddsa.c b\/cipher\/ecc-eddsa.c\nindex f91f8489..813e030d 100644\n--- a\/cipher\/ecc-eddsa.c\n+++ b\/cipher\/ecc-eddsa.c\n@@ -603,7 +603,7 @@ _gcry_ecc_eddsa_sign (gcry_mpi_t input, ECC_secret_key *skey,\n   a = mpi_snew (0);\n   x = mpi_new (0);\n   y = mpi_new (0);\n-  r = mpi_new (0);\n+  r = mpi_snew (0);\n   ctx = _gcry_mpi_ec_p_internal_new (skey->E.model, skey->E.dialect, 0,\n                                      skey->E.p, skey->E.a, skey->E.b);\n   b = (ctx->nbits+7)\/8;\n-- \n2.11.0\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-14140","CWE_ID":"200","category":"security","commit_id":"197e7e521384a23b9e585178f3f11c9fa08274b9","commit_message":"From 197e7e521384a23b9e585178f3f11c9fa08274b9 Mon Sep 17 00:00:00 2001\nFrom: Linus Torvalds <torvalds@linux-foundation.org>\nDate: Sun, 20 Aug 2017 13:26:27 -0700\nSubject: Sanitize 'move_pages()' permission checks\n\nThe 'move_paghes()' system call was introduced long long ago with the\nsame permission checks as for sending a signal (except using\nCAP_SYS_NICE instead of CAP_SYS_KILL for the overriding capability).\n\nThat turns out to not be a great choice - while the system call really\nonly moves physical page allocations around (and you need other\ncapabilities to do a lot of it), you can check the return value to map\nout some the virtual address choices and defeat ASLR of a binary that\nstill shares your uid.\n\nSo change the access checks to the more common 'ptrace_may_access()'\nmodel instead.\n\nThis tightens the access checks for the uid, and also effectively\nchanges the CAP_SYS_NICE check to CAP_SYS_PTRACE, but it's unlikely that\nanybody really _uses_ this legacy system call any more (we hav ebetter\nNUMA placement models these days), so I expect nobody to notice.\n\nFamous last words.\n\nReported-by: Otto Ebeling <otto.ebeling@iki.fi>\nAcked-by: Eric W. Biederman <ebiederm@xmission.com>\nCc: Willy Tarreau <w@1wt.eu>\nCc: stable@kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n mm\/migrate.c | 11 +++--------\n 1 file changed, 3 insertions(+), 8 deletions(-)\n\n","diff_code":"diff --git a\/mm\/migrate.c b\/mm\/migrate.c\nindex d68a41da6abb..e84eeb4e4356 100644\n--- a\/mm\/migrate.c\n+++ b\/mm\/migrate.c\n@@ -41,6 +41,7 @@\n #include <linux\/page_idle.h>\n #include <linux\/page_owner.h>\n #include <linux\/sched\/mm.h>\n+#include <linux\/ptrace.h>\n \n #include <asm\/tlbflush.h>\n \n@@ -1652,7 +1653,6 @@ SYSCALL_DEFINE6(move_pages, pid_t, pid, unsigned long, nr_pages,\n \t\tconst int __user *, nodes,\n \t\tint __user *, status, int, flags)\n {\n-\tconst struct cred *cred = current_cred(), *tcred;\n \tstruct task_struct *task;\n \tstruct mm_struct *mm;\n \tint err;\n@@ -1676,14 +1676,9 @@ SYSCALL_DEFINE6(move_pages, pid_t, pid, unsigned long, nr_pages,\n \n \t\/*\n \t * Check if this process has the right to modify the specified\n-\t * process. The right exists if the process has administrative\n-\t * capabilities, superuser privileges or the same\n-\t * userid as the target process.\n+\t * process. Use the regular \"ptrace_may_access()\" checks.\n \t *\/\n-\ttcred = __task_cred(task);\n-\tif (!uid_eq(cred->euid, tcred->suid) && !uid_eq(cred->euid, tcred->uid) &&\n-\t    !uid_eq(cred->uid,  tcred->suid) && !uid_eq(cred->uid,  tcred->uid) &&\n-\t    !capable(CAP_SYS_NICE)) {\n+\tif (!ptrace_may_access(task, PTRACE_MODE_READ_REALCREDS)) {\n \t\trcu_read_unlock();\n \t\terr = -EPERM;\n \t\tgoto out;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2010-4072","CWE_ID":"200","category":"security","commit_id":"3af54c9bd9e6f14f896aac1bb0e8405ae0bc7a44","commit_message":"From 3af54c9bd9e6f14f896aac1bb0e8405ae0bc7a44 Mon Sep 17 00:00:00 2001\nFrom: Vasiliy Kulikov <segooon@gmail.com>\nDate: Sat, 30 Oct 2010 18:22:49 +0400\nSubject: ipc: shm: fix information leak to userland\n\nThe shmid_ds structure is copied to userland with shm_unused{,2,3}\nfields unitialized.  It leads to leaking of contents of kernel stack\nmemory.\n\nSigned-off-by: Vasiliy Kulikov <segooon@gmail.com>\nAcked-by: Al Viro <viro@ZenIV.linux.org.uk>\nCc: stable@kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n ipc\/shm.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/ipc\/shm.c b\/ipc\/shm.c\nindex fd658a1c2b88..7d3bb22a9302 100644\n--- a\/ipc\/shm.c\n+++ b\/ipc\/shm.c\n@@ -479,6 +479,7 @@ static inline unsigned long copy_shmid_to_user(void __user *buf, struct shmid64_\n \t    {\n \t\tstruct shmid_ds out;\n \n+\t\tmemset(&out, 0, sizeof(out));\n \t\tipc64_perm_to_ipc_perm(&in->shm_perm, &out.shm_perm);\n \t\tout.shm_segsz\t= in->shm_segsz;\n \t\tout.shm_atime\t= in->shm_atime;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-5244","CWE_ID":"200","category":"security","commit_id":"4116def2337991b39919f3b448326e21c40e0dbb","commit_message":"From 4116def2337991b39919f3b448326e21c40e0dbb Mon Sep 17 00:00:00 2001\nFrom: Kangjie Lu <kangjielu@gmail.com>\nDate: Thu, 2 Jun 2016 04:11:20 -0400\nSubject: rds: fix an infoleak in rds_inc_info_copy\n\nThe last field \"flags\" of object \"minfo\" is not initialized.\nCopying this object out may leak kernel stack data.\nAssign 0 to it to avoid leak.\n\nSigned-off-by: Kangjie Lu <kjlu@gatech.edu>\nAcked-by: Santosh Shilimkar <santosh.shilimkar@oracle.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/rds\/recv.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/net\/rds\/recv.c b\/net\/rds\/recv.c\nindex c0be1ecd11c9..8413f6c99e13 100644\n--- a\/net\/rds\/recv.c\n+++ b\/net\/rds\/recv.c\n@@ -561,5 +561,7 @@ void rds_inc_info_copy(struct rds_incoming *inc,\n \t\tminfo.fport = inc->i_hdr.h_dport;\n \t}\n \n+\tminfo.flags = 0;\n+\n \trds_info_copy(iter, &minfo, sizeof(minfo));\n }\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2011-0711","CWE_ID":"200","category":"security","commit_id":"3a3675b7f23f83ca8c67c9c2b6edf707fd28d1ba","commit_message":"From 3a3675b7f23f83ca8c67c9c2b6edf707fd28d1ba Mon Sep 17 00:00:00 2001\nFrom: Dan Rosenberg <drosenberg@vsecurity.com>\nDate: Mon, 14 Feb 2011 13:45:28 +0000\nSubject: xfs: prevent leaking uninitialized stack memory in FSGEOMETRY_V1\n\nThe FSGEOMETRY_V1 ioctl (and its compat equivalent) calls out to\nxfs_fs_geometry() with a version number of 3.  This code path does not\nfill in the logsunit member of the passed xfs_fsop_geom_t, leading to\nthe leaking of four bytes of uninitialized stack data to potentially\nunprivileged callers.\n\nv2 switches to memset() to avoid future issues if structure members\nchange, on suggestion of Dave Chinner.\n\nSigned-off-by: Dan Rosenberg <drosenberg@vsecurity.com>\nReviewed-by: Eugene Teo <eugeneteo@kernel.org>\nSigned-off-by: Alex Elder <aelder@sgi.com>\n---\n fs\/xfs\/xfs_fsops.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/fs\/xfs\/xfs_fsops.c b\/fs\/xfs\/xfs_fsops.c\nindex cec89dd5d7d2..85668efb3e3e 100644\n--- a\/fs\/xfs\/xfs_fsops.c\n+++ b\/fs\/xfs\/xfs_fsops.c\n@@ -53,6 +53,9 @@ xfs_fs_geometry(\n \txfs_fsop_geom_t\t\t*geo,\n \tint\t\t\tnew_version)\n {\n+\n+\tmemset(geo, 0, sizeof(*geo));\n+\n \tgeo->blocksize = mp->m_sb.sb_blocksize;\n \tgeo->rtextsize = mp->m_sb.sb_rextsize;\n \tgeo->agblocks = mp->m_sb.sb_agblocks;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"mjg59","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-9150","CWE_ID":"200","category":"security","commit_id":"0d0e57697f162da4aa218b5feafe614fb666db07","commit_message":"From 0d0e57697f162da4aa218b5feafe614fb666db07 Mon Sep 17 00:00:00 2001\nFrom: Daniel Borkmann <daniel@iogearbox.net>\nDate: Mon, 8 May 2017 00:04:09 +0200\nSubject: [PATCH] bpf: don't let ldimm64 leak map addresses on unprivileged\n\nThe patch fixes two things at once:\n\n1) It checks the env->allow_ptr_leaks and only prints the map address to\n   the log if we have the privileges to do so, otherwise it just dumps 0\n   as we would when kptr_restrict is enabled on %pK. Given the latter is\n   off by default and not every distro sets it, I don't want to rely on\n   this, hence the 0 by default for unprivileged.\n\n2) Printing of ldimm64 in the verifier log is currently broken in that\n   we don't print the full immediate, but only the 32 bit part of the\n   first insn part for ldimm64. Thus, fix this up as well; it's okay to\n   access, since we verified all ldimm64 earlier already (including just\n   constants) through replace_map_fd_with_map_ptr().\n\nFixes: 1be7f75d1668 (\"bpf: enable non-root eBPF programs\")\nFixes: cbd357008604 (\"bpf: verifier (add ability to receive verification log)\")\nReported-by: Jann Horn <jannh@google.com>\nSigned-off-by: Daniel Borkmann <daniel@iogearbox.net>\nAcked-by: Alexei Starovoitov <ast@kernel.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n kernel\/bpf\/verifier.c | 21 ++++++++++++++++-----\n 1 file changed, 16 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/kernel\/bpf\/verifier.c b\/kernel\/bpf\/verifier.c\nindex c2ff608c1984e..c5b56c92f8e25 100644\n--- a\/kernel\/bpf\/verifier.c\n+++ b\/kernel\/bpf\/verifier.c\n@@ -298,7 +298,8 @@ static const char *const bpf_jmp_string[16] = {\n \t[BPF_EXIT >> 4] = \"exit\",\n };\n \n-static void print_bpf_insn(struct bpf_insn *insn)\n+static void print_bpf_insn(const struct bpf_verifier_env *env,\n+\t\t\t   const struct bpf_insn *insn)\n {\n \tu8 class = BPF_CLASS(insn->code);\n \n@@ -362,9 +363,19 @@ static void print_bpf_insn(struct bpf_insn *insn)\n \t\t\t\tinsn->code,\n \t\t\t\tbpf_ldst_string[BPF_SIZE(insn->code) >> 3],\n \t\t\t\tinsn->src_reg, insn->imm);\n-\t\t} else if (BPF_MODE(insn->code) == BPF_IMM) {\n-\t\t\tverbose(\"(%02x) r%d = 0x%x\\n\",\n-\t\t\t\tinsn->code, insn->dst_reg, insn->imm);\n+\t\t} else if (BPF_MODE(insn->code) == BPF_IMM &&\n+\t\t\t   BPF_SIZE(insn->code) == BPF_DW) {\n+\t\t\t\/* At this point, we already made sure that the second\n+\t\t\t * part of the ldimm64 insn is accessible.\n+\t\t\t *\/\n+\t\t\tu64 imm = ((u64)(insn + 1)->imm << 32) | (u32)insn->imm;\n+\t\t\tbool map_ptr = insn->src_reg == BPF_PSEUDO_MAP_FD;\n+\n+\t\t\tif (map_ptr && !env->allow_ptr_leaks)\n+\t\t\t\timm = 0;\n+\n+\t\t\tverbose(\"(%02x) r%d = 0x%llx\\n\", insn->code,\n+\t\t\t\tinsn->dst_reg, (unsigned long long)imm);\n \t\t} else {\n \t\t\tverbose(\"BUG_ld_%02x\\n\", insn->code);\n \t\t\treturn;\n@@ -2853,7 +2864,7 @@ static int do_check(struct bpf_verifier_env *env)\n \n \t\tif (log_level) {\n \t\t\tverbose(\"%d: \", insn_idx);\n-\t\t\tprint_bpf_insn(insn);\n+\t\t\tprint_bpf_insn(env, insn);\n \t\t}\n \n \t\terr = ext_analyzer_insn_hook(env, insn_idx, prev_insn_idx);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-0702","CWE_ID":"200","category":"security","commit_id":"708dc2f1291e104fe4eef810bb8ffc1fae5b19c1","commit_message":"From 708dc2f1291e104fe4eef810bb8ffc1fae5b19c1 Mon Sep 17 00:00:00 2001\nFrom: Andy Polyakov <appro@openssl.org>\nDate: Mon, 25 Jan 2016 20:38:38 +0100\nSubject: [PATCH] bn\/bn_exp.c: constant-time MOD_EXP_CTIME_COPY_FROM_PREBUF.\n\nPerformance penalty varies from platform to platform, and even\nkey length. For rsa2048 sign it was observed to reach almost 10%.\n\nCVE-2016-0702\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(cherry picked from master)\n\nResolved conflicts:\n\tcrypto\/bn\/bn_exp.c\n---\n crypto\/bn\/bn_exp.c | 75 +++++++++++++++++++++++++++++++++++-----------\n 1 file changed, 57 insertions(+), 18 deletions(-)\n\n","diff_code":"diff --git a\/crypto\/bn\/bn_exp.c b\/crypto\/bn\/bn_exp.c\nindex 6d30d1e0ff..c3d575fe77 100644\n--- a\/crypto\/bn\/bn_exp.c\n+++ b\/crypto\/bn\/bn_exp.c\n@@ -110,6 +110,7 @@\n  *\/\n \n #include \"cryptlib.h\"\n+#include \"constant_time_locl.h\"\n #include \"bn_lcl.h\"\n \n #include <stdlib.h>\n@@ -606,15 +607,17 @@ static BN_ULONG bn_get_bits(const BIGNUM *a, int bitpos)\n \n static int MOD_EXP_CTIME_COPY_TO_PREBUF(const BIGNUM *b, int top,\n                                         unsigned char *buf, int idx,\n-                                        int width)\n+                                        int window)\n {\n-    size_t i, j;\n+    int i, j;\n+    int width = 1 << window;\n+    BN_ULONG *table = (BN_ULONG *)buf;\n \n     if (top > b->top)\n         top = b->top;           \/* this works because 'buf' is explicitly\n                                  * zeroed *\/\n-    for (i = 0, j = idx; i < top * sizeof b->d[0]; i++, j += width) {\n-        buf[j] = ((unsigned char *)b->d)[i];\n+    for (i = 0, j = idx; i < top; i++, j += width) {\n+        table[j] = b->d[i];\n     }\n \n     return 1;\n@@ -622,15 +625,51 @@ static int MOD_EXP_CTIME_COPY_TO_PREBUF(const BIGNUM *b, int top,\n \n static int MOD_EXP_CTIME_COPY_FROM_PREBUF(BIGNUM *b, int top,\n                                           unsigned char *buf, int idx,\n-                                          int width)\n+                                          int window)\n {\n-    size_t i, j;\n+    int i, j;\n+    int width = 1 << window;\n+    volatile BN_ULONG *table = (volatile BN_ULONG *)buf;\n \n     if (bn_wexpand(b, top) == NULL)\n         return 0;\n \n-    for (i = 0, j = idx; i < top * sizeof b->d[0]; i++, j += width) {\n-        ((unsigned char *)b->d)[i] = buf[j];\n+    if (window <= 3) {\n+        for (i = 0; i < top; i++, table += width) {\n+            BN_ULONG acc = 0;\n+\n+            for (j = 0; j < width; j++) {\n+                acc |= table[j] &\n+                       ((BN_ULONG)0 - (constant_time_eq_int(j,idx)&1));\n+            }\n+\n+            b->d[i] = acc;\n+        }\n+    } else {\n+        int xstride = 1 << (window - 2);\n+        BN_ULONG y0, y1, y2, y3;\n+\n+        i = idx >> (window - 2);        \/* equivalent of idx \/ xstride *\/\n+        idx &= xstride - 1;             \/* equivalent of idx % xstride *\/\n+\n+        y0 = (BN_ULONG)0 - (constant_time_eq_int(i,0)&1);\n+        y1 = (BN_ULONG)0 - (constant_time_eq_int(i,1)&1);\n+        y2 = (BN_ULONG)0 - (constant_time_eq_int(i,2)&1);\n+        y3 = (BN_ULONG)0 - (constant_time_eq_int(i,3)&1);\n+\n+        for (i = 0; i < top; i++, table += width) {\n+            BN_ULONG acc = 0;\n+\n+            for (j = 0; j < xstride; j++) {\n+                acc |= ( (table[j + 0 * xstride] & y0) |\n+                         (table[j + 1 * xstride] & y1) |\n+                         (table[j + 2 * xstride] & y2) |\n+                         (table[j + 3 * xstride] & y3) )\n+                       & ((BN_ULONG)0 - (constant_time_eq_int(j,idx)&1));\n+            }\n+\n+            b->d[i] = acc;\n+        }\n     }\n \n     b->top = top;\n@@ -1065,9 +1104,9 @@ int BN_mod_exp_mont_consttime(BIGNUM *rr, const BIGNUM *a, const BIGNUM *p,\n     } else\n #endif\n     {\n-        if (!MOD_EXP_CTIME_COPY_TO_PREBUF(&tmp, top, powerbuf, 0, numPowers))\n+        if (!MOD_EXP_CTIME_COPY_TO_PREBUF(&tmp, top, powerbuf, 0, window))\n             goto err;\n-        if (!MOD_EXP_CTIME_COPY_TO_PREBUF(&am, top, powerbuf, 1, numPowers))\n+        if (!MOD_EXP_CTIME_COPY_TO_PREBUF(&am, top, powerbuf, 1, window))\n             goto err;\n \n         \/*\n@@ -1079,15 +1118,15 @@ int BN_mod_exp_mont_consttime(BIGNUM *rr, const BIGNUM *a, const BIGNUM *p,\n         if (window > 1) {\n             if (!BN_mod_mul_montgomery(&tmp, &am, &am, mont, ctx))\n                 goto err;\n-            if (!MOD_EXP_CTIME_COPY_TO_PREBUF\n-                (&tmp, top, powerbuf, 2, numPowers))\n+            if (!MOD_EXP_CTIME_COPY_TO_PREBUF(&tmp, top, powerbuf, 2,\n+                                              window))\n                 goto err;\n             for (i = 3; i < numPowers; i++) {\n                 \/* Calculate a^i = a^(i-1) * a *\/\n                 if (!BN_mod_mul_montgomery(&tmp, &am, &tmp, mont, ctx))\n                     goto err;\n-                if (!MOD_EXP_CTIME_COPY_TO_PREBUF\n-                    (&tmp, top, powerbuf, i, numPowers))\n+                if (!MOD_EXP_CTIME_COPY_TO_PREBUF(&tmp, top, powerbuf, i,\n+                                                  window))\n                     goto err;\n             }\n         }\n@@ -1095,8 +1134,8 @@ int BN_mod_exp_mont_consttime(BIGNUM *rr, const BIGNUM *a, const BIGNUM *p,\n         bits--;\n         for (wvalue = 0, i = bits % window; i >= 0; i--, bits--)\n             wvalue = (wvalue << 1) + BN_is_bit_set(p, bits);\n-        if (!MOD_EXP_CTIME_COPY_FROM_PREBUF\n-            (&tmp, top, powerbuf, wvalue, numPowers))\n+        if (!MOD_EXP_CTIME_COPY_FROM_PREBUF(&tmp, top, powerbuf, wvalue,\n+                                            window))\n             goto err;\n \n         \/*\n@@ -1116,8 +1155,8 @@ int BN_mod_exp_mont_consttime(BIGNUM *rr, const BIGNUM *a, const BIGNUM *p,\n             \/*\n              * Fetch the appropriate pre-computed value from the pre-buf\n              *\/\n-            if (!MOD_EXP_CTIME_COPY_FROM_PREBUF\n-                (&am, top, powerbuf, wvalue, numPowers))\n+            if (!MOD_EXP_CTIME_COPY_FROM_PREBUF(&am, top, powerbuf, wvalue,\n+                                                window))\n                 goto err;\n \n             \/* Multiply the result into the intermediate result *\/\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2009-3002","CWE_ID":"200","category":"security","commit_id":"80922bbb12a105f858a8f0abb879cb4302d0ecaa","commit_message":"From 80922bbb12a105f858a8f0abb879cb4302d0ecaa Mon Sep 17 00:00:00 2001\nFrom: Eric Dumazet <eric.dumazet@gmail.com>\nDate: Thu, 6 Aug 2009 03:48:36 +0000\nSubject: econet: Fix econet_getname() leak\n\neconet_getname() can leak kernel memory to user.\n\nSigned-off-by: Eric Dumazet <eric.dumazet@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/econet\/af_econet.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/econet\/af_econet.c b\/net\/econet\/af_econet.c\nindex 2e1f836d4240..f0bbc57926cd 100644\n--- a\/net\/econet\/af_econet.c\n+++ b\/net\/econet\/af_econet.c\n@@ -520,6 +520,7 @@ static int econet_getname(struct socket *sock, struct sockaddr *uaddr,\n \tif (peer)\n \t\treturn -EOPNOTSUPP;\n \n+\tmemset(sec, 0, sizeof(*sec));\n \tmutex_lock(&econet_mutex);\n \n \tsk = sock->sk;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"mjg59","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2010-3881","CWE_ID":"200","category":"security","commit_id":"97e69aa62f8b5d338d6cff49be09e37cc1262838","commit_message":"From 97e69aa62f8b5d338d6cff49be09e37cc1262838 Mon Sep 17 00:00:00 2001\nFrom: Vasiliy Kulikov <segooon@gmail.com>\nDate: Sat, 30 Oct 2010 22:54:47 +0400\nSubject: KVM: x86: fix information leak to userland\n\nStructures kvm_vcpu_events, kvm_debugregs, kvm_pit_state2 and\nkvm_clock_data are copied to userland with some padding and reserved\nfields unitialized.  It leads to leaking of contents of kernel stack\nmemory.  We have to initialize them to zero.\n\nIn patch v1 Jan Kiszka suggested to fill reserved fields with zeros\ninstead of memset'ting the whole struct.  It makes sense as these\nfields are explicitly marked as padding.  No more fields need zeroing.\n\nKVM-Stable-Tag.\nSigned-off-by: Vasiliy Kulikov <segooon@gmail.com>\nSigned-off-by: Marcelo Tosatti <mtosatti@redhat.com>\n---\n arch\/x86\/kvm\/x86.c | 6 ++++++\n 1 file changed, 6 insertions(+)\n\n","diff_code":"diff --git a\/arch\/x86\/kvm\/x86.c b\/arch\/x86\/kvm\/x86.c\nindex b0818f672064..463c65b8f93f 100644\n--- a\/arch\/x86\/kvm\/x86.c\n+++ b\/arch\/x86\/kvm\/x86.c\n@@ -2560,6 +2560,7 @@ static void kvm_vcpu_ioctl_x86_get_vcpu_events(struct kvm_vcpu *vcpu,\n \t\t!kvm_exception_is_soft(vcpu->arch.exception.nr);\n \tevents->exception.nr = vcpu->arch.exception.nr;\n \tevents->exception.has_error_code = vcpu->arch.exception.has_error_code;\n+\tevents->exception.pad = 0;\n \tevents->exception.error_code = vcpu->arch.exception.error_code;\n \n \tevents->interrupt.injected =\n@@ -2573,12 +2574,14 @@ static void kvm_vcpu_ioctl_x86_get_vcpu_events(struct kvm_vcpu *vcpu,\n \tevents->nmi.injected = vcpu->arch.nmi_injected;\n \tevents->nmi.pending = vcpu->arch.nmi_pending;\n \tevents->nmi.masked = kvm_x86_ops->get_nmi_mask(vcpu);\n+\tevents->nmi.pad = 0;\n \n \tevents->sipi_vector = vcpu->arch.sipi_vector;\n \n \tevents->flags = (KVM_VCPUEVENT_VALID_NMI_PENDING\n \t\t\t | KVM_VCPUEVENT_VALID_SIPI_VECTOR\n \t\t\t | KVM_VCPUEVENT_VALID_SHADOW);\n+\tmemset(&events->reserved, 0, sizeof(events->reserved));\n }\n \n static int kvm_vcpu_ioctl_x86_set_vcpu_events(struct kvm_vcpu *vcpu,\n@@ -2623,6 +2626,7 @@ static void kvm_vcpu_ioctl_x86_get_debugregs(struct kvm_vcpu *vcpu,\n \tdbgregs->dr6 = vcpu->arch.dr6;\n \tdbgregs->dr7 = vcpu->arch.dr7;\n \tdbgregs->flags = 0;\n+\tmemset(&dbgregs->reserved, 0, sizeof(dbgregs->reserved));\n }\n \n static int kvm_vcpu_ioctl_x86_set_debugregs(struct kvm_vcpu *vcpu,\n@@ -3106,6 +3110,7 @@ static int kvm_vm_ioctl_get_pit2(struct kvm *kvm, struct kvm_pit_state2 *ps)\n \t\tsizeof(ps->channels));\n \tps->flags = kvm->arch.vpit->pit_state.flags;\n \tmutex_unlock(&kvm->arch.vpit->pit_state.lock);\n+\tmemset(&ps->reserved, 0, sizeof(ps->reserved));\n \treturn r;\n }\n \n@@ -3486,6 +3491,7 @@ long kvm_arch_vm_ioctl(struct file *filp,\n \t\tuser_ns.clock = kvm->arch.kvmclock_offset + now_ns;\n \t\tlocal_irq_enable();\n \t\tuser_ns.flags = 0;\n+\t\tmemset(&user_ns.pad, 0, sizeof(user_ns.pad));\n \n \t\tr = -EFAULT;\n \t\tif (copy_to_user(argp, &user_ns, sizeof(user_ns)))\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-15132","CWE_ID":"200","category":"security","commit_id":"f151e048ed27f6f4eef729f3310d053ab5da71d4","commit_message":"From f151e048ed27f6f4eef729f3310d053ab5da71d4 Mon Sep 17 00:00:00 2001\nFrom: Anatol Belski <ab@php.net>\nDate: Tue, 3 Jul 2018 14:04:22 +0200\nSubject: [PATCH] Fixed bug #76459 windows linkinfo lacks openbasedir check\n\n---\n ext\/standard\/link_win32.c | 11 +++++++++++\n 1 file changed, 11 insertions(+)\n\n","diff_code":"diff --git a\/ext\/standard\/link_win32.c b\/ext\/standard\/link_win32.c\nindex 13ee88dfade5..0068a3edb1c6 100644\n--- a\/ext\/standard\/link_win32.c\n+++ b\/ext\/standard\/link_win32.c\n@@ -87,6 +87,7 @@ PHP_FUNCTION(readlink)\n PHP_FUNCTION(linkinfo)\n {\n \tchar *link;\n+\tchar *dirname;\n \tsize_t link_len;\n \tzend_stat_t sb;\n \tint ret;\n@@ -95,12 +96,22 @@ PHP_FUNCTION(linkinfo)\n \t\treturn;\n \t}\n \n+\tdirname = estrndup(link, link_len);\n+\tphp_dirname(dirname, link_len);\n+\n+\tif (php_check_open_basedir(dirname)) {\n+\t\tefree(dirname);\n+\t\tRETURN_FALSE;\n+\t}\n+\n \tret = VCWD_STAT(link, &sb);\n \tif (ret == -1) {\n \t\tphp_error_docref(NULL, E_WARNING, \"%s\", strerror(errno));\n+\t\tefree(dirname);\n \t\tRETURN_LONG(Z_L(-1));\n \t}\n \n+\tefree(dirname);\n \tRETURN_LONG((zend_long) sb.st_dev);\n }\n \/* }}} *\/\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2011-1173","CWE_ID":"200","category":"security","commit_id":"67c5c6cb8129c595f21e88254a3fc6b3b841ae8e","commit_message":"From 67c5c6cb8129c595f21e88254a3fc6b3b841ae8e Mon Sep 17 00:00:00 2001\nFrom: Vasiliy Kulikov <segoon@openwall.com>\nDate: Thu, 17 Mar 2011 01:40:10 +0000\nSubject: econet: 4 byte infoleak to the network\n\nstruct aunhdr has 4 padding bytes between 'pad' and 'handle' fields on\nx86_64.  These bytes are not initialized in the variable 'ah' before\nsending 'ah' to the network.  This leads to 4 bytes kernel stack\ninfoleak.\n\nThis bug was introduced before the git epoch.\n\nSigned-off-by: Vasiliy Kulikov <segoon@openwall.com>\nAcked-by: Phil Blundell <philb@gnu.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/econet\/af_econet.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/econet\/af_econet.c b\/net\/econet\/af_econet.c\nindex 0c2826337919..116d3fd3d669 100644\n--- a\/net\/econet\/af_econet.c\n+++ b\/net\/econet\/af_econet.c\n@@ -435,10 +435,10 @@ static int econet_sendmsg(struct kiocb *iocb, struct socket *sock,\n \t\tudpdest.sin_addr.s_addr = htonl(network | addr.station);\n \t}\n \n+\tmemset(&ah, 0, sizeof(ah));\n \tah.port = port;\n \tah.cb = cb & 0x7f;\n \tah.code = 2;\t\t\/* magic *\/\n-\tah.pad = 0;\n \n \t\/* tack our header on the front of the iovec *\/\n \tsize = sizeof(struct aunhdr);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2012-6549","CWE_ID":"200","category":"security","commit_id":"fe685aabf7c8c9f138e5ea900954d295bf229175","commit_message":"From fe685aabf7c8c9f138e5ea900954d295bf229175 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Thu, 12 Jul 2012 08:46:54 +0200\nSubject: isofs: avoid info leak on export\n\nFor type 1 the parent_offset member in struct isofs_fid gets copied\nuninitialized to userland. Fix this by initializing it to 0.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: Jan Kara <jack@suse.cz>\n---\n fs\/isofs\/export.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/fs\/isofs\/export.c b\/fs\/isofs\/export.c\nindex aa4356d09eee..1d3804492aa7 100644\n--- a\/fs\/isofs\/export.c\n+++ b\/fs\/isofs\/export.c\n@@ -134,6 +134,7 @@ isofs_export_encode_fh(struct inode *inode,\n \tlen = 3;\n \tfh32[0] = ei->i_iget5_block;\n  \tfh16[2] = (__u16)ei->i_iget5_offset;  \/* fh16 [sic] *\/\n+\tfh16[3] = 0;  \/* avoid leaking uninitialized data *\/\n \tfh32[2] = inode->i_generation;\n \tif (parent) {\n \t\tstruct iso_inode_info *eparent;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-3236","CWE_ID":"200","category":"security","commit_id":"680d04e0ba7e926233e3b9cee59125ce181f66ba","commit_message":"From 680d04e0ba7e926233e3b9cee59125ce181f66ba Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:52:01 +0000\nSubject: [PATCH] VSOCK: vmci - fix possible info leak in\n vmci_transport_dgram_dequeue()\n\nIn case we received no data on the call to skb_recv_datagram(), i.e.\nskb->data is NULL, vmci_transport_dgram_dequeue() will return with 0\nwithout updating msg_namelen leading to net\/socket.c leaking the local,\nuninitialized sockaddr_storage variable to userland -- 128 bytes of\nkernel stack memory.\n\nFix this by moving the already existing msg_namelen assignment a few\nlines above.\n\nCc: Andy King <acking@vmware.com>\nCc: Dmitry Torokhov <dtor@vmware.com>\nCc: George Zhang <georgezhang@vmware.com>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/vmw_vsock\/vmci_transport.c | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/vmw_vsock\/vmci_transport.c b\/net\/vmw_vsock\/vmci_transport.c\nindex 1f6508e249ae5..5e04d3d96285d 100644\n--- a\/net\/vmw_vsock\/vmci_transport.c\n+++ b\/net\/vmw_vsock\/vmci_transport.c\n@@ -1736,6 +1736,8 @@ static int vmci_transport_dgram_dequeue(struct kiocb *kiocb,\n \tif (flags & MSG_OOB || flags & MSG_ERRQUEUE)\n \t\treturn -EOPNOTSUPP;\n \n+\tmsg->msg_namelen = 0;\n+\n \t\/* Retrieve the head sk_buff from the socket's receive queue. *\/\n \terr = 0;\n \tskb = skb_recv_datagram(&vsk->sk, flags, noblock, &err);\n@@ -1768,7 +1770,6 @@ static int vmci_transport_dgram_dequeue(struct kiocb *kiocb,\n \tif (err)\n \t\tgoto out;\n \n-\tmsg->msg_namelen = 0;\n \tif (msg->msg_name) {\n \t\tstruct sockaddr_vm *vm_addr;\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-9178","CWE_ID":"200","category":"security","commit_id":"1c109fabbd51863475cd12ac206bdd249aee35af","commit_message":"From 1c109fabbd51863475cd12ac206bdd249aee35af Mon Sep 17 00:00:00 2001\nFrom: Al Viro <viro@ZenIV.linux.org.uk>\nDate: Thu, 15 Sep 2016 02:35:29 +0100\nSubject: [PATCH] fix minor infoleak in get_user_ex()\n\nget_user_ex(x, ptr) should zero x on failure.  It's not a lot of a leak\n(at most we are leaking uninitialized 64bit value off the kernel stack,\nand in a fairly constrained situation, at that), but the fix is trivial,\nso...\n\nCc: stable@vger.kernel.org\nSigned-off-by: Al Viro <viro@zeniv.linux.org.uk>\n[ This sat in different branch from the uaccess fixes since mid-August ]\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n arch\/x86\/include\/asm\/uaccess.h | 6 +++++-\n 1 file changed, 5 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/arch\/x86\/include\/asm\/uaccess.h b\/arch\/x86\/include\/asm\/uaccess.h\nindex e3af86f58eafd..2131c4ce7d8a1 100644\n--- a\/arch\/x86\/include\/asm\/uaccess.h\n+++ b\/arch\/x86\/include\/asm\/uaccess.h\n@@ -433,7 +433,11 @@ do {\t\t\t\t\t\t\t\t\t\\\n #define __get_user_asm_ex(x, addr, itype, rtype, ltype)\t\t\t\\\n \tasm volatile(\"1:\tmov\"itype\" %1,%\"rtype\"0\\n\"\t\t\\\n \t\t     \"2:\\n\"\t\t\t\t\t\t\\\n-\t\t     _ASM_EXTABLE_EX(1b, 2b)\t\t\t\t\\\n+\t\t     \".section .fixup,\\\"ax\\\"\\n\"\t\t\t\t\\\n+                     \"3:xor\"itype\" %\"rtype\"0,%\"rtype\"0\\n\"\t\t\\\n+\t\t     \"  jmp 2b\\n\"\t\t\t\t\t\\\n+\t\t     \".previous\\n\"\t\t\t\t\t\\\n+\t\t     _ASM_EXTABLE_EX(1b, 3b)\t\t\t\t\\\n \t\t     : ltype(x) : \"m\" (__m(addr)))\n \n #define __put_user_nocheck(x, ptr, size)\t\t\t\\\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-3493","CWE_ID":"200","category":"security","commit_id":"d2f339726d9a0adff075f7548232e2ca0c81a2f6","commit_message":"From d2f339726d9a0adff075f7548232e2ca0c81a2f6 Mon Sep 17 00:00:00 2001\nFrom: Matthew Farrellee <matt@redhat.com>\nDate: Fri, 10 Aug 2012 10:09:25 -0400\nSubject: [PATCH] Remove unused GIVE_REQUEST_AD command from the startd, #3169\n\nNote: dos2unix was run on command.h for a clean cherry-pick from master\n\nSigned-off-by: Jaime Frey <jfrey@cs.wisc.edu>\n---\n src\/condor_startd.V6\/command.cpp     | 44 ------------------------------------\n src\/condor_startd.V6\/command.h       |  2 +-\n src\/condor_startd.V6\/startd_main.cpp |  3 ---\n 3 files changed, 1 insertion(+), 48 deletions(-)\n\n","diff_code":"diff --git a\/src\/condor_startd.V6\/command.cpp b\/src\/condor_startd.V6\/command.cpp\nindex bbc279a..438827e 100644\n--- a\/src\/condor_startd.V6\/command.cpp\n+++ b\/src\/condor_startd.V6\/command.cpp\n@@ -545,50 +545,6 @@ command_match_info( Service*, int cmd, Stream* stream )\n \n \n int\n-command_give_request_ad( Service*, int, Stream* stream) \n-{\n-\tint pid = -1;  \/\/ Starter sends it's pid so we know what\n-\t\t\t\t   \/\/ resource's request ad to send \n-\tClaim*\t\tclaim;\n-\tClassAd*\tcp;\n-\n-\tif( ! stream->code(pid) ) {\n-\t\tdprintf( D_ALWAYS, \"give_request_ad: Can't read pid\\n\" );\n-\t\tstream->encode();\n-\t\tstream->end_of_message();\n-\t\treturn FALSE;\n-\t}\n-\tif( ! stream->end_of_message() ) {\n-\t\tdprintf( D_ALWAYS, \"give_request_ad: Can't read eom\\n\" );\n-\t\tstream->encode();\n-\t\tstream->end_of_message();\n-\t\treturn FALSE;\n-\t}\n-\tclaim = resmgr->getClaimByPid( pid );\n-\tif( !claim ) {\n-\t\tdprintf( D_ALWAYS, \n-\t\t\t\t \"give_request_ad: Can't find starter with pid %d\\n\",\n-\t\t\t\t pid ); \n-\t\tstream->encode();\n-\t\tstream->end_of_message();\n-\t\treturn FALSE;\n-\t}\n-\tcp = claim->ad();\n-\tif( !cp ) {\n-\t\tclaim->dprintf( D_ALWAYS, \n-\t\t\t\t\t\t\"give_request_ad: current claim has NULL classad.\\n\" );\n-\t\tstream->encode();\n-\t\tstream->end_of_message();\n-\t\treturn FALSE;\n-\t}\n-\tstream->encode();\n-\tcp->put( *stream );\n-\tstream->end_of_message();\n-\treturn TRUE;\n-}\n-\n-\n-int\n command_query_ads( Service*, int, Stream* stream) \n {\n \tClassAd queryAd;\ndiff --git a\/src\/condor_startd.V6\/command.h b\/src\/condor_startd.V6\/command.h\nindex d0b18ba..9342938 100644\n--- a\/src\/condor_startd.V6\/command.h\n+++ b\/src\/condor_startd.V6\/command.h\n@@ -83,7 +83,7 @@ int command_name_handler( Service*, int, Stream* );\n    Command handler for dealing w\/ ClassAd-only protocol commands\n *\/\n int command_classad_handler( Service*, int, Stream* );\n-\n+\n \/*\n   Since the protocol is complex and what we have to do so\n   complicated, these functions are here that actually do the work of \ndiff --git a\/src\/condor_startd.V6\/startd_main.cpp b\/src\/condor_startd.V6\/startd_main.cpp\nindex 0f8be91..c6f0b68 100644\n--- a\/src\/condor_startd.V6\/startd_main.cpp\n+++ b\/src\/condor_startd.V6\/startd_main.cpp\n@@ -273,9 +273,6 @@ main_init( int, char* argv[] )\n \t\t\t\t\t\t\t\t  \"GIVE_TOTALS_CLASSAD\",\n \t\t\t\t\t\t\t\t  (CommandHandler)command_give_totals_classad,\n \t\t\t\t\t\t\t\t  \"command_give_totals_classad\", 0, READ );\n-\tdaemonCore->Register_Command( GIVE_REQUEST_AD, \"GIVE_REQUEST_AD\",\n-\t\t\t\t\t\t\t\t  (CommandHandler)command_give_request_ad,\n-\t\t\t\t\t\t\t\t  \"command_give_request_ad\", 0, READ );\n \tdaemonCore->Register_Command( QUERY_STARTD_ADS, \"QUERY_STARTD_ADS\",\n \t\t\t\t\t\t\t\t  (CommandHandler)command_query_ads,\n \t\t\t\t\t\t\t\t  \"command_query_ads\", 0, READ );\n-- \n1.7.12.4\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-0379","CWE_ID":"200","category":"security","commit_id":"da780c8183cccc8f533c8ace8211ac2cb2bdee7b","commit_message":"From da780c8183cccc8f533c8ace8211ac2cb2bdee7b Mon Sep 17 00:00:00 2001\nFrom: NIIBE Yutaka <gniibe@fsij.org>\nDate: Fri, 25 Aug 2017 18:13:28 +0900\nSubject: [PATCH] ecc: Add input validation for X25519.\n\n* cipher\/ecc.c (ecc_decrypt_raw): Add input validation.\n* mpi\/ec.c (ec_p_init): Use scratch buffer for bad points.\n(_gcry_mpi_ec_bad_point): New.\n\n--\n\nFollowing is the paper describing the attack:\n\n    May the Fourth Be With You: A Microarchitectural Side Channel Attack\n    on Real-World Applications of Curve25519\n    by Daniel Genkin, Luke Valenta, and Yuval Yarom\n\nIn the current implementation, we do output checking and it results an\nerror for those bad points.  However, when attacked, the computation\nwill done with leak of private key, even it will results errors.  To\nmitigate leak, we added input validation.\n\nNote that we only list bad points with MSB=0.  By X25519, MSB is\nalways cleared.\n\nIn future, we should implement constant-time field computation.  Then,\nthis input validation could be removed, if performance is important\nand we are sure for no leak.\n\nCVE-id: CVE-2017-0379\nSigned-off-by: NIIBE Yutaka <gniibe@fsij.org>\n(cherry picked from commit bf76acbf0da6b0f245e491bec12c0f0a1b5be7c9)\n---\n cipher\/ecc.c | 17 +++++++++++++++--\n mpi\/ec.c     | 51 ++++++++++++++++++++++++++++++++++++++++++++++++---\n src\/mpi.h    |  1 +\n 3 files changed, 64 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/cipher\/ecc.c b\/cipher\/ecc.c\nindex e25bf095..4e3e5b1a 100644\n--- a\/cipher\/ecc.c\n+++ b\/cipher\/ecc.c\n@@ -1628,9 +1628,22 @@ ecc_decrypt_raw (gcry_sexp_t *r_plain, gcry_sexp_t s_data, gcry_sexp_t keyparms)\n   if (DBG_CIPHER)\n     log_printpnt (\"ecc_decrypt    kG\", &kG, NULL);\n \n-  if (!(flags & PUBKEY_FLAG_DJB_TWEAK)\n+  if ((flags & PUBKEY_FLAG_DJB_TWEAK))\n+    {\n       \/* For X25519, by its definition, validation should not be done.  *\/\n-      && !_gcry_mpi_ec_curve_point (&kG, ec))\n+      \/* (Instead, we do output check.)\n+       *\n+       * However, to mitigate secret key leak from our implementation,\n+       * we also do input validation here.  For constant-time\n+       * implementation, we can remove this input validation.\n+       *\/\n+      if (_gcry_mpi_ec_bad_point (&kG, ec))\n+        {\n+          rc = GPG_ERR_INV_DATA;\n+          goto leave;\n+        }\n+    }\n+  else if (!_gcry_mpi_ec_curve_point (&kG, ec))\n     {\n       rc = GPG_ERR_INV_DATA;\n       goto leave;\ndiff --git a\/mpi\/ec.c b\/mpi\/ec.c\nindex 3ac0547f..1469339c 100644\n--- a\/mpi\/ec.c\n+++ b\/mpi\/ec.c\n@@ -382,6 +382,29 @@ ec_get_two_inv_p (mpi_ec_t ec)\n }\n \n \n+static const char *curve25519_bad_points[] = {\n+  \"0x0000000000000000000000000000000000000000000000000000000000000000\",\n+  \"0x0000000000000000000000000000000000000000000000000000000000000001\",\n+  \"0x00b8495f16056286fdb1329ceb8d09da6ac49ff1fae35616aeb8413b7c7aebe0\",\n+  \"0x57119fd0dd4e22d8868e1c58c45c44045bef839c55b1d0b1248c50a3bc959c5f\",\n+  \"0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec\",\n+  \"0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed\",\n+  \"0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffee\",\n+  NULL\n+};\n+\n+static gcry_mpi_t\n+scanval (const char *string)\n+{\n+  gpg_err_code_t rc;\n+  gcry_mpi_t val;\n+\n+  rc = _gcry_mpi_scan (&val, GCRYMPI_FMT_HEX, string, 0, NULL);\n+  if (rc)\n+    log_fatal (\"scanning ECC parameter failed: %s\\n\", gpg_strerror (rc));\n+  return val;\n+}\n+\n \n \/* This function initialized a context for elliptic curve based on the\n    field GF(p).  P is the prime specifying this field, A is the first\n@@ -420,9 +443,17 @@ ec_p_init (mpi_ec_t ctx, enum gcry_mpi_ec_models model,\n \n   _gcry_mpi_ec_get_reset (ctx);\n \n-  \/* Allocate scratch variables.  *\/\n-  for (i=0; i< DIM(ctx->t.scratch); i++)\n-    ctx->t.scratch[i] = mpi_alloc_like (ctx->p);\n+  if (model == MPI_EC_MONTGOMERY)\n+    {\n+      for (i=0; i< DIM(ctx->t.scratch) && curve25519_bad_points[i]; i++)\n+        ctx->t.scratch[i] = scanval (curve25519_bad_points[i]);\n+    }\n+  else\n+    {\n+      \/* Allocate scratch variables.  *\/\n+      for (i=0; i< DIM(ctx->t.scratch); i++)\n+        ctx->t.scratch[i] = mpi_alloc_like (ctx->p);\n+    }\n \n   \/* Prepare for fast reduction.  *\/\n   \/* FIXME: need a test for NIST values.  However it does not gain us\n@@ -1558,3 +1589,17 @@ _gcry_mpi_ec_curve_point (gcry_mpi_point_t point, mpi_ec_t ctx)\n \n   return res;\n }\n+\n+\n+int\n+_gcry_mpi_ec_bad_point (gcry_mpi_point_t point, mpi_ec_t ctx)\n+{\n+  int i;\n+  gcry_mpi_t x_bad;\n+\n+  for (i = 0; (x_bad = ctx->t.scratch[i]); i++)\n+    if (!mpi_cmp (point->x, x_bad))\n+      return 1;\n+\n+  return 0;\n+}\ndiff --git a\/src\/mpi.h b\/src\/mpi.h\nindex cd539f5c..ea2a4cbe 100644\n--- a\/src\/mpi.h\n+++ b\/src\/mpi.h\n@@ -296,6 +296,7 @@ void _gcry_mpi_ec_mul_point (mpi_point_t result,\n                              gcry_mpi_t scalar, mpi_point_t point,\n                              mpi_ec_t ctx);\n int  _gcry_mpi_ec_curve_point (gcry_mpi_point_t point, mpi_ec_t ctx);\n+int _gcry_mpi_ec_bad_point (gcry_mpi_point_t point, mpi_ec_t ctx);\n \n gcry_mpi_t _gcry_mpi_ec_ec2os (gcry_mpi_point_t point, mpi_ec_t ectx);\n \n-- \n2.11.0\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2012-6544","CWE_ID":"200","category":"security","commit_id":"3f68ba07b1da811bf383b4b701b129bfcb2e4988","commit_message":"From 3f68ba07b1da811bf383b4b701b129bfcb2e4988 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:47 +0000\nSubject: [PATCH] Bluetooth: HCI - Fix info leak via getsockname()\n\nThe HCI code fails to initialize the hci_channel member of struct\nsockaddr_hci and that for leaks two bytes kernel stack via the\ngetsockname() syscall. Initialize hci_channel with 0 to avoid the\ninfo leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Gustavo Padovan <gustavo@padovan.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/bluetooth\/hci_sock.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/bluetooth\/hci_sock.c b\/net\/bluetooth\/hci_sock.c\nindex a27bbc3cd4b7e..19fdac78e555b 100644\n--- a\/net\/bluetooth\/hci_sock.c\n+++ b\/net\/bluetooth\/hci_sock.c\n@@ -694,6 +694,7 @@ static int hci_sock_getname(struct socket *sock, struct sockaddr *addr,\n \t*addr_len = sizeof(*haddr);\n \thaddr->hci_family = AF_BLUETOOTH;\n \thaddr->hci_dev    = hdev->id;\n+\thaddr->hci_channel= 0;\n \n \trelease_sock(sk);\n \treturn 0;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2014-6229","CWE_ID":"200","category":"security","commit_id":"7135ec229882370a00411aa50030eada6034cc1b","commit_message":"From 7135ec229882370a00411aa50030eada6034cc1b Mon Sep 17 00:00:00 2001\nFrom: Owen Yamauchi <oyamauchi@fb.com>\nDate: Wed, 3 Sep 2014 10:07:05 -0700\nSubject: [PATCH] Fix potential security leak in HashContext\n\nSummary: CVE-2014-6229\n\nThis is not a NUL-terminated string, it's a fixed-size block of data.\nThe risks were key truncation (if there happens to be a NUL byte in the\nkey) or over-reading (which would be information leakage).\n\nReviewed By: @ptarjan\n\nDifferential Revision: D1533546\n---\n hphp\/runtime\/ext\/ext_hash.cpp | 7 ++++++-\n 1 file changed, 6 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/hphp\/runtime\/ext\/ext_hash.cpp b\/hphp\/runtime\/ext\/ext_hash.cpp\nindex b4edc4b0fd6..cd55297c531 100644\n--- a\/hphp\/runtime\/ext\/ext_hash.cpp\n+++ b\/hphp\/runtime\/ext\/ext_hash.cpp\n@@ -152,7 +152,12 @@ class HashContext : public SweepableResourceData {\n     context = malloc(ops->context_size);\n     ops->hash_copy(context, ctx->context);\n     options = ctx->options;\n-    key = ctx->key ? strdup(ctx->key) : nullptr;\n+    if (ctx->key) {\n+      key = static_cast<char*>(malloc(ops->block_size));\n+      memcpy(key, ctx->key, ops->block_size);\n+    } else {\n+      key = nullptr;\n+    }\n   }\n \n   ~HashContext() {\n","owner":"facebook","repo":"hhvm","source":"cve"},{"CVE_ID":"CVE-2015-8569","CWE_ID":"200","category":"security","commit_id":"09ccfd238e5a0e670d8178cf50180ea81ae09ae1","commit_message":"From 09ccfd238e5a0e670d8178cf50180ea81ae09ae1 Mon Sep 17 00:00:00 2001\nFrom: WANG Cong <xiyou.wangcong@gmail.com>\nDate: Mon, 14 Dec 2015 13:48:36 -0800\nSubject: pptp: verify sockaddr_len in pptp_bind() and pptp_connect()\n\nReported-by: Dmitry Vyukov <dvyukov@gmail.com>\nSigned-off-by: Cong Wang <xiyou.wangcong@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n drivers\/net\/ppp\/pptp.c | 6 ++++++\n 1 file changed, 6 insertions(+)\n\n","diff_code":"diff --git a\/drivers\/net\/ppp\/pptp.c b\/drivers\/net\/ppp\/pptp.c\nindex fc69e41d0950..597c53e0a2ec 100644\n--- a\/drivers\/net\/ppp\/pptp.c\n+++ b\/drivers\/net\/ppp\/pptp.c\n@@ -419,6 +419,9 @@ static int pptp_bind(struct socket *sock, struct sockaddr *uservaddr,\n \tstruct pptp_opt *opt = &po->proto.pptp;\n \tint error = 0;\n \n+\tif (sockaddr_len < sizeof(struct sockaddr_pppox))\n+\t\treturn -EINVAL;\n+\n \tlock_sock(sk);\n \n \topt->src_addr = sp->sa_addr.pptp;\n@@ -440,6 +443,9 @@ static int pptp_connect(struct socket *sock, struct sockaddr *uservaddr,\n \tstruct flowi4 fl4;\n \tint error = 0;\n \n+\tif (sockaddr_len < sizeof(struct sockaddr_pppox))\n+\t\treturn -EINVAL;\n+\n \tif (sp->sa_protocol != PX_PROTO_PPTP)\n \t\treturn -EINVAL;\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2011-1172","CWE_ID":"200","category":"security","commit_id":"6a8ab060779779de8aea92ce3337ca348f973f54","commit_message":"From 6a8ab060779779de8aea92ce3337ca348f973f54 Mon Sep 17 00:00:00 2001\nFrom: Vasiliy Kulikov <segoon@openwall.com>\nDate: Tue, 15 Mar 2011 13:37:13 +0100\nSubject: ipv6: netfilter: ip6_tables: fix infoleak to userspace\n\nStructures ip6t_replace, compat_ip6t_replace, and xt_get_revision are\ncopied from userspace.  Fields of these structs that are\nzero-terminated strings are not checked.  When they are used as argument\nto a format string containing \"%s\" in request_module(), some sensitive\ninformation is leaked to userspace via argument of spawned modprobe\nprocess.\n\nThe first bug was introduced before the git epoch;  the second was\nintroduced in 3bc3fe5e (v2.6.25-rc1);  the third is introduced by\n6b7d31fc (v2.6.15-rc1).  To trigger the bug one should have\nCAP_NET_ADMIN.\n\nSigned-off-by: Vasiliy Kulikov <segoon@openwall.com>\nSigned-off-by: Patrick McHardy <kaber@trash.net>\n---\n net\/ipv6\/netfilter\/ip6_tables.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/net\/ipv6\/netfilter\/ip6_tables.c b\/net\/ipv6\/netfilter\/ip6_tables.c\nindex 47b7b8df7fac..c9598a9067d7 100644\n--- a\/net\/ipv6\/netfilter\/ip6_tables.c\n+++ b\/net\/ipv6\/netfilter\/ip6_tables.c\n@@ -1275,6 +1275,7 @@ do_replace(struct net *net, const void __user *user, unsigned int len)\n \t\/* overflow check *\/\n \tif (tmp.num_counters >= INT_MAX \/ sizeof(struct xt_counters))\n \t\treturn -ENOMEM;\n+\ttmp.name[sizeof(tmp.name)-1] = 0;\n \n \tnewinfo = xt_alloc_table_info(tmp.size);\n \tif (!newinfo)\n@@ -1822,6 +1823,7 @@ compat_do_replace(struct net *net, void __user *user, unsigned int len)\n \t\treturn -ENOMEM;\n \tif (tmp.num_counters >= INT_MAX \/ sizeof(struct xt_counters))\n \t\treturn -ENOMEM;\n+\ttmp.name[sizeof(tmp.name)-1] = 0;\n \n \tnewinfo = xt_alloc_table_info(tmp.size);\n \tif (!newinfo)\n@@ -2051,6 +2053,7 @@ do_ip6t_get_ctl(struct sock *sk, int cmd, void __user *user, int *len)\n \t\t\tret = -EFAULT;\n \t\t\tbreak;\n \t\t}\n+\t\trev.name[sizeof(rev.name)-1] = 0;\n \n \t\tif (cmd == IP6T_SO_GET_REVISION_TARGET)\n \t\t\ttarget = 1;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2015-8374","CWE_ID":"200","category":"security","commit_id":"0305cd5f7fca85dae392b9ba85b116896eb7c1c7","commit_message":"From 0305cd5f7fca85dae392b9ba85b116896eb7c1c7 Mon Sep 17 00:00:00 2001\nFrom: Filipe Manana <fdmanana@suse.com>\nDate: Fri, 16 Oct 2015 12:34:25 +0100\nSubject: [PATCH] Btrfs: fix truncation of compressed and inlined extents\n\nWhen truncating a file to a smaller size which consists of an inline\nextent that is compressed, we did not discard (or made unusable) the\ndata between the new file size and the old file size, wasting metadata\nspace and allowing for the truncated data to be leaked and the data\ncorruption\/loss mentioned below.\nWe were also not correctly decrementing the number of bytes used by the\ninode, we were setting it to zero, giving a wrong report for callers of\nthe stat(2) syscall. The fsck tool also reported an error about a mismatch\nbetween the nbytes of the file versus the real space used by the file.\n\nNow because we weren't discarding the truncated region of the file, it\nwas possible for a caller of the clone ioctl to actually read the data\nthat was truncated, allowing for a security breach without requiring root\naccess to the system, using only standard filesystem operations. The\nscenario is the following:\n\n   1) User A creates a file which consists of an inline and compressed\n      extent with a size of 2000 bytes - the file is not accessible to\n      any other users (no read, write or execution permission for anyone\n      else);\n\n   2) The user truncates the file to a size of 1000 bytes;\n\n   3) User A makes the file world readable;\n\n   4) User B creates a file consisting of an inline extent of 2000 bytes;\n\n   5) User B issues a clone operation from user A's file into its own\n      file (using a length argument of 0, clone the whole range);\n\n   6) User B now gets to see the 1000 bytes that user A truncated from\n      its file before it made its file world readbale. User B also lost\n      the bytes in the range [1000, 2000[ bytes from its own file, but\n      that might be ok if his\/her intention was reading stale data from\n      user A that was never supposed to be public.\n\nNote that this contrasts with the case where we truncate a file from 2000\nbytes to 1000 bytes and then truncate it back from 1000 to 2000 bytes. In\nthis case reading any byte from the range [1000, 2000[ will return a value\nof 0x00, instead of the original data.\n\nThis problem exists since the clone ioctl was added and happens both with\nand without my recent data loss and file corruption fixes for the clone\nioctl (patch \"Btrfs: fix file corruption and data loss after cloning\ninline extents\").\n\nSo fix this by truncating the compressed inline extents as we do for the\nnon-compressed case, which involves decompressing, if the data isn't already\nin the page cache, compressing the truncated version of the extent, writing\nthe compressed content into the inline extent and then truncate it.\n\nThe following test case for fstests reproduces the problem. In order for\nthe test to pass both this fix and my previous fix for the clone ioctl\nthat forbids cloning a smaller inline extent into a larger one,\nwhich is titled \"Btrfs: fix file corruption and data loss after cloning\ninline extents\", are needed. Without that other fix the test fails in a\ndifferent way that does not leak the truncated data, instead part of\ndestination file gets replaced with zeroes (because the destination file\nhas a larger inline extent than the source).\n\n  seq=`basename $0`\n  seqres=$RESULT_DIR\/$seq\n  echo \"QA output created by $seq\"\n  tmp=\/tmp\/$$\n  status=1\t# failure is the default!\n  trap \"_cleanup; exit \\$status\" 0 1 2 3 15\n\n  _cleanup()\n  {\n      rm -f $tmp.*\n  }\n\n  # get standard environment, filters and checks\n  . .\/common\/rc\n  . .\/common\/filter\n\n  # real QA test starts here\n  _need_to_be_root\n  _supported_fs btrfs\n  _supported_os Linux\n  _require_scratch\n  _require_cloner\n\n  rm -f $seqres.full\n\n  _scratch_mkfs >>$seqres.full 2>&1\n  _scratch_mount \"-o compress\"\n\n  # Create our test files. File foo is going to be the source of a clone operation\n  # and consists of a single inline extent with an uncompressed size of 512 bytes,\n  # while file bar consists of a single inline extent with an uncompressed size of\n  # 256 bytes. For our test's purpose, it's important that file bar has an inline\n  # extent with a size smaller than foo's inline extent.\n  $XFS_IO_PROG -f -c \"pwrite -S 0xa1 0 128\"   \\\n          -c \"pwrite -S 0x2a 128 384\" \\\n          $SCRATCH_MNT\/foo | _filter_xfs_io\n  $XFS_IO_PROG -f -c \"pwrite -S 0xbb 0 256\" $SCRATCH_MNT\/bar | _filter_xfs_io\n\n  # Now durably persist all metadata and data. We do this to make sure that we get\n  # on disk an inline extent with a size of 512 bytes for file foo.\n  sync\n\n  # Now truncate our file foo to a smaller size. Because it consists of a\n  # compressed and inline extent, btrfs did not shrink the inline extent to the\n  # new size (if the extent was not compressed, btrfs would shrink it to 128\n  # bytes), it only updates the inode's i_size to 128 bytes.\n  $XFS_IO_PROG -c \"truncate 128\" $SCRATCH_MNT\/foo\n\n  # Now clone foo's inline extent into bar.\n  # This clone operation should fail with errno EOPNOTSUPP because the source\n  # file consists only of an inline extent and the file's size is smaller than\n  # the inline extent of the destination (128 bytes < 256 bytes). However the\n  # clone ioctl was not prepared to deal with a file that has a size smaller\n  # than the size of its inline extent (something that happens only for compressed\n  # inline extents), resulting in copying the full inline extent from the source\n  # file into the destination file.\n  #\n  # Note that btrfs' clone operation for inline extents consists of removing the\n  # inline extent from the destination inode and copy the inline extent from the\n  # source inode into the destination inode, meaning that if the destination\n  # inode's inline extent is larger (N bytes) than the source inode's inline\n  # extent (M bytes), some bytes (N - M bytes) will be lost from the destination\n  # file. Btrfs could copy the source inline extent's data into the destination's\n  # inline extent so that we would not lose any data, but that's currently not\n  # done due to the complexity that would be needed to deal with such cases\n  # (specially when one or both extents are compressed), returning EOPNOTSUPP, as\n  # it's normally not a very common case to clone very small files (only case\n  # where we get inline extents) and copying inline extents does not save any\n  # space (unlike for normal, non-inlined extents).\n  $CLONER_PROG -s 0 -d 0 -l 0 $SCRATCH_MNT\/foo $SCRATCH_MNT\/bar\n\n  # Now because the above clone operation used to succeed, and due to foo's inline\n  # extent not being shinked by the truncate operation, our file bar got the whole\n  # inline extent copied from foo, making us lose the last 128 bytes from bar\n  # which got replaced by the bytes in range [128, 256[ from foo before foo was\n  # truncated - in other words, data loss from bar and being able to read old and\n  # stale data from foo that should not be possible to read anymore through normal\n  # filesystem operations. Contrast with the case where we truncate a file from a\n  # size N to a smaller size M, truncate it back to size N and then read the range\n  # [M, N[, we should always get the value 0x00 for all the bytes in that range.\n\n  # We expected the clone operation to fail with errno EOPNOTSUPP and therefore\n  # not modify our file's bar data\/metadata. So its content should be 256 bytes\n  # long with all bytes having the value 0xbb.\n  #\n  # Without the btrfs bug fix, the clone operation succeeded and resulted in\n  # leaking truncated data from foo, the bytes that belonged to its range\n  # [128, 256[, and losing data from bar in that same range. So reading the\n  # file gave us the following content:\n  #\n  # 0000000 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1\n  # *\n  # 0000200 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a\n  # *\n  # 0000400\n  echo \"File bar's content after the clone operation:\"\n  od -t x1 $SCRATCH_MNT\/bar\n\n  # Also because the foo's inline extent was not shrunk by the truncate\n  # operation, btrfs' fsck, which is run by the fstests framework everytime a\n  # test completes, failed reporting the following error:\n  #\n  #  root 5 inode 257 errors 400, nbytes wrong\n\n  status=0\n  exit\n\nCc: stable@vger.kernel.org\nSigned-off-by: Filipe Manana <fdmanana@suse.com>\n---\n fs\/btrfs\/inode.c | 82 +++++++++++++++++++++++++++++++++++++++---------\n 1 file changed, 68 insertions(+), 14 deletions(-)\n\n","diff_code":"diff --git a\/fs\/btrfs\/inode.c b\/fs\/btrfs\/inode.c\nindex 208db4e835f0f..cbb4286490a12 100644\n--- a\/fs\/btrfs\/inode.c\n+++ b\/fs\/btrfs\/inode.c\n@@ -4217,6 +4217,47 @@ static int truncate_space_check(struct btrfs_trans_handle *trans,\n \n }\n \n+static int truncate_inline_extent(struct inode *inode,\n+\t\t\t\t  struct btrfs_path *path,\n+\t\t\t\t  struct btrfs_key *found_key,\n+\t\t\t\t  const u64 item_end,\n+\t\t\t\t  const u64 new_size)\n+{\n+\tstruct extent_buffer *leaf = path->nodes[0];\n+\tint slot = path->slots[0];\n+\tstruct btrfs_file_extent_item *fi;\n+\tu32 size = (u32)(new_size - found_key->offset);\n+\tstruct btrfs_root *root = BTRFS_I(inode)->root;\n+\n+\tfi = btrfs_item_ptr(leaf, slot, struct btrfs_file_extent_item);\n+\n+\tif (btrfs_file_extent_compression(leaf, fi) != BTRFS_COMPRESS_NONE) {\n+\t\tloff_t offset = new_size;\n+\t\tloff_t page_end = ALIGN(offset, PAGE_CACHE_SIZE);\n+\n+\t\t\/*\n+\t\t * Zero out the remaining of the last page of our inline extent,\n+\t\t * instead of directly truncating our inline extent here - that\n+\t\t * would be much more complex (decompressing all the data, then\n+\t\t * compressing the truncated data, which might be bigger than\n+\t\t * the size of the inline extent, resize the extent, etc).\n+\t\t * We release the path because to get the page we might need to\n+\t\t * read the extent item from disk (data not in the page cache).\n+\t\t *\/\n+\t\tbtrfs_release_path(path);\n+\t\treturn btrfs_truncate_page(inode, offset, page_end - offset, 0);\n+\t}\n+\n+\tbtrfs_set_file_extent_ram_bytes(leaf, fi, size);\n+\tsize = btrfs_file_extent_calc_inline_size(size);\n+\tbtrfs_truncate_item(root, path, size, 1);\n+\n+\tif (test_bit(BTRFS_ROOT_REF_COWS, &root->state))\n+\t\tinode_sub_bytes(inode, item_end + 1 - new_size);\n+\n+\treturn 0;\n+}\n+\n \/*\n  * this can truncate away extent items, csum items and directory items.\n  * It starts at a high offset and removes keys until it can't find\n@@ -4411,27 +4452,40 @@ int btrfs_truncate_inode_items(struct btrfs_trans_handle *trans,\n \t\t\t * special encodings\n \t\t\t *\/\n \t\t\tif (!del_item &&\n-\t\t\t    btrfs_file_extent_compression(leaf, fi) == 0 &&\n \t\t\t    btrfs_file_extent_encryption(leaf, fi) == 0 &&\n \t\t\t    btrfs_file_extent_other_encoding(leaf, fi) == 0) {\n-\t\t\t\tu32 size = new_size - found_key.offset;\n-\n-\t\t\t\tif (test_bit(BTRFS_ROOT_REF_COWS, &root->state))\n-\t\t\t\t\tinode_sub_bytes(inode, item_end + 1 -\n-\t\t\t\t\t\t\tnew_size);\n \n \t\t\t\t\/*\n-\t\t\t\t * update the ram bytes to properly reflect\n-\t\t\t\t * the new size of our item\n+\t\t\t\t * Need to release path in order to truncate a\n+\t\t\t\t * compressed extent. So delete any accumulated\n+\t\t\t\t * extent items so far.\n \t\t\t\t *\/\n-\t\t\t\tbtrfs_set_file_extent_ram_bytes(leaf, fi, size);\n-\t\t\t\tsize =\n-\t\t\t\t    btrfs_file_extent_calc_inline_size(size);\n-\t\t\t\tbtrfs_truncate_item(root, path, size, 1);\n+\t\t\t\tif (btrfs_file_extent_compression(leaf, fi) !=\n+\t\t\t\t    BTRFS_COMPRESS_NONE && pending_del_nr) {\n+\t\t\t\t\terr = btrfs_del_items(trans, root, path,\n+\t\t\t\t\t\t\t      pending_del_slot,\n+\t\t\t\t\t\t\t      pending_del_nr);\n+\t\t\t\t\tif (err) {\n+\t\t\t\t\t\tbtrfs_abort_transaction(trans,\n+\t\t\t\t\t\t\t\t\troot,\n+\t\t\t\t\t\t\t\t\terr);\n+\t\t\t\t\t\tgoto error;\n+\t\t\t\t\t}\n+\t\t\t\t\tpending_del_nr = 0;\n+\t\t\t\t}\n+\n+\t\t\t\terr = truncate_inline_extent(inode, path,\n+\t\t\t\t\t\t\t     &found_key,\n+\t\t\t\t\t\t\t     item_end,\n+\t\t\t\t\t\t\t     new_size);\n+\t\t\t\tif (err) {\n+\t\t\t\t\tbtrfs_abort_transaction(trans,\n+\t\t\t\t\t\t\t\troot, err);\n+\t\t\t\t\tgoto error;\n+\t\t\t\t}\n \t\t\t} else if (test_bit(BTRFS_ROOT_REF_COWS,\n \t\t\t\t\t    &root->state)) {\n-\t\t\t\tinode_sub_bytes(inode, item_end + 1 -\n-\t\t\t\t\t\tfound_key.offset);\n+\t\t\t\tinode_sub_bytes(inode, item_end + 1 - new_size);\n \t\t\t}\n \t\t}\n delete:\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2016-2178","CWE_ID":"200","category":"security","commit_id":"399944622df7bd81af62e67ea967c470534090e2","commit_message":"From 399944622df7bd81af62e67ea967c470534090e2 Mon Sep 17 00:00:00 2001\nFrom: Cesar Pereida <cesar.pereida@aalto.fi>\nDate: Mon, 23 May 2016 12:45:25 +0300\nSubject: [PATCH] Fix DSA, preserve BN_FLG_CONSTTIME\n\nOperations in the DSA signing algorithm should run in constant time in\norder to avoid side channel attacks. A flaw in the OpenSSL DSA\nimplementation means that a non-constant time codepath is followed for\ncertain operations. This has been demonstrated through a cache-timing\nattack to be sufficient for an attacker to recover the private DSA key.\n\nCVE-2016-2178\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\nReviewed-by: Matt Caswell <matt@openssl.org>\n---\n crypto\/dsa\/dsa_ossl.c | 9 +++++----\n 1 file changed, 5 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/crypto\/dsa\/dsa_ossl.c b\/crypto\/dsa\/dsa_ossl.c\nindex ce1da1cd6f..beb62b2ff0 100644\n--- a\/crypto\/dsa\/dsa_ossl.c\n+++ b\/crypto\/dsa\/dsa_ossl.c\n@@ -204,10 +204,6 @@ static int dsa_sign_setup(DSA *dsa, BN_CTX *ctx_in,\n             goto err;\n     } while (BN_is_zero(k));\n \n-    if ((dsa->flags & DSA_FLAG_NO_EXP_CONSTTIME) == 0) {\n-        BN_set_flags(k, BN_FLG_CONSTTIME);\n-    }\n-\n     if (dsa->flags & DSA_FLAG_CACHE_MONT_P) {\n         if (!BN_MONT_CTX_set_locked(&dsa->method_mont_p,\n                                     dsa->lock, dsa->p, ctx))\n@@ -238,6 +234,11 @@ static int dsa_sign_setup(DSA *dsa, BN_CTX *ctx_in,\n     } else {\n         K = k;\n     }\n+\n+    if ((dsa->flags & DSA_FLAG_NO_EXP_CONSTTIME) == 0) {\n+        BN_set_flags(K, BN_FLG_CONSTTIME);\n+    }\n+\n     DSA_BN_MOD_EXP(goto err, dsa, r, dsa->g, K, dsa->p, ctx,\n                    dsa->method_mont_p);\n     if (!BN_mod(r, r, dsa->q, ctx))\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2015-5070","CWE_ID":"200","category":"security","commit_id":"b2738ffb2fdd2550ececb74f76f75583c43c8b59","commit_message":"From b2738ffb2fdd2550ececb74f76f75583c43c8b59 Mon Sep 17 00:00:00 2001\nFrom: \"Ignacio R. Morelle\" <shadowm@wesnoth.org>\nDate: Tue, 16 Jun 2015 23:08:52 -0300\nSubject: [PATCH] Use looks_like_pbl() to disallow .pbl file inclusion (bug\n #23504)\n\nThis function is implemented using case-insensitive pattern matching,\nunlike filesystem::ends_with(). I missed this when writing my original\nfix, so the vulnerability still applied to .pbl files on a\ncase-insensitive filesystem (e.g. NTFS and FAT* on Windows) by using\ndifferent case to bypass the check.\n---\n changelog                | 3 ++-\n players_changelog        | 3 ++-\n src\/filesystem.cpp       | 2 +-\n src\/filesystem_boost.cpp | 2 +-\n 4 files changed, 6 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/changelog b\/changelog\nindex 7f1d62c8f1fa..9554b610b1e8 100644\n--- a\/changelog\n+++ b\/changelog\n@@ -1,6 +1,7 @@\n Version 1.13.0+dev:\n  * Security fixes:\n-   * Disallowed inclusion of .pbl files from WML (bug #23504).\n+   * Disallowed inclusion of .pbl files from WML (bug #23504), independent of\n+     file name case.\n  * AI:\n    * Fast Micro AI: exclude hidden enemies from attack evaluation by default;\n      add optional key attack_hidden_enemies to override this\ndiff --git a\/players_changelog b\/players_changelog\nindex 3ab0758dc62e..0a1019e2e0e1 100644\n--- a\/players_changelog\n+++ b\/players_changelog\n@@ -4,7 +4,8 @@ changelog: https:\/\/github.com\/wesnoth\/wesnoth\/blob\/master\/changelog\n \n Version 1.13.0+dev:\n  * Security fixes:\n-   * Disallowed inclusion of .pbl files from WML (bug #23504).\n+   * Disallowed inclusion of .pbl files from WML (bug #23504), independent of\n+     file name case.\n \n  * Campaigns:\n    * Dead Water:\ndiff --git a\/src\/filesystem.cpp b\/src\/filesystem.cpp\nindex 7d5adb60d78c..01cd577b1fb8 100644\n--- a\/src\/filesystem.cpp\n+++ b\/src\/filesystem.cpp\n@@ -1008,7 +1008,7 @@ std::string get_wml_location(const std::string &filename, const std::string &cur\n \t\treturn result;\n \t}\n \n-\tif (ends_with(filename, \".pbl\")) {\n+\tif (looks_like_pbl(filename)) {\n \t\tERR_FS << \"Illegal path '\" << filename << \"' (.pbl files are not allowed).\" << std::endl;\n \t\treturn result;\n \t}\ndiff --git a\/src\/filesystem_boost.cpp b\/src\/filesystem_boost.cpp\nindex 21b582159e11..08cbd2666f6e 100644\n--- a\/src\/filesystem_boost.cpp\n+++ b\/src\/filesystem_boost.cpp\n@@ -1000,7 +1000,7 @@ static bool is_legal_file(const std::string &filename)\n \t\treturn false;\n \t}\n \n-\tif (ends_with(filename, \".pbl\")) {\n+\tif (looks_like_pbl(filename)) {\n \t\tERR_FS << \"Illegal path '\" << filename << \"' (.pbl files are not allowed).\" << std::endl;\n \t\treturn false;\n \t}\n","owner":"wesnoth","repo":"wesnoth","source":"cve"},{"CVE_ID":"CVE-2016-7128","CWE_ID":"200","category":"security","commit_id":"6dbb1ee46b5f4725cc6519abf91e512a2a10dfed","commit_message":"From 6dbb1ee46b5f4725cc6519abf91e512a2a10dfed Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Mon, 8 Aug 2016 00:49:34 -0700\nSubject: [PATCH] Fixed bug #72627: Memory Leakage In exif_process_IFD_in_TIFF\n\n---\n ext\/exif\/exif.c              |   5 ++-\n ext\/exif\/tests\/bug72627.phpt |  71 +++++++++++++++++++++++++++++++++++\n ext\/exif\/tests\/bug72627.tiff | Bin 0 -> 1250 bytes\n 3 files changed, 75 insertions(+), 1 deletion(-)\n create mode 100644 ext\/exif\/tests\/bug72627.phpt\n create mode 100644 ext\/exif\/tests\/bug72627.tiff\n\n","diff_code":"diff --git a\/ext\/exif\/exif.c b\/ext\/exif\/exif.c\nindex f95de3a14f19..657a2cc1f26e 100644\n--- a\/ext\/exif\/exif.c\n+++ b\/ext\/exif\/exif.c\n@@ -3768,8 +3768,11 @@ static int exif_process_IFD_in_TIFF(image_info_type *ImageInfo, size_t dir_offse\n \t\t\t\t\t\tfgot = php_stream_read(ImageInfo->infile, ImageInfo->Thumbnail.data, ImageInfo->Thumbnail.size);\n \t\t\t\t\t\tif (fgot < ImageInfo->Thumbnail.size) {\n \t\t\t\t\t\t\tEXIF_ERRLOG_THUMBEOF(ImageInfo)\n+\t\t\t\t\t\t\tefree(ImageInfo->Thumbnail.data);\n+\t\t\t\t\t\t\tImageInfo->Thumbnail.data = NULL;\n+\t\t\t\t\t\t} else {\n+\t\t\t\t\t\t\texif_thumbnail_build(ImageInfo TSRMLS_CC);\n \t\t\t\t\t\t}\n-\t\t\t\t\t\texif_thumbnail_build(ImageInfo TSRMLS_CC);\n \t\t\t\t\t}\n #ifdef EXIF_DEBUG\n \t\t\t\t\texif_error_docref(NULL EXIFERR_CC, ImageInfo, E_NOTICE, \"Read next IFD (THUMBNAIL) done\");\ndiff --git a\/ext\/exif\/tests\/bug72627.phpt b\/ext\/exif\/tests\/bug72627.phpt\nnew file mode 100644\nindex 000000000000..bb6a1fae99a1\n--- \/dev\/null\n+++ b\/ext\/exif\/tests\/bug72627.phpt\n@@ -0,0 +1,71 @@\n+--TEST--\n+Bug #72627 (Memory Leakage In exif_process_IFD_in_TIFF)\n+--SKIPIF--\n+<?php if (!extension_loaded('exif')) print 'skip exif extension not available';?>\n+--FILE--\n+<?php\n+\t$exif = exif_read_data(__DIR__ . '\/bug72627.tiff',0,0,true);\n+\tvar_dump($exif);\n+?>\n+--EXPECTF--\n+Warning: exif_read_data(%s): Thumbnail goes IFD boundary or end of file reached in %sbug72627.php on line %d\n+\n+Warning: exif_read_data(%s): Error in TIFF: filesize(x04E2) less than start of IFD dir(x829A0004) in %sbug72627.php on line %d\n+\n+Warning: exif_read_data(%s): Thumbnail goes IFD boundary or end of file reached in %sbug72627.php on line %d\n+array(11) {\n+  [\"FileName\"]=>\n+  string(13) \"bug72627.tiff\"\n+  [\"FileDateTime\"]=>\n+  int(%d)\n+  [\"FileSize\"]=>\n+  int(1250)\n+  [\"FileType\"]=>\n+  int(7)\n+  [\"MimeType\"]=>\n+  string(10) \"image\/tiff\"\n+  [\"SectionsFound\"]=>\n+  string(30) \"ANY_TAG, IFD0, THUMBNAIL, EXIF\"\n+  [\"COMPUTED\"]=>\n+  array(10) {\n+    [\"html\"]=>\n+    string(24) \"width=\"128\" height=\"132\"\"\n+    [\"Height\"]=>\n+    int(132)\n+    [\"Width\"]=>\n+    int(128)\n+    [\"IsColor\"]=>\n+    int(0)\n+    [\"ByteOrderMotorola\"]=>\n+    int(0)\n+    [\"ApertureFNumber\"]=>\n+    string(5) \"f\/1.0\"\n+    [\"Thumbnail.FileType\"]=>\n+    int(2)\n+    [\"Thumbnail.MimeType\"]=>\n+    string(10) \"image\/jpeg\"\n+    [\"Thumbnail.Height\"]=>\n+    int(132)\n+    [\"Thumbnail.Width\"]=>\n+    int(128)\n+  }\n+  [\"XResolution\"]=>\n+  string(21) \"1414812756\/1414812756\"\n+  [\"THUMBNAIL\"]=>\n+  array(5) {\n+    [\"ImageWidth\"]=>\n+    int(128)\n+    [\"ImageLength\"]=>\n+    int(132)\n+    [\"JPEGInterchangeFormat\"]=>\n+    int(1280)\n+    [\"JPEGInterchangeFormatLength\"]=>\n+    int(100)\n+    [\"THUMBNAIL\"]=>\n+    NULL\n+  }\n+  [\"ExposureTime\"]=>\n+  string(21) \"1414812756\/1414812756\"\n+  [\"FNumber\"]=>\n+  string(21) \"1414812756\/1414812756\"\n+}\ndiff --git a\/ext\/exif\/tests\/bug72627.tiff b\/ext\/exif\/tests\/bug72627.tiff\nnew file mode 100644\nindex 0000000000000000000000000000000000000000..229190a6041926d960856267a5285d887eda49b5\nGIT binary patch\nliteral 1250\nzcmebD)MDUZU|?WkkYZ$IU<9%lSQr>G+gZSDC9uq_CWwp>P-ZTa?E+*wKom1FgVi<w\nvd5lnY3y94GF@u2>XgZXg0u%><|2O{MVo39)0|*%fqaiRF0wXpA{@(-uY6E(R\n\nliteral 0\nHcmV?d00001\n\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2014-2567","CWE_ID":"200","category":"security","commit_id":"25fffa3e25cbad85bbca804193ad336b090a9ce1","commit_message":"From 25fffa3e25cbad85bbca804193ad336b090a9ce1 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Jan=20Kundr=C3=A1t?= <jkt@flaska.net>\nDate: Tue, 18 Mar 2014 22:38:39 -0400\nSubject: [PATCH] IMAP: refuse to work when STARTTLS is required but server\n sends PREAUTH\n\nOops, we cannot send STARTTLS when the connection is already authenticated.\nThis is serious enough to warrant an error; an attacker might be going after a\nplaintext of a message we're going to APPEND, etc.\n\nThanks to Arnt Gulbrandsen on the imap-protocol ML for asking what happens when\nwe're configured to request STARTTLS and a PREAUTH is received, and to Michael M\nSlusarz for starting that discussion.\n\nHope the error message is readable enough.\n\nCVE: CVE-2014-2567\n---\n src\/Imap\/Tasks\/OpenConnectionTask.cpp         | 11 +++++++++++\n tests\/Imap\/test_Imap_Tasks_OpenConnection.cpp | 13 +++++++++++++\n tests\/Imap\/test_Imap_Tasks_OpenConnection.h   |  1 +\n 3 files changed, 25 insertions(+)\n\n","diff_code":"diff --git a\/src\/Imap\/Tasks\/OpenConnectionTask.cpp b\/src\/Imap\/Tasks\/OpenConnectionTask.cpp\nindex 2957550f8..fc4e6be54 100644\n--- a\/src\/Imap\/Tasks\/OpenConnectionTask.cpp\n+++ b\/src\/Imap\/Tasks\/OpenConnectionTask.cpp\n@@ -153,6 +153,17 @@ bool OpenConnectionTask::handleStateHelper(const Imap::Responses::State *const r\n     {\n         switch (resp->kind) {\n         case PREAUTH:\n+            if (model->m_startTls) {\n+                \/\/ Oops, we cannot send STARTTLS when the connection is already authenticated.\n+                \/\/ This is serious enough to warrant an error; an attacker might be going after a plaintext\n+                \/\/ of a message we're going to APPEND, etc.\n+                \/\/ Thanks to Arnt Gulbrandsen on the imap-protocol ML for asking what happens when we're configured\n+                \/\/ to request STARTTLS and a PREAUTH is received, and to Michael M Slusarz for starting that discussion.\n+                logout(tr(\"Configuration requires sending STARTTLS, but the IMAP server greets us with PREAUTH. \"\n+                          \"Encryption cannot be established. If this configuration worked previously, someone \"\n+                          \"is after your data and they are pretty smart.\"));\n+                return true;\n+            }\n             \/\/ Cool, we're already authenticated. Now, let's see if we have to issue CAPABILITY or if we already know that\n             if (model->accessParser(parser).capabilitiesFresh) {\n                 \/\/ We're alsmost done here, apart from compression\ndiff --git a\/tests\/Imap\/test_Imap_Tasks_OpenConnection.cpp b\/tests\/Imap\/test_Imap_Tasks_OpenConnection.cpp\nindex e6aaf3d55..f186c68cd 100644\n--- a\/tests\/Imap\/test_Imap_Tasks_OpenConnection.cpp\n+++ b\/tests\/Imap\/test_Imap_Tasks_OpenConnection.cpp\n@@ -129,6 +129,19 @@ void ImapModelOpenConnectionTest::testPreauthWithCapability()\n     QVERIFY(startTlsUpgradeSpy->isEmpty());\n }\n \n+\/** @short What happens when the server responds with PREAUTH and we want STARTTLS? *\/\n+void ImapModelOpenConnectionTest::testPreauthWithStartTlsWanted()\n+{\n+    cleanup(); init(true); \/\/ yuck, but I can't come up with anything better...\n+\n+    cEmpty();\n+    cServer(\"* PREAUTH hi there\\r\\n\");\n+    QCOMPARE(failedSpy->size(), 1);\n+    QVERIFY(completedSpy->isEmpty());\n+    QVERIFY(authSpy->isEmpty());\n+    QVERIFY(startTlsUpgradeSpy->isEmpty());\n+}\n+\n \/** @short Test for obtaining capability and logging in without any STARTTLS *\/\n void ImapModelOpenConnectionTest::testOk()\n {\ndiff --git a\/tests\/Imap\/test_Imap_Tasks_OpenConnection.h b\/tests\/Imap\/test_Imap_Tasks_OpenConnection.h\nindex 23107a3f0..dcc77c0da 100644\n--- a\/tests\/Imap\/test_Imap_Tasks_OpenConnection.h\n+++ b\/tests\/Imap\/test_Imap_Tasks_OpenConnection.h\n@@ -39,6 +39,7 @@ private slots:\n \n     void testPreauth();\n     void testPreauthWithCapability();\n+    void testPreauthWithStartTlsWanted();\n \n     void testOk();\n     void testOkWithCapability();\n","owner":"jktjkt","repo":"trojita","source":"cve"},{"CVE_ID":"CVE-2017-15537","CWE_ID":"200","category":"security","commit_id":"814fb7bb7db5433757d76f4c4502c96fc53b0b5e","commit_message":"From 814fb7bb7db5433757d76f4c4502c96fc53b0b5e Mon Sep 17 00:00:00 2001\nFrom: Eric Biggers <ebiggers@google.com>\nDate: Sat, 23 Sep 2017 15:00:07 +0200\nSubject: [PATCH] x86\/fpu: Don't let userspace set bogus xcomp_bv\n\nOn x86, userspace can use the ptrace() or rt_sigreturn() system calls to\nset a task's extended state (xstate) or \"FPU\" registers.  ptrace() can\nset them for another task using the PTRACE_SETREGSET request with\nNT_X86_XSTATE, while rt_sigreturn() can set them for the current task.\nIn either case, registers can be set to any value, but the kernel\nassumes that the XSAVE area itself remains valid in the sense that the\nCPU can restore it.\n\nHowever, in the case where the kernel is using the uncompacted xstate\nformat (which it does whenever the XSAVES instruction is unavailable),\nit was possible for userspace to set the xcomp_bv field in the\nxstate_header to an arbitrary value.  However, all bits in that field\nare reserved in the uncompacted case, so when switching to a task with\nnonzero xcomp_bv, the XRSTOR instruction failed with a #GP fault.  This\ncaused the WARN_ON_FPU(err) in copy_kernel_to_xregs() to be hit.  In\naddition, since the error is otherwise ignored, the FPU registers from\nthe task previously executing on the CPU were leaked.\n\nFix the bug by checking that the user-supplied value of xcomp_bv is 0 in\nthe uncompacted case, and returning an error otherwise.\n\nThe reason for validating xcomp_bv rather than simply overwriting it\nwith 0 is that we want userspace to see an error if it (incorrectly)\nprovides an XSAVE area in compacted format rather than in uncompacted\nformat.\n\nNote that as before, in case of error we clear the task's FPU state.\nThis is perhaps non-ideal, especially for PTRACE_SETREGSET; it might be\nbetter to return an error before changing anything.  But it seems the\n\"clear on error\" behavior is fine for now, and it's a little tricky to\ndo otherwise because it would mean we couldn't simply copy the full\nuserspace state into kernel memory in one __copy_from_user().\n\nThis bug was found by syzkaller, which hit the above-mentioned\nWARN_ON_FPU():\n\n    WARNING: CPU: 1 PID: 0 at .\/arch\/x86\/include\/asm\/fpu\/internal.h:373 __switch_to+0x5b5\/0x5d0\n    CPU: 1 PID: 0 Comm: swapper\/1 Not tainted 4.13.0 #453\n    Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01\/01\/2011\n    task: ffff9ba2bc8e42c0 task.stack: ffffa78cc036c000\n    RIP: 0010:__switch_to+0x5b5\/0x5d0\n    RSP: 0000:ffffa78cc08bbb88 EFLAGS: 00010082\n    RAX: 00000000fffffffe RBX: ffff9ba2b8bf2180 RCX: 00000000c0000100\n    RDX: 00000000ffffffff RSI: 000000005cb10700 RDI: ffff9ba2b8bf36c0\n    RBP: ffffa78cc08bbbd0 R08: 00000000929fdf46 R09: 0000000000000001\n    R10: 0000000000000000 R11: 0000000000000000 R12: ffff9ba2bc8e42c0\n    R13: 0000000000000000 R14: ffff9ba2b8bf3680 R15: ffff9ba2bf5d7b40\n    FS:  00007f7e5cb10700(0000) GS:ffff9ba2bf400000(0000) knlGS:0000000000000000\n    CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n    CR2: 00000000004005cc CR3: 0000000079fd5000 CR4: 00000000001406e0\n    Call Trace:\n    Code: 84 00 00 00 00 00 e9 11 fd ff ff 0f ff 66 0f 1f 84 00 00 00 00 00 e9 e7 fa ff ff 0f ff 66 0f 1f 84 00 00 00 00 00 e9 c2 fa ff ff <0f> ff 66 0f 1f 84 00 00 00 00 00 e9 d4 fc ff ff 66 66 2e 0f 1f\n\nHere is a C reproducer.  The expected behavior is that the program spin\nforever with no output.  However, on a buggy kernel running on a\nprocessor with the \"xsave\" feature but without the \"xsaves\" feature\n(e.g. Sandy Bridge through Broadwell for Intel), within a second or two\nthe program reports that the xmm registers were corrupted, i.e. were not\nrestored correctly.  With CONFIG_X86_DEBUG_FPU=y it also hits the above\nkernel warning.\n\n    #define _GNU_SOURCE\n    #include <stdbool.h>\n    #include <inttypes.h>\n    #include <linux\/elf.h>\n    #include <stdio.h>\n    #include <sys\/ptrace.h>\n    #include <sys\/uio.h>\n    #include <sys\/wait.h>\n    #include <unistd.h>\n\n    int main(void)\n    {\n        int pid = fork();\n        uint64_t xstate[512];\n        struct iovec iov = { .iov_base = xstate, .iov_len = sizeof(xstate) };\n\n        if (pid == 0) {\n            bool tracee = true;\n            for (int i = 0; i < sysconf(_SC_NPROCESSORS_ONLN) && tracee; i++)\n                tracee = (fork() != 0);\n            uint32_t xmm0[4] = { [0 ... 3] = tracee ? 0x00000000 : 0xDEADBEEF };\n            asm volatile(\"   movdqu %0, %%xmm0\\n\"\n                         \"   mov %0, %%rbx\\n\"\n                         \"1: movdqu %%xmm0, %0\\n\"\n                         \"   mov %0, %%rax\\n\"\n                         \"   cmp %%rax, %%rbx\\n\"\n                         \"   je 1b\\n\"\n                         : \"+m\" (xmm0) : : \"rax\", \"rbx\", \"xmm0\");\n            printf(\"BUG: xmm registers corrupted!  tracee=%d, xmm0=%08X%08X%08X%08X\\n\",\n                   tracee, xmm0[0], xmm0[1], xmm0[2], xmm0[3]);\n        } else {\n            usleep(100000);\n            ptrace(PTRACE_ATTACH, pid, 0, 0);\n            wait(NULL);\n            ptrace(PTRACE_GETREGSET, pid, NT_X86_XSTATE, &iov);\n            xstate[65] = -1;\n            ptrace(PTRACE_SETREGSET, pid, NT_X86_XSTATE, &iov);\n            ptrace(PTRACE_CONT, pid, 0, 0);\n            wait(NULL);\n        }\n        return 1;\n    }\n\nNote: the program only tests for the bug using the ptrace() system call.\nThe bug can also be reproduced using the rt_sigreturn() system call, but\nonly when called from a 32-bit program, since for 64-bit programs the\nkernel restores the FPU state from the signal frame by doing XRSTOR\ndirectly from userspace memory (with proper error checking).\n\nReported-by: Dmitry Vyukov <dvyukov@google.com>\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nReviewed-by: Kees Cook <keescook@chromium.org>\nReviewed-by: Rik van Riel <riel@redhat.com>\nAcked-by: Dave Hansen <dave.hansen@linux.intel.com>\nCc: <stable@vger.kernel.org> [v3.17+]\nCc: Andrew Morton <akpm@linux-foundation.org>\nCc: Andy Lutomirski <luto@amacapital.net>\nCc: Andy Lutomirski <luto@kernel.org>\nCc: Borislav Petkov <bp@alien8.de>\nCc: Eric Biggers <ebiggers3@gmail.com>\nCc: Fenghua Yu <fenghua.yu@intel.com>\nCc: Kevin Hao <haokexin@gmail.com>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nCc: Michael Halcrow <mhalcrow@google.com>\nCc: Oleg Nesterov <oleg@redhat.com>\nCc: Peter Zijlstra <peterz@infradead.org>\nCc: Thomas Gleixner <tglx@linutronix.de>\nCc: Wanpeng Li <wanpeng.li@hotmail.com>\nCc: Yu-cheng Yu <yu-cheng.yu@intel.com>\nCc: kernel-hardening@lists.openwall.com\nFixes: 0b29643a5843 (\"x86\/xsaves: Change compacted format xsave area header\")\nLink: http:\/\/lkml.kernel.org\/r\/20170922174156.16780-2-ebiggers3@gmail.com\nLink: http:\/\/lkml.kernel.org\/r\/20170923130016.21448-25-mingo@kernel.org\nSigned-off-by: Ingo Molnar <mingo@kernel.org>\n---\n arch\/x86\/kernel\/fpu\/regset.c | 4 ++++\n arch\/x86\/kernel\/fpu\/signal.c | 9 +++++++--\n 2 files changed, 11 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/arch\/x86\/kernel\/fpu\/regset.c b\/arch\/x86\/kernel\/fpu\/regset.c\nindex 19a7385a912cc..c764f74053223 100644\n--- a\/arch\/x86\/kernel\/fpu\/regset.c\n+++ b\/arch\/x86\/kernel\/fpu\/regset.c\n@@ -141,6 +141,10 @@ int xstateregs_set(struct task_struct *target, const struct user_regset *regset,\n \t\t\tret = copy_user_to_xstate(xsave, ubuf);\n \t} else {\n \t\tret = user_regset_copyin(&pos, &count, &kbuf, &ubuf, xsave, 0, -1);\n+\n+\t\t\/* xcomp_bv must be 0 when using uncompacted format *\/\n+\t\tif (!ret && xsave->header.xcomp_bv)\n+\t\t\tret = -EINVAL;\n \t}\n \n \t\/*\ndiff --git a\/arch\/x86\/kernel\/fpu\/signal.c b\/arch\/x86\/kernel\/fpu\/signal.c\nindex 629106e51a297..da68ea1c3a442 100644\n--- a\/arch\/x86\/kernel\/fpu\/signal.c\n+++ b\/arch\/x86\/kernel\/fpu\/signal.c\n@@ -324,11 +324,16 @@ static int __fpu__restore_sig(void __user *buf, void __user *buf_fx, int size)\n \t\t *\/\n \t\tfpu__drop(fpu);\n \n-\t\tif (using_compacted_format())\n+\t\tif (using_compacted_format()) {\n \t\t\terr = copy_user_to_xstate(&fpu->state.xsave, buf_fx);\n-\t\telse\n+\t\t} else {\n \t\t\terr = __copy_from_user(&fpu->state.xsave, buf_fx, state_size);\n \n+\t\t\t\/* xcomp_bv must be 0 when using uncompacted format *\/\n+\t\t\tif (!err && state_size > offsetof(struct xregs_state, header) && fpu->state.xsave.header.xcomp_bv)\n+\t\t\t\terr = -EINVAL;\n+\t\t}\n+\n \t\tif (err || __copy_from_user(&env, buf, sizeof(env))) {\n \t\t\tfpstate_init(&fpu->state);\n \t\t\ttrace_x86_fpu_init_state(fpu);\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2005-4881","CWE_ID":"200","category":"security","commit_id":"b3563c4fbff906991a1b4ef4609f99cca2a0de6a","commit_message":"From b3563c4fbff906991a1b4ef4609f99cca2a0de6a Mon Sep 17 00:00:00 2001\nFrom: Patrick McHardy <kaber@trash.net>\nDate: Tue, 28 Jun 2005 12:54:43 -0700\nSubject: [NETLINK]: Clear padding in netlink messages\n\nSigned-off-by: Patrick McHardy <kaber@trash.net>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n include\/linux\/netlink.h   | 1 +\n include\/linux\/rtnetlink.h | 5 ++++-\n net\/core\/rtnetlink.c      | 1 +\n 3 files changed, 6 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/include\/linux\/netlink.h b\/include\/linux\/netlink.h\nindex 3029cad63a01..27e4d164a108 100644\n--- a\/include\/linux\/netlink.h\n+++ b\/include\/linux\/netlink.h\n@@ -168,6 +168,7 @@ __nlmsg_put(struct sk_buff *skb, u32 pid, u32 seq, int type, int len, int flags)\n \tnlh->nlmsg_flags = flags;\n \tnlh->nlmsg_pid = pid;\n \tnlh->nlmsg_seq = seq;\n+\tmemset(NLMSG_DATA(nlh) + len, 0, NLMSG_ALIGN(size) - size);\n \treturn nlh;\n }\n \ndiff --git a\/include\/linux\/rtnetlink.h b\/include\/linux\/rtnetlink.h\nindex d021888b58f1..dc26e82ba0fd 100644\n--- a\/include\/linux\/rtnetlink.h\n+++ b\/include\/linux\/rtnetlink.h\n@@ -898,7 +898,9 @@ extern void __rta_fill(struct sk_buff *skb, int attrtype, int attrlen, const voi\n \tmemcpy(skb_put(skb, attrlen), data, attrlen); })\n \n #define RTA_PUT_NOHDR(skb, attrlen, data) \\\n-\tRTA_APPEND(skb, RTA_ALIGN(attrlen), data)\n+({\tRTA_APPEND(skb, RTA_ALIGN(attrlen), data); \\\n+\tmemset(skb->tail - (RTA_ALIGN(attrlen) - attrlen), 0, \\\n+\t       RTA_ALIGN(attrlen) - attrlen); })\n \n #define RTA_PUT_U8(skb, attrtype, value) \\\n ({\tu8 _tmp = (value); \\\n@@ -978,6 +980,7 @@ __rta_reserve(struct sk_buff *skb, int attrtype, int attrlen)\n \trta = (struct rtattr*)skb_put(skb, RTA_ALIGN(size));\n \trta->rta_type = attrtype;\n \trta->rta_len = size;\n+\tmemset(RTA_DATA(rta) + attrlen, 0, RTA_ALIGN(size) - size);\n \treturn rta;\n }\n \ndiff --git a\/net\/core\/rtnetlink.c b\/net\/core\/rtnetlink.c\nindex e013d836a7ab..879237c378f8 100644\n--- a\/net\/core\/rtnetlink.c\n+++ b\/net\/core\/rtnetlink.c\n@@ -126,6 +126,7 @@ void __rta_fill(struct sk_buff *skb, int attrtype, int attrlen, const void *data\n \trta->rta_type = attrtype;\n \trta->rta_len = size;\n \tmemcpy(RTA_DATA(rta), data, attrlen);\n+\tmemset(RTA_DATA(rta) + attrlen, 0, RTA_ALIGN(size) - size);\n }\n \n size_t rtattr_strlcpy(char *dest, const struct rtattr *rta, size_t size)\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2018-18839","CWE_ID":"200","category":"security","commit_id":"92327c9ec211bd1616315abcb255861b130b97ca","commit_message":"From 92327c9ec211bd1616315abcb255861b130b97ca Mon Sep 17 00:00:00 2001\nFrom: Costa Tsaousis <costa@tsaousis.gr>\nDate: Tue, 30 Oct 2018 02:35:57 +0200\nSubject: [PATCH] fixed vulnerabilities identified by red4sec.com (#4521)\n\n---\n libnetdata\/url\/url.c |  4 +++-\n web\/api\/web_api_v1.c | 17 +++++++++++++++++\n 2 files changed, 20 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/libnetdata\/url\/url.c b\/libnetdata\/url\/url.c\nindex 8a96063a03..07a9f8069e 100644\n--- a\/libnetdata\/url\/url.c\n+++ b\/libnetdata\/url\/url.c\n@@ -60,7 +60,9 @@ char *url_decode_r(char *to, char *url, size_t size) {\n     while(*s && d < e) {\n         if(unlikely(*s == '%')) {\n             if(likely(s[1] && s[2])) {\n-                *d++ = from_hex(s[1]) << 4 | from_hex(s[2]);\n+                char t = from_hex(s[1]) << 4 | from_hex(s[2]);\n+                \/\/ avoid HTTP header injection\n+                *d++ = (char)((isprint(t))? t : ' ');\n                 s += 2;\n             }\n         }\ndiff --git a\/web\/api\/web_api_v1.c b\/web\/api\/web_api_v1.c\nindex 0c0242c3ca..1e03828e40 100644\n--- a\/web\/api\/web_api_v1.c\n+++ b\/web\/api\/web_api_v1.c\n@@ -233,6 +233,15 @@ inline int web_client_api_request_v1_chart(RRDHOST *host, struct web_client *w,\n     return web_client_api_request_single_chart(host, w, url, rrd_stats_api_v1_chart);\n }\n \n+void fix_google_param(char *s) {\n+    if(unlikely(!s)) return;\n+\n+    for( ; *s ;s++) {\n+        if(!isalnum(*s) && *s != '.' && *s != '_' && *s != '-')\n+            *s = '_';\n+    }\n+}\n+\n \/\/ returns the HTTP code\n inline int web_client_api_request_v1_data(RRDHOST *host, struct web_client *w, char *url) {\n     debug(D_WEB_CLIENT, \"%llu: API v1 data with URL '%s'\", w->id, url);\n@@ -332,6 +341,14 @@ inline int web_client_api_request_v1_data(RRDHOST *host, struct web_client *w, c\n         }\n     }\n \n+    \/\/ validate the google parameters given\n+    fix_google_param(google_out);\n+    fix_google_param(google_sig);\n+    fix_google_param(google_reqId);\n+    fix_google_param(google_version);\n+    fix_google_param(responseHandler);\n+    fix_google_param(outFileName);\n+\n     if(!chart || !*chart) {\n         buffer_sprintf(w->response.data, \"No chart id is given at the request.\");\n         goto cleanup;\n","owner":"netdata","repo":"netdata","source":"cve"},{"CVE_ID":"CVE-2012-6540","CWE_ID":"200","category":"security","commit_id":"2d8a041b7bfe1097af21441cb77d6af95f4f4680","commit_message":"From 2d8a041b7bfe1097af21441cb77d6af95f4f4680 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:56 +0000\nSubject: [PATCH] ipvs: fix info leak in getsockopt(IP_VS_SO_GET_TIMEOUT)\n\nIf at least one of CONFIG_IP_VS_PROTO_TCP or CONFIG_IP_VS_PROTO_UDP is\nnot set, __ip_vs_get_timeouts() does not fully initialize the structure\nthat gets copied to userland and that for leaks up to 12 bytes of kernel\nstack. Add an explicit memset(0) before passing the structure to\n__ip_vs_get_timeouts() to avoid the info leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nCc: Wensong Zhang <wensong@linux-vs.org>\nCc: Simon Horman <horms@verge.net.au>\nCc: Julian Anastasov <ja@ssi.bg>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/netfilter\/ipvs\/ip_vs_ctl.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/netfilter\/ipvs\/ip_vs_ctl.c b\/net\/netfilter\/ipvs\/ip_vs_ctl.c\nindex 84444dda194b6..72bf32a848747 100644\n--- a\/net\/netfilter\/ipvs\/ip_vs_ctl.c\n+++ b\/net\/netfilter\/ipvs\/ip_vs_ctl.c\n@@ -2759,6 +2759,7 @@ do_ip_vs_get_ctl(struct sock *sk, int cmd, void __user *user, int *len)\n \t{\n \t\tstruct ip_vs_timeout_user t;\n \n+\t\tmemset(&t, 0, sizeof(t));\n \t\t__ip_vs_get_timeouts(net, &t);\n \t\tif (copy_to_user(user, &t, sizeof(t)) != 0)\n \t\t\tret = -EFAULT;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2019-10638","CWE_ID":"200","category":"security","commit_id":"df453700e8d81b1bdafdf684365ee2b9431fb702","commit_message":"From df453700e8d81b1bdafdf684365ee2b9431fb702 Mon Sep 17 00:00:00 2001\nFrom: Eric Dumazet <edumazet@google.com>\nDate: Wed, 27 Mar 2019 12:40:33 -0700\nSubject: inet: switch IP ID generator to siphash\n\nAccording to Amit Klein and Benny Pinkas, IP ID generation is too weak\nand might be used by attackers.\n\nEven with recent net_hash_mix() fix (netns: provide pure entropy for net_hash_mix())\nhaving 64bit key and Jenkins hash is risky.\n\nIt is time to switch to siphash and its 128bit keys.\n\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nReported-by: Amit Klein <aksecurity@gmail.com>\nReported-by: Benny Pinkas <benny@pinkas.net>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n include\/linux\/siphash.h  |  5 +++++\n include\/net\/netns\/ipv4.h |  2 ++\n net\/ipv4\/route.c         | 12 +++++++-----\n net\/ipv6\/output_core.c   | 30 ++++++++++++++++--------------\n 4 files changed, 30 insertions(+), 19 deletions(-)\n\n","diff_code":"diff --git a\/include\/linux\/siphash.h b\/include\/linux\/siphash.h\nindex fa7a6b9cedbf..bf21591a9e5e 100644\n--- a\/include\/linux\/siphash.h\n+++ b\/include\/linux\/siphash.h\n@@ -21,6 +21,11 @@ typedef struct {\n \tu64 key[2];\n } siphash_key_t;\n \n+static inline bool siphash_key_is_zero(const siphash_key_t *key)\n+{\n+\treturn !(key->key[0] | key->key[1]);\n+}\n+\n u64 __siphash_aligned(const void *data, size_t len, const siphash_key_t *key);\n #ifndef CONFIG_HAVE_EFFICIENT_UNALIGNED_ACCESS\n u64 __siphash_unaligned(const void *data, size_t len, const siphash_key_t *key);\ndiff --git a\/include\/net\/netns\/ipv4.h b\/include\/net\/netns\/ipv4.h\nindex 104a6669e344..7698460a3dd1 100644\n--- a\/include\/net\/netns\/ipv4.h\n+++ b\/include\/net\/netns\/ipv4.h\n@@ -9,6 +9,7 @@\n #include <linux\/uidgid.h>\n #include <net\/inet_frag.h>\n #include <linux\/rcupdate.h>\n+#include <linux\/siphash.h>\n \n struct tcpm_hash_bucket;\n struct ctl_table_header;\n@@ -217,5 +218,6 @@ struct netns_ipv4 {\n \tunsigned int\tipmr_seq;\t\/* protected by rtnl_mutex *\/\n \n \tatomic_t\trt_genid;\n+\tsiphash_key_t\tip_id_key;\n };\n #endif\ndiff --git a\/net\/ipv4\/route.c b\/net\/ipv4\/route.c\nindex 14c7fdacaa72..f2688fce39e1 100644\n--- a\/net\/ipv4\/route.c\n+++ b\/net\/ipv4\/route.c\n@@ -500,15 +500,17 @@ EXPORT_SYMBOL(ip_idents_reserve);\n \n void __ip_select_ident(struct net *net, struct iphdr *iph, int segs)\n {\n-\tstatic u32 ip_idents_hashrnd __read_mostly;\n \tu32 hash, id;\n \n-\tnet_get_random_once(&ip_idents_hashrnd, sizeof(ip_idents_hashrnd));\n+\t\/* Note the following code is not safe, but this is okay. *\/\n+\tif (unlikely(siphash_key_is_zero(&net->ipv4.ip_id_key)))\n+\t\tget_random_bytes(&net->ipv4.ip_id_key,\n+\t\t\t\t sizeof(net->ipv4.ip_id_key));\n \n-\thash = jhash_3words((__force u32)iph->daddr,\n+\thash = siphash_3u32((__force u32)iph->daddr,\n \t\t\t    (__force u32)iph->saddr,\n-\t\t\t    iph->protocol ^ net_hash_mix(net),\n-\t\t\t    ip_idents_hashrnd);\n+\t\t\t    iph->protocol,\n+\t\t\t    &net->ipv4.ip_id_key);\n \tid = ip_idents_reserve(hash, segs);\n \tiph->id = htons(id);\n }\ndiff --git a\/net\/ipv6\/output_core.c b\/net\/ipv6\/output_core.c\nindex 4fe7c90962dd..868ae23dbae1 100644\n--- a\/net\/ipv6\/output_core.c\n+++ b\/net\/ipv6\/output_core.c\n@@ -10,15 +10,25 @@\n #include <net\/secure_seq.h>\n #include <linux\/netfilter.h>\n \n-static u32 __ipv6_select_ident(struct net *net, u32 hashrnd,\n+static u32 __ipv6_select_ident(struct net *net,\n \t\t\t       const struct in6_addr *dst,\n \t\t\t       const struct in6_addr *src)\n {\n+\tconst struct {\n+\t\tstruct in6_addr dst;\n+\t\tstruct in6_addr src;\n+\t} __aligned(SIPHASH_ALIGNMENT) combined = {\n+\t\t.dst = *dst,\n+\t\t.src = *src,\n+\t};\n \tu32 hash, id;\n \n-\thash = __ipv6_addr_jhash(dst, hashrnd);\n-\thash = __ipv6_addr_jhash(src, hash);\n-\thash ^= net_hash_mix(net);\n+\t\/* Note the following code is not safe, but this is okay. *\/\n+\tif (unlikely(siphash_key_is_zero(&net->ipv4.ip_id_key)))\n+\t\tget_random_bytes(&net->ipv4.ip_id_key,\n+\t\t\t\t sizeof(net->ipv4.ip_id_key));\n+\n+\thash = siphash(&combined, sizeof(combined), &net->ipv4.ip_id_key);\n \n \t\/* Treat id of 0 as unset and if we get 0 back from ip_idents_reserve,\n \t * set the hight order instead thus minimizing possible future\n@@ -41,7 +51,6 @@ static u32 __ipv6_select_ident(struct net *net, u32 hashrnd,\n  *\/\n __be32 ipv6_proxy_select_ident(struct net *net, struct sk_buff *skb)\n {\n-\tstatic u32 ip6_proxy_idents_hashrnd __read_mostly;\n \tstruct in6_addr buf[2];\n \tstruct in6_addr *addrs;\n \tu32 id;\n@@ -53,11 +62,7 @@ __be32 ipv6_proxy_select_ident(struct net *net, struct sk_buff *skb)\n \tif (!addrs)\n \t\treturn 0;\n \n-\tnet_get_random_once(&ip6_proxy_idents_hashrnd,\n-\t\t\t    sizeof(ip6_proxy_idents_hashrnd));\n-\n-\tid = __ipv6_select_ident(net, ip6_proxy_idents_hashrnd,\n-\t\t\t\t &addrs[1], &addrs[0]);\n+\tid = __ipv6_select_ident(net, &addrs[1], &addrs[0]);\n \treturn htonl(id);\n }\n EXPORT_SYMBOL_GPL(ipv6_proxy_select_ident);\n@@ -66,12 +71,9 @@ __be32 ipv6_select_ident(struct net *net,\n \t\t\t const struct in6_addr *daddr,\n \t\t\t const struct in6_addr *saddr)\n {\n-\tstatic u32 ip6_idents_hashrnd __read_mostly;\n \tu32 id;\n \n-\tnet_get_random_once(&ip6_idents_hashrnd, sizeof(ip6_idents_hashrnd));\n-\n-\tid = __ipv6_select_ident(net, ip6_idents_hashrnd, daddr, saddr);\n+\tid = __ipv6_select_ident(net, daddr, saddr);\n \treturn htonl(id);\n }\n EXPORT_SYMBOL(ipv6_select_ident);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-6537","CWE_ID":"200","category":"security","commit_id":"1f86840f897717f86d523a13e99a447e6a5d2fa5","commit_message":"From 1f86840f897717f86d523a13e99a447e6a5d2fa5 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 19 Sep 2012 11:33:41 +0000\nSubject: [PATCH] xfrm_user: fix info leak in copy_to_user_tmpl()\n\nThe memory used for the template copy is a local stack variable. As\nstruct xfrm_user_tmpl contains multiple holes added by the compiler for\nalignment, not initializing the memory will lead to leaking stack bytes\nto userland. Add an explicit memset(0) to avoid the info leak.\n\nInitial version of the patch by Brad Spengler.\n\nCc: Brad Spengler <spender@grsecurity.net>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nAcked-by: Steffen Klassert <steffen.klassert@secunet.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/xfrm\/xfrm_user.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/xfrm\/xfrm_user.c b\/net\/xfrm\/xfrm_user.c\nindex 84dd85ceeeeae..8024b3dea8c2d 100644\n--- a\/net\/xfrm\/xfrm_user.c\n+++ b\/net\/xfrm\/xfrm_user.c\n@@ -1425,6 +1425,7 @@ static int copy_to_user_tmpl(struct xfrm_policy *xp, struct sk_buff *skb)\n \t\tstruct xfrm_user_tmpl *up = &vec[i];\n \t\tstruct xfrm_tmpl *kp = &xp->xfrm_vec[i];\n \n+\t\tmemset(up, 0, sizeof(*up));\n \t\tmemcpy(&up->id, &kp->id, sizeof(up->id));\n \t\tup->family = kp->encap_family;\n \t\tmemcpy(&up->saddr, &kp->saddr, sizeof(up->saddr));\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2011-2494","CWE_ID":"200","category":"security","commit_id":"1a51410abe7d0ee4b1d112780f46df87d3621043","commit_message":"From 1a51410abe7d0ee4b1d112780f46df87d3621043 Mon Sep 17 00:00:00 2001\nFrom: Linus Torvalds <torvalds@linux-foundation.org>\nDate: Mon, 19 Sep 2011 17:04:37 -0700\nSubject: Make TASKSTATS require root access\n\nOk, this isn't optimal, since it means that 'iotop' needs admin\ncapabilities, and we may have to work on this some more.  But at the\nsame time it is very much not acceptable to let anybody just read\nanybody elses IO statistics quite at this level.\n\nUse of the GENL_ADMIN_PERM suggested by Johannes Berg as an alternative\nto checking the capabilities by hand.\n\nReported-by: Vasiliy Kulikov <segoon@openwall.com>\nCc: Johannes Berg <johannes.berg@intel.com>\nAcked-by: Balbir Singh <bsingharora@gmail.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n kernel\/taskstats.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/kernel\/taskstats.c b\/kernel\/taskstats.c\nindex e19ce1454ee1..e66046456f4f 100644\n--- a\/kernel\/taskstats.c\n+++ b\/kernel\/taskstats.c\n@@ -655,6 +655,7 @@ static struct genl_ops taskstats_ops = {\n \t.cmd\t\t= TASKSTATS_CMD_GET,\n \t.doit\t\t= taskstats_user_cmd,\n \t.policy\t\t= taskstats_cmd_get_policy,\n+\t.flags\t\t= GENL_ADMIN_PERM,\n };\n \n static struct genl_ops cgroupstats_ops = {\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-6545","CWE_ID":"200","category":"security","commit_id":"f9432c5ec8b1e9a09b9b0e5569e3c73db8de432a","commit_message":"From f9432c5ec8b1e9a09b9b0e5569e3c73db8de432a Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:49 +0000\nSubject: Bluetooth: RFCOMM - Fix info leak in ioctl(RFCOMMGETDEVLIST)\n\nThe RFCOMM code fails to initialize the two padding bytes of struct\nrfcomm_dev_list_req inserted for alignment before copying it to\nuserland. Additionally there are two padding bytes in each instance of\nstruct rfcomm_dev_info. The ioctl() that for disclosures two bytes plus\ndev_num times two bytes uninitialized kernel heap memory.\n\nAllocate the memory using kzalloc() to fix this issue.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Gustavo Padovan <gustavo@padovan.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/bluetooth\/rfcomm\/tty.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/bluetooth\/rfcomm\/tty.c b\/net\/bluetooth\/rfcomm\/tty.c\nindex cb960773c002..56f182393c4c 100644\n--- a\/net\/bluetooth\/rfcomm\/tty.c\n+++ b\/net\/bluetooth\/rfcomm\/tty.c\n@@ -456,7 +456,7 @@ static int rfcomm_get_dev_list(void __user *arg)\n \n \tsize = sizeof(*dl) + dev_num * sizeof(*di);\n \n-\tdl = kmalloc(size, GFP_KERNEL);\n+\tdl = kzalloc(size, GFP_KERNEL);\n \tif (!dl)\n \t\treturn -ENOMEM;\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-3222","CWE_ID":"200","category":"security","commit_id":"9b3e617f3df53822345a8573b6d358f6b9e5ed87","commit_message":"From 9b3e617f3df53822345a8573b6d358f6b9e5ed87 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:47 +0000\nSubject: atm: update msg_namelen in vcc_recvmsg()\n\nThe current code does not fill the msg_name member in case it is set.\nIt also does not set the msg_namelen member to 0 and therefore makes\nnet\/socket.c leak the local, uninitialized sockaddr_storage variable\nto userland -- 128 bytes of kernel stack memory.\n\nFix that by simply setting msg_namelen to 0 as obviously nobody cared\nabout vcc_recvmsg() not filling the msg_name in case it was set.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/atm\/common.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/net\/atm\/common.c b\/net\/atm\/common.c\nindex 7b491006eaf4..737bef59ce89 100644\n--- a\/net\/atm\/common.c\n+++ b\/net\/atm\/common.c\n@@ -531,6 +531,8 @@ int vcc_recvmsg(struct kiocb *iocb, struct socket *sock, struct msghdr *msg,\n \tstruct sk_buff *skb;\n \tint copied, error = -EINVAL;\n \n+\tmsg->msg_namelen = 0;\n+\n \tif (sock->state != SS_CONNECTED)\n \t\treturn -ENOTCONN;\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-7263","CWE_ID":"200","category":"security","commit_id":"bceaa90240b6019ed73b49965eac7d167610be69","commit_message":"From bceaa90240b6019ed73b49965eac7d167610be69 Mon Sep 17 00:00:00 2001\nFrom: Hannes Frederic Sowa <hannes@stressinduktion.org>\nDate: Mon, 18 Nov 2013 04:20:45 +0100\nSubject: inet: prevent leakage of uninitialized memory to user in recv\n syscalls\n\nOnly update *addr_len when we actually fill in sockaddr, otherwise we\ncan return uninitialized memory from the stack to the caller in the\nrecvfrom, recvmmsg and recvmsg syscalls. Drop the the (addr_len == NULL)\nchecks because we only get called with a valid addr_len pointer either\nfrom sock_common_recvmsg or inet_recvmsg.\n\nIf a blocking read waits on a socket which is concurrently shut down we\nnow return zero and set msg_msgnamelen to 0.\n\nReported-by: mpb <mpb.mail@gmail.com>\nSuggested-by: Eric Dumazet <eric.dumazet@gmail.com>\nSigned-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/ieee802154\/dgram.c |  3 +--\n net\/ipv4\/ping.c        | 19 +++++++------------\n net\/ipv4\/raw.c         |  4 +---\n net\/ipv4\/udp.c         |  7 +------\n net\/ipv6\/raw.c         |  4 +---\n net\/ipv6\/udp.c         |  5 +----\n net\/l2tp\/l2tp_ip.c     |  4 +---\n net\/phonet\/datagram.c  |  9 ++++-----\n 8 files changed, 17 insertions(+), 38 deletions(-)\n\n","diff_code":"diff --git a\/net\/ieee802154\/dgram.c b\/net\/ieee802154\/dgram.c\nindex 581a59504bd5..1865fdf5a5a5 100644\n--- a\/net\/ieee802154\/dgram.c\n+++ b\/net\/ieee802154\/dgram.c\n@@ -315,9 +315,8 @@ static int dgram_recvmsg(struct kiocb *iocb, struct sock *sk,\n \tif (saddr) {\n \t\tsaddr->family = AF_IEEE802154;\n \t\tsaddr->addr = mac_cb(skb)->sa;\n-\t}\n-\tif (addr_len)\n \t\t*addr_len = sizeof(*saddr);\n+\t}\n \n \tif (flags & MSG_TRUNC)\n \t\tcopied = skb->len;\ndiff --git a\/net\/ipv4\/ping.c b\/net\/ipv4\/ping.c\nindex 9afbdb19f4a2..aacefa0caa36 100644\n--- a\/net\/ipv4\/ping.c\n+++ b\/net\/ipv4\/ping.c\n@@ -830,8 +830,6 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n {\n \tstruct inet_sock *isk = inet_sk(sk);\n \tint family = sk->sk_family;\n-\tstruct sockaddr_in *sin;\n-\tstruct sockaddr_in6 *sin6;\n \tstruct sk_buff *skb;\n \tint copied, err;\n \n@@ -841,13 +839,6 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \tif (flags & MSG_OOB)\n \t\tgoto out;\n \n-\tif (addr_len) {\n-\t\tif (family == AF_INET)\n-\t\t\t*addr_len = sizeof(*sin);\n-\t\telse if (family == AF_INET6 && addr_len)\n-\t\t\t*addr_len = sizeof(*sin6);\n-\t}\n-\n \tif (flags & MSG_ERRQUEUE) {\n \t\tif (family == AF_INET) {\n \t\t\treturn ip_recv_error(sk, msg, len);\n@@ -877,11 +868,13 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \n \t\/* Copy the address and add cmsg data. *\/\n \tif (family == AF_INET) {\n-\t\tsin = (struct sockaddr_in *) msg->msg_name;\n+\t\tstruct sockaddr_in *sin = (struct sockaddr_in *)msg->msg_name;\n+\n \t\tsin->sin_family = AF_INET;\n \t\tsin->sin_port = 0 \/* skb->h.uh->source *\/;\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tmemset(sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \n \t\tif (isk->cmsg_flags)\n \t\t\tip_cmsg_recv(msg, skb);\n@@ -890,17 +883,19 @@ int ping_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \t} else if (family == AF_INET6) {\n \t\tstruct ipv6_pinfo *np = inet6_sk(sk);\n \t\tstruct ipv6hdr *ip6 = ipv6_hdr(skb);\n-\t\tsin6 = (struct sockaddr_in6 *) msg->msg_name;\n+\t\tstruct sockaddr_in6 *sin6 =\n+\t\t\t(struct sockaddr_in6 *)msg->msg_name;\n+\n \t\tsin6->sin6_family = AF_INET6;\n \t\tsin6->sin6_port = 0;\n \t\tsin6->sin6_addr = ip6->saddr;\n-\n \t\tsin6->sin6_flowinfo = 0;\n \t\tif (np->sndflow)\n \t\t\tsin6->sin6_flowinfo = ip6_flowinfo(ip6);\n \n \t\tsin6->sin6_scope_id = ipv6_iface_scope_id(&sin6->sin6_addr,\n \t\t\t\t\t\t\t  IP6CB(skb)->iif);\n+\t\t*addr_len = sizeof(*sin6);\n \n \t\tif (inet6_sk(sk)->rxopt.all)\n \t\t\tpingv6_ops.ip6_datagram_recv_ctl(sk, msg, skb);\ndiff --git a\/net\/ipv4\/raw.c b\/net\/ipv4\/raw.c\nindex 41e1d2845c8f..5cb8ddb505ee 100644\n--- a\/net\/ipv4\/raw.c\n+++ b\/net\/ipv4\/raw.c\n@@ -696,9 +696,6 @@ static int raw_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \tif (flags & MSG_OOB)\n \t\tgoto out;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(*sin);\n-\n \tif (flags & MSG_ERRQUEUE) {\n \t\terr = ip_recv_error(sk, msg, len);\n \t\tgoto out;\n@@ -726,6 +723,7 @@ static int raw_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tsin->sin_port = 0;\n \t\tmemset(&sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \t}\n \tif (inet->cmsg_flags)\n \t\tip_cmsg_recv(msg, skb);\ndiff --git a\/net\/ipv4\/udp.c b\/net\/ipv4\/udp.c\nindex 89909dd730dd..998431cd471a 100644\n--- a\/net\/ipv4\/udp.c\n+++ b\/net\/ipv4\/udp.c\n@@ -1235,12 +1235,6 @@ int udp_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *msg,\n \tint is_udplite = IS_UDPLITE(sk);\n \tbool slow;\n \n-\t\/*\n-\t *\tCheck any passed addresses\n-\t *\/\n-\tif (addr_len)\n-\t\t*addr_len = sizeof(*sin);\n-\n \tif (flags & MSG_ERRQUEUE)\n \t\treturn ip_recv_error(sk, msg, len);\n \n@@ -1302,6 +1296,7 @@ try_again:\n \t\tsin->sin_port = udp_hdr(skb)->source;\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tmemset(sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \t}\n \tif (inet->cmsg_flags)\n \t\tip_cmsg_recv(msg, skb);\ndiff --git a\/net\/ipv6\/raw.c b\/net\/ipv6\/raw.c\nindex 3c00842b0079..e24ff1df0401 100644\n--- a\/net\/ipv6\/raw.c\n+++ b\/net\/ipv6\/raw.c\n@@ -465,9 +465,6 @@ static int rawv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \tif (flags & MSG_OOB)\n \t\treturn -EOPNOTSUPP;\n \n-\tif (addr_len)\n-\t\t*addr_len=sizeof(*sin6);\n-\n \tif (flags & MSG_ERRQUEUE)\n \t\treturn ipv6_recv_error(sk, msg, len);\n \n@@ -506,6 +503,7 @@ static int rawv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \t\tsin6->sin6_flowinfo = 0;\n \t\tsin6->sin6_scope_id = ipv6_iface_scope_id(&sin6->sin6_addr,\n \t\t\t\t\t\t\t  IP6CB(skb)->iif);\n+\t\t*addr_len = sizeof(*sin6);\n \t}\n \n \tsock_recv_ts_and_drops(msg, sk, skb);\ndiff --git a\/net\/ipv6\/udp.c b\/net\/ipv6\/udp.c\nindex f3893e897f72..81eb8cf8389b 100644\n--- a\/net\/ipv6\/udp.c\n+++ b\/net\/ipv6\/udp.c\n@@ -392,9 +392,6 @@ int udpv6_recvmsg(struct kiocb *iocb, struct sock *sk,\n \tint is_udp4;\n \tbool slow;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(struct sockaddr_in6);\n-\n \tif (flags & MSG_ERRQUEUE)\n \t\treturn ipv6_recv_error(sk, msg, len);\n \n@@ -480,7 +477,7 @@ try_again:\n \t\t\t\tipv6_iface_scope_id(&sin6->sin6_addr,\n \t\t\t\t\t\t    IP6CB(skb)->iif);\n \t\t}\n-\n+\t\t*addr_len = sizeof(*sin6);\n \t}\n \tif (is_udp4) {\n \t\tif (inet->cmsg_flags)\ndiff --git a\/net\/l2tp\/l2tp_ip.c b\/net\/l2tp\/l2tp_ip.c\nindex 571db8dd2292..da1a1cee1a08 100644\n--- a\/net\/l2tp\/l2tp_ip.c\n+++ b\/net\/l2tp\/l2tp_ip.c\n@@ -518,9 +518,6 @@ static int l2tp_ip_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *m\n \tif (flags & MSG_OOB)\n \t\tgoto out;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(*sin);\n-\n \tskb = skb_recv_datagram(sk, flags, noblock, &err);\n \tif (!skb)\n \t\tgoto out;\n@@ -543,6 +540,7 @@ static int l2tp_ip_recvmsg(struct kiocb *iocb, struct sock *sk, struct msghdr *m\n \t\tsin->sin_addr.s_addr = ip_hdr(skb)->saddr;\n \t\tsin->sin_port = 0;\n \t\tmemset(&sin->sin_zero, 0, sizeof(sin->sin_zero));\n+\t\t*addr_len = sizeof(*sin);\n \t}\n \tif (inet->cmsg_flags)\n \t\tip_cmsg_recv(msg, skb);\ndiff --git a\/net\/phonet\/datagram.c b\/net\/phonet\/datagram.c\nindex 12c30f3e643e..38946b26e471 100644\n--- a\/net\/phonet\/datagram.c\n+++ b\/net\/phonet\/datagram.c\n@@ -139,9 +139,6 @@ static int pn_recvmsg(struct kiocb *iocb, struct sock *sk,\n \t\t\tMSG_CMSG_COMPAT))\n \t\tgoto out_nofree;\n \n-\tif (addr_len)\n-\t\t*addr_len = sizeof(sa);\n-\n \tskb = skb_recv_datagram(sk, flags, noblock, &rval);\n \tif (skb == NULL)\n \t\tgoto out_nofree;\n@@ -162,8 +159,10 @@ static int pn_recvmsg(struct kiocb *iocb, struct sock *sk,\n \n \trval = (flags & MSG_TRUNC) ? skb->len : copylen;\n \n-\tif (msg->msg_name != NULL)\n-\t\tmemcpy(msg->msg_name, &sa, sizeof(struct sockaddr_pn));\n+\tif (msg->msg_name != NULL) {\n+\t\tmemcpy(msg->msg_name, &sa, sizeof(sa));\n+\t\t*addr_len = sizeof(sa);\n+\t}\n \n out:\n \tskb_free_datagram(sk, skb);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-9526","CWE_ID":"200","category":"security","commit_id":"5a22de904a0a366ae79f03ff1e13a1232a89e26b","commit_message":"From 5a22de904a0a366ae79f03ff1e13a1232a89e26b Mon Sep 17 00:00:00 2001\nFrom: Jo Van Bulck <jo.vanbulck@cs.kuleuven.be>\nDate: Thu, 19 Jan 2017 17:00:15 +0100\nSubject: [PATCH] ecc: Store EdDSA session key in secure memory.\n\n* cipher\/ecc-eddsa.c (_gcry_ecc_eddsa_sign): use mpi_snew to allocate\nsession key.\n--\n\nAn attacker who learns the EdDSA session key from side-channel\nobservation during the signing process, can easily revover the long-\nterm secret key. Storing the session key in secure memory ensures that\nconstant time point operations are used in the MPI library.\n\nSigned-off-by: Jo Van Bulck <jo.vanbulck@cs.kuleuven.be>\n---\n cipher\/ecc-eddsa.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/cipher\/ecc-eddsa.c b\/cipher\/ecc-eddsa.c\nindex f91f8489..813e030d 100644\n--- a\/cipher\/ecc-eddsa.c\n+++ b\/cipher\/ecc-eddsa.c\n@@ -603,7 +603,7 @@ _gcry_ecc_eddsa_sign (gcry_mpi_t input, ECC_secret_key *skey,\n   a = mpi_snew (0);\n   x = mpi_new (0);\n   y = mpi_new (0);\n-  r = mpi_new (0);\n+  r = mpi_snew (0);\n   ctx = _gcry_mpi_ec_p_internal_new (skey->E.model, skey->E.dialect, 0,\n                                      skey->E.p, skey->E.a, skey->E.b);\n   b = (ctx->nbits+7)\/8;\n-- \n2.11.0\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2013-3225","CWE_ID":"200","category":"security","commit_id":"e11e0455c0d7d3d62276a0c55d9dfbc16779d691","commit_message":"From e11e0455c0d7d3d62276a0c55d9dfbc16779d691 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:50 +0000\nSubject: Bluetooth: RFCOMM - Fix missing msg_namelen update in\n rfcomm_sock_recvmsg()\n\nIf RFCOMM_DEFER_SETUP is set in the flags, rfcomm_sock_recvmsg() returns\nearly with 0 without updating the possibly set msg_namelen member. This,\nin turn, leads to a 128 byte kernel stack leak in net\/socket.c.\n\nFix this by updating msg_namelen in this case. For all other cases it\nwill be handled in bt_sock_stream_recvmsg().\n\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Gustavo Padovan <gustavo@padovan.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/bluetooth\/rfcomm\/sock.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/bluetooth\/rfcomm\/sock.c b\/net\/bluetooth\/rfcomm\/sock.c\nindex c23bae86263b..7c9224bcce17 100644\n--- a\/net\/bluetooth\/rfcomm\/sock.c\n+++ b\/net\/bluetooth\/rfcomm\/sock.c\n@@ -608,6 +608,7 @@ static int rfcomm_sock_recvmsg(struct kiocb *iocb, struct socket *sock,\n \n \tif (test_and_clear_bit(RFCOMM_DEFER_SETUP, &d->flags)) {\n \t\trfcomm_dlc_accept(d);\n+\t\tmsg->msg_namelen = 0;\n \t\treturn 0;\n \t}\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2014-9895","CWE_ID":"200","category":"security","commit_id":"c88e739b1fad662240e99ecbd0bdaac871717987","commit_message":"From c88e739b1fad662240e99ecbd0bdaac871717987 Mon Sep 17 00:00:00 2001\nFrom: Dan Carpenter <dan.carpenter@oracle.com>\nDate: Sat, 13 Apr 2013 06:32:15 -0300\nSubject: [PATCH] [media] media: info leak in __media_device_enum_links()\n\nThese structs have holes and reserved struct members which aren't\ncleared.  I've added a memset() so we don't leak stack information.\n\nSigned-off-by: Dan Carpenter <dan.carpenter@oracle.com>\nSigned-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>\nSigned-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>\n---\n drivers\/media\/media-device.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/drivers\/media\/media-device.c b\/drivers\/media\/media-device.c\nindex 1957c0df08fdb..d5a7a135f75d3 100644\n--- a\/drivers\/media\/media-device.c\n+++ b\/drivers\/media\/media-device.c\n@@ -142,6 +142,8 @@ static long __media_device_enum_links(struct media_device *mdev,\n \n \t\tfor (p = 0; p < entity->num_pads; p++) {\n \t\t\tstruct media_pad_desc pad;\n+\n+\t\t\tmemset(&pad, 0, sizeof(pad));\n \t\t\tmedia_device_kpad_to_upad(&entity->pads[p], &pad);\n \t\t\tif (copy_to_user(&links->pads[p], &pad, sizeof(pad)))\n \t\t\t\treturn -EFAULT;\n@@ -159,6 +161,7 @@ static long __media_device_enum_links(struct media_device *mdev,\n \t\t\tif (entity->links[l].source->entity != entity)\n \t\t\t\tcontinue;\n \n+\t\t\tmemset(&link, 0, sizeof(link));\n \t\t\tmedia_device_kpad_to_upad(entity->links[l].source,\n \t\t\t\t\t\t  &link.source);\n \t\t\tmedia_device_kpad_to_upad(entity->links[l].sink,\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2012-6545","CWE_ID":"200","category":"security","commit_id":"9ad2de43f1aee7e7274a4e0d41465489299e344b","commit_message":"From 9ad2de43f1aee7e7274a4e0d41465489299e344b Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:48 +0000\nSubject: Bluetooth: RFCOMM - Fix info leak in getsockopt(BT_SECURITY)\n\nThe RFCOMM code fails to initialize the key_size member of struct\nbt_security before copying it to userland -- that for leaking one\nbyte kernel stack. Initialize key_size with 0 to avoid the info\nleak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Gustavo Padovan <gustavo@padovan.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/bluetooth\/rfcomm\/sock.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/bluetooth\/rfcomm\/sock.c b\/net\/bluetooth\/rfcomm\/sock.c\nindex 7e1e59645c05..64f55ca61472 100644\n--- a\/net\/bluetooth\/rfcomm\/sock.c\n+++ b\/net\/bluetooth\/rfcomm\/sock.c\n@@ -822,6 +822,7 @@ static int rfcomm_sock_getsockopt(struct socket *sock, int level, int optname, c\n \t\t}\n \n \t\tsec.level = rfcomm_pi(sk)->sec_level;\n+\t\tsec.key_size = 0;\n \n \t\tlen = min_t(unsigned int, len, sizeof(sec));\n \t\tif (copy_to_user(optval, (char *) &sec, len))\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2014-1739","CWE_ID":"200","category":"security","commit_id":"e6a623460e5fc960ac3ee9f946d3106233fd28d8","commit_message":"From e6a623460e5fc960ac3ee9f946d3106233fd28d8 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Salva=20Peir=C3=B3?= <speiro@ai2.upv.es>\nDate: Wed, 30 Apr 2014 19:48:02 +0200\nSubject: [PATCH] [media] media-device: fix infoleak in ioctl\n media_enum_entities()\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nThis fixes CVE-2014-1739.\n\nSigned-off-by: Salva Peir\u00f3 <speiro@ai2.upv.es>\nAcked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>\nCc: stable@vger.kernel.org\nSigned-off-by: Mauro Carvalho Chehab <m.chehab@samsung.com>\n---\n drivers\/media\/media-device.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/drivers\/media\/media-device.c b\/drivers\/media\/media-device.c\nindex d5a7a135f75d3..703560fa5e73b 100644\n--- a\/drivers\/media\/media-device.c\n+++ b\/drivers\/media\/media-device.c\n@@ -93,6 +93,7 @@ static long media_device_enum_entities(struct media_device *mdev,\n \tstruct media_entity *ent;\n \tstruct media_entity_desc u_ent;\n \n+\tmemset(&u_ent, 0, sizeof(u_ent));\n \tif (copy_from_user(&u_ent.id, &uent->id, sizeof(u_ent.id)))\n \t\treturn -EFAULT;\n \n","owner":"mjg59","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2010-4073","CWE_ID":"200","category":"security","commit_id":"03145beb455cf5c20a761e8451e30b8a74ba58d9","commit_message":"From 03145beb455cf5c20a761e8451e30b8a74ba58d9 Mon Sep 17 00:00:00 2001\nFrom: Dan Rosenberg <drosenberg@vsecurity.com>\nDate: Wed, 27 Oct 2010 15:34:17 -0700\nSubject: ipc: initialize structure memory to zero for compat functions\n\nThis takes care of leaking uninitialized kernel stack memory to\nuserspace from non-zeroed fields in structs in compat ipc functions.\n\nSigned-off-by: Dan Rosenberg <drosenberg@vsecurity.com>\nCc: Manfred Spraul <manfred@colorfullife.com>\nCc: Arnd Bergmann <arnd@arndb.de>\nCc: <stable@kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n---\n ipc\/compat.c    | 6 ++++++\n ipc\/compat_mq.c | 5 +++++\n 2 files changed, 11 insertions(+)\n\n","diff_code":"diff --git a\/ipc\/compat.c b\/ipc\/compat.c\nindex 9dc2c7d3c9e6..845a28738d3a 100644\n--- a\/ipc\/compat.c\n+++ b\/ipc\/compat.c\n@@ -241,6 +241,8 @@ long compat_sys_semctl(int first, int second, int third, void __user *uptr)\n \tstruct semid64_ds __user *up64;\n \tint version = compat_ipc_parse_version(&third);\n \n+\tmemset(&s64, 0, sizeof(s64));\n+\n \tif (!uptr)\n \t\treturn -EINVAL;\n \tif (get_user(pad, (u32 __user *) uptr))\n@@ -421,6 +423,8 @@ long compat_sys_msgctl(int first, int second, void __user *uptr)\n \tint version = compat_ipc_parse_version(&second);\n \tvoid __user *p;\n \n+\tmemset(&m64, 0, sizeof(m64));\n+\n \tswitch (second & (~IPC_64)) {\n \tcase IPC_INFO:\n \tcase IPC_RMID:\n@@ -594,6 +598,8 @@ long compat_sys_shmctl(int first, int second, void __user *uptr)\n \tint err, err2;\n \tint version = compat_ipc_parse_version(&second);\n \n+\tmemset(&s64, 0, sizeof(s64));\n+\n \tswitch (second & (~IPC_64)) {\n \tcase IPC_RMID:\n \tcase SHM_LOCK:\ndiff --git a\/ipc\/compat_mq.c b\/ipc\/compat_mq.c\nindex d8d1e9ff4e88..380ea4fe08e7 100644\n--- a\/ipc\/compat_mq.c\n+++ b\/ipc\/compat_mq.c\n@@ -53,6 +53,9 @@ asmlinkage long compat_sys_mq_open(const char __user *u_name,\n \tvoid __user *p = NULL;\n \tif (u_attr && oflag & O_CREAT) {\n \t\tstruct mq_attr attr;\n+\n+\t\tmemset(&attr, 0, sizeof(attr));\n+\n \t\tp = compat_alloc_user_space(sizeof(attr));\n \t\tif (get_compat_mq_attr(&attr, u_attr) ||\n \t\t    copy_to_user(p, &attr, sizeof(attr)))\n@@ -127,6 +130,8 @@ asmlinkage long compat_sys_mq_getsetattr(mqd_t mqdes,\n \tstruct mq_attr __user *p = compat_alloc_user_space(2 * sizeof(*p));\n \tlong ret;\n \n+\tmemset(&mqstat, 0, sizeof(mqstat));\n+\n \tif (u_mqstat) {\n \t\tif (get_compat_mq_attr(&mqstat, u_mqstat) ||\n \t\t    copy_to_user(p, &mqstat, sizeof(mqstat)))\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"mjg59","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2009-3228","CWE_ID":"200","category":"security","commit_id":"16ebb5e0b36ceadc8186f71d68b0c4fa4b6e781b","commit_message":"From 16ebb5e0b36ceadc8186f71d68b0c4fa4b6e781b Mon Sep 17 00:00:00 2001\nFrom: Eric Dumazet <eric.dumazet@gmail.com>\nDate: Wed, 2 Sep 2009 02:40:09 +0000\nSubject: tc: Fix unitialized kernel memory leak\n\nThree bytes of uninitialized kernel memory are currently leaked to user\n\nSigned-off-by: Eric Dumazet <eric.dumazet@gmail.com>\nReviewed-by: Jiri Pirko <jpirko@redhat.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/sched\/sch_api.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/net\/sched\/sch_api.c b\/net\/sched\/sch_api.c\nindex 24d17ce9c294..fdb694e9f759 100644\n--- a\/net\/sched\/sch_api.c\n+++ b\/net\/sched\/sch_api.c\n@@ -1456,6 +1456,8 @@ static int tc_fill_tclass(struct sk_buff *skb, struct Qdisc *q,\n \tnlh = NLMSG_NEW(skb, pid, seq, event, sizeof(*tcm), flags);\n \ttcm = NLMSG_DATA(nlh);\n \ttcm->tcm_family = AF_UNSPEC;\n+\ttcm->tcm__pad1 = 0;\n+\ttcm->tcm__pad2 = 0;\n \ttcm->tcm_ifindex = qdisc_dev(q)->ifindex;\n \ttcm->tcm_parent = q->handle;\n \ttcm->tcm_handle = q->handle;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2009-3612","CWE_ID":"200","category":"security","commit_id":"ad61df918c44316940404891d5082c63e79c256a","commit_message":"From ad61df918c44316940404891d5082c63e79c256a Mon Sep 17 00:00:00 2001\nFrom: Jiri Pirko <jpirko@redhat.com>\nDate: Thu, 8 Oct 2009 01:21:46 -0700\nSubject: netlink: fix typo in initialization\n\nCommit 9ef1d4c7c7aca1cd436612b6ca785b726ffb8ed8 (\"[NETLINK]: Missing\ninitializations in dumped data\") introduced a typo in\ninitialization. This patch fixes this.\n\nSigned-off-by: Jiri Pirko <jpirko@redhat.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/sched\/cls_api.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/net\/sched\/cls_api.c b\/net\/sched\/cls_api.c\nindex 6a536949cdc0..7cf6c0fbc7a6 100644\n--- a\/net\/sched\/cls_api.c\n+++ b\/net\/sched\/cls_api.c\n@@ -350,7 +350,7 @@ static int tcf_fill_node(struct sk_buff *skb, struct tcf_proto *tp,\n \ttcm = NLMSG_DATA(nlh);\n \ttcm->tcm_family = AF_UNSPEC;\n \ttcm->tcm__pad1 = 0;\n-\ttcm->tcm__pad1 = 0;\n+\ttcm->tcm__pad2 = 0;\n \ttcm->tcm_ifindex = qdisc_dev(tp->q)->ifindex;\n \ttcm->tcm_parent = tp->classid;\n \ttcm->tcm_info = TC_H_MAKE(tp->prio, tp->protocol);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2013-3227","CWE_ID":"200","category":"security","commit_id":"2d6fbfe733f35c6b355c216644e08e149c61b271","commit_message":"From 2d6fbfe733f35c6b355c216644e08e149c61b271 Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Sun, 7 Apr 2013 01:51:52 +0000\nSubject: caif: Fix missing msg_namelen update in caif_seqpkt_recvmsg()\n\nThe current code does not fill the msg_name member in case it is set.\nIt also does not set the msg_namelen member to 0 and therefore makes\nnet\/socket.c leak the local, uninitialized sockaddr_storage variable\nto userland -- 128 bytes of kernel stack memory.\n\nFix that by simply setting msg_namelen to 0 as obviously nobody cared\nabout caif_seqpkt_recvmsg() not filling the msg_name in case it was\nset.\n\nCc: Sjur Braendeland <sjur.brandeland@stericsson.com>\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/caif\/caif_socket.c | 2 ++\n 1 file changed, 2 insertions(+)\n\n","diff_code":"diff --git a\/net\/caif\/caif_socket.c b\/net\/caif\/caif_socket.c\nindex 095259f83902..ff2ff3ce6965 100644\n--- a\/net\/caif\/caif_socket.c\n+++ b\/net\/caif\/caif_socket.c\n@@ -286,6 +286,8 @@ static int caif_seqpkt_recvmsg(struct kiocb *iocb, struct socket *sock,\n \tif (m->msg_flags&MSG_OOB)\n \t\tgoto read_error;\n \n+\tm->msg_namelen = 0;\n+\n \tskb = skb_recv_datagram(sk, flags, 0 , &ret);\n \tif (!skb)\n \t\tgoto read_error;\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-4569","CWE_ID":"200","category":"security","commit_id":"cec8f96e49d9be372fdb0c3836dcf31ec71e457e","commit_message":"From cec8f96e49d9be372fdb0c3836dcf31ec71e457e Mon Sep 17 00:00:00 2001\nFrom: Kangjie Lu <kangjielu@gmail.com>\nDate: Tue, 3 May 2016 16:44:07 -0400\nSubject: [PATCH] ALSA: timer: Fix leak in SNDRV_TIMER_IOCTL_PARAMS\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nThe stack object \u201ctread\u201d has a total size of 32 bytes. Its field\n\u201cevent\u201d and \u201cval\u201d both contain 4 bytes padding. These 8 bytes\npadding bytes are sent to user without being initialized.\n\nSigned-off-by: Kangjie Lu <kjlu@gatech.edu>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>\n---\n sound\/core\/timer.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/sound\/core\/timer.c b\/sound\/core\/timer.c\nindex 0cfc028c1193f..306a93dea20a9 100644\n--- a\/sound\/core\/timer.c\n+++ b\/sound\/core\/timer.c\n@@ -1737,6 +1737,7 @@ static int snd_timer_user_params(struct file *file,\n \tif (tu->timeri->flags & SNDRV_TIMER_IFLG_EARLY_EVENT) {\n \t\tif (tu->tread) {\n \t\t\tstruct snd_timer_tread tread;\n+\t\t\tmemset(&tread, 0, sizeof(tread));\n \t\t\ttread.event = SNDRV_TIMER_EVENT_EARLY;\n \t\t\ttread.tstamp.tv_sec = 0;\n \t\t\ttread.tstamp.tv_nsec = 0;\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2011-1170","CWE_ID":"200","category":"security","commit_id":"42eab94fff18cb1091d3501cd284d6bd6cc9c143","commit_message":"From 42eab94fff18cb1091d3501cd284d6bd6cc9c143 Mon Sep 17 00:00:00 2001\nFrom: Vasiliy Kulikov <segoon@openwall.com>\nDate: Tue, 15 Mar 2011 13:35:21 +0100\nSubject: netfilter: arp_tables: fix infoleak to userspace\n\nStructures ipt_replace, compat_ipt_replace, and xt_get_revision are\ncopied from userspace.  Fields of these structs that are\nzero-terminated strings are not checked.  When they are used as argument\nto a format string containing \"%s\" in request_module(), some sensitive\ninformation is leaked to userspace via argument of spawned modprobe\nprocess.\n\nThe first bug was introduced before the git epoch;  the second is\nintroduced by 6b7d31fc (v2.6.15-rc1);  the third is introduced by\n6b7d31fc (v2.6.15-rc1).  To trigger the bug one should have\nCAP_NET_ADMIN.\n\nSigned-off-by: Vasiliy Kulikov <segoon@openwall.com>\nSigned-off-by: Patrick McHardy <kaber@trash.net>\n---\n net\/ipv4\/netfilter\/arp_tables.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/net\/ipv4\/netfilter\/arp_tables.c b\/net\/ipv4\/netfilter\/arp_tables.c\nindex e95054c690c6..4b5d457c2d76 100644\n--- a\/net\/ipv4\/netfilter\/arp_tables.c\n+++ b\/net\/ipv4\/netfilter\/arp_tables.c\n@@ -1066,6 +1066,7 @@ static int do_replace(struct net *net, const void __user *user,\n \t\/* overflow check *\/\n \tif (tmp.num_counters >= INT_MAX \/ sizeof(struct xt_counters))\n \t\treturn -ENOMEM;\n+\ttmp.name[sizeof(tmp.name)-1] = 0;\n \n \tnewinfo = xt_alloc_table_info(tmp.size);\n \tif (!newinfo)\n@@ -1488,6 +1489,7 @@ static int compat_do_replace(struct net *net, void __user *user,\n \t\treturn -ENOMEM;\n \tif (tmp.num_counters >= INT_MAX \/ sizeof(struct xt_counters))\n \t\treturn -ENOMEM;\n+\ttmp.name[sizeof(tmp.name)-1] = 0;\n \n \tnewinfo = xt_alloc_table_info(tmp.size);\n \tif (!newinfo)\n@@ -1740,6 +1742,7 @@ static int do_arpt_get_ctl(struct sock *sk, int cmd, void __user *user, int *len\n \t\t\tret = -EFAULT;\n \t\t\tbreak;\n \t\t}\n+\t\trev.name[sizeof(rev.name)-1] = 0;\n \n \t\ttry_then_request_module(xt_find_revision(NFPROTO_ARP, rev.name,\n \t\t\t\t\t\t\t rev.revision, 1, &ret),\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2012-6546","CWE_ID":"200","category":"security","commit_id":"3c0c5cfdcd4d69ffc4b9c0907cec99039f30a50a","commit_message":"From 3c0c5cfdcd4d69ffc4b9c0907cec99039f30a50a Mon Sep 17 00:00:00 2001\nFrom: Mathias Krause <minipli@googlemail.com>\nDate: Wed, 15 Aug 2012 11:31:45 +0000\nSubject: [PATCH] atm: fix info leak via getsockname()\n\nThe ATM code fails to initialize the two padding bytes of struct\nsockaddr_atmpvc inserted for alignment. Add an explicit memset(0)\nbefore filling the structure to avoid the info leak.\n\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/atm\/pvc.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/net\/atm\/pvc.c b\/net\/atm\/pvc.c\nindex 3a734919c36cb..ae0324021407c 100644\n--- a\/net\/atm\/pvc.c\n+++ b\/net\/atm\/pvc.c\n@@ -95,6 +95,7 @@ static int pvc_getname(struct socket *sock, struct sockaddr *sockaddr,\n \t\treturn -ENOTCONN;\n \t*sockaddr_len = sizeof(struct sockaddr_atmpvc);\n \taddr = (struct sockaddr_atmpvc *)sockaddr;\n+\tmemset(addr, 0, sizeof(*addr));\n \taddr->sap_family = AF_ATMPVC;\n \taddr->sap_addr.itf = vcc->dev->number;\n \taddr->sap_addr.vpi = vcc->vpi;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2013-2061","CWE_ID":"200","category":"security","commit_id":"11d21349a4e7e38a025849479b36ace7c2eec2ee","commit_message":"From 11d21349a4e7e38a025849479b36ace7c2eec2ee Mon Sep 17 00:00:00 2001\nFrom: Steffan Karger <steffan.karger@fox-it.com>\nDate: Tue, 19 Mar 2013 13:01:50 +0100\nSubject: [PATCH] Use constant time memcmp when comparing HMACs in\n openvpn_decrypt.\n\nSigned-off-by: Steffan Karger <steffan.karger@fox-it.com>\nAcked-by: Gert Doering <gert@greenie.muc.de>\nSigned-off-by: Gert Doering <gert@greenie.muc.de>\n---\n src\/openvpn\/buffer.h |  8 ++++++++\n src\/openvpn\/crypto.c | 20 +++++++++++++++++++-\n 2 files changed, 27 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/src\/openvpn\/buffer.h b\/src\/openvpn\/buffer.h\nindex 7cae7337d..93efb0962 100644\n--- a\/src\/openvpn\/buffer.h\n+++ b\/src\/openvpn\/buffer.h\n@@ -668,6 +668,10 @@ buf_read_u32 (struct buffer *buf, bool *good)\n     }\n }\n \n+\/**\n+ * Compare src buffer contents with match.\n+ * *NOT* constant time. Do not use when comparing HMACs.\n+ *\/\n static inline bool\n buf_string_match (const struct buffer *src, const void *match, int size)\n {\n@@ -676,6 +680,10 @@ buf_string_match (const struct buffer *src, const void *match, int size)\n   return memcmp (BPTR (src), match, size) == 0;\n }\n \n+\/**\n+ * Compare first size bytes of src buffer contents with match.\n+ * *NOT* constant time. Do not use when comparing HMACs.\n+ *\/\n static inline bool\n buf_string_match_head (const struct buffer *src, const void *match, int size)\n {\ndiff --git a\/src\/openvpn\/crypto.c b\/src\/openvpn\/crypto.c\nindex 405c0aac2..d9adf5b51 100644\n--- a\/src\/openvpn\/crypto.c\n+++ b\/src\/openvpn\/crypto.c\n@@ -65,6 +65,24 @@\n #define CRYPT_ERROR(format) \\\n   do { msg (D_CRYPT_ERRORS, \"%s: \" format, error_prefix); goto error_exit; } while (false)\n \n+\/**\n+ * As memcmp(), but constant-time.\n+ * Returns 0 when data is equal, non-zero otherwise.\n+ *\/\n+static int\n+memcmp_constant_time (const void *a, const void *b, size_t size) {\n+  const uint8_t * a1 = a;\n+  const uint8_t * b1 = b;\n+  int ret = 0;\n+  size_t i;\n+\n+  for (i = 0; i < size; i++) {\n+      ret |= *a1++ ^ *b1++;\n+  }\n+\n+  return ret;\n+}\n+\n void\n openvpn_encrypt (struct buffer *buf, struct buffer work,\n \t\t const struct crypto_options *opt,\n@@ -244,7 +262,7 @@ openvpn_decrypt (struct buffer *buf, struct buffer work,\n \t  hmac_ctx_final (ctx->hmac, local_hmac);\n \n \t  \/* Compare locally computed HMAC with packet HMAC *\/\n-\t  if (memcmp (local_hmac, BPTR (buf), hmac_len))\n+\t  if (memcmp_constant_time (local_hmac, BPTR (buf), hmac_len))\n \t    CRYPT_ERROR (\"packet HMAC authentication failed\");\n \n \t  ASSERT (buf_advance (buf, hmac_len));\n","owner":"OpenVPN","repo":"openvpn","source":"cve"},{"CVE_ID":"CVE-2018-18837","CWE_ID":"200","category":"security","commit_id":"92327c9ec211bd1616315abcb255861b130b97ca","commit_message":"From 92327c9ec211bd1616315abcb255861b130b97ca Mon Sep 17 00:00:00 2001\nFrom: Costa Tsaousis <costa@tsaousis.gr>\nDate: Tue, 30 Oct 2018 02:35:57 +0200\nSubject: [PATCH] fixed vulnerabilities identified by red4sec.com (#4521)\n\n---\n libnetdata\/url\/url.c |  4 +++-\n web\/api\/web_api_v1.c | 17 +++++++++++++++++\n 2 files changed, 20 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/libnetdata\/url\/url.c b\/libnetdata\/url\/url.c\nindex 8a96063a03..07a9f8069e 100644\n--- a\/libnetdata\/url\/url.c\n+++ b\/libnetdata\/url\/url.c\n@@ -60,7 +60,9 @@ char *url_decode_r(char *to, char *url, size_t size) {\n     while(*s && d < e) {\n         if(unlikely(*s == '%')) {\n             if(likely(s[1] && s[2])) {\n-                *d++ = from_hex(s[1]) << 4 | from_hex(s[2]);\n+                char t = from_hex(s[1]) << 4 | from_hex(s[2]);\n+                \/\/ avoid HTTP header injection\n+                *d++ = (char)((isprint(t))? t : ' ');\n                 s += 2;\n             }\n         }\ndiff --git a\/web\/api\/web_api_v1.c b\/web\/api\/web_api_v1.c\nindex 0c0242c3ca..1e03828e40 100644\n--- a\/web\/api\/web_api_v1.c\n+++ b\/web\/api\/web_api_v1.c\n@@ -233,6 +233,15 @@ inline int web_client_api_request_v1_chart(RRDHOST *host, struct web_client *w,\n     return web_client_api_request_single_chart(host, w, url, rrd_stats_api_v1_chart);\n }\n \n+void fix_google_param(char *s) {\n+    if(unlikely(!s)) return;\n+\n+    for( ; *s ;s++) {\n+        if(!isalnum(*s) && *s != '.' && *s != '_' && *s != '-')\n+            *s = '_';\n+    }\n+}\n+\n \/\/ returns the HTTP code\n inline int web_client_api_request_v1_data(RRDHOST *host, struct web_client *w, char *url) {\n     debug(D_WEB_CLIENT, \"%llu: API v1 data with URL '%s'\", w->id, url);\n@@ -332,6 +341,14 @@ inline int web_client_api_request_v1_data(RRDHOST *host, struct web_client *w, c\n         }\n     }\n \n+    \/\/ validate the google parameters given\n+    fix_google_param(google_out);\n+    fix_google_param(google_sig);\n+    fix_google_param(google_reqId);\n+    fix_google_param(google_version);\n+    fix_google_param(responseHandler);\n+    fix_google_param(outFileName);\n+\n     if(!chart || !*chart) {\n         buffer_sprintf(w->response.data, \"No chart id is given at the request.\");\n         goto cleanup;\n","owner":"netdata","repo":"netdata","source":"cve"},{"CVE_ID":"CVE-2015-5330","CWE_ID":"200","category":"security","commit_id":"7f51ec8c4ed9ba1f53d722e44fb6fb3cde933b72","commit_message":"From 7f51ec8c4ed9ba1f53d722e44fb6fb3cde933b72 Mon Sep 17 00:00:00 2001\nFrom: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>\nDate: Tue, 24 Nov 2015 13:07:23 +1300\nSubject: [PATCH] CVE-2015-5330: ldb_dn: simplify and fix\n ldb_dn_escape_internal()\n\nPreviously we relied on NUL terminated strings and jumped back and\nforth between copying escaped bytes and memcpy()ing un-escaped chunks.\nThis simple version is easier to reason about and works with\nunterminated strings. It may also be faster as it avoids reading the\nstring twice (first with strcspn, then with memcpy).\n\nBug: https:\/\/bugzilla.samba.org\/show_bug.cgi?id=11599\n\nSigned-off-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>\nPair-programmed-with: Andrew Bartlett <abartlet@samba.org>\nReviewed-by: Ralph Boehme <slow@samba.org>\n---\n lib\/ldb\/common\/ldb_dn.c | 46 ++++++++++++++++-------------------------\n 1 file changed, 18 insertions(+), 28 deletions(-)\n\n","diff_code":"diff --git a\/lib\/ldb\/common\/ldb_dn.c b\/lib\/ldb\/common\/ldb_dn.c\nindex 85f89c1b06d..d39eb8caec1 100644\n--- a\/lib\/ldb\/common\/ldb_dn.c\n+++ b\/lib\/ldb\/common\/ldb_dn.c\n@@ -189,33 +189,23 @@ struct ldb_dn *ldb_dn_new_fmt(TALLOC_CTX *mem_ctx,\n \/* see RFC2253 section 2.4 *\/\n static int ldb_dn_escape_internal(char *dst, const char *src, int len)\n {\n-\tconst char *p, *s;\n+\tchar c;\n \tchar *d;\n-\tsize_t l;\n-\n-\tp = s = src;\n+\tint i;\n \td = dst;\n \n-\twhile (p - src < len) {\n-\t\tp += strcspn(p, \",=\\n\\r+<>#;\\\\\\\" \");\n-\n-\t\tif (p - src == len) \/* found no escapable chars *\/\n-\t\t\tbreak;\n-\n-\t\t\/* copy the part of the string before the stop *\/\n-\t\tmemcpy(d, s, p - s);\n-\t\td += (p - s); \/* move to current position *\/\n-\t\t\n-\t\tswitch (*p) {\n+\tfor (i = 0; i < len; i++){\n+\t\tc = src[i];\n+\t\tswitch (c) {\n \t\tcase ' ':\n-\t\t\tif (p == src || (p-src)==(len-1)) {\n+\t\t\tif (i == 0 || i == len - 1) {\n \t\t\t\t\/* if at the beginning or end\n \t\t\t\t * of the string then escape *\/\n \t\t\t\t*d++ = '\\\\';\n-\t\t\t\t*d++ = *p++;\t\t\t\t\t \n+\t\t\t\t*d++ = c;\n \t\t\t} else {\n \t\t\t\t\/* otherwise don't escape *\/\n-\t\t\t\t*d++ = *p++;\n+\t\t\t\t*d++ = c;\n \t\t\t}\n \t\t\tbreak;\n \n@@ -231,30 +221,30 @@ static int ldb_dn_escape_internal(char *dst, const char *src, int len)\n \t\tcase '?':\n \t\t\t\/* these must be escaped using \\c form *\/\n \t\t\t*d++ = '\\\\';\n-\t\t\t*d++ = *p++;\n+\t\t\t*d++ = c;\n \t\t\tbreak;\n \n-\t\tdefault: {\n+\t\tcase ';':\n+\t\tcase '\\r':\n+\t\tcase '\\n':\n+\t\tcase '=':\n+\t\tcase '\\0': {\n \t\t\t\/* any others get \\XX form *\/\n \t\t\tunsigned char v;\n \t\t\tconst char *hexbytes = \"0123456789ABCDEF\";\n-\t\t\tv = *(const unsigned char *)p;\n+\t\t\tv = (const unsigned char)c;\n \t\t\t*d++ = '\\\\';\n \t\t\t*d++ = hexbytes[v>>4];\n \t\t\t*d++ = hexbytes[v&0xF];\n-\t\t\tp++;\n \t\t\tbreak;\n \t\t}\n+\t\tdefault:\n+\t\t\t*d++ = c;\n \t\t}\n-\t\ts = p; \/* move forward *\/\n \t}\n \n-\t\/* copy the last part (with zero) and return *\/\n-\tl = len - (s - src);\n-\tmemcpy(d, s, l + 1);\n-\n \t\/* return the length of the resulting string *\/\n-\treturn (l + (d - dst));\n+\treturn (d - dst);\n }\n \n char *ldb_dn_escape_value(TALLOC_CTX *mem_ctx, struct ldb_val value)\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-0377","CWE_ID":"200","category":"security","commit_id":"665baf5ed5c6186d973c46cdea165c0548027350","commit_message":"From 665baf5ed5c6186d973c46cdea165c0548027350 Mon Sep 17 00:00:00 2001\nFrom: Nick Mathewson <nickm@torproject.org>\nDate: Wed, 28 Jun 2017 11:41:50 -0400\nSubject: [PATCH] Consider the exit family when applying guard restrictions.\n\nWhen the new path selection logic went into place, I accidentally\ndropped the code that considered the _family_ of the exit node when\ndeciding if the guard was usable, and we didn't catch that during\ncode review.\n\nThis patch makes the guard_restriction_t code consider the exit\nfamily as well, and adds some (hopefully redundant) checks for the\ncase where we lack a node_t for a guard but we have a bridge_info_t\nfor it.\n\nFixes bug 22753; bugfix on 0.3.0.1-alpha. Tracked as TROVE-2016-006\nand CVE-2017-0377.\n---\n changes\/bug22753    |  7 +++++++\n src\/or\/entrynodes.c | 39 ++++++++++++++++++++++++++++++++++++++-\n src\/or\/entrynodes.h |  9 +++++----\n src\/or\/nodelist.c   |  2 +-\n src\/or\/nodelist.h   |  2 ++\n 5 files changed, 53 insertions(+), 6 deletions(-)\n create mode 100644 changes\/bug22753\n\n","diff_code":"diff --git a\/changes\/bug22753 b\/changes\/bug22753\nnew file mode 100644\nindex 0000000000..32a6dfa56c\n--- \/dev\/null\n+++ b\/changes\/bug22753\n@@ -0,0 +1,7 @@\n+  o Major bugfixes (path selection, security):\n+    - When choosing which guard to use for a circuit, avoid the\n+      exit's family along with the exit itself. Previously, the new\n+      guard selection logic avoided the exit, but did not consider\n+      its family.  Fixes bug 22753; bugfix on 0.3.0.1-alpha. Tracked\n+      as TROVE-2016-006 and CVE-2017-0377.\n+\ndiff --git a\/src\/or\/entrynodes.c b\/src\/or\/entrynodes.c\nindex aba35e69f7..ccb080880c 100644\n--- a\/src\/or\/entrynodes.c\n+++ b\/src\/or\/entrynodes.c\n@@ -1428,6 +1428,38 @@ entry_guard_passes_filter(const or_options_t *options, guard_selection_t *gs,\n   }\n }\n \n+\/** Return true iff <b>guard<\/b> is in the same family as <b>node<\/b>.\n+ *\/\n+static int\n+guard_in_node_family(const entry_guard_t *guard, const node_t *node)\n+{\n+  const node_t *guard_node = node_get_by_id(guard->identity);\n+  if (guard_node) {\n+    return nodes_in_same_family(guard_node, node);\n+  } else {\n+    \/* If we don't have a node_t for the guard node, we might have\n+     * a bridge_info_t for it. So let's check to see whether the bridge\n+     * address matches has any family issues.\n+     *\n+     * (Strictly speaking, I believe this check is unnecessary, since we only\n+     * use it to avoid the exit's family when building circuits, and we don't\n+     * build multihop circuits until we have a routerinfo_t for the\n+     * bridge... at which point, we'll also have a node_t for the\n+     * bridge. Nonetheless, it seems wise to include it, in case our\n+     * assumptions change down the road.  -nickm.)\n+     *\/\n+    if (get_options()->EnforceDistinctSubnets && guard->bridge_addr) {\n+      tor_addr_t node_addr;\n+      node_get_addr(node, &node_addr);\n+      if (addrs_in_same_network_family(&node_addr,\n+                                       &guard->bridge_addr->addr)) {\n+        return 1;\n+      }\n+    }\n+    return 0;\n+  }\n+}\n+\n \/**\n  * Return true iff <b>guard<\/b> obeys the restrictions defined in <b>rst<\/b>.\n  * (If <b>rst<\/b> is NULL, there are no restrictions.)\n@@ -1440,7 +1472,12 @@ entry_guard_obeys_restriction(const entry_guard_t *guard,\n   if (! rst)\n     return 1; \/\/ No restriction?  No problem.\n \n-  \/\/ Only one kind of restriction exists right now\n+  \/\/ Only one kind of restriction exists right now: excluding an exit\n+  \/\/ ID and all of its family.\n+  const node_t *node = node_get_by_id((const char*)rst->exclude_id);\n+  if (node && guard_in_node_family(guard, node))\n+    return 0;\n+\n   return tor_memneq(guard->identity, rst->exclude_id, DIGEST_LEN);\n }\n \ndiff --git a\/src\/or\/entrynodes.h b\/src\/or\/entrynodes.h\nindex f02901f5d7..6ccc48f32f 100644\n--- a\/src\/or\/entrynodes.h\n+++ b\/src\/or\/entrynodes.h\n@@ -276,16 +276,17 @@ struct entry_guard_handle_t;\n  * A restriction to remember which entry guards are off-limits for a given\n  * circuit.\n  *\n- * Right now, we only use restrictions to block a single guard from being\n- * selected; this mechanism is designed to be more extensible in the future,\n- * however.\n+ * Right now, we only use restrictions to block a single guard and its family\n+ * from being selected; this mechanism is designed to be more extensible in\n+ * the future, however.\n  *\n  * Note: This mechanism is NOT for recording which guards are never to be\n  * used: only which guards cannot be used on <em>one particular circuit<\/em>.\n  *\/\n struct entry_guard_restriction_t {\n   \/**\n-   * The guard's RSA identity digest must not equal this.\n+   * The guard's RSA identity digest must not equal this; and it must not\n+   * be in the same family as any node with this digest.\n    *\/\n   uint8_t exclude_id[DIGEST_LEN];\n };\ndiff --git a\/src\/or\/nodelist.c b\/src\/or\/nodelist.c\nindex 96e95baf5a..2ca52e74b5 100644\n--- a\/src\/or\/nodelist.c\n+++ b\/src\/or\/nodelist.c\n@@ -1343,7 +1343,7 @@ nodelist_refresh_countries(void)\n \n \/** Return true iff router1 and router2 have similar enough network addresses\n  * that we should treat them as being in the same family *\/\n-static inline int\n+int\n addrs_in_same_network_family(const tor_addr_t *a1,\n                              const tor_addr_t *a2)\n {\ndiff --git a\/src\/or\/nodelist.h b\/src\/or\/nodelist.h\nindex 8456d21c6c..4e5301df6b 100644\n--- a\/src\/or\/nodelist.h\n+++ b\/src\/or\/nodelist.h\n@@ -94,6 +94,8 @@ int node_is_unreliable(const node_t *router, int need_uptime,\n int router_exit_policy_all_nodes_reject(const tor_addr_t *addr, uint16_t port,\n                                         int need_uptime);\n void router_set_status(const char *digest, int up);\n+int addrs_in_same_network_family(const tor_addr_t *a1,\n+                                 const tor_addr_t *a2);\n \n \/** router_have_minimum_dir_info tests to see if we have enough\n  * descriptor information to create circuits.\n","owner":"torproject","repo":"tor","source":"cve"},{"CVE_ID":"CVE-2017-9993","CWE_ID":"200","category":"security","commit_id":"a5d849b149ca67ced2d271dc84db0bc95a548abb","commit_message":"From a5d849b149ca67ced2d271dc84db0bc95a548abb Mon Sep 17 00:00:00 2001\nFrom: Michael Niedermayer <michael@niedermayer.cc>\nDate: Tue, 30 May 2017 21:29:20 +0200\nSubject: [PATCH] avformat\/avidec: Limit formats in gab2 to srt and ass\/ssa\n\nThis prevents part of one exploit leading to an information leak\n\nFound-by: Emil Lerner and Pavel Cheremushkin\nReported-by: Thierry Foucu <tfoucu@google.com>\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n---\n libavformat\/avidec.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/libavformat\/avidec.c b\/libavformat\/avidec.c\nindex b6ef0ac62d0..df520920671 100644\n--- a\/libavformat\/avidec.c\n+++ b\/libavformat\/avidec.c\n@@ -1099,6 +1099,9 @@ static int read_gab2_sub(AVFormatContext *s, AVStream *st, AVPacket *pkt)\n         if (!sub_demuxer)\n             goto error;\n \n+        if (strcmp(sub_demuxer->name, \"srt\") && strcmp(sub_demuxer->name, \"ass\"))\n+            goto error;\n+\n         if (!(ast->sub_ctx = avformat_alloc_context()))\n             goto error;\n \n","owner":"FFmpeg","repo":"FFmpeg","source":"cve"},{"CVE_ID":"CVE-2015-7665","CWE_ID":"200","category":"security","commit_id":"075d7556964f5a871a73c22ac4b69f5361295099","commit_message":"From 075d7556964f5a871a73c22ac4b69f5361295099 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Tim=20R=C3=BChsen?= <tim.ruehsen@gmx.de>\nDate: Tue, 11 Aug 2015 16:48:08 +0200\nSubject: Fix IP address exposure in FTP code\n\n* src\/ftp.c (getftp): Do not use PORT when PASV fails.\n* tests\/FTPServer.px: Add pasv_not_supported server flag.\n* tests\/Makefile.am: Add Test-ftp-pasv-not-supported.px\n* tests\/Test-ftp-pasv-not-supported.px: New test\n\nFix IP address exposure when automatically falling back from\npassive mode to active mode (using the PORT command). A behavior that\nmay be used to expose a client's privacy even when using a proxy.\n---\n NEWS                                 |  2 ++\n src\/ftp.c                            | 19 +++++++-----\n tests\/FTPServer.pm                   |  8 +++++\n tests\/Makefile.am                    |  3 +-\n tests\/Test-ftp-pasv-not-supported.px | 60 ++++++++++++++++++++++++++++++++++++\n 5 files changed, 84 insertions(+), 8 deletions(-)\n create mode 100755 tests\/Test-ftp-pasv-not-supported.px\n\n","diff_code":"diff --git a\/NEWS b\/NEWS\nindex 50d9196..d84744a 100644\n--- a\/NEWS\n+++ b\/NEWS\n@@ -9,6 +9,8 @@ Please send GNU Wget bug reports to <bug-wget@gnu.org>.\n \n * Changes in Wget X.Y.Z\n \n+** Remove FTP passive to active fallback due to privacy concerns\n+\n ** Add support for --if-modified-since\n \n ** Add support for metalink through --input-metalink and --metalink-over-http\ndiff --git a\/src\/ftp.c b\/src\/ftp.c\nindex 68f1a33..9dab99c 100644\n--- a\/src\/ftp.c\n+++ b\/src\/ftp.c\n@@ -252,7 +252,6 @@ getftp (struct url *u, wgint passed_expected_bytes, wgint *qtyread,\n   char *respline, *tms;\n   const char *user, *passwd, *tmrate;\n   int cmd = con->cmd;\n-  bool pasv_mode_open = false;\n   wgint expected_bytes = 0;\n   bool got_expected_bytes = false;\n   bool rest_failed = false;\n@@ -883,13 +882,19 @@ Error in server response, closing control connection.\\n\"));\n                           ? CONERROR : CONIMPOSSIBLE);\n                 }\n \n-              pasv_mode_open = true;  \/* Flag to avoid accept port *\/\n               if (!opt.server_response)\n                 logputs (LOG_VERBOSE, _(\"done.    \"));\n-            } \/* err==FTP_OK *\/\n-        }\n+            }\n+          else\n+            return err;\n \n-      if (!pasv_mode_open)   \/* Try to use a port command if PASV failed *\/\n+          \/*\n+           * We do not want to fall back from PASSIVE mode to ACTIVE mode !\n+           * The reason is the PORT command exposes the client's real IP address\n+           * to the server. Bad for someone who relies on privacy via a ftp proxy.\n+           *\/\n+        }\n+      else\n         {\n           err = ftp_do_port (csock, &local_sock);\n           \/* FTPRERR, WRITEFAILED, bindport (FTPSYSERR), HOSTERR,\n@@ -1148,8 +1153,8 @@ Error in server response, closing control connection.\\n\"));\n     }\n \n   \/* If no transmission was required, then everything is OK.  *\/\n-  if (!pasv_mode_open)  \/* we are not using pasive mode so we need\n-                              to accept *\/\n+  if (!opt.ftp_pasv)  \/* we are not using passive mode so we need\n+                         to accept *\/\n     {\n       \/* Wait for the server to connect to the address we're waiting\n          at.  *\/\ndiff --git a\/tests\/FTPServer.pm b\/tests\/FTPServer.pm\nindex c0a6e47..a5185d6 100644\n--- a\/tests\/FTPServer.pm\n+++ b\/tests\/FTPServer.pm\n@@ -740,6 +740,14 @@ sub run\n                     last;\n                 }\n \n+                if (defined($self->{_server_behavior}{pasv_not_supported})\n+                    && $cmd eq 'PASV')\n+                {\n+                    print {$conn->{socket}}\n+                      \"500 PASV not supported.\\r\\n\";\n+                    next;\n+                }\n+\n                 # Run the command.\n                 &{$command_table->{$cmd}}($conn, $cmd, $rest);\n             }\ndiff --git a\/tests\/Makefile.am b\/tests\/Makefile.am\nindex 5d387aa..daf162f 100644\n--- a\/tests\/Makefile.am\n+++ b\/tests\/Makefile.am\n@@ -127,7 +127,8 @@ PX_TESTS = \\\n              Test--start-pos.px \\\n              Test--start-pos--continue.px \\\n              Test--httpsonly-r.px \\\n-             Test-204.px\n+             Test-204.px \\\n+             Test-ftp-pasv-not-supported.px\n \n EXTRA_DIST = FTPServer.pm FTPTest.pm HTTPServer.pm HTTPTest.pm \\\n              WgetTests.pm WgetFeature.pm WgetFeature.cfg $(PX_TESTS) \\\ndiff --git a\/tests\/Test-ftp-pasv-not-supported.px b\/tests\/Test-ftp-pasv-not-supported.px\nnew file mode 100755\nindex 0000000..97d0610\n--- \/dev\/null\n+++ b\/tests\/Test-ftp-pasv-not-supported.px\n@@ -0,0 +1,60 @@\n+#!\/usr\/bin\/env perl\n+\n+use strict;\n+use warnings;\n+\n+use FTPTest;\n+\n+# This test checks whether Wget *does not* fall back from passive mode to\n+# active mode using a PORT command. Wget <= 1.16.3 made a fallback exposing\n+# the client's real IP address to the remote FTP server.\n+#\n+# This behavior circumvents expected privacy when using a proxy \/ proxy network (e.g. Tor).\n+#\n+# Wget >= 1.16.4 does it right. This test checks it.\n+\n+###############################################################################\n+\n+# From bug report 10.08.2015 from tomtidaly@sigaint.org\n+my $afile = <<EOF;\n+FTP PORT command code in v1.16.3?\n+\n+In the past it could be possible for a site over http connection to\n+redirect wget to FPT using FTP PORT command so the site gets the real IP\n+of the computer even when wget proxy command is in use I believe:\n+https:\/\/lists.torproject.org\/pipermail\/tor-talk\/2012-April\/024040.html\n+\n+Is that code still present in wget v1.16.3? It was present in v1.13.4.\n+EOF\n+\n+$afile =~ s\/\\n\/\\r\\n\/g;\n+\n+\n+# code, msg, headers, content\n+my %urls = (\n+    '\/afile.txt' => {\n+        content => $afile,\n+    },\n+);\n+\n+my $cmdline = $WgetTest::WGETPATH . \" -S ftp:\/\/localhost:{{port}}\/afile.txt\";\n+\n+my $expected_error_code = 8;\n+\n+my %expected_downloaded_files = (\n+    'afile.txt' => {\n+        content => $afile,\n+    },\n+);\n+\n+###############################################################################\n+\n+my $the_test = FTPTest->new (\n+                             server_behavior => {pasv_not_supported => 1},\n+                             input => \\%urls,\n+                             cmdline => $cmdline,\n+                             errcode => $expected_error_code,\n+                             output => \\%expected_downloaded_files);\n+exit !$the_test->run();\n+\n+# vim: et ts=4 sw=4\n-- \ncgit v1.0-41-gc330\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-13143","CWE_ID":"200","category":"security","commit_id":"51b0ae01709adc1e4a9245e158ef17b85a110960","commit_message":"From 51b0ae01709adc1e4a9245e158ef17b85a110960 Mon Sep 17 00:00:00 2001\nFrom: Cristy <urban-warrior@imagemagick.org>\nDate: Thu, 26 Jan 2017 11:22:42 -0500\nSubject: [PATCH] https:\/\/github.com\/ImageMagick\/ImageMagick\/issues\/362\n\n---\n coders\/mat.c | 1 +\n 1 file changed, 1 insertion(+)\n\n","diff_code":"diff --git a\/coders\/mat.c b\/coders\/mat.c\nindex e1623a82e8..cf2190bf37 100644\n--- a\/coders\/mat.c\n+++ b\/coders\/mat.c\n@@ -1123,6 +1123,7 @@ RestoreMSCWarning\n     BImgBuff = (unsigned char *) AcquireQuantumMemory((size_t) (ldblk),sizeof(double));    \/* Ldblk was set in the check phase *\/\n     if (BImgBuff == NULL)\n       ThrowReaderException(ResourceLimitError,\"MemoryAllocationFailed\");\n+    (void) ResetMagickMemory(BImgBuff,0,ldblk*sizeof(double));\n \n     MinVal = 0;\n     MaxVal = 0;\n","owner":"ImageMagick","repo":"ImageMagick","source":"cve"},{"CVE_ID":"CVE-2015-3412","CWE_ID":"200","category":"security","commit_id":"4435b9142ff9813845d5c97ab29a5d637bedb257","commit_message":"From 4435b9142ff9813845d5c97ab29a5d637bedb257 Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Sun, 5 Apr 2015 16:01:24 -0700\nSubject: [PATCH] Fixed bug #69353 (Missing null byte checks for paths in\n various PHP extensions)\n\n---\n ext\/dom\/document.c                                 | 5 ++++-\n ext\/dom\/tests\/DOMDocument_loadHTMLfile_error2.phpt | 5 +++++\n ext\/fileinfo\/fileinfo.c                            | 5 +++++\n ext\/fileinfo\/tests\/finfo_file_basic.phpt           | 4 ++++\n ext\/gd\/gd.c                                        | 8 ++++----\n ext\/hash\/hash.c                                    | 7 ++++++-\n ext\/hash\/tests\/hash_hmac_file_error.phpt           | 7 +++++++\n ext\/pgsql\/pgsql.c                                  | 2 +-\n ext\/standard\/link.c                                | 2 +-\n ext\/standard\/streamsfuncs.c                        | 2 +-\n ext\/xmlwriter\/php_xmlwriter.c                      | 4 ++--\n ext\/zlib\/zlib.c                                    | 4 ++--\n 12 files changed, 42 insertions(+), 13 deletions(-)\n\n","diff_code":"diff --git a\/ext\/dom\/document.c b\/ext\/dom\/document.c\nindex f105f6d..4666746 100644\n--- a\/ext\/dom\/document.c\n+++ b\/ext\/dom\/document.c\n@@ -1580,6 +1580,9 @@ static xmlDocPtr dom_document_parser(zval *id, int mode, char *source, int sourc\n \txmlInitParser();\n \n \tif (mode == DOM_LOAD_FILE) {\n+\t\tif (CHECK_NULL_PATH(source, source_len)) {\n+\t\t\treturn NULL;\n+\t\t}\n \t\tchar *file_dest = _dom_get_valid_file_path(source, resolved_path, MAXPATHLEN  TSRMLS_CC);\n \t\tif (file_dest) {\n \t\t\tctxt = xmlCreateFileParserCtxt(file_dest);\n@@ -2168,7 +2171,7 @@ static void dom_load_html(INTERNAL_FUNCTION_PARAMETERS, int mode) \/* {{{ *\/\n \t\n \tid = getThis();\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s|l\", &source, &source_len, &options) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p|l\", &source, &source_len, &options) == FAILURE) {\n \t\treturn;\n \t}\n \ndiff --git a\/ext\/dom\/tests\/DOMDocument_loadHTMLfile_error2.phpt b\/ext\/dom\/tests\/DOMDocument_loadHTMLfile_error2.phpt\nindex e59ff56..75004e2 100644\n--- a\/ext\/dom\/tests\/DOMDocument_loadHTMLfile_error2.phpt\n+++ b\/ext\/dom\/tests\/DOMDocument_loadHTMLfile_error2.phpt\n@@ -13,6 +13,11 @@ assert.bail=true\n $doc = new DOMDocument();\n $result = $doc->loadHTMLFile(\"\");\n assert('$result === false');\n+$doc = new DOMDocument();\n+$result = $doc->loadHTMLFile(\"text.html\\0something\");\n+assert('$result === null');\n ?>\n --EXPECTF--\n %r(PHP ){0,1}%rWarning: DOMDocument::loadHTMLFile(): Empty string supplied as input %s\n+\n+%r(PHP ){0,1}%rWarning: DOMDocument::loadHTMLFile() expects parameter 1 to be a valid path, string given %s\ndiff --git a\/ext\/fileinfo\/fileinfo.c b\/ext\/fileinfo\/fileinfo.c\nindex 2d523ab..5fd9511 100644\n--- a\/ext\/fileinfo\/fileinfo.c\n+++ b\/ext\/fileinfo\/fileinfo.c\n@@ -506,6 +506,11 @@ static void _php_finfo_get_type(INTERNAL_FUNCTION_PARAMETERS, int mode, int mime\n \t\t\t\tRETVAL_FALSE;\n \t\t\t\tgoto clean;\n \t\t\t}\n+\t\t\tif (CHECK_NULL_PATH(buffer, buffer_len)) {\n+\t\t\t\tphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"Invalid path\");\n+\t\t\t\tRETVAL_FALSE;\n+\t\t\t\tgoto clean;\n+\t\t\t}\n \n \t\t\twrap = php_stream_locate_url_wrapper(buffer, &tmp2, 0 TSRMLS_CC);\n \ndiff --git a\/ext\/fileinfo\/tests\/finfo_file_basic.phpt b\/ext\/fileinfo\/tests\/finfo_file_basic.phpt\nindex 20223fd..ee70e2e 100644\n--- a\/ext\/fileinfo\/tests\/finfo_file_basic.phpt\n+++ b\/ext\/fileinfo\/tests\/finfo_file_basic.phpt\n@@ -19,6 +19,7 @@ echo \"*** Testing finfo_file() : basic functionality ***\\n\";\n var_dump( finfo_file( $finfo, __FILE__) );\n var_dump( finfo_file( $finfo, __FILE__, FILEINFO_CONTINUE ) );\n var_dump( finfo_file( $finfo, $magicFile ) );\n+var_dump( finfo_file( $finfo, $magicFile.chr(0).$magicFile) );\n \n ?>\n ===DONE===\n@@ -27,4 +28,7 @@ var_dump( finfo_file( $finfo, $magicFile ) );\n string(28) \"text\/x-php; charset=us-ascii\"\n string(22) \"PHP script, ASCII text\"\n string(25) \"text\/plain; charset=utf-8\"\n+\n+Warning: finfo_file(): Invalid path in %s\/finfo_file_basic.php on line %d\n+bool(false)\n ===DONE===\ndiff --git a\/ext\/gd\/gd.c b\/ext\/gd\/gd.c\nindex e5657f7..d258c3d 100644\n--- a\/ext\/gd\/gd.c\n+++ b\/ext\/gd\/gd.c\n@@ -1495,7 +1495,7 @@ PHP_FUNCTION(imageloadfont)\n \tgdFontPtr font;\n \tphp_stream *stream;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &file, &file_name) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p\", &file, &file_name) == FAILURE) {\n \t\treturn;\n \t}\n \n@@ -2438,7 +2438,7 @@ static void _php_image_create_from(INTERNAL_FUNCTION_PARAMETERS, int image_type,\n \tlong ignore_warning;\n #endif\n \tif (image_type == PHP_GDIMG_TYPE_GD2PART) {\n-\t\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"sllll\", &file, &file_len, &srcx, &srcy, &width, &height) == FAILURE) {\n+\t\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"pllll\", &file, &file_len, &srcx, &srcy, &width, &height) == FAILURE) {\n \t\t\treturn;\n \t\t}\n \t\tif (width < 1 || height < 1) {\n@@ -2446,7 +2446,7 @@ static void _php_image_create_from(INTERNAL_FUNCTION_PARAMETERS, int image_type,\n \t\t\tRETURN_FALSE;\n \t\t}\n \t} else {\n-\t\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &file, &file_len) == FAILURE) {\n+\t\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p\", &file, &file_len) == FAILURE) {\n \t\t\treturn;\n \t\t}\n \t}\n@@ -4178,7 +4178,7 @@ PHP_FUNCTION(imagepsencodefont)\n \tchar *enc, **enc_vector;\n \tint enc_len, *f_ind;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"rs\", &fnt, &enc, &enc_len) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"rp\", &fnt, &enc, &enc_len) == FAILURE) {\n \t\treturn;\n \t}\n \ndiff --git a\/ext\/hash\/hash.c b\/ext\/hash\/hash.c\nindex bd9dcca..f5988c9 100644\n--- a\/ext\/hash\/hash.c\n+++ b\/ext\/hash\/hash.c\n@@ -142,6 +142,7 @@ static void php_hash_do_hash(INTERNAL_FUNCTION_PARAMETERS, int isfilename, zend_\n \t}\n \tif (isfilename) {\n \t\tif (CHECK_NULL_PATH(data, data_len)) {\n+\t\t\tphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"Invalid path\");\n \t\t\tRETURN_FALSE;\n \t\t}\n \t\tstream = php_stream_open_wrapper_ex(data, \"rb\", REPORT_ERRORS, NULL, DEFAULT_CONTEXT);\n@@ -222,6 +223,10 @@ static void php_hash_do_hash_hmac(INTERNAL_FUNCTION_PARAMETERS, int isfilename,\n \t\tRETURN_FALSE;\n \t}\n \tif (isfilename) {\n+\t\tif (CHECK_NULL_PATH(data, data_len)) {\n+\t\t\tphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"Invalid path\");\n+\t\t\tRETURN_FALSE;\n+\t\t}\n \t\tstream = php_stream_open_wrapper_ex(data, \"rb\", REPORT_ERRORS, NULL, DEFAULT_CONTEXT);\n \t\tif (!stream) {\n \t\t\t\/* Stream will report errors opening file *\/\n@@ -449,7 +454,7 @@ PHP_FUNCTION(hash_update_file)\n \tchar *filename, buf[1024];\n \tint filename_len, n;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"rs|r\", &zhash, &filename, &filename_len, &zcontext) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"rp|r\", &zhash, &filename, &filename_len, &zcontext) == FAILURE) {\n \t\treturn;\n \t}\n \ndiff --git a\/ext\/hash\/tests\/hash_hmac_file_error.phpt b\/ext\/hash\/tests\/hash_hmac_file_error.phpt\nindex 42ab122..26ba8aa 100644\n--- a\/ext\/hash\/tests\/hash_hmac_file_error.phpt\n+++ b\/ext\/hash\/tests\/hash_hmac_file_error.phpt\n@@ -28,6 +28,9 @@ hash_hmac_file('crc32', $file, $key, TRUE, $extra_arg);\n echo \"\\n-- Testing hash_hmac_file() function with invalid hash algorithm --\\n\";\n hash_hmac_file('foo', $file, $key, TRUE);\n \n+echo \"\\n-- Testing hash_hmac_file() function with bad path --\\n\";\n+hash_hmac_file('crc32', $file.chr(0).$file, $key, TRUE);\n+\n ?>\n ===Done===\n --EXPECTF--\n@@ -51,4 +54,8 @@ Warning: hash_hmac_file() expects at most 4 parameters, 5 given in %s on line %d\n -- Testing hash_hmac_file() function with invalid hash algorithm --\n \n Warning: hash_hmac_file(): Unknown hashing algorithm: foo in %s on line %d\n+\n+-- Testing hash_hmac_file() function with bad path --\n+\n+Warning: hash_hmac_file(): Invalid path in %s on line %d\n ===Done===\n\\ No newline at end of file\ndiff --git a\/ext\/pgsql\/pgsql.c b\/ext\/pgsql\/pgsql.c\nindex eb55777..cd51143 100644\n--- a\/ext\/pgsql\/pgsql.c\n+++ b\/ext\/pgsql\/pgsql.c\n@@ -3014,7 +3014,7 @@ PHP_FUNCTION(pg_trace)\n \tphp_stream *stream;\n \tid = PGG(default_link);\n \n-\tif (zend_parse_parameters(argc TSRMLS_CC, \"s|sr\", &z_filename, &z_filename_len, &mode, &mode_len, &pgsql_link) == FAILURE) {\n+\tif (zend_parse_parameters(argc TSRMLS_CC, \"p|sr\", &z_filename, &z_filename_len, &mode, &mode_len, &pgsql_link) == FAILURE) {\n \t\treturn;\n \t}\n \ndiff --git a\/ext\/standard\/link.c b\/ext\/standard\/link.c\nindex c57484e..686dd3e 100644\n--- a\/ext\/standard\/link.c\n+++ b\/ext\/standard\/link.c\n@@ -59,7 +59,7 @@ PHP_FUNCTION(readlink)\n \tchar buff[MAXPATHLEN];\n \tint ret;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &link, &link_len) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p\", &link, &link_len) == FAILURE) {\n \t\treturn;\n \t}\n \ndiff --git a\/ext\/standard\/streamsfuncs.c b\/ext\/standard\/streamsfuncs.c\nindex b1b3180..b8f15e3 100644\n--- a\/ext\/standard\/streamsfuncs.c\n+++ b\/ext\/standard\/streamsfuncs.c\n@@ -1549,7 +1549,7 @@ PHP_FUNCTION(stream_resolve_include_path)\n \tchar *filename, *resolved_path;\n \tint filename_len;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &filename, &filename_len) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p\", &filename, &filename_len) == FAILURE) {\n \t\treturn;\n \t}\n \ndiff --git a\/ext\/xmlwriter\/php_xmlwriter.c b\/ext\/xmlwriter\/php_xmlwriter.c\nindex 7bc35da..acb8754 100644\n--- a\/ext\/xmlwriter\/php_xmlwriter.c\n+++ b\/ext\/xmlwriter\/php_xmlwriter.c\n@@ -1738,7 +1738,7 @@ static PHP_FUNCTION(xmlwriter_write_dtd_entity)\n \/* }}} *\/\n #endif\n \n-\/* {{{ proto resource xmlwriter_open_uri(resource xmlwriter, string source)\n+\/* {{{ proto resource xmlwriter_open_uri(string source)\n Create new xmlwriter using source uri for output *\/\n static PHP_FUNCTION(xmlwriter_open_uri)\n {\n@@ -1759,7 +1759,7 @@ static PHP_FUNCTION(xmlwriter_open_uri)\n \tvoid *ioctx;\n #endif\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &source, &source_len) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p\", &source, &source_len) == FAILURE) {\n \t\treturn;\n \t}\n \t\ndiff --git a\/ext\/zlib\/zlib.c b\/ext\/zlib\/zlib.c\nindex 705fb5d..431dfde 100644\n--- a\/ext\/zlib\/zlib.c\n+++ b\/ext\/zlib\/zlib.c\n@@ -581,7 +581,7 @@ static PHP_FUNCTION(gzopen)\n \tphp_stream *stream;\n \tlong use_include_path = 0;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"ss|l\", &filename, &filename_len, &mode, &mode_len, &use_include_path) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"ps|l\", &filename, &filename_len, &mode, &mode_len, &use_include_path) == FAILURE) {\n \t\treturn;\n \t}\n \n@@ -609,7 +609,7 @@ static PHP_FUNCTION(readgzfile)\n \tint size;\n \tlong use_include_path = 0;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s|l\", &filename, &filename_len, &use_include_path) == FAILURE) {\n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p|l\", &filename, &filename_len, &use_include_path) == FAILURE) {\n \t\treturn;\n \t}\n \n-- \n2.1.4\n\n","owner":"NA","repo":"NA","source":"cve"}]