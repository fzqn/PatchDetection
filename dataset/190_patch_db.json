[{"CVE_ID":"CVE-2017-5576","CWE_ID":"190","category":"security","commit_id":"0f2ff82e11c86c05d051cae32b58226392d33bbf","commit_message":"From 0f2ff82e11c86c05d051cae32b58226392d33bbf Mon Sep 17 00:00:00 2001\nFrom: Eric Anholt <eric@anholt.net>\nDate: Tue, 17 Jan 2017 21:42:53 +1100\nSubject: [PATCH] drm\/vc4: Fix an integer overflow in temporary allocation\n layout.\n\nWe copy the unvalidated ioctl arguments from the user into kernel\ntemporary memory to run the validation from, to avoid a race where the\nuser updates the unvalidate contents in between validating them and\ncopying them into the validated BO.\n\nHowever, in setting up the layout of the kernel side, we failed to\ncheck one of the additions (the roundup() for shader_rec_offset)\nagainst integer overflow, allowing a nearly MAX_UINT value of\nbin_cl_size to cause us to under-allocate the temporary space that we\nthen copy_from_user into.\n\nReported-by: Murray McAllister <murray.mcallister@insomniasec.com>\nSigned-off-by: Eric Anholt <eric@anholt.net>\nFixes: d5b1a78a772f (\"drm\/vc4: Add support for drawing 3D frames.\")\n---\n drivers\/gpu\/drm\/vc4\/vc4_gem.c | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/drivers\/gpu\/drm\/vc4\/vc4_gem.c b\/drivers\/gpu\/drm\/vc4\/vc4_gem.c\nindex db920771bfb56..c5fe3554858e5 100644\n--- a\/drivers\/gpu\/drm\/vc4\/vc4_gem.c\n+++ b\/drivers\/gpu\/drm\/vc4\/vc4_gem.c\n@@ -594,7 +594,8 @@ vc4_get_bcl(struct drm_device *dev, struct vc4_exec_info *exec)\n \t\t\t\t\t  args->shader_rec_count);\n \tstruct vc4_bo *bo;\n \n-\tif (uniforms_offset < shader_rec_offset ||\n+\tif (shader_rec_offset < args->bin_cl_size ||\n+\t    uniforms_offset < shader_rec_offset ||\n \t    exec_size < uniforms_offset ||\n \t    args->shader_rec_count >= (UINT_MAX \/\n \t\t\t\t\t  sizeof(struct vc4_shader_state)) ||\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2018-8795","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2016-7947","CWE_ID":"190","category":"security","commit_id":"a0df3e1c7728205e5c7650b2e6dce684139254a6","commit_message":"From a0df3e1c7728205e5c7650b2e6dce684139254a6 Mon Sep 17 00:00:00 2001\nFrom: Tobias Stoeckmann <tobias@stoeckmann.org>\nDate: Sun, 25 Sep 2016 22:21:40 +0200\nSubject: Avoid out of boundary accesses on illegal responses\n\nThe responses of the connected X server have to be properly checked\nto avoid out of boundary accesses that could otherwise be triggered\nby a malicious server.\n\nSigned-off-by: Tobias Stoeckmann <tobias@stoeckmann.org>\nReviewed-by: Matthieu Herrb <matthieu@herrb.eu>\n---\n src\/XrrConfig.c   | 32 +++++++++++++--------\n src\/XrrCrtc.c     | 83 ++++++++++++++++++++++++++++++++++++++++++-------------\n src\/XrrMonitor.c  | 18 ++++++++++++\n src\/XrrOutput.c   | 11 ++++++++\n src\/XrrProvider.c | 28 ++++++++++++++++---\n src\/XrrScreen.c   | 52 ++++++++++++++++++++++------------\n 6 files changed, 172 insertions(+), 52 deletions(-)\n\n","diff_code":"diff --git a\/src\/XrrConfig.c b\/src\/XrrConfig.c\nindex 2f0282b..e68c45a 100644\n--- a\/src\/XrrConfig.c\n+++ b\/src\/XrrConfig.c\n@@ -29,6 +29,7 @@\n #include <config.h>\n #endif\n \n+#include <limits.h>\n #include <stdio.h>\n #include <X11\/Xlib.h>\n \/* we need to be able to manipulate the Display structure on events *\/\n@@ -272,23 +273,30 @@ static XRRScreenConfiguration *_XRRGetScreenInfo (Display *dpy,\n \trep.rate = 0;\n \trep.nrateEnts = 0;\n     }\n+    if (rep.length < INT_MAX >> 2) {\n+\tnbytes = (long) rep.length << 2;\n \n-    nbytes = (long) rep.length << 2;\n+\tnbytesRead = (long) (rep.nSizes * SIZEOF (xScreenSizes) +\n+\t\t\t    ((rep.nrateEnts + 1)& ~1) * 2 \/* SIZEOF(CARD16) *\/);\n \n-    nbytesRead = (long) (rep.nSizes * SIZEOF (xScreenSizes) +\n-\t\t\t ((rep.nrateEnts + 1)& ~1) * 2 \/* SIZEOF (CARD16) *\/);\n+\t\/*\n+\t * first we must compute how much space to allocate for\n+\t * randr library's use; we'll allocate the structures in a single\n+\t * allocation, on cleanlyness grounds.\n+\t *\/\n \n-    \/*\n-     * first we must compute how much space to allocate for\n-     * randr library's use; we'll allocate the structures in a single\n-     * allocation, on cleanlyness grounds.\n-     *\/\n+\trbytes = sizeof (XRRScreenConfiguration) +\n+\t  (rep.nSizes * sizeof (XRRScreenSize) +\n+\t   rep.nrateEnts * sizeof (int));\n \n-    rbytes = sizeof (XRRScreenConfiguration) +\n-      (rep.nSizes * sizeof (XRRScreenSize) +\n-       rep.nrateEnts * sizeof (int));\n+\tscp = (struct _XRRScreenConfiguration *) Xmalloc(rbytes);\n+    } else {\n+\tnbytes = 0;\n+\tnbytesRead = 0;\n+\trbytes = 0;\n+\tscp = NULL;\n+    }\n \n-    scp = (struct _XRRScreenConfiguration *) Xmalloc(rbytes);\n     if (scp == NULL) {\n \t_XEatData (dpy, (unsigned long) nbytes);\n \treturn NULL;\ndiff --git a\/src\/XrrCrtc.c b\/src\/XrrCrtc.c\nindex 5ae35c5..6665092 100644\n--- a\/src\/XrrCrtc.c\n+++ b\/src\/XrrCrtc.c\n@@ -24,6 +24,7 @@\n #include <config.h>\n #endif\n \n+#include <limits.h>\n #include <stdio.h>\n #include <X11\/Xlib.h>\n \/* we need to be able to manipulate the Display structure on events *\/\n@@ -57,22 +58,33 @@ XRRGetCrtcInfo (Display *dpy, XRRScreenResources *resources, RRCrtc crtc)\n \treturn NULL;\n     }\n \n-    nbytes = (long) rep.length << 2;\n+    if (rep.length < INT_MAX >> 2)\n+    {\n+\tnbytes = (long) rep.length << 2;\n \n-    nbytesRead = (long) (rep.nOutput * 4 +\n-\t\t\t rep.nPossibleOutput * 4);\n+\tnbytesRead = (long) (rep.nOutput * 4 +\n+\t\t\t     rep.nPossibleOutput * 4);\n \n-    \/*\n-     * first we must compute how much space to allocate for\n-     * randr library's use; we'll allocate the structures in a single\n-     * allocation, on cleanlyness grounds.\n-     *\/\n+\t\/*\n+\t * first we must compute how much space to allocate for\n+\t * randr library's use; we'll allocate the structures in a single\n+\t * allocation, on cleanlyness grounds.\n+\t *\/\n \n-    rbytes = (sizeof (XRRCrtcInfo) +\n-\t      rep.nOutput * sizeof (RROutput) +\n-\t      rep.nPossibleOutput * sizeof (RROutput));\n+\trbytes = (sizeof (XRRCrtcInfo) +\n+\t\t  rep.nOutput * sizeof (RROutput) +\n+\t\t  rep.nPossibleOutput * sizeof (RROutput));\n+\n+\txci = (XRRCrtcInfo *) Xmalloc(rbytes);\n+    }\n+    else\n+    {\n+\tnbytes = 0;\n+\tnbytesRead = 0;\n+\trbytes = 0;\n+\txci = NULL;\n+    }\n \n-    xci = (XRRCrtcInfo *) Xmalloc(rbytes);\n     if (xci == NULL) {\n \t_XEatDataWords (dpy, rep.length);\n \tUnlockDisplay (dpy);\n@@ -194,12 +206,21 @@ XRRGetCrtcGamma (Display *dpy, RRCrtc crtc)\n     if (!_XReply (dpy, (xReply *) &rep, 0, xFalse))\n \tgoto out;\n \n-    nbytes = (long) rep.length << 2;\n+    if (rep.length < INT_MAX >> 2)\n+    {\n+\tnbytes = (long) rep.length << 2;\n \n-    \/* three channels of CARD16 data *\/\n-    nbytesRead = (rep.size * 2 * 3);\n+\t\/* three channels of CARD16 data *\/\n+\tnbytesRead = (rep.size * 2 * 3);\n \n-    crtc_gamma = XRRAllocGamma (rep.size);\n+\tcrtc_gamma = XRRAllocGamma (rep.size);\n+    }\n+    else\n+    {\n+\tnbytes = 0;\n+\tnbytesRead = 0;\n+\tcrtc_gamma = NULL;\n+    }\n \n     if (!crtc_gamma)\n     {\n@@ -357,7 +378,7 @@ XRRGetCrtcTransform (Display\t*dpy,\n     xRRGetCrtcTransformReq\t*req;\n     int\t\t\t\tmajor_version, minor_version;\n     XRRCrtcTransformAttributes\t*attr;\n-    char\t\t\t*extra = NULL, *e;\n+    char\t\t\t*extra = NULL, *end = NULL, *e;\n     int\t\t\t\tp;\n \n     *attributes = NULL;\n@@ -395,9 +416,17 @@ XRRGetCrtcTransform (Display\t*dpy,\n \telse\n \t{\n \t    int extraBytes = rep.length * 4 - CrtcTransformExtra;\n-\t    extra = Xmalloc (extraBytes);\n+\t    if (rep.length < INT_MAX \/ 4 &&\n+\t\trep.length * 4 >= CrtcTransformExtra) {\n+\t\textra = Xmalloc (extraBytes);\n+\t\tend = extra + extraBytes;\n+\t    } else\n+\t\textra = NULL;\n \t    if (!extra) {\n-\t\t_XEatDataWords (dpy, rep.length - (CrtcTransformExtra >> 2));\n+\t\tif (rep.length > (CrtcTransformExtra >> 2))\n+\t\t    _XEatDataWords (dpy, rep.length - (CrtcTransformExtra >> 2));\n+\t\telse\n+\t\t    _XEatDataWords (dpy, rep.length);\n \t\tUnlockDisplay (dpy);\n \t\tSyncHandle ();\n \t\treturn False;\n@@ -429,22 +458,38 @@ XRRGetCrtcTransform (Display\t*dpy,\n \n     e = extra;\n \n+    if (e + rep.pendingNbytesFilter > end) {\n+\tXFree (extra);\n+\treturn False;\n+    }\n     memcpy (attr->pendingFilter, e, rep.pendingNbytesFilter);\n     attr->pendingFilter[rep.pendingNbytesFilter] = '\\0';\n     e += (rep.pendingNbytesFilter + 3) & ~3;\n     for (p = 0; p < rep.pendingNparamsFilter; p++) {\n \tINT32\tf;\n+\tif (e + 4 > end) {\n+\t    XFree (extra);\n+\t    return False;\n+\t}\n \tmemcpy (&f, e, 4);\n \te += 4;\n \tattr->pendingParams[p] = (XFixed) f;\n     }\n     attr->pendingNparams = rep.pendingNparamsFilter;\n \n+    if (e + rep.currentNbytesFilter > end) {\n+\tXFree (extra);\n+\treturn False;\n+    }\n     memcpy (attr->currentFilter, e, rep.currentNbytesFilter);\n     attr->currentFilter[rep.currentNbytesFilter] = '\\0';\n     e += (rep.currentNbytesFilter + 3) & ~3;\n     for (p = 0; p < rep.currentNparamsFilter; p++) {\n \tINT32\tf;\n+\tif (e + 4 > end) {\n+\t    XFree (extra);\n+\t    return False;\n+\t}\n \tmemcpy (&f, e, 4);\n \te += 4;\n \tattr->currentParams[p] = (XFixed) f;\ndiff --git a\/src\/XrrMonitor.c b\/src\/XrrMonitor.c\nindex a9eaa7b..adc5330 100644\n--- a\/src\/XrrMonitor.c\n+++ b\/src\/XrrMonitor.c\n@@ -24,6 +24,7 @@\n #include <config.h>\n #endif\n \n+#include <limits.h>\n #include <stdio.h>\n #include <X11\/Xlib.h>\n \/* we need to be able to manipulate the Display structure on events *\/\n@@ -65,6 +66,15 @@ XRRGetMonitors(Display *dpy, Window window, Bool get_active, int *nmonitors)\n \treturn NULL;\n     }\n \n+    if (rep.length > INT_MAX >> 2 ||\n+\trep.nmonitors > INT_MAX \/ SIZEOF(xRRMonitorInfo) ||\n+\trep.noutputs > INT_MAX \/ 4 ||\n+\trep.nmonitors * SIZEOF(xRRMonitorInfo) > INT_MAX - rep.noutputs * 4) {\n+\t_XEatData (dpy, rep.length);\n+\tUnlockDisplay (dpy);\n+\tSyncHandle ();\n+\treturn NULL;\n+    }\n     nbytes = (long) rep.length << 2;\n     nmon = rep.nmonitors;\n     noutput = rep.noutputs;\n@@ -111,6 +121,14 @@ XRRGetMonitors(Display *dpy, Window window, Bool get_active, int *nmonitors)\n \t    mon[m].outputs = output;\n \t    buf += SIZEOF (xRRMonitorInfo);\n \t    xoutput = (CARD32 *) buf;\n+\t    if (xmon->noutput > rep.noutputs) {\n+\t        Xfree(buf);\n+\t        Xfree(mon);\n+\t        UnlockDisplay (dpy);\n+\t        SyncHandle ();\n+\t        return NULL;\n+\t    }\n+\t    rep.noutputs -= xmon->noutput;\n \t    for (o = 0; o < xmon->noutput; o++)\n \t\toutput[o] = xoutput[o];\n \t    output += xmon->noutput;\ndiff --git a\/src\/XrrOutput.c b\/src\/XrrOutput.c\nindex 85f0b6e..30f3d40 100644\n--- a\/src\/XrrOutput.c\n+++ b\/src\/XrrOutput.c\n@@ -25,6 +25,7 @@\n #include <config.h>\n #endif\n \n+#include <limits.h>\n #include <stdio.h>\n #include <X11\/Xlib.h>\n \/* we need to be able to manipulate the Display structure on events *\/\n@@ -60,6 +61,16 @@ XRRGetOutputInfo (Display *dpy, XRRScreenResources *resources, RROutput output)\n \treturn NULL;\n     }\n \n+    if (rep.length > INT_MAX >> 2 || rep.length < (OutputInfoExtra >> 2))\n+    {\n+        if (rep.length > (OutputInfoExtra >> 2))\n+\t    _XEatDataWords (dpy, rep.length - (OutputInfoExtra >> 2));\n+\telse\n+\t    _XEatDataWords (dpy, rep.length);\n+\tUnlockDisplay (dpy);\n+\tSyncHandle ();\n+\treturn NULL;\n+    }\n     nbytes = ((long) (rep.length) << 2) - OutputInfoExtra;\n \n     nbytesRead = (long) (rep.nCrtcs * 4 +\ndiff --git a\/src\/XrrProvider.c b\/src\/XrrProvider.c\nindex 9e620c7..d796cd0 100644\n--- a\/src\/XrrProvider.c\n+++ b\/src\/XrrProvider.c\n@@ -25,6 +25,7 @@\n #include <config.h>\n #endif\n \n+#include <limits.h>\n #include <stdio.h>\n #include <X11\/Xlib.h>\n \/* we need to be able to manipulate the Display structure on events *\/\n@@ -59,12 +60,20 @@ XRRGetProviderResources(Display *dpy, Window window)\n       return NULL;\n     }\n \n-    nbytes = (long) rep.length << 2;\n+    if (rep.length < INT_MAX >> 2) {\n+\tnbytes = (long) rep.length << 2;\n \n-    nbytesRead = (long) (rep.nProviders * 4);\n+\tnbytesRead = (long) (rep.nProviders * 4);\n \n-    rbytes = (sizeof(XRRProviderResources) + rep.nProviders * sizeof(RRProvider));\n-    xrpr = (XRRProviderResources *) Xmalloc(rbytes);\n+\trbytes = (sizeof(XRRProviderResources) + rep.nProviders *\n+\t\t  sizeof(RRProvider));\n+\txrpr = (XRRProviderResources *) Xmalloc(rbytes);\n+    } else {\n+\tnbytes = 0;\n+\tnbytesRead = 0;\n+\trbytes = 0;\n+\txrpr = NULL;\n+    }\n \n     if (xrpr == NULL) {\n        _XEatDataWords (dpy, rep.length);\n@@ -121,6 +130,17 @@ XRRGetProviderInfo(Display *dpy, XRRScreenResources *resources, RRProvider provi\n \treturn NULL;\n     }\n \n+    if (rep.length > INT_MAX >> 2 || rep.length < ProviderInfoExtra >> 2)\n+    {\n+\tif (rep.length < ProviderInfoExtra >> 2)\n+\t    _XEatDataWords (dpy, rep.length);\n+\telse\n+\t    _XEatDataWords (dpy, rep.length - (ProviderInfoExtra >> 2));\n+\tUnlockDisplay (dpy);\n+\tSyncHandle ();\n+\treturn NULL;\n+    }\n+\n     nbytes = ((long) rep.length << 2) - ProviderInfoExtra;\n \n     nbytesRead = (long)(rep.nCrtcs * 4 +\ndiff --git a\/src\/XrrScreen.c b\/src\/XrrScreen.c\nindex b8ce7e5..1f7ffe6 100644\n--- a\/src\/XrrScreen.c\n+++ b\/src\/XrrScreen.c\n@@ -24,6 +24,7 @@\n #include <config.h>\n #endif\n \n+#include <limits.h>\n #include <stdio.h>\n #include <X11\/Xlib.h>\n \/* we need to be able to manipulate the Display structure on events *\/\n@@ -105,27 +106,36 @@ doGetScreenResources (Display *dpy, Window window, int poll)\n \txrri->has_rates = _XRRHasRates (xrri->minor_version, xrri->major_version);\n     }\n \n-    nbytes = (long) rep.length << 2;\n+    if (rep.length < INT_MAX >> 2) {\n+\tnbytes = (long) rep.length << 2;\n \n-    nbytesRead = (long) (rep.nCrtcs * 4 +\n-\t\t\t rep.nOutputs * 4 +\n-\t\t\t rep.nModes * SIZEOF (xRRModeInfo) +\n-\t\t\t ((rep.nbytesNames + 3) & ~3));\n+\tnbytesRead = (long) (rep.nCrtcs * 4 +\n+\t\t\t     rep.nOutputs * 4 +\n+\t\t\t     rep.nModes * SIZEOF (xRRModeInfo) +\n+\t\t\t     ((rep.nbytesNames + 3) & ~3));\n \n-    \/*\n-     * first we must compute how much space to allocate for\n-     * randr library's use; we'll allocate the structures in a single\n-     * allocation, on cleanlyness grounds.\n-     *\/\n+\t\/*\n+\t * first we must compute how much space to allocate for\n+\t * randr library's use; we'll allocate the structures in a single\n+\t * allocation, on cleanlyness grounds.\n+\t *\/\n+\n+\trbytes = (sizeof (XRRScreenResources) +\n+\t\t  rep.nCrtcs * sizeof (RRCrtc) +\n+\t\t  rep.nOutputs * sizeof (RROutput) +\n+\t\t  rep.nModes * sizeof (XRRModeInfo) +\n+\t\t  rep.nbytesNames + rep.nModes);    \/* '\\0' terminate names *\/\n \n-    rbytes = (sizeof (XRRScreenResources) +\n-\t      rep.nCrtcs * sizeof (RRCrtc) +\n-\t      rep.nOutputs * sizeof (RROutput) +\n-\t      rep.nModes * sizeof (XRRModeInfo) +\n-\t      rep.nbytesNames + rep.nModes);\t\/* '\\0' terminate names *\/\n+\txrsr = (XRRScreenResources *) Xmalloc(rbytes);\n+\twire_names = (char *) Xmalloc (rep.nbytesNames);\n+    } else {\n+\tnbytes = 0;\n+\tnbytesRead = 0;\n+\trbytes = 0;\n+\txrsr = NULL;\n+\twire_names = NULL;\n+    }\n \n-    xrsr = (XRRScreenResources *) Xmalloc(rbytes);\n-    wire_names = (char *) Xmalloc (rep.nbytesNames);\n     if (xrsr == NULL || wire_names == NULL) {\n \tXfree (xrsr);\n \tXfree (wire_names);\n@@ -174,6 +184,14 @@ doGetScreenResources (Display *dpy, Window window, int poll)\n     wire_name = wire_names;\n     for (i = 0; i < rep.nModes; i++)  {\n \txrsr->modes[i].name = names;\n+\tif (xrsr->modes[i].nameLength > rep.nbytesNames) {\n+\t    Xfree (xrsr);\n+\t    Xfree (wire_names);\n+\t    UnlockDisplay (dpy);\n+\t    SyncHandle ();\n+\t    return NULL;\n+\t}\n+\trep.nbytesNames -= xrsr->modes[i].nameLength;\n \tmemcpy (names, wire_name, xrsr->modes[i].nameLength);\n \tnames[xrsr->modes[i].nameLength] = '\\0';\n \tnames += xrsr->modes[i].nameLength + 1;\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2014-0143","CWE_ID":"190","category":"security","commit_id":"db8a31d11d6a60f48d6817530640d75aa72a9a2f","commit_message":"From db8a31d11d6a60f48d6817530640d75aa72a9a2f Mon Sep 17 00:00:00 2001\nFrom: Kevin Wolf <kwolf@redhat.com>\nDate: Wed, 26 Mar 2014 13:05:49 +0100\nSubject: [PATCH] qcow2: Avoid integer overflow in get_refcount (CVE-2014-0143)\n\nThis ensures that the checks catch all invalid cluster indexes\ninstead of returning the refcount of a wrong cluster.\n\nSigned-off-by: Kevin Wolf <kwolf@redhat.com>\nReviewed-by: Max Reitz <mreitz@redhat.com>\nSigned-off-by: Stefan Hajnoczi <stefanha@redhat.com>\n---\n block\/qcow2-refcount.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/block\/qcow2-refcount.c b\/block\/qcow2-refcount.c\nindex 220b322..561d659 100644\n--- a\/block\/qcow2-refcount.c\n+++ b\/block\/qcow2-refcount.c\n@@ -89,7 +89,7 @@ static int load_refcount_block(BlockDriverState *bs,\n static int get_refcount(BlockDriverState *bs, int64_t cluster_index)\n {\n     BDRVQcowState *s = bs->opaque;\n-    int refcount_table_index, block_index;\n+    uint64_t refcount_table_index, block_index;\n     int64_t refcount_block_offset;\n     int ret;\n     uint16_t *refcount_block;\n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-20847","CWE_ID":"190","category":"security","commit_id":"5d00b719f4b93b1445e6fb4c766b9a9883c57949","commit_message":"From 5d00b719f4b93b1445e6fb4c766b9a9883c57949 Mon Sep 17 00:00:00 2001\nFrom: Antonin Descampe <antonin@gmail.com>\nDate: Thu, 15 Jan 2015 18:16:29 +0000\nSubject: [PATCH] [trunk] fixed a buffer overflow in opj_tcd_init_decode_tile\n\nUpdate issue 431\n---\n src\/lib\/openjp2\/pi.c  | 8 ++++----\n src\/lib\/openjp2\/tcd.c | 9 +++++----\n 2 files changed, 9 insertions(+), 8 deletions(-)\n\n","diff_code":"diff --git a\/src\/lib\/openjp2\/pi.c b\/src\/lib\/openjp2\/pi.c\nindex 65ff6263e..66e5b05c8 100644\n--- a\/src\/lib\/openjp2\/pi.c\n+++ b\/src\/lib\/openjp2\/pi.c\n@@ -708,10 +708,10 @@ void opj_get_all_encoding_parameters(   const opj_image_t *p_image,\n \tq = tileno \/ p_cp->tw;\n \n \t\/* here calculation of tx0, tx1, ty0, ty1, maxprec, l_dx and l_dy *\/\n-\t*p_tx0 = opj_int_max((OPJ_INT32)(p_cp->tx0 + p * p_cp->tdx), (OPJ_INT32)p_image->x0);\n-\t*p_tx1 = opj_int_min((OPJ_INT32)(p_cp->tx0 + (p + 1) * p_cp->tdx), (OPJ_INT32)p_image->x1);\n-\t*p_ty0 = opj_int_max((OPJ_INT32)(p_cp->ty0 + q * p_cp->tdy), (OPJ_INT32)p_image->y0);\n-\t*p_ty1 = opj_int_min((OPJ_INT32)(p_cp->ty0 + (q + 1) * p_cp->tdy), (OPJ_INT32)p_image->y1);\n+\t*p_tx0 = (OPJ_INT32)opj_uint_max(p_cp->tx0 + p * p_cp->tdx, p_image->x0);\n+\t*p_tx1 = (OPJ_INT32)opj_uint_min(p_cp->tx0 + (p + 1) * p_cp->tdx, p_image->x1);\n+\t*p_ty0 = (OPJ_INT32)opj_uint_max(p_cp->ty0 + q * p_cp->tdy, p_image->y0);\n+\t*p_ty1 = (OPJ_INT32)opj_uint_min(p_cp->ty0 + (q + 1) * p_cp->tdy, p_image->y1);\n \n \t\/* max precision and resolution is 0 (can only grow)*\/\n \t*p_max_prec = 0;\ndiff --git a\/src\/lib\/openjp2\/tcd.c b\/src\/lib\/openjp2\/tcd.c\nindex eade5a910..a041bc1e9 100644\n--- a\/src\/lib\/openjp2\/tcd.c\n+++ b\/src\/lib\/openjp2\/tcd.c\n@@ -701,10 +701,11 @@ static INLINE OPJ_BOOL opj_tcd_init_tile(opj_tcd_t *p_tcd, OPJ_UINT32 p_tile_no,\n \t\/*fprintf(stderr, \"Tile coordinate = %d,%d\\n\", p, q);*\/\n \t\n \t\/* 4 borders of the tile rescale on the image if necessary *\/\n-\tl_tile->x0 = opj_int_max((OPJ_INT32)(l_cp->tx0 + p * l_cp->tdx), (OPJ_INT32)l_image->x0);\n-\tl_tile->y0 = opj_int_max((OPJ_INT32)(l_cp->ty0 + q * l_cp->tdy), (OPJ_INT32)l_image->y0);\n-\tl_tile->x1 = opj_int_min((OPJ_INT32)(l_cp->tx0 + (p + 1) * l_cp->tdx), (OPJ_INT32)l_image->x1);\n-\tl_tile->y1 = opj_int_min((OPJ_INT32)(l_cp->ty0 + (q + 1) * l_cp->tdy), (OPJ_INT32)l_image->y1);\n+\tl_tile->x0 = (OPJ_INT32)opj_uint_max(l_cp->tx0 + p * l_cp->tdx, l_image->x0);\n+\tl_tile->y0 = (OPJ_INT32)opj_uint_max(l_cp->ty0 + q * l_cp->tdy, l_image->y0);\n+\tl_tile->x1 = (OPJ_INT32)opj_uint_min(l_cp->tx0 + (p + 1) * l_cp->tdx, l_image->x1);\n+\tl_tile->y1 = (OPJ_INT32)opj_uint_min(l_cp->ty0 + (q + 1) * l_cp->tdy, l_image->y1);\n+\n \t\/* testcase 1888.pdf.asan.35.988 *\/\n \tif (l_tccp->numresolutions == 0) {\n \t\tfprintf(stderr, \"tiles require at least one resolution\\n\");\n","owner":"uclouvain","repo":"openjpeg","source":"cve"},{"CVE_ID":"CVE-2018-20406","CWE_ID":"190","category":"security","commit_id":"a4ae828ee416a66d8c7bf5ee71d653c2cc6a26dd","commit_message":"From a4ae828ee416a66d8c7bf5ee71d653c2cc6a26dd Mon Sep 17 00:00:00 2001\nFrom: Benjamin Peterson <benjamin@python.org>\nDate: Thu, 20 Sep 2018 18:36:40 -0700\nSubject: [PATCH] closes bpo-34656: Avoid relying on signed overflow in _pickle\n memos. (GH-9261)\n\n---\n Modules\/_pickle.c | 62 +++++++++++++++++++++++------------------------\n 1 file changed, 31 insertions(+), 31 deletions(-)\n\n","diff_code":"diff --git a\/Modules\/_pickle.c b\/Modules\/_pickle.c\nindex 2de70f5d9405..3588e33f0971 100644\n--- a\/Modules\/_pickle.c\n+++ b\/Modules\/_pickle.c\n@@ -602,9 +602,9 @@ typedef struct {\n } PyMemoEntry;\n \n typedef struct {\n-    Py_ssize_t mt_mask;\n-    Py_ssize_t mt_used;\n-    Py_ssize_t mt_allocated;\n+    size_t mt_mask;\n+    size_t mt_used;\n+    size_t mt_allocated;\n     PyMemoEntry *mt_table;\n } PyMemoTable;\n \n@@ -650,8 +650,8 @@ typedef struct UnpicklerObject {\n     \/* The unpickler memo is just an array of PyObject *s. Using a dict\n        is unnecessary, since the keys are contiguous ints. *\/\n     PyObject **memo;\n-    Py_ssize_t memo_size;       \/* Capacity of the memo array *\/\n-    Py_ssize_t memo_len;        \/* Number of objects in the memo *\/\n+    size_t memo_size;       \/* Capacity of the memo array *\/\n+    size_t memo_len;        \/* Number of objects in the memo *\/\n \n     PyObject *pers_func;        \/* persistent_load() method, can be NULL. *\/\n     PyObject *pers_func_self;   \/* borrowed reference to self if pers_func\n@@ -737,7 +737,6 @@ PyMemoTable_New(void)\n static PyMemoTable *\n PyMemoTable_Copy(PyMemoTable *self)\n {\n-    Py_ssize_t i;\n     PyMemoTable *new = PyMemoTable_New();\n     if (new == NULL)\n         return NULL;\n@@ -754,7 +753,7 @@ PyMemoTable_Copy(PyMemoTable *self)\n         PyErr_NoMemory();\n         return NULL;\n     }\n-    for (i = 0; i < self->mt_allocated; i++) {\n+    for (size_t i = 0; i < self->mt_allocated; i++) {\n         Py_XINCREF(self->mt_table[i].me_key);\n     }\n     memcpy(new->mt_table, self->mt_table,\n@@ -800,7 +799,7 @@ _PyMemoTable_Lookup(PyMemoTable *self, PyObject *key)\n {\n     size_t i;\n     size_t perturb;\n-    size_t mask = (size_t)self->mt_mask;\n+    size_t mask = self->mt_mask;\n     PyMemoEntry *table = self->mt_table;\n     PyMemoEntry *entry;\n     Py_hash_t hash = (Py_hash_t)key >> 3;\n@@ -821,22 +820,24 @@ _PyMemoTable_Lookup(PyMemoTable *self, PyObject *key)\n \n \/* Returns -1 on failure, 0 on success. *\/\n static int\n-_PyMemoTable_ResizeTable(PyMemoTable *self, Py_ssize_t min_size)\n+_PyMemoTable_ResizeTable(PyMemoTable *self, size_t min_size)\n {\n     PyMemoEntry *oldtable = NULL;\n     PyMemoEntry *oldentry, *newentry;\n-    Py_ssize_t new_size = MT_MINSIZE;\n-    Py_ssize_t to_process;\n+    size_t new_size = MT_MINSIZE;\n+    size_t to_process;\n \n     assert(min_size > 0);\n \n-    \/* Find the smallest valid table size >= min_size. *\/\n-    while (new_size < min_size && new_size > 0)\n-        new_size <<= 1;\n-    if (new_size <= 0) {\n+    if (min_size > PY_SSIZE_T_MAX) {\n         PyErr_NoMemory();\n         return -1;\n     }\n+\n+    \/* Find the smallest valid table size >= min_size. *\/\n+    while (new_size < min_size) {\n+        new_size <<= 1;\n+    }\n     \/* new_size needs to be a power of two. *\/\n     assert((new_size & (new_size - 1)) == 0);\n \n@@ -909,10 +910,12 @@ PyMemoTable_Set(PyMemoTable *self, PyObject *key, Py_ssize_t value)\n      * Very large memo tables (over 50K items) use doubling instead.\n      * This may help applications with severe memory constraints.\n      *\/\n-    if (!(self->mt_used * 3 >= (self->mt_mask + 1) * 2))\n+    if (SIZE_MAX \/ 3 >= self->mt_used && self->mt_used * 3 < self->mt_allocated * 2) {\n         return 0;\n-    return _PyMemoTable_ResizeTable(self,\n-        (self->mt_used > 50000 ? 2 : 4) * self->mt_used);\n+    }\n+    \/\/ self->mt_used is always < PY_SSIZE_T_MAX, so this can't overflow.\n+    size_t desired_size = (self->mt_used > 50000 ? 2 : 4) * self->mt_used;\n+    return _PyMemoTable_ResizeTable(self, desired_size);\n }\n \n #undef MT_MINSIZE\n@@ -1376,9 +1379,9 @@ _Unpickler_Readline(UnpicklerObject *self, char **result)\n \/* Returns -1 (with an exception set) on failure, 0 on success. The memo array\n    will be modified in place. *\/\n static int\n-_Unpickler_ResizeMemoList(UnpicklerObject *self, Py_ssize_t new_size)\n+_Unpickler_ResizeMemoList(UnpicklerObject *self, size_t new_size)\n {\n-    Py_ssize_t i;\n+    size_t i;\n \n     assert(new_size > self->memo_size);\n \n@@ -1397,9 +1400,9 @@ _Unpickler_ResizeMemoList(UnpicklerObject *self, Py_ssize_t new_size)\n \n \/* Returns NULL if idx is out of bounds. *\/\n static PyObject *\n-_Unpickler_MemoGet(UnpicklerObject *self, Py_ssize_t idx)\n+_Unpickler_MemoGet(UnpicklerObject *self, size_t idx)\n {\n-    if (idx < 0 || idx >= self->memo_size)\n+    if (idx >= self->memo_size)\n         return NULL;\n \n     return self->memo[idx];\n@@ -1408,7 +1411,7 @@ _Unpickler_MemoGet(UnpicklerObject *self, Py_ssize_t idx)\n \/* Returns -1 (with an exception set) on failure, 0 on success.\n    This takes its own reference to `value`. *\/\n static int\n-_Unpickler_MemoPut(UnpicklerObject *self, Py_ssize_t idx, PyObject *value)\n+_Unpickler_MemoPut(UnpicklerObject *self, size_t idx, PyObject *value)\n {\n     PyObject *old_item;\n \n@@ -4413,14 +4416,13 @@ static PyObject *\n _pickle_PicklerMemoProxy_copy_impl(PicklerMemoProxyObject *self)\n \/*[clinic end generated code: output=bb83a919d29225ef input=b73043485ac30b36]*\/\n {\n-    Py_ssize_t i;\n     PyMemoTable *memo;\n     PyObject *new_memo = PyDict_New();\n     if (new_memo == NULL)\n         return NULL;\n \n     memo = self->pickler->memo;\n-    for (i = 0; i < memo->mt_allocated; ++i) {\n+    for (size_t i = 0; i < memo->mt_allocated; ++i) {\n         PyMemoEntry entry = memo->mt_table[i];\n         if (entry.me_key != NULL) {\n             int status;\n@@ -6843,7 +6845,7 @@ static PyObject *\n _pickle_UnpicklerMemoProxy_copy_impl(UnpicklerMemoProxyObject *self)\n \/*[clinic end generated code: output=e12af7e9bc1e4c77 input=97769247ce032c1d]*\/\n {\n-    Py_ssize_t i;\n+    size_t i;\n     PyObject *new_memo = PyDict_New();\n     if (new_memo == NULL)\n         return NULL;\n@@ -6994,8 +6996,7 @@ static int\n Unpickler_set_memo(UnpicklerObject *self, PyObject *obj)\n {\n     PyObject **new_memo;\n-    Py_ssize_t new_memo_size = 0;\n-    Py_ssize_t i;\n+    size_t new_memo_size = 0;\n \n     if (obj == NULL) {\n         PyErr_SetString(PyExc_TypeError,\n@@ -7012,7 +7013,7 @@ Unpickler_set_memo(UnpicklerObject *self, PyObject *obj)\n         if (new_memo == NULL)\n             return -1;\n \n-        for (i = 0; i < new_memo_size; i++) {\n+        for (size_t i = 0; i < new_memo_size; i++) {\n             Py_XINCREF(unpickler->memo[i]);\n             new_memo[i] = unpickler->memo[i];\n         }\n@@ -7060,8 +7061,7 @@ Unpickler_set_memo(UnpicklerObject *self, PyObject *obj)\n \n   error:\n     if (new_memo_size) {\n-        i = new_memo_size;\n-        while (--i >= 0) {\n+        for (size_t i = new_memo_size - 1; i != SIZE_MAX; i--) {\n             Py_XDECREF(new_memo[i]);\n         }\n         PyMem_FREE(new_memo);\n","owner":"python","repo":"cpython","source":"cve"},{"CVE_ID":"CVE-2017-16612","CWE_ID":"190","category":"security","commit_id":"4794b5dd34688158fb51a2943032569d3780c4b8","commit_message":"From 4794b5dd34688158fb51a2943032569d3780c4b8 Mon Sep 17 00:00:00 2001\nFrom: Tobias Stoeckmann <tobias@stoeckmann.org>\nDate: Sat, 21 Oct 2017 23:47:52 +0200\nSubject: Fix heap overflows when parsing malicious files. (CVE-2017-16612)\n\nIt is possible to trigger heap overflows due to an integer overflow\nwhile parsing images and a signedness issue while parsing comments.\n\nThe integer overflow occurs because the chosen limit 0x10000 for\ndimensions is too large for 32 bit systems, because each pixel takes\n4 bytes. Properly chosen values allow an overflow which in turn will\nlead to less allocated memory than needed for subsequent reads.\n\nThe signedness bug is triggered by reading the length of a comment\nas unsigned int, but casting it to int when calling the function\nXcursorCommentCreate. Turning length into a negative value allows the\ncheck against XCURSOR_COMMENT_MAX_LEN to pass, and the following\naddition of sizeof (XcursorComment) + 1 makes it possible to allocate\nless memory than needed for subsequent reads.\n\nSigned-off-by: Tobias Stoeckmann <tobias@stoeckmann.org>\nReviewed-by: Matthieu Herrb <matthieu@herrb.eu>\n---\n src\/file.c | 12 ++++++++++--\n 1 file changed, 10 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/src\/file.c b\/src\/file.c\nindex 43163c2..da16277 100644\n--- a\/src\/file.c\n+++ b\/src\/file.c\n@@ -29,6 +29,11 @@ XcursorImageCreate (int width, int height)\n {\n     XcursorImage    *image;\n \n+    if (width < 0 || height < 0)\n+       return NULL;\n+    if (width > XCURSOR_IMAGE_MAX_SIZE || height > XCURSOR_IMAGE_MAX_SIZE)\n+       return NULL;\n+\n     image = malloc (sizeof (XcursorImage) +\n \t\t    width * height * sizeof (XcursorPixel));\n     if (!image)\n@@ -101,7 +106,7 @@ XcursorCommentCreate (XcursorUInt comment_type, int length)\n {\n     XcursorComment  *comment;\n \n-    if (length > XCURSOR_COMMENT_MAX_LEN)\n+    if (length < 0 || length > XCURSOR_COMMENT_MAX_LEN)\n \treturn NULL;\n \n     comment = malloc (sizeof (XcursorComment) + length + 1);\n@@ -448,7 +453,8 @@ _XcursorReadImage (XcursorFile\t\t*file,\n     if (!_XcursorReadUInt (file, &head.delay))\n \treturn NULL;\n     \/* sanity check data *\/\n-    if (head.width >= 0x10000 || head.height > 0x10000)\n+    if (head.width > XCURSOR_IMAGE_MAX_SIZE  ||\n+\thead.height > XCURSOR_IMAGE_MAX_SIZE)\n \treturn NULL;\n     if (head.width == 0 || head.height == 0)\n \treturn NULL;\n@@ -457,6 +463,8 @@ _XcursorReadImage (XcursorFile\t\t*file,\n \n     \/* Create the image and initialize it *\/\n     image = XcursorImageCreate (head.width, head.height);\n+    if (image == NULL)\n+\treturn NULL;\n     if (chunkHeader.version < image->version)\n \timage->version = chunkHeader.version;\n     image->size = chunkHeader.subtype;\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-20178","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2018-5815","CWE_ID":"190","category":"security","commit_id":"1334647862b0c90b2e8cb2f668e66627d9517b17","commit_message":"From 1334647862b0c90b2e8cb2f668e66627d9517b17 Mon Sep 17 00:00:00 2001\nFrom: Alex Tutubalin <lexa@lexa.ru>\nDate: Mon, 11 Jun 2018 13:03:24 +0300\nSubject: [PATCH] parse_qt: possible integer overflow\n\n---\n dcraw\/dcraw.c             | 2 ++\n internal\/dcraw_common.cpp | 2 ++\n 2 files changed, 4 insertions(+)\n\n","diff_code":"diff --git a\/dcraw\/dcraw.c b\/dcraw\/dcraw.c\nindex 511a6db5..364869cf 100644\n--- a\/dcraw\/dcraw.c\n+++ b\/dcraw\/dcraw.c\n@@ -13593,6 +13593,8 @@ void CLASS parse_qt (int end)\n   while (ftell(ifp)+7 < end) {\n     save = ftell(ifp);\n     if ((size = get4()) < 8) return;\n+    if ((int)size < 0) return; \/\/ 2+GB is too much\n+    if (save + size < save) return; \/\/ 32bit overflow\n     fread (tag, 4, 1, ifp);\n     if (!memcmp(tag,\"moov\",4) ||\n \t!memcmp(tag,\"udta\",4) ||\ndiff --git a\/internal\/dcraw_common.cpp b\/internal\/dcraw_common.cpp\nindex a3dcbcea..041318c5 100644\n--- a\/internal\/dcraw_common.cpp\n+++ b\/internal\/dcraw_common.cpp\n@@ -12395,6 +12395,8 @@ void CLASS parse_qt (int end)\n   while (ftell(ifp)+7 < end) {\n     save = ftell(ifp);\n     if ((size = get4()) < 8) return;\n+    if ((int)size < 0) return; \/\/ 2+GB is too much\n+    if (save + size < save) return; \/\/ 32bit overflow\n     fread (tag, 4, 1, ifp);\n     if (!memcmp(tag,\"moov\",4) ||\n \t!memcmp(tag,\"udta\",4) ||\n","owner":"LibRaw","repo":"LibRaw","source":"cve"},{"CVE_ID":"CVE-2018-20179","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2015-8896","CWE_ID":"190","category":"security","commit_id":"0f6fc2d5bf8f500820c3dbcf0d23ee14f2d9f734","commit_message":"From 0f6fc2d5bf8f500820c3dbcf0d23ee14f2d9f734 Mon Sep 17 00:00:00 2001\nFrom: cristy <urban-warrior@git.imagemagick.org>\nDate: Sat, 30 May 2015 00:49:11 +0000\nSubject: [PATCH]\n\n---\n MagickCore\/memory.c  | 31 +++++++++++++++++++++++--------\n MagickCore\/studio.h  |  6 +++---\n MagickCore\/version.c | 13 +++++++++++--\n MagickCore\/version.h |  6 +++---\n MagickWand\/studio.h  |  6 +++---\n coders\/icon.c        |  6 ++++--\n coders\/pict.c        |  6 +++---\n configure            |  7 ++++---\n configure.ac         |  5 +++--\n 9 files changed, 57 insertions(+), 29 deletions(-)\n\n","diff_code":"diff --git a\/MagickCore\/memory.c b\/MagickCore\/memory.c\nindex fa1d44ea74..50755a91a1 100644\n--- a\/MagickCore\/memory.c\n+++ b\/MagickCore\/memory.c\n@@ -606,7 +606,8 @@ MagickExport MemoryInfo *AcquireVirtualMemory(const size_t count,\n       else\n         RelinquishMagickResource(MapResource,length);\n     }\n-  if (memory_info->blob == NULL)\n+  if ((memory_info->blob == NULL) &&\n+      (AcquireMagickResource(DiskResource,length) != MagickFalse))\n     {\n       int\n         file;\n@@ -615,15 +616,26 @@ MagickExport MemoryInfo *AcquireVirtualMemory(const size_t count,\n         Anonymous memory mapping failed, try file-backed memory mapping.\n       *\/\n       file=AcquireUniqueFileResource(memory_info->filename);\n-      if (file != -1)\n+      if (file == -1)\n+        RelinquishMagickResource(DiskResource,length);\n+      else\n         {\n-          if ((lseek(file,length-1,SEEK_SET) >= 0) && (write(file,\"\",1) == 1))\n+          if ((lseek(file,length-1,SEEK_SET) < 0) || (write(file,\"\",1) != 1))\n+            RelinquishMagickResource(DiskResource,length);\n+          else\n             {\n-              memory_info->blob=MapBlob(file,IOMode,0,length);\n-              if (memory_info->blob != NULL)\n+              if (AcquireMagickResource(MapResource,length) == MagickFalse)\n+                RelinquishMagickResource(DiskResource,length);\n+              else\n                 {\n-                  memory_info->type=MapVirtualMemory;\n-                  (void) AcquireMagickResource(MapResource,length);\n+                  memory_info->blob=MapBlob(file,IOMode,0,length);\n+                  if (memory_info->blob != NULL)\n+                    memory_info->type=MapVirtualMemory;\n+                  else\n+                    {\n+                      RelinquishMagickResource(MapResource,length);\n+                      RelinquishMagickResource(DiskResource,length);\n+                    }\n                 }\n             }\n           (void) close(file);\n@@ -1033,7 +1045,10 @@ MagickExport MemoryInfo *RelinquishVirtualMemory(MemoryInfo *memory_info)\n         memory_info->blob=NULL;\n         RelinquishMagickResource(MapResource,memory_info->length);\n         if (*memory_info->filename != '\\0')\n-          (void) RelinquishUniqueFileResource(memory_info->filename);\n+          {\n+            (void) RelinquishUniqueFileResource(memory_info->filename);\n+            RelinquishMagickResource(DiskResource,memory_info->length);\n+          }\n         break;\n       }\n       case UnalignedVirtualMemory:\ndiff --git a\/MagickCore\/studio.h b\/MagickCore\/studio.h\nindex c434028d75..6905a11faa 100644\n--- a\/MagickCore\/studio.h\n+++ b\/MagickCore\/studio.h\n@@ -46,9 +46,6 @@ extern \"C\" {\n #if defined(_magickcore_inline) && !defined(inline)\n # define inline  _magickcore_inline\n #endif\n-#if defined(_magickcore_restrict) && !defined(restrict)\n-# define restrict  _magickcore_restrict\n-#endif\n # if defined(__cplusplus) || defined(c_plusplus)\n #  undef inline\n # endif\n@@ -75,6 +72,9 @@ extern \"C\" {\n #  include <stdlib.h>\n # endif\n #endif\n+#if defined(_magickcore_restrict) && !defined(restrict)\n+# define restrict  _magickcore_restrict\n+#endif\n #if defined(MAGICKCORE_HAVE_STRING_H)\n # if !defined(STDC_HEADERS) && defined(MAGICKCORE_HAVE_MEMORY_H)\n #  include <memory.h>\ndiff --git a\/MagickCore\/version.c b\/MagickCore\/version.c\nindex 36e5b5361d..d4407437ab 100644\n--- a\/MagickCore\/version.c\n+++ b\/MagickCore\/version.c\n@@ -219,17 +219,26 @@ MagickExport const char *GetMagickDelegates(void)\n MagickExport const char *GetMagickFeatures(void)\n {\n   return \"DPC\"\n-#if defined(MAGICKCORE_BUILD_MODULES) || defined(_DLL)\n-  \" Modules\"\n+#if defined(MAGICKCORE_WINDOWS_SUPPORT) && defined(_DEBUG)\n+  \" Debug\"\n+#endif\n+#if defined(MAGICKCORE_CIPHER_SUPPORT)\n+  \" Cipher\"\n #endif\n #if defined(MAGICKCORE_HDRI_SUPPORT)\n   \" HDRI\"\n #endif\n+#if defined(MAGICKCORE_BUILD_MODULES) || defined(_DLL)\n+  \" Modules\"\n+#endif\n #if defined(MAGICKCORE_OPENCL_SUPPORT)\n   \" OpenCL\"\n #endif\n #if defined(MAGICKCORE_OPENMP_SUPPORT)\n   \" OpenMP\"\n+#endif\n+#if defined(ZERO_CONFIGURATION_SUPPORT)\n+  \" Zero-configuration\"\n #endif\n   ;\n }\ndiff --git a\/MagickCore\/version.h b\/MagickCore\/version.h\nindex 7aa97dc012..f5221f15c0 100644\n--- a\/MagickCore\/version.h\n+++ b\/MagickCore\/version.h\n@@ -27,7 +27,7 @@ extern \"C\" {\n *\/\n #define MagickPackageName \"ImageMagick\"\n #define MagickCopyright  \"Copyright (C) 1999-2015 ImageMagick Studio LLC\"\n-#define MagickSVNRevision  \"18658:18662M\"\n+#define MagickSVNRevision  \"18670M\"\n #define MagickLibVersion  0x700\n #define MagickLibVersionText  \"7.0.0\"\n #define MagickLibVersionNumber  0,0,0\n@@ -48,12 +48,12 @@ extern \"C\" {\n #define MagickppLibAddendum  \"-0\"\n #define MagickppLibInterface  0\n #define MagickppLibMinInterface  0\n-#define MagickReleaseDate  \"2015-05-26\"\n+#define MagickReleaseDate  \"2015-05-29\"\n #define MagickChangeDate   \"20120427\"\n #define MagickAuthoritativeLicense  \\\n   \"http:\/\/www.imagemagick.org\/script\/license.php\"\n #define MagickAuthoritativeURL  \"http:\/\/www.imagemagick.org\"\n-#define MagickFeatures \"DPC HDRI OpenMP\"\n+#define MagickFeatures \"DPC HDRI Cipher OpenMP\"\n #define MagickDelegates \"bzlib djvu mpeg fftw fpx fontconfig freetype jbig jng jpeg lcms lzma openexr pango png ps tiff webp x xml zlib\"\n #define MagickHomeURL  \"file:\/\/\/usr\/local\/share\/doc\/ImageMagick-7\/index.html\"\n #if (MAGICKCORE_QUANTUM_DEPTH == 8)\ndiff --git a\/MagickWand\/studio.h b\/MagickWand\/studio.h\nindex b463d0a9ba..7bf0aa3a12 100644\n--- a\/MagickWand\/studio.h\n+++ b\/MagickWand\/studio.h\n@@ -46,9 +46,6 @@ extern \"C\" {\n #if defined(_magickcore_inline) && !defined(inline)\n # define inline _magickcore_inline\n #endif\n-#if defined(_magickcore_restrict) && !defined(restrict)\n-# define restrict  _magickcore_restrict\n-#endif\n # if defined(__cplusplus) || defined(c_plusplus)\n #  undef inline\n # endif\n@@ -77,6 +74,9 @@ extern \"C\" {\n #  include <stdlib.h>\n # endif\n #endif\n+#if defined(_magickcore_restrict) && !defined(restrict)\n+# define restrict  _magickcore_restrict\n+#endif\n #if defined(MAGICKCORE_HAVE_STRING_H)\n # if !defined(STDC_HEADERS) && defined(MAGICKCORE_HAVE_MEMORY_H)\n #  include <memory.h>\ndiff --git a\/coders\/icon.c b\/coders\/icon.c\nindex 94c31e6b8e..222dec2541 100644\n--- a\/coders\/icon.c\n+++ b\/coders\/icon.c\n@@ -183,8 +183,8 @@ Image *AutoResizeImage(const Image *image,const char *option,\n       p++;\n \n     size=(size_t)strtol(p,&q,10);\n-    if (p == q || size < 16 || size > 256)\n-        return((Image *) NULL);\n+    if ((p == q) || (size < 16) || (size > 256))\n+      return((Image *) NULL);\n \n     p=q;\n     sizes[i++]=size;\n@@ -354,6 +354,8 @@ static Image *ReadICONImage(const ImageInfo *image_info,\n           Icon image encoded as a compressed PNG image.\n         *\/\n         length=icon_file.directory[i].size;\n+        if (~length < 16)\n+          ThrowReaderException(ResourceLimitError,\"MemoryAllocationFailed\");\n         png=(unsigned char *) AcquireQuantumMemory(length+16,sizeof(*png));\n         if (png == (unsigned char *) NULL)\n           ThrowReaderException(ResourceLimitError,\"MemoryAllocationFailed\");\ndiff --git a\/coders\/pict.c b\/coders\/pict.c\nindex 4f51eb3937..027119d815 100644\n--- a\/coders\/pict.c\n+++ b\/coders\/pict.c\n@@ -1637,6 +1637,7 @@ static MagickBooleanType WritePICTImage(const ImageInfo *image_info,\n   size_t\n     bytes_per_line,\n     count,\n+    row_bytes,\n     storage_class;\n \n   ssize_t\n@@ -1649,7 +1650,6 @@ static MagickBooleanType WritePICTImage(const ImageInfo *image_info,\n \n   unsigned short\n     base_address,\n-    row_bytes,\n     transfer_mode;\n \n   \/*\n@@ -1681,7 +1681,7 @@ static MagickBooleanType WritePICTImage(const ImageInfo *image_info,\n   source_rectangle=size_rectangle;\n   destination_rectangle=size_rectangle;\n   base_address=0xff;\n-  row_bytes=(unsigned short) (image->columns | 0x8000);\n+  row_bytes=image->columns;\n   bounds.top=0;\n   bounds.left=0;\n   bounds.bottom=(short) image->rows;\n@@ -1711,7 +1711,7 @@ static MagickBooleanType WritePICTImage(const ImageInfo *image_info,\n       pixmap.bits_per_pixel=32;\n       pixmap.pack_type=0x04;\n       transfer_mode=0x40;\n-      row_bytes=(unsigned short) ((4*image->columns) | 0x8000);\n+      row_bytes=4*image->columns;\n     }\n   \/*\n     Allocate memory.\ndiff --git a\/configure b\/configure\nindex f1bfd46bcc..7633dd204c 100755\n--- a\/configure\n+++ b\/configure\n@@ -4341,7 +4341,7 @@ MAGICK_PATCHLEVEL_VERSION=0\n \n MAGICK_VERSION=7.0.0-0\n \n-MAGICK_SVN_REVISION=18658:18662M\n+MAGICK_SVN_REVISION=18670M\n \n \n # Substitute library versioning\n@@ -21655,6 +21655,7 @@ if test \"$enable_cipher\" = 'yes'; then\n \n $as_echo \"#define CIPHER_SUPPORT 1\" >>confdefs.h\n \n+    MAGICK_FEATURES=\"Cipher $MAGICK_FEATURES\"\n fi\n \n # Build a zero-configuration version of ImageMagick.\n@@ -21670,7 +21671,7 @@ if test \"$enable_zero_configuration\" = 'yes'; then\n \n $as_echo \"#define ZERO_CONFIGURATION_SUPPORT 1\" >>confdefs.h\n \n-    MAGICK_FEATURES=\"Zero-Configuration $MAGICK_FEATURES\"\n+    MAGICK_FEATURES=\"Zero-configuration $MAGICK_FEATURES\"\n fi\n \n # Build a high dynamic range version of ImageMagick.\n@@ -36535,7 +36536,7 @@ fi\n if test \"$build_modules\" != 'no'; then\n     MAGICK_DEP_LIBS=\"$USER_LIBS $LCMS_LIBS $FREETYPE_LIBS $LQR_LIBS $FFTW_LIBS $FONTCONFIG_LIBS $XEXT_LIBS $IPC_LIBS $X11_LIBS $XT_LIBS $LZMA_LIBS $BZLIB_LIBS $ZLIB_LIBS $LTDL_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"\n else\n-    MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $OPENJPEG_LIBS $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"\n+    MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $LIBOPENJP2_LIB $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"\n fi\n \n \ndiff --git a\/configure.ac b\/configure.ac\nindex 5d2cb8a131..ba0e111862 100755\n--- a\/configure.ac\n+++ b\/configure.ac\n@@ -642,6 +642,7 @@ AC_ARG_ENABLE([cipher],\n \n if test \"$enable_cipher\" = 'yes'; then\n     AC_DEFINE(CIPHER_SUPPORT,1,[permit enciphering and deciphering image pixels])\n+    MAGICK_FEATURES=\"Cipher $MAGICK_FEATURES\"\n fi\n \n # Build a zero-configuration version of ImageMagick.\n@@ -653,7 +654,7 @@ AC_ARG_ENABLE([zero-configuration],\n \n if test \"$enable_zero_configuration\" = 'yes'; then\n     AC_DEFINE(ZERO_CONFIGURATION_SUPPORT,1,[Build self-contained, embeddable, zero-configuration ImageMagick])\n-    MAGICK_FEATURES=\"Zero-Configuration $MAGICK_FEATURES\"\n+    MAGICK_FEATURES=\"Zero-configuration $MAGICK_FEATURES\"\n fi\n \n # Build a high dynamic range version of ImageMagick.\n@@ -3996,7 +3997,7 @@ fi\n if test \"$build_modules\" != 'no'; then\n     MAGICK_DEP_LIBS=\"$USER_LIBS $LCMS_LIBS $FREETYPE_LIBS $LQR_LIBS $FFTW_LIBS $FONTCONFIG_LIBS $XEXT_LIBS $IPC_LIBS $X11_LIBS $XT_LIBS $LZMA_LIBS $BZLIB_LIBS $ZLIB_LIBS $LTDL_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"\n else\n-    MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $OPENJPEG_LIBS $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"\n+    MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $LIBOPENJP2_LIB $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"\n fi\n AC_SUBST(MAGICK_DEP_LIBS)\n \n","owner":"ImageMagick","repo":"ImageMagick","source":"cve"},{"CVE_ID":"CVE-2016-5841","CWE_ID":"190","category":"security","commit_id":"d8ab7f046587f2e9f734b687ba7e6e10147c294b","commit_message":"From d8ab7f046587f2e9f734b687ba7e6e10147c294b Mon Sep 17 00:00:00 2001\nFrom: Cristy <urban-warrior@imagemagick.org>\nDate: Tue, 21 Jun 2016 21:13:18 -0400\nSubject: [PATCH] Improve checking of EXIF profile to prevent integer overflow\n (bug report from Ibrahim el-sayed)\n\n---\n MagickCore\/profile.c  | 47 ++++++++++++++++----------\n MagickCore\/property.c | 76 +++++++++++++++++++++++++------------------\n 2 files changed, 74 insertions(+), 49 deletions(-)\n\n","diff_code":"diff --git a\/MagickCore\/profile.c b\/MagickCore\/profile.c\nindex 1fb384d8e7..51d887902b 100644\n--- a\/MagickCore\/profile.c\n+++ b\/MagickCore\/profile.c\n@@ -1351,20 +1351,22 @@ static inline const unsigned char *ReadResourceByte(const unsigned char *p,\n static inline const unsigned char *ReadResourceLong(const unsigned char *p,\n   unsigned int *quantum)\n {\n-  *quantum=(size_t) (*p++ << 24);\n-  *quantum|=(size_t) (*p++ << 16);\n-  *quantum|=(size_t) (*p++ << 8);\n-  *quantum|=(size_t) (*p++ << 0);\n+  *quantum=(unsigned int) (*p++) << 24;\n+  *quantum|=(unsigned int) (*p++) << 16;\n+  *quantum|=(unsigned int) (*p++) << 8;\n+  *quantum|=(unsigned int) (*p++) << 0;\n   return(p);\n }\n \n static inline const unsigned char *ReadResourceShort(const unsigned char *p,\n   unsigned short *quantum)\n {\n-  *quantum=(unsigned short) (*p++ << 8);\n-  *quantum|=(unsigned short) (*p++ << 0);\n+  *quantum=(unsigned short) (*p++) << 8;\n+  *quantum|=(unsigned short) (*p++);\n   return(p);\n-}static inline void WriteResourceLong(unsigned char *p,\n+}\n+\n+static inline void WriteResourceLong(unsigned char *p,\n   const unsigned int quantum)\n {\n   unsigned char\n@@ -1731,13 +1733,14 @@ static inline signed short ReadProfileShort(const EndianType endian,\n \n   if (endian == LSBEndian)\n     {\n-      value=(unsigned short) ((buffer[1] << 8) | buffer[0]);\n-      quantum.unsigned_value=(value & 0xffff);\n+      value=(unsigned short) buffer[1] << 8;\n+      value|=(unsigned short) buffer[0];\n+      quantum.unsigned_value=value & 0xffff;\n       return(quantum.signed_value);\n     }\n-  value=(unsigned short) ((((unsigned char *) buffer)[0] << 8) |\n-    ((unsigned char *) buffer)[1]);\n-  quantum.unsigned_value=(value & 0xffff);\n+  value=(unsigned short) buffer[0] << 8;\n+  value|=(unsigned short) buffer[1];\n+  quantum.unsigned_value=value & 0xffff;\n   return(quantum.signed_value);\n }\n \n@@ -1758,14 +1761,18 @@ static inline signed int ReadProfileLong(const EndianType endian,\n \n   if (endian == LSBEndian)\n     {\n-      value=(unsigned int) ((buffer[3] << 24) | (buffer[2] << 16) |\n-        (buffer[1] << 8 ) | (buffer[0]));\n-      quantum.unsigned_value=(value & 0xffffffff);\n+      value=(unsigned int) buffer[3] << 24;\n+      value|=(unsigned int) buffer[2] << 16;\n+      value|=(unsigned int) buffer[1] << 8;\n+      value|=(unsigned int) buffer[0];\n+      quantum.unsigned_value=value & 0xffffffff;\n       return(quantum.signed_value);\n     }\n-  value=(unsigned int) ((buffer[0] << 24) | (buffer[1] << 16) |\n-    (buffer[2] << 8) | buffer[3]);\n-  quantum.unsigned_value=(value & 0xffffffff);\n+  value=(unsigned int) buffer[0] << 24;\n+  value|=(unsigned int) buffer[1] << 16;\n+  value|=(unsigned int) buffer[2] << 8;\n+  value|=(unsigned int) buffer[3];\n+  quantum.unsigned_value=value & 0xffffffff;\n   return(quantum.signed_value);\n }\n \n@@ -2017,11 +2024,15 @@ MagickBooleanType SyncExifProfile(Image *image,StringInfo *profile)\n         tag_value;\n \n       q=(unsigned char *) (directory+2+(12*entry));\n+      if (q > (exif+length-12))\n+        break;  \/* corrupt EXIF *\/\n       tag_value=(ssize_t) ReadProfileShort(endian,q);\n       format=(ssize_t) ReadProfileShort(endian,q+2);\n       if ((format-1) >= EXIF_NUM_FORMATS)\n         break;\n       components=(ssize_t) ReadProfileLong(endian,q+4);\n+      if (components < 0)\n+        break;  \/* corrupt EXIF *\/\n       number_bytes=(size_t) components*format_bytes[format];\n       if ((ssize_t) number_bytes < components)\n         break;  \/* prevent overflow *\/\ndiff --git a\/MagickCore\/property.c b\/MagickCore\/property.c\nindex 082ae7ea39..ca5c5fe0bc 100644\n--- a\/MagickCore\/property.c\n+++ b\/MagickCore\/property.c\n@@ -520,7 +520,7 @@ static inline signed int ReadPropertyMSBLong(const unsigned char **p,\n   unsigned char\n     buffer[4];\n \n-  size_t\n+  unsigned int\n     value;\n \n   if (*length < 4)\n@@ -531,11 +531,11 @@ static inline signed int ReadPropertyMSBLong(const unsigned char **p,\n     (*length)--;\n     buffer[i]=(unsigned char) c;\n   }\n-  value=(size_t) (buffer[0] << 24);\n-  value|=buffer[1] << 16;\n-  value|=buffer[2] << 8;\n-  value|=buffer[3];\n-  quantum.unsigned_value=(value & 0xffffffff);\n+  value=(unsigned int) buffer[0] << 24;\n+  value|=(unsigned int) buffer[1] << 16;\n+  value|=(unsigned int) buffer[2] << 8;\n+  value|=(unsigned int) buffer[3];\n+  quantum.unsigned_value=value & 0xffffffff;\n   return(quantum.signed_value);\n }\n \n@@ -571,9 +571,9 @@ static inline signed short ReadPropertyMSBShort(const unsigned char **p,\n     (*length)--;\n     buffer[i]=(unsigned char) c;\n   }\n-  value=(unsigned short) (buffer[0] << 8);\n-  value|=buffer[1];\n-  quantum.unsigned_value=(value & 0xffff);\n+  value=(unsigned short) buffer[0] << 8;\n+  value|=(unsigned short) buffer[1];\n+  quantum.unsigned_value=value & 0xffff;\n   return(quantum.signed_value);\n }\n \n@@ -742,14 +742,18 @@ static inline signed int ReadPropertySignedLong(const EndianType endian,\n \n   if (endian == LSBEndian)\n     {\n-      value=(unsigned int) ((buffer[3] << 24) | (buffer[2] << 16) |\n-        (buffer[1] << 8 ) | (buffer[0]));\n-      quantum.unsigned_value=(value & 0xffffffff);\n+      value=(unsigned int) buffer[3] << 24;\n+      value|=(unsigned int) buffer[2] << 16;\n+      value|=(unsigned int) buffer[1] << 8;\n+      value|=(unsigned int) buffer[0];\n+      quantum.unsigned_value=value & 0xffffffff;\n       return(quantum.signed_value);\n     }\n-  value=(unsigned int) ((buffer[0] << 24) | (buffer[1] << 16) |\n-    (buffer[2] << 8) | buffer[3]);\n-  quantum.unsigned_value=(value & 0xffffffff);\n+  value=(unsigned int) buffer[0] << 24;\n+  value|=(unsigned int) buffer[1] << 16;\n+  value|=(unsigned int) buffer[2] << 8;\n+  value|=(unsigned int) buffer[3];\n+  quantum.unsigned_value=value & 0xffffffff;\n   return(quantum.signed_value);\n }\n \n@@ -761,13 +765,17 @@ static inline unsigned int ReadPropertyUnsignedLong(const EndianType endian,\n \n   if (endian == LSBEndian)\n     {\n-      value=(unsigned int) ((buffer[3] << 24) | (buffer[2] << 16) |\n-        (buffer[1] << 8 ) | (buffer[0]));\n-      return((unsigned int) (value & 0xffffffff));\n+      value=(unsigned int) buffer[3] << 24;\n+      value|=(unsigned int) buffer[2] << 16;\n+      value|=(unsigned int) buffer[1] << 8;\n+      value|=(unsigned int) buffer[0];\n+      return(value & 0xffffffff);\n     }\n-  value=(unsigned int) ((buffer[0] << 24) | (buffer[1] << 16) |\n-    (buffer[2] << 8) | buffer[3]);\n-  return((unsigned int) (value & 0xffffffff));\n+  value=(unsigned int) buffer[0] << 24;\n+  value|=(unsigned int) buffer[1] << 16;\n+  value|=(unsigned int) buffer[2] << 8;\n+  value|=(unsigned int) buffer[3];\n+  return(value & 0xffffffff);\n }   \n \n static inline signed short ReadPropertySignedShort(const EndianType endian,\n@@ -787,13 +795,14 @@ static inline signed short ReadPropertySignedShort(const EndianType endian,\n \n   if (endian == LSBEndian)\n     {\n-      value=(unsigned short) ((buffer[1] << 8) | buffer[0]);\n-      quantum.unsigned_value=(value & 0xffff);\n+      value=(unsigned short) buffer[1] << 8;\n+      value|=(unsigned short) buffer[0];\n+      quantum.unsigned_value=value & 0xffff;\n       return(quantum.signed_value);\n     }\n-  value=(unsigned short) ((((unsigned char *) buffer)[0] << 8) |\n-    ((unsigned char *) buffer)[1]);\n-  quantum.unsigned_value=(value & 0xffff);\n+  value=(unsigned short) buffer[0] << 8;\n+  value|=(unsigned short) buffer[1];\n+  quantum.unsigned_value=value & 0xffff;\n   return(quantum.signed_value);\n }\n \n@@ -805,12 +814,13 @@ static inline unsigned short ReadPropertyUnsignedShort(const EndianType endian,\n \n   if (endian == LSBEndian)\n     {\n-      value=(unsigned short) ((buffer[1] << 8) | buffer[0]);\n-      return((unsigned short) (value & 0xffff));\n+      value=(unsigned short) buffer[1] << 8;\n+      value|=(unsigned short) buffer[0];\n+      return(value & 0xffff);\n     }\n-  value=(unsigned short) ((((unsigned char *) buffer)[0] << 8) |\n-    ((unsigned char *) buffer)[1]);\n-  return((unsigned short) (value & 0xffff));\n+  value=(unsigned short) buffer[0] << 8;\n+  value|=(unsigned short) buffer[1];\n+  return(value & 0xffff);\n }\n \n static MagickBooleanType GetEXIFProperty(const Image *image,\n@@ -1394,6 +1404,8 @@ static MagickBooleanType GetEXIFProperty(const Image *image,\n         components;\n \n       q=(unsigned char *) (directory+(12*entry)+2);\n+      if (q > (exif+length-12))\n+        break;  \/* corrupt EXIF *\/\n       if (GetValueFromSplayTree(exif_resources,q) == q)\n         break;\n       (void) AddValueToSplayTree(exif_resources,q,q);\n@@ -1402,6 +1414,8 @@ static MagickBooleanType GetEXIFProperty(const Image *image,\n       if (format >= (sizeof(tag_bytes)\/sizeof(*tag_bytes)))\n         break;\n       components=(ssize_t) ReadPropertySignedLong(endian,q+4);\n+      if (components < 0)\n+        break;  \/* corrupt EXIF *\/\n       number_bytes=(size_t) components*tag_bytes[format];\n       if (number_bytes < components)\n         break;  \/* prevent overflow *\/\n","owner":"ImageMagick","repo":"ImageMagick","source":"cve"},{"CVE_ID":"CVE-2019-11072","CWE_ID":"190","category":"security","commit_id":"32120d5b8b3203fc21ccb9eafb0eaf824bb59354","commit_message":"From 32120d5b8b3203fc21ccb9eafb0eaf824bb59354 Mon Sep 17 00:00:00 2001\nFrom: Glenn Strauss <gstrauss@gluelogic.com>\nDate: Wed, 10 Apr 2019 11:28:10 -0400\nSubject: [PATCH] [core] fix abort in http-parseopts (fixes #2945)\n\nfix abort in server.http-parseopts with url-path-2f-decode enabled\n\n(thx stze)\n\nx-ref:\n  \"Security - SIGABRT during GET request handling with url-path-2f-decode enabled\"\n  https:\/\/redmine.lighttpd.net\/issues\/2945\n---\n src\/burl.c        | 6 ++++--\n src\/t\/test_burl.c | 2 ++\n 2 files changed, 6 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/src\/burl.c b\/src\/burl.c\nindex 51182628..c4b928fd 100644\n--- a\/src\/burl.c\n+++ b\/src\/burl.c\n@@ -252,8 +252,10 @@ static int burl_normalize_2F_to_slash_fix (buffer *b, int qs, int i)\n         }\n     }\n     if (qs >= 0) {\n-        memmove(s+j, s+qs, blen - qs);\n-        j += blen - qs;\n+        const int qslen = blen - qs;\n+        memmove(s+j, s+qs, (size_t)qslen);\n+        qs = j;\n+        j += qslen;\n     }\n     buffer_string_set_length(b, j);\n     return qs;\ndiff --git a\/src\/t\/test_burl.c b\/src\/t\/test_burl.c\nindex 7be9be50..f7a16815 100644\n--- a\/src\/t\/test_burl.c\n+++ b\/src\/t\/test_burl.c\n@@ -97,6 +97,8 @@ static void test_burl_normalize (void) {\n     flags |= HTTP_PARSEOPT_URL_NORMALIZE_PATH_2F_DECODE;\n     run_burl_normalize(psrc, ptmp, flags, __LINE__, CONST_STR_LEN(\"\/a\/b?c=\/\"), CONST_STR_LEN(\"\/a\/b?c=\/\"));\n     run_burl_normalize(psrc, ptmp, flags, __LINE__, CONST_STR_LEN(\"\/a\/b?c=%2f\"), CONST_STR_LEN(\"\/a\/b?c=\/\"));\n+    run_burl_normalize(psrc, ptmp, flags, __LINE__, CONST_STR_LEN(\"%2f?\"), CONST_STR_LEN(\"\/?\"));\n+    run_burl_normalize(psrc, ptmp, flags, __LINE__, CONST_STR_LEN(\"\/%2f?\"), CONST_STR_LEN(\"\/\/?\"));\n     run_burl_normalize(psrc, ptmp, flags, __LINE__, CONST_STR_LEN(\"\/a%2fb\"), CONST_STR_LEN(\"\/a\/b\"));\n     run_burl_normalize(psrc, ptmp, flags, __LINE__, CONST_STR_LEN(\"\/a%2Fb\"), CONST_STR_LEN(\"\/a\/b\"));\n     run_burl_normalize(psrc, ptmp, flags, __LINE__, CONST_STR_LEN(\"\/a%2fb?c=\/\"), CONST_STR_LEN(\"\/a\/b?c=\/\"));\n","owner":"lighttpd","repo":"lighttpd1.4","source":"cve"},{"CVE_ID":"CVE-2017-6349","CWE_ID":"190","category":"security","commit_id":"3eb1637b1bba19519885dd6d377bd5596e91d22c","commit_message":"From 3eb1637b1bba19519885dd6d377bd5596e91d22c Mon Sep 17 00:00:00 2001\nFrom: Bram Moolenaar <Bram@vim.org>\nDate: Sun, 26 Feb 2017 18:11:36 +0100\nSubject: [PATCH] patch 8.0.0377: possible overflow when reading corrupted undo\n file\n\nProblem:    Possible overflow when reading corrupted undo file.\nSolution:   Check if allocated size is not too big. (King)\n---\n src\/undo.c    | 5 +++--\n src\/version.c | 2 ++\n 2 files changed, 5 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/src\/undo.c b\/src\/undo.c\nindex b69f318723..ba7c0b83c7 100644\n--- a\/src\/undo.c\n+++ b\/src\/undo.c\n@@ -1787,7 +1787,7 @@ u_read_undo(char_u *name, char_u *hash, char_u *orig_name)\n     linenr_T\tline_lnum;\n     colnr_T\tline_colnr;\n     linenr_T\tline_count;\n-    int\t\tnum_head = 0;\n+    long\tnum_head = 0;\n     long\told_header_seq, new_header_seq, cur_header_seq;\n     long\tseq_last, seq_cur;\n     long\tlast_save_nr = 0;\n@@ -1974,7 +1974,8 @@ u_read_undo(char_u *name, char_u *hash, char_u *orig_name)\n      * When there are no headers uhp_table is NULL. *\/\n     if (num_head > 0)\n     {\n-\tuhp_table = (u_header_T **)U_ALLOC_LINE(\n+\tif (num_head < LONG_MAX \/ (long)sizeof(u_header_T *))\n+\t    uhp_table = (u_header_T **)U_ALLOC_LINE(\n \t\t\t\t\t     num_head * sizeof(u_header_T *));\n \tif (uhp_table == NULL)\n \t    goto error;\ndiff --git a\/src\/version.c b\/src\/version.c\nindex 8d1454197d..c79020b211 100644\n--- a\/src\/version.c\n+++ b\/src\/version.c\n@@ -764,6 +764,8 @@ static char *(features[]) =\n \n static int included_patches[] =\n {   \/* Add new patch number below this line *\/\n+\/**\/\n+    377,\n \/**\/\n     376,\n \/**\/\n","owner":"vim","repo":"vim","source":"cve"},{"CVE_ID":"CVE-2016-6289","CWE_ID":"190","category":"security","commit_id":"0218acb7e756a469099c4ccfb22bce6c2bd1ef87","commit_message":"From 0218acb7e756a469099c4ccfb22bce6c2bd1ef87 Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Tue, 12 Jul 2016 21:48:00 -0700\nSubject: [PATCH] Fix for bug #72513\n\n---\n TSRM\/tsrm_virtual_cwd.c | 8 ++++----\n 1 file changed, 4 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/TSRM\/tsrm_virtual_cwd.c b\/TSRM\/tsrm_virtual_cwd.c\nindex ba92711..6c22ee8 100644\n--- a\/TSRM\/tsrm_virtual_cwd.c\n+++ b\/TSRM\/tsrm_virtual_cwd.c\n@@ -621,14 +621,14 @@ CWD_API void realpath_cache_del(const char *path, int path_len TSRMLS_DC) \/* {{{\n \t\t\t\t\tmemcmp(path, (*bucket)->path, path_len) == 0) {\n \t\t\trealpath_cache_bucket *r = *bucket;\n \t\t\t*bucket = (*bucket)->next;\n-\t\t   \n+\n \t\t\t\/* if the pointers match then only subtract the length of the path *\/\n \t\t   \tif(r->path == r->realpath) {\n \t\t\t\tCWDG(realpath_cache_size) -= sizeof(realpath_cache_bucket) + r->path_len + 1;\n \t\t\t} else {\n \t\t\t\tCWDG(realpath_cache_size) -= sizeof(realpath_cache_bucket) + r->path_len + 1 + r->realpath_len + 1;\n \t\t\t}\n-\t\t   \n+\n \t\t\tfree(r);\n \t\t\treturn;\n \t\t} else {\n@@ -704,7 +704,7 @@ static inline realpath_cache_bucket* realpath_cache_find(const char *path, int p\n \t\t\trealpath_cache_bucket *r = *bucket;\n \t\t\t*bucket = (*bucket)->next;\n \n-\t\t\t\/* if the pointers match then only subtract the length of the path *\/\t\t   \n+\t\t\t\/* if the pointers match then only subtract the length of the path *\/\n \t\t   \tif(r->path == r->realpath) {\n \t\t\t\tCWDG(realpath_cache_size) -= sizeof(realpath_cache_bucket) + r->path_len + 1;\n \t\t\t} else {\n@@ -1159,7 +1159,7 @@ CWD_API int virtual_file_ex(cwd_state *state, const char *path, verify_path_func\n \tint add_slash;\n \tvoid *tmp;\n \n-\tif (path_length == 0 || path_length >= MAXPATHLEN-1) {\n+\tif (path_length <= 0 || path_length >= MAXPATHLEN-1) {\n #ifdef TSRM_WIN32\n # if _MSC_VER < 1300\n \t\terrno = EINVAL;\n-- \n2.1.4\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-6355","CWE_ID":"190","category":"security","commit_id":"93761787b29f37fa627dea9082cdfc1a1ec608d6","commit_message":"From 93761787b29f37fa627dea9082cdfc1a1ec608d6 Mon Sep 17 00:00:00 2001\nFrom: Li Qiang <liq3ea@gmail.com>\nDate: Sat, 7 Jan 2017 06:21:09 -0500\nSubject: renderer: fix integer overflow in create shader\n\nAs the 'pkt_length' and 'offlen' can be malicious from guest,\nthe vrend_create_shader function has an integer overflow, this\nwill make the next 'memcpy' oob access. This patch avoid this.\n\nSigned-off-by: Li Qiang <liq3ea@gmail.com>\nSigned-off-by: Dave Airlie <airlied@redhat.com>\n---\n src\/vrend_renderer.c | 9 +++++++++\n 1 file changed, 9 insertions(+)\n\n","diff_code":"diff --git a\/src\/vrend_renderer.c b\/src\/vrend_renderer.c\nindex ad68f71..0af91ae 100644\n--- a\/src\/vrend_renderer.c\n+++ b\/src\/vrend_renderer.c\n@@ -2215,6 +2215,15 @@ int vrend_create_shader(struct vrend_context *ctx,\n          ret = EINVAL;\n          goto error;\n       }\n+\n+      \/*make sure no overflow *\/\n+      if (pkt_length * 4 < pkt_length ||\n+          pkt_length * 4 + sel->buf_offset < pkt_length * 4 ||\n+          pkt_length * 4 + sel->buf_offset < sel->buf_offset) {\n+            ret = EINVAL;\n+            goto error;\n+          }\n+\n       if ((pkt_length * 4 + sel->buf_offset) > sel->buf_len) {\n          fprintf(stderr, \"Got too large shader continuation %d vs %d\\n\",\n                  pkt_length * 4 + sel->buf_offset, sel->buf_len);\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-7133","CWE_ID":"190","category":"security","commit_id":"c2a13ced4272f2e65d2773e2ea6ca11c1ce4a911","commit_message":"From c2a13ced4272f2e65d2773e2ea6ca11c1ce4a911 Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Sun, 14 Aug 2016 19:07:15 -0700\nSubject: [PATCH] Fix bug #72742 - memory allocator fails to realloc small\n block to large one\n\n---\n Zend\/zend_alloc.c | 24 ++++++++++++------------\n 1 file changed, 12 insertions(+), 12 deletions(-)\n\n","diff_code":"diff --git a\/Zend\/zend_alloc.c b\/Zend\/zend_alloc.c\nindex 18765593174f..a79d67b4b996 100644\n--- a\/Zend\/zend_alloc.c\n+++ b\/Zend\/zend_alloc.c\n@@ -1548,21 +1548,21 @@ static void *zend_mm_realloc_heap(zend_mm_heap *heap, void *ptr, size_t size, si\n \n \t\tZEND_MM_CHECK(chunk->heap == heap, \"zend_mm_heap corrupted\");\n \t\tif (info & ZEND_MM_IS_SRUN) {\n-\t\t\tint old_bin_num, bin_num;\n-\n-\t\t\told_bin_num = ZEND_MM_SRUN_BIN_NUM(info);\n+\t\t\tint old_bin_num = ZEND_MM_SRUN_BIN_NUM(info);\n \t\t\told_size = bin_data_size[old_bin_num];\n-\t\t\tbin_num = ZEND_MM_SMALL_SIZE_TO_BIN(size);\n-\t\t\tif (old_bin_num == bin_num) {\n+\t\t\tif (size <= ZEND_MM_MAX_SMALL_SIZE) {\n+\t\t\t\tint bin_num = ZEND_MM_SMALL_SIZE_TO_BIN(size);\n+\t\t\t\tif (old_bin_num == bin_num) {\n #if ZEND_DEBUG\n-\t\t\t\tdbg = zend_mm_get_debug_info(heap, ptr);\n-\t\t\t\tdbg->size = real_size;\n-\t\t\t\tdbg->filename = __zend_filename;\n-\t\t\t\tdbg->orig_filename = __zend_orig_filename;\n-\t\t\t\tdbg->lineno = __zend_lineno;\n-\t\t\t\tdbg->orig_lineno = __zend_orig_lineno;\n+\t\t\t\t\tdbg = zend_mm_get_debug_info(heap, ptr);\n+\t\t\t\t\tdbg->size = real_size;\n+\t\t\t\t\tdbg->filename = __zend_filename;\n+\t\t\t\t\tdbg->orig_filename = __zend_orig_filename;\n+\t\t\t\t\tdbg->lineno = __zend_lineno;\n+\t\t\t\t\tdbg->orig_lineno = __zend_orig_lineno;\n #endif\n-\t\t\t\treturn ptr;\n+\t\t\t\t\treturn ptr;\n+\t\t\t\t}\n \t\t\t}\n \t\t} else \/* if (info & ZEND_MM_IS_LARGE_RUN) *\/ {\n \t\t\tZEND_MM_CHECK(ZEND_MM_ALIGNED_OFFSET(page_offset, ZEND_MM_PAGE_SIZE) == 0, \"zend_mm_heap corrupted\");\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2016-4300","CWE_ID":"190","category":"security","commit_id":"e79ef306afe332faf22e9b442a2c6b59cb175573","commit_message":"From e79ef306afe332faf22e9b442a2c6b59cb175573 Mon Sep 17 00:00:00 2001\nFrom: Tim Kientzle <kientzle@acm.org>\nDate: Sun, 19 Jun 2016 14:14:09 -0700\nSubject: [PATCH] Issue #718: Fix TALOS-CAN-152\n\nIf a 7-Zip archive declares a rediculously large number of substreams,\nit can overflow an internal counter, leading a subsequent memory\nallocation to be too small for the substream data.\n\nThanks to the Open Source and Threat Intelligence project at Cisco\nfor reporting this issue.\n---\n libarchive\/archive_read_support_format_7zip.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/libarchive\/archive_read_support_format_7zip.c b\/libarchive\/archive_read_support_format_7zip.c\nindex 90901acb7..1dfe52b85 100644\n--- a\/libarchive\/archive_read_support_format_7zip.c\n+++ b\/libarchive\/archive_read_support_format_7zip.c\n@@ -2153,6 +2153,9 @@ read_SubStreamsInfo(struct archive_read *a, struct _7z_substream_info *ss,\n \t\t\t\treturn (-1);\n \t\t\tif (UMAX_ENTRY < f[i].numUnpackStreams)\n \t\t\t\treturn (-1);\n+\t\t\tif (unpack_streams > SIZE_MAX - UMAX_ENTRY) {\n+\t\t\t\treturn (-1);\n+\t\t\t}\n \t\t\tunpack_streams += (size_t)f[i].numUnpackStreams;\n \t\t}\n \t\tif ((p = header_bytes(a, 1)) == NULL)\n","owner":"libarchive","repo":"libarchive","source":"cve"},{"CVE_ID":"CVE-2018-8797","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2017-18257","CWE_ID":"190","category":"security","commit_id":"b86e33075ed1909d8002745b56ecf73b833db143","commit_message":"From b86e33075ed1909d8002745b56ecf73b833db143 Mon Sep 17 00:00:00 2001\nFrom: Wei Fang <fangwei1@huawei.com>\nDate: Sun, 22 Jan 2017 12:21:02 +0800\nSubject: [PATCH] f2fs: fix a dead loop in f2fs_fiemap()\n\nA dead loop can be triggered in f2fs_fiemap() using the test case\nas below:\n\n\t...\n\tfd = open();\n\tfallocate(fd, 0, 0, 4294967296);\n\tioctl(fd, FS_IOC_FIEMAP, fiemap_buf);\n\t...\n\nIt's caused by an overflow in __get_data_block():\n\t...\n\tbh->b_size = map.m_len << inode->i_blkbits;\n\t...\nmap.m_len is an unsigned int, and bh->b_size is a size_t which is 64 bits\non 64 bits archtecture, type conversion from an unsigned int to a size_t\nwill result in an overflow.\n\nIn the above-mentioned case, bh->b_size will be zero, and f2fs_fiemap()\nwill call get_data_block() at block 0 again an again.\n\nFix this by adding a force conversion before left shift.\n\nSigned-off-by: Wei Fang <fangwei1@huawei.com>\nAcked-by: Chao Yu <yuchao0@huawei.com>\nSigned-off-by: Jaegeuk Kim <jaegeuk@kernel.org>\n---\n fs\/f2fs\/data.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/fs\/f2fs\/data.c b\/fs\/f2fs\/data.c\nindex 2ea80215f26ce..3b5f1d14cab37 100644\n--- a\/fs\/f2fs\/data.c\n+++ b\/fs\/f2fs\/data.c\n@@ -964,7 +964,7 @@ static int __get_data_block(struct inode *inode, sector_t iblock,\n \tif (!err) {\n \t\tmap_bh(bh, inode->i_sb, map.m_pblk);\n \t\tbh->b_state = (bh->b_state & ~F2FS_MAP_FLAGS) | map.m_flags;\n-\t\tbh->b_size = map.m_len << inode->i_blkbits;\n+\t\tbh->b_size = (u64)map.m_len << inode->i_blkbits;\n \t}\n \treturn err;\n }\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2017-5931","CWE_ID":"190","category":"security","commit_id":"a08aaff811fb194950f79711d2afe5a892ae03a4","commit_message":"From a08aaff811fb194950f79711d2afe5a892ae03a4 Mon Sep 17 00:00:00 2001\nFrom: Gonglei <arei.gonglei@huawei.com>\nDate: Tue, 3 Jan 2017 14:50:03 +0800\nSubject: [PATCH] virtio-crypto: fix possible integer and heap overflow\n\nBecause the 'size_t' type is 4 bytes in 32-bit platform, which\nis the same with 'int'. It's easy to make 'max_len' to zero when\ninteger overflow and then cause heap overflow if 'max_len' is zero.\n\nUsing uint_64 instead of size_t to avoid the integer overflow.\n\nCc: qemu-stable@nongnu.org\nReported-by: Li Qiang <liqiang6-s@360.cn>\nSigned-off-by: Gonglei <arei.gonglei@huawei.com>\nTested-by: Li Qiang <liqiang6-s@360.cn>\nReviewed-by: Michael S. Tsirkin <mst@redhat.com>\nSigned-off-by: Michael S. Tsirkin <mst@redhat.com>\n---\n hw\/virtio\/virtio-crypto.c | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/hw\/virtio\/virtio-crypto.c b\/hw\/virtio\/virtio-crypto.c\nindex 2f2467e..c23e1ad 100644\n--- a\/hw\/virtio\/virtio-crypto.c\n+++ b\/hw\/virtio\/virtio-crypto.c\n@@ -416,7 +416,7 @@ virtio_crypto_sym_op_helper(VirtIODevice *vdev,\n     uint32_t hash_start_src_offset = 0, len_to_hash = 0;\n     uint32_t cipher_start_src_offset = 0, len_to_cipher = 0;\n \n-    size_t max_len, curr_size = 0;\n+    uint64_t max_len, curr_size = 0;\n     size_t s;\n \n     \/* Plain cipher *\/\n@@ -441,7 +441,7 @@ virtio_crypto_sym_op_helper(VirtIODevice *vdev,\n         return NULL;\n     }\n \n-    max_len = iv_len + aad_len + src_len + dst_len + hash_result_len;\n+    max_len = (uint64_t)iv_len + aad_len + src_len + dst_len + hash_result_len;\n     if (unlikely(max_len > vcrypto->conf.max_size)) {\n         virtio_error(vdev, \"virtio-crypto too big length\");\n         return NULL;\n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-7482","CWE_ID":"190","category":"security","commit_id":"5f2f97656ada8d811d3c1bef503ced266fcd53a0","commit_message":"From 5f2f97656ada8d811d3c1bef503ced266fcd53a0 Mon Sep 17 00:00:00 2001\nFrom: David Howells <dhowells@redhat.com>\nDate: Thu, 15 Jun 2017 00:12:24 +0100\nSubject: rxrpc: Fix several cases where a padded len isn't checked in ticket\n decode\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nThis fixes CVE-2017-7482.\n\nWhen a kerberos 5 ticket is being decoded so that it can be loaded into an\nrxrpc-type key, there are several places in which the length of a\nvariable-length field is checked to make sure that it's not going to\noverrun the available data - but the data is padded to the nearest\nfour-byte boundary and the code doesn't check for this extra.  This could\nlead to the size-remaining variable wrapping and the data pointer going\nover the end of the buffer.\n\nFix this by making the various variable-length data checks use the padded\nlength.\n\nReported-by: \u77f3\u78ca <shilei-c@360.cn>\nSigned-off-by: David Howells <dhowells@redhat.com>\nReviewed-by: Marc Dionne <marc.c.dionne@auristor.com>\nReviewed-by: Dan Carpenter <dan.carpenter@oracle.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/rxrpc\/key.c | 64 ++++++++++++++++++++++++++++++---------------------------\n 1 file changed, 34 insertions(+), 30 deletions(-)\n\n","diff_code":"diff --git a\/net\/rxrpc\/key.c b\/net\/rxrpc\/key.c\nindex 0a4e28477ad9..54369225766e 100644\n--- a\/net\/rxrpc\/key.c\n+++ b\/net\/rxrpc\/key.c\n@@ -217,7 +217,7 @@ static int rxrpc_krb5_decode_principal(struct krb5_principal *princ,\n \t\t\t\t       unsigned int *_toklen)\n {\n \tconst __be32 *xdr = *_xdr;\n-\tunsigned int toklen = *_toklen, n_parts, loop, tmp;\n+\tunsigned int toklen = *_toklen, n_parts, loop, tmp, paddedlen;\n \n \t\/* there must be at least one name, and at least #names+1 length\n \t * words *\/\n@@ -247,16 +247,16 @@ static int rxrpc_krb5_decode_principal(struct krb5_principal *princ,\n \t\ttoklen -= 4;\n \t\tif (tmp <= 0 || tmp > AFSTOKEN_STRING_MAX)\n \t\t\treturn -EINVAL;\n-\t\tif (tmp > toklen)\n+\t\tpaddedlen = (tmp + 3) & ~3;\n+\t\tif (paddedlen > toklen)\n \t\t\treturn -EINVAL;\n \t\tprinc->name_parts[loop] = kmalloc(tmp + 1, GFP_KERNEL);\n \t\tif (!princ->name_parts[loop])\n \t\t\treturn -ENOMEM;\n \t\tmemcpy(princ->name_parts[loop], xdr, tmp);\n \t\tprinc->name_parts[loop][tmp] = 0;\n-\t\ttmp = (tmp + 3) & ~3;\n-\t\ttoklen -= tmp;\n-\t\txdr += tmp >> 2;\n+\t\ttoklen -= paddedlen;\n+\t\txdr += paddedlen >> 2;\n \t}\n \n \tif (toklen < 4)\n@@ -265,16 +265,16 @@ static int rxrpc_krb5_decode_principal(struct krb5_principal *princ,\n \ttoklen -= 4;\n \tif (tmp <= 0 || tmp > AFSTOKEN_K5_REALM_MAX)\n \t\treturn -EINVAL;\n-\tif (tmp > toklen)\n+\tpaddedlen = (tmp + 3) & ~3;\n+\tif (paddedlen > toklen)\n \t\treturn -EINVAL;\n \tprinc->realm = kmalloc(tmp + 1, GFP_KERNEL);\n \tif (!princ->realm)\n \t\treturn -ENOMEM;\n \tmemcpy(princ->realm, xdr, tmp);\n \tprinc->realm[tmp] = 0;\n-\ttmp = (tmp + 3) & ~3;\n-\ttoklen -= tmp;\n-\txdr += tmp >> 2;\n+\ttoklen -= paddedlen;\n+\txdr += paddedlen >> 2;\n \n \t_debug(\"%s\/...@%s\", princ->name_parts[0], princ->realm);\n \n@@ -293,7 +293,7 @@ static int rxrpc_krb5_decode_tagged_data(struct krb5_tagged_data *td,\n \t\t\t\t\t unsigned int *_toklen)\n {\n \tconst __be32 *xdr = *_xdr;\n-\tunsigned int toklen = *_toklen, len;\n+\tunsigned int toklen = *_toklen, len, paddedlen;\n \n \t\/* there must be at least one tag and one length word *\/\n \tif (toklen <= 8)\n@@ -307,15 +307,17 @@ static int rxrpc_krb5_decode_tagged_data(struct krb5_tagged_data *td,\n \ttoklen -= 8;\n \tif (len > max_data_size)\n \t\treturn -EINVAL;\n+\tpaddedlen = (len + 3) & ~3;\n+\tif (paddedlen > toklen)\n+\t\treturn -EINVAL;\n \ttd->data_len = len;\n \n \tif (len > 0) {\n \t\ttd->data = kmemdup(xdr, len, GFP_KERNEL);\n \t\tif (!td->data)\n \t\t\treturn -ENOMEM;\n-\t\tlen = (len + 3) & ~3;\n-\t\ttoklen -= len;\n-\t\txdr += len >> 2;\n+\t\ttoklen -= paddedlen;\n+\t\txdr += paddedlen >> 2;\n \t}\n \n \t_debug(\"tag %x len %x\", td->tag, td->data_len);\n@@ -387,7 +389,7 @@ static int rxrpc_krb5_decode_ticket(u8 **_ticket, u16 *_tktlen,\n \t\t\t\t    const __be32 **_xdr, unsigned int *_toklen)\n {\n \tconst __be32 *xdr = *_xdr;\n-\tunsigned int toklen = *_toklen, len;\n+\tunsigned int toklen = *_toklen, len, paddedlen;\n \n \t\/* there must be at least one length word *\/\n \tif (toklen <= 4)\n@@ -399,6 +401,9 @@ static int rxrpc_krb5_decode_ticket(u8 **_ticket, u16 *_tktlen,\n \ttoklen -= 4;\n \tif (len > AFSTOKEN_K5_TIX_MAX)\n \t\treturn -EINVAL;\n+\tpaddedlen = (len + 3) & ~3;\n+\tif (paddedlen > toklen)\n+\t\treturn -EINVAL;\n \t*_tktlen = len;\n \n \t_debug(\"ticket len %u\", len);\n@@ -407,9 +412,8 @@ static int rxrpc_krb5_decode_ticket(u8 **_ticket, u16 *_tktlen,\n \t\t*_ticket = kmemdup(xdr, len, GFP_KERNEL);\n \t\tif (!*_ticket)\n \t\t\treturn -ENOMEM;\n-\t\tlen = (len + 3) & ~3;\n-\t\ttoklen -= len;\n-\t\txdr += len >> 2;\n+\t\ttoklen -= paddedlen;\n+\t\txdr += paddedlen >> 2;\n \t}\n \n \t*_xdr = xdr;\n@@ -552,7 +556,7 @@ static int rxrpc_preparse_xdr(struct key_preparsed_payload *prep)\n {\n \tconst __be32 *xdr = prep->data, *token;\n \tconst char *cp;\n-\tunsigned int len, tmp, loop, ntoken, toklen, sec_ix;\n+\tunsigned int len, paddedlen, loop, ntoken, toklen, sec_ix;\n \tsize_t datalen = prep->datalen;\n \tint ret;\n \n@@ -578,22 +582,21 @@ static int rxrpc_preparse_xdr(struct key_preparsed_payload *prep)\n \tif (len < 1 || len > AFSTOKEN_CELL_MAX)\n \t\tgoto not_xdr;\n \tdatalen -= 4;\n-\ttmp = (len + 3) & ~3;\n-\tif (tmp > datalen)\n+\tpaddedlen = (len + 3) & ~3;\n+\tif (paddedlen > datalen)\n \t\tgoto not_xdr;\n \n \tcp = (const char *) xdr;\n \tfor (loop = 0; loop < len; loop++)\n \t\tif (!isprint(cp[loop]))\n \t\t\tgoto not_xdr;\n-\tif (len < tmp)\n-\t\tfor (; loop < tmp; loop++)\n-\t\t\tif (cp[loop])\n-\t\t\t\tgoto not_xdr;\n+\tfor (; loop < paddedlen; loop++)\n+\t\tif (cp[loop])\n+\t\t\tgoto not_xdr;\n \t_debug(\"cellname: [%u\/%u] '%*.*s'\",\n-\t       len, tmp, len, len, (const char *) xdr);\n-\tdatalen -= tmp;\n-\txdr += tmp >> 2;\n+\t       len, paddedlen, len, len, (const char *) xdr);\n+\tdatalen -= paddedlen;\n+\txdr += paddedlen >> 2;\n \n \t\/* get the token count *\/\n \tif (datalen < 12)\n@@ -614,10 +617,11 @@ static int rxrpc_preparse_xdr(struct key_preparsed_payload *prep)\n \t\tsec_ix = ntohl(*xdr);\n \t\tdatalen -= 4;\n \t\t_debug(\"token: [%x\/%zx] %x\", toklen, datalen, sec_ix);\n-\t\tif (toklen < 20 || toklen > datalen)\n+\t\tpaddedlen = (toklen + 3) & ~3;\n+\t\tif (toklen < 20 || toklen > datalen || paddedlen > datalen)\n \t\t\tgoto not_xdr;\n-\t\tdatalen -= (toklen + 3) & ~3;\n-\t\txdr += (toklen + 3) >> 2;\n+\t\tdatalen -= paddedlen;\n+\t\txdr += paddedlen >> 2;\n \n \t} while (--loop > 0);\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-2326","CWE_ID":"190","category":"security","commit_id":"7c0b84d89911b2035161f5ef51aafbfcc84aa9e2","commit_message":"From 7c0b84d89911b2035161f5ef51aafbfcc84aa9e2 Mon Sep 17 00:00:00 2001\nFrom: Michael Niedermayer <michael@niedermayer.cc>\nDate: Tue, 12 Jan 2016 18:49:20 +0100\nSubject: [PATCH] avformat\/asfenc: Check pts\n\nFixes integer overflow\nFixes: 0063df8be3aaa30dd6d76f59c8f818c8\/signal_sigsegv_7b7b59_3634_bf418b6822bbfa68734411d96b667be3.mov\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n---\n libavformat\/asfenc.c | 5 +++++\n 1 file changed, 5 insertions(+)\n\n","diff_code":"diff --git a\/libavformat\/asfenc.c b\/libavformat\/asfenc.c\nindex 90d5c26317..87993b64c9 100644\n--- a\/libavformat\/asfenc.c\n+++ b\/libavformat\/asfenc.c\n@@ -964,6 +964,11 @@ static int asf_write_packet(AVFormatContext *s, AVPacket *pkt)\n \n     pts = (pkt->pts != AV_NOPTS_VALUE) ? pkt->pts : pkt->dts;\n     av_assert0(pts != AV_NOPTS_VALUE);\n+    if (   pts < - PREROLL_TIME\n+        || pts > (INT_MAX-3)\/10000LL * ASF_INDEXED_INTERVAL - PREROLL_TIME) {\n+        av_log(s, AV_LOG_ERROR, \"input pts %\"PRId64\" is invalid\\n\", pts);\n+        return AVERROR(EINVAL);\n+    }\n     pts *= 10000;\n     asf->duration = FFMAX(asf->duration, pts + pkt->duration * 10000);\n \n-- \n2.11.0\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-10159","CWE_ID":"190","category":"security","commit_id":"ca46d0acbce55019b970fcd4c1e8a10edfdded93","commit_message":"From ca46d0acbce55019b970fcd4c1e8a10edfdded93 Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Fri, 30 Dec 2016 15:34:46 -0800\nSubject: [PATCH] Fix int overflows in phar (bug #73764)\n\n---\n ext\/phar\/phar.c              |   4 ++--\n ext\/phar\/tests\/bug73764.phar | Bin 0 -> 138 bytes\n ext\/phar\/tests\/bug73764.phpt |  16 ++++++++++++++++\n 3 files changed, 18 insertions(+), 2 deletions(-)\n create mode 100644 ext\/phar\/tests\/bug73764.phar\n create mode 100644 ext\/phar\/tests\/bug73764.phpt\n\n","diff_code":"diff --git a\/ext\/phar\/phar.c b\/ext\/phar\/phar.c\nindex 14b80e175ed4..532b4c3169ac 100644\n--- a\/ext\/phar\/phar.c\n+++ b\/ext\/phar\/phar.c\n@@ -1055,7 +1055,7 @@ static int phar_parse_pharfile(php_stream *fp, char *fname, int fname_len, char\n \tentry.is_persistent = mydata->is_persistent;\n \n \tfor (manifest_index = 0; manifest_index < manifest_count; ++manifest_index) {\n-\t\tif (buffer + 4 > endbuffer) {\n+\t\tif (buffer + 24 > endbuffer) {\n \t\t\tMAPPHAR_FAIL(\"internal corruption of phar \\\"%s\\\" (truncated manifest entry)\")\n \t\t}\n \n@@ -1069,7 +1069,7 @@ static int phar_parse_pharfile(php_stream *fp, char *fname, int fname_len, char\n \t\t\tentry.manifest_pos = manifest_index;\n \t\t}\n \n-\t\tif (entry.filename_len + 20 > endbuffer - buffer) {\n+\t\tif (entry.filename_len > endbuffer - buffer - 20) {\n \t\t\tMAPPHAR_FAIL(\"internal corruption of phar \\\"%s\\\" (truncated manifest entry)\");\n \t\t}\n \ndiff --git a\/ext\/phar\/tests\/bug73764.phar b\/ext\/phar\/tests\/bug73764.phar\nnew file mode 100644\nindex 0000000000000000000000000000000000000000..89a5ff65426d1b64a7a114c2acf499d57adf0bf9\nGIT binary patch\nliteral 138\nzcma!#_i*$HiFfw*4e<1F4bsrGR<O6@<;rJZU|<B||NkL0kO>5D{{R1<T9KGrkdvxc\nzkWnB96jBZki2%{gYogD9lz@PZJy4P>H8~?+K`A3OCnsN_JijO>B_>aa%ifMFopGvt\nX!v6%-oR_-~ZG09I3bMxC$=3-0z#k^&\n\nliteral 0\nHcmV?d00001\n\ndiff --git a\/ext\/phar\/tests\/bug73764.phpt b\/ext\/phar\/tests\/bug73764.phpt\nnew file mode 100644\nindex 000000000000..cab314a7317c\n--- \/dev\/null\n+++ b\/ext\/phar\/tests\/bug73764.phpt\n@@ -0,0 +1,16 @@\n+--TEST--\n+Phar: PHP bug #73764: Crash while loading hostile phar archive\n+--SKIPIF--\n+<?php if (!extension_loaded(\"phar\")) die(\"skip\"); ?>\n+--FILE--\n+<?php\n+chdir(__DIR__);\n+try {\n+$p = Phar::LoadPhar('bug73764.phar', 'alias.phar');\n+echo \"OK\\n\";\n+} catch(PharException $e) {\n+\techo $e->getMessage();\n+}\n+?>\n+--EXPECTF--\n+internal corruption of phar \"%sbug73764.phar\" (truncated manifest entry)\n\\ No newline at end of file\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2017-15873","CWE_ID":"190","category":"security","commit_id":"0402cb32df015d9372578e3db27db47b33d5c7b0","commit_message":"From 0402cb32df015d9372578e3db27db47b33d5c7b0 Mon Sep 17 00:00:00 2001\nFrom: Denys Vlasenko <vda.linux@googlemail.com>\nDate: Sun, 22 Oct 2017 18:23:23 +0200\nSubject: bunzip2: fix runCnt overflow from bug 10431\n\nThis particular corrupted file can be dealth with by using \"unsigned\".\nIf there will be cases where it genuinely overflows, there is a disabled\ncode to deal with that too.\n\nfunction                                             old     new   delta\nget_next_block                                      1678    1667     -11\n\nSigned-off-by: Denys Vlasenko <vda.linux@googlemail.com>\n---\n archival\/libarchive\/decompress_bunzip2.c | 30 +++++++++++++++++++-----------\n 1 file changed, 19 insertions(+), 11 deletions(-)\n\n","diff_code":"diff --git a\/archival\/libarchive\/decompress_bunzip2.c b\/archival\/libarchive\/decompress_bunzip2.c\nindex 7cd18f5ed..bec89edd3 100644\n--- a\/archival\/libarchive\/decompress_bunzip2.c\n+++ b\/archival\/libarchive\/decompress_bunzip2.c\n@@ -156,15 +156,15 @@ static unsigned get_bits(bunzip_data *bd, int bits_wanted)\n static int get_next_block(bunzip_data *bd)\n {\n \tstruct group_data *hufGroup;\n-\tint dbufCount, dbufSize, groupCount, *base, *limit, selector,\n-\t\ti, j, runPos, symCount, symTotal, nSelectors, byteCount[256];\n-\tint runCnt = runCnt; \/* for compiler *\/\n+\tint groupCount, *base, *limit, selector,\n+\t\ti, j, symCount, symTotal, nSelectors, byteCount[256];\n \tuint8_t uc, symToByte[256], mtfSymbol[256], *selectors;\n \tuint32_t *dbuf;\n \tunsigned origPtr, t;\n+\tunsigned dbufCount, runPos;\n+\tunsigned runCnt = runCnt; \/* for compiler *\/\n \n \tdbuf = bd->dbuf;\n-\tdbufSize = bd->dbufSize;\n \tselectors = bd->selectors;\n \n \/* In bbox, we are ok with aborting through setjmp which is set up in start_bunzip *\/\n@@ -187,7 +187,7 @@ static int get_next_block(bunzip_data *bd)\n \t   it didn't actually work. *\/\n \tif (get_bits(bd, 1)) return RETVAL_OBSOLETE_INPUT;\n \torigPtr = get_bits(bd, 24);\n-\tif ((int)origPtr > dbufSize) return RETVAL_DATA_ERROR;\n+\tif (origPtr > bd->dbufSize) return RETVAL_DATA_ERROR;\n \n \t\/* mapping table: if some byte values are never used (encoding things\n \t   like ascii text), the compression code removes the gaps to have fewer\n@@ -435,7 +435,14 @@ static int get_next_block(bunzip_data *bd)\n \t\t\t   symbols, but a run of length 0 doesn't mean anything in this\n \t\t\t   context).  Thus space is saved. *\/\n \t\t\trunCnt += (runPos << nextSym); \/* +runPos if RUNA; +2*runPos if RUNB *\/\n-\t\t\tif (runPos < dbufSize) runPos <<= 1;\n+\/\/The 32-bit overflow of runCnt wasn't yet seen, but probably can happen.\n+\/\/This would be the fix (catches too large count way before it can overflow):\n+\/\/\t\t\tif (runCnt > bd->dbufSize) {\n+\/\/\t\t\t\tdbg(\"runCnt:%u > dbufSize:%u RETVAL_DATA_ERROR\",\n+\/\/\t\t\t\t\t\trunCnt, bd->dbufSize);\n+\/\/\t\t\t\treturn RETVAL_DATA_ERROR;\n+\/\/\t\t\t}\n+\t\t\tif (runPos < bd->dbufSize) runPos <<= 1;\n \t\t\tgoto end_of_huffman_loop;\n \t\t}\n \n@@ -445,14 +452,15 @@ static int get_next_block(bunzip_data *bd)\n \t\t   literal used is the one at the head of the mtfSymbol array.) *\/\n \t\tif (runPos != 0) {\n \t\t\tuint8_t tmp_byte;\n-\t\t\tif (dbufCount + runCnt > dbufSize) {\n-\t\t\t\tdbg(\"dbufCount:%d+runCnt:%d %d > dbufSize:%d RETVAL_DATA_ERROR\",\n-\t\t\t\t\t\tdbufCount, runCnt, dbufCount + runCnt, dbufSize);\n+\t\t\tif (dbufCount + runCnt > bd->dbufSize) {\n+\t\t\t\tdbg(\"dbufCount:%u+runCnt:%u %u > dbufSize:%u RETVAL_DATA_ERROR\",\n+\t\t\t\t\t\tdbufCount, runCnt, dbufCount + runCnt, bd->dbufSize);\n \t\t\t\treturn RETVAL_DATA_ERROR;\n \t\t\t}\n \t\t\ttmp_byte = symToByte[mtfSymbol[0]];\n \t\t\tbyteCount[tmp_byte] += runCnt;\n-\t\t\twhile (--runCnt >= 0) dbuf[dbufCount++] = (uint32_t)tmp_byte;\n+\t\t\twhile ((int)--runCnt >= 0)\n+\t\t\t\tdbuf[dbufCount++] = (uint32_t)tmp_byte;\n \t\t\trunPos = 0;\n \t\t}\n \n@@ -466,7 +474,7 @@ static int get_next_block(bunzip_data *bd)\n \t\t   first symbol in the mtf array, position 0, would have been handled\n \t\t   as part of a run above.  Therefore 1 unused mtf position minus\n \t\t   2 non-literal nextSym values equals -1.) *\/\n-\t\tif (dbufCount >= dbufSize) return RETVAL_DATA_ERROR;\n+\t\tif (dbufCount >= bd->dbufSize) return RETVAL_DATA_ERROR;\n \t\ti = nextSym - 1;\n \t\tuc = mtfSymbol[i];\n \n-- \ncgit v1.2.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-17568","CWE_ID":"190","category":"security","commit_id":"5c2dc2b7856a66338e2f113540fd2e8fcb847f9e","commit_message":"From 5c2dc2b7856a66338e2f113540fd2e8fcb847f9e Mon Sep 17 00:00:00 2001\nFrom: Benjamin Chodroff <benjamin.chodroff@gmail.com>\nDate: Wed, 8 Aug 2018 11:10:45 +0800\nSubject: [PATCH] fix memory corruption and other 32bit overflows\n\n---\n network\/nw_buf.c  | 10 ++++++++--\n utils\/ut_rpc.c    | 10 ++++++++--\n utils\/ut_rpc.h    |  1 +\n utils\/ut_ws_svr.c |  2 +-\n utils\/ut_ws_svr.h |  2 ++\n 5 files changed, 20 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/network\/nw_buf.c b\/network\/nw_buf.c\nindex f338af5..fa42b0a 100644\n--- a\/network\/nw_buf.c\n+++ b\/network\/nw_buf.c\n@@ -8,7 +8,9 @@\n # include \"nw_buf.h\"\n \n # define NW_BUF_POOL_INIT_SIZE 64\n+# define NW_BUF_POOL_MAX_SIZE  65535\n # define NW_CACHE_INIT_SIZE    64\n+# define NW_CACHE_MAX_SIZE     65535\n \n size_t nw_buf_size(nw_buf *buf)\n {\n@@ -85,7 +87,7 @@ void nw_buf_free(nw_buf_pool *pool, nw_buf *buf)\n {\n     if (pool->free < pool->free_total) {\n         pool->free_arr[pool->free++] = buf;\n-    } else {\n+    } else if (pool->free_total < NW_BUF_POOL_MAX_SIZE) {\n         uint32_t new_free_total = pool->free_total * 2;\n         void *new_arr = realloc(pool->free_arr, new_free_total * sizeof(nw_buf *));\n         if (new_arr) {\n@@ -95,6 +97,8 @@ void nw_buf_free(nw_buf_pool *pool, nw_buf *buf)\n         } else {\n             free(buf);\n         }\n+    } else {\n+        free(buf);\n     }\n }\n \n@@ -230,7 +234,7 @@ void nw_cache_free(nw_cache *cache, void *obj)\n {\n     if (cache->free < cache->free_total) {\n         cache->free_arr[cache->free++] = obj;\n-    } else {\n+    } else if (cache->free_total < NW_CACHE_MAX_SIZE) {\n         uint32_t new_free_total = cache->free_total * 2;\n         void *new_arr = realloc(cache->free_arr, new_free_total * sizeof(void *));\n         if (new_arr) {\n@@ -240,6 +244,8 @@ void nw_cache_free(nw_cache *cache, void *obj)\n         } else {\n             free(obj);\n         }\n+    } else {\n+        free(obj);\n     }\n }\n \ndiff --git a\/utils\/ut_rpc.c b\/utils\/ut_rpc.c\nindex 4ade964..14d0429 100644\n--- a\/utils\/ut_rpc.c\n+++ b\/utils\/ut_rpc.c\n@@ -44,13 +44,19 @@ int rpc_pack(rpc_pkg *pkg, void **data, uint32_t *size)\n {\n     static void *send_buf;\n     static size_t send_buf_size;\n-    uint32_t pkg_size = RPC_PKG_HEAD_SIZE + pkg->ext_size + pkg->body_size;\n+    uint32_t pkg_size;\n+    if (pkg->body_size > RPC_PKG_MAX_BODY_SIZE) {\n+        return -1;\n+    }\n+    pkg_size = RPC_PKG_HEAD_SIZE + pkg->ext_size + pkg->body_size;\n     if (send_buf_size < pkg_size) {\n         if (send_buf)\n             free(send_buf);\n         send_buf_size = pkg_size * 2;\n         send_buf = malloc(send_buf_size);\n-        assert(send_buf != NULL);\n+        if (send_buf == NULL) {\n+            return -1;\n+        }\n     }\n \n     memcpy(send_buf, pkg, RPC_PKG_HEAD_SIZE);\ndiff --git a\/utils\/ut_rpc.h b\/utils\/ut_rpc.h\nindex a30cf53..2c7b217 100644\n--- a\/utils\/ut_rpc.h\n+++ b\/utils\/ut_rpc.h\n@@ -32,6 +32,7 @@ typedef struct rpc_pkg {\n # pragma pack()\n \n # define RPC_PKG_HEAD_SIZE (sizeof(rpc_pkg) - sizeof(void *) * 2)\n+# define RPC_PKG_MAX_BODY_SIZE ((UINT32_MAX \/ 2) - UINT16_MAX - sizeof(rpc_pkg))\n \n int rpc_decode(nw_ses *ses, void *data, size_t max);\n int rpc_pack(rpc_pkg *pkg, void **data, uint32_t *size);\ndiff --git a\/utils\/ut_ws_svr.c b\/utils\/ut_ws_svr.c\nindex 5dfb87b..5a4b8b1 100644\n--- a\/utils\/ut_ws_svr.c\n+++ b\/utils\/ut_ws_svr.c\n@@ -129,7 +129,7 @@ static int on_http_message_complete(http_parser* parser)\n     if (upgrade == NULL || strcasecmp(upgrade, \"websocket\") != 0)\n         goto error;\n     const char *connection = http_request_get_header(info->request, \"Connection\");\n-    if (connection == NULL)\n+    if (connection == NULL || strlen(connection) > UT_WS_SVR_MAX_HEADER_SIZE)\n         goto error;\n     else {\n         bool found_upgrade = false;\ndiff --git a\/utils\/ut_ws_svr.h b\/utils\/ut_ws_svr.h\nindex d3fcf0f..11c53d4 100644\n--- a\/utils\/ut_ws_svr.h\n+++ b\/utils\/ut_ws_svr.h\n@@ -12,6 +12,8 @@\n # include \"nw_buf.h\"\n # include \"nw_timer.h\"\n \n+# define UT_WS_SVR_MAX_HEADER_SIZE 1024\n+\n typedef struct ws_svr_cfg {\n     uint32_t bind_count;\n     nw_svr_bind *bind_arr;\n","owner":"viabtc","repo":"viabtc_exchange_server.viabtc.viabtc_exchange_server","source":"cve"},{"CVE_ID":"CVE-2016-10507","CWE_ID":"190","category":"security","commit_id":"893143c8e13e491d0e884eb757580ec9575bbc8f","commit_message":"From 893143c8e13e491d0e884eb757580ec9575bbc8f Mon Sep 17 00:00:00 2001\nFrom: trylab <trylab@users.noreply.github.com>\nDate: Tue, 13 Sep 2016 17:43:30 +0800\nSubject: [PATCH] Fix issue 833.\n\nAdd some overflow check operations.\n---\n src\/bin\/jp2\/convertbmp.c | 18 ++++++++++++++++++\n 1 file changed, 18 insertions(+)\n\n","diff_code":"diff --git a\/src\/bin\/jp2\/convertbmp.c b\/src\/bin\/jp2\/convertbmp.c\nindex d264823f0..ae83077ca 100644\n--- a\/src\/bin\/jp2\/convertbmp.c\n+++ b\/src\/bin\/jp2\/convertbmp.c\n@@ -675,10 +675,28 @@ opj_image_t* bmptoimage(const char *filename, opj_cparameters_t *parameters)\n \t\t}\n \t}\n \t\n+\tif (Info_h.biWidth == 0 || Info_h.biHeight == 0) {\n+\t\tfclose(IN);\n+\t\treturn NULL;\n+\t}\n+\t\n+\tif (Info_h.biBitCount > (((OPJ_UINT32)-1) - 31) \/ Info_h.biWidth) {\n+\t\tfclose(IN);\n+\t\treturn NULL;\n+\t}\n \tstride = ((Info_h.biWidth * Info_h.biBitCount + 31U) \/ 32U) * 4U; \/* rows are aligned on 32bits *\/\n \tif (Info_h.biBitCount == 4 && Info_h.biCompression == 2) { \/* RLE 4 gets decoded as 8 bits data for now... *\/\n+\t\tif (8 > (((OPJ_UINT32)-1) - 31) \/ Info_h.biWidth) {\n+\t\t\tfclose(IN);\n+\t\t\treturn NULL;\n+\t\t}\n \t\tstride = ((Info_h.biWidth * 8U + 31U) \/ 32U) * 4U;\n \t}\n+\t\n+\tif (stride > ((OPJ_UINT32)-1) \/ sizeof(OPJ_UINT8) \/ Info_h.biHeight) {\n+\t\tfclose(IN);\n+\t\treturn NULL;\n+\t}\n \tpData = (OPJ_UINT8 *) calloc(1, stride * Info_h.biHeight * sizeof(OPJ_UINT8));\n \tif (pData == NULL) {\n \t\tfclose(IN);\n","owner":"uclouvain","repo":"openjpeg.uclouvain.openjpeg","source":"cve"},{"CVE_ID":"CVE-2017-5885","CWE_ID":"190","category":"security","commit_id":"c8583fd3783c5b811590fcb7bae4ce6e7344963e","commit_message":"From c8583fd3783c5b811590fcb7bae4ce6e7344963e Mon Sep 17 00:00:00 2001\nFrom: \"Daniel P. Berrange\" <berrange@redhat.com>\nDate: Thu, 2 Feb 2017 18:18:48 +0000\nSubject: [PATCH] Correctly validate color map range indexes\n\nThe color map index could wrap around to zero causing negative\narray index accesses.\n\nhttps:\/\/bugzilla.gnome.org\/show_bug.cgi?id=778050\n\nCVE-2017-5885\n\nSigned-off-by: Daniel P. Berrange <berrange@redhat.com>\n---\n src\/vnccolormap.c       |  4 +--\n src\/vncconnection.c     | 18 +++++++---\n src\/vncconnectiontest.c | 76 +++++++++++++++++++++++++++++++++++++++++\n 3 files changed, 92 insertions(+), 6 deletions(-)\n\n","diff_code":"diff --git a\/src\/vnccolormap.c b\/src\/vnccolormap.c\nindex 25cd2fc..f3e153a 100644\n--- a\/src\/vnccolormap.c\n+++ b\/src\/vnccolormap.c\n@@ -119,7 +119,7 @@ gboolean vnc_color_map_set(VncColorMap *map,\n                            guint16 green,\n                            guint16 blue)\n {\n-    if (idx >= (map->size + map->offset))\n+    if (idx < map->offset || idx >= (map->size + map->offset))\n         return FALSE;\n \n     map->colors[idx - map->offset].red = red;\n@@ -149,7 +149,7 @@ gboolean vnc_color_map_lookup(VncColorMap *map,\n                               guint16 *green,\n                               guint16 *blue)\n {\n-    if (idx >= (map->size + map->offset))\n+    if (idx < map->offset || idx >= (map->size + map->offset))\n         return FALSE;\n \n     *red = map->colors[idx - map->offset].red;\ndiff --git a\/src\/vncconnection.c b\/src\/vncconnection.c\nindex f57fc4f..8a52346 100644\n--- a\/src\/vncconnection.c\n+++ b\/src\/vncconnection.c\n@@ -3344,8 +3344,13 @@ static gboolean vnc_connection_server_message(VncConnection *conn)\n \n         VNC_DEBUG(\"Colour map from %d with %d entries\",\n                   first_color, n_colors);\n-        map = vnc_color_map_new(first_color, n_colors);\n \n+        if (first_color > (65536 - n_colors)) {\n+            vnc_connection_set_error(conn, \"Colormap start %d out of range %d\", first_color, 65536 - n_colors);\n+            break;\n+        }\n+\n+        map = vnc_color_map_new(first_color, n_colors);\n         for (i = 0; i < n_colors; i++) {\n             guint16 red, green, blue;\n \n@@ -3353,9 +3358,14 @@ static gboolean vnc_connection_server_message(VncConnection *conn)\n             green = vnc_connection_read_u16(conn);\n             blue = vnc_connection_read_u16(conn);\n \n-            vnc_color_map_set(map,\n-                              i + first_color,\n-                              red, green, blue);\n+            if (!vnc_color_map_set(map,\n+                                   i + first_color,\n+                                   red, green, blue)) {\n+                \/* Should not be reachable given earlier range check *\/\n+                vnc_connection_set_error(conn, \"Colormap index %d out of range %d,%d\",\n+                                         i + first_color, first_color, 65536 - n_colors);\n+                break;\n+            }\n         }\n \n         vnc_framebuffer_set_color_map(priv->fb, map);\ndiff --git a\/src\/vncconnectiontest.c b\/src\/vncconnectiontest.c\nindex 521529e..4917b2f 100644\n--- a\/src\/vncconnectiontest.c\n+++ b\/src\/vncconnectiontest.c\n@@ -445,6 +445,76 @@ static void test_unexpected_cmap_server(GInputStream *is, GOutputStream *os)\n }\n \n \n+static void test_overflow_cmap_server(GInputStream *is, GOutputStream *os)\n+{\n+    \/* Frame buffer width \/ height *\/\n+    test_send_u16(os, 100);\n+    test_send_u16(os, 100);\n+\n+    \/* BPP, depth, endian, true color *\/\n+    test_send_u8(os, 32);\n+    test_send_u8(os, 8);\n+    test_send_u8(os, 1);\n+    test_send_u8(os, 0);\n+\n+    \/* RGB max + shift*\/\n+    test_send_u16(os, 255);\n+    test_send_u16(os, 255);\n+    test_send_u16(os, 255);\n+    test_send_u8(os, 0);\n+    test_send_u8(os, 8);\n+    test_send_u8(os, 16);\n+\n+    guint8 pad[3] = {0};\n+    test_send_bytes(os, pad, G_N_ELEMENTS(pad));\n+\n+    \/* name *\/\n+    guint8 name[] = { 'T', 'e', 's', 't' };\n+    test_send_u32(os, G_N_ELEMENTS(name));\n+    test_send_bytes(os, name, G_N_ELEMENTS(name));\n+\n+    \/* n-encodings *\/\n+    test_recv_u8(is, 2);\n+    \/* pad *\/\n+    test_recv_u8(is, 0);\n+    \/* num encodings *\/\n+    test_recv_u16(is, 5);\n+\n+    \/* encodings *\/\n+    test_recv_s32(is, 16);\n+    test_recv_s32(is, 5);\n+    test_recv_s32(is, 2);\n+    test_recv_s32(is, 1);\n+    test_recv_s32(is, 0);\n+\n+    \/* update request *\/\n+    test_recv_u8(is, 3);\n+    \/* ! incremental *\/\n+    test_recv_u8(is, 0);\n+\n+    \/* x, y, w, h *\/\n+    test_recv_u16(is, 0);\n+    test_recv_u16(is, 0);\n+    test_recv_u16(is, 100);\n+    test_recv_u16(is, 100);\n+\n+    \/* set color map *\/\n+    test_send_u8(os, 1);\n+    \/* pad *\/\n+    test_send_u8(os, 0);\n+    \/* first color, ncolors *\/\n+    test_send_u16(os, 65535);\n+    test_send_u16(os, 2);\n+\n+    \/* r,g,b *\/\n+    for (int i = 0 ; i < 2; i++) {\n+        test_send_u16(os, i);\n+        test_send_u16(os, i);\n+        test_send_u16(os, i);\n+    }\n+}\n+\n+\n static void test_validation(void (*test_func)(GInputStream *, GOutputStream *))\n {\n     struct GVncTest *test;\n@@ -526,6 +596,11 @@ static void test_validation_unexpected_cmap(void)\n {\n     test_validation(test_unexpected_cmap_server);\n }\n+\n+static void test_validation_overflow_cmap(void)\n+{\n+    test_validation(test_overflow_cmap_server);\n+}\n #endif\n \n int main(int argc, char **argv) {\n@@ -541,6 +616,7 @@ int main(int argc, char **argv) {\n     g_test_add_func(\"\/conn\/validation\/copyrect\", test_validation_copyrect);\n     g_test_add_func(\"\/conn\/validation\/hextile\", test_validation_hextile);\n     g_test_add_func(\"\/conn\/validation\/unexpectedcmap\", test_validation_unexpected_cmap);\n+    g_test_add_func(\"\/conn\/validation\/overflowcmap\", test_validation_overflow_cmap);\n #endif\n \n     return g_test_run();\n-- \n2.21.0\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-9538","CWE_ID":"190","category":"security","commit_id":"43c0b81a818640429317c80fea1e66771e85024b","commit_message":"From 43c0b81a818640429317c80fea1e66771e85024b Mon Sep 17 00:00:00 2001\nFrom: erouault <erouault>\nDate: Sat, 8 Oct 2016 15:04:31 +0000\nSubject: [PATCH] * tools\/tiffcp.c: fix read of undefined variable in case of\n missing required tags. Found on test case of MSVR 35100. * tools\/tiffcrop.c:\n fix read of undefined buffer in readContigStripsIntoBuffer() due to uint16\n overflow. Probably not a security issue but I can be wrong. Reported as MSVR\n 35100 by Axel Souchet from the MSRC Vulnerabilities & Mitigations team.\n\n---\n ChangeLog        | 9 +++++++++\n tools\/tiffcp.c   | 4 ++--\n tools\/tiffcrop.c | 9 ++++++---\n 3 files changed, 17 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/ChangeLog b\/ChangeLog\nindex c76f832c..8f54f286 100644\n--- a\/ChangeLog\n+++ b\/ChangeLog\n@@ -1,3 +1,12 @@\n+2016-10-08 Even Rouault <even.rouault at spatialys.com>\n+\n+\t* tools\/tiffcp.c: fix read of undefined variable in case of missing\n+\trequired tags. Found on test case of MSVR 35100.\n+\t* tools\/tiffcrop.c: fix read of undefined buffer in\n+\treadContigStripsIntoBuffer() due to uint16 overflow. Probably not a\n+\tsecurity issue but I can be wrong. Reported as MSVR 35100 by Axel\n+\tSouchet from the MSRC Vulnerabilities & Mitigations team.\n+\n 2016-09-25  Bob Friesenhahn  <bfriesen@simple.dallas.tx.us>\n \n \t* html: Change as many remotesensing.org broken links to a working\ndiff --git a\/tools\/tiffcp.c b\/tools\/tiffcp.c\nindex ba2b715c..4ad74d39 100644\n--- a\/tools\/tiffcp.c\n+++ b\/tools\/tiffcp.c\n@@ -592,8 +592,8 @@ static\tcopyFunc pickCopyFunc(TIFF*, TIFF*, uint16, uint16);\n static int\n tiffcp(TIFF* in, TIFF* out)\n {\n-\tuint16 bitspersample, samplesperpixel;\n-\tuint16 input_compression, input_photometric;\n+\tuint16 bitspersample, samplesperpixel = 1;\n+\tuint16 input_compression, input_photometric = PHOTOMETRIC_MINISBLACK;\n \tcopyFunc cf;\n \tuint32 width, length;\n \tstruct cpTag* p;\ndiff --git a\/tools\/tiffcrop.c b\/tools\/tiffcrop.c\nindex 76855665..eb6de77c 100644\n--- a\/tools\/tiffcrop.c\n+++ b\/tools\/tiffcrop.c\n@@ -3628,7 +3628,7 @@ static int readContigStripsIntoBuffer (TIFF* in, uint8* buf)\n {\n         uint8* bufp = buf;\n         int32  bytes_read = 0;\n-        uint16 strip, nstrips   = TIFFNumberOfStrips(in);\n+        uint32 strip, nstrips   = TIFFNumberOfStrips(in);\n         uint32 stripsize = TIFFStripSize(in);\n         uint32 rows = 0;\n         uint32 rps = TIFFGetFieldDefaulted(in, TIFFTAG_ROWSPERSTRIP, &rps);\n@@ -4711,9 +4711,12 @@ static int readSeparateStripsIntoBuffer (TIFF *in, uint8 *obuf, uint32 length,\n                                          uint32 width, uint16 spp,\n                                          struct dump_opts *dump)\n   {\n-  int i, j, bytes_per_sample, bytes_per_pixel, shift_width, result = 1;\n+  int i, bytes_per_sample, bytes_per_pixel, shift_width, result = 1;\n+  uint32 j;\n   int32  bytes_read = 0;\n-  uint16 bps, nstrips, planar, strips_per_sample;\n+  uint16 bps, planar;\n+  uint32 nstrips;\n+  uint32 strips_per_sample;\n   uint32 src_rowsize, dst_rowsize, rows_processed, rps;\n   uint32 rows_this_strip = 0;\n   tsample_t s;\n","owner":"vadz","repo":"libtiff","source":"cve"},{"CVE_ID":"CVE-2017-16612","CWE_ID":"190","category":"security","commit_id":"5d201df72f3d4f4cb8b8f75f980169b03507da38","commit_message":"From 5d201df72f3d4f4cb8b8f75f980169b03507da38 Mon Sep 17 00:00:00 2001\nFrom: Tobias Stoeckmann <tobias@stoeckmann.org>\nDate: Tue, 28 Nov 2017 21:38:07 +0100\nSubject: cursor: Fix heap overflows when parsing malicious files.\n\nIt is possible to trigger heap overflows due to an integer overflow\nwhile parsing images.\n\nThe integer overflow occurs because the chosen limit 0x10000 for\ndimensions is too large for 32 bit systems, because each pixel takes\n4 bytes. Properly chosen values allow an overflow which in turn will\nlead to less allocated memory than needed for subsequent reads.\n\nSee also: https:\/\/cgit.freedesktop.org\/xorg\/lib\/libXcursor\/commit\/?id=4794b5dd34688158fb51a2943032569d3780c4b8\nFixes: https:\/\/bugs.freedesktop.org\/show_bug.cgi?id=103961\n\nSigned-off-by: Tobias Stoeckmann <tobias@stoeckmann.org>\n[Pekka: add link to the corresponding libXcursor commit]\nSigned-off-by: Pekka Paalanen <pekka.paalanen@collabora.co.uk>\n---\n cursor\/xcursor.c | 8 +++++++-\n 1 file changed, 7 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/cursor\/xcursor.c b\/cursor\/xcursor.c\nindex ca41c4a..689c702 100644\n--- a\/cursor\/xcursor.c\n+++ b\/cursor\/xcursor.c\n@@ -202,6 +202,11 @@ XcursorImageCreate (int width, int height)\n {\n     XcursorImage    *image;\n \n+    if (width < 0 || height < 0)\n+       return NULL;\n+    if (width > XCURSOR_IMAGE_MAX_SIZE || height > XCURSOR_IMAGE_MAX_SIZE)\n+       return NULL;\n+\n     image = malloc (sizeof (XcursorImage) +\n \t\t    width * height * sizeof (XcursorPixel));\n     if (!image)\n@@ -482,7 +487,8 @@ _XcursorReadImage (XcursorFile\t\t*file,\n     if (!_XcursorReadUInt (file, &head.delay))\n \treturn NULL;\n     \/* sanity check data *\/\n-    if (head.width >= 0x10000 || head.height > 0x10000)\n+    if (head.width > XCURSOR_IMAGE_MAX_SIZE  ||\n+\thead.height > XCURSOR_IMAGE_MAX_SIZE)\n \treturn NULL;\n     if (head.width == 0 || head.height == 0)\n \treturn NULL;\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-8794","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2018-20181","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2018-1000524","CWE_ID":"190","category":"security","commit_id":"252c1ca184cb38e1acb917aa0e451c5f08519996","commit_message":"From 252c1ca184cb38e1acb917aa0e451c5f08519996 Mon Sep 17 00:00:00 2001\nFrom: Xiaoyin Liu <xiaoyinl@users.noreply.github.com>\nDate: Tue, 12 Jun 2018 22:12:57 -0700\nSubject: [PATCH] Fix integer overflow in layer_resize in map_engine.c (#268)\n\n* Fix integer overflow in layer_resize in map_engine.c\n\nThere's a buffer overflow bug in the function layer_resize. It allocates\na buffer `tilemap` with size `x_size * y_size * sizeof(struct map_tile)`.\nBut it didn't check for integer overflow, so if x_size and y_size are\nvery large, it's possible that the buffer size is smaller than needed,\ncausing a buffer overflow later.\n\nPoC: `SetLayerSize(0, 0x7FFFFFFF, 0x7FFFFFFF);`\n\n* move malloc to a separate line\n---\n src\/minisphere\/map_engine.c | 5 ++++-\n 1 file changed, 4 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/src\/minisphere\/map_engine.c b\/src\/minisphere\/map_engine.c\nindex 0d47a326..cba8a612 100644\n--- a\/src\/minisphere\/map_engine.c\n+++ b\/src\/minisphere\/map_engine.c\n@@ -1036,6 +1036,7 @@ layer_resize(int layer, int x_size, int y_size)\n \tstruct map_tile*    tilemap;\n \tstruct map_trigger* trigger;\n \tstruct map_zone*    zone;\n+\tsize_t              tilemap_size;\n \n \tint x, y, i;\n \n@@ -1044,7 +1045,9 @@ layer_resize(int layer, int x_size, int y_size)\n \n \t\/\/ allocate a new tilemap and copy the old layer tiles into it.  we can't simply realloc\n \t\/\/ because the tilemap is a 2D array.\n-\tif (!(tilemap = malloc(x_size * y_size * sizeof(struct map_tile))))\n+\ttilemap_size = x_size * y_size * sizeof(struct map_tile);\n+\tif (x_size == 0 || tilemap_size \/ x_size \/ sizeof(struct map_tile) != y_size\n+\t\t|| !(tilemap = malloc(tilemap_size)))\n \t\treturn false;\n \tfor (x = 0; x < x_size; ++x) {\n \t\tfor (y = 0; y < y_size; ++y) {\n","owner":"fatcerberus","repo":"minisphere","source":"cve"},{"CVE_ID":"CVE-2018-19199","CWE_ID":"190","category":"security","commit_id":"f76275d4a91b28d687250525d3a0c5509bbd666f","commit_message":"From f76275d4a91b28d687250525d3a0c5509bbd666f Mon Sep 17 00:00:00 2001\nFrom: Sebastian Pipping <sebastian@pipping.org>\nDate: Sun, 23 Sep 2018 21:30:39 +0200\nSubject: [PATCH] UriQuery.c: Catch integer overflow in ComposeQuery and ...Ex\n\n---\n ChangeLog      |  2 ++\n src\/UriQuery.c | 14 ++++++++++++--\n 2 files changed, 14 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/ChangeLog b\/ChangeLog\nindex 7c32d86..fae1ede 100644\n--- a\/ChangeLog\n+++ b\/ChangeLog\n@@ -4,6 +4,8 @@\n       Thanks to Google Autofuzz team for the report!\n   * Fixed: Fix off-by-one in uriComposeQueryCharsRequired* and ...Ex*\n       Reported space requirements were 1 byte bigger than necessary\n+  * Fixed: Detect integer overflow in uriComposeQuery* and uriComposeQueryEx*\n+      Thanks to Google Autofuzz team for the report!\n   * TODO BUMP SONAME\n \n 2018-08-18 -- 0.8.6\ndiff --git a\/src\/UriQuery.c b\/src\/UriQuery.c\nindex 45acf5a..9165ec8 100644\n--- a\/src\/UriQuery.c\n+++ b\/src\/UriQuery.c\n@@ -68,6 +68,10 @@\n \n \n \n+#include <limits.h>\n+\n+\n+\n static int URI_FUNC(ComposeQueryEngine)(URI_CHAR * dest,\n \t\tconst URI_TYPE(QueryList) * queryList,\n \t\tint maxChars, int * charsWritten, int * charsRequired,\n@@ -201,9 +205,15 @@ int URI_FUNC(ComposeQueryEngine)(URI_CHAR * dest,\n \t\tconst URI_CHAR * const value = queryList->value;\n \t\tconst int worstCase = (normalizeBreaks == URI_TRUE ? 6 : 3);\n \t\tconst int keyLen = (key == NULL) ? 0 : (int)URI_STRLEN(key);\n-\t\tconst int keyRequiredChars = worstCase * keyLen;\n+\t\tint keyRequiredChars;\n \t\tconst int valueLen = (value == NULL) ? 0 : (int)URI_STRLEN(value);\n-\t\tconst int valueRequiredChars = worstCase * valueLen;\n+\t\tint valueRequiredChars;\n+\n+\t\tif ((keyLen >= INT_MAX \/ worstCase) || (valueLen >= INT_MAX \/ worstCase)) {\n+\t\t\treturn URI_ERROR_OUTPUT_TOO_LARGE;\n+\t\t}\n+\t\tkeyRequiredChars = worstCase * keyLen;\n+\t\tvalueRequiredChars = worstCase * valueLen;\n \n \t\tif (dest == NULL) {\n \t\t\t(*charsRequired) += ampersandLen + keyRequiredChars + ((value == NULL)\n","owner":"uriparser","repo":"uriparser","source":"cve"},{"CVE_ID":"CVE-2017-6952","CWE_ID":"190","category":"security","commit_id":"6fe86eef621b9849f51a5e1e5d73258a93440403","commit_message":"From 6fe86eef621b9849f51a5e1e5d73258a93440403 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Quang=20Nguy=E1=BB=85n?=\n <quangnh89@users.noreply.github.com>\nDate: Mon, 13 Mar 2017 22:34:48 +0700\nSubject: [PATCH] provide a validity check to prevent against Integer overflow\n conditions (#870)\n\n* provide a validity check to prevent against Integer overflow conditions\n\n* fix some style issues.\n---\n windows\/winkernel_mm.c | 13 +++++++++++--\n 1 file changed, 11 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/windows\/winkernel_mm.c b\/windows\/winkernel_mm.c\nindex c127da3ac..ecdc1ca2d 100644\n--- a\/windows\/winkernel_mm.c\n+++ b\/windows\/winkernel_mm.c\n@@ -3,6 +3,7 @@\n \n #include \"winkernel_mm.h\"\n #include <ntddk.h>\n+#include <Ntintsafe.h>\n \n \/\/ A pool tag for memory allocation\n static const ULONG CS_WINKERNEL_POOL_TAG = 'kwsC';\n@@ -33,8 +34,16 @@ void * CAPSTONE_API cs_winkernel_malloc(size_t size)\n \n \t\/\/ FP; a use of NonPagedPool is required for Windows 7 support\n #pragma prefast(suppress : 30030)\t\t\/\/ Allocating executable POOL_TYPE memory\n-\tCS_WINKERNEL_MEMBLOCK *block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(\n-\t\t\tNonPagedPool, size + sizeof(CS_WINKERNEL_MEMBLOCK), CS_WINKERNEL_POOL_TAG);\n+\tsize_t number_of_bytes = 0;\n+\tCS_WINKERNEL_MEMBLOCK *block = NULL;\n+\t\/\/ A specially crafted size value can trigger the overflow.\n+\t\/\/ If the sum in a value that overflows or underflows the capacity of the type,\n+\t\/\/ the function returns NULL.\n+\tif (!NT_SUCCESS(RtlSizeTAdd(size, sizeof(CS_WINKERNEL_MEMBLOCK), &number_of_bytes))) {\n+\t\treturn NULL;\n+\t}\n+\tblock = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(\n+\t\t\tNonPagedPool, number_of_bytes, CS_WINKERNEL_POOL_TAG);\n \tif (!block) {\n \t\treturn NULL;\n \t}\n","owner":"aquynh","repo":"capstone","source":"cve"},{"CVE_ID":"CVE-2017-1000470","CWE_ID":"190","category":"security","commit_id":"adeb4abc6c998c19524e09fde20c02b4a26765a3","commit_message":"From adeb4abc6c998c19524e09fde20c02b4a26765a3 Mon Sep 17 00:00:00 2001\nFrom: \"K. Reid Wightman\" <wightman@digitalbond.com>\nDate: Wed, 18 Oct 2017 09:19:20 -0400\nSubject: [PATCH] Add integer overflow check for content-length\n\n---\n src\/http.c | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/src\/http.c b\/src\/http.c\nindex 8920e45a..e59a9064 100644\n--- a\/src\/http.c\n+++ b\/src\/http.c\n@@ -1090,12 +1090,12 @@ static void parseHeaders(Webs *wp)\n         } else if (strcmp(key, \"content-length\") == 0) {\n             wp->rxLen = atoi(value);\n             if (smatch(wp->method, \"PUT\")) {\n-                if (wp->rxLen > ME_GOAHEAD_LIMIT_PUT) {\n+                if (wp->rxLen > ME_GOAHEAD_LIMIT_PUT || wp->rxLen < 0) {\n                     websError(wp, HTTP_CODE_REQUEST_TOO_LARGE | WEBS_CLOSE, \"Too big\");\n                     return;\n                 }\n             } else {\n-                if (wp->rxLen > ME_GOAHEAD_LIMIT_POST) {\n+                if (wp->rxLen > ME_GOAHEAD_LIMIT_POST || wp->rxLen < 0) {\n                     websError(wp, HTTP_CODE_REQUEST_TOO_LARGE | WEBS_CLOSE, \"Too big\");\n                     return;\n                 }\n","owner":"embedthis","repo":"goahead","source":"cve"},{"CVE_ID":"CVE-2016-10249","CWE_ID":"190","category":"security","commit_id":"988f8365f7d8ad8073b6786e433d34c553ecf568","commit_message":"From 988f8365f7d8ad8073b6786e433d34c553ecf568 Mon Sep 17 00:00:00 2001\nFrom: Michael Adams <mdadams@ece.uvic.ca>\nDate: Sat, 22 Oct 2016 14:36:49 -0700\nSubject: [PATCH] Fixed an integer overflow problem.\n\n---\n src\/libjasper\/base\/jas_malloc.c |  4 ++--\n src\/libjasper\/base\/jas_seq.c    | 27 ++++++++++++++++++++-------\n 2 files changed, 22 insertions(+), 9 deletions(-)\n\n","diff_code":"diff --git a\/src\/libjasper\/base\/jas_malloc.c b\/src\/libjasper\/base\/jas_malloc.c\nindex 23154e3..b4b868f 100644\n--- a\/src\/libjasper\/base\/jas_malloc.c\n+++ b\/src\/libjasper\/base\/jas_malloc.c\n@@ -238,7 +238,7 @@ void jas_free(void *ptr)\n void *jas_malloc(size_t size)\n {\n \tvoid *result;\n-\tJAS_DBGLOG(101, (\"jas_malloc called with %zu\\n\", size));\n+\tJAS_DBGLOG(101, (\"jas_malloc(%zu)\\n\", size));\n \tresult = malloc(size);\n \tJAS_DBGLOG(100, (\"jas_malloc(%zu) -> %p\\n\", size, result));\n \treturn result;\n@@ -247,7 +247,7 @@ void *jas_malloc(size_t size)\n void *jas_realloc(void *ptr, size_t size)\n {\n \tvoid *result;\n-\tJAS_DBGLOG(101, (\"jas_realloc called with %x,%zu\\n\", ptr, size));\n+\tJAS_DBGLOG(101, (\"jas_realloc(%x, %zu)\\n\", ptr, size));\n \tresult = realloc(ptr, size);\n \tJAS_DBGLOG(100, (\"jas_realloc(%p, %zu) -> %p\\n\", ptr, size, result));\n \treturn result;\ndiff --git a\/src\/libjasper\/base\/jas_seq.c b\/src\/libjasper\/base\/jas_seq.c\nindex cac20e2..adc7e13 100644\n--- a\/src\/libjasper\/base\/jas_seq.c\n+++ b\/src\/libjasper\/base\/jas_seq.c\n@@ -101,13 +101,16 @@ jas_matrix_t *jas_matrix_create(int numrows, int numcols)\n {\n \tjas_matrix_t *matrix;\n \tint i;\n+\tsize_t size;\n+\n+\tmatrix = 0;\n \n \tif (numrows < 0 || numcols < 0) {\n-\t\treturn 0;\n+\t\tgoto error;\n \t}\n \n \tif (!(matrix = jas_malloc(sizeof(jas_matrix_t)))) {\n-\t\treturn 0;\n+\t\tgoto error;\n \t}\n \tmatrix->flags_ = 0;\n \tmatrix->numrows_ = numrows;\n@@ -115,21 +118,25 @@ jas_matrix_t *jas_matrix_create(int numrows, int numcols)\n \tmatrix->rows_ = 0;\n \tmatrix->maxrows_ = numrows;\n \tmatrix->data_ = 0;\n-\tmatrix->datasize_ = numrows * numcols;\n+\tmatrix->datasize_ = 0;\n+\n+\t\/\/ matrix->datasize_ = numrows * numcols;\n+\tif (!jas_safe_size_mul(numrows, numcols, &size)) {\n+\t\tgoto error;\n+\t}\n+\tmatrix->datasize_ = size;\n \n \tif (matrix->maxrows_ > 0) {\n \t\tif (!(matrix->rows_ = jas_alloc2(matrix->maxrows_,\n \t\t  sizeof(jas_seqent_t *)))) {\n-\t\t\tjas_matrix_destroy(matrix);\n-\t\t\treturn 0;\n+\t\t\tgoto error;\n \t\t}\n \t}\n \n \tif (matrix->datasize_ > 0) {\n \t\tif (!(matrix->data_ = jas_alloc2(matrix->datasize_,\n \t\t  sizeof(jas_seqent_t)))) {\n-\t\t\tjas_matrix_destroy(matrix);\n-\t\t\treturn 0;\n+\t\t\tgoto error;\n \t\t}\n \t}\n \n@@ -147,6 +154,12 @@ jas_matrix_t *jas_matrix_create(int numrows, int numcols)\n \tmatrix->yend_ = matrix->numrows_;\n \n \treturn matrix;\n+\n+error:\n+\tif (matrix) {\n+\t\tjas_matrix_destroy(matrix);\n+\t}\n+\treturn 0;\n }\n \n void jas_matrix_destroy(jas_matrix_t *matrix)\n","owner":"mdadams","repo":"jasper","source":"cve"},{"CVE_ID":"CVE-2015-2310","CWE_ID":"190","category":"security","commit_id":"f343f0dbd0a2e87f17cd74f14186ed73e3fbdbfa","commit_message":"From f343f0dbd0a2e87f17cd74f14186ed73e3fbdbfa Mon Sep 17 00:00:00 2001\nFrom: Kenton Varda <kenton@sandstorm.io>\nDate: Wed, 25 Feb 2015 13:50:43 -0800\nSubject: [PATCH] SECURITY: Integer overflow in pointer validation.\n\nDetails: https:\/\/github.com\/sandstorm-io\/capnproto\/tree\/master\/security-advisories\/2014-03-02-0-c++-integer-overflow.md\n---\n c++\/src\/capnp\/layout.c++ | 7 ++++---\n 1 file changed, 4 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/c++\/src\/capnp\/layout.c++ b\/c++\/src\/capnp\/layout.c++\nindex 325ca403d..a43dbcd6b 100644\n--- a\/c++\/src\/capnp\/layout.c++\n+++ b\/c++\/src\/capnp\/layout.c++\n@@ -685,7 +685,8 @@ struct WireHelpers {\n               return result;\n             }\n \n-            KJ_REQUIRE(elementTag->structRef.wordSize() \/ ELEMENTS * count <= wordCount,\n+            KJ_REQUIRE(elementTag->structRef.wordSize() \/ ELEMENTS *\n+                       ElementCount64(count) <= wordCount,\n                        \"Struct list pointer's elements overran size.\") {\n               return result;\n             }\n@@ -1663,7 +1664,7 @@ struct WireHelpers {\n           ElementCount elementCount = tag->inlineCompositeListElementCount();\n           auto wordsPerElement = tag->structRef.wordSize() \/ ELEMENTS;\n \n-          KJ_REQUIRE(wordsPerElement * elementCount <= wordCount,\n+          KJ_REQUIRE(wordsPerElement * ElementCount64(elementCount) <= wordCount,\n                      \"INLINE_COMPOSITE list's elements overrun its word count.\") {\n             goto useDefault;\n           }\n@@ -1919,7 +1920,7 @@ struct WireHelpers {\n       size = tag->inlineCompositeListElementCount();\n       wordsPerElement = tag->structRef.wordSize() \/ ELEMENTS;\n \n-      KJ_REQUIRE(size * wordsPerElement <= wordCount,\n+      KJ_REQUIRE(ElementCount64(size) * wordsPerElement <= wordCount,\n                  \"INLINE_COMPOSITE list's elements overrun its word count.\") {\n         goto useDefault;\n       }\n","owner":"capnproto","repo":"capnproto","source":"cve"},{"CVE_ID":"CVE-2016-9084","CWE_ID":"190","category":"security","commit_id":"05692d7005a364add85c6e25a6c4447ce08f913a","commit_message":"From 05692d7005a364add85c6e25a6c4447ce08f913a Mon Sep 17 00:00:00 2001\nFrom: Vlad Tsyrklevich <vlad@tsyrklevich.net>\nDate: Wed, 12 Oct 2016 18:51:24 +0200\nSubject: [PATCH] vfio\/pci: Fix integer overflows, bitmask check\n\nThe VFIO_DEVICE_SET_IRQS ioctl did not sufficiently sanitize\nuser-supplied integers, potentially allowing memory corruption. This\npatch adds appropriate integer overflow checks, checks the range bounds\nfor VFIO_IRQ_SET_DATA_NONE, and also verifies that only single element\nin the VFIO_IRQ_SET_DATA_TYPE_MASK bitmask is set.\nVFIO_IRQ_SET_ACTION_TYPE_MASK is already correctly checked later in\nvfio_pci_set_irqs_ioctl().\n\nFurthermore, a kzalloc is changed to a kcalloc because the use of a\nkzalloc with an integer multiplication allowed an integer overflow\ncondition to be reached without this patch. kcalloc checks for overflow\nand should prevent a similar occurrence.\n\nSigned-off-by: Vlad Tsyrklevich <vlad@tsyrklevich.net>\nSigned-off-by: Alex Williamson <alex.williamson@redhat.com>\n---\n drivers\/vfio\/pci\/vfio_pci.c       | 33 ++++++++++++++++++++-----------\n drivers\/vfio\/pci\/vfio_pci_intrs.c |  2 +-\n 2 files changed, 22 insertions(+), 13 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/vfio\/pci\/vfio_pci.c b\/drivers\/vfio\/pci\/vfio_pci.c\nindex d624a527777f6..031bc08d000d4 100644\n--- a\/drivers\/vfio\/pci\/vfio_pci.c\n+++ b\/drivers\/vfio\/pci\/vfio_pci.c\n@@ -829,8 +829,9 @@ static long vfio_pci_ioctl(void *device_data,\n \n \t} else if (cmd == VFIO_DEVICE_SET_IRQS) {\n \t\tstruct vfio_irq_set hdr;\n+\t\tsize_t size;\n \t\tu8 *data = NULL;\n-\t\tint ret = 0;\n+\t\tint max, ret = 0;\n \n \t\tminsz = offsetofend(struct vfio_irq_set, count);\n \n@@ -838,23 +839,31 @@ static long vfio_pci_ioctl(void *device_data,\n \t\t\treturn -EFAULT;\n \n \t\tif (hdr.argsz < minsz || hdr.index >= VFIO_PCI_NUM_IRQS ||\n+\t\t    hdr.count >= (U32_MAX - hdr.start) ||\n \t\t    hdr.flags & ~(VFIO_IRQ_SET_DATA_TYPE_MASK |\n \t\t\t\t  VFIO_IRQ_SET_ACTION_TYPE_MASK))\n \t\t\treturn -EINVAL;\n \n-\t\tif (!(hdr.flags & VFIO_IRQ_SET_DATA_NONE)) {\n-\t\t\tsize_t size;\n-\t\t\tint max = vfio_pci_get_irq_count(vdev, hdr.index);\n+\t\tmax = vfio_pci_get_irq_count(vdev, hdr.index);\n+\t\tif (hdr.start >= max || hdr.start + hdr.count > max)\n+\t\t\treturn -EINVAL;\n \n-\t\t\tif (hdr.flags & VFIO_IRQ_SET_DATA_BOOL)\n-\t\t\t\tsize = sizeof(uint8_t);\n-\t\t\telse if (hdr.flags & VFIO_IRQ_SET_DATA_EVENTFD)\n-\t\t\t\tsize = sizeof(int32_t);\n-\t\t\telse\n-\t\t\t\treturn -EINVAL;\n+\t\tswitch (hdr.flags & VFIO_IRQ_SET_DATA_TYPE_MASK) {\n+\t\tcase VFIO_IRQ_SET_DATA_NONE:\n+\t\t\tsize = 0;\n+\t\t\tbreak;\n+\t\tcase VFIO_IRQ_SET_DATA_BOOL:\n+\t\t\tsize = sizeof(uint8_t);\n+\t\t\tbreak;\n+\t\tcase VFIO_IRQ_SET_DATA_EVENTFD:\n+\t\t\tsize = sizeof(int32_t);\n+\t\t\tbreak;\n+\t\tdefault:\n+\t\t\treturn -EINVAL;\n+\t\t}\n \n-\t\t\tif (hdr.argsz - minsz < hdr.count * size ||\n-\t\t\t    hdr.start >= max || hdr.start + hdr.count > max)\n+\t\tif (size) {\n+\t\t\tif (hdr.argsz - minsz < hdr.count * size)\n \t\t\t\treturn -EINVAL;\n \n \t\t\tdata = memdup_user((void __user *)(arg + minsz),\ndiff --git a\/drivers\/vfio\/pci\/vfio_pci_intrs.c b\/drivers\/vfio\/pci\/vfio_pci_intrs.c\nindex c2e60893cd09a..1c46045b0e7fc 100644\n--- a\/drivers\/vfio\/pci\/vfio_pci_intrs.c\n+++ b\/drivers\/vfio\/pci\/vfio_pci_intrs.c\n@@ -256,7 +256,7 @@ static int vfio_msi_enable(struct vfio_pci_device *vdev, int nvec, bool msix)\n \tif (!is_irq_none(vdev))\n \t\treturn -EINVAL;\n \n-\tvdev->ctx = kzalloc(nvec * sizeof(struct vfio_pci_irq_ctx), GFP_KERNEL);\n+\tvdev->ctx = kcalloc(nvec, sizeof(struct vfio_pci_irq_ctx), GFP_KERNEL);\n \tif (!vdev->ctx)\n \t\treturn -ENOMEM;\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-7944","CWE_ID":"190","category":"security","commit_id":"61c1039ee23a2d1de712843bed3480654d7ef42e","commit_message":"From 61c1039ee23a2d1de712843bed3480654d7ef42e Mon Sep 17 00:00:00 2001\nFrom: Tobias Stoeckmann <tobias@stoeckmann.org>\nDate: Sun, 25 Sep 2016 22:38:44 +0200\nSubject: Integer overflow on illegal server response\n\nThe 32 bit field \"rep.length\" is not checked for validity, which allows\nan integer overflow on 32 bit systems.\n\nA malicious server could send INT_MAX as length, which gets multiplied\nby the size of XRectangle. In that case the client won't read the whole\ndata from server, getting out of sync.\n\nSigned-off-by: Tobias Stoeckmann <tobias@stoeckmann.org>\nReviewed-by: Matthieu Herrb <matthieu@herrb.eu>\n---\n src\/Region.c | 15 ++++++++++++---\n 1 file changed, 12 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/src\/Region.c b\/src\/Region.c\nindex cb0cf6e..59bcc1a 100644\n--- a\/src\/Region.c\n+++ b\/src\/Region.c\n@@ -23,6 +23,7 @@\n #ifdef HAVE_CONFIG_H\n #include <config.h>\n #endif\n+#include <limits.h>\n #include \"Xfixesint.h\"\n \n XserverRegion\n@@ -333,9 +334,17 @@ XFixesFetchRegionAndBounds (Display\t    *dpy,\n     bounds->y = rep.y;\n     bounds->width = rep.width;\n     bounds->height = rep.height;\n-    nbytes = (long) rep.length << 2;\n-    nrects = rep.length >> 1;\n-    rects = Xmalloc (nrects * sizeof (XRectangle));\n+\n+    if (rep.length < (INT_MAX >> 2)) {\n+\tnbytes = (long) rep.length << 2;\n+\tnrects = rep.length >> 1;\n+\trects = Xmalloc (nrects * sizeof (XRectangle));\n+    } else {\n+\tnbytes = 0;\n+\tnrects = 0;\n+\trects = NULL;\n+    }\n+\n     if (!rects)\n     {\n \t_XEatDataWords(dpy, rep.length);\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-7568","CWE_ID":"190","category":"security","commit_id":"46df0642618eabc5b5b7df490d1ae23bda00a745","commit_message":"From 46df0642618eabc5b5b7df490d1ae23bda00a745 Mon Sep 17 00:00:00 2001\nFrom: \"Christoph M. Becker\" <cmbecker69@gmx.de>\nDate: Fri, 16 Sep 2016 11:31:21 +0200\nSubject: [PATCH] Fix #73003: Integer Overflow in gdImageWebpCtx of gd_webp.c\n\nWe add the missing integer overflow check to avoid potential buffer overflows.\n---\n NEWS                   | 2 ++\n ext\/gd\/libgd\/gd_webp.c | 9 +++++++++\n 2 files changed, 11 insertions(+)\n\n","diff_code":"diff --git a\/NEWS b\/NEWS\nindex 63a6800ba76d..ef6cb570abc4 100644\n--- a\/NEWS\n+++ b\/NEWS\n@@ -22,6 +22,8 @@ PHP                                                                        NEWS\n     (cmb)\n   . Fixed bug #50194 (imagettftext broken on transparent background w\/o\n     alphablending). (cmb)\n+  . Fixed bug #73003 (Integer Overflow in gdImageWebpCtx of gd_webp.c). (trylab,\n+    cmb)\n \n - Mbstring:\n   . Fixed bug #72994 (mbc_to_code() out of bounds read). (Laruence, cmb)\ndiff --git a\/ext\/gd\/libgd\/gd_webp.c b\/ext\/gd\/libgd\/gd_webp.c\nindex bf9ac9dd0e1a..985187edc260 100644\n--- a\/ext\/gd\/libgd\/gd_webp.c\n+++ b\/ext\/gd\/libgd\/gd_webp.c\n@@ -180,6 +180,15 @@ void gdImageWebpCtx (gdImagePtr im, gdIOCtx * outfile, int quantization)\n \t\/* Conversion to Y,U,V buffer *\/\n     yuv_width = (width + 1) >> 1;\n     yuv_height = (height + 1) >> 1;\n+\n+\tif (overflow2(width, height)) {\n+\t\treturn;\n+\t}\n+\t\/* simplification possible, because WebP must not be larger than 16384**2 *\/\n+\tif (overflow2(width * height, 2 * sizeof(unsigned char))) {\n+\t\treturn;\n+\t}\n+\n     yuv_nbytes = width * height + 2 * yuv_width * yuv_height;\n \n     if ((Y = (unsigned char *)gdCalloc(yuv_nbytes, sizeof(unsigned char))) == NULL) {\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2016-6823","CWE_ID":"190","category":"security","commit_id":"4cc6ec8a4197d4c008577127736bf7985d632323","commit_message":"From 4cc6ec8a4197d4c008577127736bf7985d632323 Mon Sep 17 00:00:00 2001\nFrom: Cristy <urban-warrior@imagemagick.org>\nDate: Mon, 15 Aug 2016 15:54:42 -0400\nSubject: [PATCH] Prevent buffer overflow in BMP coder (bug report from pwchen\n of tencent).\n\n---\n ChangeLog    | 3 +++\n coders\/bmp.c | 5 ++++-\n 2 files changed, 7 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/ChangeLog b\/ChangeLog\nindex 7c9cad2e50..14b82002dc 100644\n--- a\/ChangeLog\n+++ b\/ChangeLog\n@@ -1,3 +1,6 @@\n+2016-08-15  7.0.2-10 Cristy  <quetzlzacatenango@image...>\n+  * Prevent buffer overflow in BMP coder (bug report from pwchen of tencent).\n+\n 2016-08-14  7.0.2-9 Cristy  <quetzlzacatenango@image...>\n   * Release ImageMagick version 7.0.2-9, GIT revision 18707:2c02f09:20160814.\n \ndiff --git a\/coders\/bmp.c b\/coders\/bmp.c\nindex 85741e173a..47aeae964c 100644\n--- a\/coders\/bmp.c\n+++ b\/coders\/bmp.c\n@@ -1682,10 +1682,13 @@ static MagickBooleanType WriteBMPImage(const ImageInfo *image_info,Image *image,\n           bmp_info.file_size+=extra_size;\n           bmp_info.offset_bits+=extra_size;\n         }\n+    if ((image->columns != (signed int) image->columns) ||\n+        (image->rows != (signed int) image->rows))\n+      ThrowWriterException(ImageError,\"WidthOrHeightExceedsLimit\");\n     bmp_info.width=(ssize_t) image->columns;\n     bmp_info.height=(ssize_t) image->rows;\n     bmp_info.planes=1;\n-    bmp_info.image_size=(unsigned int) (bytes_per_line*image->rows);\n+    bmp_info.image_size=(unsigned long) (bytes_per_line*image->rows);\n     bmp_info.file_size+=bmp_info.image_size;\n     bmp_info.x_pixels=75*39;\n     bmp_info.y_pixels=75*39;\n","owner":"ImageMagick","repo":"ImageMagick","source":"cve"},{"CVE_ID":"CVE-2018-6927","CWE_ID":"190","category":"security","commit_id":"fbe0e839d1e22d88810f3ee3e2f1479be4c0aa4a","commit_message":"From fbe0e839d1e22d88810f3ee3e2f1479be4c0aa4a Mon Sep 17 00:00:00 2001\nFrom: Li Jinyue <lijinyue@huawei.com>\nDate: Thu, 14 Dec 2017 17:04:54 +0800\nSubject: [PATCH] futex: Prevent overflow by strengthen input validation\n\nUBSAN reports signed integer overflow in kernel\/futex.c:\n\n UBSAN: Undefined behaviour in kernel\/futex.c:2041:18\n signed integer overflow:\n 0 - -2147483648 cannot be represented in type 'int'\n\nAdd a sanity check to catch negative values of nr_wake and nr_requeue.\n\nSigned-off-by: Li Jinyue <lijinyue@huawei.com>\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\nCc: peterz@infradead.org\nCc: dvhart@infradead.org\nCc: stable@vger.kernel.org\nLink: https:\/\/lkml.kernel.org\/r\/1513242294-31786-1-git-send-email-lijinyue@huawei.com\n---\n kernel\/futex.c | 3 +++\n 1 file changed, 3 insertions(+)\n\n","diff_code":"diff --git a\/kernel\/futex.c b\/kernel\/futex.c\nindex 9e69589b92484..8c5424dd59244 100644\n--- a\/kernel\/futex.c\n+++ b\/kernel\/futex.c\n@@ -1878,6 +1878,9 @@ static int futex_requeue(u32 __user *uaddr1, unsigned int flags,\n \tstruct futex_q *this, *next;\n \tDEFINE_WAKE_Q(wake_q);\n \n+\tif (nr_wake < 0 || nr_requeue < 0)\n+\t\treturn -EINVAL;\n+\n \t\/*\n \t * When PI not supported: return -ENOSYS if requeue_pi is true,\n \t * consequently the compiler knows requeue_pi is always false past\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2014-0143","CWE_ID":"190","category":"security","commit_id":"e3737b820b45e54b059656dc3f914f895ac7a88b","commit_message":"From e3737b820b45e54b059656dc3f914f895ac7a88b Mon Sep 17 00:00:00 2001\nFrom: Kevin Wolf <kwolf@redhat.com>\nDate: Wed, 26 Mar 2014 13:05:33 +0100\nSubject: [PATCH] bochs: Check catalog_size header field (CVE-2014-0143)\n\nIt should neither become negative nor allow unbounded memory\nallocations. This fixes aborts in g_malloc() and an s->catalog_bitmap\nbuffer overflow on big endian hosts.\n\nSigned-off-by: Kevin Wolf <kwolf@redhat.com>\nReviewed-by: Stefan Hajnoczi <stefanha@redhat.com>\nReviewed-by: Max Reitz <mreitz@redhat.com>\nSigned-off-by: Stefan Hajnoczi <stefanha@redhat.com>\n---\n block\/bochs.c              | 13 +++++++++++++\n tests\/qemu-iotests\/078     | 13 +++++++++++++\n tests\/qemu-iotests\/078.out | 10 +++++++++-\n 3 files changed, 35 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/block\/bochs.c b\/block\/bochs.c\nindex e923eed..0ffa9c1 100644\n--- a\/block\/bochs.c\n+++ b\/block\/bochs.c\n@@ -123,7 +123,14 @@ static int bochs_open(BlockDriverState *bs, QDict *options, int flags,\n         bs->total_sectors = le64_to_cpu(bochs.extra.redolog.disk) \/ 512;\n     }\n \n+    \/* Limit to 1M entries to avoid unbounded allocation. This is what is\n+     * needed for the largest image that bximage can create (~8 TB). *\/\n     s->catalog_size = le32_to_cpu(bochs.catalog);\n+    if (s->catalog_size > 0x100000) {\n+        error_setg(errp, \"Catalog size is too large\");\n+        return -EFBIG;\n+    }\n+\n     s->catalog_bitmap = g_malloc(s->catalog_size * 4);\n \n     ret = bdrv_pread(bs->file, le32_to_cpu(bochs.header), s->catalog_bitmap,\n@@ -142,6 +149,12 @@ static int bochs_open(BlockDriverState *bs, QDict *options, int flags,\n \n     s->extent_size = le32_to_cpu(bochs.extent);\n \n+    if (s->catalog_size < bs->total_sectors \/ s->extent_size) {\n+        error_setg(errp, \"Catalog size is too small for this disk size\");\n+        ret = -EINVAL;\n+        goto fail;\n+    }\n+\n     qemu_co_mutex_init(&s->lock);\n     return 0;\n \ndiff --git a\/tests\/qemu-iotests\/078 b\/tests\/qemu-iotests\/078\nindex 73b573a..902ef0f 100755\n--- a\/tests\/qemu-iotests\/078\n+++ b\/tests\/qemu-iotests\/078\n@@ -43,6 +43,7 @@ _supported_proto generic\n _supported_os Linux\n \n catalog_size_offset=$((0x48))\n+disk_size_offset=$((0x58))\n \n echo\n echo \"== Read from a valid image ==\"\n@@ -55,6 +56,18 @@ _use_sample_img empty.bochs.bz2\n poke_file \"$TEST_IMG\" \"$catalog_size_offset\" \"\\xff\\xff\\xff\\xff\"\n { $QEMU_IO -c \"read 0 512\" $TEST_IMG; } 2>&1 | _filter_qemu_io | _filter_testdir\n \n+echo\n+echo \"== Overflow for catalog size * sizeof(uint32_t) ==\"\n+_use_sample_img empty.bochs.bz2\n+poke_file \"$TEST_IMG\" \"$catalog_size_offset\" \"\\x00\\x00\\x00\\x40\"\n+{ $QEMU_IO -c \"read 0 512\" $TEST_IMG; } 2>&1 | _filter_qemu_io | _filter_testdir\n+\n+echo\n+echo \"== Too small catalog bitmap for image size ==\"\n+_use_sample_img empty.bochs.bz2\n+poke_file \"$TEST_IMG\" \"$disk_size_offset\" \"\\x00\\xc0\\x0f\\x00\\x00\\x00\\x00\\x7f\"\n+{ $QEMU_IO -c \"read 2T 4k\" $TEST_IMG; } 2>&1 | _filter_qemu_io | _filter_testdir\n+\n # success, all done\n echo \"*** done\"\n rm -f $seq.full\ndiff --git a\/tests\/qemu-iotests\/078.out b\/tests\/qemu-iotests\/078.out\nindex ef8c42d..7254693 100644\n--- a\/tests\/qemu-iotests\/078.out\n+++ b\/tests\/qemu-iotests\/078.out\n@@ -5,6 +5,14 @@ read 512\/512 bytes at offset 0\n 512 bytes, X ops; XX:XX:XX.X (XXX YYY\/sec and XXX ops\/sec)\n \n == Negative catalog size ==\n-qemu-io: can't open device TEST_DIR\/empty.bochs: Could not open 'TEST_DIR\/empty.bochs': Interrupted system call\n+qemu-io: can't open device TEST_DIR\/empty.bochs: Catalog size is too large\n+no file open, try 'help open'\n+\n+== Overflow for catalog size * sizeof(uint32_t) ==\n+qemu-io: can't open device TEST_DIR\/empty.bochs: Catalog size is too large\n+no file open, try 'help open'\n+\n+== Too small catalog bitmap for image size ==\n+qemu-io: can't open device TEST_DIR\/empty.bochs: Catalog size is too small for this disk size\n no file open, try 'help open'\n *** done\n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-6872","CWE_ID":"190","category":"security","commit_id":"2c9a8fcc73a151608634d3e712973d192027c271","commit_message":"From 2c9a8fcc73a151608634d3e712973d192027c271 Mon Sep 17 00:00:00 2001\nFrom: \"mwilliams@fb.com\" <mwilliams@fb.com>\nDate: Mon, 1 Aug 2016 15:13:08 -0700\nSubject: [PATCH] Fix integer overflow in StringUtil::implode\n\nReviewed By: ricklavoie\n\nDifferential Revision: D3623922\n\nfbshipit-source-id: 136d124a850c07cc6c63535afc11d36499d576fc\n---\n hphp\/runtime\/base\/string-util.cpp                         | 4 ++--\n hphp\/test\/slow\/string_length_overflow\/implode.php         | 5 +++++\n hphp\/test\/slow\/string_length_overflow\/implode.php.expectf | 2 ++\n 3 files changed, 9 insertions(+), 2 deletions(-)\n create mode 100644 hphp\/test\/slow\/string_length_overflow\/implode.php\n create mode 100644 hphp\/test\/slow\/string_length_overflow\/implode.php.expectf\n\n","diff_code":"diff --git a\/hphp\/runtime\/base\/string-util.cpp b\/hphp\/runtime\/base\/string-util.cpp\nindex 56d7104c14f..51408ef85a6 100644\n--- a\/hphp\/runtime\/base\/string-util.cpp\n+++ b\/hphp\/runtime\/base\/string-util.cpp\n@@ -124,8 +124,8 @@ String StringUtil::Implode(const Variant& items, const String& delim,\n \n   req::vector<String> sitems;\n   sitems.reserve(size);\n-  int len = 0;\n-  int lenDelim = delim.size();\n+  size_t len = 0;\n+  size_t lenDelim = delim.size();\n   for (ArrayIter iter(items); iter; ++iter) {\n     sitems.emplace_back(iter.second().toString());\n     len += sitems.back().size() + lenDelim;\ndiff --git a\/hphp\/test\/slow\/string_length_overflow\/implode.php b\/hphp\/test\/slow\/string_length_overflow\/implode.php\nnew file mode 100644\nindex 00000000000..3d348321ac4\n--- \/dev\/null\n+++ b\/hphp\/test\/slow\/string_length_overflow\/implode.php\n@@ -0,0 +1,5 @@\n+<?php\n+\n+$stringLarge = str_repeat('*', 300289);\n+$arrayLarge = array_fill(0, 49981, '*');\n+$string_implode_2 = implode($stringLarge, $arrayLarge);\ndiff --git a\/hphp\/test\/slow\/string_length_overflow\/implode.php.expectf b\/hphp\/test\/slow\/string_length_overflow\/implode.php.expectf\nnew file mode 100644\nindex 00000000000..484c51265ce\n--- \/dev\/null\n+++ b\/hphp\/test\/slow\/string_length_overflow\/implode.php.expectf\n@@ -0,0 +1,2 @@\n+\n+Fatal error: String length exceeded 2^31-2: 15008494201 in %s\/test\/slow\/string_length_overflow\/implode.php on line 5\n","owner":"facebook","repo":"hhvm","source":"cve"},{"CVE_ID":"CVE-2017-6839","CWE_ID":"190","category":"security","commit_id":"beacc44eb8cdf6d58717ec1a5103c5141f1b37f9","commit_message":"From beacc44eb8cdf6d58717ec1a5103c5141f1b37f9 Mon Sep 17 00:00:00 2001\nFrom: Antonio Larrosa <larrosa@kde.org>\nDate: Mon, 6 Mar 2017 13:43:53 +0100\nSubject: [PATCH] Check for multiplication overflow in MSADPCM decodeSample\n\nCheck for multiplication overflow (using __builtin_mul_overflow\nif available) in MSADPCM.cpp decodeSample and return an empty\ndecoded block if an error occurs.\n\nThis fixes the 00193-audiofile-signintoverflow-MSADPCM case of #41\n---\n libaudiofile\/modules\/BlockCodec.cpp |  5 +--\n libaudiofile\/modules\/MSADPCM.cpp    | 47 ++++++++++++++++++++++++++---\n 2 files changed, 46 insertions(+), 6 deletions(-)\n\n","diff_code":"diff --git a\/libaudiofile\/modules\/BlockCodec.cpp b\/libaudiofile\/modules\/BlockCodec.cpp\nindex 45925e8..4731be1 100644\n--- a\/libaudiofile\/modules\/BlockCodec.cpp\n+++ b\/libaudiofile\/modules\/BlockCodec.cpp\n@@ -52,8 +52,9 @@ void BlockCodec::runPull()\n \t\/\/ Decompress into m_outChunk.\n \tfor (int i=0; i<blocksRead; i++)\n \t{\n-\t\tdecodeBlock(static_cast<const uint8_t *>(m_inChunk->buffer) + i * m_bytesPerPacket,\n-\t\t\tstatic_cast<int16_t *>(m_outChunk->buffer) + i * m_framesPerPacket * m_track->f.channelCount);\n+\t\tif (decodeBlock(static_cast<const uint8_t *>(m_inChunk->buffer) + i * m_bytesPerPacket,\n+\t\t\tstatic_cast<int16_t *>(m_outChunk->buffer) + i * m_framesPerPacket * m_track->f.channelCount)==0)\n+\t\t\tbreak;\n \n \t\tframesRead += m_framesPerPacket;\n \t}\ndiff --git a\/libaudiofile\/modules\/MSADPCM.cpp b\/libaudiofile\/modules\/MSADPCM.cpp\nindex 8ea3c85..ef9c38c 100644\n--- a\/libaudiofile\/modules\/MSADPCM.cpp\n+++ b\/libaudiofile\/modules\/MSADPCM.cpp\n@@ -101,24 +101,60 @@ static const int16_t adaptationTable[] =\n \t768, 614, 512, 409, 307, 230, 230, 230\n };\n \n+int firstBitSet(int x)\n+{\n+        int position=0;\n+        while (x!=0)\n+        {\n+                x>>=1;\n+                ++position;\n+        }\n+        return position;\n+}\n+\n+#ifndef __has_builtin\n+#define __has_builtin(x) 0\n+#endif\n+\n+int multiplyCheckOverflow(int a, int b, int *result)\n+{\n+#if (defined __GNUC__ && __GNUC__ >= 5) || ( __clang__ && __has_builtin(__builtin_mul_overflow))\n+\treturn __builtin_mul_overflow(a, b, result);\n+#else\n+\tif (firstBitSet(a)+firstBitSet(b)>31) \/\/ int is signed, so we can't use 32 bits\n+\t\treturn true;\n+\t*result = a * b;\n+\treturn false;\n+#endif\n+}\n+\n+\n \/\/ Compute a linear PCM value from the given differential coded value.\n static int16_t decodeSample(ms_adpcm_state &state,\n-\tuint8_t code, const int16_t *coefficient)\n+\tuint8_t code, const int16_t *coefficient, bool *ok=NULL)\n {\n \tint linearSample = (state.sample1 * coefficient[0] +\n \t\tstate.sample2 * coefficient[1]) >> 8;\n+\tint delta;\n \n \tlinearSample += ((code & 0x08) ? (code - 0x10) : code) * state.delta;\n \n \tlinearSample = clamp(linearSample, MIN_INT16, MAX_INT16);\n \n-\tint delta = (state.delta * adaptationTable[code]) >> 8;\n+\tif (multiplyCheckOverflow(state.delta, adaptationTable[code], &delta))\n+\t{\n+                if (ok) *ok=false;\n+\t\t_af_error(AF_BAD_COMPRESSION, \"Error decoding sample\");\n+\t\treturn 0;\n+\t}\n+\tdelta >>= 8;\n \tif (delta < 16)\n \t\tdelta = 16;\n \n \tstate.delta = delta;\n \tstate.sample2 = state.sample1;\n \tstate.sample1 = linearSample;\n+\tif (ok) *ok=true;\n \n \treturn static_cast<int16_t>(linearSample);\n }\n@@ -212,13 +248,16 @@ int MSADPCM::decodeBlock(const uint8_t *encoded, int16_t *decoded)\n \t{\n \t\tuint8_t code;\n \t\tint16_t newSample;\n+\t\tbool ok;\n \n \t\tcode = *encoded >> 4;\n-\t\tnewSample = decodeSample(*state[0], code, coefficient[0]);\n+\t\tnewSample = decodeSample(*state[0], code, coefficient[0], &ok);\n+\t\tif (!ok) return 0;\n \t\t*decoded++ = newSample;\n \n \t\tcode = *encoded & 0x0f;\n-\t\tnewSample = decodeSample(*state[1], code, coefficient[1]);\n+\t\tnewSample = decodeSample(*state[1], code, coefficient[1], &ok);\n+\t\tif (!ok) return 0;\n \t\t*decoded++ = newSample;\n \n \t\tencoded++;\n","owner":"antlarr","repo":"audiofile","source":"cve"},{"CVE_ID":"CVE-2017-18255","CWE_ID":"190","category":"security","commit_id":"1572e45a924f254d9570093abde46430c3172e3d","commit_message":"From 1572e45a924f254d9570093abde46430c3172e3d Mon Sep 17 00:00:00 2001\nFrom: Tan Xiaojun <tanxiaojun@huawei.com>\nDate: Thu, 23 Feb 2017 14:04:39 +0800\nSubject: [PATCH] perf\/core: Fix the perf_cpu_time_max_percent check\n\nUse \"proc_dointvec_minmax\" instead of \"proc_dointvec\" to check the input\nvalue from user-space.\n\nIf not, we can set a big value and some vars will overflow like\n\"sysctl_perf_event_sample_rate\" which will cause a lot of unexpected\nproblems.\n\nSigned-off-by: Tan Xiaojun <tanxiaojun@huawei.com>\nSigned-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>\nCc: <acme@kernel.org>\nCc: <alexander.shishkin@linux.intel.com>\nCc: Alexander Shishkin <alexander.shishkin@linux.intel.com>\nCc: Arnaldo Carvalho de Melo <acme@redhat.com>\nCc: Jiri Olsa <jolsa@redhat.com>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nCc: Peter Zijlstra <peterz@infradead.org>\nCc: Stephane Eranian <eranian@google.com>\nCc: Thomas Gleixner <tglx@linutronix.de>\nCc: Vince Weaver <vincent.weaver@maine.edu>\nLink: http:\/\/lkml.kernel.org\/r\/1487829879-56237-1-git-send-email-tanxiaojun@huawei.com\nSigned-off-by: Ingo Molnar <mingo@kernel.org>\n---\n kernel\/events\/core.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/kernel\/events\/core.c b\/kernel\/events\/core.c\nindex d4e3f8d8238b3..c1c1cdf0b8117 100644\n--- a\/kernel\/events\/core.c\n+++ b\/kernel\/events\/core.c\n@@ -455,7 +455,7 @@ int perf_cpu_time_max_percent_handler(struct ctl_table *table, int write,\n \t\t\t\tvoid __user *buffer, size_t *lenp,\n \t\t\t\tloff_t *ppos)\n {\n-\tint ret = proc_dointvec(table, write, buffer, lenp, ppos);\n+\tint ret = proc_dointvec_minmax(table, write, buffer, lenp, ppos);\n \n \tif (ret || !write)\n \t\treturn ret;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-3078","CWE_ID":"190","category":"security","commit_id":"3b8d4de300854b3517c7acb239b84f7726c1353c","commit_message":"From 3b8d4de300854b3517c7acb239b84f7726c1353c Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Tue, 19 Apr 2016 23:49:22 -0700\nSubject: [PATCH] Fix bug #71923 - integer overflow in ZipArchive::getFrom*\n\n---\n ext\/zip\/php_zip.c | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/ext\/zip\/php_zip.c b\/ext\/zip\/php_zip.c\nindex db201af6347f..7c9adf4af780 100644\n--- a\/ext\/zip\/php_zip.c\n+++ b\/ext\/zip\/php_zip.c\n@@ -1281,7 +1281,7 @@ static PHP_NAMED_FUNCTION(zif_zip_entry_read)\n \t}\n \n \tif (zr_rsrc->zf) {\n-\t\tbuffer = zend_string_alloc(len, 0);\n+\t\tbuffer = zend_string_safe_alloc(1, len, 0, 0);\n \t\tn = zip_fread(zr_rsrc->zf, ZSTR_VAL(buffer), ZSTR_LEN(buffer));\n \t\tif (n > 0) {\n \t\t\tZSTR_VAL(buffer)[n] = '\\0';\n@@ -2728,7 +2728,7 @@ static void php_zip_get_from(INTERNAL_FUNCTION_PARAMETERS, int type) \/* {{{ *\/\n \t\tRETURN_FALSE;\n \t}\n \n-\tbuffer = zend_string_alloc(len, 0);\n+\tbuffer = zend_string_safe_alloc(1, len, 0, 0);\n \tn = zip_fread(zf, ZSTR_VAL(buffer), ZSTR_LEN(buffer));\n \tif (n < 1) {\n \t\tzend_string_free(buffer);\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2018-8787","CWE_ID":"190","category":"security","commit_id":"09b9d4f1994a674c4ec85b4947aa656eda1aed8a","commit_message":"From 09b9d4f1994a674c4ec85b4947aa656eda1aed8a Mon Sep 17 00:00:00 2001\nFrom: Armin Novak <armin.novak@thincast.com>\nDate: Mon, 22 Oct 2018 16:30:20 +0200\nSubject: [PATCH] Fixed CVE-2018-8787\n\nThanks to Eyal Itkin from Check Point Software Technologies.\n---\n libfreerdp\/gdi\/graphics.c | 10 +++++++++-\n 1 file changed, 9 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/libfreerdp\/gdi\/graphics.c b\/libfreerdp\/gdi\/graphics.c\nindex 4afae48d1b..159198756b 100644\n--- a\/libfreerdp\/gdi\/graphics.c\n+++ b\/libfreerdp\/gdi\/graphics.c\n@@ -141,9 +141,17 @@ static BOOL gdi_Bitmap_Decompress(rdpContext* context, rdpBitmap* bitmap,\n {\n \tUINT32 SrcSize = length;\n \trdpGdi* gdi = context->gdi;\n+\tUINT32 size = DstWidth * DstHeight;\n \tbitmap->compressed = FALSE;\n \tbitmap->format = gdi->dstFormat;\n-\tbitmap->length = DstWidth * DstHeight * GetBytesPerPixel(bitmap->format);\n+\n+\tif ((GetBytesPerPixel(bitmap->format) == 0) ||\n+\t    (DstWidth == 0) || (DstHeight == 0) || (DstWidth > UINT32_MAX \/ DstHeight) ||\n+\t    (size > (UINT32_MAX \/ GetBytesPerPixel(bitmap->format))))\n+\t\treturn FALSE;\n+\n+\tsize *= GetBytesPerPixel(bitmap->format);\n+\tbitmap->length = size;\n \tbitmap->data = (BYTE*) _aligned_malloc(bitmap->length, 16);\n \n \tif (!bitmap->data)\n","owner":"FreeRDP","repo":"FreeRDP","source":"cve"},{"CVE_ID":"CVE-2017-5953","CWE_ID":"190","category":"security","commit_id":"399c297aa93afe2c0a39e2a1b3f972aebba44c9d","commit_message":"From 399c297aa93afe2c0a39e2a1b3f972aebba44c9d Mon Sep 17 00:00:00 2001\nFrom: Bram Moolenaar <Bram@vim.org>\nDate: Thu, 9 Feb 2017 21:07:12 +0100\nSubject: [PATCH] patch 8.0.0322: possible overflow with corrupted spell file\n\nProblem:    Possible overflow with spell file where the tree length is\n            corrupted.\nSolution:   Check for an invalid length (suggested by shqking)\n---\n src\/spellfile.c | 3 +++\n src\/version.c   | 2 ++\n 2 files changed, 5 insertions(+)\n\n","diff_code":"diff --git a\/src\/spellfile.c b\/src\/spellfile.c\nindex c7d87c6c72..8b1a3a633e 100644\n--- a\/src\/spellfile.c\n+++ b\/src\/spellfile.c\n@@ -1595,6 +1595,9 @@ spell_read_tree(\n     len = get4c(fd);\n     if (len < 0)\n \treturn SP_TRUNCERROR;\n+    if (len >= 0x3ffffff)\n+\t\/* Invalid length, multiply with sizeof(int) would overflow. *\/\n+\treturn SP_FORMERROR;\n     if (len > 0)\n     {\n \t\/* Allocate the byte array. *\/\ndiff --git a\/src\/version.c b\/src\/version.c\nindex 7a3d21513f..c1a5186bac 100644\n--- a\/src\/version.c\n+++ b\/src\/version.c\n@@ -764,6 +764,8 @@ static char *(features[]) =\n \n static int included_patches[] =\n {   \/* Add new patch number below this line *\/\n+\/**\/\n+    322,\n \/**\/\n     321,\n \/**\/\n","owner":"vim","repo":"vim","source":"cve"},{"CVE_ID":"CVE-2018-11219","CWE_ID":"190","category":"security","commit_id":"1eb08bcd4634ae42ec45e8284923ac048beaa4c3","commit_message":"From 1eb08bcd4634ae42ec45e8284923ac048beaa4c3 Mon Sep 17 00:00:00 2001\nFrom: antirez <antirez@gmail.com>\nDate: Mon, 14 May 2018 17:49:06 +0200\nSubject: [PATCH] Security: update Lua struct package for security.\n\nDuring an auditing Apple found that the \"struct\" Lua package\nwe ship with Redis (http:\/\/www.inf.puc-rio.br\/~roberto\/struct\/) contains\na security problem. A bound-checking statement fails because of integer\noverflow. The bug exists since we initially integrated this package with\nLua, when scripting was introduced, so every version of Redis with\nEVAL\/EVALSHA capabilities exposed is affected.\n\nInstead of just fixing the bug, the library was updated to the latest\nversion shipped by the author.\n---\n deps\/lua\/src\/lua_struct.c | 46 +++++++++++++++++++--------------------\n 1 file changed, 23 insertions(+), 23 deletions(-)\n\n","diff_code":"diff --git a\/deps\/lua\/src\/lua_struct.c b\/deps\/lua\/src\/lua_struct.c\nindex a602bb4309e..b03a002dade 100644\n--- a\/deps\/lua\/src\/lua_struct.c\n+++ b\/deps\/lua\/src\/lua_struct.c\n@@ -1,7 +1,7 @@\n \/*\n ** {======================================================\n ** Library for packing\/unpacking structures.\n-** $Id: struct.c,v 1.4 2012\/07\/04 18:54:29 roberto Exp $\n+** $Id: struct.c,v 1.7 2018\/05\/11 22:04:31 roberto Exp $\n ** See Copyright Notice at the end of this file\n ** =======================================================\n *\/\n@@ -15,8 +15,8 @@\n ** h\/H - signed\/unsigned short\n ** l\/L - signed\/unsigned long\n ** T   - size_t\n-** i\/In - signed\/unsigned integer with size `n' (default is size of int)\n-** cn - sequence of `n' chars (from\/to a string); when packing, n==0 means\n+** i\/In - signed\/unsigned integer with size 'n' (default is size of int)\n+** cn - sequence of 'n' chars (from\/to a string); when packing, n==0 means\n         the whole string; when unpacking, n==0 means use the previous\n         read number as the string length\n ** s - zero-terminated string\n@@ -89,14 +89,12 @@ typedef struct Header {\n } Header;\n \n \n-static int getnum (lua_State *L, const char **fmt, int df) {\n+static int getnum (const char **fmt, int df) {\n   if (!isdigit(**fmt))  \/* no number? *\/\n     return df;  \/* return default value *\/\n   else {\n     int a = 0;\n     do {\n-      if (a > (INT_MAX \/ 10) || a * 10 > (INT_MAX - (**fmt - '0')))\n-        luaL_error(L, \"integral size overflow\");\n       a = a*10 + *((*fmt)++) - '0';\n     } while (isdigit(**fmt));\n     return a;\n@@ -117,9 +115,9 @@ static size_t optsize (lua_State *L, char opt, const char **fmt) {\n     case 'f':  return sizeof(float);\n     case 'd':  return sizeof(double);\n     case 'x': return 1;\n-    case 'c': return getnum(L, fmt, 1);\n+    case 'c': return getnum(fmt, 1);\n     case 'i': case 'I': {\n-      int sz = getnum(L, fmt, sizeof(int));\n+      int sz = getnum(fmt, sizeof(int));\n       if (sz > MAXINTSIZE)\n         luaL_error(L, \"integral size %d is larger than limit of %d\",\n                        sz, MAXINTSIZE);\n@@ -152,7 +150,7 @@ static void controloptions (lua_State *L, int opt, const char **fmt,\n     case '>': h->endian = BIG; return;\n     case '<': h->endian = LITTLE; return;\n     case '!': {\n-      int a = getnum(L, fmt, MAXALIGN);\n+      int a = getnum(fmt, MAXALIGN);\n       if (!isp2(a))\n         luaL_error(L, \"alignment %d is not a power of 2\", a);\n       h->align = a;\n@@ -296,20 +294,21 @@ static int b_unpack (lua_State *L) {\n   size_t ld;\n   const char *data = luaL_checklstring(L, 2, &ld);\n   size_t pos = luaL_optinteger(L, 3, 1) - 1;\n+  int n = 0;  \/* number of results *\/\n   defaultoptions(&h);\n-  lua_settop(L, 2);\n   while (*fmt) {\n     int opt = *fmt++;\n     size_t size = optsize(L, opt, &fmt);\n     pos += gettoalign(pos, &h, opt, size);\n     luaL_argcheck(L, pos+size <= ld, 2, \"data string too short\");\n-    luaL_checkstack(L, 1, \"too many results\");\n+    \/* stack space for item + next position *\/\n+    luaL_checkstack(L, 2, \"too many results\");\n     switch (opt) {\n       case 'b': case 'B': case 'h': case 'H':\n       case 'l': case 'L': case 'T': case 'i':  case 'I': {  \/* integer types *\/\n         int issigned = islower(opt);\n         lua_Number res = getinteger(data+pos, h.endian, issigned, size);\n-        lua_pushnumber(L, res);\n+        lua_pushnumber(L, res); n++;\n         break;\n       }\n       case 'x': {\n@@ -319,25 +318,26 @@ static int b_unpack (lua_State *L) {\n         float f;\n         memcpy(&f, data+pos, size);\n         correctbytes((char *)&f, sizeof(f), h.endian);\n-        lua_pushnumber(L, f);\n+        lua_pushnumber(L, f); n++;\n         break;\n       }\n       case 'd': {\n         double d;\n         memcpy(&d, data+pos, size);\n         correctbytes((char *)&d, sizeof(d), h.endian);\n-        lua_pushnumber(L, d);\n+        lua_pushnumber(L, d); n++;\n         break;\n       }\n       case 'c': {\n         if (size == 0) {\n-          if (!lua_isnumber(L, -1))\n-            luaL_error(L, \"format `c0' needs a previous size\");\n+          if (n == 0 || !lua_isnumber(L, -1))\n+            luaL_error(L, \"format 'c0' needs a previous size\");\n           size = lua_tonumber(L, -1);\n-          lua_pop(L, 1);\n-          luaL_argcheck(L, pos+size <= ld, 2, \"data string too short\");\n+          lua_pop(L, 1); n--;\n+          luaL_argcheck(L, size <= ld && pos <= ld - size,\n+                           2, \"data string too short\");\n         }\n-        lua_pushlstring(L, data+pos, size);\n+        lua_pushlstring(L, data+pos, size); n++;\n         break;\n       }\n       case 's': {\n@@ -345,15 +345,15 @@ static int b_unpack (lua_State *L) {\n         if (e == NULL)\n           luaL_error(L, \"unfinished string in data\");\n         size = (e - (data+pos)) + 1;\n-        lua_pushlstring(L, data+pos, size - 1);\n+        lua_pushlstring(L, data+pos, size - 1); n++;\n         break;\n       }\n       default: controloptions(L, opt, &fmt, &h);\n     }\n     pos += size;\n   }\n-  lua_pushinteger(L, pos + 1);\n-  return lua_gettop(L) - 2;\n+  lua_pushinteger(L, pos + 1);  \/* next position *\/\n+  return n + 1;\n }\n \n \n@@ -399,7 +399,7 @@ LUALIB_API int luaopen_struct (lua_State *L) {\n \n \n \/******************************************************************************\n-* Copyright (C) 2010-2012 Lua.org, PUC-Rio.  All rights reserved.\n+* Copyright (C) 2010-2018 Lua.org, PUC-Rio.  All rights reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n","owner":"antirez","repo":"redis","source":"cve"},{"CVE_ID":"CVE-2018-12896","CWE_ID":"190","category":"security","commit_id":"78c9c4dfbf8c04883941445a195276bb4bb92c76","commit_message":"From 78c9c4dfbf8c04883941445a195276bb4bb92c76 Mon Sep 17 00:00:00 2001\nFrom: Thomas Gleixner <tglx@linutronix.de>\nDate: Tue, 26 Jun 2018 15:21:32 +0200\nSubject: [PATCH] posix-timers: Sanitize overrun handling\n\nThe posix timer overrun handling is broken because the forwarding functions\ncan return a huge number of overruns which does not fit in an int. As a\nconsequence timer_getoverrun(2) and siginfo::si_overrun can turn into\nrandom number generators.\n\nThe k_clock::timer_forward() callbacks return a 64 bit value now. Make\nk_itimer::ti_overrun[_last] 64bit as well, so the kernel internal\naccounting is correct. 3Remove the temporary (int) casts.\n\nAdd a helper function which clamps the overrun value returned to user space\nvia timer_getoverrun(2) or siginfo::si_overrun limited to a positive value\nbetween 0 and INT_MAX. INT_MAX is an indicator for user space that the\noverrun value has been clamped.\n\nReported-by: Team OWL337 <icytxw@gmail.com>\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\nAcked-by: John Stultz <john.stultz@linaro.org>\nCc: Peter Zijlstra <peterz@infradead.org>\nCc: Michael Kerrisk <mtk.manpages@gmail.com>\nLink: https:\/\/lkml.kernel.org\/r\/20180626132705.018623573@linutronix.de\n---\n include\/linux\/posix-timers.h   |  4 ++--\n kernel\/time\/posix-cpu-timers.c |  2 +-\n kernel\/time\/posix-timers.c     | 31 ++++++++++++++++++++-----------\n 3 files changed, 23 insertions(+), 14 deletions(-)\n\n","diff_code":"diff --git a\/include\/linux\/posix-timers.h b\/include\/linux\/posix-timers.h\nindex c85704fcdbd21..ee7e987ea1b43 100644\n--- a\/include\/linux\/posix-timers.h\n+++ b\/include\/linux\/posix-timers.h\n@@ -95,8 +95,8 @@ struct k_itimer {\n \tclockid_t\t\tit_clock;\n \ttimer_t\t\t\tit_id;\n \tint\t\t\tit_active;\n-\tint\t\t\tit_overrun;\n-\tint\t\t\tit_overrun_last;\n+\ts64\t\t\tit_overrun;\n+\ts64\t\t\tit_overrun_last;\n \tint\t\t\tit_requeue_pending;\n \tint\t\t\tit_sigev_notify;\n \tktime_t\t\t\tit_interval;\ndiff --git a\/kernel\/time\/posix-cpu-timers.c b\/kernel\/time\/posix-cpu-timers.c\nindex 5a6251ac6f7ac..562cc3891b570 100644\n--- a\/kernel\/time\/posix-cpu-timers.c\n+++ b\/kernel\/time\/posix-cpu-timers.c\n@@ -85,7 +85,7 @@ static void bump_cpu_timer(struct k_itimer *timer, u64 now)\n \t\t\tcontinue;\n \n \t\ttimer->it.cpu.expires += incr;\n-\t\ttimer->it_overrun += 1 << i;\n+\t\ttimer->it_overrun += 1LL << i;\n \t\tdelta -= incr;\n \t}\n }\ndiff --git a\/kernel\/time\/posix-timers.c b\/kernel\/time\/posix-timers.c\nindex db1d65963a576..3ac7295306dcd 100644\n--- a\/kernel\/time\/posix-timers.c\n+++ b\/kernel\/time\/posix-timers.c\n@@ -283,6 +283,17 @@ static __init int init_posix_timers(void)\n }\n __initcall(init_posix_timers);\n \n+\/*\n+ * The siginfo si_overrun field and the return value of timer_getoverrun(2)\n+ * are of type int. Clamp the overrun value to INT_MAX\n+ *\/\n+static inline int timer_overrun_to_int(struct k_itimer *timr, int baseval)\n+{\n+\ts64 sum = timr->it_overrun_last + (s64)baseval;\n+\n+\treturn sum > (s64)INT_MAX ? INT_MAX : (int)sum;\n+}\n+\n static void common_hrtimer_rearm(struct k_itimer *timr)\n {\n \tstruct hrtimer *timer = &timr->it.real.timer;\n@@ -290,9 +301,8 @@ static void common_hrtimer_rearm(struct k_itimer *timr)\n \tif (!timr->it_interval)\n \t\treturn;\n \n-\ttimr->it_overrun += (unsigned int) hrtimer_forward(timer,\n-\t\t\t\t\t\ttimer->base->get_time(),\n-\t\t\t\t\t\ttimr->it_interval);\n+\ttimr->it_overrun += hrtimer_forward(timer, timer->base->get_time(),\n+\t\t\t\t\t    timr->it_interval);\n \thrtimer_restart(timer);\n }\n \n@@ -321,10 +331,10 @@ void posixtimer_rearm(struct siginfo *info)\n \n \t\ttimr->it_active = 1;\n \t\ttimr->it_overrun_last = timr->it_overrun;\n-\t\ttimr->it_overrun = -1;\n+\t\ttimr->it_overrun = -1LL;\n \t\t++timr->it_requeue_pending;\n \n-\t\tinfo->si_overrun += timr->it_overrun_last;\n+\t\tinfo->si_overrun = timer_overrun_to_int(timr, info->si_overrun);\n \t}\n \n \tunlock_timer(timr, flags);\n@@ -418,9 +428,8 @@ static enum hrtimer_restart posix_timer_fn(struct hrtimer *timer)\n \t\t\t\t\tnow = ktime_add(now, kj);\n \t\t\t}\n #endif\n-\t\t\ttimr->it_overrun += (unsigned int)\n-\t\t\t\thrtimer_forward(timer, now,\n-\t\t\t\t\t\ttimr->it_interval);\n+\t\t\ttimr->it_overrun += hrtimer_forward(timer, now,\n+\t\t\t\t\t\t\t    timr->it_interval);\n \t\t\tret = HRTIMER_RESTART;\n \t\t\t++timr->it_requeue_pending;\n \t\t\ttimr->it_active = 1;\n@@ -524,7 +533,7 @@ static int do_timer_create(clockid_t which_clock, struct sigevent *event,\n \tnew_timer->it_id = (timer_t) new_timer_id;\n \tnew_timer->it_clock = which_clock;\n \tnew_timer->kclock = kc;\n-\tnew_timer->it_overrun = -1;\n+\tnew_timer->it_overrun = -1LL;\n \n \tif (event) {\n \t\trcu_read_lock();\n@@ -702,7 +711,7 @@ void common_timer_get(struct k_itimer *timr, struct itimerspec64 *cur_setting)\n \t * expiry time forward by intervals, so expiry is > now.\n \t *\/\n \tif (iv && (timr->it_requeue_pending & REQUEUE_PENDING || sig_none))\n-\t\ttimr->it_overrun += (int)kc->timer_forward(timr, now);\n+\t\ttimr->it_overrun += kc->timer_forward(timr, now);\n \n \tremaining = kc->timer_remaining(timr, now);\n \t\/* Return 0 only, when the timer is expired and not pending *\/\n@@ -791,7 +800,7 @@ SYSCALL_DEFINE1(timer_getoverrun, timer_t, timer_id)\n \tif (!timr)\n \t\treturn -EINVAL;\n \n-\toverrun = timr->it_overrun_last;\n+\toverrun = timer_overrun_to_int(timr, 0);\n \tunlock_timer(timr, flags);\n \n \treturn overrun;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2018-20177","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2018-6191","CWE_ID":"190","category":"security","commit_id":"25821e6d74fab5fcc200fe5e818362e03e114428","commit_message":"From 25821e6d74fab5fcc200fe5e818362e03e114428 Mon Sep 17 00:00:00 2001\nFrom: Tor Andersson <tor.andersson@artifex.com>\nDate: Wed, 24 Jan 2018 16:55:18 +0100\nSubject: [PATCH] Fix 698920: Guard jsdtoa from integer overflow wreaking\n havoc.\n\n---\n jsdtoa.c | 14 +++++++++-----\n 1 file changed, 9 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/jsdtoa.c b\/jsdtoa.c\nindex 04f22a1..af8f358 100644\n--- a\/jsdtoa.c\n+++ b\/jsdtoa.c\n@@ -709,16 +709,20 @@ js_strtod(const char *string, char **endPtr)\n \t * fraction.\n \t *\/\n \n-\tif (exp < 0) {\n+\tif (exp < -maxExponent) {\n+\t\texp = maxExponent;\n+\t\texpSign = TRUE;\n+\t\terrno = ERANGE;\n+\t} else if (exp > maxExponent) {\n+\t\texp = maxExponent;\n+\t\texpSign = FALSE;\n+\t\terrno = ERANGE;\n+\t} else if (exp < 0) {\n \t\texpSign = TRUE;\n \t\texp = -exp;\n \t} else {\n \t\texpSign = FALSE;\n \t}\n-\tif (exp > maxExponent) {\n-\t\texp = maxExponent;\n-\t\terrno = ERANGE;\n-\t}\n \tdblExp = 1.0;\n \tfor (d = powersOf10; exp != 0; exp >>= 1, d += 1) {\n \t\tif (exp & 01) {\n-- \n2.9.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-6350","CWE_ID":"190","category":"security","commit_id":"0c8485f0e4931463c0f7986e1ea84a7d79f10c75","commit_message":"From 0c8485f0e4931463c0f7986e1ea84a7d79f10c75 Mon Sep 17 00:00:00 2001\nFrom: Bram Moolenaar <Bram@vim.org>\nDate: Sun, 26 Feb 2017 18:17:10 +0100\nSubject: [PATCH] patch 8.0.0378: possible overflow when reading corrupted undo\n file\n\nProblem:    Another possible overflow when reading corrupted undo file.\nSolution:   Check if allocated size is not too big. (King)\n---\n src\/undo.c    | 7 +++----\n src\/version.c | 2 ++\n 2 files changed, 5 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/src\/undo.c b\/src\/undo.c\nindex ba7c0b83c7..5b953795ef 100644\n--- a\/src\/undo.c\n+++ b\/src\/undo.c\n@@ -1385,7 +1385,7 @@ unserialize_uep(bufinfo_T *bi, int *error, char_u *file_name)\n {\n     int\t\ti;\n     u_entry_T\t*uep;\n-    char_u\t**array;\n+    char_u\t**array = NULL;\n     char_u\t*line;\n     int\t\tline_len;\n \n@@ -1402,7 +1402,8 @@ unserialize_uep(bufinfo_T *bi, int *error, char_u *file_name)\n     uep->ue_size = undo_read_4c(bi);\n     if (uep->ue_size > 0)\n     {\n-\tarray = (char_u **)U_ALLOC_LINE(sizeof(char_u *) * uep->ue_size);\n+\tif (uep->ue_size < LONG_MAX \/ (int)sizeof(char_u *))\n+\t    array = (char_u **)U_ALLOC_LINE(sizeof(char_u *) * uep->ue_size);\n \tif (array == NULL)\n \t{\n \t    *error = TRUE;\n@@ -1410,8 +1411,6 @@ unserialize_uep(bufinfo_T *bi, int *error, char_u *file_name)\n \t}\n \tvim_memset(array, 0, sizeof(char_u *) * uep->ue_size);\n     }\n-    else\n-\tarray = NULL;\n     uep->ue_array = array;\n \n     for (i = 0; i < uep->ue_size; ++i)\ndiff --git a\/src\/version.c b\/src\/version.c\nindex c79020b211..026b829816 100644\n--- a\/src\/version.c\n+++ b\/src\/version.c\n@@ -764,6 +764,8 @@ static char *(features[]) =\n \n static int included_patches[] =\n {   \/* Add new patch number below this line *\/\n+\/**\/\n+    378,\n \/**\/\n     377,\n \/**\/\n","owner":"vim","repo":"vim","source":"cve"},{"CVE_ID":"CVE-2014-0143","CWE_ID":"190","category":"security","commit_id":"afbcc40bee4ef51731102d7d4b499ee12fc182e1","commit_message":"From afbcc40bee4ef51731102d7d4b499ee12fc182e1 Mon Sep 17 00:00:00 2001\nFrom: Kevin Wolf <kwolf@redhat.com>\nDate: Wed, 26 Mar 2014 13:06:08 +0100\nSubject: [PATCH] parallels: Fix catalog size integer overflow (CVE-2014-0143)\n\nThe first test case would cause a huge memory allocation, leading to a\nqemu abort; the second one to a too small malloc() for the catalog\n(smaller than s->catalog_size), which causes a read-only out-of-bounds\narray access and on big endian hosts an endianess conversion for an\nundefined memory area.\n\nThe sample image used here is not an original Parallels image. It was\ncreated using an hexeditor on the basis of the struct that qemu uses.\nGood enough for trying to crash the driver, but not for ensuring\ncompatibility.\n\nSigned-off-by: Kevin Wolf <kwolf@redhat.com>\nReviewed-by: Max Reitz <mreitz@redhat.com>\nSigned-off-by: Stefan Hajnoczi <stefanha@redhat.com>\n---\n block\/parallels.c                                  |   7 ++-\n tests\/qemu-iotests\/076                             |  69 +++++++++++++++++++++\n tests\/qemu-iotests\/076.out                         |  14 +++++\n tests\/qemu-iotests\/common                          |   7 +++\n tests\/qemu-iotests\/group                           |   1 +\n ...\/qemu-iotests\/sample_images\/fake.parallels.bz2  | Bin 0 -> 141 bytes\n 6 files changed, 97 insertions(+), 1 deletion(-)\n create mode 100755 tests\/qemu-iotests\/076\n create mode 100644 tests\/qemu-iotests\/076.out\n create mode 100644 tests\/qemu-iotests\/sample_images\/fake.parallels.bz2\n\n","diff_code":"diff --git a\/block\/parallels.c b\/block\/parallels.c\nindex 3f588f5..fe47ecb 100644\n--- a\/block\/parallels.c\n+++ b\/block\/parallels.c\n@@ -49,7 +49,7 @@ typedef struct BDRVParallelsState {\n     CoMutex lock;\n \n     uint32_t *catalog_bitmap;\n-    int catalog_size;\n+    unsigned int catalog_size;\n \n     int tracks;\n } BDRVParallelsState;\n@@ -95,6 +95,11 @@ static int parallels_open(BlockDriverState *bs, QDict *options, int flags,\n     s->tracks = le32_to_cpu(ph.tracks);\n \n     s->catalog_size = le32_to_cpu(ph.catalog_entries);\n+    if (s->catalog_size > INT_MAX \/ 4) {\n+        error_setg(errp, \"Catalog too large\");\n+        ret = -EFBIG;\n+        goto fail;\n+    }\n     s->catalog_bitmap = g_malloc(s->catalog_size * 4);\n \n     ret = bdrv_pread(bs->file, 64, s->catalog_bitmap, s->catalog_size * 4);\ndiff --git a\/tests\/qemu-iotests\/076 b\/tests\/qemu-iotests\/076\nnew file mode 100755\nindex 0000000..6028ac5\n--- \/dev\/null\n+++ b\/tests\/qemu-iotests\/076\n@@ -0,0 +1,69 @@\n+#!\/bin\/bash\n+#\n+# parallels format input validation tests\n+#\n+# Copyright (C) 2013 Red Hat, Inc.\n+#\n+# This program is free software; you can redistribute it and\/or modify\n+# it under the terms of the GNU General Public License as published by\n+# the Free Software Foundation; either version 2 of the License, or\n+# (at your option) any later version.\n+#\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with this program.  If not, see <http:\/\/www.gnu.org\/licenses\/>.\n+#\n+\n+# creator\n+owner=kwolf@redhat.com\n+\n+seq=`basename $0`\n+echo \"QA output created by $seq\"\n+\n+here=`pwd`\n+tmp=\/tmp\/$$\n+status=1\t# failure is the default!\n+\n+_cleanup()\n+{\n+\t_cleanup_test_img\n+}\n+trap \"_cleanup; exit \\$status\" 0 1 2 3 15\n+\n+# get standard environment, filters and checks\n+. .\/common.rc\n+. .\/common.filter\n+\n+_supported_fmt parallels\n+_supported_proto generic\n+_supported_os Linux\n+\n+catalog_entries_offset=$((0x20))\n+nb_sectors_offset=$((0x24))\n+\n+echo\n+echo \"== Read from a valid (enough) image ==\"\n+_use_sample_img fake.parallels.bz2\n+{ $QEMU_IO -c \"read -P 0x11 0 64k\" $TEST_IMG; } 2>&1 | _filter_qemu_io | _filter_testdir\n+\n+echo\n+echo \"== Negative catalog size ==\"\n+_use_sample_img fake.parallels.bz2\n+poke_file \"$TEST_IMG\" \"$catalog_entries_offset\" \"\\xff\\xff\\xff\\xff\"\n+{ $QEMU_IO -c \"read 0 512\" $TEST_IMG; } 2>&1 | _filter_qemu_io | _filter_testdir\n+\n+echo\n+echo \"== Overflow in catalog allocation ==\"\n+_use_sample_img fake.parallels.bz2\n+poke_file \"$TEST_IMG\" \"$nb_sectors_offset\" \"\\xff\\xff\\xff\\xff\"\n+poke_file \"$TEST_IMG\" \"$catalog_entries_offset\" \"\\x01\\x00\\x00\\x40\"\n+{ $QEMU_IO -c \"read 64M 64M\" $TEST_IMG; } 2>&1 | _filter_qemu_io | _filter_testdir\n+\n+# success, all done\n+echo \"*** done\"\n+rm -f $seq.full\n+status=0\ndiff --git a\/tests\/qemu-iotests\/076.out b\/tests\/qemu-iotests\/076.out\nnew file mode 100644\nindex 0000000..12af42a\n--- \/dev\/null\n+++ b\/tests\/qemu-iotests\/076.out\n@@ -0,0 +1,14 @@\n+QA output created by 076\n+\n+== Read from a valid (enough) image ==\n+read 65536\/65536 bytes at offset 0\n+64 KiB, X ops; XX:XX:XX.X (XXX YYY\/sec and XXX ops\/sec)\n+\n+== Negative catalog size ==\n+qemu-io: can't open device TEST_DIR\/fake.parallels: Catalog too large\n+no file open, try 'help open'\n+\n+== Overflow in catalog allocation ==\n+qemu-io: can't open device TEST_DIR\/fake.parallels: Catalog too large\n+no file open, try 'help open'\n+*** done\ndiff --git a\/tests\/qemu-iotests\/common b\/tests\/qemu-iotests\/common\nindex a09d9c8..0aaf84d 100644\n--- a\/tests\/qemu-iotests\/common\n+++ b\/tests\/qemu-iotests\/common\n@@ -139,6 +139,7 @@ check options\n     -bochs              test bochs\n     -cow                test cow\n     -cloop              test cloop\n+    -parallels          test parallels\n     -qcow               test qcow\n     -qcow2              test qcow2\n     -qed                test qed\n@@ -192,6 +193,12 @@ testlist options\n             xpand=false\n             ;;\n \n+        -parallels)\n+            IMGFMT=parallels\n+            IMGFMT_GENERIC=false\n+            xpand=false\n+            ;;\n+\n         -qcow)\n             IMGFMT=qcow\n             xpand=false\ndiff --git a\/tests\/qemu-iotests\/group b\/tests\/qemu-iotests\/group\nindex c51640c..864643d 100644\n--- a\/tests\/qemu-iotests\/group\n+++ b\/tests\/qemu-iotests\/group\n@@ -82,6 +82,7 @@\n 073 rw auto quick\n 074 rw auto quick\n 075 rw auto\n+076 auto\n 077 rw auto quick\n 078 rw auto\n 079 rw auto\ndiff --git a\/tests\/qemu-iotests\/sample_images\/fake.parallels.bz2 b\/tests\/qemu-iotests\/sample_images\/fake.parallels.bz2\nnew file mode 100644\nindex 0000000000000000000000000000000000000000..ffb5f13bac31bc9ab6e1ea5c0cfa26786f2c4cc6\nGIT binary patch\nliteral 141\nzcmV;80CN9AT4*^jL0KkKS*i&LJ^%_Hf6(xNVE_;S2ml2D2!JYJ)&M{N00969FaWp;\nz000b`1pojBOn|7QnnOSv)YEF7cgIVO0ByGSdk7e?fW`f$x`2Bi3t$bd06owJs09G{\nvKo+1B1LXi)0CVe)J@eC^zBuEJbFFJA24D=p8Gt*$AL8yvrwS4kK_LggA5<|C\n\nliteral 0\nHcmV?d00001\n\n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-5770","CWE_ID":"190","category":"security","commit_id":"7245bff300d3fa8bacbef7897ff080a6f1c23eba","commit_message":"From 7245bff300d3fa8bacbef7897ff080a6f1c23eba Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Wed, 15 Jun 2016 21:58:26 -0700\nSubject: [PATCH] Fix bug #72262 - do not overflow int\n\n---\n ext\/spl\/spl_directory.c | 218 ++++++++++++++++++++--------------------\n 1 file changed, 111 insertions(+), 107 deletions(-)\n\n","diff_code":"diff --git a\/ext\/spl\/spl_directory.c b\/ext\/spl\/spl_directory.c\nindex e20a80ae77c6..7718fe42d7fa 100644\n--- a\/ext\/spl\/spl_directory.c\n+++ b\/ext\/spl\/spl_directory.c\n@@ -79,9 +79,9 @@ static void spl_filesystem_object_free_storage(void *object TSRMLS_DC) \/* {{{ *\/\n \tif (intern->oth_handler && intern->oth_handler->dtor) {\n \t\tintern->oth_handler->dtor(intern TSRMLS_CC);\n \t}\n-\t\n+\n \tzend_object_std_dtor(&intern->std TSRMLS_CC);\n-\t\n+\n \tif (intern->_path) {\n \t\tefree(intern->_path);\n \t}\n@@ -98,7 +98,7 @@ static void spl_filesystem_object_free_storage(void *object TSRMLS_DC) \/* {{{ *\/\n \t\t}\n \t\tif (intern->u.dir.sub_path) {\n \t\t\tefree(intern->u.dir.sub_path);\n-\t\t}\t\t\n+\t\t}\n \t\tbreak;\n \tcase SPL_FS_FILE:\n \t\tif (intern->u.file.stream) {\n@@ -134,13 +134,13 @@ static void spl_filesystem_object_free_storage(void *object TSRMLS_DC) \/* {{{ *\/\n } \/* }}} *\/\n \n \/* {{{ spl_ce_dir_object_new *\/\n-\/* creates the object by \n-   - allocating memory \n+\/* creates the object by\n+   - allocating memory\n    - initializing the object members\n    - storing the object\n    - setting it's handlers\n \n-   called from \n+   called from\n    - clone\n    - new\n  *\/\n@@ -313,7 +313,7 @@ static int spl_filesystem_file_open(spl_filesystem_object *intern, int use_inclu\n \t\/* avoid reference counting in debug mode, thus do it manually *\/\n \tZVAL_RESOURCE(&intern->u.file.zresource, php_stream_get_resource_id(intern->u.file.stream));\n \tZ_SET_REFCOUNT(intern->u.file.zresource, 1);\n-\t\n+\n \tintern->u.file.delimiter = ',';\n \tintern->u.file.enclosure = '\"';\n \tintern->u.file.escape = '\\\\';\n@@ -325,7 +325,7 @@ static int spl_filesystem_file_open(spl_filesystem_object *intern, int use_inclu\n \n \/* {{{ spl_filesystem_object_clone *\/\n \/* Local zend_object_value creation (on stack)\n-   Load the 'other' object \n+   Load the 'other' object\n    Create a new empty object (See spl_filesystem_object_new_ex)\n    Open the directory\n    Clone other members (properties)\n@@ -370,7 +370,7 @@ static zend_object_value spl_filesystem_object_clone(zval *zobject TSRMLS_DC)\n \t\tphp_error_docref(NULL TSRMLS_CC, E_ERROR, \"An object of class %s cannot be cloned\", old_object->ce->name);\n \t\tbreak;\n \t}\n-\t\n+\n \tintern->file_class = source->file_class;\n \tintern->info_class = source->info_class;\n \tintern->oth = source->oth;\n@@ -389,7 +389,7 @@ static zend_object_value spl_filesystem_object_clone(zval *zobject TSRMLS_DC)\n void spl_filesystem_info_set_filename(spl_filesystem_object *intern, char *path, int len, int use_copy TSRMLS_DC) \/* {{{ *\/\n {\n \tchar *p1, *p2;\n-\t\n+\n \tif (intern->file_name) {\n \t\tefree(intern->file_name);\n \t}\n@@ -413,7 +413,7 @@ void spl_filesystem_info_set_filename(spl_filesystem_object *intern, char *path,\n \t} else {\n \t\tintern->_path_len = 0;\n \t}\n-\t\n+\n \tif (intern->_path) {\n \t\tefree(intern->_path);\n \t}\n@@ -459,7 +459,7 @@ static spl_filesystem_object * spl_filesystem_object_create_info(spl_filesystem_\n \t} else {\n \t\tspl_filesystem_info_set_filename(intern, file_path, file_path_len, use_copy TSRMLS_CC);\n \t}\n-\t\n+\n \tzend_restore_error_handling(&error_handling TSRMLS_CC);\n \treturn intern;\n } \/* }}} *\/\n@@ -514,7 +514,7 @@ static spl_filesystem_object * spl_filesystem_object_create_type(int ht, spl_fil\n \n \t\treturn_value->value.obj = spl_filesystem_object_new_ex(ce, &intern TSRMLS_CC);\n \t\tZ_TYPE_P(return_value) = IS_OBJECT;\n-\t\n+\n \t\tspl_filesystem_object_get_file_name(source TSRMLS_CC);\n \n \t\tif (ce->constructor->common.scope != spl_ce_SplFileObject) {\n@@ -530,12 +530,12 @@ static spl_filesystem_object * spl_filesystem_object_create_type(int ht, spl_fil\n \t\t\tintern->file_name_len = source->file_name_len;\n \t\t\tintern->_path = spl_filesystem_object_get_path(source, &intern->_path_len TSRMLS_CC);\n \t\t\tintern->_path = estrndup(intern->_path, intern->_path_len);\n-\t\t\n+\n \t\t\tintern->u.file.open_mode = \"r\";\n \t\t\tintern->u.file.open_mode_len = 1;\n-\t\t\n-\t\t\tif (ht && zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|sbr\", \n-\t\t\t\t\t&intern->u.file.open_mode, &intern->u.file.open_mode_len, \n+\n+\t\t\tif (ht && zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|sbr\",\n+\t\t\t\t\t&intern->u.file.open_mode, &intern->u.file.open_mode_len,\n \t\t\t\t\t&use_include_path, &intern->u.file.zcontext) == FAILURE) {\n \t\t\t\tzend_restore_error_handling(&error_handling TSRMLS_CC);\n \t\t\t\tintern->u.file.open_mode = NULL;\n@@ -544,7 +544,7 @@ static spl_filesystem_object * spl_filesystem_object_create_type(int ht, spl_fil\n \t\t\t\tZ_TYPE_P(return_value) = IS_NULL;\n \t\t\t\treturn NULL;\n \t\t\t}\n-\t\t\n+\n \t\t\tif (spl_filesystem_file_open(intern, use_include_path, 0 TSRMLS_CC) == FAILURE) {\n \t\t\t\tzend_restore_error_handling(&error_handling TSRMLS_CC);\n \t\t\t\tzval_dtor(return_value);\n@@ -553,7 +553,7 @@ static spl_filesystem_object * spl_filesystem_object_create_type(int ht, spl_fil\n \t\t\t}\n \t\t}\n \t\tbreak;\n-\tcase SPL_FS_DIR:\t\n+\tcase SPL_FS_DIR:\n \t\tzend_restore_error_handling(&error_handling TSRMLS_CC);\n \t\tzend_throw_exception_ex(spl_ce_RuntimeException, 0 TSRMLS_CC, \"Operation not supported\");\n \t\treturn NULL;\n@@ -617,7 +617,7 @@ static HashTable* spl_filesystem_object_get_debug_info(zval *obj, int *is_temp T\n \tif (intern->file_name) {\n \t\tpnstr = spl_gen_private_prop_name(spl_ce_SplFileInfo, \"fileName\", sizeof(\"fileName\")-1, &pnlen TSRMLS_CC);\n \t\tspl_filesystem_object_get_path(intern, &path_len TSRMLS_CC);\n-\t\t\n+\n \t\tif (path_len && path_len < intern->file_name_len) {\n \t\t\tadd_assoc_stringl_ex(&zrv, pnstr, pnlen+1, intern->file_name + path_len + 1, intern->file_name_len - (path_len + 1), 1);\n \t\t} else {\n@@ -665,13 +665,13 @@ static HashTable* spl_filesystem_object_get_debug_info(zval *obj, int *is_temp T\n zend_function *spl_filesystem_object_get_method_check(zval **object_ptr, char *method, int method_len, const struct _zend_literal *key TSRMLS_DC) \/* {{{ *\/\n {\n \tspl_filesystem_object *fsobj = zend_object_store_get_object(*object_ptr TSRMLS_CC);\n-\t\n+\n \tif (fsobj->u.dir.entry.d_name[0] == '\\0' && fsobj->orig_path == NULL) {\n \t\tmethod = \"_bad_state_ex\";\n \t\tmethod_len = sizeof(\"_bad_state_ex\") - 1;\n \t\tkey = NULL;\n \t}\n-\t\n+\n \treturn zend_get_std_object_handlers()->get_method(object_ptr, method, method_len, key TSRMLS_CC);\n }\n \/* }}} *\/\n@@ -751,7 +751,7 @@ SPL_METHOD(DirectoryIterator, __construct)\n SPL_METHOD(DirectoryIterator, rewind)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -769,7 +769,7 @@ SPL_METHOD(DirectoryIterator, rewind)\n SPL_METHOD(DirectoryIterator, key)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -799,7 +799,7 @@ SPL_METHOD(DirectoryIterator, next)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n \tint skip_dots = SPL_HAS_FLAG(intern->flags, SPL_FILE_DIR_SKIPDOTS);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -859,7 +859,7 @@ SPL_METHOD(DirectoryIterator, seek)\n SPL_METHOD(DirectoryIterator, valid)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -875,7 +875,7 @@ SPL_METHOD(SplFileInfo, getPath)\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n \tchar *path;\n \tint path_len;\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -891,13 +891,13 @@ SPL_METHOD(SplFileInfo, getFilename)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n \tint path_len;\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n \n \tspl_filesystem_object_get_path(intern, &path_len TSRMLS_CC);\n-\t\n+\n \tif (path_len && path_len < intern->file_name_len) {\n \t\tRETURN_STRINGL(intern->file_name + path_len + 1, intern->file_name_len - (path_len + 1), 1);\n \t} else {\n@@ -911,7 +911,7 @@ SPL_METHOD(SplFileInfo, getFilename)\n SPL_METHOD(DirectoryIterator, getFilename)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -1019,7 +1019,7 @@ SPL_METHOD(SplFileInfo, getBasename)\n \n \tRETURN_STRINGL(fname, flen, 0);\n }\n-\/* }}}*\/   \n+\/* }}}*\/\n \n \/* {{{ proto string DirectoryIterator::getBasename([string $suffix]) U\n    Returns filename component of current dir entry *\/\n@@ -1029,7 +1029,7 @@ SPL_METHOD(DirectoryIterator, getBasename)\n \tchar *suffix = 0, *fname;\n \tint slen = 0;\n \tsize_t flen;\n-\t\n+\n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|s\", &suffix, &slen) == FAILURE) {\n \t\treturn;\n \t}\n@@ -1065,7 +1065,7 @@ SPL_METHOD(SplFileInfo, getPathname)\n SPL_METHOD(FilesystemIterator, key)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -1084,7 +1084,7 @@ SPL_METHOD(FilesystemIterator, key)\n SPL_METHOD(FilesystemIterator, current)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -1107,7 +1107,7 @@ SPL_METHOD(FilesystemIterator, current)\n SPL_METHOD(DirectoryIterator, isDot)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -1121,8 +1121,8 @@ SPL_METHOD(DirectoryIterator, isDot)\n \/* zend_replace_error_handling() is used to throw exceptions in case\n    the constructor fails. Here we use this to ensure the object\n    has a valid directory resource.\n-   \n-   When the constructor gets called the object is already created \n+\n+   When the constructor gets called the object is already created\n    by the engine, so we must only call 'additional' initializations.\n  *\/\n SPL_METHOD(SplFileInfo, __construct)\n@@ -1140,11 +1140,11 @@ SPL_METHOD(SplFileInfo, __construct)\n \t}\n \n \tintern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tspl_filesystem_info_set_filename(intern, path, len, 1 TSRMLS_CC);\n \n \tzend_restore_error_handling(&error_handling TSRMLS_CC);\n-\t\n+\n \t\/* intern->type = SPL_FS_INFO; already set *\/\n }\n \/* }}} *\/\n@@ -1249,7 +1249,7 @@ SPL_METHOD(SplFileInfo, getLinkTarget)\n \tint ret;\n \tchar buff[MAXPATHLEN];\n \tzend_error_handling error_handling;\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -1297,7 +1297,7 @@ SPL_METHOD(SplFileInfo, getRealPath)\n \tchar buff[MAXPATHLEN];\n \tchar *filename;\n \tzend_error_handling error_handling;\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -1307,10 +1307,10 @@ SPL_METHOD(SplFileInfo, getRealPath)\n \tif (intern->type == SPL_FS_DIR && !intern->file_name && intern->u.dir.entry.d_name[0]) {\n \t\tspl_filesystem_object_get_file_name(intern TSRMLS_CC);\n \t}\n-\t\n+\n \tif (intern->orig_path) {\n \t\tfilename = intern->orig_path;\n-\t} else { \n+\t} else {\n \t\tfilename = intern->file_name;\n \t}\n \n@@ -1348,7 +1348,7 @@ SPL_METHOD(SplFileInfo, setFileClass)\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n \tzend_class_entry *ce = spl_ce_SplFileObject;\n \tzend_error_handling error_handling;\n-\t\n+\n \tzend_replace_error_handling(EH_THROW, spl_ce_UnexpectedValueException, &error_handling TSRMLS_CC);\n \n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|C\", &ce) == SUCCESS) {\n@@ -1366,7 +1366,7 @@ SPL_METHOD(SplFileInfo, setInfoClass)\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n \tzend_class_entry *ce = spl_ce_SplFileInfo;\n \tzend_error_handling error_handling;\n-\t\n+\n \tzend_replace_error_handling(EH_THROW, spl_ce_UnexpectedValueException, &error_handling  TSRMLS_CC);\n \n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|C\", &ce) == SUCCESS) {\n@@ -1384,7 +1384,7 @@ SPL_METHOD(SplFileInfo, getFileInfo)\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n \tzend_class_entry *ce = intern->info_class;\n \tzend_error_handling error_handling;\n-\t\n+\n \tzend_replace_error_handling(EH_THROW, spl_ce_UnexpectedValueException, &error_handling TSRMLS_CC);\n \n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|C\", &ce) == SUCCESS) {\n@@ -1402,7 +1402,7 @@ SPL_METHOD(SplFileInfo, getPathInfo)\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n \tzend_class_entry *ce = intern->info_class;\n \tzend_error_handling error_handling;\n-\t\n+\n \tzend_replace_error_handling(EH_THROW, spl_ce_UnexpectedValueException, &error_handling TSRMLS_CC);\n \n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|C\", &ce) == SUCCESS) {\n@@ -1463,7 +1463,7 @@ SPL_METHOD(FilesystemIterator, rewind)\n SPL_METHOD(FilesystemIterator, getFlags)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -1519,11 +1519,11 @@ SPL_METHOD(RecursiveDirectoryIterator, getChildren)\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n \tspl_filesystem_object *subdir;\n \tchar slash = SPL_HAS_FLAG(intern->flags, SPL_FILE_DIR_UNIXPATHS) ? '\/' : DEFAULT_SLASH;\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n-\t\n+\n \tspl_filesystem_object_get_file_name(intern TSRMLS_CC);\n \n \tMAKE_STD_ZVAL(zflags);\n@@ -1554,7 +1554,7 @@ SPL_METHOD(RecursiveDirectoryIterator, getChildren)\n SPL_METHOD(RecursiveDirectoryIterator, getSubPath)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -1575,7 +1575,7 @@ SPL_METHOD(RecursiveDirectoryIterator, getSubPathname)\n \tchar *sub_name;\n \tint len;\n \tchar slash = SPL_HAS_FLAG(intern->flags, SPL_FILE_DIR_UNIXPATHS) ? '\/' : DEFAULT_SLASH;\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -1611,7 +1611,7 @@ SPL_METHOD(GlobIterator, __construct)\n SPL_METHOD(GlobIterator, count)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -1666,7 +1666,7 @@ zend_object_iterator *spl_filesystem_dir_get_iterator(zend_class_entry *ce, zval\n \t\titerator->current = object;\n \t}\n \tzval_add_ref(&object);\n-\t\n+\n \treturn (zend_object_iterator*)iterator;\n }\n \/* }}} *\/\n@@ -1701,7 +1701,7 @@ static int spl_filesystem_dir_it_valid(zend_object_iterator *iter TSRMLS_DC)\n static void spl_filesystem_dir_it_current_data(zend_object_iterator *iter, zval ***data TSRMLS_DC)\n {\n \tspl_filesystem_iterator *iterator = (spl_filesystem_iterator *)iter;\n-\t\n+\n \t*data = &iterator->current;\n }\n \/* }}} *\/\n@@ -1719,7 +1719,7 @@ static void spl_filesystem_dir_it_current_key(zend_object_iterator *iter, zval *\n static void spl_filesystem_dir_it_move_forward(zend_object_iterator *iter TSRMLS_DC)\n {\n \tspl_filesystem_object *object = spl_filesystem_iterator_to_object((spl_filesystem_iterator *)iter);\n-\t\n+\n \tobject->u.dir.index++;\n \tspl_filesystem_dir_read(object TSRMLS_CC);\n \tif (object->file_name) {\n@@ -1733,7 +1733,7 @@ static void spl_filesystem_dir_it_move_forward(zend_object_iterator *iter TSRMLS\n static void spl_filesystem_dir_it_rewind(zend_object_iterator *iter TSRMLS_DC)\n {\n \tspl_filesystem_object *object = spl_filesystem_iterator_to_object((spl_filesystem_iterator *)iter);\n-\t\n+\n \tobject->u.dir.index = 0;\n \tif (object->u.dir.dirp) {\n \t\tphp_stream_rewinddir(object->u.dir.dirp);\n@@ -1803,7 +1803,7 @@ static void spl_filesystem_tree_it_move_forward(zend_object_iterator *iter TSRML\n {\n \tspl_filesystem_iterator *iterator = (spl_filesystem_iterator *)iter;\n \tspl_filesystem_object   *object   = spl_filesystem_iterator_to_object(iterator);\n-\t\n+\n \tobject->u.dir.index++;\n \tdo {\n \t\tspl_filesystem_dir_read(object TSRMLS_CC);\n@@ -1824,7 +1824,7 @@ static void spl_filesystem_tree_it_rewind(zend_object_iterator *iter TSRMLS_DC)\n {\n \tspl_filesystem_iterator *iterator = (spl_filesystem_iterator *)iter;\n \tspl_filesystem_object   *object   = spl_filesystem_iterator_to_object(iterator);\n-\t\n+\n \tobject->u.dir.index = 0;\n \tif (object->u.dir.dirp) {\n \t\tphp_stream_rewinddir(object->u.dir.dirp);\n@@ -1868,7 +1868,7 @@ zend_object_iterator *spl_filesystem_tree_get_iterator(zend_class_entry *ce, zva\n \t\titerator->intern.funcs = &spl_filesystem_tree_it_funcs;\n \t}\n \tzval_add_ref(&object);\n-\t\n+\n \treturn (zend_object_iterator*)iterator;\n }\n \/* }}} *\/\n@@ -1924,7 +1924,7 @@ static int spl_filesystem_object_cast(zval *readobj, zval *writeobj, int type TS\n \n \/* {{{ declare method parameters *\/\n \/* supply a name and default to call by parameter *\/\n-ZEND_BEGIN_ARG_INFO(arginfo_info___construct, 0) \n+ZEND_BEGIN_ARG_INFO(arginfo_info___construct, 0)\n \tZEND_ARG_INFO(0, file_name)\n ZEND_END_ARG_INFO()\n \n@@ -1983,11 +1983,11 @@ static const zend_function_entry spl_SplFileInfo_functions[] = {\n \tPHP_FE_END\n };\n \n-ZEND_BEGIN_ARG_INFO(arginfo_dir___construct, 0) \n+ZEND_BEGIN_ARG_INFO(arginfo_dir___construct, 0)\n \tZEND_ARG_INFO(0, path)\n ZEND_END_ARG_INFO()\n \n-ZEND_BEGIN_ARG_INFO(arginfo_dir_it_seek, 0) \n+ZEND_BEGIN_ARG_INFO(arginfo_dir_it_seek, 0)\n \tZEND_ARG_INFO(0, position)\n ZEND_END_ARG_INFO();\n \n@@ -2009,7 +2009,7 @@ static const zend_function_entry spl_DirectoryIterator_functions[] = {\n \tPHP_FE_END\n };\n \n-ZEND_BEGIN_ARG_INFO_EX(arginfo_r_dir___construct, 0, 0, 1) \n+ZEND_BEGIN_ARG_INFO_EX(arginfo_r_dir___construct, 0, 0, 1)\n \tZEND_ARG_INFO(0, path)\n \tZEND_ARG_INFO(0, flags)\n ZEND_END_ARG_INFO()\n@@ -2058,7 +2058,7 @@ static int spl_filesystem_file_read(spl_filesystem_object *intern, int silent TS\n \tlong line_add = (intern->u.file.current_line || intern->u.file.current_zval) ? 1 : 0;\n \n \tspl_filesystem_file_free_line(intern TSRMLS_CC);\n-\t\n+\n \tif (php_stream_eof(intern->u.file.stream)) {\n \t\tif (!silent) {\n \t\t\tzend_throw_exception_ex(spl_ce_RuntimeException, 0 TSRMLS_CC, \"Cannot read from file %s\", intern->file_name);\n@@ -2086,7 +2086,7 @@ static int spl_filesystem_file_read(spl_filesystem_object *intern, int silent TS\n \t\t\tline_len = strcspn(buf, \"\\r\\n\");\n \t\t\tbuf[line_len] = '\\0';\n \t\t}\n-\t\n+\n \t\tintern->u.file.current_line = buf;\n \t\tintern->u.file.current_line_len = line_len;\n \t}\n@@ -2107,7 +2107,7 @@ static int spl_filesystem_file_call(spl_filesystem_object *intern, zend_function\n \tzval ***params = (zval***)safe_emalloc(num_args, sizeof(zval**), 0);\n \n \tparams[0] = &zresource_ptr;\n-\t\n+\n \tif (arg2) {\n \t\tparams[1] = &arg2;\n \t}\n@@ -2133,7 +2133,7 @@ static int spl_filesystem_file_call(spl_filesystem_object *intern, zend_function\n \tfcic.object_ptr = NULL;\n \n \tresult = zend_call_function(&fci, &fcic TSRMLS_CC);\n-\t\n+\n \tif (result == FAILURE) {\n \t\tRETVAL_FALSE;\n \t} else {\n@@ -2159,11 +2159,11 @@ static int spl_filesystem_file_call(spl_filesystem_object *intern, zend_function\n static int spl_filesystem_file_read_csv(spl_filesystem_object *intern, char delimiter, char enclosure, char escape, zval *return_value TSRMLS_DC) \/* {{{ *\/\n {\n \tint ret = SUCCESS;\n-\t\n+\n \tdo {\n \t\tret = spl_filesystem_file_read(intern, 1 TSRMLS_CC);\n \t} while (ret == SUCCESS && !intern->u.file.current_line_len && SPL_HAS_FLAG(intern->flags, SPL_FILE_OBJECT_SKIP_EMPTY));\n-\t\n+\n \tif (ret == SUCCESS) {\n \t\tsize_t buf_len = intern->u.file.current_line_len;\n \t\tchar *buf = estrndup(intern->u.file.current_line, buf_len);\n@@ -2237,7 +2237,7 @@ static int spl_filesystem_file_is_empty_line(spl_filesystem_object *intern TSRML\n \t\t\tif (SPL_HAS_FLAG(intern->flags, SPL_FILE_OBJECT_READ_CSV)\n \t\t\t&& zend_hash_num_elements(Z_ARRVAL_P(intern->u.file.current_zval)) == 1) {\n \t\t\t\tzval ** first = Z_ARRVAL_P(intern->u.file.current_zval)->pListHead->pData;\n-\t\t\t\t\t\n+\n \t\t\t\treturn Z_TYPE_PP(first) == IS_STRING && Z_STRLEN_PP(first) == 0;\n \t\t\t}\n \t\t\treturn zend_hash_num_elements(Z_ARRVAL_P(intern->u.file.current_zval)) == 0;\n@@ -2260,7 +2260,7 @@ static int spl_filesystem_file_read_line(zval * this_ptr, spl_filesystem_object\n \t\tspl_filesystem_file_free_line(intern TSRMLS_CC);\n \t\tret = spl_filesystem_file_read_line_ex(this_ptr, intern, silent TSRMLS_CC);\n \t}\n-\t\n+\n \treturn ret;\n }\n \/* }}} *\/\n@@ -2294,16 +2294,16 @@ SPL_METHOD(SplFileObject, __construct)\n \tintern->u.file.open_mode = NULL;\n \tintern->u.file.open_mode_len = 0;\n \n-\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p|sbr!\", \n+\tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p|sbr!\",\n \t\t\t&intern->file_name, &intern->file_name_len,\n-\t\t\t&intern->u.file.open_mode, &intern->u.file.open_mode_len, \n-\t\t\t&use_include_path, &intern->u.file.zcontext) == FAILURE) {\t\t\n+\t\t\t&intern->u.file.open_mode, &intern->u.file.open_mode_len,\n+\t\t\t&use_include_path, &intern->u.file.zcontext) == FAILURE) {\n \t\tintern->u.file.open_mode = NULL;\n \t\tintern->file_name = NULL;\n \t\tzend_restore_error_handling(&error_handling TSRMLS_CC);\n \t\treturn;\n \t}\n-\t\n+\n \tif (intern->u.file.open_mode == NULL) {\n \t\tintern->u.file.open_mode = \"r\";\n \t\tintern->u.file.open_mode_len = 1;\n@@ -2368,7 +2368,7 @@ SPL_METHOD(SplTempFileObject, __construct)\n \tintern->u.file.open_mode = \"wb\";\n \tintern->u.file.open_mode_len = 1;\n \tintern->u.file.zcontext = NULL;\n-\t\n+\n \tif (spl_filesystem_file_open(intern, 0, 0 TSRMLS_CC) == SUCCESS) {\n \t\tintern->_path_len = 0;\n \t\tintern->_path = estrndup(\"\", 0);\n@@ -2381,7 +2381,7 @@ SPL_METHOD(SplTempFileObject, __construct)\n SPL_METHOD(SplFileObject, rewind)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -2394,7 +2394,7 @@ SPL_METHOD(SplFileObject, rewind)\n SPL_METHOD(SplFileObject, eof)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -2407,7 +2407,7 @@ SPL_METHOD(SplFileObject, eof)\n SPL_METHOD(SplFileObject, valid)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -2424,7 +2424,7 @@ SPL_METHOD(SplFileObject, valid)\n SPL_METHOD(SplFileObject, fgets)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -2440,7 +2440,7 @@ SPL_METHOD(SplFileObject, fgets)\n SPL_METHOD(SplFileObject, current)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -2461,7 +2461,7 @@ SPL_METHOD(SplFileObject, current)\n SPL_METHOD(SplFileObject, key)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -2478,7 +2478,7 @@ SPL_METHOD(SplFileObject, key)\n SPL_METHOD(SplFileObject, next)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -2530,7 +2530,7 @@ SPL_METHOD(SplFileObject, setMaxLineLen)\n \t\tzend_throw_exception_ex(spl_ce_DomainException, 0 TSRMLS_CC, \"Maximum line length must be greater than or equal zero\");\n \t\treturn;\n \t}\n-\t\n+\n \tintern->u.file.max_line_len = max_len;\n } \/* }}} *\/\n \n@@ -2539,7 +2539,7 @@ SPL_METHOD(SplFileObject, setMaxLineLen)\n SPL_METHOD(SplFileObject, getMaxLineLen)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n-\t\n+\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n@@ -2554,7 +2554,7 @@ SPL_METHOD(SplFileObject, hasChildren)\n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\treturn;\n \t}\n-\t\n+\n \tRETURN_FALSE;\n } \/* }}} *\/\n \n@@ -2585,7 +2585,7 @@ SPL_METHOD(SplFileObject, fgetcsv)\n \tchar delimiter = intern->u.file.delimiter, enclosure = intern->u.file.enclosure, escape = intern->u.file.escape;\n \tchar *delim = NULL, *enclo = NULL, *esc = NULL;\n \tint d_len = 0, e_len = 0, esc_len = 0;\n-\t\n+\n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|sss\", &delim, &d_len, &enclo, &e_len, &esc, &esc_len) == SUCCESS) {\n \t\tswitch(ZEND_NUM_ARGS())\n \t\t{\n@@ -2627,7 +2627,7 @@ SPL_METHOD(SplFileObject, fputcsv)\n \tchar *delim = NULL, *enclo = NULL, *esc = NULL;\n \tint d_len = 0, e_len = 0, esc_len = 0, ret;\n \tzval *fields = NULL;\n-\t\n+\n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"a|sss\", &fields, &delim, &d_len, &enclo, &e_len, &esc, &esc_len) == SUCCESS) {\n \t\tswitch(ZEND_NUM_ARGS())\n \t\t{\n@@ -2670,7 +2670,7 @@ SPL_METHOD(SplFileObject, setCsvControl)\n \tchar delimiter = ',', enclosure = '\"', escape='\\\\';\n \tchar *delim = NULL, *enclo = NULL, *esc = NULL;\n \tint d_len = 0, e_len = 0, esc_len = 0;\n-\t\n+\n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|sss\", &delim, &d_len, &enclo, &e_len, &esc, &esc_len) == SUCCESS) {\n \t\tswitch(ZEND_NUM_ARGS())\n \t\t{\n@@ -2713,7 +2713,7 @@ SPL_METHOD(SplFileObject, getCsvControl)\n \tchar delimiter[2], enclosure[2];\n \n \tarray_init(return_value);\n-\t\n+\n \tdelimiter[0] = intern->u.file.delimiter;\n \tdelimiter[1] = '\\0';\n \tenclosure[0] = intern->u.file.enclosure;\n@@ -2742,7 +2742,7 @@ SPL_METHOD(SplFileObject, fflush)\n    Return current file position *\/\n SPL_METHOD(SplFileObject, ftell)\n {\n-\tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\t\n+\tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n \tlong ret = php_stream_tell(intern->u.file.stream);\n \n \tif (ret == -1) {\n@@ -2872,6 +2872,10 @@ SPL_METHOD(SplFileObject, fread)\n \t\tphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"Length parameter must be greater than 0\");\n \t\tRETURN_FALSE;\n \t}\n+\tif (length > INT_MAX) {\n+\t\tphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"Length parameter must be no more than %d\", INT_MAX);\n+\t\tRETURN_FALSE;\n+\t}\n \n \tZ_STRVAL_P(return_value) = emalloc(length + 1);\n \tZ_STRLEN_P(return_value) = php_stream_read(intern->u.file.stream, Z_STRVAL_P(return_value), length);\n@@ -2892,7 +2896,7 @@ SPL_METHOD(SplFileObject, ftruncate)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n \tlong size;\n-\t\n+\n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"l\", &size) == FAILURE) {\n \t\treturn;\n \t}\n@@ -2901,7 +2905,7 @@ SPL_METHOD(SplFileObject, ftruncate)\n \t\tzend_throw_exception_ex(spl_ce_LogicException, 0 TSRMLS_CC, \"Can't truncate file %s\", intern->file_name);\n \t\tRETURN_FALSE;\n \t}\n-\t\n+\n \tRETURN_BOOL(0 == php_stream_truncate_set_size(intern->u.file.stream, size));\n } \/* }}} *\/\n \n@@ -2911,17 +2915,17 @@ SPL_METHOD(SplFileObject, seek)\n {\n \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);\n \tlong line_pos;\n-\t\n+\n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"l\", &line_pos) == FAILURE) {\n \t\treturn;\n \t}\n \tif (line_pos < 0) {\n \t\tzend_throw_exception_ex(spl_ce_LogicException, 0 TSRMLS_CC, \"Can't seek file %s to negative line %ld\", intern->file_name, line_pos);\n-\t\tRETURN_FALSE;\t\t\n+\t\tRETURN_FALSE;\n \t}\n-\t\n+\n \tspl_filesystem_file_rewind(getThis(), intern TSRMLS_CC);\n-\t\n+\n \twhile(intern->u.file.current_line_num < line_pos) {\n \t\tif (spl_filesystem_file_read_line(getThis(), intern, 1 TSRMLS_CC) == FAILURE) {\n \t\t\tbreak;\n@@ -2958,25 +2962,25 @@ ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fputcsv, 0, 0, 1)\n \tZEND_ARG_INFO(0, escape)\n ZEND_END_ARG_INFO()\n \n-ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_flock, 0, 0, 1) \n+ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_flock, 0, 0, 1)\n \tZEND_ARG_INFO(0, operation)\n \tZEND_ARG_INFO(1, wouldblock)\n ZEND_END_ARG_INFO()\n \n-ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fseek, 0, 0, 1) \n+ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fseek, 0, 0, 1)\n \tZEND_ARG_INFO(0, pos)\n \tZEND_ARG_INFO(0, whence)\n ZEND_END_ARG_INFO()\n \n-ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fgetss, 0, 0, 0) \n+ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fgetss, 0, 0, 0)\n \tZEND_ARG_INFO(0, allowable_tags)\n ZEND_END_ARG_INFO()\n \n-ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fscanf, 1, 0, 1) \n+ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fscanf, 1, 0, 1)\n \tZEND_ARG_INFO(0, format)\n ZEND_END_ARG_INFO()\n \n-ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fwrite, 0, 0, 1) \n+ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fwrite, 0, 0, 1)\n \tZEND_ARG_INFO(0, str)\n \tZEND_ARG_INFO(0, length)\n ZEND_END_ARG_INFO()\n@@ -2985,11 +2989,11 @@ ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fread, 0, 0, 1)\n \tZEND_ARG_INFO(0, length)\n ZEND_END_ARG_INFO()\n \n-ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_ftruncate, 0, 0, 1) \n+ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_ftruncate, 0, 0, 1)\n \tZEND_ARG_INFO(0, size)\n ZEND_END_ARG_INFO()\n \n-ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_seek, 0, 0, 1) \n+ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_seek, 0, 0, 1)\n \tZEND_ARG_INFO(0, line_pos)\n ZEND_END_ARG_INFO()\n \n@@ -3078,7 +3082,7 @@ PHP_MINIT_FUNCTION(spl_directory)\n \n \tREGISTER_SPL_SUB_CLASS_EX(RecursiveDirectoryIterator, FilesystemIterator, spl_filesystem_object_new, spl_RecursiveDirectoryIterator_functions);\n \tREGISTER_SPL_IMPLEMENTS(RecursiveDirectoryIterator, RecursiveIterator);\n-\t\n+\n \tmemcpy(&spl_filesystem_object_check_handlers, &spl_filesystem_object_handlers, sizeof(zend_object_handlers));\n \tspl_filesystem_object_check_handlers.get_method = spl_filesystem_object_get_method_check;\n \n@@ -3095,7 +3099,7 @@ PHP_MINIT_FUNCTION(spl_directory)\n \tREGISTER_SPL_CLASS_CONST_LONG(SplFileObject, \"READ_AHEAD\",    SPL_FILE_OBJECT_READ_AHEAD);\n \tREGISTER_SPL_CLASS_CONST_LONG(SplFileObject, \"SKIP_EMPTY\",    SPL_FILE_OBJECT_SKIP_EMPTY);\n \tREGISTER_SPL_CLASS_CONST_LONG(SplFileObject, \"READ_CSV\",      SPL_FILE_OBJECT_READ_CSV);\n-\t\n+\n \tREGISTER_SPL_SUB_CLASS_EX(SplTempFileObject, SplFileObject, spl_filesystem_object_new_check, spl_SplTempFileObject_functions);\n \treturn SUCCESS;\n }\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2016-9262","CWE_ID":"190","category":"security","commit_id":"634ce8e8a5accc0fa05dd2c20d42b4749d4b2735","commit_message":"From 634ce8e8a5accc0fa05dd2c20d42b4749d4b2735 Mon Sep 17 00:00:00 2001\nFrom: Michael Adams <mdadams@ece.uvic.ca>\nDate: Sun, 6 Nov 2016 10:26:16 -0800\nSubject: [PATCH] Made some changes to the I\/O stream library for memory\n streams. There were a number of potential problems due to the possibility of\n integer overflow. Changed some integral types to the larger types size_t or\n ssize_t. For example, the function mem_resize now takes the buffer size\n parameter as a size_t. Added a new function jas_stream_memopen2, which takes\n a buffer size specified as a size_t instead of an int. This can be used in\n jas_image_cmpt_create to avoid potential overflow problems.\n\nAdded a new function jas_deprecated to warn about reliance on\ndeprecated library behavior.\n---\n src\/libjasper\/base\/jas_debug.c            |  19 +++\n src\/libjasper\/base\/jas_image.c            |   2 +-\n src\/libjasper\/base\/jas_stream.c           | 183 ++++++++++++++++++++--\n src\/libjasper\/include\/jasper\/jas_debug.h  |   3 +\n src\/libjasper\/include\/jasper\/jas_stream.h |   6 +-\n 5 files changed, 198 insertions(+), 15 deletions(-)\n\n","diff_code":"diff --git a\/src\/libjasper\/base\/jas_debug.c b\/src\/libjasper\/base\/jas_debug.c\nindex d082f70..42a7480 100644\n--- a\/src\/libjasper\/base\/jas_debug.c\n+++ b\/src\/libjasper\/base\/jas_debug.c\n@@ -135,3 +135,22 @@ int jas_memdump(FILE *out, void *data, size_t len)\n \t}\n \treturn 0;\n }\n+\n+\/******************************************************************************\\\n+* Code.\n+\\******************************************************************************\/\n+\n+void jas_deprecated(const char *s)\n+{\n+\tstatic char message[] =\n+\t\"WARNING!!! WARNING!!! WARNING!!! WARNING!!! WARNING!!! WARNING!!!\\n\"\n+\t\"WARNING!!! WARNING!!! WARNING!!! WARNING!!! WARNING!!! WARNING!!!\\n\"\n+\t\"WARNING!!! WARNING!!! WARNING!!! WARNING!!! WARNING!!! WARNING!!!\\n\"\n+\t\"YOUR CODE IS RELYING ON DEPRECATED FUNCTIONALTIY IN THE JASPER LIBRARY.\\n\"\n+\t\"THIS FUNCTIONALITY WILL BE REMOVED IN THE NEAR FUTURE.\\n\"\n+\t\"PLEASE FIX THIS PROBLEM BEFORE YOUR CODE STOPS WORKING!\\n\"\n+\t;\n+\tjas_eprintf(\"%s\", message);\n+\tjas_eprintf(\"The specific problem is as follows:\\n%s\\n\", s);\n+\t\/\/abort();\n+}\ndiff --git a\/src\/libjasper\/base\/jas_image.c b\/src\/libjasper\/base\/jas_image.c\nindex d011bc5..54702b4 100644\n--- a\/src\/libjasper\/base\/jas_image.c\n+++ b\/src\/libjasper\/base\/jas_image.c\n@@ -347,7 +347,7 @@ static jas_image_cmpt_t *jas_image_cmpt_create(int_fast32_t tlx,\n \t  !jas_safe_size_mul(size, cmpt->cps_, &size)) {\n \t\tgoto error;\n \t}\n-\tcmpt->stream_ = (inmem) ? jas_stream_memopen(0, size) :\n+\tcmpt->stream_ = (inmem) ? jas_stream_memopen2(0, size) :\n \t  jas_stream_tmpfile();\n \tif (!cmpt->stream_) {\n \t\tgoto error;\ndiff --git a\/src\/libjasper\/base\/jas_stream.c b\/src\/libjasper\/base\/jas_stream.c\nindex e3918b9..cb0c894 100644\n--- a\/src\/libjasper\/base\/jas_stream.c\n+++ b\/src\/libjasper\/base\/jas_stream.c\n@@ -169,6 +169,10 @@ static jas_stream_t *jas_stream_create()\n \treturn stream;\n }\n \n+#if 0\n+\n+\/* Obsolete code. *\/\n+\n jas_stream_t *jas_stream_memopen(char *buf, int bufsize)\n {\n \tjas_stream_t *stream;\n@@ -238,6 +242,136 @@ jas_stream_t *jas_stream_memopen(char *buf, int bufsize)\n \treturn stream;\n }\n \n+#else\n+\n+\/*\n+This function will eventually replace jas_stream_memopen.\n+If buf is 0 and bufsize > 0:\n+\ta buffer is dynamically allocated with size bufsize and this buffer is\n+\tnot growable.\n+If buf is 0 and bufsize is 0:\n+\ta buffer is dynamically allocated whose size will automatically grow to\n+\taccommodate the amount of data written.\n+If buf is not 0:\n+\tbufsize (which, in this case, is not currently allowed to be zero) is\n+\tthe size of the (nongrowable) buffer pointed to by buf.\n+*\/\n+\n+jas_stream_t *jas_stream_memopen2(char *buf, size_t bufsize)\n+{\n+\tjas_stream_t *stream;\n+\tjas_stream_memobj_t *obj;\n+\n+\tJAS_DBGLOG(100, (\"jas_stream_memopen2(%p, %zu)\\n\", buf, bufsize));\n+\n+\tassert((buf && bufsize > 0) || (!buf));\n+\n+\tif (!(stream = jas_stream_create())) {\n+\t\treturn 0;\n+\t}\n+\n+\t\/* A stream associated with a memory buffer is always opened\n+\tfor both reading and writing in binary mode. *\/\n+\tstream->openmode_ = JAS_STREAM_READ | JAS_STREAM_WRITE | JAS_STREAM_BINARY;\n+\n+\t\/* Since the stream data is already resident in memory, buffering\n+\tis not necessary. *\/\n+\t\/* But... It still may be faster to use buffering anyways. *\/\n+\tjas_stream_initbuf(stream, JAS_STREAM_FULLBUF, 0, 0);\n+\n+\t\/* Select the operations for a memory stream. *\/\n+\tstream->ops_ = &jas_stream_memops;\n+\n+\t\/* Allocate memory for the underlying memory stream object. *\/\n+\tif (!(obj = jas_malloc(sizeof(jas_stream_memobj_t)))) {\n+\t\tjas_stream_destroy(stream);\n+\t\treturn 0;\n+\t}\n+\tstream->obj_ = (void *) obj;\n+\n+\t\/* Initialize a few important members of the memory stream object. *\/\n+\tobj->myalloc_ = 0;\n+\tobj->buf_ = 0;\n+\n+\t\/* If the buffer size specified is nonpositive, then the buffer\n+\tis allocated internally and automatically grown as needed. *\/\n+\tif (!bufsize) {\n+\t\tobj->bufsize_ = 1024;\n+\t\tobj->growable_ = 1;\n+\t} else {\n+\t\tobj->bufsize_ = bufsize;\n+\t\tobj->growable_ = 0;\n+\t}\n+\tif (buf) {\n+\t\tobj->buf_ = JAS_CAST(unsigned char *, buf);\n+\t} else {\n+\t\tobj->buf_ = jas_malloc(obj->bufsize_);\n+\t\tobj->myalloc_ = 1;\n+\t}\n+\tif (!obj->buf_) {\n+\t\tjas_stream_close(stream);\n+\t\treturn 0;\n+\t}\n+\tJAS_DBGLOG(100, (\"jas_stream_memopen2 buffer buf=%p myalloc=%d\\n\",\n+\t  obj->buf_, obj->myalloc_));\n+\n+\tif (bufsize > 0 && buf) {\n+\t\t\/* If a buffer was supplied by the caller and its length is positive,\n+\t\t  make the associated buffer data appear in the stream initially. *\/\n+\t\tobj->len_ = bufsize;\n+\t} else {\n+\t\t\/* The stream is initially empty. *\/\n+\t\tobj->len_ = 0;\n+\t}\n+\tobj->pos_ = 0;\n+\t\n+\treturn stream;\n+}\n+\n+\/*\n+NOTE:\n+The version of the function jas_stream_memopen only exists for backwards\n+compatibility.\n+Eventually, it should be replaced by jas_stream_memopen2.\n+In retrospect, it was a very poor choice to have specified the buffer\n+size parameter (bufsize) to have type int.  On some machines, int may only\n+be a 16-bit integer.  This precludes larger-sized buffer allocations, which\n+are needed in practice.\n+\n+If bufsize <= 0, the buffer is growable; otherwise, the buffer has a fixed\n+size of bufsize.\n+If buf is 0, the buffer is dynamically allocated with jas_malloc.\n+If buf is not 0 and bufsize <= 0 (which is not permitted in any\n+circumstances), bad things will happen (especially if the buf was not\n+allocated with jas_malloc).\n+*\/\n+jas_stream_t *jas_stream_memopen(char *buf, int bufsize)\n+{\n+\tchar *new_buf;\n+\tsize_t new_bufsize;\n+\n+\tJAS_DBGLOG(100, (\"jas_stream_memopen(%p, %d)\\n\", buf, bufsize));\n+\tif (bufsize < 0) {\n+\t\tjas_deprecated(\"negative buffer size for jas_stream_memopen\");\n+\t}\n+\tif (buf && bufsize <= 0) {\n+\t\t\/\/ This was never a valid thing to do with the old API.\n+\t\tjas_eprintf(\"Invalid use of jas_stream_memopen detected.\\n\");\n+\t\tjas_deprecated(\"A user-provided buffer for \"\n+\t\t  \"jas_stream_memopen cannot be growable.\\n\");\n+\t}\n+\tif (bufsize <= 0) {\n+\t\tnew_bufsize = 0;\n+\t\tnew_buf = 0;\n+\t} else {\n+\t\tnew_bufsize = bufsize;\n+\t\tnew_buf = buf;\n+\t}\n+\treturn jas_stream_memopen2(new_buf, new_bufsize);\n+}\n+\n+#endif\n+\n jas_stream_t *jas_stream_fopen(const char *filename, const char *mode)\n {\n \tjas_stream_t *stream;\n@@ -520,6 +654,10 @@ int jas_stream_read(jas_stream_t *stream, void *buf, int cnt)\n \tint c;\n \tchar *bufptr;\n \n+\tif (cnt < 0) {\n+\t\tjas_deprecated(\"negative count for jas_stream_read\");\n+\t}\n+\n \tbufptr = buf;\n \n \tn = 0;\n@@ -539,6 +677,10 @@ int jas_stream_write(jas_stream_t *stream, const void *buf, int cnt)\n \tint n;\n \tconst char *bufptr;\n \n+\tif (cnt < 0) {\n+\t\tjas_deprecated(\"negative count for jas_stream_write\");\n+\t}\n+\n \tbufptr = buf;\n \n \tn = 0;\n@@ -604,6 +746,9 @@ char *jas_stream_gets(jas_stream_t *stream, char *buf, int bufsize)\n int jas_stream_gobble(jas_stream_t *stream, int n)\n {\n \tint m;\n+\tif (n < 0) {\n+\t\tjas_deprecated(\"negative count for jas_stream_gobble\");\n+\t}\n \tm = n;\n \tfor (m = n; m > 0; --m) {\n \t\tif (jas_stream_getc(stream) == EOF) {\n@@ -616,6 +761,9 @@ int jas_stream_gobble(jas_stream_t *stream, int n)\n int jas_stream_pad(jas_stream_t *stream, int n, int c)\n {\n \tint m;\n+\tif (n < 0) {\n+\t\tjas_deprecated(\"negative count for jas_stream_pad\");\n+\t}\n \tm = n;\n \tfor (m = n; m > 0; --m) {\n \t\tif (jas_stream_putc(stream, c) == EOF)\n@@ -988,7 +1136,7 @@ long jas_stream_length(jas_stream_t *stream)\n \n static int mem_read(jas_stream_obj_t *obj, char *buf, int cnt)\n {\n-\tint n;\n+\tssize_t n;\n \tassert(cnt >= 0);\n \tassert(buf);\n \n@@ -1001,14 +1149,21 @@ static int mem_read(jas_stream_obj_t *obj, char *buf, int cnt)\n \treturn cnt;\n }\n \n-static int mem_resize(jas_stream_memobj_t *m, int bufsize)\n+static int mem_resize(jas_stream_memobj_t *m, size_t bufsize)\n {\n \tunsigned char *buf;\n \n \t\/\/assert(m->buf_);\n-\tassert(bufsize >= 0);\n+\t\/\/assert(bufsize >= 0);\n+\n+\tJAS_DBGLOG(100, (\"mem_resize(%p, %zu)\\n\", m, bufsize));\n+\tif (!bufsize) {\n+\t\tjas_eprintf(\n+\t\t  \"mem_resize was not really designed to handle a buffer of size 0\\n\"\n+\t\t  \"This may not work.\\n\"\n+\t\t);\n+\t}\n \n-\tJAS_DBGLOG(100, (\"mem_resize(%p, %d)\\n\", m, bufsize));\n \tif (!(buf = jas_realloc2(m->buf_, bufsize, sizeof(unsigned char))) &&\n \t  bufsize) {\n \t\tJAS_DBGLOG(100, (\"mem_resize realloc failed\\n\"));\n@@ -1022,11 +1177,11 @@ static int mem_resize(jas_stream_memobj_t *m, int bufsize)\n \n static int mem_write(jas_stream_obj_t *obj, char *buf, int cnt)\n {\n-\tint n;\n+\tsize_t n;\n \tint ret;\n \tjas_stream_memobj_t *m = (jas_stream_memobj_t *)obj;\n-\tlong newbufsize;\n-\tlong newpos;\n+\tsize_t newbufsize;\n+\tsize_t newpos;\n \n \tassert(buf);\n \tassert(cnt >= 0);\n@@ -1036,13 +1191,15 @@ static int mem_write(jas_stream_obj_t *obj, char *buf, int cnt)\n \tif (newpos > m->bufsize_ && m->growable_) {\n \t\tnewbufsize = m->bufsize_;\n \t\twhile (newbufsize < newpos) {\n-\t\t\tnewbufsize <<= 1;\n-\t\t\tassert(newbufsize >= 0);\n+\t\t\t\/\/newbufsize <<= 1;\n+\t\t\tif (!jas_safe_size_mul(newbufsize, 2, &newbufsize)) {\n+\t\t\t\tJAS_DBGLOG(100, (\"new buffer size would cause overflow\\n\"));\n+\t\t\t\treturn -1;\n+\t\t\t}\n \t\t}\n-\t\tJAS_DBGLOG(100, (\"mem_write resizing from %d to %z\\n\", m->bufsize_,\n+\t\tJAS_DBGLOG(100, (\"mem_write resizing from %d to %zu\\n\", m->bufsize_,\n \t\t  newbufsize));\n-\t\tJAS_DBGLOG(100, (\"mem_write resizing from %d to %ul\\n\", m->bufsize_,\n-\t\t  JAS_CAST(unsigned long, newbufsize)));\n+\t\tassert(newbufsize > 0);\n \t\tif (mem_resize(m, newbufsize)) {\n \t\t\treturn -1;\n \t\t}\n@@ -1076,7 +1233,7 @@ static int mem_write(jas_stream_obj_t *obj, char *buf, int cnt)\n static long mem_seek(jas_stream_obj_t *obj, long offset, int origin)\n {\n \tjas_stream_memobj_t *m = (jas_stream_memobj_t *)obj;\n-\tlong newpos;\n+\tsize_t newpos;\n \n \tJAS_DBGLOG(100, (\"mem_seek(%p, %ld, %d)\\n\", obj, offset, origin));\n \tswitch (origin) {\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_debug.h b\/src\/libjasper\/include\/jasper\/jas_debug.h\nindex 1619a5a..6b78112 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_debug.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_debug.h\n@@ -107,6 +107,9 @@ int jas_eprintf(const char *fmt, ...);\n \/* Dump memory to a stream. *\/\n int jas_memdump(FILE *out, void *data, size_t len);\n \n+\/* Warn about use of deprecated functionality. *\/\n+void jas_deprecated(const char *s);\n+\n #ifdef __cplusplus\n }\n #endif\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_stream.h b\/src\/libjasper\/include\/jasper\/jas_stream.h\nindex 651bea9..b9801d8 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_stream.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_stream.h\n@@ -267,7 +267,7 @@ typedef struct {\n \tuchar *buf_;\n \n \t\/* The allocated size of the buffer for holding file data. *\/\n-\tint bufsize_;\n+\tsize_t bufsize_;\n \n \t\/* The length of the file. *\/\n \tint_fast32_t len_;\n@@ -293,6 +293,10 @@ jas_stream_t *jas_stream_fopen(const char *filename, const char *mode);\n \/* Open a memory buffer as a stream. *\/\n jas_stream_t *jas_stream_memopen(char *buf, int bufsize);\n \n+\/* Do not use this function.\n+It will eventually replace jas_stream_memopen. *\/\n+jas_stream_t *jas_stream_memopen2(char *buf, size_t bufsize);\n+\n \/* Open a file descriptor as a stream. *\/\n jas_stream_t *jas_stream_fdopen(int fd, const char *mode);\n \n","owner":"mdadams","repo":"jasper","source":"cve"},{"CVE_ID":"CVE-2016-9445","CWE_ID":"190","category":"security","commit_id":"4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe","commit_message":"From 4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Sebastian=20Dr=C3=B6ge?= <sebastian@centricular.com>\nDate: Wed, 16 Nov 2016 20:41:39 +0200\nSubject: vmncdec: Sanity-check width\/height before using it\n\nWe will allocate a screen area of width*height*bpp bytes, however this\ncalculation can easily overflow if too high width or height are given\ninside the stream. Nonetheless we would just assume that enough memory\nwas allocated, try to fill it and overwrite as much memory as wanted.\n\nAlso allocate the screen area filled with zeroes to ensure that we start\nwith full-black and not any random (or not so random) data.\n\nhttps:\/\/scarybeastsecurity.blogspot.gr\/2016\/11\/0day-poc-risky-design-decisions-in.html\n\nIdeally we should just remove this plugin in favour of the one in\ngst-libav, which generally seems to be of better code quality.\n\nhttps:\/\/bugzilla.gnome.org\/show_bug.cgi?id=774533\n---\n gst\/vmnc\/vmncdec.c | 6 +++++-\n 1 file changed, 5 insertions(+), 1 deletion(-)\n\n(limited to 'gst\/vmnc\/vmncdec.c')\n\n","diff_code":"diff --git a\/gst\/vmnc\/vmncdec.c b\/gst\/vmnc\/vmncdec.c\nindex e8d498c..b3c9778 100644\n--- a\/gst\/vmnc\/vmncdec.c\n+++ b\/gst\/vmnc\/vmncdec.c\n@@ -260,7 +260,7 @@ vmnc_handle_wmvi_rectangle (GstVMncDec * dec, struct RfbRectangle *rect,\n   gst_video_codec_state_unref (state);\n \n   g_free (dec->imagedata);\n-  dec->imagedata = g_malloc (dec->format.width * dec->format.height *\n+  dec->imagedata = g_malloc0 (dec->format.width * dec->format.height *\n       dec->format.bytes_per_pixel);\n   GST_DEBUG_OBJECT (dec, \"Allocated image data at %p\", dec->imagedata);\n \n@@ -790,6 +790,10 @@ vmnc_handle_packet (GstVMncDec * dec, const guint8 * data, int len,\n             GST_WARNING_OBJECT (dec, \"Rectangle out of range, type %d\", r.type);\n             return ERROR_INVALID;\n           }\n+        } else if (r.width > 16384 || r.height > 16384) {\n+          GST_WARNING_OBJECT (dec, \"Width or height too high: %ux%u\", r.width,\n+              r.height);\n+          return ERROR_INVALID;\n         }\n \n         switch (r.type) {\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-8098","CWE_ID":"190","category":"security","commit_id":"3207ddb0103543da8ad2139ec6539f590f9900c1","commit_message":"From 3207ddb0103543da8ad2139ec6539f590f9900c1 Mon Sep 17 00:00:00 2001\nFrom: Patrick Steinhardt <ps@pks.im>\nDate: Thu, 8 Mar 2018 12:00:27 +0000\nSubject: [PATCH] index: fix out-of-bounds read with invalid index entry prefix\n length\n\nThe index format in version 4 has prefix-compressed entries, where every\nindex entry can compress its path by using a path prefix of the previous\nentry. Since implmenting support for this index format version in commit\n5625d86b9 (index: support index v4, 2016-05-17), though, we do not\ncorrectly verify that the prefix length that we want to reuse is\nactually smaller or equal to the amount of characters than the length of\nthe previous index entry's path. This can lead to a an integer underflow\nand subsequently to an out-of-bounds read.\n\nFix this by verifying that the prefix is actually smaller than the\nprevious entry's path length.\n\nReported-by: Krishna Ram Prakash R <krp@gtux.in>\nReported-by: Vivek Parikh <viv0411.parikh@gmail.com>\n---\n src\/index.c | 19 ++++++++++---------\n 1 file changed, 10 insertions(+), 9 deletions(-)\n\n","diff_code":"diff --git a\/src\/index.c b\/src\/index.c\nindex 3ef892b7f1..20586f52c3 100644\n--- a\/src\/index.c\n+++ b\/src\/index.c\n@@ -2365,17 +2365,18 @@ static int read_entry(\n \t\tentry_size = index_entry_size(path_length, 0, entry.flags);\n \t\tentry.path = (char *)path_ptr;\n \t} else {\n-\t\tsize_t varint_len;\n-\t\tsize_t strip_len = git_decode_varint((const unsigned char *)path_ptr,\n-\t\t\t\t\t\t     &varint_len);\n-\t\tsize_t last_len = strlen(last);\n-\t\tsize_t prefix_len = last_len - strip_len;\n-\t\tsize_t suffix_len = strlen(path_ptr + varint_len);\n-\t\tsize_t path_len;\n-\n-\t\tif (varint_len == 0)\n+\t\tsize_t varint_len, last_len, prefix_len, suffix_len, path_len;\n+\t\tuintmax_t strip_len;\n+\n+\t\tstrip_len = git_decode_varint((const unsigned char *)path_ptr, &varint_len);\n+\t\tlast_len = strlen(last);\n+\n+\t\tif (varint_len == 0 || last_len < strip_len)\n \t\t\treturn index_error_invalid(\"incorrect prefix length\");\n \n+\t\tprefix_len = last_len - strip_len;\n+\t\tsuffix_len = strlen(path_ptr + varint_len);\n+\n \t\tGITERR_CHECK_ALLOC_ADD(&path_len, prefix_len, suffix_len);\n \t\tGITERR_CHECK_ALLOC_ADD(&path_len, path_len, 1);\n \t\ttmp_path = git__malloc(path_len);\n","owner":"libgit2","repo":"libgit2","source":"cve"},{"CVE_ID":"CVE-2018-8800","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2018-11590","CWE_ID":"190","category":"security","commit_id":"a0d7f432abee692402c00e8b615ff5982dde9780","commit_message":"From a0d7f432abee692402c00e8b615ff5982dde9780 Mon Sep 17 00:00:00 2001\nFrom: Gordon Williams <gw@pur3.co.uk>\nDate: Mon, 21 May 2018 09:54:07 +0100\nSubject: [PATCH] Fix stack size detection on Linux (fix #1427)\n\n---\n ChangeLog     | 1 +\n src\/jsutils.c | 4 +++-\n 2 files changed, 4 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/ChangeLog b\/ChangeLog\nindex 0887a9bd4..a857a1621 100644\n--- a\/ChangeLog\n+++ b\/ChangeLog\n@@ -1,6 +1,7 @@\n             Increase jslMatch error buffer size to handle \"UNFINISHED TEMPLATE LITERAL\" string (#1426)\n             nRF5x: Make FlashWrite cope with flash writes > 4k\n             Increase max size of native strings on platforms that support it - 16 bit to 32 bit (#1432)\n+            Fix stack size detection on Linux (fix #1427)\n \n      1v98 : Allow Crypto SHA1 without SHA256\/512 (for ESP8266 where flash is scarce)\n             Add better docs for the form of Wifi callback functions\ndiff --git a\/src\/jsutils.c b\/src\/jsutils.c\nindex 7b706f5f7..be879cc19 100644\n--- a\/src\/jsutils.c\n+++ b\/src\/jsutils.c\n@@ -844,7 +844,9 @@ size_t jsuGetFreeStack() {\n   char ptr; \/\/ this is on the stack\n   extern void *STACK_BASE;\n   uint32_t count =  (uint32_t)((size_t)STACK_BASE - (size_t)&ptr);\n-  return 1000000 - count; \/\/ give it 1 megabyte of stack\n+  const uint32_t max_stack = 1000000; \/\/ give it 1 megabyte of stack\n+  if (count>max_stack) return 0;\n+  return max_stack - count;\n #else\n   \/\/ stack depth seems pretty platform-specific :( Default to a value that disables it\n   return 1000000; \/\/ no stack depth check on this platform\n","owner":"espruino","repo":"Espruino","source":"cve"},{"CVE_ID":"CVE-2016-5842","CWE_ID":"190","category":"security","commit_id":"d8ab7f046587f2e9f734b687ba7e6e10147c294b","commit_message":"From d8ab7f046587f2e9f734b687ba7e6e10147c294b Mon Sep 17 00:00:00 2001\nFrom: Cristy <urban-warrior@imagemagick.org>\nDate: Tue, 21 Jun 2016 21:13:18 -0400\nSubject: [PATCH] Improve checking of EXIF profile to prevent integer overflow\n (bug report from Ibrahim el-sayed)\n\n---\n MagickCore\/profile.c  | 47 ++++++++++++++++----------\n MagickCore\/property.c | 76 +++++++++++++++++++++++++------------------\n 2 files changed, 74 insertions(+), 49 deletions(-)\n\n","diff_code":"diff --git a\/MagickCore\/profile.c b\/MagickCore\/profile.c\nindex 1fb384d8e7..51d887902b 100644\n--- a\/MagickCore\/profile.c\n+++ b\/MagickCore\/profile.c\n@@ -1351,20 +1351,22 @@ static inline const unsigned char *ReadResourceByte(const unsigned char *p,\n static inline const unsigned char *ReadResourceLong(const unsigned char *p,\n   unsigned int *quantum)\n {\n-  *quantum=(size_t) (*p++ << 24);\n-  *quantum|=(size_t) (*p++ << 16);\n-  *quantum|=(size_t) (*p++ << 8);\n-  *quantum|=(size_t) (*p++ << 0);\n+  *quantum=(unsigned int) (*p++) << 24;\n+  *quantum|=(unsigned int) (*p++) << 16;\n+  *quantum|=(unsigned int) (*p++) << 8;\n+  *quantum|=(unsigned int) (*p++) << 0;\n   return(p);\n }\n \n static inline const unsigned char *ReadResourceShort(const unsigned char *p,\n   unsigned short *quantum)\n {\n-  *quantum=(unsigned short) (*p++ << 8);\n-  *quantum|=(unsigned short) (*p++ << 0);\n+  *quantum=(unsigned short) (*p++) << 8;\n+  *quantum|=(unsigned short) (*p++);\n   return(p);\n-}static inline void WriteResourceLong(unsigned char *p,\n+}\n+\n+static inline void WriteResourceLong(unsigned char *p,\n   const unsigned int quantum)\n {\n   unsigned char\n@@ -1731,13 +1733,14 @@ static inline signed short ReadProfileShort(const EndianType endian,\n \n   if (endian == LSBEndian)\n     {\n-      value=(unsigned short) ((buffer[1] << 8) | buffer[0]);\n-      quantum.unsigned_value=(value & 0xffff);\n+      value=(unsigned short) buffer[1] << 8;\n+      value|=(unsigned short) buffer[0];\n+      quantum.unsigned_value=value & 0xffff;\n       return(quantum.signed_value);\n     }\n-  value=(unsigned short) ((((unsigned char *) buffer)[0] << 8) |\n-    ((unsigned char *) buffer)[1]);\n-  quantum.unsigned_value=(value & 0xffff);\n+  value=(unsigned short) buffer[0] << 8;\n+  value|=(unsigned short) buffer[1];\n+  quantum.unsigned_value=value & 0xffff;\n   return(quantum.signed_value);\n }\n \n@@ -1758,14 +1761,18 @@ static inline signed int ReadProfileLong(const EndianType endian,\n \n   if (endian == LSBEndian)\n     {\n-      value=(unsigned int) ((buffer[3] << 24) | (buffer[2] << 16) |\n-        (buffer[1] << 8 ) | (buffer[0]));\n-      quantum.unsigned_value=(value & 0xffffffff);\n+      value=(unsigned int) buffer[3] << 24;\n+      value|=(unsigned int) buffer[2] << 16;\n+      value|=(unsigned int) buffer[1] << 8;\n+      value|=(unsigned int) buffer[0];\n+      quantum.unsigned_value=value & 0xffffffff;\n       return(quantum.signed_value);\n     }\n-  value=(unsigned int) ((buffer[0] << 24) | (buffer[1] << 16) |\n-    (buffer[2] << 8) | buffer[3]);\n-  quantum.unsigned_value=(value & 0xffffffff);\n+  value=(unsigned int) buffer[0] << 24;\n+  value|=(unsigned int) buffer[1] << 16;\n+  value|=(unsigned int) buffer[2] << 8;\n+  value|=(unsigned int) buffer[3];\n+  quantum.unsigned_value=value & 0xffffffff;\n   return(quantum.signed_value);\n }\n \n@@ -2017,11 +2024,15 @@ MagickBooleanType SyncExifProfile(Image *image,StringInfo *profile)\n         tag_value;\n \n       q=(unsigned char *) (directory+2+(12*entry));\n+      if (q > (exif+length-12))\n+        break;  \/* corrupt EXIF *\/\n       tag_value=(ssize_t) ReadProfileShort(endian,q);\n       format=(ssize_t) ReadProfileShort(endian,q+2);\n       if ((format-1) >= EXIF_NUM_FORMATS)\n         break;\n       components=(ssize_t) ReadProfileLong(endian,q+4);\n+      if (components < 0)\n+        break;  \/* corrupt EXIF *\/\n       number_bytes=(size_t) components*format_bytes[format];\n       if ((ssize_t) number_bytes < components)\n         break;  \/* prevent overflow *\/\ndiff --git a\/MagickCore\/property.c b\/MagickCore\/property.c\nindex 082ae7ea39..ca5c5fe0bc 100644\n--- a\/MagickCore\/property.c\n+++ b\/MagickCore\/property.c\n@@ -520,7 +520,7 @@ static inline signed int ReadPropertyMSBLong(const unsigned char **p,\n   unsigned char\n     buffer[4];\n \n-  size_t\n+  unsigned int\n     value;\n \n   if (*length < 4)\n@@ -531,11 +531,11 @@ static inline signed int ReadPropertyMSBLong(const unsigned char **p,\n     (*length)--;\n     buffer[i]=(unsigned char) c;\n   }\n-  value=(size_t) (buffer[0] << 24);\n-  value|=buffer[1] << 16;\n-  value|=buffer[2] << 8;\n-  value|=buffer[3];\n-  quantum.unsigned_value=(value & 0xffffffff);\n+  value=(unsigned int) buffer[0] << 24;\n+  value|=(unsigned int) buffer[1] << 16;\n+  value|=(unsigned int) buffer[2] << 8;\n+  value|=(unsigned int) buffer[3];\n+  quantum.unsigned_value=value & 0xffffffff;\n   return(quantum.signed_value);\n }\n \n@@ -571,9 +571,9 @@ static inline signed short ReadPropertyMSBShort(const unsigned char **p,\n     (*length)--;\n     buffer[i]=(unsigned char) c;\n   }\n-  value=(unsigned short) (buffer[0] << 8);\n-  value|=buffer[1];\n-  quantum.unsigned_value=(value & 0xffff);\n+  value=(unsigned short) buffer[0] << 8;\n+  value|=(unsigned short) buffer[1];\n+  quantum.unsigned_value=value & 0xffff;\n   return(quantum.signed_value);\n }\n \n@@ -742,14 +742,18 @@ static inline signed int ReadPropertySignedLong(const EndianType endian,\n \n   if (endian == LSBEndian)\n     {\n-      value=(unsigned int) ((buffer[3] << 24) | (buffer[2] << 16) |\n-        (buffer[1] << 8 ) | (buffer[0]));\n-      quantum.unsigned_value=(value & 0xffffffff);\n+      value=(unsigned int) buffer[3] << 24;\n+      value|=(unsigned int) buffer[2] << 16;\n+      value|=(unsigned int) buffer[1] << 8;\n+      value|=(unsigned int) buffer[0];\n+      quantum.unsigned_value=value & 0xffffffff;\n       return(quantum.signed_value);\n     }\n-  value=(unsigned int) ((buffer[0] << 24) | (buffer[1] << 16) |\n-    (buffer[2] << 8) | buffer[3]);\n-  quantum.unsigned_value=(value & 0xffffffff);\n+  value=(unsigned int) buffer[0] << 24;\n+  value|=(unsigned int) buffer[1] << 16;\n+  value|=(unsigned int) buffer[2] << 8;\n+  value|=(unsigned int) buffer[3];\n+  quantum.unsigned_value=value & 0xffffffff;\n   return(quantum.signed_value);\n }\n \n@@ -761,13 +765,17 @@ static inline unsigned int ReadPropertyUnsignedLong(const EndianType endian,\n \n   if (endian == LSBEndian)\n     {\n-      value=(unsigned int) ((buffer[3] << 24) | (buffer[2] << 16) |\n-        (buffer[1] << 8 ) | (buffer[0]));\n-      return((unsigned int) (value & 0xffffffff));\n+      value=(unsigned int) buffer[3] << 24;\n+      value|=(unsigned int) buffer[2] << 16;\n+      value|=(unsigned int) buffer[1] << 8;\n+      value|=(unsigned int) buffer[0];\n+      return(value & 0xffffffff);\n     }\n-  value=(unsigned int) ((buffer[0] << 24) | (buffer[1] << 16) |\n-    (buffer[2] << 8) | buffer[3]);\n-  return((unsigned int) (value & 0xffffffff));\n+  value=(unsigned int) buffer[0] << 24;\n+  value|=(unsigned int) buffer[1] << 16;\n+  value|=(unsigned int) buffer[2] << 8;\n+  value|=(unsigned int) buffer[3];\n+  return(value & 0xffffffff);\n }   \n \n static inline signed short ReadPropertySignedShort(const EndianType endian,\n@@ -787,13 +795,14 @@ static inline signed short ReadPropertySignedShort(const EndianType endian,\n \n   if (endian == LSBEndian)\n     {\n-      value=(unsigned short) ((buffer[1] << 8) | buffer[0]);\n-      quantum.unsigned_value=(value & 0xffff);\n+      value=(unsigned short) buffer[1] << 8;\n+      value|=(unsigned short) buffer[0];\n+      quantum.unsigned_value=value & 0xffff;\n       return(quantum.signed_value);\n     }\n-  value=(unsigned short) ((((unsigned char *) buffer)[0] << 8) |\n-    ((unsigned char *) buffer)[1]);\n-  quantum.unsigned_value=(value & 0xffff);\n+  value=(unsigned short) buffer[0] << 8;\n+  value|=(unsigned short) buffer[1];\n+  quantum.unsigned_value=value & 0xffff;\n   return(quantum.signed_value);\n }\n \n@@ -805,12 +814,13 @@ static inline unsigned short ReadPropertyUnsignedShort(const EndianType endian,\n \n   if (endian == LSBEndian)\n     {\n-      value=(unsigned short) ((buffer[1] << 8) | buffer[0]);\n-      return((unsigned short) (value & 0xffff));\n+      value=(unsigned short) buffer[1] << 8;\n+      value|=(unsigned short) buffer[0];\n+      return(value & 0xffff);\n     }\n-  value=(unsigned short) ((((unsigned char *) buffer)[0] << 8) |\n-    ((unsigned char *) buffer)[1]);\n-  return((unsigned short) (value & 0xffff));\n+  value=(unsigned short) buffer[0] << 8;\n+  value|=(unsigned short) buffer[1];\n+  return(value & 0xffff);\n }\n \n static MagickBooleanType GetEXIFProperty(const Image *image,\n@@ -1394,6 +1404,8 @@ static MagickBooleanType GetEXIFProperty(const Image *image,\n         components;\n \n       q=(unsigned char *) (directory+(12*entry)+2);\n+      if (q > (exif+length-12))\n+        break;  \/* corrupt EXIF *\/\n       if (GetValueFromSplayTree(exif_resources,q) == q)\n         break;\n       (void) AddValueToSplayTree(exif_resources,q,q);\n@@ -1402,6 +1414,8 @@ static MagickBooleanType GetEXIFProperty(const Image *image,\n       if (format >= (sizeof(tag_bytes)\/sizeof(*tag_bytes)))\n         break;\n       components=(ssize_t) ReadPropertySignedLong(endian,q+4);\n+      if (components < 0)\n+        break;  \/* corrupt EXIF *\/\n       number_bytes=(size_t) components*tag_bytes[format];\n       if (number_bytes < components)\n         break;  \/* prevent overflow *\/\n","owner":"ImageMagick","repo":"ImageMagick","source":"cve"},{"CVE_ID":"CVE-2016-5767","CWE_ID":"190","category":"security","commit_id":"c395c6e5d7e8df37a21265ff76e48fe75ceb5ae6","commit_message":"From c395c6e5d7e8df37a21265ff76e48fe75ceb5ae6 Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Mon, 20 Jun 2016 23:58:26 -0700\nSubject: [PATCH] iFixed bug #72446 - Integer Overflow in\n gdImagePaletteToTrueColor() resulting in heap overflow\n\n---\n NEWS              |  2 ++\n ext\/gd\/libgd\/gd.c | 22 +++++++++++++---------\n 2 files changed, 15 insertions(+), 9 deletions(-)\n\n","diff_code":"diff --git a\/NEWS b\/NEWS\nindex fffc443a7cf3..6f1461c2f9e2 100644\n--- a\/NEWS\n+++ b\/NEWS\n@@ -18,6 +18,8 @@ PHP                                                                        NEWS\n   . Fixed bug #72339 (Integer Overflow in _gd2GetHeader() resulting in \n     heap overflow). (Pierre)\n   . Fixed bug #72407 (NULL Pointer Dereference at _gdScaleVert). (Stas)\n+  . Fixed bug #72446 (Integer Overflow in gdImagePaletteToTrueColor() resulting\n+    in heap overflow). (Pierre)\n \n - mbstring:\n    . Fixed bug #72402 (_php_mb_regex_ereg_replace_exec - double free). (Stas)\ndiff --git a\/ext\/gd\/libgd\/gd.c b\/ext\/gd\/libgd\/gd.c\nindex 2c63aac4cd4a..4dad95ae3930 100644\n--- a\/ext\/gd\/libgd\/gd.c\n+++ b\/ext\/gd\/libgd\/gd.c\n@@ -133,6 +133,10 @@ gdImagePtr gdImageCreate (int sx, int sy)\n \t\treturn NULL;\n \t}\n \n+\tif (overflow2(sizeof(unsigned char *), sx)) {\n+\t\treturn NULL;\n+\t}\n+\n \tim = (gdImage *) gdCalloc(1, sizeof(gdImage));\n \n \t\/* Row-major ever since gd 1.3 *\/\n@@ -1098,12 +1102,12 @@ void gdImageLine (gdImagePtr im, int x1, int y1, int x2, int y2, int color)\n \tint thick = im->thick;\n \n \tif (color == gdAntiAliased) {\n-\t\t\/* \n+\t\t\/*\n \t\t   gdAntiAliased passed as color: use the much faster, much cheaper\n \t\t   and equally attractive gdImageAALine implementation. That\n \t\t   clips too, so don't clip twice.\n \t\t   *\/\n-\t\tgdImageAALine(im, x1, y1, x2, y2, im->AA_color); \n+\t\tgdImageAALine(im, x1, y1, x2, y2, im->AA_color);\n \t\treturn;\n \t}\n \n@@ -1880,7 +1884,7 @@ void gdImageFill(gdImagePtr im, int x, int y, int nc)\n \t\treturn;\n \t}\n \n-\talphablending_bak = im->alphaBlendingFlag;\t\n+\talphablending_bak = im->alphaBlendingFlag;\n \tim->alphaBlendingFlag = 0;\n \n \tif (nc==gdTiled){\n@@ -1892,7 +1896,7 @@ void gdImageFill(gdImagePtr im, int x, int y, int nc)\n \twx2=im->sx;wy2=im->sy;\n \toc = gdImageGetPixel(im, x, y);\n \tif (oc==nc || x<0 || x>wx2 || y<0 || y>wy2) {\n-\t\tim->alphaBlendingFlag = alphablending_bak;\t\n+\t\tim->alphaBlendingFlag = alphablending_bak;\n \t\treturn;\n \t}\n \n@@ -1955,7 +1959,7 @@ skip:\t\t\tfor (x++; x<=x2 && (gdImageGetPixel(im, x, y)!=oc); x++);\n \tefree(stack);\n \n done:\n-\tim->alphaBlendingFlag = alphablending_bak;\t\n+\tim->alphaBlendingFlag = alphablending_bak;\n }\n \n static void _gdImageFillTiled(gdImagePtr im, int x, int y, int nc)\n@@ -2061,7 +2065,7 @@ void gdImageRectangle (gdImagePtr im, int x1, int y1, int x2, int y2, int color)\n \n \t\tx1ul = x1 - half;\n \t\ty1ul = y1 - half;\n-\t\t\n+\n \t\tx2lr = x2 + half;\n \t\ty2lr = y2 + half;\n \n@@ -2259,7 +2263,7 @@ void gdImageCopyMerge (gdImagePtr dst, gdImagePtr src, int dstX, int dstY, int s\n \tint tox, toy;\n \tint ncR, ncG, ncB;\n \ttoy = dstY;\n-\t\n+\n \tfor (y = srcY; y < (srcY + h); y++) {\n \t\ttox = dstX;\n \t\tfor (x = srcX; x < (srcX + w); x++) {\n@@ -2356,7 +2360,7 @@ void gdImageCopyResized (gdImagePtr dst, gdImagePtr src, int dstX, int dstY, int\n \tint colorMap[gdMaxColors];\n \t\/* Stretch vectors *\/\n \tint *stx, *sty;\n-\t\n+\n \tif (overflow2(sizeof(int), srcW)) {\n \t\treturn;\n \t}\n@@ -2901,7 +2905,7 @@ int gdAlphaBlend (int dst, int src) {\n     src_weight = gdAlphaTransparent - src_alpha;\n     dst_weight = (gdAlphaTransparent - dst_alpha) * src_alpha \/ gdAlphaMax;\n     tot_weight = src_weight + dst_weight;\n-    \n+\n \/* -------------------------------------------------------------------- *\/\n \/*      What red, green and blue result values will we use?             *\/\n \/* -------------------------------------------------------------------- *\/\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2018-5816","CWE_ID":"190","category":"security","commit_id":"1d8d1b452e5dc74033ee9f846081a0efb616cc39","commit_message":"From 1d8d1b452e5dc74033ee9f846081a0efb616cc39 Mon Sep 17 00:00:00 2001\nFrom: Alex Tutubalin <lexa@lexa.ru>\nDate: Mon, 11 Jun 2018 13:05:32 +0300\nSubject: [PATCH] reject broken\/crafted NOKIARAW files\n\n---\n dcraw\/dcraw.c             | 5 ++++-\n internal\/dcraw_common.cpp | 5 ++++-\n 2 files changed, 8 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/dcraw\/dcraw.c b\/dcraw\/dcraw.c\nindex 364869cf..c22f98a9 100644\n--- a\/dcraw\/dcraw.c\n+++ b\/dcraw\/dcraw.c\n@@ -15738,7 +15738,10 @@ void CLASS identify()\n #endif\n \tswitch (tiff_bps = i*8 \/ (width * height)) {\n \tcase  8: load_raw = &CLASS eight_bit_load_raw;  break;\n-\tcase 10: load_raw = &CLASS nokia_load_raw;\n+\tcase 10: load_raw = &CLASS nokia_load_raw; break;\n+#ifdef LIBRAW_LIBRARY_BUILD\n+        case 0:  throw LIBRAW_EXCEPTION_IO_CORRUPT; break;\n+#endif\n \t}\n \traw_height = height + (top_margin = i \/ (width * tiff_bps\/8) - height);\n \tmask[0][3] = 1;\ndiff --git a\/internal\/dcraw_common.cpp b\/internal\/dcraw_common.cpp\nindex 041318c5..7cb6c15c 100644\n--- a\/internal\/dcraw_common.cpp\n+++ b\/internal\/dcraw_common.cpp\n@@ -14399,7 +14399,10 @@ void CLASS identify()\n #endif\n \tswitch (tiff_bps = i*8 \/ (width * height)) {\n \tcase  8: load_raw = &CLASS eight_bit_load_raw;  break;\n-\tcase 10: load_raw = &CLASS nokia_load_raw;\n+\tcase 10: load_raw = &CLASS nokia_load_raw; break;\n+#ifdef LIBRAW_LIBRARY_BUILD\n+        case 0:  throw LIBRAW_EXCEPTION_IO_CORRUPT; break;\n+#endif\n \t}\n \traw_height = height + (top_margin = i \/ (width * tiff_bps\/8) - height);\n \tmask[0][3] = 1;\n","owner":"LibRaw","repo":"LibRaw","source":"cve"},{"CVE_ID":"CVE-2018-10191","CWE_ID":"190","category":"security","commit_id":"1905091634a6a2925c911484434448e568330626","commit_message":"From 1905091634a6a2925c911484434448e568330626 Mon Sep 17 00:00:00 2001\nFrom: \"Yukihiro \\\"Matz\\\" Matsumoto\" <matz@ruby.or.jp>\nDate: Wed, 11 Apr 2018 10:24:44 +0900\nSubject: [PATCH] Check length of env stack before accessing upvar; fix #3995\n\n---\n src\/vm.c | 6 +++---\n 1 file changed, 3 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/src\/vm.c b\/src\/vm.c\nindex ae9bf2e69..0acdd1ba8 100644\n--- a\/src\/vm.c\n+++ b\/src\/vm.c\n@@ -1201,11 +1201,11 @@ mrb_vm_exec(mrb_state *mrb, struct RProc *proc, mrb_code *pc)\n       mrb_value *regs_a = regs + a;\n       struct REnv *e = uvenv(mrb, c);\n \n-      if (!e) {\n-        *regs_a = mrb_nil_value();\n+      if (e && b < MRB_ENV_STACK_LEN(e)) {\n+        *regs_a = e->stack[b];\n       }\n       else {\n-        *regs_a = e->stack[b];\n+        *regs_a = mrb_nil_value();\n       }\n       NEXT;\n     }\n","owner":"mruby","repo":"mruby","source":"cve"},{"CVE_ID":"CVE-2016-7948","CWE_ID":"190","category":"security","commit_id":"a0df3e1c7728205e5c7650b2e6dce684139254a6","commit_message":"From a0df3e1c7728205e5c7650b2e6dce684139254a6 Mon Sep 17 00:00:00 2001\nFrom: Tobias Stoeckmann <tobias@stoeckmann.org>\nDate: Sun, 25 Sep 2016 22:21:40 +0200\nSubject: Avoid out of boundary accesses on illegal responses\n\nThe responses of the connected X server have to be properly checked\nto avoid out of boundary accesses that could otherwise be triggered\nby a malicious server.\n\nSigned-off-by: Tobias Stoeckmann <tobias@stoeckmann.org>\nReviewed-by: Matthieu Herrb <matthieu@herrb.eu>\n---\n src\/XrrConfig.c   | 32 +++++++++++++--------\n src\/XrrCrtc.c     | 83 ++++++++++++++++++++++++++++++++++++++++++-------------\n src\/XrrMonitor.c  | 18 ++++++++++++\n src\/XrrOutput.c   | 11 ++++++++\n src\/XrrProvider.c | 28 ++++++++++++++++---\n src\/XrrScreen.c   | 52 ++++++++++++++++++++++------------\n 6 files changed, 172 insertions(+), 52 deletions(-)\n\n","diff_code":"diff --git a\/src\/XrrConfig.c b\/src\/XrrConfig.c\nindex 2f0282b..e68c45a 100644\n--- a\/src\/XrrConfig.c\n+++ b\/src\/XrrConfig.c\n@@ -29,6 +29,7 @@\n #include <config.h>\n #endif\n \n+#include <limits.h>\n #include <stdio.h>\n #include <X11\/Xlib.h>\n \/* we need to be able to manipulate the Display structure on events *\/\n@@ -272,23 +273,30 @@ static XRRScreenConfiguration *_XRRGetScreenInfo (Display *dpy,\n \trep.rate = 0;\n \trep.nrateEnts = 0;\n     }\n+    if (rep.length < INT_MAX >> 2) {\n+\tnbytes = (long) rep.length << 2;\n \n-    nbytes = (long) rep.length << 2;\n+\tnbytesRead = (long) (rep.nSizes * SIZEOF (xScreenSizes) +\n+\t\t\t    ((rep.nrateEnts + 1)& ~1) * 2 \/* SIZEOF(CARD16) *\/);\n \n-    nbytesRead = (long) (rep.nSizes * SIZEOF (xScreenSizes) +\n-\t\t\t ((rep.nrateEnts + 1)& ~1) * 2 \/* SIZEOF (CARD16) *\/);\n+\t\/*\n+\t * first we must compute how much space to allocate for\n+\t * randr library's use; we'll allocate the structures in a single\n+\t * allocation, on cleanlyness grounds.\n+\t *\/\n \n-    \/*\n-     * first we must compute how much space to allocate for\n-     * randr library's use; we'll allocate the structures in a single\n-     * allocation, on cleanlyness grounds.\n-     *\/\n+\trbytes = sizeof (XRRScreenConfiguration) +\n+\t  (rep.nSizes * sizeof (XRRScreenSize) +\n+\t   rep.nrateEnts * sizeof (int));\n \n-    rbytes = sizeof (XRRScreenConfiguration) +\n-      (rep.nSizes * sizeof (XRRScreenSize) +\n-       rep.nrateEnts * sizeof (int));\n+\tscp = (struct _XRRScreenConfiguration *) Xmalloc(rbytes);\n+    } else {\n+\tnbytes = 0;\n+\tnbytesRead = 0;\n+\trbytes = 0;\n+\tscp = NULL;\n+    }\n \n-    scp = (struct _XRRScreenConfiguration *) Xmalloc(rbytes);\n     if (scp == NULL) {\n \t_XEatData (dpy, (unsigned long) nbytes);\n \treturn NULL;\ndiff --git a\/src\/XrrCrtc.c b\/src\/XrrCrtc.c\nindex 5ae35c5..6665092 100644\n--- a\/src\/XrrCrtc.c\n+++ b\/src\/XrrCrtc.c\n@@ -24,6 +24,7 @@\n #include <config.h>\n #endif\n \n+#include <limits.h>\n #include <stdio.h>\n #include <X11\/Xlib.h>\n \/* we need to be able to manipulate the Display structure on events *\/\n@@ -57,22 +58,33 @@ XRRGetCrtcInfo (Display *dpy, XRRScreenResources *resources, RRCrtc crtc)\n \treturn NULL;\n     }\n \n-    nbytes = (long) rep.length << 2;\n+    if (rep.length < INT_MAX >> 2)\n+    {\n+\tnbytes = (long) rep.length << 2;\n \n-    nbytesRead = (long) (rep.nOutput * 4 +\n-\t\t\t rep.nPossibleOutput * 4);\n+\tnbytesRead = (long) (rep.nOutput * 4 +\n+\t\t\t     rep.nPossibleOutput * 4);\n \n-    \/*\n-     * first we must compute how much space to allocate for\n-     * randr library's use; we'll allocate the structures in a single\n-     * allocation, on cleanlyness grounds.\n-     *\/\n+\t\/*\n+\t * first we must compute how much space to allocate for\n+\t * randr library's use; we'll allocate the structures in a single\n+\t * allocation, on cleanlyness grounds.\n+\t *\/\n \n-    rbytes = (sizeof (XRRCrtcInfo) +\n-\t      rep.nOutput * sizeof (RROutput) +\n-\t      rep.nPossibleOutput * sizeof (RROutput));\n+\trbytes = (sizeof (XRRCrtcInfo) +\n+\t\t  rep.nOutput * sizeof (RROutput) +\n+\t\t  rep.nPossibleOutput * sizeof (RROutput));\n+\n+\txci = (XRRCrtcInfo *) Xmalloc(rbytes);\n+    }\n+    else\n+    {\n+\tnbytes = 0;\n+\tnbytesRead = 0;\n+\trbytes = 0;\n+\txci = NULL;\n+    }\n \n-    xci = (XRRCrtcInfo *) Xmalloc(rbytes);\n     if (xci == NULL) {\n \t_XEatDataWords (dpy, rep.length);\n \tUnlockDisplay (dpy);\n@@ -194,12 +206,21 @@ XRRGetCrtcGamma (Display *dpy, RRCrtc crtc)\n     if (!_XReply (dpy, (xReply *) &rep, 0, xFalse))\n \tgoto out;\n \n-    nbytes = (long) rep.length << 2;\n+    if (rep.length < INT_MAX >> 2)\n+    {\n+\tnbytes = (long) rep.length << 2;\n \n-    \/* three channels of CARD16 data *\/\n-    nbytesRead = (rep.size * 2 * 3);\n+\t\/* three channels of CARD16 data *\/\n+\tnbytesRead = (rep.size * 2 * 3);\n \n-    crtc_gamma = XRRAllocGamma (rep.size);\n+\tcrtc_gamma = XRRAllocGamma (rep.size);\n+    }\n+    else\n+    {\n+\tnbytes = 0;\n+\tnbytesRead = 0;\n+\tcrtc_gamma = NULL;\n+    }\n \n     if (!crtc_gamma)\n     {\n@@ -357,7 +378,7 @@ XRRGetCrtcTransform (Display\t*dpy,\n     xRRGetCrtcTransformReq\t*req;\n     int\t\t\t\tmajor_version, minor_version;\n     XRRCrtcTransformAttributes\t*attr;\n-    char\t\t\t*extra = NULL, *e;\n+    char\t\t\t*extra = NULL, *end = NULL, *e;\n     int\t\t\t\tp;\n \n     *attributes = NULL;\n@@ -395,9 +416,17 @@ XRRGetCrtcTransform (Display\t*dpy,\n \telse\n \t{\n \t    int extraBytes = rep.length * 4 - CrtcTransformExtra;\n-\t    extra = Xmalloc (extraBytes);\n+\t    if (rep.length < INT_MAX \/ 4 &&\n+\t\trep.length * 4 >= CrtcTransformExtra) {\n+\t\textra = Xmalloc (extraBytes);\n+\t\tend = extra + extraBytes;\n+\t    } else\n+\t\textra = NULL;\n \t    if (!extra) {\n-\t\t_XEatDataWords (dpy, rep.length - (CrtcTransformExtra >> 2));\n+\t\tif (rep.length > (CrtcTransformExtra >> 2))\n+\t\t    _XEatDataWords (dpy, rep.length - (CrtcTransformExtra >> 2));\n+\t\telse\n+\t\t    _XEatDataWords (dpy, rep.length);\n \t\tUnlockDisplay (dpy);\n \t\tSyncHandle ();\n \t\treturn False;\n@@ -429,22 +458,38 @@ XRRGetCrtcTransform (Display\t*dpy,\n \n     e = extra;\n \n+    if (e + rep.pendingNbytesFilter > end) {\n+\tXFree (extra);\n+\treturn False;\n+    }\n     memcpy (attr->pendingFilter, e, rep.pendingNbytesFilter);\n     attr->pendingFilter[rep.pendingNbytesFilter] = '\\0';\n     e += (rep.pendingNbytesFilter + 3) & ~3;\n     for (p = 0; p < rep.pendingNparamsFilter; p++) {\n \tINT32\tf;\n+\tif (e + 4 > end) {\n+\t    XFree (extra);\n+\t    return False;\n+\t}\n \tmemcpy (&f, e, 4);\n \te += 4;\n \tattr->pendingParams[p] = (XFixed) f;\n     }\n     attr->pendingNparams = rep.pendingNparamsFilter;\n \n+    if (e + rep.currentNbytesFilter > end) {\n+\tXFree (extra);\n+\treturn False;\n+    }\n     memcpy (attr->currentFilter, e, rep.currentNbytesFilter);\n     attr->currentFilter[rep.currentNbytesFilter] = '\\0';\n     e += (rep.currentNbytesFilter + 3) & ~3;\n     for (p = 0; p < rep.currentNparamsFilter; p++) {\n \tINT32\tf;\n+\tif (e + 4 > end) {\n+\t    XFree (extra);\n+\t    return False;\n+\t}\n \tmemcpy (&f, e, 4);\n \te += 4;\n \tattr->currentParams[p] = (XFixed) f;\ndiff --git a\/src\/XrrMonitor.c b\/src\/XrrMonitor.c\nindex a9eaa7b..adc5330 100644\n--- a\/src\/XrrMonitor.c\n+++ b\/src\/XrrMonitor.c\n@@ -24,6 +24,7 @@\n #include <config.h>\n #endif\n \n+#include <limits.h>\n #include <stdio.h>\n #include <X11\/Xlib.h>\n \/* we need to be able to manipulate the Display structure on events *\/\n@@ -65,6 +66,15 @@ XRRGetMonitors(Display *dpy, Window window, Bool get_active, int *nmonitors)\n \treturn NULL;\n     }\n \n+    if (rep.length > INT_MAX >> 2 ||\n+\trep.nmonitors > INT_MAX \/ SIZEOF(xRRMonitorInfo) ||\n+\trep.noutputs > INT_MAX \/ 4 ||\n+\trep.nmonitors * SIZEOF(xRRMonitorInfo) > INT_MAX - rep.noutputs * 4) {\n+\t_XEatData (dpy, rep.length);\n+\tUnlockDisplay (dpy);\n+\tSyncHandle ();\n+\treturn NULL;\n+    }\n     nbytes = (long) rep.length << 2;\n     nmon = rep.nmonitors;\n     noutput = rep.noutputs;\n@@ -111,6 +121,14 @@ XRRGetMonitors(Display *dpy, Window window, Bool get_active, int *nmonitors)\n \t    mon[m].outputs = output;\n \t    buf += SIZEOF (xRRMonitorInfo);\n \t    xoutput = (CARD32 *) buf;\n+\t    if (xmon->noutput > rep.noutputs) {\n+\t        Xfree(buf);\n+\t        Xfree(mon);\n+\t        UnlockDisplay (dpy);\n+\t        SyncHandle ();\n+\t        return NULL;\n+\t    }\n+\t    rep.noutputs -= xmon->noutput;\n \t    for (o = 0; o < xmon->noutput; o++)\n \t\toutput[o] = xoutput[o];\n \t    output += xmon->noutput;\ndiff --git a\/src\/XrrOutput.c b\/src\/XrrOutput.c\nindex 85f0b6e..30f3d40 100644\n--- a\/src\/XrrOutput.c\n+++ b\/src\/XrrOutput.c\n@@ -25,6 +25,7 @@\n #include <config.h>\n #endif\n \n+#include <limits.h>\n #include <stdio.h>\n #include <X11\/Xlib.h>\n \/* we need to be able to manipulate the Display structure on events *\/\n@@ -60,6 +61,16 @@ XRRGetOutputInfo (Display *dpy, XRRScreenResources *resources, RROutput output)\n \treturn NULL;\n     }\n \n+    if (rep.length > INT_MAX >> 2 || rep.length < (OutputInfoExtra >> 2))\n+    {\n+        if (rep.length > (OutputInfoExtra >> 2))\n+\t    _XEatDataWords (dpy, rep.length - (OutputInfoExtra >> 2));\n+\telse\n+\t    _XEatDataWords (dpy, rep.length);\n+\tUnlockDisplay (dpy);\n+\tSyncHandle ();\n+\treturn NULL;\n+    }\n     nbytes = ((long) (rep.length) << 2) - OutputInfoExtra;\n \n     nbytesRead = (long) (rep.nCrtcs * 4 +\ndiff --git a\/src\/XrrProvider.c b\/src\/XrrProvider.c\nindex 9e620c7..d796cd0 100644\n--- a\/src\/XrrProvider.c\n+++ b\/src\/XrrProvider.c\n@@ -25,6 +25,7 @@\n #include <config.h>\n #endif\n \n+#include <limits.h>\n #include <stdio.h>\n #include <X11\/Xlib.h>\n \/* we need to be able to manipulate the Display structure on events *\/\n@@ -59,12 +60,20 @@ XRRGetProviderResources(Display *dpy, Window window)\n       return NULL;\n     }\n \n-    nbytes = (long) rep.length << 2;\n+    if (rep.length < INT_MAX >> 2) {\n+\tnbytes = (long) rep.length << 2;\n \n-    nbytesRead = (long) (rep.nProviders * 4);\n+\tnbytesRead = (long) (rep.nProviders * 4);\n \n-    rbytes = (sizeof(XRRProviderResources) + rep.nProviders * sizeof(RRProvider));\n-    xrpr = (XRRProviderResources *) Xmalloc(rbytes);\n+\trbytes = (sizeof(XRRProviderResources) + rep.nProviders *\n+\t\t  sizeof(RRProvider));\n+\txrpr = (XRRProviderResources *) Xmalloc(rbytes);\n+    } else {\n+\tnbytes = 0;\n+\tnbytesRead = 0;\n+\trbytes = 0;\n+\txrpr = NULL;\n+    }\n \n     if (xrpr == NULL) {\n        _XEatDataWords (dpy, rep.length);\n@@ -121,6 +130,17 @@ XRRGetProviderInfo(Display *dpy, XRRScreenResources *resources, RRProvider provi\n \treturn NULL;\n     }\n \n+    if (rep.length > INT_MAX >> 2 || rep.length < ProviderInfoExtra >> 2)\n+    {\n+\tif (rep.length < ProviderInfoExtra >> 2)\n+\t    _XEatDataWords (dpy, rep.length);\n+\telse\n+\t    _XEatDataWords (dpy, rep.length - (ProviderInfoExtra >> 2));\n+\tUnlockDisplay (dpy);\n+\tSyncHandle ();\n+\treturn NULL;\n+    }\n+\n     nbytes = ((long) rep.length << 2) - ProviderInfoExtra;\n \n     nbytesRead = (long)(rep.nCrtcs * 4 +\ndiff --git a\/src\/XrrScreen.c b\/src\/XrrScreen.c\nindex b8ce7e5..1f7ffe6 100644\n--- a\/src\/XrrScreen.c\n+++ b\/src\/XrrScreen.c\n@@ -24,6 +24,7 @@\n #include <config.h>\n #endif\n \n+#include <limits.h>\n #include <stdio.h>\n #include <X11\/Xlib.h>\n \/* we need to be able to manipulate the Display structure on events *\/\n@@ -105,27 +106,36 @@ doGetScreenResources (Display *dpy, Window window, int poll)\n \txrri->has_rates = _XRRHasRates (xrri->minor_version, xrri->major_version);\n     }\n \n-    nbytes = (long) rep.length << 2;\n+    if (rep.length < INT_MAX >> 2) {\n+\tnbytes = (long) rep.length << 2;\n \n-    nbytesRead = (long) (rep.nCrtcs * 4 +\n-\t\t\t rep.nOutputs * 4 +\n-\t\t\t rep.nModes * SIZEOF (xRRModeInfo) +\n-\t\t\t ((rep.nbytesNames + 3) & ~3));\n+\tnbytesRead = (long) (rep.nCrtcs * 4 +\n+\t\t\t     rep.nOutputs * 4 +\n+\t\t\t     rep.nModes * SIZEOF (xRRModeInfo) +\n+\t\t\t     ((rep.nbytesNames + 3) & ~3));\n \n-    \/*\n-     * first we must compute how much space to allocate for\n-     * randr library's use; we'll allocate the structures in a single\n-     * allocation, on cleanlyness grounds.\n-     *\/\n+\t\/*\n+\t * first we must compute how much space to allocate for\n+\t * randr library's use; we'll allocate the structures in a single\n+\t * allocation, on cleanlyness grounds.\n+\t *\/\n+\n+\trbytes = (sizeof (XRRScreenResources) +\n+\t\t  rep.nCrtcs * sizeof (RRCrtc) +\n+\t\t  rep.nOutputs * sizeof (RROutput) +\n+\t\t  rep.nModes * sizeof (XRRModeInfo) +\n+\t\t  rep.nbytesNames + rep.nModes);    \/* '\\0' terminate names *\/\n \n-    rbytes = (sizeof (XRRScreenResources) +\n-\t      rep.nCrtcs * sizeof (RRCrtc) +\n-\t      rep.nOutputs * sizeof (RROutput) +\n-\t      rep.nModes * sizeof (XRRModeInfo) +\n-\t      rep.nbytesNames + rep.nModes);\t\/* '\\0' terminate names *\/\n+\txrsr = (XRRScreenResources *) Xmalloc(rbytes);\n+\twire_names = (char *) Xmalloc (rep.nbytesNames);\n+    } else {\n+\tnbytes = 0;\n+\tnbytesRead = 0;\n+\trbytes = 0;\n+\txrsr = NULL;\n+\twire_names = NULL;\n+    }\n \n-    xrsr = (XRRScreenResources *) Xmalloc(rbytes);\n-    wire_names = (char *) Xmalloc (rep.nbytesNames);\n     if (xrsr == NULL || wire_names == NULL) {\n \tXfree (xrsr);\n \tXfree (wire_names);\n@@ -174,6 +184,14 @@ doGetScreenResources (Display *dpy, Window window, int poll)\n     wire_name = wire_names;\n     for (i = 0; i < rep.nModes; i++)  {\n \txrsr->modes[i].name = names;\n+\tif (xrsr->modes[i].nameLength > rep.nbytesNames) {\n+\t    Xfree (xrsr);\n+\t    Xfree (wire_names);\n+\t    UnlockDisplay (dpy);\n+\t    SyncHandle ();\n+\t    return NULL;\n+\t}\n+\trep.nbytesNames -= xrsr->modes[i].nameLength;\n \tmemcpy (names, wire_name, xrsr->modes[i].nameLength);\n \tnames[xrsr->modes[i].nameLength] = '\\0';\n \tnames += xrsr->modes[i].nameLength + 1;\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-17569","CWE_ID":"190","category":"security","commit_id":"5c2dc2b7856a66338e2f113540fd2e8fcb847f9e","commit_message":"From 5c2dc2b7856a66338e2f113540fd2e8fcb847f9e Mon Sep 17 00:00:00 2001\nFrom: Benjamin Chodroff <benjamin.chodroff@gmail.com>\nDate: Wed, 8 Aug 2018 11:10:45 +0800\nSubject: [PATCH] fix memory corruption and other 32bit overflows\n\n---\n network\/nw_buf.c  | 10 ++++++++--\n utils\/ut_rpc.c    | 10 ++++++++--\n utils\/ut_rpc.h    |  1 +\n utils\/ut_ws_svr.c |  2 +-\n utils\/ut_ws_svr.h |  2 ++\n 5 files changed, 20 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/network\/nw_buf.c b\/network\/nw_buf.c\nindex f338af5..fa42b0a 100644\n--- a\/network\/nw_buf.c\n+++ b\/network\/nw_buf.c\n@@ -8,7 +8,9 @@\n # include \"nw_buf.h\"\n \n # define NW_BUF_POOL_INIT_SIZE 64\n+# define NW_BUF_POOL_MAX_SIZE  65535\n # define NW_CACHE_INIT_SIZE    64\n+# define NW_CACHE_MAX_SIZE     65535\n \n size_t nw_buf_size(nw_buf *buf)\n {\n@@ -85,7 +87,7 @@ void nw_buf_free(nw_buf_pool *pool, nw_buf *buf)\n {\n     if (pool->free < pool->free_total) {\n         pool->free_arr[pool->free++] = buf;\n-    } else {\n+    } else if (pool->free_total < NW_BUF_POOL_MAX_SIZE) {\n         uint32_t new_free_total = pool->free_total * 2;\n         void *new_arr = realloc(pool->free_arr, new_free_total * sizeof(nw_buf *));\n         if (new_arr) {\n@@ -95,6 +97,8 @@ void nw_buf_free(nw_buf_pool *pool, nw_buf *buf)\n         } else {\n             free(buf);\n         }\n+    } else {\n+        free(buf);\n     }\n }\n \n@@ -230,7 +234,7 @@ void nw_cache_free(nw_cache *cache, void *obj)\n {\n     if (cache->free < cache->free_total) {\n         cache->free_arr[cache->free++] = obj;\n-    } else {\n+    } else if (cache->free_total < NW_CACHE_MAX_SIZE) {\n         uint32_t new_free_total = cache->free_total * 2;\n         void *new_arr = realloc(cache->free_arr, new_free_total * sizeof(void *));\n         if (new_arr) {\n@@ -240,6 +244,8 @@ void nw_cache_free(nw_cache *cache, void *obj)\n         } else {\n             free(obj);\n         }\n+    } else {\n+        free(obj);\n     }\n }\n \ndiff --git a\/utils\/ut_rpc.c b\/utils\/ut_rpc.c\nindex 4ade964..14d0429 100644\n--- a\/utils\/ut_rpc.c\n+++ b\/utils\/ut_rpc.c\n@@ -44,13 +44,19 @@ int rpc_pack(rpc_pkg *pkg, void **data, uint32_t *size)\n {\n     static void *send_buf;\n     static size_t send_buf_size;\n-    uint32_t pkg_size = RPC_PKG_HEAD_SIZE + pkg->ext_size + pkg->body_size;\n+    uint32_t pkg_size;\n+    if (pkg->body_size > RPC_PKG_MAX_BODY_SIZE) {\n+        return -1;\n+    }\n+    pkg_size = RPC_PKG_HEAD_SIZE + pkg->ext_size + pkg->body_size;\n     if (send_buf_size < pkg_size) {\n         if (send_buf)\n             free(send_buf);\n         send_buf_size = pkg_size * 2;\n         send_buf = malloc(send_buf_size);\n-        assert(send_buf != NULL);\n+        if (send_buf == NULL) {\n+            return -1;\n+        }\n     }\n \n     memcpy(send_buf, pkg, RPC_PKG_HEAD_SIZE);\ndiff --git a\/utils\/ut_rpc.h b\/utils\/ut_rpc.h\nindex a30cf53..2c7b217 100644\n--- a\/utils\/ut_rpc.h\n+++ b\/utils\/ut_rpc.h\n@@ -32,6 +32,7 @@ typedef struct rpc_pkg {\n # pragma pack()\n \n # define RPC_PKG_HEAD_SIZE (sizeof(rpc_pkg) - sizeof(void *) * 2)\n+# define RPC_PKG_MAX_BODY_SIZE ((UINT32_MAX \/ 2) - UINT16_MAX - sizeof(rpc_pkg))\n \n int rpc_decode(nw_ses *ses, void *data, size_t max);\n int rpc_pack(rpc_pkg *pkg, void **data, uint32_t *size);\ndiff --git a\/utils\/ut_ws_svr.c b\/utils\/ut_ws_svr.c\nindex 5dfb87b..5a4b8b1 100644\n--- a\/utils\/ut_ws_svr.c\n+++ b\/utils\/ut_ws_svr.c\n@@ -129,7 +129,7 @@ static int on_http_message_complete(http_parser* parser)\n     if (upgrade == NULL || strcasecmp(upgrade, \"websocket\") != 0)\n         goto error;\n     const char *connection = http_request_get_header(info->request, \"Connection\");\n-    if (connection == NULL)\n+    if (connection == NULL || strlen(connection) > UT_WS_SVR_MAX_HEADER_SIZE)\n         goto error;\n     else {\n         bool found_upgrade = false;\ndiff --git a\/utils\/ut_ws_svr.h b\/utils\/ut_ws_svr.h\nindex d3fcf0f..11c53d4 100644\n--- a\/utils\/ut_ws_svr.h\n+++ b\/utils\/ut_ws_svr.h\n@@ -12,6 +12,8 @@\n # include \"nw_buf.h\"\n # include \"nw_timer.h\"\n \n+# define UT_WS_SVR_MAX_HEADER_SIZE 1024\n+\n typedef struct ws_svr_cfg {\n     uint32_t bind_count;\n     nw_svr_bind *bind_arr;\n","owner":"viabtc","repo":"viabtc_exchange_server.viabtc.viabtc_exchange_server","source":"cve"},{"CVE_ID":"CVE-2018-20175","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2018-20180","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2017-6838","CWE_ID":"190","category":"security","commit_id":"7d65f89defb092b63bcbc5d98349fb222ca73b3c","commit_message":"From 7d65f89defb092b63bcbc5d98349fb222ca73b3c Mon Sep 17 00:00:00 2001\nFrom: Antonio Larrosa <larrosa@kde.org>\nDate: Mon, 6 Mar 2017 13:54:52 +0100\nSubject: [PATCH] Check for multiplication overflow in sfconvert\n\nChecks that a multiplication doesn't overflow when\ncalculating the buffer size, and if it overflows,\nreduce the buffer size instead of failing.\n\nThis fixes the 00192-audiofile-signintoverflow-sfconvert case\nin #41\n---\n sfcommands\/sfconvert.c | 34 ++++++++++++++++++++++++++++++++--\n 1 file changed, 32 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/sfcommands\/sfconvert.c b\/sfcommands\/sfconvert.c\nindex 80a1bc4..970a3e4 100644\n--- a\/sfcommands\/sfconvert.c\n+++ b\/sfcommands\/sfconvert.c\n@@ -45,6 +45,33 @@ void printusage (void);\n void usageerror (void);\n bool copyaudiodata (AFfilehandle infile, AFfilehandle outfile, int trackid);\n \n+int firstBitSet(int x)\n+{\n+        int position=0;\n+        while (x!=0)\n+        {\n+                x>>=1;\n+                ++position;\n+        }\n+        return position;\n+}\n+\n+#ifndef __has_builtin\n+#define __has_builtin(x) 0\n+#endif\n+\n+int multiplyCheckOverflow(int a, int b, int *result)\n+{\n+#if (defined __GNUC__ && __GNUC__ >= 5) || ( __clang__ && __has_builtin(__builtin_mul_overflow))\n+\treturn __builtin_mul_overflow(a, b, result);\n+#else\n+\tif (firstBitSet(a)+firstBitSet(b)>31) \/\/ int is signed, so we can't use 32 bits\n+\t\treturn true;\n+\t*result = a * b;\n+\treturn false;\n+#endif\n+}\n+\n int main (int argc, char **argv)\n {\n \tif (argc == 2)\n@@ -323,8 +350,11 @@ bool copyaudiodata (AFfilehandle infile, AFfilehandle outfile, int trackid)\n {\n \tint frameSize = afGetVirtualFrameSize(infile, trackid, 1);\n \n-\tconst int kBufferFrameCount = 65536;\n-\tvoid *buffer = malloc(kBufferFrameCount * frameSize);\n+\tint kBufferFrameCount = 65536;\n+\tint bufferSize;\n+\twhile (multiplyCheckOverflow(kBufferFrameCount, frameSize, &bufferSize))\n+\t\tkBufferFrameCount \/= 2;\n+\tvoid *buffer = malloc(bufferSize);\n \n \tAFframecount totalFrames = afGetFrameCount(infile, AF_DEFAULT_TRACK);\n \tAFframecount totalFramesWritten = 0;\n","owner":"antlarr","repo":"audiofile","source":"cve"},{"CVE_ID":"CVE-2017-17854","CWE_ID":"190","category":"security","commit_id":"bb7f0f989ca7de1153bd128a40a71709e339fa03","commit_message":"From bb7f0f989ca7de1153bd128a40a71709e339fa03 Mon Sep 17 00:00:00 2001\nFrom: Alexei Starovoitov <ast@kernel.org>\nDate: Mon, 18 Dec 2017 20:12:00 -0800\nSubject: [PATCH] bpf: fix integer overflows\n\nThere were various issues related to the limited size of integers used in\nthe verifier:\n - `off + size` overflow in __check_map_access()\n - `off + reg->off` overflow in check_mem_access()\n - `off + reg->var_off.value` overflow or 32-bit truncation of\n   `reg->var_off.value` in check_mem_access()\n - 32-bit truncation in check_stack_boundary()\n\nMake sure that any integer math cannot overflow by not allowing\npointer math with large values.\n\nAlso reduce the scope of \"scalar op scalar\" tracking.\n\nFixes: f1174f77b50c (\"bpf\/verifier: rework value tracking\")\nReported-by: Jann Horn <jannh@google.com>\nSigned-off-by: Alexei Starovoitov <ast@kernel.org>\nSigned-off-by: Daniel Borkmann <daniel@iogearbox.net>\n---\n include\/linux\/bpf_verifier.h |  4 +--\n kernel\/bpf\/verifier.c        | 48 ++++++++++++++++++++++++++++++++++++\n 2 files changed, 50 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/include\/linux\/bpf_verifier.h b\/include\/linux\/bpf_verifier.h\nindex c561b986bab0e..1632bb13ad8ae 100644\n--- a\/include\/linux\/bpf_verifier.h\n+++ b\/include\/linux\/bpf_verifier.h\n@@ -15,11 +15,11 @@\n  * In practice this is far bigger than any realistic pointer offset; this limit\n  * ensures that umax_value + (int)off + (int)size cannot overflow a u64.\n  *\/\n-#define BPF_MAX_VAR_OFF\t(1ULL << 31)\n+#define BPF_MAX_VAR_OFF\t(1 << 29)\n \/* Maximum variable size permitted for ARG_CONST_SIZE[_OR_ZERO].  This ensures\n  * that converting umax_value to int cannot overflow.\n  *\/\n-#define BPF_MAX_VAR_SIZ\tINT_MAX\n+#define BPF_MAX_VAR_SIZ\t(1 << 29)\n \n \/* Liveness marks, used for registers and spilled-regs (in stack slots).\n  * Read marks propagate upwards until they find a write mark; they record that\ndiff --git a\/kernel\/bpf\/verifier.c b\/kernel\/bpf\/verifier.c\nindex 982bd9ec721ae..86dfe6b5c2436 100644\n--- a\/kernel\/bpf\/verifier.c\n+++ b\/kernel\/bpf\/verifier.c\n@@ -1819,6 +1819,41 @@ static bool signed_sub_overflows(s64 a, s64 b)\n \treturn res > a;\n }\n \n+static bool check_reg_sane_offset(struct bpf_verifier_env *env,\n+\t\t\t\t  const struct bpf_reg_state *reg,\n+\t\t\t\t  enum bpf_reg_type type)\n+{\n+\tbool known = tnum_is_const(reg->var_off);\n+\ts64 val = reg->var_off.value;\n+\ts64 smin = reg->smin_value;\n+\n+\tif (known && (val >= BPF_MAX_VAR_OFF || val <= -BPF_MAX_VAR_OFF)) {\n+\t\tverbose(env, \"math between %s pointer and %lld is not allowed\\n\",\n+\t\t\treg_type_str[type], val);\n+\t\treturn false;\n+\t}\n+\n+\tif (reg->off >= BPF_MAX_VAR_OFF || reg->off <= -BPF_MAX_VAR_OFF) {\n+\t\tverbose(env, \"%s pointer offset %d is not allowed\\n\",\n+\t\t\treg_type_str[type], reg->off);\n+\t\treturn false;\n+\t}\n+\n+\tif (smin == S64_MIN) {\n+\t\tverbose(env, \"math between %s pointer and register with unbounded min value is not allowed\\n\",\n+\t\t\treg_type_str[type]);\n+\t\treturn false;\n+\t}\n+\n+\tif (smin >= BPF_MAX_VAR_OFF || smin <= -BPF_MAX_VAR_OFF) {\n+\t\tverbose(env, \"value %lld makes %s pointer be out of bounds\\n\",\n+\t\t\tsmin, reg_type_str[type]);\n+\t\treturn false;\n+\t}\n+\n+\treturn true;\n+}\n+\n \/* Handles arithmetic on a pointer and a scalar: computes new min\/max and var_off.\n  * Caller should also handle BPF_MOV case separately.\n  * If we return -EACCES, caller may want to try again treating pointer as a\n@@ -1887,6 +1922,10 @@ static int adjust_ptr_min_max_vals(struct bpf_verifier_env *env,\n \tdst_reg->type = ptr_reg->type;\n \tdst_reg->id = ptr_reg->id;\n \n+\tif (!check_reg_sane_offset(env, off_reg, ptr_reg->type) ||\n+\t    !check_reg_sane_offset(env, ptr_reg, ptr_reg->type))\n+\t\treturn -EINVAL;\n+\n \tswitch (opcode) {\n \tcase BPF_ADD:\n \t\t\/* We can take a fixed offset as long as it doesn't overflow\n@@ -2017,6 +2056,9 @@ static int adjust_ptr_min_max_vals(struct bpf_verifier_env *env,\n \t\treturn -EACCES;\n \t}\n \n+\tif (!check_reg_sane_offset(env, dst_reg, ptr_reg->type))\n+\t\treturn -EINVAL;\n+\n \t__update_reg_bounds(dst_reg);\n \t__reg_deduce_bounds(dst_reg);\n \t__reg_bound_offset(dst_reg);\n@@ -2046,6 +2088,12 @@ static int adjust_scalar_min_max_vals(struct bpf_verifier_env *env,\n \tsrc_known = tnum_is_const(src_reg.var_off);\n \tdst_known = tnum_is_const(dst_reg->var_off);\n \n+\tif (!src_known &&\n+\t    opcode != BPF_ADD && opcode != BPF_SUB && opcode != BPF_AND) {\n+\t\t__mark_reg_unknown(dst_reg);\n+\t\treturn 0;\n+\t}\n+\n \tswitch (opcode) {\n \tcase BPF_ADD:\n \t\tif (signed_add_overflows(dst_reg->smin_value, smin_val) ||\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2018-18928","CWE_ID":"190","category":"security","commit_id":"53d8c8f3d181d87a6aa925b449b51c4a2c922a51","commit_message":"From 53d8c8f3d181d87a6aa925b449b51c4a2c922a51 Mon Sep 17 00:00:00 2001\nFrom: Shane Carr <shane@unicode.org>\nDate: Mon, 29 Oct 2018 23:52:44 -0700\nSubject: [PATCH] ICU-20246 Fixing another integer overflow in number parsing.\n\n---\n icu4c\/source\/i18n\/fmtable.cpp                          |  2 +-\n icu4c\/source\/i18n\/number_decimalquantity.cpp           |  5 ++++-\n icu4c\/source\/test\/intltest\/numfmtst.cpp                |  8 ++++++++\n ...\/icu\/impl\/number\/DecimalQuantity_AbstractBCD.java   |  5 ++++-\n ...\/impl\/number\/DecimalQuantity_DualStorageBCD.java    | 10 +++++++++-\n ...\/com\/ibm\/icu\/dev\/test\/format\/NumberFormatTest.java  |  5 +++++\n 6 files changed, 31 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/icu4c\/source\/i18n\/fmtable.cpp b\/icu4c\/source\/i18n\/fmtable.cpp\nindex 45c7024fc29..8601d95f4a6 100644\n--- a\/icu4c\/source\/i18n\/fmtable.cpp\n+++ b\/icu4c\/source\/i18n\/fmtable.cpp\n@@ -734,7 +734,7 @@ CharString *Formattable::internalGetCharString(UErrorCode &status) {\n       \/\/ not print scientific notation for magnitudes greater than -5 and smaller than some amount (+5?).\n       if (fDecimalQuantity->isZero()) {\n         fDecimalStr->append(\"0\", -1, status);\n-      } else if (std::abs(fDecimalQuantity->getMagnitude()) < 5) {\n+      } else if (fDecimalQuantity->getMagnitude() != INT32_MIN && std::abs(fDecimalQuantity->getMagnitude()) < 5) {\n         fDecimalStr->appendInvariantChars(fDecimalQuantity->toPlainString(), status);\n       } else {\n         fDecimalStr->appendInvariantChars(fDecimalQuantity->toScientificString(), status);\ndiff --git a\/icu4c\/source\/i18n\/number_decimalquantity.cpp b\/icu4c\/source\/i18n\/number_decimalquantity.cpp\nindex 47b930a564b..d5dd7ae694c 100644\n--- a\/icu4c\/source\/i18n\/number_decimalquantity.cpp\n+++ b\/icu4c\/source\/i18n\/number_decimalquantity.cpp\n@@ -898,7 +898,10 @@ UnicodeString DecimalQuantity::toScientificString() const {\n     }\n     result.append(u'E');\n     int32_t _scale = upperPos + scale;\n-    if (_scale < 0) {\n+    if (_scale == INT32_MIN) {\n+        result.append({u\"-2147483648\", -1});\n+        return result;\n+    } else if (_scale < 0) {\n         _scale *= -1;\n         result.append(u'-');\n     } else {\ndiff --git a\/icu4c\/source\/test\/intltest\/numfmtst.cpp b\/icu4c\/source\/test\/intltest\/numfmtst.cpp\nindex 34355939113..8d52dc122bf 100644\n--- a\/icu4c\/source\/test\/intltest\/numfmtst.cpp\n+++ b\/icu4c\/source\/test\/intltest\/numfmtst.cpp\n@@ -9226,6 +9226,14 @@ void NumberFormatTest::Test20037_ScientificIntegerOverflow() {\n     assertEquals(u\"Should not overflow and should parse only the first exponent\",\n                  u\"1E-2147483647\",\n                  {sp.data(), sp.length(), US_INV});\n+\n+    \/\/ Test edge case overflow of exponent\n+    result = Formattable();\n+    nf->parse(u\".0003e-2147483644\", result, status);\n+    sp = result.getDecimalNumber(status);\n+    assertEquals(u\"Should not overflow\",\n+                 u\"3E-2147483648\",\n+                 {sp.data(), sp.length(), US_INV});\n }\n \n void NumberFormatTest::Test13840_ParseLongStringCrash() {\ndiff --git a\/icu4j\/main\/classes\/core\/src\/com\/ibm\/icu\/impl\/number\/DecimalQuantity_AbstractBCD.java b\/icu4j\/main\/classes\/core\/src\/com\/ibm\/icu\/impl\/number\/DecimalQuantity_AbstractBCD.java\nindex f5fb4278e1f..138c2e9acf7 100644\n--- a\/icu4j\/main\/classes\/core\/src\/com\/ibm\/icu\/impl\/number\/DecimalQuantity_AbstractBCD.java\n+++ b\/icu4j\/main\/classes\/core\/src\/com\/ibm\/icu\/impl\/number\/DecimalQuantity_AbstractBCD.java\n@@ -1067,7 +1067,10 @@ public void toScientificString(StringBuilder result) {\n         }\n         result.append('E');\n         int _scale = upperPos + scale;\n-        if (_scale < 0) {\n+        if (_scale == Integer.MIN_VALUE) {\n+            result.append(\"-2147483648\");\n+            return;\n+        } else if (_scale < 0) {\n             _scale *= -1;\n             result.append('-');\n         } else {\ndiff --git a\/icu4j\/main\/classes\/core\/src\/com\/ibm\/icu\/impl\/number\/DecimalQuantity_DualStorageBCD.java b\/icu4j\/main\/classes\/core\/src\/com\/ibm\/icu\/impl\/number\/DecimalQuantity_DualStorageBCD.java\nindex 42cc2c48ecf..faa46281a1d 100644\n--- a\/icu4j\/main\/classes\/core\/src\/com\/ibm\/icu\/impl\/number\/DecimalQuantity_DualStorageBCD.java\n+++ b\/icu4j\/main\/classes\/core\/src\/com\/ibm\/icu\/impl\/number\/DecimalQuantity_DualStorageBCD.java\n@@ -239,7 +239,15 @@ protected BigDecimal bcdToBigDecimal() {\n                 tempLong = tempLong * 10 + getDigitPos(shift);\n             }\n             BigDecimal result = BigDecimal.valueOf(tempLong);\n-            result = result.scaleByPowerOfTen(scale);\n+            try {\n+                result = result.scaleByPowerOfTen(scale);\n+            } catch (ArithmeticException e) {\n+                if (e.getMessage().contains(\"Underflow\")) {\n+                    result = BigDecimal.ZERO;\n+                } else {\n+                    throw e;\n+                }\n+            }\n             if (isNegative())\n                 result = result.negate();\n             return result;\ndiff --git a\/icu4j\/main\/tests\/core\/src\/com\/ibm\/icu\/dev\/test\/format\/NumberFormatTest.java b\/icu4j\/main\/tests\/core\/src\/com\/ibm\/icu\/dev\/test\/format\/NumberFormatTest.java\nindex ce6b3666aa0..fe0d77cca29 100644\n--- a\/icu4j\/main\/tests\/core\/src\/com\/ibm\/icu\/dev\/test\/format\/NumberFormatTest.java\n+++ b\/icu4j\/main\/tests\/core\/src\/com\/ibm\/icu\/dev\/test\/format\/NumberFormatTest.java\n@@ -6325,6 +6325,11 @@ public void Test20037_ScientificIntegerOverflow() throws ParseException {\n         result = nf.parse(\"1E-547483647\");\n         assertEquals(\"Should *not* snap to zero\",\n                 \"1E-547483647\", result.toString());\n+\n+        \/\/ Test edge case overflow of exponent\n+        result = nf.parse(\".0003e-2147483644\");\n+        assertEquals(\"Should not overflow\",\n+                \"0\", result.toString());\n     }\n \n     @Test\n","owner":"unicode-org","repo":"icu","source":"cve"},{"CVE_ID":"CVE-2017-6308","CWE_ID":"190","category":"security","commit_id":"c5044689e50039635e7700fe2472fd632ac77176","commit_message":"From c5044689e50039635e7700fe2472fd632ac77176 Mon Sep 17 00:00:00 2001\nFrom: Eric Sesterhenn <eric.sesterhenn@x41-dsec.de>\nDate: Fri, 17 Feb 2017 09:43:21 +0100\nSubject: [PATCH] Fix integer overflows and harden memory allocator.\n\n---\n src\/alloc.c | 55 +++++++++++++++++++++++++++++++++++++----------------\n src\/alloc.h | 10 +++++-----\n 2 files changed, 44 insertions(+), 21 deletions(-)\n\n","diff_code":"diff --git a\/src\/alloc.c b\/src\/alloc.c\nindex 47d192f..c23909c 100644\n--- a\/src\/alloc.c\n+++ b\/src\/alloc.c\n@@ -40,14 +40,23 @@ get_alloc_limit()\n     return alloc_limit;\n }\n \n+size_t\n+check_mul_overflow(size_t a, size_t b, size_t* res)\n+{\n+    size_t tmp = a * b;\n+    if (a != 0 && tmp \/ a != b) return 1;\n+    *res = tmp;\n+    return 0;\n+}\n+\n static void\n alloc_limit_failure (char *fn_name, size_t size)\n {\n-    fprintf (stderr, \n+    fprintf (stderr,\n              \"%s: Maximum allocation size exceeded \"\n              \"(maxsize = %lu; size = %lu).\\n\",\n              fn_name,\n-             (unsigned long)alloc_limit, \n+             (unsigned long)alloc_limit,\n              (unsigned long)size);\n }\n \n@@ -56,17 +65,21 @@ alloc_limit_assert (char *fn_name, size_t size)\n {\n     if (alloc_limit && size > alloc_limit)\n     {\n-\talloc_limit_failure (fn_name, size);\n-\texit (-1);\n+        alloc_limit_failure (fn_name, size);\n+        exit (-1);\n     }\n }\n \n \/* attempts to malloc memory, if fails print error and call abort *\/\n void*\n-xmalloc (size_t size)\n+xmalloc (size_t num, size_t size)\n {\n-    void *ptr = malloc (size);\n-    if (!ptr \n+    size_t res;\n+    if (check_mul_overflow(num, size, &res))\n+        abort();\n+\n+    void *ptr = malloc (res);\n+    if (!ptr\n         && (size != 0))         \/* some libc don't like size == 0 *\/\n     {\n         perror (\"xmalloc: Memory allocation failure\");\n@@ -77,20 +90,29 @@ xmalloc (size_t size)\n \n \/* Allocates memory but only up to a limit *\/\n void*\n-checked_xmalloc (size_t size)\n+checked_xmalloc (size_t num, size_t size)\n {\n-    alloc_limit_assert (\"checked_xmalloc\", size);\n-    return xmalloc (size);\n+    size_t res;\n+    if (check_mul_overflow(num, size, &res))\n+        abort();\n+\n+    alloc_limit_assert (\"checked_xmalloc\", res);\n+    return xmalloc (num, size);\n }\n \n \/* xmallocs memory and clears it out *\/\n void*\n xcalloc (size_t num, size_t size)\n {\n-    void *ptr = malloc(num * size);\n+    size_t res;\n+    if (check_mul_overflow(num, size, &res))\n+        abort();\n+\n+    void *ptr;\n+    ptr = malloc(res);\n     if (ptr)\n     {\n-        memset (ptr, '\\0', (num * size));\n+        memset (ptr, '\\0', (res));\n     }\n     return ptr;\n }\n@@ -99,9 +121,10 @@ xcalloc (size_t num, size_t size)\n void*\n checked_xcalloc (size_t num, size_t size)\n {\n-    alloc_limit_assert (\"checked_xcalloc\", (num *size));\n+    size_t res;\n+    if (check_mul_overflow(num, size, &res))\n+        abort();\n+\n+    alloc_limit_assert (\"checked_xcalloc\", (res));\n     return xcalloc (num, size);\n }\n-\n-\n-\ndiff --git a\/src\/alloc.h b\/src\/alloc.h\nindex d63f6a3..8fbd6bf 100644\n--- a\/src\/alloc.h\n+++ b\/src\/alloc.h\n@@ -35,20 +35,20 @@ extern void free (void*);\n extern void set_alloc_limit (size_t size);\n extern size_t get_alloc_limit();\n extern void alloc_limit_assert (char *fn_name, size_t size);\n-extern void* checked_xmalloc (size_t size);\n-extern void* xmalloc (size_t size);\n+extern void* checked_xmalloc (size_t num, size_t size);\n+extern void* xmalloc (size_t num, size_t size);\n extern void* checked_xcalloc (size_t num, size_t size);\n extern void* xcalloc (size_t num, size_t size);\n \n #define XMALLOC(_type,_num)\t\t\t                \\\n-        ((_type*)xmalloc((_num)*sizeof(_type)))\n+        ((_type*)xmalloc((_num), sizeof(_type)))\n #define XCALLOC(_type,_num) \t\t\t\t        \\\n         ((_type*)xcalloc((_num), sizeof (_type)))\n #define CHECKED_XMALLOC(_type,_num) \t\t\t        \\\n-        ((_type*)checked_xmalloc((_num)*sizeof(_type)))\n+        ((_type*)checked_xmalloc((_num),sizeof(_type)))\n #define CHECKED_XCALLOC(_type,_num) \t\t\t        \\\n         ((_type*)checked_xcalloc((_num),sizeof(_type)))\n #define XFREE(_ptr)\t\t\t\t\t\t\\\n-\tdo { if (_ptr) { free (_ptr); _ptr = 0; } } while (0)\n+        do { if (_ptr) { free (_ptr); _ptr = 0; } } while (0)\n \n #endif \/* ALLOC_H *\/\n","owner":"verdammelt","repo":"tnef","source":"cve"},{"CVE_ID":"CVE-2017-5340","CWE_ID":"190","category":"security","commit_id":"4cc0286f2f3780abc6084bcdae5dce595daa3c12","commit_message":"From 4cc0286f2f3780abc6084bcdae5dce595daa3c12 Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Mon, 2 Jan 2017 20:14:05 -0800\nSubject: [PATCH] Fix #73832 - leave the table in a safe state if the size is\n too big.\n\n---\n Zend\/zend_hash.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/Zend\/zend_hash.c b\/Zend\/zend_hash.c\nindex 322422da155b..8b54a3932d0a 100644\n--- a\/Zend\/zend_hash.c\n+++ b\/Zend\/zend_hash.c\n@@ -175,7 +175,6 @@ ZEND_API void ZEND_FASTCALL _zend_hash_init(HashTable *ht, uint32_t nSize, dtor_\n \tGC_REFCOUNT(ht) = 1;\n \tGC_TYPE_INFO(ht) = IS_ARRAY;\n \tht->u.flags = (persistent ? HASH_FLAG_PERSISTENT : 0) | HASH_FLAG_APPLY_PROTECTION | HASH_FLAG_STATIC_KEYS;\n-\tht->nTableSize = zend_hash_check_size(nSize);\n \tht->nTableMask = HT_MIN_MASK;\n \tHT_SET_DATA_ADDR(ht, &uninitialized_bucket);\n \tht->nNumUsed = 0;\n@@ -183,6 +182,7 @@ ZEND_API void ZEND_FASTCALL _zend_hash_init(HashTable *ht, uint32_t nSize, dtor_\n \tht->nInternalPointer = HT_INVALID_IDX;\n \tht->nNextFreeElement = 0;\n \tht->pDestructor = pDestructor;\n+\tht->nTableSize = zend_hash_check_size(nSize);\n }\n \n static void ZEND_FASTCALL zend_hash_packed_grow(HashTable *ht)\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2018-13053","CWE_ID":"190","category":"security","commit_id":"5f936e19cc0ef97dbe3a56e9498922ad5ba1edef","commit_message":"From 5f936e19cc0ef97dbe3a56e9498922ad5ba1edef Mon Sep 17 00:00:00 2001\nFrom: Thomas Gleixner <tglx@linutronix.de>\nDate: Mon, 2 Jul 2018 09:34:29 +0200\nSubject: alarmtimer: Prevent overflow for relative nanosleep\n\nAir Icy reported:\n\n  UBSAN: Undefined behaviour in kernel\/time\/alarmtimer.c:811:7\n  signed integer overflow:\n  1529859276030040771 + 9223372036854775807 cannot be represented in type 'long long int'\n  Call Trace:\n   alarm_timer_nsleep+0x44c\/0x510 kernel\/time\/alarmtimer.c:811\n   __do_sys_clock_nanosleep kernel\/time\/posix-timers.c:1235 [inline]\n   __se_sys_clock_nanosleep kernel\/time\/posix-timers.c:1213 [inline]\n   __x64_sys_clock_nanosleep+0x326\/0x4e0 kernel\/time\/posix-timers.c:1213\n   do_syscall_64+0xb8\/0x3a0 arch\/x86\/entry\/common.c:290\n\nalarm_timer_nsleep() uses ktime_add() to add the current time and the\nrelative expiry value. ktime_add() has no sanity checks so the addition\ncan overflow when the relative timeout is large enough.\n\nUse ktime_add_safe() which has the necessary sanity checks in place and\nlimits the result to the valid range.\n\nFixes: 9a7adcf5c6de (\"timers: Posix interface for alarm-timers\")\nReported-by: Team OWL337 <icytxw@gmail.com>\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\nCc: John Stultz <john.stultz@linaro.org>\nLink: https:\/\/lkml.kernel.org\/r\/alpine.DEB.2.21.1807020926360.1595@nanos.tec.linutronix.de\n---\n kernel\/time\/alarmtimer.c | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/kernel\/time\/alarmtimer.c b\/kernel\/time\/alarmtimer.c\nindex 78a3cc555823..fa5de5e8de61 100644\n--- a\/kernel\/time\/alarmtimer.c\n+++ b\/kernel\/time\/alarmtimer.c\n@@ -808,7 +808,8 @@ static int alarm_timer_nsleep(const clockid_t which_clock, int flags,\n \t\/* Convert (if necessary) to absolute time *\/\n \tif (flags != TIMER_ABSTIME) {\n \t\tktime_t now = alarm_bases[type].gettime();\n-\t\texp = ktime_add(now, exp);\n+\n+\t\texp = ktime_add_safe(now, exp);\n \t}\n \n \tret = alarmtimer_do_nsleep(&alarm, exp, type);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-8636","CWE_ID":"190","category":"security","commit_id":"647bf3d8a8e5777319da92af672289b2a6c4dc66","commit_message":"From 647bf3d8a8e5777319da92af672289b2a6c4dc66 Mon Sep 17 00:00:00 2001\nFrom: Eyal Itkin <eyal.itkin@gmail.com>\nDate: Tue, 7 Feb 2017 16:45:19 +0300\nSubject: [PATCH] IB\/rxe: Fix mem_check_range integer overflow\n\nUpdate the range check to avoid integer-overflow in edge case.\nResolves CVE 2016-8636.\n\nSigned-off-by: Eyal Itkin <eyal.itkin@gmail.com>\nSigned-off-by: Dan Carpenter <dan.carpenter@oracle.com>\nReviewed-by: Leon Romanovsky <leonro@mellanox.com>\nSigned-off-by: Doug Ledford <dledford@redhat.com>\n---\n drivers\/infiniband\/sw\/rxe\/rxe_mr.c | 8 +++++---\n 1 file changed, 5 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/infiniband\/sw\/rxe\/rxe_mr.c b\/drivers\/infiniband\/sw\/rxe\/rxe_mr.c\nindex d0faca294006f..86a6585b847df 100644\n--- a\/drivers\/infiniband\/sw\/rxe\/rxe_mr.c\n+++ b\/drivers\/infiniband\/sw\/rxe\/rxe_mr.c\n@@ -59,9 +59,11 @@ int mem_check_range(struct rxe_mem *mem, u64 iova, size_t length)\n \n \tcase RXE_MEM_TYPE_MR:\n \tcase RXE_MEM_TYPE_FMR:\n-\t\treturn ((iova < mem->iova) ||\n-\t\t\t((iova + length) > (mem->iova + mem->length))) ?\n-\t\t\t-EFAULT : 0;\n+\t\tif (iova < mem->iova ||\n+\t\t    length > mem->length ||\n+\t\t    iova > mem->iova + mem->length - length)\n+\t\t\treturn -EFAULT;\n+\t\treturn 0;\n \n \tdefault:\n \t\treturn -EFAULT;\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2018-20174","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2016-2147","CWE_ID":"190","category":"security","commit_id":"d474ffc68290e0a83651c4432eeabfa62cd51e87","commit_message":"From d474ffc68290e0a83651c4432eeabfa62cd51e87 Mon Sep 17 00:00:00 2001\nFrom: Denys Vlasenko <vda.linux@googlemail.com>\nDate: Thu, 10 Mar 2016 11:47:58 +0100\nSubject: udhcp: fix a SEGV on malformed RFC1035-encoded domain name\n\nSigned-off-by: Denys Vlasenko <vda.linux@googlemail.com>\n---\n networking\/udhcp\/domain_codec.c | 13 +++++++++----\n 1 file changed, 9 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/networking\/udhcp\/domain_codec.c b\/networking\/udhcp\/domain_codec.c\nindex 05cdf51e9..cee31f14d 100644\n--- a\/networking\/udhcp\/domain_codec.c\n+++ b\/networking\/udhcp\/domain_codec.c\n@@ -63,11 +63,10 @@ char* FAST_FUNC dname_dec(const uint8_t *cstr, int clen, const char *pre)\n \t\t\t\tif (crtpos + *c + 1 > clen) \/* label too long? abort *\/\n \t\t\t\t\treturn NULL;\n \t\t\t\tif (dst)\n-\t\t\t\t\tmemcpy(dst + len, c + 1, *c);\n+\t\t\t\t\t\/* \\3com ---> \"com.\" *\/\n+\t\t\t\t\t((char*)mempcpy(dst + len, c + 1, *c))[0] = '.';\n \t\t\t\tlen += *c + 1;\n \t\t\t\tcrtpos += *c + 1;\n-\t\t\t\tif (dst)\n-\t\t\t\t\tdst[len - 1] = '.';\n \t\t\t} else {\n \t\t\t\t\/* NUL: end of current domain name *\/\n \t\t\t\tif (retpos == 0) {\n@@ -78,7 +77,10 @@ char* FAST_FUNC dname_dec(const uint8_t *cstr, int clen, const char *pre)\n \t\t\t\t\tcrtpos = retpos;\n \t\t\t\t\tretpos = depth = 0;\n \t\t\t\t}\n-\t\t\t\tif (dst)\n+\t\t\t\tif (dst && len != 0)\n+\t\t\t\t\t\/* \\4host\\3com\\0\\4host and we are at \\0:\n+\t\t\t\t\t * \\3com was converted to \"com.\", change dot to space.\n+\t\t\t\t\t *\/\n \t\t\t\t\tdst[len - 1] = ' ';\n \t\t\t}\n \n@@ -227,6 +229,9 @@ int main(int argc, char **argv)\n \tint len;\n \tuint8_t *encoded;\n \n+        uint8_t str[6] = { 0x00, 0x00, 0x02, 0x65, 0x65, 0x00 };\n+        printf(\"NUL:'%s'\\n\",   dname_dec(str, 6, \"\"));\n+\n #define DNAME_DEC(encoded,pre) dname_dec((uint8_t*)(encoded), sizeof(encoded), (pre))\n \tprintf(\"'%s'\\n\",       DNAME_DEC(\"\\4host\\3com\\0\", \"test1:\"));\n \tprintf(\"test2:'%s'\\n\", DNAME_DEC(\"\\4host\\3com\\0\\4host\\3com\\0\", \"\"));\n-- \ncgit v1.2.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-9446","CWE_ID":"190","category":"security","commit_id":"4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe","commit_message":"From 4cb1bcf1422bbcd79c0f683edb7ee85e3f7a31fe Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Sebastian=20Dr=C3=B6ge?= <sebastian@centricular.com>\nDate: Wed, 16 Nov 2016 20:41:39 +0200\nSubject: vmncdec: Sanity-check width\/height before using it\n\nWe will allocate a screen area of width*height*bpp bytes, however this\ncalculation can easily overflow if too high width or height are given\ninside the stream. Nonetheless we would just assume that enough memory\nwas allocated, try to fill it and overwrite as much memory as wanted.\n\nAlso allocate the screen area filled with zeroes to ensure that we start\nwith full-black and not any random (or not so random) data.\n\nhttps:\/\/scarybeastsecurity.blogspot.gr\/2016\/11\/0day-poc-risky-design-decisions-in.html\n\nIdeally we should just remove this plugin in favour of the one in\ngst-libav, which generally seems to be of better code quality.\n\nhttps:\/\/bugzilla.gnome.org\/show_bug.cgi?id=774533\n---\n gst\/vmnc\/vmncdec.c | 6 +++++-\n 1 file changed, 5 insertions(+), 1 deletion(-)\n\n(limited to 'gst\/vmnc\/vmncdec.c')\n\n","diff_code":"diff --git a\/gst\/vmnc\/vmncdec.c b\/gst\/vmnc\/vmncdec.c\nindex e8d498c..b3c9778 100644\n--- a\/gst\/vmnc\/vmncdec.c\n+++ b\/gst\/vmnc\/vmncdec.c\n@@ -260,7 +260,7 @@ vmnc_handle_wmvi_rectangle (GstVMncDec * dec, struct RfbRectangle *rect,\n   gst_video_codec_state_unref (state);\n \n   g_free (dec->imagedata);\n-  dec->imagedata = g_malloc (dec->format.width * dec->format.height *\n+  dec->imagedata = g_malloc0 (dec->format.width * dec->format.height *\n       dec->format.bytes_per_pixel);\n   GST_DEBUG_OBJECT (dec, \"Allocated image data at %p\", dec->imagedata);\n \n@@ -790,6 +790,10 @@ vmnc_handle_packet (GstVMncDec * dec, const guint8 * data, int len,\n             GST_WARNING_OBJECT (dec, \"Rectangle out of range, type %d\", r.type);\n             return ERROR_INVALID;\n           }\n+        } else if (r.width > 16384 || r.height > 16384) {\n+          GST_WARNING_OBJECT (dec, \"Width or height too high: %ux%u\", r.width,\n+              r.height);\n+          return ERROR_INVALID;\n         }\n \n         switch (r.type) {\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-8098","CWE_ID":"190","category":"security","commit_id":"3db1af1f370295ad5355b8f64b865a2a357bcac0","commit_message":"From 3db1af1f370295ad5355b8f64b865a2a357bcac0 Mon Sep 17 00:00:00 2001\nFrom: Patrick Steinhardt <ps@pks.im>\nDate: Thu, 8 Mar 2018 12:36:46 +0000\nSubject: [PATCH] index: error out on unreasonable prefix-compressed path\n lengths\n\nWhen computing the complete path length from the encoded\nprefix-compressed path, we end up just allocating the complete path\nwithout ever checking what the encoded path length actually is. This can\neasily lead to a denial of service by just encoding an unreasonable long\npath name inside of the index. Git already enforces a maximum path\nlength of 4096 bytes. As we also have that enforcement ready in some\nplaces, just make sure that the resulting path is smaller than\nGIT_PATH_MAX.\n\nReported-by: Krishna Ram Prakash R <krp@gtux.in>\nReported-by: Vivek Parikh <viv0411.parikh@gmail.com>\n---\n src\/index.c | 4 ++++\n 1 file changed, 4 insertions(+)\n\n","diff_code":"diff --git a\/src\/index.c b\/src\/index.c\nindex 20586f52c3..a867547fbb 100644\n--- a\/src\/index.c\n+++ b\/src\/index.c\n@@ -2379,6 +2379,10 @@ static int read_entry(\n \n \t\tGITERR_CHECK_ALLOC_ADD(&path_len, prefix_len, suffix_len);\n \t\tGITERR_CHECK_ALLOC_ADD(&path_len, path_len, 1);\n+\n+\t\tif (path_len > GIT_PATH_MAX)\n+\t\t\treturn index_error_invalid(\"unreasonable path length\");\n+\n \t\ttmp_path = git__malloc(path_len);\n \t\tGITERR_CHECK_ALLOC(tmp_path);\n \n","owner":"libgit2","repo":"libgit2","source":"cve"},{"CVE_ID":"CVE-2016-6250","CWE_ID":"190","category":"security","commit_id":"3014e19820ea53c15c90f9d447ca3e668a0b76c6","commit_message":"From 3014e19820ea53c15c90f9d447ca3e668a0b76c6 Mon Sep 17 00:00:00 2001\nFrom: Tim Kientzle <kientzle@acm.org>\nDate: Sat, 28 May 2016 11:50:39 -0700\nSubject: [PATCH] Issue 711:  Be more careful about verifying filename lengths\n when writing ISO9660 archives\n\n* Don't cast size_t to int, since this can lead to overflow\n  on machines where sizeof(int) < sizeof(size_t)\n* Check a + b > limit by writing it as\n    a > limit || b > limit || a + b > limit\n  to avoid problems when a + b wraps around.\n---\n libarchive\/archive_write_set_format_iso9660.c | 18 ++++++++++--------\n 1 file changed, 10 insertions(+), 8 deletions(-)\n\n","diff_code":"diff --git a\/libarchive\/archive_write_set_format_iso9660.c b\/libarchive\/archive_write_set_format_iso9660.c\nindex 4d832fb6e..cb3e54e8d 100644\n--- a\/libarchive\/archive_write_set_format_iso9660.c\n+++ b\/libarchive\/archive_write_set_format_iso9660.c\n@@ -6225,7 +6225,7 @@ isoent_gen_joliet_identifier(struct archive_write *a, struct isoent *isoent,\n \tunsigned char *p;\n \tsize_t l;\n \tint r;\n-\tint ffmax, parent_len;\n+\tsize_t ffmax, parent_len;\n \tstatic const struct archive_rb_tree_ops rb_ops = {\n \t\tisoent_cmp_node_joliet, isoent_cmp_key_joliet\n \t};\n@@ -6239,7 +6239,7 @@ isoent_gen_joliet_identifier(struct archive_write *a, struct isoent *isoent,\n \telse\n \t\tffmax = 128;\n \n-\tr = idr_start(a, idr, isoent->children.cnt, ffmax, 6, 2, &rb_ops);\n+\tr = idr_start(a, idr, isoent->children.cnt, (int)ffmax, 6, 2, &rb_ops);\n \tif (r < 0)\n \t\treturn (r);\n \n@@ -6252,7 +6252,7 @@ isoent_gen_joliet_identifier(struct archive_write *a, struct isoent *isoent,\n \t\tint ext_off, noff, weight;\n \t\tsize_t lt;\n \n-\t\tif ((int)(l = np->file->basename_utf16.length) > ffmax)\n+\t\tif ((l = np->file->basename_utf16.length) > ffmax)\n \t\t\tl = ffmax;\n \n \t\tp = malloc((l+1)*2);\n@@ -6285,7 +6285,7 @@ isoent_gen_joliet_identifier(struct archive_write *a, struct isoent *isoent,\n \t\t\/*\n \t\t * Get a length of MBS of a full-pathname.\n \t\t *\/\n-\t\tif ((int)np->file->basename_utf16.length > ffmax) {\n+\t\tif (np->file->basename_utf16.length > ffmax) {\n \t\t\tif (archive_strncpy_l(&iso9660->mbs,\n \t\t\t    (const char *)np->identifier, l,\n \t\t\t\tiso9660->sconv_from_utf16be) != 0 &&\n@@ -6302,7 +6302,9 @@ isoent_gen_joliet_identifier(struct archive_write *a, struct isoent *isoent,\n \n \t\t\/* If a length of full-pathname is longer than 240 bytes,\n \t\t * it violates Joliet extensions regulation. *\/\n-\t\tif (parent_len + np->mb_len > 240) {\n+\t\tif (parent_len > 240\n+\t\t    || np->mb_len > 240\n+\t\t    || parent_len + np->mb_len > 240) {\n \t\t\tarchive_set_error(&a->archive, ARCHIVE_ERRNO_MISC,\n \t\t\t    \"The regulation of Joliet extensions;\"\n \t\t\t    \" A length of a full-pathname of `%s' is \"\n@@ -6314,11 +6316,11 @@ isoent_gen_joliet_identifier(struct archive_write *a, struct isoent *isoent,\n \n \t\t\/* Make an offset of the number which is used to be set\n \t\t * hexadecimal number to avoid duplicate identifier. *\/\n-\t\tif ((int)l == ffmax)\n+\t\tif (l == ffmax)\n \t\t\tnoff = ext_off - 6;\n-\t\telse if ((int)l == ffmax-2)\n+\t\telse if (l == ffmax-2)\n \t\t\tnoff = ext_off - 4;\n-\t\telse if ((int)l == ffmax-4)\n+\t\telse if (l == ffmax-4)\n \t\t\tnoff = ext_off - 2;\n \t\telse\n \t\t\tnoff = ext_off;\n","owner":"libarchive","repo":"libarchive","source":"cve"},{"CVE_ID":"CVE-2018-8793","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2017-7542","CWE_ID":"190","category":"security","commit_id":"6399f1fae4ec29fab5ec76070435555e256ca3a6","commit_message":"From 6399f1fae4ec29fab5ec76070435555e256ca3a6 Mon Sep 17 00:00:00 2001\nFrom: Sabrina Dubroca <sd@queasysnail.net>\nDate: Wed, 19 Jul 2017 22:28:55 +0200\nSubject: [PATCH] ipv6: avoid overflow of offset in ip6_find_1stfragopt\n\nIn some cases, offset can overflow and can cause an infinite loop in\nip6_find_1stfragopt(). Make it unsigned int to prevent the overflow, and\ncap it at IPV6_MAXPLEN, since packets larger than that should be invalid.\n\nThis problem has been here since before the beginning of git history.\n\nSigned-off-by: Sabrina Dubroca <sd@queasysnail.net>\nAcked-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n net\/ipv6\/output_core.c | 8 ++++++--\n 1 file changed, 6 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/net\/ipv6\/output_core.c b\/net\/ipv6\/output_core.c\nindex e9065b8d3af85..abb2c307fbe83 100644\n--- a\/net\/ipv6\/output_core.c\n+++ b\/net\/ipv6\/output_core.c\n@@ -78,7 +78,7 @@ EXPORT_SYMBOL(ipv6_select_ident);\n \n int ip6_find_1stfragopt(struct sk_buff *skb, u8 **nexthdr)\n {\n-\tu16 offset = sizeof(struct ipv6hdr);\n+\tunsigned int offset = sizeof(struct ipv6hdr);\n \tunsigned int packet_len = skb_tail_pointer(skb) -\n \t\tskb_network_header(skb);\n \tint found_rhdr = 0;\n@@ -86,6 +86,7 @@ int ip6_find_1stfragopt(struct sk_buff *skb, u8 **nexthdr)\n \n \twhile (offset <= packet_len) {\n \t\tstruct ipv6_opt_hdr *exthdr;\n+\t\tunsigned int len;\n \n \t\tswitch (**nexthdr) {\n \n@@ -111,7 +112,10 @@ int ip6_find_1stfragopt(struct sk_buff *skb, u8 **nexthdr)\n \n \t\texthdr = (struct ipv6_opt_hdr *)(skb_network_header(skb) +\n \t\t\t\t\t\t offset);\n-\t\toffset += ipv6_optlen(exthdr);\n+\t\tlen = ipv6_optlen(exthdr);\n+\t\tif (len + offset >= IPV6_MAXPLEN)\n+\t\t\treturn -EINVAL;\n+\t\toffset += len;\n \t\t*nexthdr = &exthdr->nexthdr;\n \t}\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-9754","CWE_ID":"190","category":"security","commit_id":"59643d1535eb220668692a5359de22545af579f6","commit_message":"From 59643d1535eb220668692a5359de22545af579f6 Mon Sep 17 00:00:00 2001\nFrom: \"Steven Rostedt (Red Hat)\" <rostedt@goodmis.org>\nDate: Fri, 13 May 2016 09:34:12 -0400\nSubject: ring-buffer: Prevent overflow of size in ring_buffer_resize()\n\nIf the size passed to ring_buffer_resize() is greater than MAX_LONG - BUF_PAGE_SIZE\nthen the DIV_ROUND_UP() will return zero.\n\nHere's the details:\n\n  # echo 18014398509481980 > \/sys\/kernel\/debug\/tracing\/buffer_size_kb\n\ntracing_entries_write() processes this and converts kb to bytes.\n\n 18014398509481980 << 10 = 18446744073709547520\n\nand this is passed to ring_buffer_resize() as unsigned long size.\n\n size = DIV_ROUND_UP(size, BUF_PAGE_SIZE);\n\nWhere DIV_ROUND_UP(a, b) is (a + b - 1)\/b\n\nBUF_PAGE_SIZE is 4080 and here\n\n 18446744073709547520 + 4080 - 1 = 18446744073709551599\n\nwhere 18446744073709551599 is still smaller than 2^64\n\n 2^64 - 18446744073709551599 = 17\n\nBut now 18446744073709551599 \/ 4080 = 4521260802379792\n\nand size = size * 4080 = 18446744073709551360\n\nThis is checked to make sure its still greater than 2 * 4080,\nwhich it is.\n\nThen we convert to the number of buffer pages needed.\n\n nr_page = DIV_ROUND_UP(size, BUF_PAGE_SIZE)\n\nbut this time size is 18446744073709551360 and\n\n 2^64 - (18446744073709551360 + 4080 - 1) = -3823\n\nThus it overflows and the resulting number is less than 4080, which makes\n\n  3823 \/ 4080 = 0\n\nan nr_pages is set to this. As we already checked against the minimum that\nnr_pages may be, this causes the logic to fail as well, and we crash the\nkernel.\n\nThere's no reason to have the two DIV_ROUND_UP() (that's just result of\nhistorical code changes), clean up the code and fix this bug.\n\nCc: stable@vger.kernel.org # 3.5+\nFixes: 83f40318dab00 (\"ring-buffer: Make removal of ring buffer pages atomic\")\nSigned-off-by: Steven Rostedt <rostedt@goodmis.org>\n---\n kernel\/trace\/ring_buffer.c | 9 ++++-----\n 1 file changed, 4 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/kernel\/trace\/ring_buffer.c b\/kernel\/trace\/ring_buffer.c\nindex 99d64cd58c52..9c143739b8d7 100644\n--- a\/kernel\/trace\/ring_buffer.c\n+++ b\/kernel\/trace\/ring_buffer.c\n@@ -1657,14 +1657,13 @@ int ring_buffer_resize(struct ring_buffer *buffer, unsigned long size,\n \t    !cpumask_test_cpu(cpu_id, buffer->cpumask))\n \t\treturn size;\n \n-\tsize = DIV_ROUND_UP(size, BUF_PAGE_SIZE);\n-\tsize *= BUF_PAGE_SIZE;\n+\tnr_pages = DIV_ROUND_UP(size, BUF_PAGE_SIZE);\n \n \t\/* we need a minimum of two pages *\/\n-\tif (size < BUF_PAGE_SIZE * 2)\n-\t\tsize = BUF_PAGE_SIZE * 2;\n+\tif (nr_pages < 2)\n+\t\tnr_pages = 2;\n \n-\tnr_pages = DIV_ROUND_UP(size, BUF_PAGE_SIZE);\n+\tsize = nr_pages * BUF_PAGE_SIZE;\n \n \t\/*\n \t * Don't succeed if resizing is disabled, as a reader might be\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"stoth68000","repo":"media-tree","source":"cve"},{"CVE_ID":"CVE-2016-9132","CWE_ID":"190","category":"security","commit_id":"06a93345fb715dfaefbdb5774ec66eff46fdfaa3","commit_message":"From 06a93345fb715dfaefbdb5774ec66eff46fdfaa3 Mon Sep 17 00:00:00 2001\nFrom: Jack Lloyd <jack@randombit.net>\nDate: Wed, 23 Nov 2016 12:46:45 -0500\nSubject: [PATCH] Check for overflow in BER decoder EOC scanning\n\n---\n doc\/security.rst         | 11 ++++++++++-\n src\/lib\/asn1\/ber_dec.cpp |  5 ++++-\n src\/lib\/utils\/info.txt   |  3 ++-\n src\/lib\/utils\/safeint.h  | 39 +++++++++++++++++++++++++++++++++++++++\n 4 files changed, 55 insertions(+), 3 deletions(-)\n create mode 100644 src\/lib\/utils\/safeint.h\n\n","diff_code":"diff --git a\/doc\/security.rst b\/doc\/security.rst\nindex faefca7d52..151c279f64 100644\n--- a\/doc\/security.rst\n+++ b\/doc\/security.rst\n@@ -21,7 +21,16 @@ Advisories\n 2016\n ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-* 2016-10-8871 (CVE-2016-8871) OAEP side channel\n+* 2016-11-27 (CVE-2016-xxxx) Integer overflow in BER decoder\n+\n+  While decoding BER length fields, an integer overflow could occur. This could\n+  occur while parsing untrusted inputs such as X.509 certificates. The overflow\n+  does not seem to lead to any obviously exploitable condition, but exploitation\n+  cannot be positively ruled out. Only 32-bit platforms are likely affected; to\n+  cause an overflow on 64-bit the parsed data would have to be many gigabytes.\n+  Bug found by Falko Strenzke, cryptosource GmbH.\n+\n+* 2016-10-26 (CVE-2016-8871) OAEP side channel\n \n   A side channel in OAEP decoding could be used to distinguish RSA ciphertexts\n   that did or did not have a leading 0 byte. For an attacker capable of\ndiff --git a\/src\/lib\/asn1\/ber_dec.cpp b\/src\/lib\/asn1\/ber_dec.cpp\nindex ac676cd087..81c04aa6ad 100644\n--- a\/src\/lib\/asn1\/ber_dec.cpp\n+++ b\/src\/lib\/asn1\/ber_dec.cpp\n@@ -9,6 +9,7 @@\n #include <botan\/ber_dec.h>\n #include <botan\/bigint.h>\n #include <botan\/loadstor.h>\n+#include <botan\/internal\/safeint.h>\n \n namespace Botan {\n \n@@ -126,7 +127,9 @@ size_t find_eoc(DataSource* ber)\n       size_t item_size = decode_length(&source, length_size);\n       source.discard_next(item_size);\n \n-      length += item_size + length_size + tag_size;\n+      length = BOTAN_CHECKED_ADD(length, item_size);\n+      length = BOTAN_CHECKED_ADD(length, tag_size);\n+      length = BOTAN_CHECKED_ADD(length, length_size);\n \n       if(type_tag == EOC && class_tag == UNIVERSAL)\n          break;\ndiff --git a\/src\/lib\/utils\/info.txt b\/src\/lib\/utils\/info.txt\nindex 820dd407d9..306e6e9adb 100644\n--- a\/src\/lib\/utils\/info.txt\n+++ b\/src\/lib\/utils\/info.txt\n@@ -1,4 +1,4 @@\n-define UTIL_FUNCTIONS 20150919\n+define UTIL_FUNCTIONS 20161127\n \n load_on always\n \n@@ -31,6 +31,7 @@ filesystem.h\n os_utils.h\n prefetch.h\n rounding.h\n+safeint.h\n semaphore.h\n stl_util.h\n <\/header:internal>\ndiff --git a\/src\/lib\/utils\/safeint.h b\/src\/lib\/utils\/safeint.h\nnew file mode 100644\nindex 0000000000..e0bd66232c\n--- \/dev\/null\n+++ b\/src\/lib\/utils\/safeint.h\n@@ -0,0 +1,39 @@\n+\/*\n+* Safe(r) Integer Handling\n+* (C) 2016 Jack Lloyd\n+*\n+* Botan is released under the Simplified BSD License (see license.txt)\n+*\/\n+\n+#ifndef BOTAN_UTILS_SAFE_INT_H__\n+#define BOTAN_UTILS_SAFE_INT_H__\n+\n+#include <botan\/exceptn.h>\n+#include <string>\n+\n+namespace Botan {\n+\n+class Integer_Overflow_Detected : public Exception\n+   {\n+   public:\n+      Integer_Overflow_Detected(const std::string& file, int line) :\n+         Exception(\"Integer overflow detected at \" + file + \":\" + std::to_string(line))\n+         {}\n+   };\n+\n+inline size_t checked_add(size_t x, size_t y, const char* file, int line)\n+   {\n+   \/\/ TODO: use __builtin_x_overflow on GCC and Clang\n+   size_t z = x + y;\n+   if(z < x)\n+      {\n+      throw Integer_Overflow_Detected(file, line);\n+      }\n+   return z;\n+   }\n+\n+#define BOTAN_CHECKED_ADD(x,y) checked_add(x,y,__FILE__,__LINE__)\n+\n+}\n+\n+#endif\n","owner":"randombit","repo":"botan","source":"cve"},{"CVE_ID":"CVE-2015-8895","CWE_ID":"190","category":"security","commit_id":"0f6fc2d5bf8f500820c3dbcf0d23ee14f2d9f734","commit_message":"From 0f6fc2d5bf8f500820c3dbcf0d23ee14f2d9f734 Mon Sep 17 00:00:00 2001\nFrom: cristy <urban-warrior@git.imagemagick.org>\nDate: Sat, 30 May 2015 00:49:11 +0000\nSubject: [PATCH]\n\n---\n MagickCore\/memory.c  | 31 +++++++++++++++++++++++--------\n MagickCore\/studio.h  |  6 +++---\n MagickCore\/version.c | 13 +++++++++++--\n MagickCore\/version.h |  6 +++---\n MagickWand\/studio.h  |  6 +++---\n coders\/icon.c        |  6 ++++--\n coders\/pict.c        |  6 +++---\n configure            |  7 ++++---\n configure.ac         |  5 +++--\n 9 files changed, 57 insertions(+), 29 deletions(-)\n\n","diff_code":"diff --git a\/MagickCore\/memory.c b\/MagickCore\/memory.c\nindex fa1d44ea74..50755a91a1 100644\n--- a\/MagickCore\/memory.c\n+++ b\/MagickCore\/memory.c\n@@ -606,7 +606,8 @@ MagickExport MemoryInfo *AcquireVirtualMemory(const size_t count,\n       else\n         RelinquishMagickResource(MapResource,length);\n     }\n-  if (memory_info->blob == NULL)\n+  if ((memory_info->blob == NULL) &&\n+      (AcquireMagickResource(DiskResource,length) != MagickFalse))\n     {\n       int\n         file;\n@@ -615,15 +616,26 @@ MagickExport MemoryInfo *AcquireVirtualMemory(const size_t count,\n         Anonymous memory mapping failed, try file-backed memory mapping.\n       *\/\n       file=AcquireUniqueFileResource(memory_info->filename);\n-      if (file != -1)\n+      if (file == -1)\n+        RelinquishMagickResource(DiskResource,length);\n+      else\n         {\n-          if ((lseek(file,length-1,SEEK_SET) >= 0) && (write(file,\"\",1) == 1))\n+          if ((lseek(file,length-1,SEEK_SET) < 0) || (write(file,\"\",1) != 1))\n+            RelinquishMagickResource(DiskResource,length);\n+          else\n             {\n-              memory_info->blob=MapBlob(file,IOMode,0,length);\n-              if (memory_info->blob != NULL)\n+              if (AcquireMagickResource(MapResource,length) == MagickFalse)\n+                RelinquishMagickResource(DiskResource,length);\n+              else\n                 {\n-                  memory_info->type=MapVirtualMemory;\n-                  (void) AcquireMagickResource(MapResource,length);\n+                  memory_info->blob=MapBlob(file,IOMode,0,length);\n+                  if (memory_info->blob != NULL)\n+                    memory_info->type=MapVirtualMemory;\n+                  else\n+                    {\n+                      RelinquishMagickResource(MapResource,length);\n+                      RelinquishMagickResource(DiskResource,length);\n+                    }\n                 }\n             }\n           (void) close(file);\n@@ -1033,7 +1045,10 @@ MagickExport MemoryInfo *RelinquishVirtualMemory(MemoryInfo *memory_info)\n         memory_info->blob=NULL;\n         RelinquishMagickResource(MapResource,memory_info->length);\n         if (*memory_info->filename != '\\0')\n-          (void) RelinquishUniqueFileResource(memory_info->filename);\n+          {\n+            (void) RelinquishUniqueFileResource(memory_info->filename);\n+            RelinquishMagickResource(DiskResource,memory_info->length);\n+          }\n         break;\n       }\n       case UnalignedVirtualMemory:\ndiff --git a\/MagickCore\/studio.h b\/MagickCore\/studio.h\nindex c434028d75..6905a11faa 100644\n--- a\/MagickCore\/studio.h\n+++ b\/MagickCore\/studio.h\n@@ -46,9 +46,6 @@ extern \"C\" {\n #if defined(_magickcore_inline) && !defined(inline)\n # define inline  _magickcore_inline\n #endif\n-#if defined(_magickcore_restrict) && !defined(restrict)\n-# define restrict  _magickcore_restrict\n-#endif\n # if defined(__cplusplus) || defined(c_plusplus)\n #  undef inline\n # endif\n@@ -75,6 +72,9 @@ extern \"C\" {\n #  include <stdlib.h>\n # endif\n #endif\n+#if defined(_magickcore_restrict) && !defined(restrict)\n+# define restrict  _magickcore_restrict\n+#endif\n #if defined(MAGICKCORE_HAVE_STRING_H)\n # if !defined(STDC_HEADERS) && defined(MAGICKCORE_HAVE_MEMORY_H)\n #  include <memory.h>\ndiff --git a\/MagickCore\/version.c b\/MagickCore\/version.c\nindex 36e5b5361d..d4407437ab 100644\n--- a\/MagickCore\/version.c\n+++ b\/MagickCore\/version.c\n@@ -219,17 +219,26 @@ MagickExport const char *GetMagickDelegates(void)\n MagickExport const char *GetMagickFeatures(void)\n {\n   return \"DPC\"\n-#if defined(MAGICKCORE_BUILD_MODULES) || defined(_DLL)\n-  \" Modules\"\n+#if defined(MAGICKCORE_WINDOWS_SUPPORT) && defined(_DEBUG)\n+  \" Debug\"\n+#endif\n+#if defined(MAGICKCORE_CIPHER_SUPPORT)\n+  \" Cipher\"\n #endif\n #if defined(MAGICKCORE_HDRI_SUPPORT)\n   \" HDRI\"\n #endif\n+#if defined(MAGICKCORE_BUILD_MODULES) || defined(_DLL)\n+  \" Modules\"\n+#endif\n #if defined(MAGICKCORE_OPENCL_SUPPORT)\n   \" OpenCL\"\n #endif\n #if defined(MAGICKCORE_OPENMP_SUPPORT)\n   \" OpenMP\"\n+#endif\n+#if defined(ZERO_CONFIGURATION_SUPPORT)\n+  \" Zero-configuration\"\n #endif\n   ;\n }\ndiff --git a\/MagickCore\/version.h b\/MagickCore\/version.h\nindex 7aa97dc012..f5221f15c0 100644\n--- a\/MagickCore\/version.h\n+++ b\/MagickCore\/version.h\n@@ -27,7 +27,7 @@ extern \"C\" {\n *\/\n #define MagickPackageName \"ImageMagick\"\n #define MagickCopyright  \"Copyright (C) 1999-2015 ImageMagick Studio LLC\"\n-#define MagickSVNRevision  \"18658:18662M\"\n+#define MagickSVNRevision  \"18670M\"\n #define MagickLibVersion  0x700\n #define MagickLibVersionText  \"7.0.0\"\n #define MagickLibVersionNumber  0,0,0\n@@ -48,12 +48,12 @@ extern \"C\" {\n #define MagickppLibAddendum  \"-0\"\n #define MagickppLibInterface  0\n #define MagickppLibMinInterface  0\n-#define MagickReleaseDate  \"2015-05-26\"\n+#define MagickReleaseDate  \"2015-05-29\"\n #define MagickChangeDate   \"20120427\"\n #define MagickAuthoritativeLicense  \\\n   \"http:\/\/www.imagemagick.org\/script\/license.php\"\n #define MagickAuthoritativeURL  \"http:\/\/www.imagemagick.org\"\n-#define MagickFeatures \"DPC HDRI OpenMP\"\n+#define MagickFeatures \"DPC HDRI Cipher OpenMP\"\n #define MagickDelegates \"bzlib djvu mpeg fftw fpx fontconfig freetype jbig jng jpeg lcms lzma openexr pango png ps tiff webp x xml zlib\"\n #define MagickHomeURL  \"file:\/\/\/usr\/local\/share\/doc\/ImageMagick-7\/index.html\"\n #if (MAGICKCORE_QUANTUM_DEPTH == 8)\ndiff --git a\/MagickWand\/studio.h b\/MagickWand\/studio.h\nindex b463d0a9ba..7bf0aa3a12 100644\n--- a\/MagickWand\/studio.h\n+++ b\/MagickWand\/studio.h\n@@ -46,9 +46,6 @@ extern \"C\" {\n #if defined(_magickcore_inline) && !defined(inline)\n # define inline _magickcore_inline\n #endif\n-#if defined(_magickcore_restrict) && !defined(restrict)\n-# define restrict  _magickcore_restrict\n-#endif\n # if defined(__cplusplus) || defined(c_plusplus)\n #  undef inline\n # endif\n@@ -77,6 +74,9 @@ extern \"C\" {\n #  include <stdlib.h>\n # endif\n #endif\n+#if defined(_magickcore_restrict) && !defined(restrict)\n+# define restrict  _magickcore_restrict\n+#endif\n #if defined(MAGICKCORE_HAVE_STRING_H)\n # if !defined(STDC_HEADERS) && defined(MAGICKCORE_HAVE_MEMORY_H)\n #  include <memory.h>\ndiff --git a\/coders\/icon.c b\/coders\/icon.c\nindex 94c31e6b8e..222dec2541 100644\n--- a\/coders\/icon.c\n+++ b\/coders\/icon.c\n@@ -183,8 +183,8 @@ Image *AutoResizeImage(const Image *image,const char *option,\n       p++;\n \n     size=(size_t)strtol(p,&q,10);\n-    if (p == q || size < 16 || size > 256)\n-        return((Image *) NULL);\n+    if ((p == q) || (size < 16) || (size > 256))\n+      return((Image *) NULL);\n \n     p=q;\n     sizes[i++]=size;\n@@ -354,6 +354,8 @@ static Image *ReadICONImage(const ImageInfo *image_info,\n           Icon image encoded as a compressed PNG image.\n         *\/\n         length=icon_file.directory[i].size;\n+        if (~length < 16)\n+          ThrowReaderException(ResourceLimitError,\"MemoryAllocationFailed\");\n         png=(unsigned char *) AcquireQuantumMemory(length+16,sizeof(*png));\n         if (png == (unsigned char *) NULL)\n           ThrowReaderException(ResourceLimitError,\"MemoryAllocationFailed\");\ndiff --git a\/coders\/pict.c b\/coders\/pict.c\nindex 4f51eb3937..027119d815 100644\n--- a\/coders\/pict.c\n+++ b\/coders\/pict.c\n@@ -1637,6 +1637,7 @@ static MagickBooleanType WritePICTImage(const ImageInfo *image_info,\n   size_t\n     bytes_per_line,\n     count,\n+    row_bytes,\n     storage_class;\n \n   ssize_t\n@@ -1649,7 +1650,6 @@ static MagickBooleanType WritePICTImage(const ImageInfo *image_info,\n \n   unsigned short\n     base_address,\n-    row_bytes,\n     transfer_mode;\n \n   \/*\n@@ -1681,7 +1681,7 @@ static MagickBooleanType WritePICTImage(const ImageInfo *image_info,\n   source_rectangle=size_rectangle;\n   destination_rectangle=size_rectangle;\n   base_address=0xff;\n-  row_bytes=(unsigned short) (image->columns | 0x8000);\n+  row_bytes=image->columns;\n   bounds.top=0;\n   bounds.left=0;\n   bounds.bottom=(short) image->rows;\n@@ -1711,7 +1711,7 @@ static MagickBooleanType WritePICTImage(const ImageInfo *image_info,\n       pixmap.bits_per_pixel=32;\n       pixmap.pack_type=0x04;\n       transfer_mode=0x40;\n-      row_bytes=(unsigned short) ((4*image->columns) | 0x8000);\n+      row_bytes=4*image->columns;\n     }\n   \/*\n     Allocate memory.\ndiff --git a\/configure b\/configure\nindex f1bfd46bcc..7633dd204c 100755\n--- a\/configure\n+++ b\/configure\n@@ -4341,7 +4341,7 @@ MAGICK_PATCHLEVEL_VERSION=0\n \n MAGICK_VERSION=7.0.0-0\n \n-MAGICK_SVN_REVISION=18658:18662M\n+MAGICK_SVN_REVISION=18670M\n \n \n # Substitute library versioning\n@@ -21655,6 +21655,7 @@ if test \"$enable_cipher\" = 'yes'; then\n \n $as_echo \"#define CIPHER_SUPPORT 1\" >>confdefs.h\n \n+    MAGICK_FEATURES=\"Cipher $MAGICK_FEATURES\"\n fi\n \n # Build a zero-configuration version of ImageMagick.\n@@ -21670,7 +21671,7 @@ if test \"$enable_zero_configuration\" = 'yes'; then\n \n $as_echo \"#define ZERO_CONFIGURATION_SUPPORT 1\" >>confdefs.h\n \n-    MAGICK_FEATURES=\"Zero-Configuration $MAGICK_FEATURES\"\n+    MAGICK_FEATURES=\"Zero-configuration $MAGICK_FEATURES\"\n fi\n \n # Build a high dynamic range version of ImageMagick.\n@@ -36535,7 +36536,7 @@ fi\n if test \"$build_modules\" != 'no'; then\n     MAGICK_DEP_LIBS=\"$USER_LIBS $LCMS_LIBS $FREETYPE_LIBS $LQR_LIBS $FFTW_LIBS $FONTCONFIG_LIBS $XEXT_LIBS $IPC_LIBS $X11_LIBS $XT_LIBS $LZMA_LIBS $BZLIB_LIBS $ZLIB_LIBS $LTDL_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"\n else\n-    MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $OPENJPEG_LIBS $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"\n+    MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $LIBOPENJP2_LIB $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"\n fi\n \n \ndiff --git a\/configure.ac b\/configure.ac\nindex 5d2cb8a131..ba0e111862 100755\n--- a\/configure.ac\n+++ b\/configure.ac\n@@ -642,6 +642,7 @@ AC_ARG_ENABLE([cipher],\n \n if test \"$enable_cipher\" = 'yes'; then\n     AC_DEFINE(CIPHER_SUPPORT,1,[permit enciphering and deciphering image pixels])\n+    MAGICK_FEATURES=\"Cipher $MAGICK_FEATURES\"\n fi\n \n # Build a zero-configuration version of ImageMagick.\n@@ -653,7 +654,7 @@ AC_ARG_ENABLE([zero-configuration],\n \n if test \"$enable_zero_configuration\" = 'yes'; then\n     AC_DEFINE(ZERO_CONFIGURATION_SUPPORT,1,[Build self-contained, embeddable, zero-configuration ImageMagick])\n-    MAGICK_FEATURES=\"Zero-Configuration $MAGICK_FEATURES\"\n+    MAGICK_FEATURES=\"Zero-configuration $MAGICK_FEATURES\"\n fi\n \n # Build a high dynamic range version of ImageMagick.\n@@ -3996,7 +3997,7 @@ fi\n if test \"$build_modules\" != 'no'; then\n     MAGICK_DEP_LIBS=\"$USER_LIBS $LCMS_LIBS $FREETYPE_LIBS $LQR_LIBS $FFTW_LIBS $FONTCONFIG_LIBS $XEXT_LIBS $IPC_LIBS $X11_LIBS $XT_LIBS $LZMA_LIBS $BZLIB_LIBS $ZLIB_LIBS $LTDL_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"\n else\n-    MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $OPENJPEG_LIBS $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"\n+    MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $LIBOPENJP2_LIB $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"\n fi\n AC_SUBST(MAGICK_DEP_LIBS)\n \n","owner":"ImageMagick","repo":"ImageMagick","source":"cve"},{"CVE_ID":"CVE-2018-8792","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2016-2347","CWE_ID":"190","category":"security","commit_id":"6fcdb8f1f538b9d63e63a5fa199c5514a15d4564","commit_message":"From 6fcdb8f1f538b9d63e63a5fa199c5514a15d4564 Mon Sep 17 00:00:00 2001\nFrom: Simon Howard <fraggle@soulsphere.org>\nDate: Thu, 17 Mar 2016 00:40:19 -0400\nSubject: [PATCH] Fix integer underflow vulnerability in L3 decode.\n\nMarcin 'Icewall' Noga of Cisco TALOS discovered that the level 3 header\ndecoding routines were vulnerable to an integer underflow, if the 32-bit\nheader length was less than the base level 3 header length. This could\nlead to an exploitable heap corruption condition.\n\nThanks go to Marcin Noga and Regina Wilson of Cisco TALOS for reporting\nthis vulnerability.\n---\n lib\/lha_file_header.c | 7 ++++++-\n 1 file changed, 6 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/lib\/lha_file_header.c b\/lib\/lha_file_header.c\nindex 2889eec..b06be91 100644\n--- a\/lib\/lha_file_header.c\n+++ b\/lib\/lha_file_header.c\n@@ -351,6 +351,10 @@ static uint8_t *extend_raw_data(LHAFileHeader **header,\n \tsize_t new_raw_len;\n \tuint8_t *result;\n \n+\tif (nbytes > LEVEL_3_MAX_HEADER_LEN) {\n+\t\treturn NULL;\n+\t}\n+\n \t\/\/ Reallocate the header and raw_data area to be larger.\n \n \tnew_raw_len = RAW_DATA_LEN(header) + nbytes;\n@@ -797,7 +801,8 @@ static int decode_level3_header(LHAFileHeader **header, LHAInputStream *stream)\n \n \theader_len = lha_decode_uint32(&RAW_DATA(header, 24));\n \n-\tif (header_len > LEVEL_3_MAX_HEADER_LEN) {\n+\tif (header_len > LEVEL_3_MAX_HEADER_LEN\n+\t || header_len < RAW_DATA_LEN(header)) {\n \t\treturn 0;\n \t}\n \n","owner":"fragglet","repo":"lhasa","source":"cve"},{"CVE_ID":"CVE-2016-2177","CWE_ID":"190","category":"security","commit_id":"a004e72b95835136d3f1ea90517f706c24c03da7","commit_message":"From a004e72b95835136d3f1ea90517f706c24c03da7 Mon Sep 17 00:00:00 2001\nFrom: Matt Caswell <matt@openssl.org>\nDate: Thu, 5 May 2016 11:10:26 +0100\nSubject: [PATCH] Avoid some undefined pointer arithmetic\n\nA common idiom in the codebase is:\n\nif (p + len > limit)\n{\n    return; \/* Too long *\/\n}\n\nWhere \"p\" points to some malloc'd data of SIZE bytes and\nlimit == p + SIZE\n\n\"len\" here could be from some externally supplied data (e.g. from a TLS\nmessage).\n\nThe rules of C pointer arithmetic are such that \"p + len\" is only well\ndefined where len <= SIZE. Therefore the above idiom is actually\nundefined behaviour.\n\nFor example this could cause problems if some malloc implementation\nprovides an address for \"p\" such that \"p + len\" actually overflows for\nvalues of len that are too big and therefore p + len < limit!\n\nIssue reported by Guido Vranken.\n\nCVE-2016-2177\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\n---\n ssl\/s3_srvr.c  | 14 ++++++-------\n ssl\/ssl_sess.c |  2 +-\n ssl\/t1_lib.c   | 56 +++++++++++++++++++++++++++-----------------------\n 3 files changed, 38 insertions(+), 34 deletions(-)\n\n","diff_code":"diff --git a\/ssl\/s3_srvr.c b\/ssl\/s3_srvr.c\nindex ab28702ee9..ab7f6900d2 100644\n--- a\/ssl\/s3_srvr.c\n+++ b\/ssl\/s3_srvr.c\n@@ -980,7 +980,7 @@ int ssl3_get_client_hello(SSL *s)\n \n         session_length = *(p + SSL3_RANDOM_SIZE);\n \n-        if (p + SSL3_RANDOM_SIZE + session_length + 1 >= d + n) {\n+        if (SSL3_RANDOM_SIZE + session_length + 1 >= (d + n) - p) {\n             al = SSL_AD_DECODE_ERROR;\n             SSLerr(SSL_F_SSL3_GET_CLIENT_HELLO, SSL_R_LENGTH_TOO_SHORT);\n             goto f_err;\n@@ -998,7 +998,7 @@ int ssl3_get_client_hello(SSL *s)\n     \/* get the session-id *\/\n     j = *(p++);\n \n-    if (p + j > d + n) {\n+    if ((d + n) - p < j) {\n         al = SSL_AD_DECODE_ERROR;\n         SSLerr(SSL_F_SSL3_GET_CLIENT_HELLO, SSL_R_LENGTH_TOO_SHORT);\n         goto f_err;\n@@ -1054,14 +1054,14 @@ int ssl3_get_client_hello(SSL *s)\n \n     if (SSL_IS_DTLS(s)) {\n         \/* cookie stuff *\/\n-        if (p + 1 > d + n) {\n+        if ((d + n) - p < 1) {\n             al = SSL_AD_DECODE_ERROR;\n             SSLerr(SSL_F_SSL3_GET_CLIENT_HELLO, SSL_R_LENGTH_TOO_SHORT);\n             goto f_err;\n         }\n         cookie_len = *(p++);\n \n-        if (p + cookie_len > d + n) {\n+        if ((d + n ) - p < cookie_len) {\n             al = SSL_AD_DECODE_ERROR;\n             SSLerr(SSL_F_SSL3_GET_CLIENT_HELLO, SSL_R_LENGTH_TOO_SHORT);\n             goto f_err;\n@@ -1131,7 +1131,7 @@ int ssl3_get_client_hello(SSL *s)\n         }\n     }\n \n-    if (p + 2 > d + n) {\n+    if ((d + n ) - p < 2) {\n         al = SSL_AD_DECODE_ERROR;\n         SSLerr(SSL_F_SSL3_GET_CLIENT_HELLO, SSL_R_LENGTH_TOO_SHORT);\n         goto f_err;\n@@ -1145,7 +1145,7 @@ int ssl3_get_client_hello(SSL *s)\n     }\n \n     \/* i bytes of cipher data + 1 byte for compression length later *\/\n-    if ((p + i + 1) > (d + n)) {\n+    if ((d + n) - p < i + 1) {\n         \/* not enough data *\/\n         al = SSL_AD_DECODE_ERROR;\n         SSLerr(SSL_F_SSL3_GET_CLIENT_HELLO, SSL_R_LENGTH_MISMATCH);\n@@ -1211,7 +1211,7 @@ int ssl3_get_client_hello(SSL *s)\n \n     \/* compression *\/\n     i = *(p++);\n-    if ((p + i) > (d + n)) {\n+    if ((d + n) - p < i) {\n         \/* not enough data *\/\n         al = SSL_AD_DECODE_ERROR;\n         SSLerr(SSL_F_SSL3_GET_CLIENT_HELLO, SSL_R_LENGTH_MISMATCH);\ndiff --git a\/ssl\/ssl_sess.c b\/ssl\/ssl_sess.c\nindex b182998343..54ee78350b 100644\n--- a\/ssl\/ssl_sess.c\n+++ b\/ssl\/ssl_sess.c\n@@ -573,7 +573,7 @@ int ssl_get_prev_session(SSL *s, unsigned char *session_id, int len,\n     int r;\n #endif\n \n-    if (session_id + len > limit) {\n+    if (limit - session_id < len) {\n         fatal = 1;\n         goto err;\n     }\ndiff --git a\/ssl\/t1_lib.c b\/ssl\/t1_lib.c\nindex fb64607acf..cdac0118ca 100644\n--- a\/ssl\/t1_lib.c\n+++ b\/ssl\/t1_lib.c\n@@ -1867,11 +1867,11 @@ static void ssl_check_for_safari(SSL *s, const unsigned char *data,\n         0x02, 0x03,             \/* SHA-1\/ECDSA *\/\n     };\n \n-    if (data >= (limit - 2))\n+    if (limit - data <= 2)\n         return;\n     data += 2;\n \n-    if (data > (limit - 4))\n+    if (limit - data < 4)\n         return;\n     n2s(data, type);\n     n2s(data, size);\n@@ -1879,7 +1879,7 @@ static void ssl_check_for_safari(SSL *s, const unsigned char *data,\n     if (type != TLSEXT_TYPE_server_name)\n         return;\n \n-    if (data + size > limit)\n+    if (limit - data < size)\n         return;\n     data += size;\n \n@@ -1887,7 +1887,7 @@ static void ssl_check_for_safari(SSL *s, const unsigned char *data,\n         const size_t len1 = sizeof(kSafariExtensionsBlock);\n         const size_t len2 = sizeof(kSafariTLS12ExtensionsBlock);\n \n-        if (data + len1 + len2 != limit)\n+        if (limit - data != (int)(len1 + len2))\n             return;\n         if (memcmp(data, kSafariExtensionsBlock, len1) != 0)\n             return;\n@@ -1896,7 +1896,7 @@ static void ssl_check_for_safari(SSL *s, const unsigned char *data,\n     } else {\n         const size_t len = sizeof(kSafariExtensionsBlock);\n \n-        if (data + len != limit)\n+        if (limit - data != (int)(len))\n             return;\n         if (memcmp(data, kSafariExtensionsBlock, len) != 0)\n             return;\n@@ -2053,19 +2053,19 @@ static int ssl_scan_clienthello_tlsext(SSL *s, unsigned char **p,\n     if (data == limit)\n         goto ri_check;\n \n-    if (data > (limit - 2))\n+    if (limit - data < 2)\n         goto err;\n \n     n2s(data, len);\n \n-    if (data + len != limit)\n+    if (limit - data != len)\n         goto err;\n \n-    while (data <= (limit - 4)) {\n+    while (limit - data >= 4) {\n         n2s(data, type);\n         n2s(data, size);\n \n-        if (data + size > (limit))\n+        if (limit - data < size)\n             goto err;\n # if 0\n         fprintf(stderr, \"Received extension type %d size %d\\n\", type, size);\n@@ -2472,18 +2472,18 @@ static int ssl_scan_clienthello_custom_tlsext(SSL *s,\n     if (s->hit || s->cert->srv_ext.meths_count == 0)\n         return 1;\n \n-    if (data >= limit - 2)\n+    if (limit - data <= 2)\n         return 1;\n     n2s(data, len);\n \n-    if (data > limit - len)\n+    if (limit - data < len)\n         return 1;\n \n-    while (data <= limit - 4) {\n+    while (limit - data >= 4) {\n         n2s(data, type);\n         n2s(data, size);\n \n-        if (data + size > limit)\n+        if (limit - data < size)\n             return 1;\n         if (custom_ext_parse(s, 1 \/* server *\/ , type, data, size, al) <= 0)\n             return 0;\n@@ -2569,20 +2569,20 @@ static int ssl_scan_serverhello_tlsext(SSL *s, unsigned char **p,\n                              SSL_TLSEXT_HB_DONT_SEND_REQUESTS);\n # endif\n \n-    if (data >= (d + n - 2))\n+    if ((d + n) - data <= 2)\n         goto ri_check;\n \n     n2s(data, length);\n-    if (data + length != d + n) {\n+    if ((d + n) - data != length) {\n         *al = SSL_AD_DECODE_ERROR;\n         return 0;\n     }\n \n-    while (data <= (d + n - 4)) {\n+    while ((d + n) - data >= 4) {\n         n2s(data, type);\n         n2s(data, size);\n \n-        if (data + size > (d + n))\n+        if ((d + n) - data < size)\n             goto ri_check;\n \n         if (s->tlsext_debug_cb)\n@@ -3307,29 +3307,33 @@ int tls1_process_ticket(SSL *s, unsigned char *session_id, int len,\n     \/* Skip past DTLS cookie *\/\n     if (SSL_IS_DTLS(s)) {\n         i = *(p++);\n-        p += i;\n-        if (p >= limit)\n+\n+        if (limit - p <= i)\n             return -1;\n+\n+        p += i;\n     }\n     \/* Skip past cipher list *\/\n     n2s(p, i);\n-    p += i;\n-    if (p >= limit)\n+    if (limit - p <= i)\n         return -1;\n+    p += i;\n+\n     \/* Skip past compression algorithm list *\/\n     i = *(p++);\n-    p += i;\n-    if (p > limit)\n+    if (limit - p < i)\n         return -1;\n+    p += i;\n+\n     \/* Now at start of extensions *\/\n-    if ((p + 2) >= limit)\n+    if (limit - p <= 2)\n         return 0;\n     n2s(p, i);\n-    while ((p + 4) <= limit) {\n+    while (limit - p >= 4) {\n         unsigned short type, size;\n         n2s(p, type);\n         n2s(p, size);\n-        if (p + size > limit)\n+        if (limit - p < size)\n             return 0;\n         if (type == TLSEXT_TYPE_session_ticket) {\n             int r;\n-- \n2.17.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2018-20176","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2018-20182","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2016-9387","CWE_ID":"190","category":"security","commit_id":"d91198abd00fc435a397fe6bad906a4c1748e9cf","commit_message":"From d91198abd00fc435a397fe6bad906a4c1748e9cf Mon Sep 17 00:00:00 2001\nFrom: Michael Adams <mdadams@ece.uvic.ca>\nDate: Sun, 23 Oct 2016 03:34:35 -0700\nSubject: [PATCH] Fixed another integer overflow problem.\n\n---\n src\/libjasper\/jpc\/jpc_dec.c | 6 +++++-\n 1 file changed, 5 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/src\/libjasper\/jpc\/jpc_dec.c b\/src\/libjasper\/jpc\/jpc_dec.c\nindex d2f258e..4f24660 100644\n--- a\/src\/libjasper\/jpc\/jpc_dec.c\n+++ b\/src\/libjasper\/jpc\/jpc_dec.c\n@@ -1195,6 +1195,7 @@ static int jpc_dec_process_siz(jpc_dec_t *dec, jpc_ms_t *ms)\n \tint htileno;\n \tint vtileno;\n \tjpc_dec_cmpt_t *cmpt;\n+\tsize_t size;\n \n \tdec->xstart = siz->xoff;\n \tdec->ystart = siz->yoff;\n@@ -1231,7 +1232,10 @@ static int jpc_dec_process_siz(jpc_dec_t *dec, jpc_ms_t *ms)\n \n \tdec->numhtiles = JPC_CEILDIV(dec->xend - dec->tilexoff, dec->tilewidth);\n \tdec->numvtiles = JPC_CEILDIV(dec->yend - dec->tileyoff, dec->tileheight);\n-\tdec->numtiles = dec->numhtiles * dec->numvtiles;\n+\tif (!jas_safe_size_mul(dec->numhtiles, dec->numvtiles, &size)) {\n+\t\treturn -1;\n+\t}\n+\tdec->numtiles = size;\n \tJAS_DBGLOG(10, (\"numtiles = %d; numhtiles = %d; numvtiles = %d;\\n\",\n \t  dec->numtiles, dec->numhtiles, dec->numvtiles));\n \tif (!(dec->tiles = jas_alloc2(dec->numtiles, sizeof(jpc_dec_tile_t)))) {\n","owner":"mdadams","repo":"jasper","source":"cve"},{"CVE_ID":"CVE-2016-6164","CWE_ID":"190","category":"security","commit_id":"8a3221cc67a516dfc1700bdae3566ec52c7ee823","commit_message":"From 8a3221cc67a516dfc1700bdae3566ec52c7ee823 Mon Sep 17 00:00:00 2001\nFrom: Michael Niedermayer <michael@niedermayer.cc>\nDate: Tue, 28 Jun 2016 23:49:36 +0200\nSubject: [PATCH] avformat\/mov: Check sample size\n\nFixes integer overflow\nFixes: poc.mp4\n\nFound-by: ajax secure <ajax4sec@hotmail.com>\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n---\n libavformat\/mov.c | 11 ++++++++++-\n 1 file changed, 10 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/libavformat\/mov.c b\/libavformat\/mov.c\nindex 973115ab89..a929f74511 100644\n--- a\/libavformat\/mov.c\n+++ b\/libavformat\/mov.c\n@@ -2843,7 +2843,12 @@ static void mov_build_index(MOVContext *mov, AVStream *st)\n                 sample_size = sc->stsz_sample_size > 0 ? sc->stsz_sample_size : sc->sample_sizes[current_sample];\n                 if (sc->pseudo_stream_id == -1 ||\n                    sc->stsc_data[stsc_index].id - 1 == sc->pseudo_stream_id) {\n-                    AVIndexEntry *e = &st->index_entries[st->nb_index_entries++];\n+                    AVIndexEntry *e;\n+                    if (sample_size > 0x3FFFFFFF) {\n+                        av_log(mov->fc, AV_LOG_ERROR, \"Sample size %u is too large\\n\", sample_size);\n+                        return;\n+                    }\n+                    e = &st->index_entries[st->nb_index_entries++];\n                     e->pos = current_offset;\n                     e->timestamp = current_dts;\n                     e->size = sample_size;\n@@ -2968,6 +2973,10 @@ static void mov_build_index(MOVContext *mov, AVStream *st)\n                     av_log(mov->fc, AV_LOG_ERROR, \"wrong chunk count %d\\n\", total);\n                     return;\n                 }\n+                if (size > 0x3FFFFFFF) {\n+                    av_log(mov->fc, AV_LOG_ERROR, \"Sample size %u is too large\\n\", size);\n+                    return;\n+                }\n                 e = &st->index_entries[st->nb_index_entries++];\n                 e->pos = current_offset;\n                 e->timestamp = current_dts;\n-- \n2.11.0\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-5769","CWE_ID":"190","category":"security","commit_id":"6c5211a0cef0cc2854eaa387e0eb036e012904d0","commit_message":"From 6c5211a0cef0cc2854eaa387e0eb036e012904d0 Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Mon, 20 Jun 2016 21:51:42 -0700\nSubject: [PATCH] Fix bug #72455:  Heap Overflow due to integer overflows\n\n---\n ext\/mcrypt\/mcrypt.c | 92 ++++++++++++++++++++++++---------------------\n 1 file changed, 50 insertions(+), 42 deletions(-)\n\n","diff_code":"diff --git a\/ext\/mcrypt\/mcrypt.c b\/ext\/mcrypt\/mcrypt.c\nindex 194660d864ea..3cbb913414a5 100644\n--- a\/ext\/mcrypt\/mcrypt.c\n+++ b\/ext\/mcrypt\/mcrypt.c\n@@ -44,7 +44,7 @@\n \n static int le_mcrypt;\n \n-typedef struct _php_mcrypt { \n+typedef struct _php_mcrypt {\n \tMCRYPT td;\n \tzend_bool init;\n } php_mcrypt;\n@@ -292,7 +292,7 @@ ZEND_DECLARE_MODULE_GLOBALS(mcrypt)\n \n zend_module_entry mcrypt_module_entry = {\n \tSTANDARD_MODULE_HEADER,\n-\t\"mcrypt\", \n+\t\"mcrypt\",\n \tmcrypt_functions,\n \tPHP_MINIT(mcrypt), PHP_MSHUTDOWN(mcrypt),\n \tNULL, NULL,\n@@ -376,7 +376,7 @@ ZEND_GET_MODULE(mcrypt)\n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"r\", &mcryptind) == FAILURE) {\t\t\t\\\n \t\treturn;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\\\n \t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\\\n-\tZEND_FETCH_RESOURCE (pm, php_mcrypt *, &mcryptind, -1, \"MCrypt\", le_mcrypt);\t\t\t\t\n+\tZEND_FETCH_RESOURCE (pm, php_mcrypt *, &mcryptind, -1, \"MCrypt\", le_mcrypt);\n \n #define MCRYPT_GET_MODE_DIR_ARGS(DIRECTORY)\t\t\t\t\t\t\t\t\\\n \tchar *dir = NULL;                                                   \\\n@@ -407,7 +407,7 @@ PHP_INI_END()\n static void php_mcrypt_module_dtor(zend_rsrc_list_entry *rsrc TSRMLS_DC) \/* {{{ *\/\n {\n \tphp_mcrypt *pm = (php_mcrypt *) rsrc->ptr;\n-\tif (pm) {\t\n+\tif (pm) {\n \t\tmcrypt_generic_deinit(pm->td);\n \t\tmcrypt_module_close(pm->td);\n \t\tefree(pm);\n@@ -548,7 +548,7 @@ PHP_MINFO_FUNCTION(mcrypt) \/* {{{ *\/\n \tsmart_str_free(&tmp1);\n \tsmart_str_free(&tmp2);\n \tphp_info_print_table_end();\n-\t\n+\n \tDISPLAY_INI_ENTRIES();\n }\n \/* }}} *\/\n@@ -563,17 +563,17 @@ PHP_FUNCTION(mcrypt_module_open)\n \tint   mode_len,   mode_dir_len;\n \tMCRYPT td;\n \tphp_mcrypt *pm;\n-   \n+\n \tif (zend_parse_parameters (ZEND_NUM_ARGS() TSRMLS_CC, \"ssss\",\n \t\t&cipher, &cipher_len, &cipher_dir, &cipher_dir_len,\n \t\t&mode,   &mode_len,   &mode_dir,   &mode_dir_len)) {\n \t\treturn;\n \t}\n-\t\n+\n \ttd = mcrypt_module_open (\n \t\tcipher,\n \t\tcipher_dir_len > 0 ? cipher_dir : MCG(algorithms_dir),\n-\t\tmode, \n+\t\tmode,\n \t\tmode_dir_len > 0 ? mode_dir : MCG(modes_dir)\n \t);\n \n@@ -600,7 +600,7 @@ PHP_FUNCTION(mcrypt_generic_init)\n \tint max_key_size, key_size, iv_size;\n \tphp_mcrypt *pm;\n \tint result = 0;\n-\t\n+\n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"rss\", &mcryptind, &key, &key_len, &iv, &iv_len) == FAILURE) {\n \t\treturn;\n \t}\n@@ -679,7 +679,7 @@ PHP_FUNCTION(mcrypt_generic)\n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"rs\", &mcryptind, &data, &data_len) == FAILURE) {\n \t\treturn;\n \t}\n-\t\n+\n \tZEND_FETCH_RESOURCE(pm, php_mcrypt *, &mcryptind, -1, \"MCrypt\", le_mcrypt);\n \tPHP_MCRYPT_INIT_CHECK\n \n@@ -692,6 +692,10 @@ PHP_FUNCTION(mcrypt_generic)\n \tif (mcrypt_enc_is_block_mode(pm->td) == 1) { \/* It's a block algorithm *\/\n \t\tblock_size = mcrypt_enc_get_block_size(pm->td);\n \t\tdata_size = (((data_len - 1) \/ block_size) + 1) * block_size;\n+\t\tif (data_size <= 0) {\n+\t\t\tphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"Integer overflow in data size\");\n+\t\t\tRETURN_FALSE;\n+\t\t}\n \t\tdata_s = emalloc(data_size + 1);\n \t\tmemset(data_s, 0, data_size);\n \t\tmemcpy(data_s, data, data_len);\n@@ -701,7 +705,7 @@ PHP_FUNCTION(mcrypt_generic)\n \t\tmemset(data_s, 0, data_size);\n \t\tmemcpy(data_s, data, data_len);\n \t}\n-\t\n+\n \tmcrypt_generic(pm->td, data_s, data_size);\n \tdata_s[data_size] = '\\0';\n \n@@ -720,11 +724,11 @@ PHP_FUNCTION(mdecrypt_generic)\n \tphp_mcrypt *pm;\n \tchar* data_s;\n \tint block_size, data_size;\n-\t\n+\n \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"rs\", &mcryptind, &data, &data_len) == FAILURE) {\n \t\treturn;\n \t}\n-\t\n+\n \tZEND_FETCH_RESOURCE(pm, php_mcrypt * , &mcryptind, -1, \"MCrypt\", le_mcrypt);\n \tPHP_MCRYPT_INIT_CHECK\n \n@@ -737,6 +741,10 @@ PHP_FUNCTION(mdecrypt_generic)\n \tif (mcrypt_enc_is_block_mode(pm->td) == 1) { \/* It's a block algorithm *\/\n \t\tblock_size = mcrypt_enc_get_block_size(pm->td);\n \t\tdata_size = (((data_len - 1) \/ block_size) + 1) * block_size;\n+\t\tif (data_size <= 0) {\n+\t\t\tphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"Integer overflow in data size\");\n+\t\t\tRETURN_FALSE;\n+\t\t}\n \t\tdata_s = emalloc(data_size + 1);\n \t\tmemset(data_s, 0, data_size);\n \t\tmemcpy(data_s, data, data_len);\n@@ -746,7 +754,7 @@ PHP_FUNCTION(mdecrypt_generic)\n \t\tmemset(data_s, 0, data_size);\n \t\tmemcpy(data_s, data, data_len);\n \t}\n-\t\n+\n \tmdecrypt_generic(pm->td, data_s, data_size);\n \n \tRETVAL_STRINGL(data_s, data_size, 1);\n@@ -760,7 +768,7 @@ PHP_FUNCTION(mcrypt_enc_get_supported_key_sizes)\n {\n \tint i, count = 0;\n \tint *key_sizes;\n-\t\n+\n \tMCRYPT_GET_TD_ARG\n \tarray_init(return_value);\n \n@@ -829,7 +837,7 @@ PHP_FUNCTION(mcrypt_enc_is_block_algorithm)\n \tMCRYPT_GET_TD_ARG\n \n \tif (mcrypt_enc_is_block_algorithm(pm->td) == 1) {\n-\t\tRETURN_TRUE \n+\t\tRETURN_TRUE\n \t} else {\n \t\tRETURN_FALSE\n \t}\n@@ -908,7 +916,7 @@ PHP_FUNCTION(mcrypt_enc_get_modes_name)\n PHP_FUNCTION(mcrypt_module_self_test)\n {\n \tMCRYPT_GET_MODE_DIR_ARGS(algorithms_dir);\n-\t\n+\n \tif (mcrypt_module_self_test(module, dir) == 0) {\n \t\tRETURN_TRUE;\n \t} else {\n@@ -922,7 +930,7 @@ PHP_FUNCTION(mcrypt_module_self_test)\n PHP_FUNCTION(mcrypt_module_is_block_algorithm_mode)\n {\n \tMCRYPT_GET_MODE_DIR_ARGS(modes_dir)\n-\t\n+\n \tif (mcrypt_module_is_block_algorithm_mode(module, dir) == 1) {\n \t\tRETURN_TRUE;\n \t} else {\n@@ -936,7 +944,7 @@ PHP_FUNCTION(mcrypt_module_is_block_algorithm_mode)\n PHP_FUNCTION(mcrypt_module_is_block_algorithm)\n {\n \tMCRYPT_GET_MODE_DIR_ARGS(algorithms_dir)\n-\t\n+\n \tif (mcrypt_module_is_block_algorithm(module, dir) == 1) {\n \t\tRETURN_TRUE;\n \t} else {\n@@ -950,7 +958,7 @@ PHP_FUNCTION(mcrypt_module_is_block_algorithm)\n PHP_FUNCTION(mcrypt_module_is_block_mode)\n {\n \tMCRYPT_GET_MODE_DIR_ARGS(modes_dir)\n-\t\n+\n \tif (mcrypt_module_is_block_mode(module, dir) == 1) {\n \t\tRETURN_TRUE;\n \t} else {\n@@ -964,7 +972,7 @@ PHP_FUNCTION(mcrypt_module_is_block_mode)\n PHP_FUNCTION(mcrypt_module_get_algo_block_size)\n {\n \tMCRYPT_GET_MODE_DIR_ARGS(algorithms_dir)\n-\t\n+\n \tRETURN_LONG(mcrypt_module_get_algo_block_size(module, dir));\n }\n \/* }}} *\/\n@@ -974,7 +982,7 @@ PHP_FUNCTION(mcrypt_module_get_algo_block_size)\n PHP_FUNCTION(mcrypt_module_get_algo_key_size)\n {\n \tMCRYPT_GET_MODE_DIR_ARGS(algorithms_dir);\n-\t\n+\n \tRETURN_LONG(mcrypt_module_get_algo_key_size(module, dir));\n }\n \/* }}} *\/\n@@ -985,7 +993,7 @@ PHP_FUNCTION(mcrypt_module_get_supported_key_sizes)\n {\n \tint i, count = 0;\n \tint *key_sizes;\n-\t\n+\n \tMCRYPT_GET_MODE_DIR_ARGS(algorithms_dir)\n \tarray_init(return_value);\n \n@@ -1011,7 +1019,7 @@ PHP_FUNCTION(mcrypt_list_algorithms)\n \t\t&lib_dir, &lib_dir_len) == FAILURE) {\n \t\treturn;\n \t}\n-\t\n+\n \tarray_init(return_value);\n \tmodules = mcrypt_list_algorithms(lib_dir, &count);\n \n@@ -1058,7 +1066,7 @@ PHP_FUNCTION(mcrypt_get_key_size)\n {\n \tchar *cipher;\n \tchar *module;\n-\tint   cipher_len, module_len; \n+\tint   cipher_len, module_len;\n \tchar *cipher_dir_string;\n \tchar *module_dir_string;\n \tMCRYPT td;\n@@ -1069,7 +1077,7 @@ PHP_FUNCTION(mcrypt_get_key_size)\n \t\t&cipher, &cipher_len, &module, &module_len) == FAILURE) {\n \t\treturn;\n \t}\n-\t\n+\n \ttd = mcrypt_module_open(cipher, cipher_dir_string, module, module_dir_string);\n \tif (td != MCRYPT_FAILED) {\n \t\tRETVAL_LONG(mcrypt_enc_get_key_size(td));\n@@ -1087,7 +1095,7 @@ PHP_FUNCTION(mcrypt_get_block_size)\n {\n \tchar *cipher;\n \tchar *module;\n-\tint   cipher_len, module_len; \n+\tint   cipher_len, module_len;\n \tchar *cipher_dir_string;\n \tchar *module_dir_string;\n \tMCRYPT td;\n@@ -1098,7 +1106,7 @@ PHP_FUNCTION(mcrypt_get_block_size)\n \t\t&cipher, &cipher_len, &module, &module_len) == FAILURE) {\n \t\treturn;\n \t}\n-\t\n+\n \ttd = mcrypt_module_open(cipher, cipher_dir_string, module, module_dir_string);\n \tif (td != MCRYPT_FAILED) {\n \t\tRETVAL_LONG(mcrypt_enc_get_block_size(td));\n@@ -1116,7 +1124,7 @@ PHP_FUNCTION(mcrypt_get_iv_size)\n {\n \tchar *cipher;\n \tchar *module;\n-\tint   cipher_len, module_len; \n+\tint   cipher_len, module_len;\n \tchar *cipher_dir_string;\n \tchar *module_dir_string;\n \tMCRYPT td;\n@@ -1127,7 +1135,7 @@ PHP_FUNCTION(mcrypt_get_iv_size)\n \t\t&cipher, &cipher_len, &module, &module_len) == FAILURE) {\n \t\treturn;\n \t}\n-\t\n+\n \ttd = mcrypt_module_open(cipher, cipher_dir_string, module, module_dir_string);\n \tif (td != MCRYPT_FAILED) {\n \t\tRETVAL_LONG(mcrypt_enc_get_iv_size(td));\n@@ -1217,7 +1225,7 @@ static void php_mcrypt_do_crypt(char* cipher, const char *key, int key_len, cons\n \t} else { \/* dertermine smallest supported key > length of requested key *\/\n \t\tuse_key_length = max_key_length; \/* start with max key length *\/\n \t\tfor (i = 0; i < count; i++) {\n-\t\t\tif (key_length_sizes[i] >= key_len && \n+\t\t\tif (key_length_sizes[i] >= key_len &&\n \t\t\t\tkey_length_sizes[i] < use_key_length)\n \t\t\t{\n \t\t\t\tuse_key_length = key_length_sizes[i];\n@@ -1228,11 +1236,11 @@ static void php_mcrypt_do_crypt(char* cipher, const char *key, int key_len, cons\n \t\tmemcpy(key_s, key, MIN(key_len, use_key_length));\n \t}\n \tmcrypt_free (key_length_sizes);\n-\t\n+\n \t\/* Check IV *\/\n \tiv_s = NULL;\n \tiv_size = mcrypt_enc_get_iv_size (td);\n-\t\n+\n \t\/* IV is required *\/\n \tif (mcrypt_enc_mode_has_iv(td) == 1) {\n \t\tif (argc == 5) {\n@@ -1272,7 +1280,7 @@ static void php_mcrypt_do_crypt(char* cipher, const char *key, int key_len, cons\n \t} else {\n \t\tmdecrypt_generic(td, data_s, data_size);\n \t}\n-\t\n+\n \tRETVAL_STRINGL(data_s, data_size, 1);\n \n \t\/* freeing vars *\/\n@@ -1294,9 +1302,9 @@ PHP_FUNCTION(mcrypt_encrypt)\n \tzval **mode;\n \tchar *cipher, *key, *data, *iv = NULL;\n \tint cipher_len, key_len, data_len, iv_len = 0;\n-\t\n+\n \tMCRYPT_GET_CRYPT_ARGS\n-\t\n+\n \tconvert_to_string_ex(mode);\n \n \tphp_mcrypt_do_crypt(cipher, key, key_len, data, data_len, Z_STRVAL_PP(mode), iv, iv_len, ZEND_NUM_ARGS(), MCRYPT_ENCRYPT, return_value TSRMLS_CC);\n@@ -1312,7 +1320,7 @@ PHP_FUNCTION(mcrypt_decrypt)\n \tint cipher_len, key_len, data_len, iv_len = 0;\n \n \tMCRYPT_GET_CRYPT_ARGS\n-\t\n+\n \tconvert_to_string_ex(mode);\n \n \tphp_mcrypt_do_crypt(cipher, key, key_len, data, data_len, Z_STRVAL_PP(mode), iv, iv_len, ZEND_NUM_ARGS(), MCRYPT_DECRYPT, return_value TSRMLS_CC);\n@@ -1326,7 +1334,7 @@ PHP_FUNCTION(mcrypt_ecb)\n \tzval **mode;\n \tchar *cipher, *key, *data, *iv = NULL;\n \tint cipher_len, key_len, data_len, iv_len = 0;\n-\t\n+\n \tMCRYPT_GET_CRYPT_ARGS\n \n \tconvert_to_long_ex(mode);\n@@ -1358,7 +1366,7 @@ PHP_FUNCTION(mcrypt_cfb)\n \tzval **mode;\n \tchar *cipher, *key, *data, *iv = NULL;\n \tint cipher_len, key_len, data_len, iv_len = 0;\n-\t\n+\n \tMCRYPT_GET_CRYPT_ARGS\n \n \tconvert_to_long_ex(mode);\n@@ -1374,7 +1382,7 @@ PHP_FUNCTION(mcrypt_ofb)\n \tzval **mode;\n \tchar *cipher, *key, *data, *iv = NULL;\n \tint cipher_len, key_len, data_len, iv_len = 0;\n-\t\n+\n \tMCRYPT_GET_CRYPT_ARGS\n \n \tconvert_to_long_ex(mode);\n@@ -1400,9 +1408,9 @@ PHP_FUNCTION(mcrypt_create_iv)\n \t\tphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"Cannot create an IV with a size of less than 1 or greater than %d\", INT_MAX);\n \t\tRETURN_FALSE;\n \t}\n-\t\n+\n \tiv = ecalloc(size + 1, 1);\n-\t\n+\n \tif (source == RANDOM || source == URANDOM) {\n #if PHP_WIN32\n \t\t\/* random\/urandom equivalent on Windows *\/\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2014-0143","CWE_ID":"190","category":"security","commit_id":"6a83f8b5bec6f59e56cc49bd49e4c3f8f805d56f","commit_message":"From 6a83f8b5bec6f59e56cc49bd49e4c3f8f805d56f Mon Sep 17 00:00:00 2001\nFrom: Kevin Wolf <kwolf@redhat.com>\nDate: Wed, 26 Mar 2014 13:06:06 +0100\nSubject: [PATCH] qcow2: Check maximum L1 size in qcow2_snapshot_load_tmp()\n (CVE-2014-0143)\n\nThis avoids an unbounded allocation.\n\nSigned-off-by: Kevin Wolf <kwolf@redhat.com>\nReviewed-by: Max Reitz <mreitz@redhat.com>\nSigned-off-by: Stefan Hajnoczi <stefanha@redhat.com>\n---\n block\/qcow2-snapshot.c     |  4 ++++\n block\/qcow2.c              |  4 +---\n block\/qcow2.h              |  4 ++++\n tests\/qemu-iotests\/080     | 15 ++++++++++++++-\n tests\/qemu-iotests\/080.out |  6 ++++++\n 5 files changed, 29 insertions(+), 4 deletions(-)\n\n","diff_code":"diff --git a\/block\/qcow2-snapshot.c b\/block\/qcow2-snapshot.c\nindex 715168e..5db4f30 100644\n--- a\/block\/qcow2-snapshot.c\n+++ b\/block\/qcow2-snapshot.c\n@@ -680,6 +680,10 @@ int qcow2_snapshot_load_tmp(BlockDriverState *bs,\n     sn = &s->snapshots[snapshot_index];\n \n     \/* Allocate and read in the snapshot's L1 table *\/\n+    if (sn->l1_size > QCOW_MAX_L1_SIZE) {\n+        error_setg(errp, \"Snapshot L1 table too large\");\n+        return -EFBIG;\n+    }\n     new_l1_bytes = sn->l1_size * sizeof(uint64_t);\n     new_l1_table = g_malloc0(align_offset(new_l1_bytes, 512));\n \ndiff --git a\/block\/qcow2.c b\/block\/qcow2.c\nindex be48a27..bb6000f 100644\n--- a\/block\/qcow2.c\n+++ b\/block\/qcow2.c\n@@ -638,9 +638,7 @@ static int qcow2_open(BlockDriverState *bs, QDict *options, int flags,\n     }\n \n     \/* read the level 1 table *\/\n-    if (header.l1_size > 0x2000000) {\n-        \/* 32 MB L1 table is enough for 2 PB images at 64k cluster size\n-         * (128 GB for 512 byte clusters, 2 EB for 2 MB clusters) *\/\n+    if (header.l1_size > QCOW_MAX_L1_SIZE) {\n         error_setg(errp, \"Active L1 table too large\");\n         ret = -EFBIG;\n         goto fail;\ndiff --git a\/block\/qcow2.h b\/block\/qcow2.h\nindex 3649465..f28e7d9 100644\n--- a\/block\/qcow2.h\n+++ b\/block\/qcow2.h\n@@ -44,6 +44,10 @@\n  * (128 GB for 512 byte clusters, 2 EB for 2 MB clusters) *\/\n #define QCOW_MAX_REFTABLE_SIZE 0x800000\n \n+\/* 32 MB L1 table is enough for 2 PB images at 64k cluster size\n+ * (128 GB for 512 byte clusters, 2 EB for 2 MB clusters) *\/\n+#define QCOW_MAX_L1_SIZE 0x2000000\n+\n \/* indicate that the refcount of the referenced cluster is exactly one. *\/\n #define QCOW_OFLAG_COPIED     (1ULL << 63)\n \/* indicate that the cluster is compressed (they never have the copied flag) *\/\ndiff --git a\/tests\/qemu-iotests\/080 b\/tests\/qemu-iotests\/080\nindex 59e7a44..6b3a3e7 100755\n--- a\/tests\/qemu-iotests\/080\n+++ b\/tests\/qemu-iotests\/080\n@@ -30,7 +30,8 @@ status=1\t# failure is the default!\n \n _cleanup()\n {\n-\t_cleanup_test_img\n+    rm -f $TEST_IMG.snap\n+    _cleanup_test_img\n }\n trap \"_cleanup; exit \\$status\" 0 1 2 3 15\n \n@@ -58,6 +59,10 @@ offset_ext_size=$((header_size + 4))\n \n offset_l2_table_0=$((0x40000))\n \n+offset_snap1=$((0x70000))\n+offset_snap1_l1_offset=$((offset_snap1 + 0))\n+offset_snap1_l1_size=$((offset_snap1 + 8))\n+\n echo\n echo \"== Huge header size ==\"\n _make_test_img 64M\n@@ -161,6 +166,14 @@ poke_file \"$TEST_IMG\" \"$offset_l2_table_0\" \"\\xbf\\xff\\xff\\xff\\xff\\xff\\x00\\x00\"\n poke_file \"$TEST_IMG\" \"$offset_l2_table_0\" \"\\x80\\x00\\x00\\xff\\xff\\xff\\x00\\x00\"\n { $QEMU_IMG snapshot -c test $TEST_IMG; } 2>&1 | _filter_qemu_io | _filter_testdir\n \n+echo\n+echo \"== Invalid snapshot L1 table ==\"\n+_make_test_img 64M\n+{ $QEMU_IO -c \"write 0 512\" $TEST_IMG; } 2>&1 | _filter_qemu_io | _filter_testdir\n+{ $QEMU_IMG snapshot -c test $TEST_IMG; } 2>&1 | _filter_testdir\n+poke_file \"$TEST_IMG\" \"$offset_snap1_l1_size\" \"\\x10\\x00\\x00\\x00\"\n+{ $QEMU_IMG convert -s test $TEST_IMG $TEST_IMG.snap; } 2>&1 | _filter_testdir\n+\n # success, all done\n echo \"*** done\"\n rm -f $seq.full\ndiff --git a\/tests\/qemu-iotests\/080.out b\/tests\/qemu-iotests\/080.out\nindex 4d84fbf..f7a943c 100644\n--- a\/tests\/qemu-iotests\/080.out\n+++ b\/tests\/qemu-iotests\/080.out\n@@ -74,4 +74,10 @@ wrote 512\/512 bytes at offset 0\n 512 bytes, X ops; XX:XX:XX.X (XXX YYY\/sec and XXX ops\/sec)\n qemu-img: Could not create snapshot 'test': -27 (File too large)\n qemu-img: Could not create snapshot 'test': -11 (Resource temporarily unavailable)\n+\n+== Invalid snapshot L1 table ==\n+Formatting 'TEST_DIR\/t.IMGFMT', fmt=IMGFMT size=67108864 \n+wrote 512\/512 bytes at offset 0\n+512 bytes, X ops; XX:XX:XX.X (XXX YYY\/sec and XXX ops\/sec)\n+qemu-img: Failed to load snapshot: Snapshot L1 table too large\n *** done\n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-6890","CWE_ID":"190","category":"security","commit_id":"194f592e205990ea8fce72b6c571c14350aca716","commit_message":"From 194f592e205990ea8fce72b6c571c14350aca716 Mon Sep 17 00:00:00 2001\nFrom: Alex Tutubalin <lexa@lexa.ru>\nDate: Sat, 4 Mar 2017 19:55:24 +0300\nSubject: [PATCH] Fixed possible foveon buffer overrun (Secunia SA750000)\n\n---\n dcraw_foveon.c | 8 ++++++--\n 1 file changed, 6 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/dcraw_foveon.c b\/dcraw_foveon.c\nindex d8b7005..bdde89d 100644\n--- a\/dcraw_foveon.c\n+++ b\/dcraw_foveon.c\n@@ -319,7 +319,7 @@ void CLASS foveon_huff (ushort *huff)\n void CLASS foveon_dp_load_raw()\n {\n   unsigned c, roff[4], row, col, diff;\n-  ushort huff[512], vpred[2][2], hpred[2];\n+  ushort huff[1024], vpred[2][2], hpred[2];\n \n   fseek (ifp, 8, SEEK_CUR);\n   foveon_huff (huff);\n@@ -346,12 +346,16 @@ void CLASS foveon_dp_load_raw()\n void CLASS foveon_load_camf()\n {\n   unsigned type, wide, high, i, j, row, col, diff;\n-  ushort huff[258], vpred[2][2] = {{512,512},{512,512}}, hpred[2];\n+  ushort huff[1024], vpred[2][2] = {{512,512},{512,512}}, hpred[2];\n \n   fseek (ifp, meta_offset, SEEK_SET);\n   type = get4();  get4();  get4();\n   wide = get4();\n   high = get4();\n+#ifdef LIBRAW_LIBRARY_BUILD\n+  if(wide>32767 || high > 32767 || wide*high > 20000000)\n+     throw LIBRAW_EXCEPTION_IO_CORRUPT;\n+#endif\n   if (type == 2) {\n     fread (meta_data, 1, meta_length, ifp);\n     for (i=0; i < meta_length; i++) {\n","owner":"LibRaw","repo":"LibRaw-demosaic-pack-GPL2","source":"cve"},{"CVE_ID":"CVE-2018-8798","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2017-14173","CWE_ID":"190","category":"security","commit_id":"48bcf7c39302cdf9b0d9202ad03bf1b95152c44d","commit_message":"From 48bcf7c39302cdf9b0d9202ad03bf1b95152c44d Mon Sep 17 00:00:00 2001\nFrom: Cristy <urban-warrior@imagemagick.org>\nDate: Fri, 1 Sep 2017 09:25:46 -0400\nSubject: [PATCH] https:\/\/github.com\/ImageMagick\/ImageMagick\/issues\/713\n\n---\n coders\/txt.c | 6 +++---\n 1 file changed, 3 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/coders\/txt.c b\/coders\/txt.c\nindex d9010078ee..258b70da81 100644\n--- a\/coders\/txt.c\n+++ b\/coders\/txt.c\n@@ -453,9 +453,9 @@ static Image *ReadTXTImage(const ImageInfo *image_info,ExceptionInfo *exception)\n       ThrowReaderException(CorruptImageError,\"ImproperImageHeader\");\n     image->columns=width;\n     image->rows=height;\n-    for (depth=1; (GetQuantumRange(depth)+1) < max_value; depth++)\n-      if (depth >= 64)\n-        break;\n+    if ((max_value == 0) || (max_value > 4294967295))\n+      ThrowReaderException(CorruptImageError,\"ImproperImageHeader\");\n+    for (depth=1; (GetQuantumRange(depth)+1) < max_value; depth++) ;\n     image->depth=depth;\n     status=SetImageExtent(image,image->columns,image->rows);\n     if (status == MagickFalse)\n","owner":"ImageMagick","repo":"ImageMagick","source":"cve"},{"CVE_ID":"CVE-2018-16435","CWE_ID":"190","category":"security","commit_id":"768f70ca405cd3159d990e962d54456773bb8cf8","commit_message":"From 768f70ca405cd3159d990e962d54456773bb8cf8 Mon Sep 17 00:00:00 2001\nFrom: Marti Maria <info@littlecms.com>\nDate: Wed, 15 Aug 2018 20:07:56 +0200\nSubject: [PATCH] Upgrade Visual studio 2017 15.8\n\n- Upgrade to 15.8\n- Add check on CGATS memory allocation (thanks to Quang Nguyen for\npointing out this)\n---\n Projects\/VC2017\/jpegicc\/jpegicc.vcxproj           |  1 +\n Projects\/VC2017\/lcms2_DLL\/lcms2_DLL.vcxproj       |  2 +-\n Projects\/VC2017\/lcms2_static\/lcms2_static.vcxproj |  2 +-\n Projects\/VC2017\/linkicc\/linkicc.vcxproj           |  2 +-\n Projects\/VC2017\/psicc\/psicc.vcxproj               |  2 +-\n Projects\/VC2017\/testbed\/testbed.vcxproj           |  2 +-\n Projects\/VC2017\/tiffdiff\/tiffdiff.vcxproj         |  2 +-\n Projects\/VC2017\/tifficc\/tifficc.vcxproj           |  2 +-\n Projects\/VC2017\/transicc\/transicc.vcxproj         |  1 +\n src\/cmscgats.c                                    | 14 ++++++++++----\n 10 files changed, 19 insertions(+), 11 deletions(-)\n\n","diff_code":"diff --git a\/Projects\/VC2017\/jpegicc\/jpegicc.vcxproj b\/Projects\/VC2017\/jpegicc\/jpegicc.vcxproj\nindex ab26a53..39cfd00 100644\n--- a\/Projects\/VC2017\/jpegicc\/jpegicc.vcxproj\n+++ b\/Projects\/VC2017\/jpegicc\/jpegicc.vcxproj\n@@ -22,6 +22,7 @@\n     <ProjectGuid>{62812507-F926-4968-96A9-17678460AD90}<\/ProjectGuid>\n     <RootNamespace>jpegicc<\/RootNamespace>\n     <Keyword>Win32Proj<\/Keyword>\n+    <WindowsTargetPlatformVersion>10.0.17134.0<\/WindowsTargetPlatformVersion>\n   <\/PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" \/>\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">\ndiff --git a\/Projects\/VC2017\/lcms2_DLL\/lcms2_DLL.vcxproj b\/Projects\/VC2017\/lcms2_DLL\/lcms2_DLL.vcxproj\nindex 4c8aa3f..d1bf3eb 100644\n--- a\/Projects\/VC2017\/lcms2_DLL\/lcms2_DLL.vcxproj\n+++ b\/Projects\/VC2017\/lcms2_DLL\/lcms2_DLL.vcxproj\n@@ -22,7 +22,7 @@\n     <ProjectGuid>{8C51BE48-ADB8-4089-A9EC-F6BF993A0548}<\/ProjectGuid>\n     <RootNamespace>lcms2_DLL<\/RootNamespace>\n     <Keyword>Win32Proj<\/Keyword>\n-    <WindowsTargetPlatformVersion>8.1<\/WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0<\/WindowsTargetPlatformVersion>\n   <\/PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" \/>\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">\ndiff --git a\/Projects\/VC2017\/lcms2_static\/lcms2_static.vcxproj b\/Projects\/VC2017\/lcms2_static\/lcms2_static.vcxproj\nindex 2a9988a..9fc05ce 100644\n--- a\/Projects\/VC2017\/lcms2_static\/lcms2_static.vcxproj\n+++ b\/Projects\/VC2017\/lcms2_static\/lcms2_static.vcxproj\n@@ -22,7 +22,7 @@\n     <ProjectGuid>{71DEDE59-3F1E-486B-A899-4283000F76B5}<\/ProjectGuid>\n     <RootNamespace>lcms2_static<\/RootNamespace>\n     <Keyword>Win32Proj<\/Keyword>\n-    <WindowsTargetPlatformVersion>8.1<\/WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0<\/WindowsTargetPlatformVersion>\n   <\/PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" \/>\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">\ndiff --git a\/Projects\/VC2017\/linkicc\/linkicc.vcxproj b\/Projects\/VC2017\/linkicc\/linkicc.vcxproj\nindex 30c2b4e..51586dd 100644\n--- a\/Projects\/VC2017\/linkicc\/linkicc.vcxproj\n+++ b\/Projects\/VC2017\/linkicc\/linkicc.vcxproj\n@@ -22,7 +22,7 @@\n     <ProjectGuid>{FBFBE1DC-DB84-4BA1-9552-B4780F457849}<\/ProjectGuid>\n     <RootNamespace>linkicc<\/RootNamespace>\n     <Keyword>Win32Proj<\/Keyword>\n-    <WindowsTargetPlatformVersion>8.1<\/WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0<\/WindowsTargetPlatformVersion>\n   <\/PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" \/>\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">\ndiff --git a\/Projects\/VC2017\/psicc\/psicc.vcxproj b\/Projects\/VC2017\/psicc\/psicc.vcxproj\nindex 9dcf89a..8f26e12 100644\n--- a\/Projects\/VC2017\/psicc\/psicc.vcxproj\n+++ b\/Projects\/VC2017\/psicc\/psicc.vcxproj\n@@ -22,7 +22,7 @@\n     <ProjectGuid>{EF6A8851-65FE-46F5-B9EF-14F0B671F693}<\/ProjectGuid>\n     <RootNamespace>psicc<\/RootNamespace>\n     <Keyword>Win32Proj<\/Keyword>\n-    <WindowsTargetPlatformVersion>8.1<\/WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0<\/WindowsTargetPlatformVersion>\n   <\/PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" \/>\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">\ndiff --git a\/Projects\/VC2017\/testbed\/testbed.vcxproj b\/Projects\/VC2017\/testbed\/testbed.vcxproj\nindex 0af3762..3f6aea3 100644\n--- a\/Projects\/VC2017\/testbed\/testbed.vcxproj\n+++ b\/Projects\/VC2017\/testbed\/testbed.vcxproj\n@@ -22,7 +22,7 @@\n     <ProjectGuid>{928A3A2B-46EF-4279-959C-513B3652FF0E}<\/ProjectGuid>\n     <RootNamespace>testbed<\/RootNamespace>\n     <Keyword>Win32Proj<\/Keyword>\n-    <WindowsTargetPlatformVersion>8.1<\/WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0<\/WindowsTargetPlatformVersion>\n   <\/PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" \/>\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">\ndiff --git a\/Projects\/VC2017\/tiffdiff\/tiffdiff.vcxproj b\/Projects\/VC2017\/tiffdiff\/tiffdiff.vcxproj\nindex 7edfe28..3a6d837 100644\n--- a\/Projects\/VC2017\/tiffdiff\/tiffdiff.vcxproj\n+++ b\/Projects\/VC2017\/tiffdiff\/tiffdiff.vcxproj\n@@ -22,7 +22,7 @@\n     <ProjectGuid>{75B91835-CCD7-48BE-A606-A9C997D5DBEE}<\/ProjectGuid>\n     <RootNamespace>tiffdiff<\/RootNamespace>\n     <Keyword>Win32Proj<\/Keyword>\n-    <WindowsTargetPlatformVersion>8.1<\/WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0<\/WindowsTargetPlatformVersion>\n   <\/PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" \/>\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">\ndiff --git a\/Projects\/VC2017\/tifficc\/tifficc.vcxproj b\/Projects\/VC2017\/tifficc\/tifficc.vcxproj\nindex cd9f04c..5ef954f 100644\n--- a\/Projects\/VC2017\/tifficc\/tifficc.vcxproj\n+++ b\/Projects\/VC2017\/tifficc\/tifficc.vcxproj\n@@ -22,7 +22,7 @@\n     <ProjectGuid>{2256DE16-ED92-4A6F-9C54-F65BB61E64A2}<\/ProjectGuid>\n     <RootNamespace>tifficc<\/RootNamespace>\n     <Keyword>Win32Proj<\/Keyword>\n-    <WindowsTargetPlatformVersion>8.1<\/WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0<\/WindowsTargetPlatformVersion>\n   <\/PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" \/>\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">\ndiff --git a\/Projects\/VC2017\/transicc\/transicc.vcxproj b\/Projects\/VC2017\/transicc\/transicc.vcxproj\nindex d9b77c6..b3173d8 100644\n--- a\/Projects\/VC2017\/transicc\/transicc.vcxproj\n+++ b\/Projects\/VC2017\/transicc\/transicc.vcxproj\n@@ -22,6 +22,7 @@\n     <ProjectGuid>{9EE22D66-C849-474C-9ED5-C3E141DAB160}<\/ProjectGuid>\n     <RootNamespace>transicc<\/RootNamespace>\n     <Keyword>Win32Proj<\/Keyword>\n+    <WindowsTargetPlatformVersion>10.0.17134.0<\/WindowsTargetPlatformVersion>\n   <\/PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" \/>\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">\ndiff --git a\/src\/cmscgats.c b\/src\/cmscgats.c\nindex 1a87613..8c3e96d 100644\n--- a\/src\/cmscgats.c\n+++ b\/src\/cmscgats.c\n@@ -1,7 +1,7 @@\n \/\/---------------------------------------------------------------------------------\n \/\/\n \/\/  Little Color Management System\n-\/\/  Copyright (c) 1998-2017 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2018 Marti Maria Saguer\n \/\/\n \/\/ Permission is hereby granted, free of charge, to any person obtaining\n \/\/ a copy of this software and associated documentation files (the \"Software\"),\n@@ -1506,10 +1506,16 @@ void AllocateDataSet(cmsIT8* it8)\n     t-> nSamples   = atoi(cmsIT8GetProperty(it8, \"NUMBER_OF_FIELDS\"));\n     t-> nPatches   = atoi(cmsIT8GetProperty(it8, \"NUMBER_OF_SETS\"));\n \n-    t-> Data = (char**)AllocChunk (it8, ((cmsUInt32Number) t->nSamples + 1) * ((cmsUInt32Number) t->nPatches + 1) *sizeof (char*));\n-    if (t->Data == NULL) {\n+    if (t -> nSamples < 0 || t->nSamples > 0x7ffe || t->nPatches < 0 || t->nPatches > 0x7ffe)\n+    {\n+        SynError(it8, \"AllocateDataSet: too much data\");\n+    }\n+    else {\n+        t->Data = (char**)AllocChunk(it8, ((cmsUInt32Number)t->nSamples + 1) * ((cmsUInt32Number)t->nPatches + 1) * sizeof(char*));\n+        if (t->Data == NULL) {\n \n-        SynError(it8, \"AllocateDataSet: Unable to allocate data array\");\n+            SynError(it8, \"AllocateDataSet: Unable to allocate data array\");\n+        }\n     }\n \n }\n","owner":"mm2","repo":"Little-CMS","source":"cve"},{"CVE_ID":"CVE-2018-17570","CWE_ID":"190","category":"security","commit_id":"5c2dc2b7856a66338e2f113540fd2e8fcb847f9e","commit_message":"From 5c2dc2b7856a66338e2f113540fd2e8fcb847f9e Mon Sep 17 00:00:00 2001\nFrom: Benjamin Chodroff <benjamin.chodroff@gmail.com>\nDate: Wed, 8 Aug 2018 11:10:45 +0800\nSubject: [PATCH] fix memory corruption and other 32bit overflows\n\n---\n network\/nw_buf.c  | 10 ++++++++--\n utils\/ut_rpc.c    | 10 ++++++++--\n utils\/ut_rpc.h    |  1 +\n utils\/ut_ws_svr.c |  2 +-\n utils\/ut_ws_svr.h |  2 ++\n 5 files changed, 20 insertions(+), 5 deletions(-)\n\n","diff_code":"diff --git a\/network\/nw_buf.c b\/network\/nw_buf.c\nindex f338af5..fa42b0a 100644\n--- a\/network\/nw_buf.c\n+++ b\/network\/nw_buf.c\n@@ -8,7 +8,9 @@\n # include \"nw_buf.h\"\n \n # define NW_BUF_POOL_INIT_SIZE 64\n+# define NW_BUF_POOL_MAX_SIZE  65535\n # define NW_CACHE_INIT_SIZE    64\n+# define NW_CACHE_MAX_SIZE     65535\n \n size_t nw_buf_size(nw_buf *buf)\n {\n@@ -85,7 +87,7 @@ void nw_buf_free(nw_buf_pool *pool, nw_buf *buf)\n {\n     if (pool->free < pool->free_total) {\n         pool->free_arr[pool->free++] = buf;\n-    } else {\n+    } else if (pool->free_total < NW_BUF_POOL_MAX_SIZE) {\n         uint32_t new_free_total = pool->free_total * 2;\n         void *new_arr = realloc(pool->free_arr, new_free_total * sizeof(nw_buf *));\n         if (new_arr) {\n@@ -95,6 +97,8 @@ void nw_buf_free(nw_buf_pool *pool, nw_buf *buf)\n         } else {\n             free(buf);\n         }\n+    } else {\n+        free(buf);\n     }\n }\n \n@@ -230,7 +234,7 @@ void nw_cache_free(nw_cache *cache, void *obj)\n {\n     if (cache->free < cache->free_total) {\n         cache->free_arr[cache->free++] = obj;\n-    } else {\n+    } else if (cache->free_total < NW_CACHE_MAX_SIZE) {\n         uint32_t new_free_total = cache->free_total * 2;\n         void *new_arr = realloc(cache->free_arr, new_free_total * sizeof(void *));\n         if (new_arr) {\n@@ -240,6 +244,8 @@ void nw_cache_free(nw_cache *cache, void *obj)\n         } else {\n             free(obj);\n         }\n+    } else {\n+        free(obj);\n     }\n }\n \ndiff --git a\/utils\/ut_rpc.c b\/utils\/ut_rpc.c\nindex 4ade964..14d0429 100644\n--- a\/utils\/ut_rpc.c\n+++ b\/utils\/ut_rpc.c\n@@ -44,13 +44,19 @@ int rpc_pack(rpc_pkg *pkg, void **data, uint32_t *size)\n {\n     static void *send_buf;\n     static size_t send_buf_size;\n-    uint32_t pkg_size = RPC_PKG_HEAD_SIZE + pkg->ext_size + pkg->body_size;\n+    uint32_t pkg_size;\n+    if (pkg->body_size > RPC_PKG_MAX_BODY_SIZE) {\n+        return -1;\n+    }\n+    pkg_size = RPC_PKG_HEAD_SIZE + pkg->ext_size + pkg->body_size;\n     if (send_buf_size < pkg_size) {\n         if (send_buf)\n             free(send_buf);\n         send_buf_size = pkg_size * 2;\n         send_buf = malloc(send_buf_size);\n-        assert(send_buf != NULL);\n+        if (send_buf == NULL) {\n+            return -1;\n+        }\n     }\n \n     memcpy(send_buf, pkg, RPC_PKG_HEAD_SIZE);\ndiff --git a\/utils\/ut_rpc.h b\/utils\/ut_rpc.h\nindex a30cf53..2c7b217 100644\n--- a\/utils\/ut_rpc.h\n+++ b\/utils\/ut_rpc.h\n@@ -32,6 +32,7 @@ typedef struct rpc_pkg {\n # pragma pack()\n \n # define RPC_PKG_HEAD_SIZE (sizeof(rpc_pkg) - sizeof(void *) * 2)\n+# define RPC_PKG_MAX_BODY_SIZE ((UINT32_MAX \/ 2) - UINT16_MAX - sizeof(rpc_pkg))\n \n int rpc_decode(nw_ses *ses, void *data, size_t max);\n int rpc_pack(rpc_pkg *pkg, void **data, uint32_t *size);\ndiff --git a\/utils\/ut_ws_svr.c b\/utils\/ut_ws_svr.c\nindex 5dfb87b..5a4b8b1 100644\n--- a\/utils\/ut_ws_svr.c\n+++ b\/utils\/ut_ws_svr.c\n@@ -129,7 +129,7 @@ static int on_http_message_complete(http_parser* parser)\n     if (upgrade == NULL || strcasecmp(upgrade, \"websocket\") != 0)\n         goto error;\n     const char *connection = http_request_get_header(info->request, \"Connection\");\n-    if (connection == NULL)\n+    if (connection == NULL || strlen(connection) > UT_WS_SVR_MAX_HEADER_SIZE)\n         goto error;\n     else {\n         bool found_upgrade = false;\ndiff --git a\/utils\/ut_ws_svr.h b\/utils\/ut_ws_svr.h\nindex d3fcf0f..11c53d4 100644\n--- a\/utils\/ut_ws_svr.h\n+++ b\/utils\/ut_ws_svr.h\n@@ -12,6 +12,8 @@\n # include \"nw_buf.h\"\n # include \"nw_timer.h\"\n \n+# define UT_WS_SVR_MAX_HEADER_SIZE 1024\n+\n typedef struct ws_svr_cfg {\n     uint32_t bind_count;\n     nw_svr_bind *bind_arr;\n","owner":"viabtc","repo":"viabtc_exchange_server.viabtc.viabtc_exchange_server","source":"cve"},{"CVE_ID":"CVE-2016-5766","CWE_ID":"190","category":"security","commit_id":"7722455726bec8c53458a32851d2a87982cf0eac","commit_message":"From 7722455726bec8c53458a32851d2a87982cf0eac Mon Sep 17 00:00:00 2001\nFrom: Pierre Joye <pajoye@php.net>\nDate: Sat, 18 Jun 2016 20:15:10 +0200\nSubject: [PATCH] Fixed #72339 Integer Overflow in _gd2GetHeader() resulting in\n heap overflow\n\n---\n ext\/gd\/libgd\/gd_gd2.c      |   7 +++++++\n ext\/gd\/tests\/bug72339.gd   | Bin 0 -> 67108882 bytes\n ext\/gd\/tests\/bug72339.phpt |  11 +++++++++++\n 3 files changed, 18 insertions(+)\n create mode 100644 ext\/gd\/tests\/bug72339.gd\n create mode 100644 ext\/gd\/tests\/bug72339.phpt\n\n","diff_code":"diff --git a\/ext\/gd\/libgd\/gd_gd2.c b\/ext\/gd\/libgd\/gd_gd2.c\nindex 6726fee8268d..63e3aefc3f16 100644\n--- a\/ext\/gd\/libgd\/gd_gd2.c\n+++ b\/ext\/gd\/libgd\/gd_gd2.c\n@@ -138,11 +138,18 @@ static int _gd2GetHeader(gdIOCtxPtr in, int *sx, int *sy, int *cs, int *vers, in\n \tif (gd2_compressed(*fmt)) {\n \t\tnc = (*ncx) * (*ncy);\n \t\tGD2_DBG(php_gd_error(\"Reading %d chunk index entries\", nc));\n+\t\tif (overflow2(sidx, nc)) {\n+\t\t\tgoto fail1;\n+\t\t}\n \t\tsidx = sizeof(t_chunk_info) * nc;\n \t\tif (sidx <= 0) {\n \t\t\tgoto fail1;\n \t\t}\n \t\tcidx = gdCalloc(sidx, 1);\n+\t\tif (cidx == NULL) {\n+\t\t\tgoto fail1;\n+\t\t}\n+\n \t\tfor (i = 0; i < nc; i++) {\n \t\t\tif (gdGetInt(&cidx[i].offset, in) != 1) {\n \t\t\t\tgdFree(cidx);\ndiff --git a\/ext\/gd\/tests\/bug72339.gd b\/ext\/gd\/tests\/bug72339.gd\nnew file mode 100644\nindex 0000000000000000000000000000000000000000..0634c990050f339dbbdd50cc748a027b344b6ddd\nGIT binary patch\nliteral 67108882\nzcmeFtK@9*P5X8XcB%uIw+?NFZ4nWAX4(6VjRK|a$I-M;71PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C7\nz2oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N\nz0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+\nz009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBly\nzK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF\nz5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk\nz1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs\nz0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZ\nzfB*pk1PBlyK!5-N0t5&UAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&U\nzAV7cs0RjXF5FkK+009C72oNAZfB*pk1PBlyK!5-N0t5&UAn@3s0|5X4001EW*G5Qi\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jjM^9S8sb0002_zcxaG0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNq!T=s*Af0002U|Fsbk95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddDyLk9u?0000$\nz{;!RY;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jedu9Xb#I00000@_%iF1P2ZrIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxiJ?9hP#00000kpF8VBsg&3z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)V22I_\nz00000fc#$@A;EzI2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede06TOb000000ObGL2nh}xIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!1K6Ph0RR9103iR@Mo4hrz<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz9Ka482mk;8008;FHbQ~}2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede-~e{$KmY&$007AUwGk2=\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|&4}2Lb>9002P#uZ@u4z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95{d-IuHN=0002;e{F;W2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J^Xw(18E|0001x\nz|7#;8IB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c\nz2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=\nzfddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede\nz;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQq\nzIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?\nz4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!\nz0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`\nzz<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!K\nzaNxj!0|yQqIB?*=fddB)95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yQqIB?*=fddB)\nz95`^`z<~n?4jede;J|?c2M!!KaNxj!0|yRhhYn-_00006`CH%PD})RfFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r\nz3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@\nz0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VK\nzfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5\nzV8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM\nz7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*\nz1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd\nz0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwA\nzz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEj\nzFkrxd0RsjM7%*VKfB^#r3>YwAz<>b*1`HT5V8DO@0|pEjFkrxd0RsjM7%*VKfB^&h\nFfdCtwKHC5Q\n\nliteral 0\nHcmV?d00001\n\ndiff --git a\/ext\/gd\/tests\/bug72339.phpt b\/ext\/gd\/tests\/bug72339.phpt\nnew file mode 100644\nindex 000000000000..763ae71000a6\n--- \/dev\/null\n+++ b\/ext\/gd\/tests\/bug72339.phpt\n@@ -0,0 +1,11 @@\n+--TEST--\n+Bug #72339 Integer Overflow in _gd2GetHeader() resulting in heap overflow \n+--SKIPIF--\n+<?php if (!function_exists(\"imagecreatefromgd2\")) print \"skip\"; ?>\n+--FILE--\n+<?php imagecreatefromgd2(dirname(__FILE__) . DIRECTORY_SEPARATOR . \"bug72339.gd\"); ?>\n+--EXPECTF--\t\n+Warning: imagecreatefromgd2(): gd warning: product of memory allocation multiplication would exceed INT_MAX, failing operation gracefully\n+ in %sbug72339.php on line %d\n+\n+Warning: imagecreatefromgd2(): '%sbug72339.gd' is not a valid GD2 file in %sbug72339.php on line %d\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2016-5094","CWE_ID":"190","category":"security","commit_id":"0da8b8b801f9276359262f1ef8274c7812d3dfda","commit_message":"From 0da8b8b801f9276359262f1ef8274c7812d3dfda Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Sun, 15 May 2016 23:26:51 -0700\nSubject: [PATCH] Fix bug #72135 - don't create strings with lengths outside\n int range\n\n---\n ext\/standard\/html.c | 50 ++++++++++++++++++++++++---------------------\n 1 file changed, 27 insertions(+), 23 deletions(-)\n\n","diff_code":"diff --git a\/ext\/standard\/html.c b\/ext\/standard\/html.c\nindex 72423b59f0e4..81d8aff9e9ad 100644\n--- a\/ext\/standard\/html.c\n+++ b\/ext\/standard\/html.c\n@@ -163,7 +163,7 @@ static inline unsigned int get_next_char(\n \t\t\t\t\telse\n \t\t\t\t\t\tMB_FAILURE(pos, 4);\n \t\t\t\t}\n-\t\t\t\t\n+\n \t\t\t\tthis_char = ((c & 0x07) << 18) | ((str[pos + 1] & 0x3f) << 12) | ((str[pos + 2] & 0x3f) << 6) | (str[pos + 3] & 0x3f);\n \t\t\t\tif (this_char < 0x10000 || this_char > 0x10FFFF) { \/* non-shortest form or outside range *\/\n \t\t\t\t\tMB_FAILURE(pos, 4);\n@@ -437,7 +437,7 @@ static enum entity_charset determine_charset(char *charset_hint TSRMLS_DC)\n \n \tif (charset_hint) {\n \t\tint found = 0;\n-\t\t\n+\n \t\t\/* now walk the charset map and look for the codeset *\/\n \t\tfor (i = 0; charset_map[i].codeset; i++) {\n \t\t\tif (len == strlen(charset_map[i].codeset) && strncasecmp(charset_hint, charset_map[i].codeset, len) == 0) {\n@@ -545,7 +545,7 @@ static inline unsigned char unimap_bsearch(const uni_to_enc *table, unsigned cod\n \t\treturn 0;\n \n \tcode_key = (unsigned short) code_key_a;\n-\t\n+\n \twhile (l <= h) {\n \t\tm = l + (h - l) \/ 2;\n \t\tif (code_key < m->un_code_point)\n@@ -571,7 +571,7 @@ static inline int map_from_unicode(unsigned code, enum entity_charset charset, u\n \t\t\/* identity mapping of code points to unicode *\/\n \t\tif (code > 0xFF) {\n \t\t\treturn FAILURE;\n-\t\t} \n+\t\t}\n \t\t*res = code;\n \t\tbreak;\n \n@@ -590,7 +590,7 @@ static inline int map_from_unicode(unsigned code, enum entity_charset charset, u\n \t\t\treturn FAILURE;\n \t\t}\n \t\tbreak;\n-\t\t\n+\n \tcase cs_8859_15:\n \t\tif (code < 0xA4 || (code > 0xBE && code <= 0xFF)) {\n \t\t\t*res = code;\n@@ -634,7 +634,7 @@ static inline int map_from_unicode(unsigned code, enum entity_charset charset, u\n \tcase cs_cp866:\n \t\ttable = unimap_cp866;\n \t\ttable_size = sizeof(unimap_cp866) \/ sizeof(*unimap_cp866);\n-\t\t\n+\n table_over_7F:\n \t\tif (code <= 0x7F) {\n \t\t\t*res = code;\n@@ -710,7 +710,7 @@ static inline int unicode_cp_is_allowed(unsigned uni_cp, int document_type)\n \t * Not sure this is the relevant part for HTML 5, though. I opted to\n \t * disallow the characters that would result in a parse error when\n \t * preprocessing of the input stream. See also section 8.1.3.\n-\t * \n+\t *\n \t * It's unclear if XHTML 1.0 allows C1 characters. I'll opt to apply to\n \t * XHTML 1.0 the same rules as for XML 1.0.\n \t * See <http:\/\/cmsmcq.com\/2007\/C1.xml>.\n@@ -774,7 +774,7 @@ static inline int numeric_entity_is_allowed(unsigned uni_cp, int document_type)\n \/* {{{ process_numeric_entity\n  * Auxiliary function to traverse_for_entities.\n  * On input, *buf should point to the first character after # and on output, it's the last\n- * byte read, no matter if there was success or insuccess. \n+ * byte read, no matter if there was success or insuccess.\n  *\/\n static inline int process_numeric_entity(const char **buf, unsigned *code_point)\n {\n@@ -784,7 +784,7 @@ static inline int process_numeric_entity(const char **buf, unsigned *code_point)\n \n \tif (hexadecimal && (**buf != '\\0'))\n \t\t(*buf)++;\n-\t\t\t\n+\n \t\/* strtol allows whitespace and other stuff in the beginning\n \t\t* we're not interested *\/\n \tif ((hexadecimal && !isxdigit(**buf)) ||\n@@ -969,7 +969,7 @@ static void traverse_for_entities(\n \t\t\t\tgoto invalid_code;\n \n \t\t\t\/* are we allowed to decode this entity in this document type?\n-\t\t\t * HTML 5 is the only that has a character that cannot be used in \n+\t\t\t * HTML 5 is the only that has a character that cannot be used in\n \t\t\t * a numeric entity but is allowed literally (U+000D). The\n \t\t\t * unoptimized version would be ... || !numeric_entity_is_allowed(code) *\/\n \t\t\tif (!unicode_cp_is_allowed(code, doctype) ||\n@@ -996,9 +996,9 @@ static void traverse_for_entities(\n \t\t\t\t}\n \t\t\t}\n \t\t}\n-\t\t\n+\n \t\tassert(*next == ';');\n-\t\t\n+\n \t\tif (((code == '\\'' && !(flags & ENT_HTML_QUOTE_SINGLE)) ||\n \t\t\t\t(code == '\"' && !(flags & ENT_HTML_QUOTE_DOUBLE)))\n \t\t\t\t\/* && code2 == '\\0' always true for current maps *\/)\n@@ -1026,7 +1026,7 @@ static void traverse_for_entities(\n \t\t\t*(q++) = *p;\n \t\t}\n \t}\n-\t\n+\n \t*q = '\\0';\n \t*retlen = (size_t)(q - ret);\n }\n@@ -1066,7 +1066,7 @@ static entity_table_opt determine_entity_table(int all, int doctype)\n \tentity_table_opt retval = {NULL};\n \n \tassert(!(doctype == ENT_HTML_DOC_XML1 && all));\n-\t\n+\n \tif (all) {\n \t\tretval.ms_table = (doctype == ENT_HTML_DOC_HTML5) ?\n \t\t\tentity_ms_table_html5 : entity_ms_table_html4;\n@@ -1111,13 +1111,13 @@ PHPAPI char *php_unescape_html_entities(unsigned char *old, size_t oldlen, size_\n \tif (retlen == 0) {\n \t\tgoto empty_source;\n \t}\n-\t\n+\n \tinverse_map = unescape_inverse_map(all, flags);\n-\t\n+\n \t\/* replace numeric entities *\/\n \ttraverse_for_entities(old, oldlen, ret, &retlen, all, flags, inverse_map, charset);\n \n-empty_source:\t\n+empty_source:\n \t*newlen = retlen;\n \treturn ret;\n }\n@@ -1141,7 +1141,7 @@ static inline void find_entity_for_char(\n {\n \tunsigned stage1_idx = ENT_STAGE1_INDEX(k);\n \tconst entity_stage3_row *c;\n-\t\n+\n \tif (stage1_idx > 0x1D) {\n \t\t*entity     = NULL;\n \t\t*entity_len = 0;\n@@ -1162,7 +1162,7 @@ static inline void find_entity_for_char(\n \t\tif (!(*cursor < oldlen))\n \t\t\tgoto no_suitable_2nd;\n \n-\t\tnext_char = get_next_char(charset, old, oldlen, cursor, &status); \n+\t\tnext_char = get_next_char(charset, old, oldlen, cursor, &status);\n \n \t\tif (status == FAILURE)\n \t\t\tgoto no_suitable_2nd;\n@@ -1187,7 +1187,7 @@ static inline void find_entity_for_char(\n \t\t*entity = (const unsigned char *)\n \t\t\tc->data.multicodepoint_table[0].leading_entry.default_entity;\n \t\t*entity_len = c->data.multicodepoint_table[0].leading_entry.default_entity_len;\n-\t}\t\n+\t}\n }\n \/* }}} *\/\n \n@@ -1255,7 +1255,7 @@ PHPAPI char *php_escape_html_entities_ex(unsigned char *old, size_t oldlen, size\n \n \t\/* initial estimate *\/\n \tif (oldlen < 64) {\n-\t\tmaxlen = 128;\t\n+\t\tmaxlen = 128;\n \t} else {\n \t\tmaxlen = 2 * oldlen;\n \t\tif (maxlen < oldlen) {\n@@ -1444,6 +1444,10 @@ static void php_html_entities(INTERNAL_FUNCTION_PARAMETERS, int all)\n \t}\n \n \treplaced = php_escape_html_entities_ex(str, str_len, &new_len, all, (int) flags, hint_charset, double_encode TSRMLS_CC);\n+\tif (new_len > INT_MAX) {\n+\t\tefree(replaced);\n+\t\tRETURN_FALSE;\n+\t}\n \tRETVAL_STRINGL(replaced, (int)new_len, 0);\n }\n \/* }}} *\/\n@@ -1577,7 +1581,7 @@ static inline void write_s3row_data(\n \t\t\t} else {\n \t\t\t\tspe_cp = uni_cp;\n \t\t\t}\n-\t\t\t\n+\n \t\t\twritten_k2 = write_octet_sequence(&key[written_k1], charset, spe_cp);\n \t\t\tmemcpy(&entity[1], mcpr[i].normal_entry.entity, l);\n \t\t\tentity[l + 1] = ';';\n@@ -1615,7 +1619,7 @@ PHP_FUNCTION(get_html_translation_table)\n \tLIMIT_ALL(all, doctype, charset);\n \n \tarray_init(return_value);\n-\t\n+\n \tentity_table = determine_entity_table(all, doctype);\n \tif (all && !CHARSET_UNICODE_COMPAT(charset)) {\n \t\tto_uni_table = enc_to_uni_index[charset];\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2016-9557","CWE_ID":"190","category":"security","commit_id":"d42b2388f7f8e0332c846675133acea151fc557a","commit_message":"From d42b2388f7f8e0332c846675133acea151fc557a Mon Sep 17 00:00:00 2001\nFrom: Michael Adams <mdadams@ece.uvic.ca>\nDate: Fri, 11 Nov 2016 16:27:34 -0800\nSubject: [PATCH] The generation of the configuration file jas_config.h has\n been completely reworked in order to avoid pollution of the global namespace.\n\nSome problematic types like uchar, ulong, and friends have been replaced\nwith names with a jas_ prefix.\n\nAn option max_samples has been added to the BMP and JPEG decoders to\nrestrict the maximum size of image that they can decode.  This change\nwas made as a (possibly temporary) fix to address security concerns.\nA max_samples command-line option has also been added to imginfo.\n\nWhether an image component (for jas_image_t) is stored in memory or on\ndisk is now based on the component size (rather than the image size).\n\nSome debug log message were added.\n\nSome new integer overflow checks were added.\n\nSome new safe integer add\/multiply functions were added.\n\nMore pre-C99 cruft was removed.  JasPer has numerous \"hacks\" to\nhandle pre-C99 compilers.  JasPer now assumes C99 support.  So, this\npre-C99 cruft is unnecessary and can be removed.\n\nThe regression jasper-doublefree-mem_close.jpg has been re-enabled.\nTheoretically, it should work more predictably now.\n---\n .gitignore                                   |   5 +-\n configure.ac                                 | 114 ++++++++++++-------\n src\/appl\/imginfo.c                           |  23 +++-\n src\/libjasper\/base\/jas_debug.c               |   2 +-\n src\/libjasper\/base\/jas_icc.c                 |  30 ++---\n src\/libjasper\/base\/jas_iccdata.c             |   4 +-\n src\/libjasper\/base\/jas_image.c               |  60 +++++++---\n src\/libjasper\/base\/jas_seq.c                 | 102 ++++++++++-------\n src\/libjasper\/base\/jas_stream.c              |  11 +-\n src\/libjasper\/base\/jas_tmr.c                 |   7 +-\n src\/libjasper\/bmp\/bmp_dec.c                  |  82 ++++++++++---\n src\/libjasper\/include\/jasper\/jas_cm.h        |   2 +\n src\/libjasper\/include\/jasper\/jas_config.h.in |  27 +++++\n src\/libjasper\/include\/jasper\/jas_config2.h   |  13 ---\n src\/libjasper\/include\/jasper\/jas_debug.h     |   4 +-\n src\/libjasper\/include\/jasper\/jas_fix.h       |   4 +-\n src\/libjasper\/include\/jasper\/jas_getopt.h    |   1 +\n src\/libjasper\/include\/jasper\/jas_icc.h       |  12 +-\n src\/libjasper\/include\/jasper\/jas_image.h     |   4 +-\n src\/libjasper\/include\/jasper\/jas_init.h      |   1 +\n src\/libjasper\/include\/jasper\/jas_malloc.h    |   1 +\n src\/libjasper\/include\/jasper\/jas_math.h      |  70 ++++++++++++\n src\/libjasper\/include\/jasper\/jas_seq.h       |  33 +++---\n src\/libjasper\/include\/jasper\/jas_stream.h    |  17 +--\n src\/libjasper\/include\/jasper\/jas_string.h    |   2 +\n src\/libjasper\/include\/jasper\/jas_tmr.h       |  10 +-\n src\/libjasper\/include\/jasper\/jas_tvp.h       |   1 +\n src\/libjasper\/include\/jasper\/jas_types.h     |  38 +++----\n src\/libjasper\/include\/jasper\/jas_version.h   |   1 +\n src\/libjasper\/include\/jasper\/jasper.h        |   2 +\n src\/libjasper\/jp2\/jp2_dec.c                  |  15 +--\n src\/libjasper\/jpc\/jpc_cs.c                   |   6 +-\n src\/libjasper\/jpc\/jpc_cs.h                   |   6 +-\n src\/libjasper\/jpc\/jpc_dec.c                  |   2 +-\n src\/libjasper\/jpc\/jpc_dec.h                  |   2 +-\n src\/libjasper\/jpc\/jpc_enc.c                  |   2 +-\n src\/libjasper\/jpc\/jpc_mqdec.h                |   2 +-\n src\/libjasper\/jpg\/jpg_dec.c                  |  52 +++++----\n src\/libjasper\/jpg\/jpg_val.c                  |   2 +-\n src\/libjasper\/mif\/mif_cod.c                  |   4 +-\n src\/libjasper\/pgx\/pgx_dec.c                  |   4 +-\n src\/libjasper\/pnm\/pnm_dec.c                  |   2 +-\n src\/libjasper\/ras\/ras_dec.c                  |   2 +-\n test\/bin\/run_test_1                          |  10 +-\n 44 files changed, 524 insertions(+), 270 deletions(-)\n create mode 100644 src\/libjasper\/include\/jasper\/jas_config.h.in\n\n","diff_code":"diff --git a\/.gitignore b\/.gitignore\nindex 9ef3d79..6fd9859 100644\n--- a\/.gitignore\n+++ b\/.gitignore\n@@ -40,6 +40,7 @@ Makefile.in\n \n # .\/src\/libjasper\/include\/jasper directory\n \/src\/libjasper\/include\/jasper\/jas_config.h\n-\/src\/libjasper\/include\/jasper\/jas_config.h.in\n-\/src\/libjasper\/include\/jasper\/jas_config.h.in~\n+\/src\/libjasper\/include\/jasper\/jas_pconf.h\n+\/src\/libjasper\/include\/jasper\/jas_pconf.h.in\n+\/src\/libjasper\/include\/jasper\/jas_pconf.h.in~\n \/src\/libjasper\/include\/jasper\/stamp-h1\ndiff --git a\/configure.ac b\/configure.ac\nindex c83181c..a218b3c 100644\n--- a\/configure.ac\n+++ b\/configure.ac\n@@ -132,16 +132,6 @@ AH_TOP([\n \/* If configure is being used, this symbol will be defined automatically\n   at this point in the configuration header file. *\/\n \n-#if defined(__GNUC__) && !defined(__clang__)\n-#define JAS_ATTRIBUTE_DISABLE_USAN \\\n-  __attribute__((no_sanitize_undefined))\n-#elif defined(__clang__)\n-#define JAS_ATTRIBUTE_DISABLE_USAN \\\n-  __attribute__((no_sanitize(\"undefined\")))\n-#else\n-#define JAS_ATTRIBUTE_DISABLE_USAN\n-#endif\n-\n \/* The preprocessor symbol JAS_WIN_MSVC_BUILD should not be defined\n   unless the JasPer software is being built under Microsoft Windows\n   using Microsoft Visual C. *\/\n@@ -153,7 +143,7 @@ AH_TOP([\n AH_BOTTOM([\n #else\n \/* A configure-based build is not being used. *\/\n-#include <jasper\/jas_config2.h>\n+#include <jasper\/jas_pconf2.h>\n #endif\n \n #endif\n@@ -312,31 +302,82 @@ AC_CHECK_LIB(m, main)\n # Check for header files.\n ############################################################\n \n-AC_HEADER_STDC\n-AC_CHECK_HEADERS(fcntl.h limits.h unistd.h stdint.h stdbool.h io.h windows.h sys\/types.h sys\/time.h stdlib.h stddef.h)\n+dnl AC_HEADER_STDC\n+AC_CHECK_HEADERS(fcntl.h io.h unistd.h windows.h sys\/time.h sys\/types.h)\n+\n+# Surely, there must be a better way to do this, but\n+# let's just get something working for now.\n+\n+if test $ac_cv_header_fcntl_h = yes; then\n+\tAC_SUBST([JAS_HAVE_FCNTL_H], [\"#define JAS_HAVE_FCNTL_H 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_FCNTL_H], [\"#undef JAS_HAVE_FCNTL_H\"])\n+fi\n+\n+if test $ac_cv_header_io_h = yes; then\n+\tAC_SUBST([JAS_HAVE_IO_H], [\"#define JAS_HAVE_IO_H 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_IO_H], [\"#undef JAS_HAVE_IO_H\"])\n+fi\n+\n+if test $ac_cv_header_unistd_h = yes; then\n+\tAC_SUBST([JAS_HAVE_UNISTD_H], [\"#define JAS_HAVE_UNISTD_H 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_UNISTD_H], [\"#undef JAS_HAVE_UNISTD_H\"])\n+fi\n+\n+if test $ac_cv_header_windows_h = yes; then\n+\tAC_SUBST([JAS_HAVE_WINDOWS_H], [\"#define JAS_HAVE_WINDOWS_H 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_WINDOWS_H], [\"#undef JAS_HAVE_WINDOWS_H\"])\n+fi\n+\n+if test $ac_cv_header_sys_time_h = yes; then\n+\tAC_SUBST([JAS_HAVE_SYS_TIME_H], [\"#define JAS_HAVE_SYS_TIME_H 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_SYS_TIME_H], [\"#undef JAS_HAVE_SYS_TIME_H\"])\n+fi\n+\n+if test $ac_cv_header_sys_types_h = yes; then\n+\tAC_SUBST([JAS_HAVE_SYS_TYPES_H], [\"#define JAS_HAVE_SYS_TYPES_H 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_SYS_TYPES_H], [\"#undef JAS_HAVE_SYS_TYPES_H\"])\n+fi\n \n ############################################################\n # Check for typedefs, structures, and compiler characteristics.\n ############################################################\n \n-AC_C_CONST\n-AC_C_INLINE\n-AC_TYPE_SIZE_T\n-AC_CHECK_TYPE(uchar, unsigned char)\n-AC_CHECK_TYPE(ushort, unsigned short)\n-AC_CHECK_TYPE(uint, unsigned int)\n-AC_CHECK_TYPE(ulong, unsigned long)\n-AC_CHECK_TYPE(longlong, long long)\n-AC_CHECK_TYPE(ulonglong, unsigned long long)\n-AC_CHECK_TYPE(ssize_t, int)\n+dnl AC_C_CONST\n+dnl AC_C_INLINE\n+dnl AC_TYPE_SIZE_T\n+dnl AC_CHECK_TYPE(uchar, unsigned char)\n+dnl AC_CHECK_TYPE(ushort, unsigned short)\n+dnl AC_CHECK_TYPE(uint, unsigned int)\n+dnl AC_CHECK_TYPE(ulong, unsigned long)\n+dnl AC_CHECK_TYPE(longlong, long long)\n+dnl AC_CHECK_TYPE(ulonglong, unsigned long long)\n+dnl AC_CHECK_TYPE(ssize_t, int)\n AC_CHECK_FUNCS(gettimeofday)\n AC_CHECK_FUNCS(getrusage)\n \n+if test $ac_cv_func_gettimeofday = yes; then\n+\tAC_SUBST([JAS_HAVE_GETTIMEOFDAY], [\"#define JAS_HAVE_GETTIMEOFDAY 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_GETTIMEOFDAY], [\"#undef JAS_HAVE_GETTIMEOFDAY\"])\n+fi\n+\n+if test $ac_cv_func_getrusage = yes; then\n+\tAC_SUBST([JAS_HAVE_GETRUSAGE], [\"#define JAS_HAVE_GETRUSAGE 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_GETRUSAGE], [\"#undef JAS_HAVE_GETRUSAGE\"])\n+fi\n+\n ############################################################\n # Checks for library functions.\n ############################################################\n \n-AC_FUNC_VPRINTF\n+dnl AC_FUNC_VPRINTF\n \n ############################################################\n # Enable memory limit feature.\n@@ -432,26 +473,9 @@ esac\n ], [debug=no])\n \n ############################################################\n-# Extra stuff for research purposes.\n+# Extra stuff\n ############################################################\n \n-AC_ARG_ENABLE(special0,\n-[  --enable-special0    enable something],\n-[\n-case \"${enableval}\" in\n-yes)\n-\tif test \"$GCC\" = yes; then\n-\t\tCFLAGS=\"-g -O0\"\n-\tfi\n-\t;;\n-no)\n-\t;;\n-*)\n-\tAC_MSG_ERROR(bad value ${enableval} for --enable-special0)\n-\t;;\n-esac\n-], [])\n-\n if test -n \"$EXTRA_CFLAGS\"; then\n \tCFLAGS=\"$CFLAGS $EXTRA_CFLAGS\"\n fi\n@@ -460,13 +484,17 @@ fi\n # Generate the configuration header file.\n ############################################################\n \n-AC_CONFIG_HEADERS([src\/libjasper\/include\/jasper\/jas_config.h])\n+# The private header file generated by AC_CONFIG_HEADERS is not\n+# currently used.  This just causes less verbose command lines\n+# when make is run.\n+AC_CONFIG_HEADERS([src\/libjasper\/include\/jasper\/jas_pconf.h])\n \n ############################################################\n # Generate the makefiles.\n ############################################################\n \n AC_CONFIG_FILES([\n+src\/libjasper\/include\/jasper\/jas_config.h\n Makefile\n src\/Makefile\n src\/appl\/Makefile\ndiff --git a\/src\/appl\/imginfo.c b\/src\/appl\/imginfo.c\nindex 0560bea..160054c 100644\n--- a\/src\/appl\/imginfo.c\n+++ b\/src\/appl\/imginfo.c\n@@ -88,6 +88,7 @@ typedef enum {\n \tOPT_VERBOSE,\n \tOPT_INFILE,\n \tOPT_DEBUG,\n+\tOPT_MAXSAMPLES,\n \tOPT_MAXMEM\n } optid_t;\n \n@@ -108,6 +109,7 @@ static jas_opt_t opts[] = {\n \t{OPT_VERBOSE, \"verbose\", 0},\n \t{OPT_INFILE, \"f\", JAS_OPT_HASARG},\n \t{OPT_DEBUG, \"debug-level\", JAS_OPT_HASARG},\n+\t{OPT_MAXSAMPLES, \"max-samples\", JAS_OPT_HASARG},\n #if defined(JAS_DEFAULT_MAX_MEM_USAGE)\n \t{OPT_MAXMEM, \"memory-limit\", JAS_OPT_HASARG},\n #endif\n@@ -135,6 +137,8 @@ int main(int argc, char **argv)\n \tchar *fmtname;\n \tint debug;\n \tsize_t max_mem;\n+\tsize_t max_samples;\n+\tchar optstr[32];\n \n \tif (jas_init()) {\n \t\tabort();\n@@ -142,6 +146,7 @@ int main(int argc, char **argv)\n \n \tcmdname = argv[0];\n \n+\tmax_samples = 64 * JAS_MEBI;\n \tinfile = 0;\n \tverbose = 0;\n \tdebug = 0;\n@@ -165,6 +170,9 @@ int main(int argc, char **argv)\n \t\tcase OPT_INFILE:\n \t\t\tinfile = jas_optarg;\n \t\t\tbreak;\n+\t\tcase OPT_MAXSAMPLES:\n+\t\t\tmax_samples = strtoull(jas_optarg, 0, 10);\n+\t\t\tbreak;\n \t\tcase OPT_MAXMEM:\n \t\t\tmax_mem = strtoull(jas_optarg, 0, 10);\n \t\t\tbreak;\n@@ -199,8 +207,10 @@ int main(int argc, char **argv)\n \t\tfprintf(stderr, \"unknown image format\\n\");\n \t}\n \n+\tsnprintf(optstr, sizeof(optstr), \"max_samples=%-zu\", max_samples);\n+\n \t\/* Decode the image. *\/\n-\tif (!(image = jas_image_decode(instream, fmtid, 0))) {\n+\tif (!(image = jas_image_decode(instream, fmtid, optstr))) {\n \t\tjas_stream_close(instream);\n \t\tfprintf(stderr, \"cannot load image\\n\");\n \t\treturn EXIT_FAILURE;\n@@ -209,6 +219,11 @@ int main(int argc, char **argv)\n \t\/* Close the image file. *\/\n \tjas_stream_close(instream);\n \n+\tif (!(fmtname = jas_image_fmttostr(fmtid))) {\n+\t\tjas_eprintf(\"format name lookup failed\\n\");\n+\t\treturn EXIT_FAILURE;\n+\t}\n+\n \tif (!(numcmpts = jas_image_numcmpts(image))) {\n \t\tfprintf(stderr, \"warning: image has no components\\n\");\n \t}\n@@ -221,10 +236,8 @@ int main(int argc, char **argv)\n \t\theight = 0;\n \t\tdepth = 0;\n \t}\n-\tif (!(fmtname = jas_image_fmttostr(fmtid))) {\n-\t\tabort();\n-\t}\n-\tprintf(\"%s %d %d %d %d %ld\\n\", fmtname, numcmpts, width, height, depth, (long) jas_image_rawsize(image));\n+\tprintf(\"%s %d %d %d %d %ld\\n\", fmtname, numcmpts, width, height, depth,\n+\t  JAS_CAST(long, jas_image_rawsize(image)));\n \n \tjas_image_destroy(image);\n \tjas_image_clearfmts();\ndiff --git a\/src\/libjasper\/base\/jas_debug.c b\/src\/libjasper\/base\/jas_debug.c\nindex 42a7480..c79992e 100644\n--- a\/src\/libjasper\/base\/jas_debug.c\n+++ b\/src\/libjasper\/base\/jas_debug.c\n@@ -122,7 +122,7 @@ int jas_memdump(FILE *out, void *data, size_t len)\n {\n \tsize_t i;\n \tsize_t j;\n-\tuchar *dp;\n+\tjas_uchar *dp;\n \tdp = data;\n \tfor (i = 0; i < len; i += 16) {\n \t\tfprintf(out, \"%04zx:\", i);\ndiff --git a\/src\/libjasper\/base\/jas_icc.c b\/src\/libjasper\/base\/jas_icc.c\nindex c9ca43c..09c6ae2 100644\n--- a\/src\/libjasper\/base\/jas_icc.c\n+++ b\/src\/libjasper\/base\/jas_icc.c\n@@ -82,14 +82,14 @@\n \n static jas_iccattrval_t *jas_iccattrval_create0(void);\n \n-static int jas_iccgetuint(jas_stream_t *in, int n, ulonglong *val);\n+static int jas_iccgetuint(jas_stream_t *in, int n, jas_ulonglong *val);\n static int jas_iccgetuint8(jas_stream_t *in, jas_iccuint8_t *val);\n static int jas_iccgetuint16(jas_stream_t *in, jas_iccuint16_t *val);\n static int jas_iccgetsint32(jas_stream_t *in, jas_iccsint32_t *val);\n static int jas_iccgetuint32(jas_stream_t *in, jas_iccuint32_t *val);\n static int jas_iccgetuint64(jas_stream_t *in, jas_iccuint64_t *val);\n-static int jas_iccputuint(jas_stream_t *out, int n, ulonglong val);\n-static int jas_iccputsint(jas_stream_t *out, int n, longlong val);\n+static int jas_iccputuint(jas_stream_t *out, int n, jas_ulonglong val);\n+static int jas_iccputsint(jas_stream_t *out, int n, jas_longlong val);\n static jas_iccprof_t *jas_iccprof_create(void);\n static int jas_iccprof_readhdr(jas_stream_t *in, jas_icchdr_t *hdr);\n static int jas_iccprof_writehdr(jas_stream_t *out, jas_icchdr_t *hdr);\n@@ -1603,11 +1603,11 @@ static void jas_icclut16_dump(jas_iccattrval_t *attrval, FILE *out)\n *\n \\******************************************************************************\/\n \n-static int jas_iccgetuint(jas_stream_t *in, int n, ulonglong *val)\n+static int jas_iccgetuint(jas_stream_t *in, int n, jas_ulonglong *val)\n {\n \tint i;\n \tint c;\n-\tulonglong v;\n+\tjas_ulonglong v;\n \tv = 0;\n \tfor (i = n; i > 0; --i) {\n \t\tif ((c = jas_stream_getc(in)) == EOF)\n@@ -1629,7 +1629,7 @@ static int jas_iccgetuint8(jas_stream_t *in, jas_iccuint8_t *val)\n \n static int jas_iccgetuint16(jas_stream_t *in, jas_iccuint16_t *val)\n {\n-\tulonglong tmp;\n+\tjas_ulonglong tmp;\n \tif (jas_iccgetuint(in, 2, &tmp))\n \t\treturn -1;\n \t*val = tmp;\n@@ -1638,17 +1638,17 @@ static int jas_iccgetuint16(jas_stream_t *in, jas_iccuint16_t *val)\n \n static int jas_iccgetsint32(jas_stream_t *in, jas_iccsint32_t *val)\n {\n-\tulonglong tmp;\n+\tjas_ulonglong tmp;\n \tif (jas_iccgetuint(in, 4, &tmp))\n \t\treturn -1;\n-\t*val = (tmp & 0x80000000) ? (-JAS_CAST(longlong, (((~tmp) &\n-\t  0x7fffffff) + 1))) : JAS_CAST(longlong, tmp);\n+\t*val = (tmp & 0x80000000) ? (-JAS_CAST(jas_longlong, (((~tmp) &\n+\t  0x7fffffff) + 1))) : JAS_CAST(jas_longlong, tmp);\n \treturn 0;\n }\n \n static int jas_iccgetuint32(jas_stream_t *in, jas_iccuint32_t *val)\n {\n-\tulonglong tmp;\n+\tjas_ulonglong tmp;\n \tif (jas_iccgetuint(in, 4, &tmp))\n \t\treturn -1;\n \t*val = tmp;\n@@ -1657,14 +1657,14 @@ static int jas_iccgetuint32(jas_stream_t *in, jas_iccuint32_t *val)\n \n static int jas_iccgetuint64(jas_stream_t *in, jas_iccuint64_t *val)\n {\n-\tulonglong tmp;\n+\tjas_ulonglong tmp;\n \tif (jas_iccgetuint(in, 8, &tmp))\n \t\treturn -1;\n \t*val = tmp;\n \treturn 0;\n }\n \n-static int jas_iccputuint(jas_stream_t *out, int n, ulonglong val)\n+static int jas_iccputuint(jas_stream_t *out, int n, jas_ulonglong val)\n {\n \tint i;\n \tint c;\n@@ -1676,9 +1676,9 @@ static int jas_iccputuint(jas_stream_t *out, int n, ulonglong val)\n \treturn 0;\n }\n \n-static int jas_iccputsint(jas_stream_t *out, int n, longlong val)\n+static int jas_iccputsint(jas_stream_t *out, int n, jas_longlong val)\n {\n-\tulonglong tmp;\n+\tjas_ulonglong tmp;\n \ttmp = (val < 0) ? (abort(), 0) : val;\n \treturn jas_iccputuint(out, n, tmp);\n }\n@@ -1719,7 +1719,7 @@ static long jas_iccpowi(int x, int n)\n }\n \n \n-jas_iccprof_t *jas_iccprof_createfrombuf(uchar *buf, int len)\n+jas_iccprof_t *jas_iccprof_createfrombuf(jas_uchar *buf, int len)\n {\n \tjas_stream_t *in;\n \tjas_iccprof_t *prof;\ndiff --git a\/src\/libjasper\/base\/jas_iccdata.c b\/src\/libjasper\/base\/jas_iccdata.c\nindex bf68bf0..dcbedf2 100644\n--- a\/src\/libjasper\/base\/jas_iccdata.c\n+++ b\/src\/libjasper\/base\/jas_iccdata.c\n@@ -62,7 +62,7 @@\n #include <jasper\/jas_config.h>\n #include <jasper\/jas_types.h>\n \n-uchar jas_iccprofdata_srgb[] =\n+jas_uchar jas_iccprofdata_srgb[] =\n {\n \t0x00, 0x00, 0x0c, 0x48, 0x4c, 0x69, 0x6e, 0x6f,\n \t0x02, 0x10, 0x00, 0x00, 0x6d, 0x6e, 0x74, 0x72,\n@@ -461,7 +461,7 @@ uchar jas_iccprofdata_srgb[] =\n \n int jas_iccprofdata_srgblen = sizeof(jas_iccprofdata_srgb);\n \n-uchar jas_iccprofdata_sgray[] = {\n+jas_uchar jas_iccprofdata_sgray[] = {\n \t0x00, 0x00, 0x01, 0x8a, 0x00, 0x00, 0x00, 0x00,\n \t0x02, 0x20, 0x00, 0x00, 0x73, 0x63, 0x6e, 0x72,\n \t0x47, 0x52, 0x41, 0x59, 0x58, 0x59, 0x5a, 0x20,\ndiff --git a\/src\/libjasper\/base\/jas_image.c b\/src\/libjasper\/base\/jas_image.c\nindex 7b56d17..f6dee96 100644\n--- a\/src\/libjasper\/base\/jas_image.c\n+++ b\/src\/libjasper\/base\/jas_image.c\n@@ -133,30 +133,35 @@ jas_image_t *jas_image_create(int numcmpts, jas_image_cmptparm_t *cmptparms,\n   int clrspc)\n {\n \tjas_image_t *image;\n-\tuint_fast32_t rawsize;\n+\tsize_t rawsize;\n \tuint_fast32_t inmem;\n \tint cmptno;\n \tjas_image_cmptparm_t *cmptparm;\n \n+\timage = 0;\n+\n+\tJAS_DBGLOG(100, (\"jas_image_create(%d, %p, %d)\\n\", numcmpts, cmptparms,\n+\t  clrspc));\n+\n \tif (!(image = jas_image_create0())) {\n-\t\treturn 0;\n+\t\tgoto error;\n \t}\n \n \timage->clrspc_ = clrspc;\n \timage->maxcmpts_ = numcmpts;\n-\timage->inmem_ = true;\n+\/\/\timage->inmem_ = true;\n \n \t\/* Allocate memory for the per-component information. *\/\n \tif (!(image->cmpts_ = jas_alloc2(image->maxcmpts_,\n \t  sizeof(jas_image_cmpt_t *)))) {\n-\t\tjas_image_destroy(image);\n-\t\treturn 0;\n+\t\tgoto error;\n \t}\n \t\/* Initialize in case of failure. *\/\n \tfor (cmptno = 0; cmptno < image->maxcmpts_; ++cmptno) {\n \t\timage->cmpts_[cmptno] = 0;\n \t}\n \n+#if 0\n \t\/* Compute the approximate raw size of the image. *\/\n \trawsize = 0;\n \tfor (cmptno = 0, cmptparm = cmptparms; cmptno < numcmpts; ++cmptno,\n@@ -167,16 +172,22 @@ jas_image_t *jas_image_create(int numcmpts, jas_image_cmptparm_t *cmptparms,\n \t\/* Decide whether to buffer the image data in memory, based on the\n \t  raw size of the image. *\/\n \tinmem = (rawsize < JAS_IMAGE_INMEMTHRESH);\n+#endif\n \n \t\/* Create the individual image components. *\/\n \tfor (cmptno = 0, cmptparm = cmptparms; cmptno < numcmpts; ++cmptno,\n \t  ++cmptparm) {\n+\t\tif (!jas_safe_size_mul3(cmptparm->width, cmptparm->height,\n+\t\t  (cmptparm->prec + 7), &rawsize)) {\n+\t\t\tgoto error;\n+\t\t}\n+\t\trawsize \/= 8;\n+\t\tinmem = (rawsize < JAS_IMAGE_INMEMTHRESH);\n \t\tif (!(image->cmpts_[cmptno] = jas_image_cmpt_create(cmptparm->tlx,\n \t\t  cmptparm->tly, cmptparm->hstep, cmptparm->vstep,\n \t\t  cmptparm->width, cmptparm->height, cmptparm->prec,\n \t\t  cmptparm->sgnd, inmem))) {\n-\t\t\tjas_image_destroy(image);\n-\t\t\treturn 0;\n+\t\t\tgoto error;\n \t\t}\n \t\t++image->numcmpts_;\n \t}\n@@ -186,6 +197,12 @@ jas_image_t *jas_image_create(int numcmpts, jas_image_cmptparm_t *cmptparms,\n \tjas_image_setbbox(image);\n \n \treturn image;\n+\n+error:\n+\tif (image) {\n+\t\tjas_image_destroy(image);\n+\t}\n+\treturn 0;\n }\n \n jas_image_t *jas_image_create0()\n@@ -204,7 +221,7 @@ jas_image_t *jas_image_create0()\n \timage->numcmpts_ = 0;\n \timage->maxcmpts_ = 0;\n \timage->cmpts_ = 0;\n-\timage->inmem_ = true;\n+\/\/\timage->inmem_ = true;\n \timage->cmprof_ = 0;\n \n \treturn image;\n@@ -316,6 +333,19 @@ static jas_image_cmpt_t *jas_image_cmpt_create(int_fast32_t tlx,\n \tjas_image_cmpt_t *cmpt;\n \tsize_t size;\n \n+\tJAS_DBGLOG(100, (\n+\t  \"jas_image_cmpt_create(%ld, %ld, %ld, %ld, %ld, %ld, %d, %d, %d)\\n\",\n+\t  JAS_CAST(long, tlx),\n+\t  JAS_CAST(long, tly),\n+\t  JAS_CAST(long, hstep),\n+\t  JAS_CAST(long, vstep),\n+\t  JAS_CAST(long, width),\n+\t  JAS_CAST(long, height),\n+\t  JAS_CAST(int, depth),\n+\t  sgnd,\n+\t  inmem\n+\t  ));\n+\n \tcmpt = 0;\n \tif (width < 0 || height < 0 || hstep <= 0 || vstep <= 0) {\n \t\tgoto error;\n@@ -324,6 +354,9 @@ static jas_image_cmpt_t *jas_image_cmpt_create(int_fast32_t tlx,\n \t  !jas_safe_intfast32_add(tly, height, 0)) {\n \t\tgoto error;\n \t}\n+\tif (!jas_safe_intfast32_mul3(width, height, depth, 0)) {\n+\t\tgoto error;\n+\t}\n \n \tif (!(cmpt = jas_malloc(sizeof(jas_image_cmpt_t)))) {\n \t\tgoto error;\n@@ -344,8 +377,7 @@ static jas_image_cmpt_t *jas_image_cmpt_create(int_fast32_t tlx,\n \t\/\/ Compute the number of samples in the image component, while protecting\n \t\/\/ against overflow.\n \t\/\/ size = cmpt->width_ * cmpt->height_ * cmpt->cps_;\n-\tif (!jas_safe_size_mul(cmpt->width_, cmpt->height_, &size) ||\n-\t  !jas_safe_size_mul(size, cmpt->cps_, &size)) {\n+\tif (!jas_safe_size_mul3(cmpt->width_, cmpt->height_, cmpt->cps_, &size)) {\n \t\tgoto error;\n \t}\n \tcmpt->stream_ = (inmem) ? jas_stream_memopen2(0, size) :\n@@ -1279,7 +1311,7 @@ static void jas_image_calcbbox2(jas_image_t *image, jas_image_coord_t *tlx,\n \t*bry = tmpbry;\n }\n \n-static inline long decode_twos_comp(ulong c, int prec)\n+static inline long decode_twos_comp(jas_ulong c, int prec)\n {\n \tlong result;\n \tassert(prec >= 2);\n@@ -1289,9 +1321,9 @@ static inline long decode_twos_comp(ulong c, int prec)\n \treturn result;\n }\n \n-static inline ulong encode_twos_comp(long n, int prec)\n+static inline jas_ulong encode_twos_comp(long n, int prec)\n {\n-\tulong result;\n+\tjas_ulong result;\n \tassert(prec >= 2);\n \tjas_eprintf(\"warning: support for signed data is untested\\n\");\n \t\/\/ NOTE: Is this correct?\n@@ -1332,7 +1364,7 @@ static int putint(jas_stream_t *out, int sgnd, int prec, long val)\n \tint n;\n \tint c;\n \tbool s;\n-\tulong tmp;\n+\tjas_ulong tmp;\n \tassert((!sgnd && prec >= 1) || (sgnd && prec >= 2));\n \tif (sgnd) {\n \t\tval = encode_twos_comp(val, prec);\ndiff --git a\/src\/libjasper\/base\/jas_seq.c b\/src\/libjasper\/base\/jas_seq.c\nindex 27a21e9..6c5e163 100644\n--- a\/src\/libjasper\/base\/jas_seq.c\n+++ b\/src\/libjasper\/base\/jas_seq.c\n@@ -84,7 +84,8 @@\n * Constructors and destructors.\n \\******************************************************************************\/\n \n-jas_matrix_t *jas_seq2d_create(int xstart, int ystart, int xend, int yend)\n+jas_matrix_t *jas_seq2d_create(jas_matind_t xstart, jas_matind_t ystart,\n+  jas_matind_t xend, jas_matind_t yend)\n {\n \tjas_matrix_t *matrix;\n \tassert(xstart <= xend && ystart <= yend);\n@@ -98,10 +99,10 @@ jas_matrix_t *jas_seq2d_create(int xstart, int ystart, int xend, int yend)\n \treturn matrix;\n }\n \n-jas_matrix_t *jas_matrix_create(int numrows, int numcols)\n+jas_matrix_t *jas_matrix_create(jas_matind_t numrows, jas_matind_t numcols)\n {\n \tjas_matrix_t *matrix;\n-\tint i;\n+\tjas_matind_t i;\n \tsize_t size;\n \n \tmatrix = 0;\n@@ -180,8 +181,8 @@ void jas_matrix_destroy(jas_matrix_t *matrix)\n jas_seq2d_t *jas_seq2d_copy(jas_seq2d_t *x)\n {\n \tjas_matrix_t *y;\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \ty = jas_seq2d_create(jas_seq2d_xstart(x), jas_seq2d_ystart(x),\n \t  jas_seq2d_xend(x), jas_seq2d_yend(x));\n \tassert(y);\n@@ -196,8 +197,8 @@ jas_seq2d_t *jas_seq2d_copy(jas_seq2d_t *x)\n jas_matrix_t *jas_matrix_copy(jas_matrix_t *x)\n {\n \tjas_matrix_t *y;\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \ty = jas_matrix_create(x->numrows_, x->numcols_);\n \tfor (i = 0; i < x->numrows_; ++i) {\n \t\tfor (j = 0; j < x->numcols_; ++j) {\n@@ -211,17 +212,17 @@ jas_matrix_t *jas_matrix_copy(jas_matrix_t *x)\n * Bind operations.\n \\******************************************************************************\/\n \n-void jas_seq2d_bindsub(jas_matrix_t *s, jas_matrix_t *s1, int xstart,\n-  int ystart, int xend, int yend)\n+void jas_seq2d_bindsub(jas_matrix_t *s, jas_matrix_t *s1, jas_matind_t xstart,\n+  jas_matind_t ystart, jas_matind_t xend, jas_matind_t yend)\n {\n \tjas_matrix_bindsub(s, s1, ystart - s1->ystart_, xstart - s1->xstart_,\n \t  yend - s1->ystart_ - 1, xend - s1->xstart_ - 1);\n }\n \n-void jas_matrix_bindsub(jas_matrix_t *mat0, jas_matrix_t *mat1, int r0,\n-  int c0, int r1, int c1)\n+void jas_matrix_bindsub(jas_matrix_t *mat0, jas_matrix_t *mat1,\n+  jas_matind_t r0, jas_matind_t c0, jas_matind_t r1, jas_matind_t c1)\n {\n-\tint i;\n+\tjas_matind_t i;\n \n \tif (mat0->data_) {\n \t\tif (!(mat0->flags_ & JAS_MATRIX_REF)) {\n@@ -265,8 +266,8 @@ void jas_matrix_bindsub(jas_matrix_t *mat0, jas_matrix_t *mat1, int r0,\n \n int jas_matrix_cmp(jas_matrix_t *mat0, jas_matrix_t *mat1)\n {\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \n \tif (mat0->numrows_ != mat1->numrows_ || mat0->numcols_ !=\n \t  mat1->numcols_) {\n@@ -284,10 +285,10 @@ int jas_matrix_cmp(jas_matrix_t *mat0, jas_matrix_t *mat1)\n \n void jas_matrix_divpow2(jas_matrix_t *matrix, int n)\n {\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tjas_seqent_t *rowstart;\n-\tint rowstep;\n+\tjas_matind_t rowstep;\n \tjas_seqent_t *data;\n \n \tif (jas_matrix_numrows(matrix) > 0 && jas_matrix_numcols(matrix) > 0) {\n@@ -307,12 +308,12 @@ void jas_matrix_divpow2(jas_matrix_t *matrix, int n)\n void jas_matrix_clip(jas_matrix_t *matrix, jas_seqent_t minval,\n   jas_seqent_t maxval)\n {\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tjas_seqent_t v;\n \tjas_seqent_t *rowstart;\n \tjas_seqent_t *data;\n-\tint rowstep;\n+\tjas_matind_t rowstep;\n \n \tif (jas_matrix_numrows(matrix) > 0 && jas_matrix_numcols(matrix) > 0) {\n \t\tassert(matrix->rows_);\n@@ -335,10 +336,10 @@ void jas_matrix_clip(jas_matrix_t *matrix, jas_seqent_t minval,\n \n void jas_matrix_asr(jas_matrix_t *matrix, int n)\n {\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tjas_seqent_t *rowstart;\n-\tint rowstep;\n+\tjas_matind_t rowstep;\n \tjas_seqent_t *data;\n \n \tassert(n >= 0);\n@@ -358,10 +359,10 @@ void jas_matrix_asr(jas_matrix_t *matrix, int n)\n \n void jas_matrix_asl(jas_matrix_t *matrix, int n)\n {\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tjas_seqent_t *rowstart;\n-\tint rowstep;\n+\tjas_matind_t rowstep;\n \tjas_seqent_t *data;\n \n \tif (jas_matrix_numrows(matrix) > 0 && jas_matrix_numcols(matrix) > 0) {\n@@ -382,10 +383,11 @@ void jas_matrix_asl(jas_matrix_t *matrix, int n)\n * Code.\n \\******************************************************************************\/\n \n-int jas_matrix_resize(jas_matrix_t *matrix, int numrows, int numcols)\n+int jas_matrix_resize(jas_matrix_t *matrix, jas_matind_t numrows,\n+  jas_matind_t numcols)\n {\n-\tint size;\n-\tint i;\n+\tjas_matind_t size;\n+\tjas_matind_t i;\n \n \tsize = numrows * numcols;\n \tif (size > matrix->datasize_ || numrows > matrix->maxrows_) {\n@@ -404,10 +406,10 @@ int jas_matrix_resize(jas_matrix_t *matrix, int numrows, int numcols)\n \n void jas_matrix_setall(jas_matrix_t *matrix, jas_seqent_t val)\n {\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tjas_seqent_t *rowstart;\n-\tint rowstep;\n+\tjas_matind_t rowstep;\n \tjas_seqent_t *data;\n \n \tif (jas_matrix_numrows(matrix) > 0 && jas_matrix_numcols(matrix) > 0) {\n@@ -426,20 +428,32 @@ void jas_matrix_setall(jas_matrix_t *matrix, jas_seqent_t val)\n jas_matrix_t *jas_seq2d_input(FILE *in)\n {\n \tjas_matrix_t *matrix;\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tlong x;\n-\tint numrows;\n-\tint numcols;\n-\tint xoff;\n-\tint yoff;\n-\n-\tif (fscanf(in, \"%d %d\", &xoff, &yoff) != 2)\n+\tjas_matind_t numrows;\n+\tjas_matind_t numcols;\n+\tjas_matind_t xoff;\n+\tjas_matind_t yoff;\n+\tlong tmp_xoff;\n+\tlong tmp_yoff;\n+\tlong tmp_numrows;\n+\tlong tmp_numcols;\n+\n+\tif (fscanf(in, \"%ld %ld\", &tmp_xoff, &tmp_yoff) != 2) {\n \t\treturn 0;\n-\tif (fscanf(in, \"%d %d\", &numcols, &numrows) != 2)\n+\t}\n+\txoff = tmp_xoff;\n+\tyoff = tmp_yoff;\n+\tif (fscanf(in, \"%ld %ld\", &tmp_numcols, &tmp_numrows) != 2) {\n \t\treturn 0;\n-\tif (!(matrix = jas_seq2d_create(xoff, yoff, xoff + numcols, yoff + numrows)))\n+\t}\n+\tnumrows = tmp_numrows;\n+\tnumcols = tmp_numcols;\n+\tif (!(matrix = jas_seq2d_create(xoff, yoff, xoff + numcols,\n+\t  yoff + numrows))) {\n \t\treturn 0;\n+\t}\n \n \tif (jas_matrix_numrows(matrix) != numrows ||\n \t  jas_matrix_numcols(matrix) != numcols) {\n@@ -463,8 +477,8 @@ jas_matrix_t *jas_seq2d_input(FILE *in)\n int jas_seq2d_output(jas_matrix_t *matrix, FILE *out)\n {\n #define MAXLINELEN\t80\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tjas_seqent_t x;\n \tchar buf[MAXLINELEN + 1];\n \tchar sbuf[MAXLINELEN + 1];\ndiff --git a\/src\/libjasper\/base\/jas_stream.c b\/src\/libjasper\/base\/jas_stream.c\nindex cea4a95..327ee57 100644\n--- a\/src\/libjasper\/base\/jas_stream.c\n+++ b\/src\/libjasper\/base\/jas_stream.c\n@@ -71,18 +71,21 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n+#include \"jasper\/jas_config.h\"\n+\n #include <assert.h>\n-#if defined(HAVE_FCNTL_H)\n+#if defined(JAS_HAVE_FCNTL_H)\n #include <fcntl.h>\n #endif\n #include <stdlib.h>\n #include <stdarg.h>\n #include <stdio.h>\n #include <ctype.h>\n-#if defined(HAVE_UNISTD_H)\n+#if defined(JAS_HAVE_UNISTD_H)\n #include <unistd.h>\n #endif\n-#if defined(WIN32) || defined(HAVE_IO_H)\n+#if defined(WIN32) || defined(JAS_HAVE_IO_H)\n #include <io.h>\n #endif\n \n@@ -909,7 +912,7 @@ static void jas_stream_initbuf(jas_stream_t *stream, int bufmode, char *buf,\n \t\t\t\/* The buffer must be large enough to accommodate maximum\n \t\t\t  putback. *\/\n \t\t\tassert(bufsize > JAS_STREAM_MAXPUTBACK);\n-\t\t\tstream->bufbase_ = JAS_CAST(uchar *, buf);\n+\t\t\tstream->bufbase_ = JAS_CAST(jas_uchar *, buf);\n \t\t\tstream->bufsize_ = bufsize - JAS_STREAM_MAXPUTBACK;\n \t\t}\n \t} else {\ndiff --git a\/src\/libjasper\/base\/jas_tmr.c b\/src\/libjasper\/base\/jas_tmr.c\nindex babb9fd..b3540d3 100644\n--- a\/src\/libjasper\/base\/jas_tmr.c\n+++ b\/src\/libjasper\/base\/jas_tmr.c\n@@ -69,6 +69,9 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n+#include \"jasper\/jas_config.h\"\n+\n #include <stdio.h>\n #include <stdlib.h>\n #include <time.h>\n@@ -79,7 +82,7 @@\n * Code.\n \\******************************************************************************\/\n \n-#if defined(HAVE_GETTIMEOFDAY)\n+#if defined(JAS_HAVE_GETTIMEOFDAY)\n \n void jas_tmr_start(jas_tmr_t *tmr)\n {\n@@ -104,7 +107,7 @@ double jas_tmr_get(jas_tmr_t *tmr)\n \treturn t1 - t0;\n }\n \n-#elif defined(HAVE_GETRUSAGE)\n+#elif defined(JAS_HAVE_GETRUSAGE)\n \n void jas_tmr_start(jas_tmr_t *tmr)\n {\ndiff --git a\/src\/libjasper\/bmp\/bmp_dec.c b\/src\/libjasper\/bmp\/bmp_dec.c\nindex d5a903f..6af2216 100644\n--- a\/src\/libjasper\/bmp\/bmp_dec.c\n+++ b\/src\/libjasper\/bmp\/bmp_dec.c\n@@ -78,9 +78,22 @@\n #include \"jasper\/jas_image.h\"\n #include \"jasper\/jas_malloc.h\"\n #include \"jasper\/jas_debug.h\"\n+#include \"jasper\/jas_tvp.h\"\n \n #include \"bmp_cod.h\"\n \n+\/******************************************************************************\\\n+* Local types.\n+\\******************************************************************************\/\n+\n+typedef struct {\n+\tsize_t max_samples;\n+} bmp_dec_importopts_t;\n+\n+typedef enum {\n+\tOPT_MAXSIZE,\n+} optid_t;\n+\n \/******************************************************************************\\\n * Local prototypes.\n \\******************************************************************************\/\n@@ -92,6 +105,43 @@ static int bmp_getint16(jas_stream_t *in, int_fast16_t *val);\n static int bmp_getint32(jas_stream_t *in, int_fast32_t *val);\n static int bmp_gobble(jas_stream_t *in, long n);\n \n+\/******************************************************************************\\\n+* Option parsing.\n+\\******************************************************************************\/\n+\n+static jas_taginfo_t decopts[] = {\n+\t{OPT_MAXSIZE, \"max_samples\"},\n+\t{-1, 0}\n+};\n+\n+static int bmp_dec_parseopts(char *optstr, bmp_dec_importopts_t *opts)\n+{\n+\tjas_tvparser_t *tvp;\n+\n+\topts->max_samples = 128 * JAS_MEBI;\n+\n+\tif (!(tvp = jas_tvparser_create(optstr ? optstr : \"\"))) {\n+\t\treturn -1;\n+\t}\n+\n+\twhile (!jas_tvparser_next(tvp)) {\n+\t\tswitch (jas_taginfo_nonull(jas_taginfos_lookup(decopts,\n+\t\t  jas_tvparser_gettag(tvp)))->id) {\n+\t\tcase OPT_MAXSIZE:\n+\t\t\topts->max_samples = atoi(jas_tvparser_getval(tvp));\n+\t\t\tbreak;\n+\t\tdefault:\n+\t\t\tjas_eprintf(\"warning: ignoring invalid option %s\\n\",\n+\t\t\t  jas_tvparser_gettag(tvp));\n+\t\t\tbreak;\n+\t\t}\n+\t}\n+\n+\tjas_tvparser_destroy(tvp);\n+\n+\treturn 0;\n+}\n+\n \/******************************************************************************\\\n * Interface functions.\n \\******************************************************************************\/\n@@ -106,12 +156,14 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \tjas_image_cmptparm_t *cmptparm;\n \tuint_fast16_t numcmpts;\n \tlong n;\n+\tbmp_dec_importopts_t opts;\n+\tsize_t num_samples;\n \n \timage = 0;\n \tinfo = 0;\n \n-\tif (optstr) {\n-\t\tjas_eprintf(\"warning: ignoring BMP decoder options\\n\");\n+\tif (bmp_dec_parseopts(optstr, &opts)) {\n+\t\tgoto error;\n \t}\n \n \tjas_eprintf(\n@@ -125,7 +177,6 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \tif (bmp_gethdr(in, &hdr)) {\n \t\tjas_eprintf(\"cannot get header\\n\");\n \t\tgoto error;\n-\t\t\/\/return 0;\n \t}\n \tJAS_DBGLOG(1, (\n \t  \"BMP header: magic 0x%x; siz %d; res1 %d; res2 %d; off %d\\n\",\n@@ -135,7 +186,6 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \t\/* Read the bitmap information. *\/\n \tif (!(info = bmp_getinfo(in))) {\n \t\tjas_eprintf(\"cannot get info\\n\");\n-\t\t\/\/return 0;\n \t\tgoto error;\n \t}\n \tJAS_DBGLOG(1,\n@@ -154,11 +204,21 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \t\tgoto error;\n \t}\n \n+\tif (!jas_safe_size_mul3(info->width, info->height, info->numplanes,\n+\t  &num_samples)) {\n+\t\tjas_eprintf(\"image size too large\\n\");\n+\t\tgoto error;\n+\t}\n+\n+\tif (opts.max_samples > 0 && num_samples > opts.max_samples) {\n+\t\tjas_eprintf(\"maximum number of pixels exceeded (%zu)\\n\",\n+\t\t  opts.max_samples);\n+\t\tgoto error;\n+\t}\n+\n \t\/* Ensure that we support this type of BMP file. *\/\n \tif (!bmp_issupported(&hdr, info)) {\n \t\tjas_eprintf(\"error: unsupported BMP encoding\\n\");\n-\t\t\/\/bmp_info_destroy(info);\n-\t\t\/\/return 0;\n \t\tgoto error;\n \t}\n \n@@ -167,13 +227,10 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \tif ((n = hdr.off - (BMP_HDRLEN + BMP_INFOLEN + BMP_PALLEN(info))) < 0) {\n \t\tjas_eprintf(\"error: possibly bad bitmap offset?\\n\");\n \t\tgoto error;\n-\t\t\/\/return 0;\n \t}\n \tif (n > 0) {\n \t\tjas_eprintf(\"skipping unknown data in BMP file\\n\");\n \t\tif (bmp_gobble(in, n)) {\n-\t\t\t\/\/bmp_info_destroy(info);\n-\t\t\t\/\/return 0;\n \t\t\tgoto error;\n \t\t}\n \t}\n@@ -196,8 +253,6 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \t\/* Create image object. *\/\n \tif (!(image = jas_image_create(numcmpts, cmptparms,\n \t  JAS_CLRSPC_UNKNOWN))) {\n-\t\t\/\/bmp_info_destroy(info);\n-\t\t\/\/return 0;\n \t\tgoto error;\n \t}\n \n@@ -217,9 +272,6 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \n \t\/* Read the bitmap data. *\/\n \tif (bmp_getdata(in, info, image)) {\n-\t\t\/\/bmp_info_destroy(info);\n-\t\t\/\/jas_image_destroy(image);\n-\t\t\/\/return 0;\n \t\tgoto error;\n \t}\n \n@@ -241,7 +293,7 @@ int bmp_validate(jas_stream_t *in)\n {\n \tint n;\n \tint i;\n-\tuchar buf[2];\n+\tjas_uchar buf[2];\n \n \tassert(JAS_STREAM_MAXPUTBACK >= 2);\n \ndiff --git a\/src\/libjasper\/include\/jasper\/jas_cm.h b\/src\/libjasper\/include\/jasper\/jas_cm.h\nindex d5cd22e..af785f3 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_cm.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_cm.h\n@@ -68,7 +68,9 @@\n #ifndef JAS_CM_H\n #define JAS_CM_H\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n+\n #include <jasper\/jas_icc.h>\n \n #ifdef __cplusplus\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_config.h.in b\/src\/libjasper\/include\/jasper\/jas_config.h.in\nnew file mode 100644\nindex 0000000..0c0e86f\n--- \/dev\/null\n+++ b\/src\/libjasper\/include\/jasper\/jas_config.h.in\n@@ -0,0 +1,27 @@\n+#ifndef JAS_CONFIG_H\n+#define JAS_CONFIG_H\n+\n+\/* This preprocessor symbol identifies the version of JasPer. *\/\n+#define\tJAS_VERSION \"@JAS_VERSION@\"\n+\n+@JAS_HAVE_FCNTL_H@\n+@JAS_HAVE_IO_H@\n+@JAS_HAVE_UNISTD_H@\n+@JAS_HAVE_WINDOWS_H@\n+@JAS_HAVE_SYS_TIME_H@\n+@JAS_HAVE_SYS_TYPES_H@\n+\n+@JAS_HAVE_GETTIMEOFDAY@\n+@JAS_HAVE_GETRUSAGE@\n+\n+#if defined(__GNUC__) && !defined(__clang__)\n+#define JAS_ATTRIBUTE_DISABLE_USAN \\\n+  __attribute__((no_sanitize_undefined))\n+#elif defined(__clang__)\n+#define JAS_ATTRIBUTE_DISABLE_USAN \\\n+  __attribute__((no_sanitize(\"undefined\")))\n+#else\n+#define JAS_ATTRIBUTE_DISABLE_USAN\n+#endif\n+\n+#endif\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_config2.h b\/src\/libjasper\/include\/jasper\/jas_config2.h\nindex f139db0..2666b79 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_config2.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_config2.h\n@@ -70,23 +70,10 @@\n  * normally defined by configure.\n  *\/\n \n-#define\tuchar\t\tunsigned char\n-#define\tushort\t\tunsigned short\n-#define\tuint\t\tunsigned int\n-#define\tulong\t\tunsigned long\n-#undef longlong\n-#define\tlonglong\tlong long\n-#undef ulonglong\n-#define\tulonglong\tunsigned long long\n-\/*#define\tssize_t\t\tint*\/\n-\n #define\tHAVE_FCNTL_H\t\t1\n-#define\tHAVE_LIMITS_H\t\t1\n #define\tHAVE_IO_H\t\t1\n #define\tHAVE_WINDOWS_H\t\t1\n #define\tHAVE_SYS_TYPES_H\t1\n-#define\tHAVE_STDLIB_H\t\t1\n-#define\tHAVE_STDDEF_H\t\t1\n \n #ifndef __cplusplus\n #undef inline\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_debug.h b\/src\/libjasper\/include\/jasper\/jas_debug.h\nindex 6b78112..d820d36 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_debug.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_debug.h\n@@ -72,9 +72,11 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n+#include <jasper\/jas_config.h>\n+\n #include <stdio.h>\n \n-#include <jasper\/jas_config.h>\n #include <jasper\/jas_types.h>\n #include <jasper\/jas_debug.h>\n \ndiff --git a\/src\/libjasper\/include\/jasper\/jas_fix.h b\/src\/libjasper\/include\/jasper\/jas_fix.h\nindex e9164c7..f75d52a 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_fix.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_fix.h\n@@ -74,11 +74,13 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n+#include <jasper\/jas_config.h>\n+\n #include <stdio.h>\n #include <stdlib.h>\n #include <math.h>\n \n-#include <jasper\/jas_config.h>\n #include <jasper\/jas_types.h>\n #include <jasper\/jas_debug.h>\n \ndiff --git a\/src\/libjasper\/include\/jasper\/jas_getopt.h b\/src\/libjasper\/include\/jasper\/jas_getopt.h\nindex 3c7b205..1db2e0f 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_getopt.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_getopt.h\n@@ -74,6 +74,7 @@\n extern \"C\" {\n #endif\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n \/******************************************************************************\\\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_icc.h b\/src\/libjasper\/include\/jasper\/jas_icc.h\nindex 616a572..668f6f5 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_icc.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_icc.h\n@@ -62,7 +62,9 @@\n #ifndef JAS_ICC_H\n #define\tJAS_ICC_H\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n+\n #include <jasper\/jas_types.h>\n #include <jasper\/jas_stream.h>\n \n@@ -252,10 +254,10 @@ typedef struct {\n \tchar *ascdata; \/* ASCII invariant description *\/\n \tjas_iccuint32_t uclangcode; \/* Unicode language code *\/\n \tjas_iccuint32_t uclen; \/* Unicode localizable description count *\/\n-\tuchar *ucdata; \/* Unicode localizable description *\/\n+\tjas_uchar *ucdata; \/* Unicode localizable description *\/\n \tjas_iccuint16_t sccode; \/* ScriptCode code *\/\n \tjas_iccuint8_t maclen; \/* Localizable Macintosh description count *\/\n-\tuchar macdata[69]; \/* Localizable Macintosh description *\/\n+\tjas_uchar macdata[69]; \/* Localizable Macintosh description *\/\n } jas_icctxtdesc_t;\n \n \/* Text type. *\/\n@@ -393,11 +395,11 @@ jas_iccattrval_t *jas_iccattrval_create(jas_iccuint32_t type);\n \n void jas_iccattrtab_dump(jas_iccattrtab_t *attrtab, FILE *out);\n \n-extern uchar jas_iccprofdata_srgb[];\n+extern jas_uchar jas_iccprofdata_srgb[];\n extern int jas_iccprofdata_srgblen;\n-extern uchar jas_iccprofdata_sgray[];\n+extern jas_uchar jas_iccprofdata_sgray[];\n extern int jas_iccprofdata_sgraylen;\n-jas_iccprof_t *jas_iccprof_createfrombuf(uchar *buf, int len);\n+jas_iccprof_t *jas_iccprof_createfrombuf(jas_uchar *buf, int len);\n jas_iccprof_t *jas_iccprof_createfromclrspc(int clrspc);\n \n #ifdef __cplusplus\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_image.h b\/src\/libjasper\/include\/jasper\/jas_image.h\nindex 4dcfcc1..b0594c7 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_image.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_image.h\n@@ -74,7 +74,9 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n+\n #include <jasper\/jas_stream.h>\n #include <jasper\/jas_seq.h>\n #include <jasper\/jas_cm.h>\n@@ -217,7 +219,7 @@ typedef struct {\n \n \tjas_cmprof_t *cmprof_;\n \n-\tbool inmem_;\n+\/\/\tbool inmem_;\n \n } jas_image_t;\n \ndiff --git a\/src\/libjasper\/include\/jasper\/jas_init.h b\/src\/libjasper\/include\/jasper\/jas_init.h\nindex 10301e9..20121f5 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_init.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_init.h\n@@ -62,6 +62,7 @@\n #ifndef JAS_INIT_H\n #define JAS_INIT_H\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #ifdef __cplusplus\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_malloc.h b\/src\/libjasper\/include\/jasper\/jas_malloc.h\nindex f3f9047..7b03933 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_malloc.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_malloc.h\n@@ -74,6 +74,7 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #include <stdlib.h>\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_math.h b\/src\/libjasper\/include\/jasper\/jas_math.h\nindex 88f43ed..723b0fa 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_math.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_math.h\n@@ -74,7 +74,9 @@\n * Includes\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n+\n #include <jasper\/jas_types.h>\n \n #include <assert.h>\n@@ -91,6 +93,9 @@ extern \"C\" {\n * Macros\n \\******************************************************************************\/\n \n+#define JAS_KIBI\tJAS_CAST(size_t, 1024)\n+#define JAS_MEBI\t(JAS_KIBI * JAS_KIBI)\n+\n \/* Compute the absolute value. *\/\n #define\tJAS_ABS(x) \\\n \t(((x) >= 0) ? (x) : (-(x)))\n@@ -187,6 +192,20 @@ inline static bool jas_safe_size_mul(size_t x, size_t y, size_t *result)\n \treturn true;\n }\n \n+inline static bool jas_safe_size_mul3(size_t a, size_t b, size_t c,\n+  size_t *result)\n+{\n+\tsize_t tmp;\n+\tif (!jas_safe_size_mul(a, b, &tmp) ||\n+\t  !jas_safe_size_mul(tmp, c, &tmp)) {\n+\t\treturn false;\n+\t}\n+\tif (result) {\n+\t\t*result = tmp;\n+\t}\n+\treturn true;\n+}\n+\n \/* Compute the sum of two size_t integer with overflow checking. *\/\n inline static bool jas_safe_size_add(size_t x, size_t y, size_t *result)\n {\n@@ -211,6 +230,57 @@ inline static bool jas_safe_size_sub(size_t x, size_t y, size_t *result)\n \treturn true;\n }\n \n+\/* Compute the sum of two size_t integer with overflow checking. *\/\n+inline static bool jas_safe_intfast32_mul(int_fast32_t x, int_fast32_t y,\n+  int_fast32_t *result)\n+{\n+\tif (x > 0) {\n+\t\t\/* x is positive *\/\n+\t\tif (y > 0) {\n+\t\t\t\/* x and y are positive *\/\n+\t\t\tif (x > INT_FAST32_MAX \/ y) {\n+\t\t\t\treturn false;\n+\t\t\t}\n+\t\t} else {\n+\t\t\t\/* x positive, y nonpositive *\/\n+\t\t\tif (y < INT_FAST32_MIN \/ x) {\n+\t\t\t\treturn false;\n+\t\t\t}\n+\t\t}\n+\t} else {\n+\t\t\/* x is nonpositive *\/\n+\t\tif (y > 0) {\n+\t\t\t\/* x is nonpositive, y is positive *\/\n+\t\t\tif (x < INT_FAST32_MIN \/ y) {\n+\t\t\t\treturn false;\n+\t\t\t}\n+\t\t} else { \/* x and y are nonpositive *\/\n+\t\t\tif (x != 0 && y < INT_FAST32_MAX \/ x) {\n+\t\t\t\treturn false;\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tif (result) {\n+\t\t*result = x * y;\n+\t}\n+\treturn true;\n+}\n+\n+inline static bool jas_safe_intfast32_mul3(int_fast32_t a, int_fast32_t b,\n+  int_fast32_t c, int_fast32_t *result)\n+{\n+\tint_fast32_t tmp;\n+\tif (!jas_safe_intfast32_mul(a, b, &tmp) ||\n+\t  !jas_safe_intfast32_mul(tmp, c, &tmp)) {\n+\t\treturn false;\n+\t}\n+\tif (result) {\n+\t\t*result = tmp;\n+\t}\n+\treturn true;\n+}\n+\n \/* Compute the sum of two size_t integer with overflow checking. *\/\n inline static bool jas_safe_intfast32_add(int_fast32_t x, int_fast32_t y,\n   int_fast32_t *result)\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_seq.h b\/src\/libjasper\/include\/jasper\/jas_seq.h\nindex 02fdebf..3cdc9e5 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_seq.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_seq.h\n@@ -74,6 +74,7 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #include <jasper\/jas_stream.h>\n@@ -102,6 +103,8 @@ typedef int_fast32_t jas_seqent_t;\n \/* An element in a matrix. *\/\n typedef int_fast32_t jas_matent_t;\n \n+typedef int_fast32_t jas_matind_t;\n+\n \/* Matrix. *\/\n \n typedef struct {\n@@ -110,22 +113,22 @@ typedef struct {\n \tint flags_;\n \n \t\/* The starting horizontal index. *\/\n-\tint_fast32_t xstart_;\n+\tjas_matind_t xstart_;\n \n \t\/* The starting vertical index. *\/\n-\tint_fast32_t ystart_;\n+\tjas_matind_t ystart_;\n \n \t\/* The ending horizontal index. *\/\n-\tint_fast32_t xend_;\n+\tjas_matind_t xend_;\n \n \t\/* The ending vertical index. *\/\n-\tint_fast32_t yend_;\n+\tjas_matind_t yend_;\n \n \t\/* The number of rows in the matrix. *\/\n-\tint_fast32_t numrows_;\n+\tjas_matind_t numrows_;\n \n \t\/* The number of columns in the matrix. *\/\n-\tint_fast32_t numcols_;\n+\tjas_matind_t numcols_;\n \n \t\/* Pointers to the start of each row. *\/\n \tjas_seqent_t **rows_;\n@@ -182,25 +185,26 @@ typedef jas_matrix_t jas_seq_t;\n \t(&(matrix)->rows_[i][j])\n \n #define\tjas_matrix_getvref(matrix, i) \\\n-\t(((matrix)->numrows_ > 1) ? jas_matrix_getref(matrix, i, 0) : jas_matrix_getref(matrix, 0, i))\n+\t(((matrix)->numrows_ > 1) ? jas_matrix_getref(matrix, i, 0) : \\\n+\t  jas_matrix_getref(matrix, 0, i))\n \n #define jas_matrix_length(matrix) \\\n \t(max((matrix)->numrows_, (matrix)->numcols_))\n \n \/* Create a matrix with the specified dimensions. *\/\n-jas_matrix_t *jas_matrix_create(int numrows, int numcols);\n+jas_matrix_t *jas_matrix_create(jas_matind_t numrows, jas_matind_t numcols);\n \n \/* Destroy a matrix. *\/\n void jas_matrix_destroy(jas_matrix_t *matrix);\n \n \/* Resize a matrix.  The previous contents of the matrix are lost. *\/\n-int jas_matrix_resize(jas_matrix_t *matrix, int numrows, int numcols);\n+int jas_matrix_resize(jas_matrix_t *matrix, jas_matind_t numrows, jas_matind_t numcols);\n \n int jas_matrix_output(jas_matrix_t *matrix, FILE *out);\n \n \/* Create a matrix that references part of another matrix. *\/\n-void jas_matrix_bindsub(jas_matrix_t *mat0, jas_matrix_t *mat1, int r0,\n-  int c0, int r1, int c1);\n+void jas_matrix_bindsub(jas_matrix_t *mat0, jas_matrix_t *mat1, jas_matind_t r0,\n+  jas_matind_t c0, jas_matind_t r1, jas_matind_t c1);\n \n \/* Create a matrix that is a reference to a row of another matrix. *\/\n #define jas_matrix_bindrow(mat0, mat1, r) \\\n@@ -250,7 +254,8 @@ jas_matrix_t *jas_matrix_input(FILE *);\n \n jas_seq2d_t *jas_seq2d_copy(jas_seq2d_t *x);\n \n-jas_matrix_t *jas_seq2d_create(int xstart, int ystart, int xend, int yend);\n+jas_matrix_t *jas_seq2d_create(jas_matind_t xstart, jas_matind_t ystart,\n+  jas_matind_t xend, jas_matind_t yend);\n \n #define\tjas_seq2d_destroy(s) \\\n \tjas_matrix_destroy(s)\n@@ -280,8 +285,8 @@ jas_matrix_t *jas_seq2d_create(int xstart, int ystart, int xend, int yend);\n #define jas_seq2d_size(s) \\\n \t(jas_seq2d_width(s) * jas_seq2d_height(s))\n \n-void jas_seq2d_bindsub(jas_matrix_t *s, jas_matrix_t *s1, int xstart,\n-  int ystart, int xend, int yend);\n+void jas_seq2d_bindsub(jas_matrix_t *s, jas_matrix_t *s1, jas_matind_t xstart,\n+  jas_matind_t ystart, jas_matind_t xend, jas_matind_t yend);\n \n \/******************************************************************************\\\n * Functions\/macros for 1-D sequence class.\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_stream.h b\/src\/libjasper\/include\/jasper\/jas_stream.h\nindex b9801d8..5badccd 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_stream.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_stream.h\n@@ -74,14 +74,15 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #include <stdio.h>\n-#if defined(HAVE_FCNTL_H)\n+#if defined(JAS_HAVE_FCNTL_H)\n #include <fcntl.h>\n #endif\n #include <string.h>\n-#if defined(HAVE_UNISTD_H)\n+#if defined(JAS_HAVE_UNISTD_H)\n #include <unistd.h>\n #endif\n #include <jasper\/jas_types.h>\n@@ -208,24 +209,24 @@ typedef struct {\n \tint flags_;\n \n \t\/* The start of the buffer area to use for reading\/writing. *\/\n-\tuchar *bufbase_;\n+\tjas_uchar *bufbase_;\n \n \t\/* The start of the buffer area excluding the extra initial space for\n \t  character putback. *\/\n-\tuchar *bufstart_;\n+\tjas_uchar *bufstart_;\n \n \t\/* The buffer size. *\/\n \tint bufsize_;\n \n \t\/* The current position in the buffer. *\/\n-\tuchar *ptr_;\n+\tjas_uchar *ptr_;\n \n \t\/* The number of characters that must be read\/written before\n \tthe buffer needs to be filled\/flushed. *\/\n \tint cnt_;\n \n \t\/* A trivial buffer to be used for unbuffered operation. *\/\n-\tuchar tinybuf_[JAS_STREAM_MAXPUTBACK + 1];\n+\tjas_uchar tinybuf_[JAS_STREAM_MAXPUTBACK + 1];\n \n \t\/* The operations for the underlying stream file object. *\/\n \tjas_stream_ops_t *ops_;\n@@ -264,7 +265,7 @@ typedef struct {\n typedef struct {\n \n \t\/* The data associated with this file. *\/\n-\tuchar *buf_;\n+\tjas_uchar *buf_;\n \n \t\/* The allocated size of the buffer for holding file data. *\/\n \tsize_t bufsize_;\n@@ -451,7 +452,7 @@ directly, you will die a horrible, miserable, and painful death! *\/\n \t  jas_stream_putc2(stream, c)) : EOF)\n #define jas_stream_putc2(stream, c) \\\n \t(((stream)->bufmode_ |= JAS_STREAM_WRBUF, --(stream)->cnt_ < 0) ? \\\n-\t  jas_stream_flushbuf((stream), (uchar)(c)) : \\\n+\t  jas_stream_flushbuf((stream), (jas_uchar)(c)) : \\\n \t  (++(stream)->rwcnt_, (int)(*(stream)->ptr_++ = (c))))\n \n \/* These prototypes need to be here for the sake of the stream_getc and\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_string.h b\/src\/libjasper\/include\/jasper\/jas_string.h\nindex f217da2..37fddf3 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_string.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_string.h\n@@ -74,7 +74,9 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n+\n #include <string.h>\n \n #ifdef __cplusplus\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_tmr.h b\/src\/libjasper\/include\/jasper\/jas_tmr.h\nindex 837f2bf..2f645e2 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_tmr.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_tmr.h\n@@ -62,9 +62,11 @@\n #ifndef JAS_TMR_H\n #define JAS_TMR_H\n \n-#include<time.h>\n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n-#if defined(HAVE_SYS_TIME_H)\n+\n+#include<time.h>\n+#if defined(JAS_HAVE_SYS_TIME_H)\n #include <sys\/time.h>\n #endif\n \n@@ -72,14 +74,14 @@\n extern \"C\" {\n #endif\n \n-#if defined(HAVE_GETTIMEOFDAY)\n+#if defined(JAS_HAVE_GETTIMEOFDAY)\n \n typedef struct {\n \tstruct timeval start;\n \tstruct timeval stop;\n } jas_tmr_t;\n \n-#elif defined(HAVE_GETRUSAGE)\n+#elif defined(JAS_HAVE_GETRUSAGE)\n \n typedef struct {\n \tstruct rusage start;\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_tvp.h b\/src\/libjasper\/include\/jasper\/jas_tvp.h\nindex ae4f933..e08402c 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_tvp.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_tvp.h\n@@ -72,6 +72,7 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #ifdef __cplusplus\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_types.h b\/src\/libjasper\/include\/jasper\/jas_types.h\nindex 32c541c..bd83ca5 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_types.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_types.h\n@@ -70,11 +70,13 @@\n #ifndef JAS_TYPES_H\n #define JAS_TYPES_H\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #if !defined(JAS_CONFIGURE)\n \n-#if defined(WIN32) || defined(HAVE_WINDOWS_H)\n+#if defined(WIN32) || defined(JAS_HAVE_WINDOWS_H)\n+\/\/ THIS SHOULD NO LONGER BE NEEDED SINCE MSVC SUPPORTS LONG LONG.\n \/*\n    We are dealing with Microsoft Windows and most likely Microsoft\n    Visual C (MSVC).  (Heaven help us.)  Sadly, MSVC does not correctly\n@@ -84,10 +86,10 @@\n    and \"UINT64\" types that are defined in the header file \"windows.h\".\n  *\/\n #include <windows.h>\n-#undef longlong\n-#define\tlonglong\tINT64\n-#undef ulonglong\n-#define\tulonglong\tUINT64\n+\/\/#undef longlong\n+\/\/#define\tlonglong\tINT64\n+\/\/#undef ulonglong\n+\/\/#define\tulonglong\tUINT64\n #endif\n \n #endif\n@@ -98,29 +100,15 @@\n #include <stdbool.h>\n #include <stdint.h>\n \n-#if defined(HAVE_SYS_TYPES_H)\n+#if defined(JAS_HAVE_SYS_TYPES_H)\n #include <sys\/types.h>\n #endif\n \n-\/* Hopefully, these macro definitions will fix more problems than they cause. *\/\n-#if !defined(uchar)\n-#define uchar unsigned char\n-#endif\n-#if !defined(ushort)\n-#define ushort unsigned short\n-#endif\n-#if !defined(uint)\n-#define uint unsigned int\n-#endif\n-#if !defined(ulong)\n-#define ulong unsigned long\n-#endif\n-#if !defined(longlong)\n-#define longlong long long\n-#endif\n-#if !defined(ulonglong)\n-#define ulonglong unsigned long long\n-#endif\n+#define jas_uchar unsigned char\n+#define jas_uint unsigned int\n+#define jas_ulong unsigned long\n+#define jas_longlong long long\n+#define jas_ulonglong unsigned long long\n \n \/* The below macro is intended to be used for type casts.  By using this\n   macro, type casts can be easily located in the source code with\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_version.h b\/src\/libjasper\/include\/jasper\/jas_version.h\nindex 14da7a0..ea37ed2 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_version.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_version.h\n@@ -68,6 +68,7 @@\n #ifndef JAS_VERSION_H\n #define JAS_VERSION_H\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #ifdef __cplusplus\ndiff --git a\/src\/libjasper\/include\/jasper\/jasper.h b\/src\/libjasper\/include\/jasper\/jasper.h\nindex eb74ba0..fc544eb 100644\n--- a\/src\/libjasper\/include\/jasper\/jasper.h\n+++ b\/src\/libjasper\/include\/jasper\/jasper.h\n@@ -62,7 +62,9 @@\n #ifndef JAS_JASPER_H\n #define JAS_JASPER_H\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n+\n #include <jasper\/jas_types.h>\n #include <jasper\/jas_version.h>\n \ndiff --git a\/src\/libjasper\/jp2\/jp2_dec.c b\/src\/libjasper\/jp2\/jp2_dec.c\nindex 2996393..cb5f14f 100644\n--- a\/src\/libjasper\/jp2\/jp2_dec.c\n+++ b\/src\/libjasper\/jp2\/jp2_dec.c\n@@ -77,6 +77,7 @@\n #include \"jasper\/jas_debug.h\"\n #include \"jasper\/jas_malloc.h\"\n #include \"jasper\/jas_version.h\"\n+#include \"jasper\/jas_types.h\"\n \n #include \"jp2_cod.h\"\n #include \"jp2_dec.h\"\n@@ -225,7 +226,7 @@ jas_image_t *jp2_decode(jas_stream_t *in, char *optstr)\n \n \t\/* Does the number of components indicated in the IHDR box match\n \t  the value specified in the code stream? *\/\n-\tif (dec->ihdr->data.ihdr.numcmpts != JAS_CAST(uint,\n+\tif (dec->ihdr->data.ihdr.numcmpts != JAS_CAST(jas_uint,\n \t  jas_image_numcmpts(dec->image))) {\n \t\tjas_eprintf(\"warning: number of components mismatch\\n\");\n \t}\n@@ -239,7 +240,7 @@ jas_image_t *jp2_decode(jas_stream_t *in, char *optstr)\n \t\/* Determine if all components have the same data type. *\/\n \tsamedtype = true;\n \tdtype = jas_image_cmptdtype(dec->image, 0);\n-\tfor (i = 1; i < JAS_CAST(uint, jas_image_numcmpts(dec->image)); ++i) {\n+\tfor (i = 1; i < JAS_CAST(jas_uint, jas_image_numcmpts(dec->image)); ++i) {\n \t\tif (jas_image_cmptdtype(dec->image, i) != dtype) {\n \t\t\tsamedtype = false;\n \t\t\tbreak;\n@@ -262,14 +263,14 @@ jas_image_t *jp2_decode(jas_stream_t *in, char *optstr)\n \tif (dec->bpcc) {\n \t\t\/* Is the number of components indicated in the BPCC box\n \t\t  consistent with the code stream data? *\/\n-\t\tif (dec->bpcc->data.bpcc.numcmpts != JAS_CAST(uint, jas_image_numcmpts(\n+\t\tif (dec->bpcc->data.bpcc.numcmpts != JAS_CAST(jas_uint, jas_image_numcmpts(\n \t\t  dec->image))) {\n \t\t\tjas_eprintf(\"warning: number of components mismatch\\n\");\n \t\t}\n \t\t\/* Is the component data type information indicated in the BPCC\n \t\t  box consistent with the code stream data? *\/\n \t\tif (!samedtype) {\n-\t\t\tfor (i = 0; i < JAS_CAST(uint, jas_image_numcmpts(dec->image));\n+\t\t\tfor (i = 0; i < JAS_CAST(jas_uint, jas_image_numcmpts(dec->image));\n \t\t\t  ++i) {\n \t\t\t\tif (jas_image_cmptdtype(dec->image, i) !=\n \t\t\t\t  JP2_BPCTODTYPE(dec->bpcc->data.bpcc.bpcs[i])) {\n@@ -324,13 +325,13 @@ jas_image_t *jp2_decode(jas_stream_t *in, char *optstr)\n \t\/* Determine the number of channels (which is essentially the number\n \t  of components after any palette mappings have been applied). *\/\n \tdec->numchans = dec->cmap ? dec->cmap->data.cmap.numchans :\n-\t  JAS_CAST(uint, jas_image_numcmpts(dec->image));\n+\t  JAS_CAST(jas_uint, jas_image_numcmpts(dec->image));\n \n \t\/* Perform a basic sanity check on the CMAP box if present. *\/\n \tif (dec->cmap) {\n \t\tfor (i = 0; i < dec->numchans; ++i) {\n \t\t\t\/* Is the component number reasonable? *\/\n-\t\t\tif (dec->cmap->data.cmap.ents[i].cmptno >= JAS_CAST(uint,\n+\t\t\tif (dec->cmap->data.cmap.ents[i].cmptno >= JAS_CAST(jas_uint,\n \t\t\t  jas_image_numcmpts(dec->image))) {\n \t\t\t\tjas_eprintf(\"error: invalid component number in CMAP box\\n\");\n \t\t\t\tgoto error;\n@@ -391,7 +392,7 @@ jas_image_t *jp2_decode(jas_stream_t *in, char *optstr)\n \n \t\/* Mark all components as being of unknown type. *\/\n \n-\tfor (i = 0; i < JAS_CAST(uint, jas_image_numcmpts(dec->image)); ++i) {\n+\tfor (i = 0; i < JAS_CAST(jas_uint, jas_image_numcmpts(dec->image)); ++i) {\n \t\tjas_image_setcmpttype(dec->image, i, JAS_IMAGE_CT_UNKNOWN);\n \t}\n \ndiff --git a\/src\/libjasper\/jpc\/jpc_cs.c b\/src\/libjasper\/jpc\/jpc_cs.c\nindex e6a5503..cc66ddb 100644\n--- a\/src\/libjasper\/jpc\/jpc_cs.c\n+++ b\/src\/libjasper\/jpc\/jpc_cs.c\n@@ -289,7 +289,7 @@ jpc_ms_t *jpc_getms(jas_stream_t *in, jpc_cstate_t *cstate)\n \t\t\tjpc_ms_dump(ms, stderr);\n \t\t}\n \n-\t\tif (JAS_CAST(ulong, jas_stream_tell(tmpstream)) != ms->len) {\n+\t\tif (JAS_CAST(jas_ulong, jas_stream_tell(tmpstream)) != ms->len) {\n \t\t\tjas_eprintf(\n \t\t\t  \"warning: trailing garbage in marker segment (%ld bytes)\\n\",\n \t\t\t  ms->len - jas_stream_tell(tmpstream));\n@@ -1177,7 +1177,7 @@ static int jpc_ppm_getparms(jpc_ms_t *ms, jpc_cstate_t *cstate, jas_stream_t *in\n \t\tif (!(ppm->data = jas_malloc(ppm->len))) {\n \t\t\tgoto error;\n \t\t}\n-\t\tif (JAS_CAST(uint, jas_stream_read(in, ppm->data, ppm->len)) != ppm->len) {\n+\t\tif (JAS_CAST(jas_uint, jas_stream_read(in, ppm->data, ppm->len)) != ppm->len) {\n \t\t\tgoto error;\n \t\t}\n \t} else {\n@@ -1197,7 +1197,7 @@ static int jpc_ppm_putparms(jpc_ms_t *ms, jpc_cstate_t *cstate, jas_stream_t *ou\n \t\/* Eliminate compiler warning about unused variables. *\/\n \tcstate = 0;\n \n-\tif (JAS_CAST(uint, jas_stream_write(out, (char *) ppm->data, ppm->len)) != ppm->len) {\n+\tif (JAS_CAST(jas_uint, jas_stream_write(out, (char *) ppm->data, ppm->len)) != ppm->len) {\n \t\treturn -1;\n \t}\n \treturn 0;\ndiff --git a\/src\/libjasper\/jpc\/jpc_cs.h b\/src\/libjasper\/jpc\/jpc_cs.h\nindex 311986f..f2fbfee 100644\n--- a\/src\/libjasper\/jpc\/jpc_cs.h\n+++ b\/src\/libjasper\/jpc\/jpc_cs.h\n@@ -490,7 +490,7 @@ typedef struct {\n \tuint_fast16_t len;\n \n \t\/* The data. *\/\n-\tuchar *data;\n+\tjas_uchar *data;\n \n } jpc_ppm_t;\n \n@@ -529,7 +529,7 @@ typedef struct {\n \tuint_fast16_t len;\n \n \t\/* The data. *\/\n-\tuchar *data;\n+\tjas_uchar *data;\n \n } jpc_com_t;\n \n@@ -577,7 +577,7 @@ typedef struct {\n typedef struct {\n \n \t\/* The data. *\/\n-\tuchar *data;\n+\tjas_uchar *data;\n \n \t\/* The length. *\/\n \tuint_fast16_t len;\ndiff --git a\/src\/libjasper\/jpc\/jpc_dec.c b\/src\/libjasper\/jpc\/jpc_dec.c\nindex 28b29fe..58e101d 100644\n--- a\/src\/libjasper\/jpc\/jpc_dec.c\n+++ b\/src\/libjasper\/jpc\/jpc_dec.c\n@@ -2276,7 +2276,7 @@ int jpc_ppxstab_insert(jpc_ppxstab_t *tab, jpc_ppxstabent_t *ent)\n jpc_streamlist_t *jpc_ppmstabtostreams(jpc_ppxstab_t *tab)\n {\n \tjpc_streamlist_t *streams;\n-\tuchar *dataptr;\n+\tjas_uchar *dataptr;\n \tuint_fast32_t datacnt;\n \tuint_fast32_t tpcnt;\n \tjpc_ppxstabent_t *ent;\ndiff --git a\/src\/libjasper\/jpc\/jpc_dec.h b\/src\/libjasper\/jpc\/jpc_dec.h\nindex 2af98ca..81a1a50 100644\n--- a\/src\/libjasper\/jpc\/jpc_dec.h\n+++ b\/src\/libjasper\/jpc\/jpc_dec.h\n@@ -99,7 +99,7 @@ typedef struct {\n \tuint_fast32_t len;\n \n \t\/* The data. *\/\n-\tuchar *data;\n+\tjas_uchar *data;\n \n } jpc_ppxstabent_t;\n \ndiff --git a\/src\/libjasper\/jpc\/jpc_enc.c b\/src\/libjasper\/jpc\/jpc_enc.c\nindex 0a4c0ce..03a86ed 100644\n--- a\/src\/libjasper\/jpc\/jpc_enc.c\n+++ b\/src\/libjasper\/jpc\/jpc_enc.c\n@@ -961,7 +961,7 @@ startoff = jas_stream_getrwcount(enc->out);\n \tcom = &enc->mrk->parms.com;\n \tcom->len = JAS_CAST(uint_fast16_t, strlen(buf));\n \tcom->regid = JPC_COM_LATIN;\n-\tif (!(com->data = JAS_CAST(uchar *, jas_strdup(buf)))) {\n+\tif (!(com->data = JAS_CAST(jas_uchar *, jas_strdup(buf)))) {\n \t\tabort();\n \t}\n \tif (jpc_putms(enc->out, enc->cstate, enc->mrk)) {\ndiff --git a\/src\/libjasper\/jpc\/jpc_mqdec.h b\/src\/libjasper\/jpc\/jpc_mqdec.h\nindex 05bf735..2266769 100644\n--- a\/src\/libjasper\/jpc\/jpc_mqdec.h\n+++ b\/src\/libjasper\/jpc\/jpc_mqdec.h\n@@ -109,7 +109,7 @@ typedef struct {\n \tjas_stream_t *in;\n \n \t\/* The last character read. *\/\n-\tuchar inbuffer;\n+\tjas_uchar inbuffer;\n \n \t\/* The EOF indicator. *\/\n \tint eof;\ndiff --git a\/src\/libjasper\/jpg\/jpg_dec.c b\/src\/libjasper\/jpg\/jpg_dec.c\nindex 858f243..c4b3aa2 100644\n--- a\/src\/libjasper\/jpg\/jpg_dec.c\n+++ b\/src\/libjasper\/jpg\/jpg_dec.c\n@@ -80,6 +80,14 @@\n * Types.\n \\******************************************************************************\/\n \n+typedef struct {\n+\tsize_t max_samples;\n+} jpg_dec_importopts_t;\n+\n+typedef enum {\n+\tOPT_MAXSIZE,\n+} optid_t;\n+\n \/* JPEG decoder data sink type. *\/\n \n typedef struct jpg_dest_s {\n@@ -127,19 +135,11 @@ static int jpg_copystreamtofile(FILE *out, jas_stream_t *in);\n static jas_image_t *jpg_mkimage(j_decompress_ptr cinfo);\n \n \/******************************************************************************\\\n-*\n+* Option parsing.\n \\******************************************************************************\/\n \n-typedef struct {\n-\tsize_t max_size;\n-} jpg_dec_importopts_t;\n-\n-typedef enum {\n-\tOPT_MAXSIZE,\n-} optid_t;\n-\n static jas_taginfo_t decopts[] = {\n-\t{OPT_MAXSIZE, \"max_size\"},\n+\t{OPT_MAXSIZE, \"max_samples\"},\n \t{-1, 0}\n };\n \n@@ -147,7 +147,7 @@ static int jpg_dec_parseopts(char *optstr, jpg_dec_importopts_t *opts)\n {\n \tjas_tvparser_t *tvp;\n \n-\topts->max_size = 0;\n+\topts->max_samples = 64 * JAS_MEBI;\n \n \tif (!(tvp = jas_tvparser_create(optstr ? optstr : \"\"))) {\n \t\treturn -1;\n@@ -157,7 +157,7 @@ static int jpg_dec_parseopts(char *optstr, jpg_dec_importopts_t *opts)\n \t\tswitch (jas_taginfo_nonull(jas_taginfos_lookup(decopts,\n \t\t  jas_tvparser_gettag(tvp)))->id) {\n \t\tcase OPT_MAXSIZE:\n-\t\t\topts->max_size = atoi(jas_tvparser_getval(tvp));\n+\t\t\topts->max_samples = atoi(jas_tvparser_getval(tvp));\n \t\t\tbreak;\n \t\tdefault:\n \t\t\tjas_eprintf(\"warning: ignoring invalid option %s\\n\",\n@@ -188,7 +188,9 @@ jas_image_t *jpg_decode(jas_stream_t *in, char *optstr)\n \tjas_image_t *image;\n \tint ret;\n \tjpg_dec_importopts_t opts;\n-\tsize_t size;\n+\tsize_t num_samples;\n+\n+\tJAS_DBGLOG(100, (\"jpg_decode(%p, \\\"%s\\\")\\n\", in, optstr));\n \n \tif (jpg_dec_parseopts(optstr, &opts)) {\n \t\tgoto error;\n@@ -236,6 +238,18 @@ jas_image_t *jpg_decode(jas_stream_t *in, char *optstr)\n \t  cinfo.image_width, cinfo.image_height, cinfo.num_components)\n \t  );\n \n+\tif (opts.max_samples > 0) {\n+\t\tif (!jas_safe_size_mul3(cinfo.image_width, cinfo.image_height,\n+\t\t  cinfo.num_components, &num_samples)) {\n+\t\t\tgoto error;\n+\t\t}\n+\t\tif (num_samples > opts.max_samples) {\n+\t\t\tjas_eprintf(\"image is too large (%zu > %zu)\\n\", num_samples,\n+\t\t\t  opts.max_samples);\n+\t\t\tgoto error;\n+\t\t}\n+\t}\n+\n \t\/* Start the decompressor. *\/\n \tJAS_DBGLOG(10, (\"jpeg_start_decompress(%p)\\n\", &cinfo));\n \tret = jpeg_start_decompress(&cinfo);\n@@ -245,18 +259,6 @@ jas_image_t *jpg_decode(jas_stream_t *in, char *optstr)\n \t  cinfo.output_width, cinfo.output_height, cinfo.output_components)\n \t  );\n \n-\tif (opts.max_size) {\n-\t\tif (!jas_safe_size_mul(cinfo.output_width, cinfo.output_height,\n-\t\t  &size) ||\n-\t\t  !jas_safe_size_mul(size, cinfo.output_components, &size)) {\n-\t\t\tgoto error;\n-\t\t}\n-\t\tif (size > opts.max_size) {\n-\t\t\tjas_eprintf(\"image is too large\\n\");\n-\t\t\tgoto error;\n-\t\t}\n-\t}\n-\n \t\/* Create an image object to hold the decoded data. *\/\n \tif (!(image = jpg_mkimage(&cinfo))) {\n \t\tjas_eprintf(\"jpg_mkimage failed\\n\");\ndiff --git a\/src\/libjasper\/jpg\/jpg_val.c b\/src\/libjasper\/jpg\/jpg_val.c\nindex 338afaf..6222a69 100644\n--- a\/src\/libjasper\/jpg\/jpg_val.c\n+++ b\/src\/libjasper\/jpg\/jpg_val.c\n@@ -77,7 +77,7 @@\n \n int jpg_validate(jas_stream_t *in)\n {\n-\tuchar buf[JPG_MAGICLEN];\n+\tjas_uchar buf[JPG_MAGICLEN];\n \tint i;\n \tint n;\n \ndiff --git a\/src\/libjasper\/mif\/mif_cod.c b\/src\/libjasper\/mif\/mif_cod.c\nindex bfed68a..3303f59 100644\n--- a\/src\/libjasper\/mif\/mif_cod.c\n+++ b\/src\/libjasper\/mif\/mif_cod.c\n@@ -370,7 +370,7 @@ int mif_encode(jas_image_t *image, jas_stream_t *out, char *optstr)\n \n int mif_validate(jas_stream_t *in)\n {\n-\tuchar buf[MIF_MAGICLEN];\n+\tjas_uchar buf[MIF_MAGICLEN];\n \tuint_fast32_t magic;\n \tint i;\n \tint n;\n@@ -462,7 +462,7 @@ static int mif_hdr_growcmpts(mif_hdr_t *hdr, int maxcmpts)\n \n static mif_hdr_t *mif_hdr_get(jas_stream_t *in)\n {\n-\tuchar magicbuf[MIF_MAGICLEN];\n+\tjas_uchar magicbuf[MIF_MAGICLEN];\n \tchar buf[4096];\n \tmif_hdr_t *hdr;\n \tbool done;\ndiff --git a\/src\/libjasper\/pgx\/pgx_dec.c b\/src\/libjasper\/pgx\/pgx_dec.c\nindex 5a2e631..f6f8563 100644\n--- a\/src\/libjasper\/pgx\/pgx_dec.c\n+++ b\/src\/libjasper\/pgx\/pgx_dec.c\n@@ -151,7 +151,7 @@ jas_image_t *pgx_decode(jas_stream_t *in, char *optstr)\n \n int pgx_validate(jas_stream_t *in)\n {\n-\tuchar buf[PGX_MAGICLEN];\n+\tjas_uchar buf[PGX_MAGICLEN];\n \tuint_fast32_t magic;\n \tint i;\n \tint n;\n@@ -195,7 +195,7 @@ int pgx_validate(jas_stream_t *in)\n static int pgx_gethdr(jas_stream_t *in, pgx_hdr_t *hdr)\n {\n \tint c;\n-\tuchar buf[2];\n+\tjas_uchar buf[2];\n \n \tif ((c = jas_stream_getc(in)) == EOF) {\n \t\tgoto error;\ndiff --git a\/src\/libjasper\/pnm\/pnm_dec.c b\/src\/libjasper\/pnm\/pnm_dec.c\nindex 78e2b3a..526e10d 100644\n--- a\/src\/libjasper\/pnm\/pnm_dec.c\n+++ b\/src\/libjasper\/pnm\/pnm_dec.c\n@@ -180,7 +180,7 @@ jas_image_t *pnm_decode(jas_stream_t *in, char *opts)\n \n int pnm_validate(jas_stream_t *in)\n {\n-\tuchar buf[2];\n+\tjas_uchar buf[2];\n \tint i;\n \tint n;\n \ndiff --git a\/src\/libjasper\/ras\/ras_dec.c b\/src\/libjasper\/ras\/ras_dec.c\nindex 927883f..8200406 100644\n--- a\/src\/libjasper\/ras\/ras_dec.c\n+++ b\/src\/libjasper\/ras\/ras_dec.c\n@@ -185,7 +185,7 @@ jas_image_t *ras_decode(jas_stream_t *in, char *optstr)\n \n int ras_validate(jas_stream_t *in)\n {\n-\tuchar buf[RAS_MAGICLEN];\n+\tjas_uchar buf[RAS_MAGICLEN];\n \tint i;\n \tint n;\n \tuint_fast32_t magic;\ndiff --git a\/test\/bin\/run_test_1 b\/test\/bin\/run_test_1\nindex 7cc1663..6f38e08 100755\n--- a\/test\/bin\/run_test_1\n+++ b\/test\/bin\/run_test_1\n@@ -54,23 +54,29 @@ for in_file in \"${bad_list[@]}\"; do\n \tname=$(basename \"$in_file\")\n \techo \"############################################################\"\n \tcase \"$name\" in\n-\t2_crashes.bmp|jasper-doublefree-mem_close.jpg)\n+\t2_crashes.bmp)\n+\t\t#jasper-doublefree-mem_close.jpg\n \t\t# The file jasper-doublefree-mem_close.jpg must be skipped\n \t\t# since this test could pass or fail depending on the version of\n \t\t# the JPEG library used (and if it passes it will be VERY SLOW).\n+\t\t# Thie file 2_crashes.bmp must be skipped since it will try\n+\t\t# to allocate a huge palette which can cause an ASAN failure.\n \t\techo \"Skipping $in_file\"\n \t\tcontinue\n \t\t;;\n \tesac\n \n \techo \"Input file: $in_file\"\n+\timginfo_opts=()\n+\timginfo_opts+=(--max-samples 100000000)\n \tspecial_asan_options=()\n \tspecial_asan_options+=(exitcode=10)\n \tspecial_asan_options+=(allocator_may_return_null=true)\n \tspecial_asan_options+=(detect_leaks=false)\n \t#special_asan_options+=(soft_rss_limit_mb=1024)\n \texpected_status=1\n-\tASAN_OPTIONS=\"${special_asan_options[*]}\" \"$imginfo\" < \"$in_file\"\n+\tASAN_OPTIONS=\"${special_asan_options[*]}\" \\\n+\t  \"$imginfo\" \"${imginfo_opts[@]}\" < \"$in_file\"\n \tstatus=$?\n \techo \"actual exit status: $status\"\n \techo \"expected exit status: $expected_status\"\n","owner":"mdadams","repo":"jasper","source":"cve"},{"CVE_ID":"CVE-2014-0143","CWE_ID":"190","category":"security","commit_id":"509a41bab5306181044b5fff02eadf96d9c8676a","commit_message":"From 509a41bab5306181044b5fff02eadf96d9c8676a Mon Sep 17 00:00:00 2001\nFrom: Stefan Hajnoczi <stefanha@redhat.com>\nDate: Wed, 26 Mar 2014 13:05:26 +0100\nSubject: [PATCH] block\/cloop: prevent offsets_size integer overflow\n (CVE-2014-0143)\n\nThe following integer overflow in offsets_size can lead to out-of-bounds\nmemory stores when n_blocks has a huge value:\n\n    uint32_t n_blocks, offsets_size;\n    [...]\n    ret = bdrv_pread(bs->file, 128 + 4, &s->n_blocks, 4);\n    [...]\n    s->n_blocks = be32_to_cpu(s->n_blocks);\n\n    \/* read offsets *\/\n    offsets_size = s->n_blocks * sizeof(uint64_t);\n    s->offsets = g_malloc(offsets_size);\n\n    [...]\n\n    for(i=0;i<s->n_blocks;i++) {\n        s->offsets[i] = be64_to_cpu(s->offsets[i]);\n\noffsets_size can be smaller than n_blocks due to integer overflow.\nTherefore s->offsets[] is too small when the for loop byteswaps offsets.\n\nThis patch refuses to open files if offsets_size would overflow.\n\nNote that changing the type of offsets_size is not a fix since 32-bit\nhosts still only have 32-bit size_t.\n\nSigned-off-by: Stefan Hajnoczi <stefanha@redhat.com>\nSigned-off-by: Kevin Wolf <kwolf@redhat.com>\nReviewed-by: Max Reitz <mreitz@redhat.com>\nSigned-off-by: Stefan Hajnoczi <stefanha@redhat.com>\n---\n block\/cloop.c              | 7 +++++++\n tests\/qemu-iotests\/075     | 7 +++++++\n tests\/qemu-iotests\/075.out | 4 ++++\n 3 files changed, 18 insertions(+)\n\n","diff_code":"diff --git a\/block\/cloop.c b\/block\/cloop.c\nindex f021663..563e916 100644\n--- a\/block\/cloop.c\n+++ b\/block\/cloop.c\n@@ -99,6 +99,13 @@ static int cloop_open(BlockDriverState *bs, QDict *options, int flags,\n     s->n_blocks = be32_to_cpu(s->n_blocks);\n \n     \/* read offsets *\/\n+    if (s->n_blocks > UINT32_MAX \/ sizeof(uint64_t)) {\n+        \/* Prevent integer overflow *\/\n+        error_setg(errp, \"n_blocks %u must be %zu or less\",\n+                   s->n_blocks,\n+                   UINT32_MAX \/ sizeof(uint64_t));\n+        return -EINVAL;\n+    }\n     offsets_size = s->n_blocks * sizeof(uint64_t);\n     s->offsets = g_malloc(offsets_size);\n \ndiff --git a\/tests\/qemu-iotests\/075 b\/tests\/qemu-iotests\/075\nindex 8f54a99..9ce6b1f 100755\n--- a\/tests\/qemu-iotests\/075\n+++ b\/tests\/qemu-iotests\/075\n@@ -43,6 +43,7 @@ _supported_proto generic\n _supported_os Linux\n \n block_size_offset=128\n+n_blocks_offset=132\n \n echo\n echo \"== check that the first sector can be read ==\"\n@@ -67,6 +68,12 @@ _use_sample_img simple-pattern.cloop.bz2\n poke_file \"$TEST_IMG\" \"$block_size_offset\" \"\\xff\\xff\\xfe\\x00\"\n $QEMU_IO -c \"read 0 512\" $TEST_IMG 2>&1 | _filter_qemu_io | _filter_testdir\n \n+echo\n+echo \"== offsets_size overflow ===\"\n+_use_sample_img simple-pattern.cloop.bz2\n+poke_file \"$TEST_IMG\" \"$n_blocks_offset\" \"\\xff\\xff\\xff\\xff\"\n+$QEMU_IO -c \"read 0 512\" $TEST_IMG 2>&1 | _filter_qemu_io | _filter_testdir\n+\n # success, all done\n echo \"*** done\"\n rm -f $seq.full\ndiff --git a\/tests\/qemu-iotests\/075.out b\/tests\/qemu-iotests\/075.out\nindex d362c95..a771789 100644\n--- a\/tests\/qemu-iotests\/075.out\n+++ b\/tests\/qemu-iotests\/075.out\n@@ -15,4 +15,8 @@ no file open, try 'help open'\n == huge block_size ===\n qemu-io: can't open device TEST_DIR\/simple-pattern.cloop: block_size 4294966784 must be 64 MB or less\n no file open, try 'help open'\n+\n+== offsets_size overflow ===\n+qemu-io: can't open device TEST_DIR\/simple-pattern.cloop: n_blocks 4294967295 must be 536870911 or less\n+no file open, try 'help open'\n *** done\n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-9581","CWE_ID":"190","category":"security","commit_id":"cadff5fb6e73398de26a92e96d3d7cac893af255","commit_message":"From cadff5fb6e73398de26a92e96d3d7cac893af255 Mon Sep 17 00:00:00 2001\nFrom: szukw000 <szukw000@arcor.de>\nDate: Fri, 9 Dec 2016 08:29:55 +0100\nSubject: [PATCH] These changes repair bugs of #871 and #872\n\n---\n src\/bin\/jp2\/converttif.c | 107 +++++++++++++++++++++++++--------------\n 1 file changed, 70 insertions(+), 37 deletions(-)\n\n","diff_code":"diff --git a\/src\/bin\/jp2\/converttif.c b\/src\/bin\/jp2\/converttif.c\nindex 143d3be6f..c690f8bfd 100644\n--- a\/src\/bin\/jp2\/converttif.c\n+++ b\/src\/bin\/jp2\/converttif.c\n@@ -553,20 +553,18 @@ static void tif_32sto16u(const OPJ_INT32* pSrc, OPJ_UINT16* pDst, OPJ_SIZE_T len\n \n int imagetotif(opj_image_t * image, const char *outfile)\n {\n-\tint width, height;\n-\tint bps,adjust, sgnd;\n-\tint tiPhoto;\n+\tuint32 width, height, bps, tiPhoto;\n+\tint adjust, sgnd;\n \tTIFF *tif;\n \ttdata_t buf;\n-\ttsize_t strip_size;\n+\ttmsize_t strip_size, rowStride;\n \tOPJ_UINT32 i, numcomps;\n-\tOPJ_SIZE_T rowStride;\n \tOPJ_INT32* buffer32s = NULL;\n \tOPJ_INT32 const* planes[4];\n \tconvert_32s_PXCX cvtPxToCx = NULL;\n \tconvert_32sXXx_C1R cvt32sToTif = NULL;\n \n-\tbps = (int)image->comps[0].prec;\n+\tbps = (uint32)image->comps[0].prec;\n \tplanes[0] = image->comps[0].data;\n \t\n \tnumcomps = image->numcomps;\n@@ -674,13 +672,13 @@ int imagetotif(opj_image_t * image, const char *outfile)\n \t\t\tbreak;\n \t}\n \tsgnd = (int)image->comps[0].sgnd;\n-\tadjust = sgnd ? 1 << (image->comps[0].prec - 1) : 0;\n-\twidth   = (int)image->comps[0].w;\n-\theight  = (int)image->comps[0].h;\n+\tadjust = sgnd ? (int)(1 << (image->comps[0].prec - 1)) : 0;\n+\twidth   = (uint32)image->comps[0].w;\n+\theight  = (uint32)image->comps[0].h;\n \t\n \tTIFFSetField(tif, TIFFTAG_IMAGEWIDTH, width);\n \tTIFFSetField(tif, TIFFTAG_IMAGELENGTH, height);\n-\tTIFFSetField(tif, TIFFTAG_SAMPLESPERPIXEL, numcomps);\n+\tTIFFSetField(tif, TIFFTAG_SAMPLESPERPIXEL, (uint32)numcomps);\n \tTIFFSetField(tif, TIFFTAG_BITSPERSAMPLE, bps);\n \tTIFFSetField(tif, TIFFTAG_ORIENTATION, ORIENTATION_TOPLEFT);\n \tTIFFSetField(tif, TIFFTAG_PLANARCONFIG, PLANARCONFIG_CONTIG);\n@@ -688,8 +686,8 @@ int imagetotif(opj_image_t * image, const char *outfile)\n \tTIFFSetField(tif, TIFFTAG_ROWSPERSTRIP, 1);\n \t\n \tstrip_size = TIFFStripSize(tif);\n-\trowStride = ((OPJ_SIZE_T)width * numcomps * (OPJ_SIZE_T)bps + 7U) \/ 8U;\n-\tif (rowStride != (OPJ_SIZE_T)strip_size) {\n+\trowStride = (width * numcomps * bps + 7U) \/ 8U;\n+\tif (rowStride != strip_size) {\n \t\tfprintf(stderr, \"Invalid TIFF strip size\\n\");\n \t\tTIFFClose(tif);\n \t\treturn 1;\n@@ -699,7 +697,7 @@ int imagetotif(opj_image_t * image, const char *outfile)\n \t\tTIFFClose(tif);\n \t\treturn 1;\n \t}\n-\tbuffer32s = (OPJ_INT32 *)malloc((OPJ_SIZE_T)width * numcomps * sizeof(OPJ_INT32));\n+\tbuffer32s = (OPJ_INT32 *)malloc((OPJ_SIZE_T)(width * numcomps * sizeof(OPJ_INT32)));\n \tif (buffer32s == NULL) {\n \t\t_TIFFfree(buf);\n \t\tTIFFClose(tif);\n@@ -1211,20 +1209,19 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \tTIFF *tif;\n \ttdata_t buf;\n \ttstrip_t strip;\n-\ttsize_t strip_size;\n+\ttmsize_t strip_size;\n \tint j, currentPlane, numcomps = 0, w, h;\n \tOPJ_COLOR_SPACE color_space = OPJ_CLRSPC_UNKNOWN;\n \topj_image_cmptparm_t cmptparm[4]; \/* RGBA *\/\n \topj_image_t *image = NULL;\n \tint has_alpha = 0;\n-\tunsigned short tiBps, tiPhoto, tiSf, tiSpp, tiPC;\n-\tunsigned int tiWidth, tiHeight;\n+\tuint32 tiBps, tiPhoto, tiSf, tiSpp, tiPC, tiWidth, tiHeight;\n \tOPJ_BOOL is_cinema = OPJ_IS_CINEMA(parameters->rsiz);\n \tconvert_XXx32s_C1R cvtTifTo32s = NULL;\n \tconvert_32s_CXPX cvtCxToPx = NULL;\n \tOPJ_INT32* buffer32s = NULL;\n \tOPJ_INT32* planes[4];\n-\tOPJ_SIZE_T rowStride;\n+\ttmsize_t rowStride;\n \t\n \ttif = TIFFOpen(filename, \"r\");\n \t\n@@ -1243,22 +1240,35 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \tTIFFGetField(tif, TIFFTAG_SAMPLESPERPIXEL, &tiSpp);\n \tTIFFGetField(tif, TIFFTAG_PHOTOMETRIC, &tiPhoto);\n \tTIFFGetField(tif, TIFFTAG_PLANARCONFIG, &tiPC);\n-\tw= (int)tiWidth;\n-\th= (int)tiHeight;\n-\t\n-\tif(tiBps > 16U) {\n-\t\tfprintf(stderr,\"tiftoimage: Bits=%d, Only 1 to 16 bits implemented\\n\",tiBps);\n-\t\tfprintf(stderr,\"\\tAborting\\n\");\n+\n+\tif(tiSpp == 0 || tiSpp > 4) { \/* should be 1 ... 4 *\/\n+\t\tfprintf(stderr,\"tiftoimage: Bad value for samples per pixel == %hu.\\n\"\n+\t\t \"\\tAborting.\\n\", tiSpp);\n+\t\tTIFFClose(tif);\n+\t\treturn NULL;\n+\t}\n+\tif(tiBps > 16U || tiBps == 0) {\n+\t\tfprintf(stderr,\"tiftoimage: Bad values for Bits == %d.\\n\"\n+\t\t \"\\tMax. 16 Bits are allowed here.\\n\\tAborting.\\n\",tiBps);\n \t\tTIFFClose(tif);\n \t\treturn NULL;\n \t}\n \tif(tiPhoto != PHOTOMETRIC_MINISBLACK && tiPhoto != PHOTOMETRIC_RGB) {\n-\t\tfprintf(stderr,\"tiftoimage: Bad color format %d.\\n\\tOnly RGB(A) and GRAY(A) has been implemented\\n\",(int) tiPhoto);\n+\t\tfprintf(stderr,\"tiftoimage: Bad color format %d.\\n\"\n+\t\t \"\\tOnly RGB(A) and GRAY(A) has been implemented\\n\",(int) tiPhoto);\n \t\tfprintf(stderr,\"\\tAborting\\n\");\n \t\tTIFFClose(tif);\n \t\treturn NULL;\n \t}\n-\t\n+\tif(tiWidth == 0 || tiHeight == 0) {\n+\t\tfprintf(stderr,\"tiftoimage: Bad values for width(%u) \"\n+\t\t \"and\/or height(%u)\\n\\tAborting.\\n\",tiWidth,tiHeight);\n+\t\tTIFFClose(tif);\n+\t\treturn NULL;\n+\t}\n+\tw= (int)tiWidth;\n+\th= (int)tiHeight;\n+\n \tswitch (tiBps) {\n \t\tcase 1:\n \t\tcase 2:\n@@ -1312,7 +1322,7 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \t\t\n \t\tTIFFGetFieldDefaulted(tif, TIFFTAG_EXTRASAMPLES,\n \t\t\t\t\t\t\t\t\t\t\t\t\t&extrasamples, &sampleinfo);\n-\t\t\n+\n \t\tif(extrasamples >= 1)\n \t\t{\n \t\t\tswitch(sampleinfo[0])\n@@ -1333,7 +1343,7 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \t\telse \/* extrasamples == 0 *\/\n \t\t\tif(tiSpp == 4 || tiSpp == 2) has_alpha = 1;\n \t}\n-\t\n+\n \t\/* initialize image components *\/\n \tmemset(&cmptparm[0], 0, 4 * sizeof(opj_image_cmptparm_t));\n \t\n@@ -1346,7 +1356,7 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \t} else {\n \t\tis_cinema = 0U;\n \t}\n-\t\n+\n \tif(tiPhoto == PHOTOMETRIC_RGB) \/* RGB(A) *\/\n \t{\n \t\tnumcomps = 3 + has_alpha;\n@@ -1384,10 +1394,24 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \timage->x0 = (OPJ_UINT32)parameters->image_offset_x0;\n \timage->y0 = (OPJ_UINT32)parameters->image_offset_y0;\n \timage->x1 =\t!image->x0 ? (OPJ_UINT32)(w - 1) * (OPJ_UINT32)subsampling_dx + 1 :\n-\timage->x0 + (OPJ_UINT32)(w - 1) * (OPJ_UINT32)subsampling_dx + 1;\n+\t image->x0 + (OPJ_UINT32)(w - 1) * (OPJ_UINT32)subsampling_dx + 1;\n+\tif(image->x1 <= image->x0) {\n+\t\tfprintf(stderr,\"tiftoimage: Bad value for image->x1(%d) vs. \"\n+\t\t \"image->x0(%d)\\n\\tAborting.\\n\",image->x1,image->x0);\n+\t\tTIFFClose(tif);\n+\t\topj_image_destroy(image);\n+\t\treturn NULL;\n+\t}\n \timage->y1 =\t!image->y0 ? (OPJ_UINT32)(h - 1) * (OPJ_UINT32)subsampling_dy + 1 :\n-\timage->y0 + (OPJ_UINT32)(h - 1) * (OPJ_UINT32)subsampling_dy + 1;\n-\n+\t image->y0 + (OPJ_UINT32)(h - 1) * (OPJ_UINT32)subsampling_dy + 1;\n+\tif(image->y1 <= image->y0) {\n+\t\tfprintf(stderr,\"tiftoimage: Bad value for image->y1(%d) vs. \"\n+\t\t \"image->y0(%d)\\n\\tAborting.\\n\",image->y1,image->y0);\n+\t\tTIFFClose(tif);\n+\t\topj_image_destroy(image);\n+\t\treturn NULL;\n+\t}\n+\t\n \tfor(j = 0; j < numcomps; j++)\n \t{\n \t\tplanes[j] = image->comps[j].data;\n@@ -1395,15 +1419,15 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \timage->comps[numcomps - 1].alpha = (OPJ_UINT16)(1 - (numcomps & 1));\n \t\t\n \tstrip_size = TIFFStripSize(tif);\n-\t\n+\n \tbuf = _TIFFmalloc(strip_size);\n \tif (buf == NULL) {\n \t\tTIFFClose(tif);\n \t\topj_image_destroy(image);\n \t\treturn NULL;\n \t}\n-\trowStride = ((OPJ_SIZE_T)w * tiSpp * tiBps + 7U) \/ 8U;\n-\tbuffer32s = (OPJ_INT32 *)malloc((OPJ_SIZE_T)w * tiSpp * sizeof(OPJ_INT32));\n+\trowStride = (w * tiSpp * tiBps + 7U) \/ 8U;\n+\tbuffer32s = (OPJ_INT32 *)malloc((OPJ_SIZE_T)(w * tiSpp * sizeof(OPJ_INT32)));\n \tif (buffer32s == NULL) {\n \t\t_TIFFfree(buf);\n \t\tTIFFClose(tif);\n@@ -1421,11 +1445,20 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \t\tfor(; (h > 0) && (strip < TIFFNumberOfStrips(tif)); strip++)\n \t\t{\n \t\t\t\tconst OPJ_UINT8 *dat8;\n-\t\t\t\tOPJ_SIZE_T ssize;\n+\t\t\t\ttmsize_t ssize;\n \t\t\t\t\n-\t\t\t\tssize = (OPJ_SIZE_T)TIFFReadEncodedStrip(tif, strip, buf, strip_size);\n+\t\t\t\tssize = TIFFReadEncodedStrip(tif, strip, buf, strip_size);\n+\t\t\t\tif(ssize < 1 || ssize > strip_size) {\n+\t\t\t\t\tfprintf(stderr,\"tiftoimage: Bad value for ssize(%ld) \"\n+                     \"vs. strip_size(%ld).\\n\\tAborting.\\n\",ssize,strip_size);\n+\t\t\t\t\t_TIFFfree(buf);\n+\t\t\t\t\t_TIFFfree(buffer32s);\n+\t\t\t\t\tTIFFClose(tif);\n+\t\t\t\t\topj_image_destroy(image);\n+\t\t\t\t\treturn NULL;\n+\t\t\t\t}\n \t\t\t\tdat8 = (const OPJ_UINT8*)buf;\n-\t\t\t\t\n+\n \t\t\t\twhile (ssize >= rowStride) {\n \t\t\t\t\tcvtTifTo32s(dat8, buffer32s, (OPJ_SIZE_T)w * tiSpp);\n \t\t\t\t\tcvtCxToPx(buffer32s, planes, (OPJ_SIZE_T)w);\n","owner":"szukw000","repo":"openjpeg","source":"cve"},{"CVE_ID":"CVE-2018-8799","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2017-6889","CWE_ID":"190","category":"security","commit_id":"194f592e205990ea8fce72b6c571c14350aca716","commit_message":"From 194f592e205990ea8fce72b6c571c14350aca716 Mon Sep 17 00:00:00 2001\nFrom: Alex Tutubalin <lexa@lexa.ru>\nDate: Sat, 4 Mar 2017 19:55:24 +0300\nSubject: [PATCH] Fixed possible foveon buffer overrun (Secunia SA750000)\n\n---\n dcraw_foveon.c | 8 ++++++--\n 1 file changed, 6 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/dcraw_foveon.c b\/dcraw_foveon.c\nindex d8b7005..bdde89d 100644\n--- a\/dcraw_foveon.c\n+++ b\/dcraw_foveon.c\n@@ -319,7 +319,7 @@ void CLASS foveon_huff (ushort *huff)\n void CLASS foveon_dp_load_raw()\n {\n   unsigned c, roff[4], row, col, diff;\n-  ushort huff[512], vpred[2][2], hpred[2];\n+  ushort huff[1024], vpred[2][2], hpred[2];\n \n   fseek (ifp, 8, SEEK_CUR);\n   foveon_huff (huff);\n@@ -346,12 +346,16 @@ void CLASS foveon_dp_load_raw()\n void CLASS foveon_load_camf()\n {\n   unsigned type, wide, high, i, j, row, col, diff;\n-  ushort huff[258], vpred[2][2] = {{512,512},{512,512}}, hpred[2];\n+  ushort huff[1024], vpred[2][2] = {{512,512},{512,512}}, hpred[2];\n \n   fseek (ifp, meta_offset, SEEK_SET);\n   type = get4();  get4();  get4();\n   wide = get4();\n   high = get4();\n+#ifdef LIBRAW_LIBRARY_BUILD\n+  if(wide>32767 || high > 32767 || wide*high > 20000000)\n+     throw LIBRAW_EXCEPTION_IO_CORRUPT;\n+#endif\n   if (type == 2) {\n     fread (meta_data, 1, meta_length, ifp);\n     for (i=0; i < meta_length; i++) {\n","owner":"LibRaw","repo":"LibRaw-demosaic-pack-GPL2","source":"cve"},{"CVE_ID":"CVE-2018-13406","CWE_ID":"190","category":"security","commit_id":"9f645bcc566a1e9f921bdae7528a01ced5bc3713","commit_message":"From 9f645bcc566a1e9f921bdae7528a01ced5bc3713 Mon Sep 17 00:00:00 2001\nFrom: Kees Cook <keescook@chromium.org>\nDate: Fri, 11 May 2018 18:24:12 +1000\nSubject: video: uvesafb: Fix integer overflow in allocation\n\ncmap->len can get close to INT_MAX\/2, allowing for an integer overflow in\nallocation. This uses kmalloc_array() instead to catch the condition.\n\nReported-by: Dr Silvio Cesare of InfoSect <silvio.cesare@gmail.com>\nFixes: 8bdb3a2d7df48 (\"uvesafb: the driver core\")\nCc: stable@vger.kernel.org\nSigned-off-by: Kees Cook <keescook@chromium.org>\n---\n drivers\/video\/fbdev\/uvesafb.c | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/drivers\/video\/fbdev\/uvesafb.c b\/drivers\/video\/fbdev\/uvesafb.c\nindex 73676eb0244a..c592ca513115 100644\n--- a\/drivers\/video\/fbdev\/uvesafb.c\n+++ b\/drivers\/video\/fbdev\/uvesafb.c\n@@ -1044,7 +1044,8 @@ static int uvesafb_setcmap(struct fb_cmap *cmap, struct fb_info *info)\n \t\t    info->cmap.len || cmap->start < info->cmap.start)\n \t\t\treturn -EINVAL;\n \n-\t\tentries = kmalloc(sizeof(*entries) * cmap->len, GFP_KERNEL);\n+\t\tentries = kmalloc_array(cmap->len, sizeof(*entries),\n+\t\t\t\t\tGFP_KERNEL);\n \t\tif (!entries)\n \t\t\treturn -ENOMEM;\n \n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-9395","CWE_ID":"190","category":"security","commit_id":"d42b2388f7f8e0332c846675133acea151fc557a","commit_message":"From d42b2388f7f8e0332c846675133acea151fc557a Mon Sep 17 00:00:00 2001\nFrom: Michael Adams <mdadams@ece.uvic.ca>\nDate: Fri, 11 Nov 2016 16:27:34 -0800\nSubject: [PATCH] The generation of the configuration file jas_config.h has\n been completely reworked in order to avoid pollution of the global namespace.\n\nSome problematic types like uchar, ulong, and friends have been replaced\nwith names with a jas_ prefix.\n\nAn option max_samples has been added to the BMP and JPEG decoders to\nrestrict the maximum size of image that they can decode.  This change\nwas made as a (possibly temporary) fix to address security concerns.\nA max_samples command-line option has also been added to imginfo.\n\nWhether an image component (for jas_image_t) is stored in memory or on\ndisk is now based on the component size (rather than the image size).\n\nSome debug log message were added.\n\nSome new integer overflow checks were added.\n\nSome new safe integer add\/multiply functions were added.\n\nMore pre-C99 cruft was removed.  JasPer has numerous \"hacks\" to\nhandle pre-C99 compilers.  JasPer now assumes C99 support.  So, this\npre-C99 cruft is unnecessary and can be removed.\n\nThe regression jasper-doublefree-mem_close.jpg has been re-enabled.\nTheoretically, it should work more predictably now.\n---\n .gitignore                                   |   5 +-\n configure.ac                                 | 114 ++++++++++++-------\n src\/appl\/imginfo.c                           |  23 +++-\n src\/libjasper\/base\/jas_debug.c               |   2 +-\n src\/libjasper\/base\/jas_icc.c                 |  30 ++---\n src\/libjasper\/base\/jas_iccdata.c             |   4 +-\n src\/libjasper\/base\/jas_image.c               |  60 +++++++---\n src\/libjasper\/base\/jas_seq.c                 | 102 ++++++++++-------\n src\/libjasper\/base\/jas_stream.c              |  11 +-\n src\/libjasper\/base\/jas_tmr.c                 |   7 +-\n src\/libjasper\/bmp\/bmp_dec.c                  |  82 ++++++++++---\n src\/libjasper\/include\/jasper\/jas_cm.h        |   2 +\n src\/libjasper\/include\/jasper\/jas_config.h.in |  27 +++++\n src\/libjasper\/include\/jasper\/jas_config2.h   |  13 ---\n src\/libjasper\/include\/jasper\/jas_debug.h     |   4 +-\n src\/libjasper\/include\/jasper\/jas_fix.h       |   4 +-\n src\/libjasper\/include\/jasper\/jas_getopt.h    |   1 +\n src\/libjasper\/include\/jasper\/jas_icc.h       |  12 +-\n src\/libjasper\/include\/jasper\/jas_image.h     |   4 +-\n src\/libjasper\/include\/jasper\/jas_init.h      |   1 +\n src\/libjasper\/include\/jasper\/jas_malloc.h    |   1 +\n src\/libjasper\/include\/jasper\/jas_math.h      |  70 ++++++++++++\n src\/libjasper\/include\/jasper\/jas_seq.h       |  33 +++---\n src\/libjasper\/include\/jasper\/jas_stream.h    |  17 +--\n src\/libjasper\/include\/jasper\/jas_string.h    |   2 +\n src\/libjasper\/include\/jasper\/jas_tmr.h       |  10 +-\n src\/libjasper\/include\/jasper\/jas_tvp.h       |   1 +\n src\/libjasper\/include\/jasper\/jas_types.h     |  38 +++----\n src\/libjasper\/include\/jasper\/jas_version.h   |   1 +\n src\/libjasper\/include\/jasper\/jasper.h        |   2 +\n src\/libjasper\/jp2\/jp2_dec.c                  |  15 +--\n src\/libjasper\/jpc\/jpc_cs.c                   |   6 +-\n src\/libjasper\/jpc\/jpc_cs.h                   |   6 +-\n src\/libjasper\/jpc\/jpc_dec.c                  |   2 +-\n src\/libjasper\/jpc\/jpc_dec.h                  |   2 +-\n src\/libjasper\/jpc\/jpc_enc.c                  |   2 +-\n src\/libjasper\/jpc\/jpc_mqdec.h                |   2 +-\n src\/libjasper\/jpg\/jpg_dec.c                  |  52 +++++----\n src\/libjasper\/jpg\/jpg_val.c                  |   2 +-\n src\/libjasper\/mif\/mif_cod.c                  |   4 +-\n src\/libjasper\/pgx\/pgx_dec.c                  |   4 +-\n src\/libjasper\/pnm\/pnm_dec.c                  |   2 +-\n src\/libjasper\/ras\/ras_dec.c                  |   2 +-\n test\/bin\/run_test_1                          |  10 +-\n 44 files changed, 524 insertions(+), 270 deletions(-)\n create mode 100644 src\/libjasper\/include\/jasper\/jas_config.h.in\n\n","diff_code":"diff --git a\/.gitignore b\/.gitignore\nindex 9ef3d79..6fd9859 100644\n--- a\/.gitignore\n+++ b\/.gitignore\n@@ -40,6 +40,7 @@ Makefile.in\n \n # .\/src\/libjasper\/include\/jasper directory\n \/src\/libjasper\/include\/jasper\/jas_config.h\n-\/src\/libjasper\/include\/jasper\/jas_config.h.in\n-\/src\/libjasper\/include\/jasper\/jas_config.h.in~\n+\/src\/libjasper\/include\/jasper\/jas_pconf.h\n+\/src\/libjasper\/include\/jasper\/jas_pconf.h.in\n+\/src\/libjasper\/include\/jasper\/jas_pconf.h.in~\n \/src\/libjasper\/include\/jasper\/stamp-h1\ndiff --git a\/configure.ac b\/configure.ac\nindex c83181c..a218b3c 100644\n--- a\/configure.ac\n+++ b\/configure.ac\n@@ -132,16 +132,6 @@ AH_TOP([\n \/* If configure is being used, this symbol will be defined automatically\n   at this point in the configuration header file. *\/\n \n-#if defined(__GNUC__) && !defined(__clang__)\n-#define JAS_ATTRIBUTE_DISABLE_USAN \\\n-  __attribute__((no_sanitize_undefined))\n-#elif defined(__clang__)\n-#define JAS_ATTRIBUTE_DISABLE_USAN \\\n-  __attribute__((no_sanitize(\"undefined\")))\n-#else\n-#define JAS_ATTRIBUTE_DISABLE_USAN\n-#endif\n-\n \/* The preprocessor symbol JAS_WIN_MSVC_BUILD should not be defined\n   unless the JasPer software is being built under Microsoft Windows\n   using Microsoft Visual C. *\/\n@@ -153,7 +143,7 @@ AH_TOP([\n AH_BOTTOM([\n #else\n \/* A configure-based build is not being used. *\/\n-#include <jasper\/jas_config2.h>\n+#include <jasper\/jas_pconf2.h>\n #endif\n \n #endif\n@@ -312,31 +302,82 @@ AC_CHECK_LIB(m, main)\n # Check for header files.\n ############################################################\n \n-AC_HEADER_STDC\n-AC_CHECK_HEADERS(fcntl.h limits.h unistd.h stdint.h stdbool.h io.h windows.h sys\/types.h sys\/time.h stdlib.h stddef.h)\n+dnl AC_HEADER_STDC\n+AC_CHECK_HEADERS(fcntl.h io.h unistd.h windows.h sys\/time.h sys\/types.h)\n+\n+# Surely, there must be a better way to do this, but\n+# let's just get something working for now.\n+\n+if test $ac_cv_header_fcntl_h = yes; then\n+\tAC_SUBST([JAS_HAVE_FCNTL_H], [\"#define JAS_HAVE_FCNTL_H 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_FCNTL_H], [\"#undef JAS_HAVE_FCNTL_H\"])\n+fi\n+\n+if test $ac_cv_header_io_h = yes; then\n+\tAC_SUBST([JAS_HAVE_IO_H], [\"#define JAS_HAVE_IO_H 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_IO_H], [\"#undef JAS_HAVE_IO_H\"])\n+fi\n+\n+if test $ac_cv_header_unistd_h = yes; then\n+\tAC_SUBST([JAS_HAVE_UNISTD_H], [\"#define JAS_HAVE_UNISTD_H 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_UNISTD_H], [\"#undef JAS_HAVE_UNISTD_H\"])\n+fi\n+\n+if test $ac_cv_header_windows_h = yes; then\n+\tAC_SUBST([JAS_HAVE_WINDOWS_H], [\"#define JAS_HAVE_WINDOWS_H 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_WINDOWS_H], [\"#undef JAS_HAVE_WINDOWS_H\"])\n+fi\n+\n+if test $ac_cv_header_sys_time_h = yes; then\n+\tAC_SUBST([JAS_HAVE_SYS_TIME_H], [\"#define JAS_HAVE_SYS_TIME_H 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_SYS_TIME_H], [\"#undef JAS_HAVE_SYS_TIME_H\"])\n+fi\n+\n+if test $ac_cv_header_sys_types_h = yes; then\n+\tAC_SUBST([JAS_HAVE_SYS_TYPES_H], [\"#define JAS_HAVE_SYS_TYPES_H 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_SYS_TYPES_H], [\"#undef JAS_HAVE_SYS_TYPES_H\"])\n+fi\n \n ############################################################\n # Check for typedefs, structures, and compiler characteristics.\n ############################################################\n \n-AC_C_CONST\n-AC_C_INLINE\n-AC_TYPE_SIZE_T\n-AC_CHECK_TYPE(uchar, unsigned char)\n-AC_CHECK_TYPE(ushort, unsigned short)\n-AC_CHECK_TYPE(uint, unsigned int)\n-AC_CHECK_TYPE(ulong, unsigned long)\n-AC_CHECK_TYPE(longlong, long long)\n-AC_CHECK_TYPE(ulonglong, unsigned long long)\n-AC_CHECK_TYPE(ssize_t, int)\n+dnl AC_C_CONST\n+dnl AC_C_INLINE\n+dnl AC_TYPE_SIZE_T\n+dnl AC_CHECK_TYPE(uchar, unsigned char)\n+dnl AC_CHECK_TYPE(ushort, unsigned short)\n+dnl AC_CHECK_TYPE(uint, unsigned int)\n+dnl AC_CHECK_TYPE(ulong, unsigned long)\n+dnl AC_CHECK_TYPE(longlong, long long)\n+dnl AC_CHECK_TYPE(ulonglong, unsigned long long)\n+dnl AC_CHECK_TYPE(ssize_t, int)\n AC_CHECK_FUNCS(gettimeofday)\n AC_CHECK_FUNCS(getrusage)\n \n+if test $ac_cv_func_gettimeofday = yes; then\n+\tAC_SUBST([JAS_HAVE_GETTIMEOFDAY], [\"#define JAS_HAVE_GETTIMEOFDAY 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_GETTIMEOFDAY], [\"#undef JAS_HAVE_GETTIMEOFDAY\"])\n+fi\n+\n+if test $ac_cv_func_getrusage = yes; then\n+\tAC_SUBST([JAS_HAVE_GETRUSAGE], [\"#define JAS_HAVE_GETRUSAGE 1\"])\n+else\n+\tAC_SUBST([JAS_HAVE_GETRUSAGE], [\"#undef JAS_HAVE_GETRUSAGE\"])\n+fi\n+\n ############################################################\n # Checks for library functions.\n ############################################################\n \n-AC_FUNC_VPRINTF\n+dnl AC_FUNC_VPRINTF\n \n ############################################################\n # Enable memory limit feature.\n@@ -432,26 +473,9 @@ esac\n ], [debug=no])\n \n ############################################################\n-# Extra stuff for research purposes.\n+# Extra stuff\n ############################################################\n \n-AC_ARG_ENABLE(special0,\n-[  --enable-special0    enable something],\n-[\n-case \"${enableval}\" in\n-yes)\n-\tif test \"$GCC\" = yes; then\n-\t\tCFLAGS=\"-g -O0\"\n-\tfi\n-\t;;\n-no)\n-\t;;\n-*)\n-\tAC_MSG_ERROR(bad value ${enableval} for --enable-special0)\n-\t;;\n-esac\n-], [])\n-\n if test -n \"$EXTRA_CFLAGS\"; then\n \tCFLAGS=\"$CFLAGS $EXTRA_CFLAGS\"\n fi\n@@ -460,13 +484,17 @@ fi\n # Generate the configuration header file.\n ############################################################\n \n-AC_CONFIG_HEADERS([src\/libjasper\/include\/jasper\/jas_config.h])\n+# The private header file generated by AC_CONFIG_HEADERS is not\n+# currently used.  This just causes less verbose command lines\n+# when make is run.\n+AC_CONFIG_HEADERS([src\/libjasper\/include\/jasper\/jas_pconf.h])\n \n ############################################################\n # Generate the makefiles.\n ############################################################\n \n AC_CONFIG_FILES([\n+src\/libjasper\/include\/jasper\/jas_config.h\n Makefile\n src\/Makefile\n src\/appl\/Makefile\ndiff --git a\/src\/appl\/imginfo.c b\/src\/appl\/imginfo.c\nindex 0560bea..160054c 100644\n--- a\/src\/appl\/imginfo.c\n+++ b\/src\/appl\/imginfo.c\n@@ -88,6 +88,7 @@ typedef enum {\n \tOPT_VERBOSE,\n \tOPT_INFILE,\n \tOPT_DEBUG,\n+\tOPT_MAXSAMPLES,\n \tOPT_MAXMEM\n } optid_t;\n \n@@ -108,6 +109,7 @@ static jas_opt_t opts[] = {\n \t{OPT_VERBOSE, \"verbose\", 0},\n \t{OPT_INFILE, \"f\", JAS_OPT_HASARG},\n \t{OPT_DEBUG, \"debug-level\", JAS_OPT_HASARG},\n+\t{OPT_MAXSAMPLES, \"max-samples\", JAS_OPT_HASARG},\n #if defined(JAS_DEFAULT_MAX_MEM_USAGE)\n \t{OPT_MAXMEM, \"memory-limit\", JAS_OPT_HASARG},\n #endif\n@@ -135,6 +137,8 @@ int main(int argc, char **argv)\n \tchar *fmtname;\n \tint debug;\n \tsize_t max_mem;\n+\tsize_t max_samples;\n+\tchar optstr[32];\n \n \tif (jas_init()) {\n \t\tabort();\n@@ -142,6 +146,7 @@ int main(int argc, char **argv)\n \n \tcmdname = argv[0];\n \n+\tmax_samples = 64 * JAS_MEBI;\n \tinfile = 0;\n \tverbose = 0;\n \tdebug = 0;\n@@ -165,6 +170,9 @@ int main(int argc, char **argv)\n \t\tcase OPT_INFILE:\n \t\t\tinfile = jas_optarg;\n \t\t\tbreak;\n+\t\tcase OPT_MAXSAMPLES:\n+\t\t\tmax_samples = strtoull(jas_optarg, 0, 10);\n+\t\t\tbreak;\n \t\tcase OPT_MAXMEM:\n \t\t\tmax_mem = strtoull(jas_optarg, 0, 10);\n \t\t\tbreak;\n@@ -199,8 +207,10 @@ int main(int argc, char **argv)\n \t\tfprintf(stderr, \"unknown image format\\n\");\n \t}\n \n+\tsnprintf(optstr, sizeof(optstr), \"max_samples=%-zu\", max_samples);\n+\n \t\/* Decode the image. *\/\n-\tif (!(image = jas_image_decode(instream, fmtid, 0))) {\n+\tif (!(image = jas_image_decode(instream, fmtid, optstr))) {\n \t\tjas_stream_close(instream);\n \t\tfprintf(stderr, \"cannot load image\\n\");\n \t\treturn EXIT_FAILURE;\n@@ -209,6 +219,11 @@ int main(int argc, char **argv)\n \t\/* Close the image file. *\/\n \tjas_stream_close(instream);\n \n+\tif (!(fmtname = jas_image_fmttostr(fmtid))) {\n+\t\tjas_eprintf(\"format name lookup failed\\n\");\n+\t\treturn EXIT_FAILURE;\n+\t}\n+\n \tif (!(numcmpts = jas_image_numcmpts(image))) {\n \t\tfprintf(stderr, \"warning: image has no components\\n\");\n \t}\n@@ -221,10 +236,8 @@ int main(int argc, char **argv)\n \t\theight = 0;\n \t\tdepth = 0;\n \t}\n-\tif (!(fmtname = jas_image_fmttostr(fmtid))) {\n-\t\tabort();\n-\t}\n-\tprintf(\"%s %d %d %d %d %ld\\n\", fmtname, numcmpts, width, height, depth, (long) jas_image_rawsize(image));\n+\tprintf(\"%s %d %d %d %d %ld\\n\", fmtname, numcmpts, width, height, depth,\n+\t  JAS_CAST(long, jas_image_rawsize(image)));\n \n \tjas_image_destroy(image);\n \tjas_image_clearfmts();\ndiff --git a\/src\/libjasper\/base\/jas_debug.c b\/src\/libjasper\/base\/jas_debug.c\nindex 42a7480..c79992e 100644\n--- a\/src\/libjasper\/base\/jas_debug.c\n+++ b\/src\/libjasper\/base\/jas_debug.c\n@@ -122,7 +122,7 @@ int jas_memdump(FILE *out, void *data, size_t len)\n {\n \tsize_t i;\n \tsize_t j;\n-\tuchar *dp;\n+\tjas_uchar *dp;\n \tdp = data;\n \tfor (i = 0; i < len; i += 16) {\n \t\tfprintf(out, \"%04zx:\", i);\ndiff --git a\/src\/libjasper\/base\/jas_icc.c b\/src\/libjasper\/base\/jas_icc.c\nindex c9ca43c..09c6ae2 100644\n--- a\/src\/libjasper\/base\/jas_icc.c\n+++ b\/src\/libjasper\/base\/jas_icc.c\n@@ -82,14 +82,14 @@\n \n static jas_iccattrval_t *jas_iccattrval_create0(void);\n \n-static int jas_iccgetuint(jas_stream_t *in, int n, ulonglong *val);\n+static int jas_iccgetuint(jas_stream_t *in, int n, jas_ulonglong *val);\n static int jas_iccgetuint8(jas_stream_t *in, jas_iccuint8_t *val);\n static int jas_iccgetuint16(jas_stream_t *in, jas_iccuint16_t *val);\n static int jas_iccgetsint32(jas_stream_t *in, jas_iccsint32_t *val);\n static int jas_iccgetuint32(jas_stream_t *in, jas_iccuint32_t *val);\n static int jas_iccgetuint64(jas_stream_t *in, jas_iccuint64_t *val);\n-static int jas_iccputuint(jas_stream_t *out, int n, ulonglong val);\n-static int jas_iccputsint(jas_stream_t *out, int n, longlong val);\n+static int jas_iccputuint(jas_stream_t *out, int n, jas_ulonglong val);\n+static int jas_iccputsint(jas_stream_t *out, int n, jas_longlong val);\n static jas_iccprof_t *jas_iccprof_create(void);\n static int jas_iccprof_readhdr(jas_stream_t *in, jas_icchdr_t *hdr);\n static int jas_iccprof_writehdr(jas_stream_t *out, jas_icchdr_t *hdr);\n@@ -1603,11 +1603,11 @@ static void jas_icclut16_dump(jas_iccattrval_t *attrval, FILE *out)\n *\n \\******************************************************************************\/\n \n-static int jas_iccgetuint(jas_stream_t *in, int n, ulonglong *val)\n+static int jas_iccgetuint(jas_stream_t *in, int n, jas_ulonglong *val)\n {\n \tint i;\n \tint c;\n-\tulonglong v;\n+\tjas_ulonglong v;\n \tv = 0;\n \tfor (i = n; i > 0; --i) {\n \t\tif ((c = jas_stream_getc(in)) == EOF)\n@@ -1629,7 +1629,7 @@ static int jas_iccgetuint8(jas_stream_t *in, jas_iccuint8_t *val)\n \n static int jas_iccgetuint16(jas_stream_t *in, jas_iccuint16_t *val)\n {\n-\tulonglong tmp;\n+\tjas_ulonglong tmp;\n \tif (jas_iccgetuint(in, 2, &tmp))\n \t\treturn -1;\n \t*val = tmp;\n@@ -1638,17 +1638,17 @@ static int jas_iccgetuint16(jas_stream_t *in, jas_iccuint16_t *val)\n \n static int jas_iccgetsint32(jas_stream_t *in, jas_iccsint32_t *val)\n {\n-\tulonglong tmp;\n+\tjas_ulonglong tmp;\n \tif (jas_iccgetuint(in, 4, &tmp))\n \t\treturn -1;\n-\t*val = (tmp & 0x80000000) ? (-JAS_CAST(longlong, (((~tmp) &\n-\t  0x7fffffff) + 1))) : JAS_CAST(longlong, tmp);\n+\t*val = (tmp & 0x80000000) ? (-JAS_CAST(jas_longlong, (((~tmp) &\n+\t  0x7fffffff) + 1))) : JAS_CAST(jas_longlong, tmp);\n \treturn 0;\n }\n \n static int jas_iccgetuint32(jas_stream_t *in, jas_iccuint32_t *val)\n {\n-\tulonglong tmp;\n+\tjas_ulonglong tmp;\n \tif (jas_iccgetuint(in, 4, &tmp))\n \t\treturn -1;\n \t*val = tmp;\n@@ -1657,14 +1657,14 @@ static int jas_iccgetuint32(jas_stream_t *in, jas_iccuint32_t *val)\n \n static int jas_iccgetuint64(jas_stream_t *in, jas_iccuint64_t *val)\n {\n-\tulonglong tmp;\n+\tjas_ulonglong tmp;\n \tif (jas_iccgetuint(in, 8, &tmp))\n \t\treturn -1;\n \t*val = tmp;\n \treturn 0;\n }\n \n-static int jas_iccputuint(jas_stream_t *out, int n, ulonglong val)\n+static int jas_iccputuint(jas_stream_t *out, int n, jas_ulonglong val)\n {\n \tint i;\n \tint c;\n@@ -1676,9 +1676,9 @@ static int jas_iccputuint(jas_stream_t *out, int n, ulonglong val)\n \treturn 0;\n }\n \n-static int jas_iccputsint(jas_stream_t *out, int n, longlong val)\n+static int jas_iccputsint(jas_stream_t *out, int n, jas_longlong val)\n {\n-\tulonglong tmp;\n+\tjas_ulonglong tmp;\n \ttmp = (val < 0) ? (abort(), 0) : val;\n \treturn jas_iccputuint(out, n, tmp);\n }\n@@ -1719,7 +1719,7 @@ static long jas_iccpowi(int x, int n)\n }\n \n \n-jas_iccprof_t *jas_iccprof_createfrombuf(uchar *buf, int len)\n+jas_iccprof_t *jas_iccprof_createfrombuf(jas_uchar *buf, int len)\n {\n \tjas_stream_t *in;\n \tjas_iccprof_t *prof;\ndiff --git a\/src\/libjasper\/base\/jas_iccdata.c b\/src\/libjasper\/base\/jas_iccdata.c\nindex bf68bf0..dcbedf2 100644\n--- a\/src\/libjasper\/base\/jas_iccdata.c\n+++ b\/src\/libjasper\/base\/jas_iccdata.c\n@@ -62,7 +62,7 @@\n #include <jasper\/jas_config.h>\n #include <jasper\/jas_types.h>\n \n-uchar jas_iccprofdata_srgb[] =\n+jas_uchar jas_iccprofdata_srgb[] =\n {\n \t0x00, 0x00, 0x0c, 0x48, 0x4c, 0x69, 0x6e, 0x6f,\n \t0x02, 0x10, 0x00, 0x00, 0x6d, 0x6e, 0x74, 0x72,\n@@ -461,7 +461,7 @@ uchar jas_iccprofdata_srgb[] =\n \n int jas_iccprofdata_srgblen = sizeof(jas_iccprofdata_srgb);\n \n-uchar jas_iccprofdata_sgray[] = {\n+jas_uchar jas_iccprofdata_sgray[] = {\n \t0x00, 0x00, 0x01, 0x8a, 0x00, 0x00, 0x00, 0x00,\n \t0x02, 0x20, 0x00, 0x00, 0x73, 0x63, 0x6e, 0x72,\n \t0x47, 0x52, 0x41, 0x59, 0x58, 0x59, 0x5a, 0x20,\ndiff --git a\/src\/libjasper\/base\/jas_image.c b\/src\/libjasper\/base\/jas_image.c\nindex 7b56d17..f6dee96 100644\n--- a\/src\/libjasper\/base\/jas_image.c\n+++ b\/src\/libjasper\/base\/jas_image.c\n@@ -133,30 +133,35 @@ jas_image_t *jas_image_create(int numcmpts, jas_image_cmptparm_t *cmptparms,\n   int clrspc)\n {\n \tjas_image_t *image;\n-\tuint_fast32_t rawsize;\n+\tsize_t rawsize;\n \tuint_fast32_t inmem;\n \tint cmptno;\n \tjas_image_cmptparm_t *cmptparm;\n \n+\timage = 0;\n+\n+\tJAS_DBGLOG(100, (\"jas_image_create(%d, %p, %d)\\n\", numcmpts, cmptparms,\n+\t  clrspc));\n+\n \tif (!(image = jas_image_create0())) {\n-\t\treturn 0;\n+\t\tgoto error;\n \t}\n \n \timage->clrspc_ = clrspc;\n \timage->maxcmpts_ = numcmpts;\n-\timage->inmem_ = true;\n+\/\/\timage->inmem_ = true;\n \n \t\/* Allocate memory for the per-component information. *\/\n \tif (!(image->cmpts_ = jas_alloc2(image->maxcmpts_,\n \t  sizeof(jas_image_cmpt_t *)))) {\n-\t\tjas_image_destroy(image);\n-\t\treturn 0;\n+\t\tgoto error;\n \t}\n \t\/* Initialize in case of failure. *\/\n \tfor (cmptno = 0; cmptno < image->maxcmpts_; ++cmptno) {\n \t\timage->cmpts_[cmptno] = 0;\n \t}\n \n+#if 0\n \t\/* Compute the approximate raw size of the image. *\/\n \trawsize = 0;\n \tfor (cmptno = 0, cmptparm = cmptparms; cmptno < numcmpts; ++cmptno,\n@@ -167,16 +172,22 @@ jas_image_t *jas_image_create(int numcmpts, jas_image_cmptparm_t *cmptparms,\n \t\/* Decide whether to buffer the image data in memory, based on the\n \t  raw size of the image. *\/\n \tinmem = (rawsize < JAS_IMAGE_INMEMTHRESH);\n+#endif\n \n \t\/* Create the individual image components. *\/\n \tfor (cmptno = 0, cmptparm = cmptparms; cmptno < numcmpts; ++cmptno,\n \t  ++cmptparm) {\n+\t\tif (!jas_safe_size_mul3(cmptparm->width, cmptparm->height,\n+\t\t  (cmptparm->prec + 7), &rawsize)) {\n+\t\t\tgoto error;\n+\t\t}\n+\t\trawsize \/= 8;\n+\t\tinmem = (rawsize < JAS_IMAGE_INMEMTHRESH);\n \t\tif (!(image->cmpts_[cmptno] = jas_image_cmpt_create(cmptparm->tlx,\n \t\t  cmptparm->tly, cmptparm->hstep, cmptparm->vstep,\n \t\t  cmptparm->width, cmptparm->height, cmptparm->prec,\n \t\t  cmptparm->sgnd, inmem))) {\n-\t\t\tjas_image_destroy(image);\n-\t\t\treturn 0;\n+\t\t\tgoto error;\n \t\t}\n \t\t++image->numcmpts_;\n \t}\n@@ -186,6 +197,12 @@ jas_image_t *jas_image_create(int numcmpts, jas_image_cmptparm_t *cmptparms,\n \tjas_image_setbbox(image);\n \n \treturn image;\n+\n+error:\n+\tif (image) {\n+\t\tjas_image_destroy(image);\n+\t}\n+\treturn 0;\n }\n \n jas_image_t *jas_image_create0()\n@@ -204,7 +221,7 @@ jas_image_t *jas_image_create0()\n \timage->numcmpts_ = 0;\n \timage->maxcmpts_ = 0;\n \timage->cmpts_ = 0;\n-\timage->inmem_ = true;\n+\/\/\timage->inmem_ = true;\n \timage->cmprof_ = 0;\n \n \treturn image;\n@@ -316,6 +333,19 @@ static jas_image_cmpt_t *jas_image_cmpt_create(int_fast32_t tlx,\n \tjas_image_cmpt_t *cmpt;\n \tsize_t size;\n \n+\tJAS_DBGLOG(100, (\n+\t  \"jas_image_cmpt_create(%ld, %ld, %ld, %ld, %ld, %ld, %d, %d, %d)\\n\",\n+\t  JAS_CAST(long, tlx),\n+\t  JAS_CAST(long, tly),\n+\t  JAS_CAST(long, hstep),\n+\t  JAS_CAST(long, vstep),\n+\t  JAS_CAST(long, width),\n+\t  JAS_CAST(long, height),\n+\t  JAS_CAST(int, depth),\n+\t  sgnd,\n+\t  inmem\n+\t  ));\n+\n \tcmpt = 0;\n \tif (width < 0 || height < 0 || hstep <= 0 || vstep <= 0) {\n \t\tgoto error;\n@@ -324,6 +354,9 @@ static jas_image_cmpt_t *jas_image_cmpt_create(int_fast32_t tlx,\n \t  !jas_safe_intfast32_add(tly, height, 0)) {\n \t\tgoto error;\n \t}\n+\tif (!jas_safe_intfast32_mul3(width, height, depth, 0)) {\n+\t\tgoto error;\n+\t}\n \n \tif (!(cmpt = jas_malloc(sizeof(jas_image_cmpt_t)))) {\n \t\tgoto error;\n@@ -344,8 +377,7 @@ static jas_image_cmpt_t *jas_image_cmpt_create(int_fast32_t tlx,\n \t\/\/ Compute the number of samples in the image component, while protecting\n \t\/\/ against overflow.\n \t\/\/ size = cmpt->width_ * cmpt->height_ * cmpt->cps_;\n-\tif (!jas_safe_size_mul(cmpt->width_, cmpt->height_, &size) ||\n-\t  !jas_safe_size_mul(size, cmpt->cps_, &size)) {\n+\tif (!jas_safe_size_mul3(cmpt->width_, cmpt->height_, cmpt->cps_, &size)) {\n \t\tgoto error;\n \t}\n \tcmpt->stream_ = (inmem) ? jas_stream_memopen2(0, size) :\n@@ -1279,7 +1311,7 @@ static void jas_image_calcbbox2(jas_image_t *image, jas_image_coord_t *tlx,\n \t*bry = tmpbry;\n }\n \n-static inline long decode_twos_comp(ulong c, int prec)\n+static inline long decode_twos_comp(jas_ulong c, int prec)\n {\n \tlong result;\n \tassert(prec >= 2);\n@@ -1289,9 +1321,9 @@ static inline long decode_twos_comp(ulong c, int prec)\n \treturn result;\n }\n \n-static inline ulong encode_twos_comp(long n, int prec)\n+static inline jas_ulong encode_twos_comp(long n, int prec)\n {\n-\tulong result;\n+\tjas_ulong result;\n \tassert(prec >= 2);\n \tjas_eprintf(\"warning: support for signed data is untested\\n\");\n \t\/\/ NOTE: Is this correct?\n@@ -1332,7 +1364,7 @@ static int putint(jas_stream_t *out, int sgnd, int prec, long val)\n \tint n;\n \tint c;\n \tbool s;\n-\tulong tmp;\n+\tjas_ulong tmp;\n \tassert((!sgnd && prec >= 1) || (sgnd && prec >= 2));\n \tif (sgnd) {\n \t\tval = encode_twos_comp(val, prec);\ndiff --git a\/src\/libjasper\/base\/jas_seq.c b\/src\/libjasper\/base\/jas_seq.c\nindex 27a21e9..6c5e163 100644\n--- a\/src\/libjasper\/base\/jas_seq.c\n+++ b\/src\/libjasper\/base\/jas_seq.c\n@@ -84,7 +84,8 @@\n * Constructors and destructors.\n \\******************************************************************************\/\n \n-jas_matrix_t *jas_seq2d_create(int xstart, int ystart, int xend, int yend)\n+jas_matrix_t *jas_seq2d_create(jas_matind_t xstart, jas_matind_t ystart,\n+  jas_matind_t xend, jas_matind_t yend)\n {\n \tjas_matrix_t *matrix;\n \tassert(xstart <= xend && ystart <= yend);\n@@ -98,10 +99,10 @@ jas_matrix_t *jas_seq2d_create(int xstart, int ystart, int xend, int yend)\n \treturn matrix;\n }\n \n-jas_matrix_t *jas_matrix_create(int numrows, int numcols)\n+jas_matrix_t *jas_matrix_create(jas_matind_t numrows, jas_matind_t numcols)\n {\n \tjas_matrix_t *matrix;\n-\tint i;\n+\tjas_matind_t i;\n \tsize_t size;\n \n \tmatrix = 0;\n@@ -180,8 +181,8 @@ void jas_matrix_destroy(jas_matrix_t *matrix)\n jas_seq2d_t *jas_seq2d_copy(jas_seq2d_t *x)\n {\n \tjas_matrix_t *y;\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \ty = jas_seq2d_create(jas_seq2d_xstart(x), jas_seq2d_ystart(x),\n \t  jas_seq2d_xend(x), jas_seq2d_yend(x));\n \tassert(y);\n@@ -196,8 +197,8 @@ jas_seq2d_t *jas_seq2d_copy(jas_seq2d_t *x)\n jas_matrix_t *jas_matrix_copy(jas_matrix_t *x)\n {\n \tjas_matrix_t *y;\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \ty = jas_matrix_create(x->numrows_, x->numcols_);\n \tfor (i = 0; i < x->numrows_; ++i) {\n \t\tfor (j = 0; j < x->numcols_; ++j) {\n@@ -211,17 +212,17 @@ jas_matrix_t *jas_matrix_copy(jas_matrix_t *x)\n * Bind operations.\n \\******************************************************************************\/\n \n-void jas_seq2d_bindsub(jas_matrix_t *s, jas_matrix_t *s1, int xstart,\n-  int ystart, int xend, int yend)\n+void jas_seq2d_bindsub(jas_matrix_t *s, jas_matrix_t *s1, jas_matind_t xstart,\n+  jas_matind_t ystart, jas_matind_t xend, jas_matind_t yend)\n {\n \tjas_matrix_bindsub(s, s1, ystart - s1->ystart_, xstart - s1->xstart_,\n \t  yend - s1->ystart_ - 1, xend - s1->xstart_ - 1);\n }\n \n-void jas_matrix_bindsub(jas_matrix_t *mat0, jas_matrix_t *mat1, int r0,\n-  int c0, int r1, int c1)\n+void jas_matrix_bindsub(jas_matrix_t *mat0, jas_matrix_t *mat1,\n+  jas_matind_t r0, jas_matind_t c0, jas_matind_t r1, jas_matind_t c1)\n {\n-\tint i;\n+\tjas_matind_t i;\n \n \tif (mat0->data_) {\n \t\tif (!(mat0->flags_ & JAS_MATRIX_REF)) {\n@@ -265,8 +266,8 @@ void jas_matrix_bindsub(jas_matrix_t *mat0, jas_matrix_t *mat1, int r0,\n \n int jas_matrix_cmp(jas_matrix_t *mat0, jas_matrix_t *mat1)\n {\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \n \tif (mat0->numrows_ != mat1->numrows_ || mat0->numcols_ !=\n \t  mat1->numcols_) {\n@@ -284,10 +285,10 @@ int jas_matrix_cmp(jas_matrix_t *mat0, jas_matrix_t *mat1)\n \n void jas_matrix_divpow2(jas_matrix_t *matrix, int n)\n {\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tjas_seqent_t *rowstart;\n-\tint rowstep;\n+\tjas_matind_t rowstep;\n \tjas_seqent_t *data;\n \n \tif (jas_matrix_numrows(matrix) > 0 && jas_matrix_numcols(matrix) > 0) {\n@@ -307,12 +308,12 @@ void jas_matrix_divpow2(jas_matrix_t *matrix, int n)\n void jas_matrix_clip(jas_matrix_t *matrix, jas_seqent_t minval,\n   jas_seqent_t maxval)\n {\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tjas_seqent_t v;\n \tjas_seqent_t *rowstart;\n \tjas_seqent_t *data;\n-\tint rowstep;\n+\tjas_matind_t rowstep;\n \n \tif (jas_matrix_numrows(matrix) > 0 && jas_matrix_numcols(matrix) > 0) {\n \t\tassert(matrix->rows_);\n@@ -335,10 +336,10 @@ void jas_matrix_clip(jas_matrix_t *matrix, jas_seqent_t minval,\n \n void jas_matrix_asr(jas_matrix_t *matrix, int n)\n {\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tjas_seqent_t *rowstart;\n-\tint rowstep;\n+\tjas_matind_t rowstep;\n \tjas_seqent_t *data;\n \n \tassert(n >= 0);\n@@ -358,10 +359,10 @@ void jas_matrix_asr(jas_matrix_t *matrix, int n)\n \n void jas_matrix_asl(jas_matrix_t *matrix, int n)\n {\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tjas_seqent_t *rowstart;\n-\tint rowstep;\n+\tjas_matind_t rowstep;\n \tjas_seqent_t *data;\n \n \tif (jas_matrix_numrows(matrix) > 0 && jas_matrix_numcols(matrix) > 0) {\n@@ -382,10 +383,11 @@ void jas_matrix_asl(jas_matrix_t *matrix, int n)\n * Code.\n \\******************************************************************************\/\n \n-int jas_matrix_resize(jas_matrix_t *matrix, int numrows, int numcols)\n+int jas_matrix_resize(jas_matrix_t *matrix, jas_matind_t numrows,\n+  jas_matind_t numcols)\n {\n-\tint size;\n-\tint i;\n+\tjas_matind_t size;\n+\tjas_matind_t i;\n \n \tsize = numrows * numcols;\n \tif (size > matrix->datasize_ || numrows > matrix->maxrows_) {\n@@ -404,10 +406,10 @@ int jas_matrix_resize(jas_matrix_t *matrix, int numrows, int numcols)\n \n void jas_matrix_setall(jas_matrix_t *matrix, jas_seqent_t val)\n {\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tjas_seqent_t *rowstart;\n-\tint rowstep;\n+\tjas_matind_t rowstep;\n \tjas_seqent_t *data;\n \n \tif (jas_matrix_numrows(matrix) > 0 && jas_matrix_numcols(matrix) > 0) {\n@@ -426,20 +428,32 @@ void jas_matrix_setall(jas_matrix_t *matrix, jas_seqent_t val)\n jas_matrix_t *jas_seq2d_input(FILE *in)\n {\n \tjas_matrix_t *matrix;\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tlong x;\n-\tint numrows;\n-\tint numcols;\n-\tint xoff;\n-\tint yoff;\n-\n-\tif (fscanf(in, \"%d %d\", &xoff, &yoff) != 2)\n+\tjas_matind_t numrows;\n+\tjas_matind_t numcols;\n+\tjas_matind_t xoff;\n+\tjas_matind_t yoff;\n+\tlong tmp_xoff;\n+\tlong tmp_yoff;\n+\tlong tmp_numrows;\n+\tlong tmp_numcols;\n+\n+\tif (fscanf(in, \"%ld %ld\", &tmp_xoff, &tmp_yoff) != 2) {\n \t\treturn 0;\n-\tif (fscanf(in, \"%d %d\", &numcols, &numrows) != 2)\n+\t}\n+\txoff = tmp_xoff;\n+\tyoff = tmp_yoff;\n+\tif (fscanf(in, \"%ld %ld\", &tmp_numcols, &tmp_numrows) != 2) {\n \t\treturn 0;\n-\tif (!(matrix = jas_seq2d_create(xoff, yoff, xoff + numcols, yoff + numrows)))\n+\t}\n+\tnumrows = tmp_numrows;\n+\tnumcols = tmp_numcols;\n+\tif (!(matrix = jas_seq2d_create(xoff, yoff, xoff + numcols,\n+\t  yoff + numrows))) {\n \t\treturn 0;\n+\t}\n \n \tif (jas_matrix_numrows(matrix) != numrows ||\n \t  jas_matrix_numcols(matrix) != numcols) {\n@@ -463,8 +477,8 @@ jas_matrix_t *jas_seq2d_input(FILE *in)\n int jas_seq2d_output(jas_matrix_t *matrix, FILE *out)\n {\n #define MAXLINELEN\t80\n-\tint i;\n-\tint j;\n+\tjas_matind_t i;\n+\tjas_matind_t j;\n \tjas_seqent_t x;\n \tchar buf[MAXLINELEN + 1];\n \tchar sbuf[MAXLINELEN + 1];\ndiff --git a\/src\/libjasper\/base\/jas_stream.c b\/src\/libjasper\/base\/jas_stream.c\nindex cea4a95..327ee57 100644\n--- a\/src\/libjasper\/base\/jas_stream.c\n+++ b\/src\/libjasper\/base\/jas_stream.c\n@@ -71,18 +71,21 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n+#include \"jasper\/jas_config.h\"\n+\n #include <assert.h>\n-#if defined(HAVE_FCNTL_H)\n+#if defined(JAS_HAVE_FCNTL_H)\n #include <fcntl.h>\n #endif\n #include <stdlib.h>\n #include <stdarg.h>\n #include <stdio.h>\n #include <ctype.h>\n-#if defined(HAVE_UNISTD_H)\n+#if defined(JAS_HAVE_UNISTD_H)\n #include <unistd.h>\n #endif\n-#if defined(WIN32) || defined(HAVE_IO_H)\n+#if defined(WIN32) || defined(JAS_HAVE_IO_H)\n #include <io.h>\n #endif\n \n@@ -909,7 +912,7 @@ static void jas_stream_initbuf(jas_stream_t *stream, int bufmode, char *buf,\n \t\t\t\/* The buffer must be large enough to accommodate maximum\n \t\t\t  putback. *\/\n \t\t\tassert(bufsize > JAS_STREAM_MAXPUTBACK);\n-\t\t\tstream->bufbase_ = JAS_CAST(uchar *, buf);\n+\t\t\tstream->bufbase_ = JAS_CAST(jas_uchar *, buf);\n \t\t\tstream->bufsize_ = bufsize - JAS_STREAM_MAXPUTBACK;\n \t\t}\n \t} else {\ndiff --git a\/src\/libjasper\/base\/jas_tmr.c b\/src\/libjasper\/base\/jas_tmr.c\nindex babb9fd..b3540d3 100644\n--- a\/src\/libjasper\/base\/jas_tmr.c\n+++ b\/src\/libjasper\/base\/jas_tmr.c\n@@ -69,6 +69,9 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n+#include \"jasper\/jas_config.h\"\n+\n #include <stdio.h>\n #include <stdlib.h>\n #include <time.h>\n@@ -79,7 +82,7 @@\n * Code.\n \\******************************************************************************\/\n \n-#if defined(HAVE_GETTIMEOFDAY)\n+#if defined(JAS_HAVE_GETTIMEOFDAY)\n \n void jas_tmr_start(jas_tmr_t *tmr)\n {\n@@ -104,7 +107,7 @@ double jas_tmr_get(jas_tmr_t *tmr)\n \treturn t1 - t0;\n }\n \n-#elif defined(HAVE_GETRUSAGE)\n+#elif defined(JAS_HAVE_GETRUSAGE)\n \n void jas_tmr_start(jas_tmr_t *tmr)\n {\ndiff --git a\/src\/libjasper\/bmp\/bmp_dec.c b\/src\/libjasper\/bmp\/bmp_dec.c\nindex d5a903f..6af2216 100644\n--- a\/src\/libjasper\/bmp\/bmp_dec.c\n+++ b\/src\/libjasper\/bmp\/bmp_dec.c\n@@ -78,9 +78,22 @@\n #include \"jasper\/jas_image.h\"\n #include \"jasper\/jas_malloc.h\"\n #include \"jasper\/jas_debug.h\"\n+#include \"jasper\/jas_tvp.h\"\n \n #include \"bmp_cod.h\"\n \n+\/******************************************************************************\\\n+* Local types.\n+\\******************************************************************************\/\n+\n+typedef struct {\n+\tsize_t max_samples;\n+} bmp_dec_importopts_t;\n+\n+typedef enum {\n+\tOPT_MAXSIZE,\n+} optid_t;\n+\n \/******************************************************************************\\\n * Local prototypes.\n \\******************************************************************************\/\n@@ -92,6 +105,43 @@ static int bmp_getint16(jas_stream_t *in, int_fast16_t *val);\n static int bmp_getint32(jas_stream_t *in, int_fast32_t *val);\n static int bmp_gobble(jas_stream_t *in, long n);\n \n+\/******************************************************************************\\\n+* Option parsing.\n+\\******************************************************************************\/\n+\n+static jas_taginfo_t decopts[] = {\n+\t{OPT_MAXSIZE, \"max_samples\"},\n+\t{-1, 0}\n+};\n+\n+static int bmp_dec_parseopts(char *optstr, bmp_dec_importopts_t *opts)\n+{\n+\tjas_tvparser_t *tvp;\n+\n+\topts->max_samples = 128 * JAS_MEBI;\n+\n+\tif (!(tvp = jas_tvparser_create(optstr ? optstr : \"\"))) {\n+\t\treturn -1;\n+\t}\n+\n+\twhile (!jas_tvparser_next(tvp)) {\n+\t\tswitch (jas_taginfo_nonull(jas_taginfos_lookup(decopts,\n+\t\t  jas_tvparser_gettag(tvp)))->id) {\n+\t\tcase OPT_MAXSIZE:\n+\t\t\topts->max_samples = atoi(jas_tvparser_getval(tvp));\n+\t\t\tbreak;\n+\t\tdefault:\n+\t\t\tjas_eprintf(\"warning: ignoring invalid option %s\\n\",\n+\t\t\t  jas_tvparser_gettag(tvp));\n+\t\t\tbreak;\n+\t\t}\n+\t}\n+\n+\tjas_tvparser_destroy(tvp);\n+\n+\treturn 0;\n+}\n+\n \/******************************************************************************\\\n * Interface functions.\n \\******************************************************************************\/\n@@ -106,12 +156,14 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \tjas_image_cmptparm_t *cmptparm;\n \tuint_fast16_t numcmpts;\n \tlong n;\n+\tbmp_dec_importopts_t opts;\n+\tsize_t num_samples;\n \n \timage = 0;\n \tinfo = 0;\n \n-\tif (optstr) {\n-\t\tjas_eprintf(\"warning: ignoring BMP decoder options\\n\");\n+\tif (bmp_dec_parseopts(optstr, &opts)) {\n+\t\tgoto error;\n \t}\n \n \tjas_eprintf(\n@@ -125,7 +177,6 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \tif (bmp_gethdr(in, &hdr)) {\n \t\tjas_eprintf(\"cannot get header\\n\");\n \t\tgoto error;\n-\t\t\/\/return 0;\n \t}\n \tJAS_DBGLOG(1, (\n \t  \"BMP header: magic 0x%x; siz %d; res1 %d; res2 %d; off %d\\n\",\n@@ -135,7 +186,6 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \t\/* Read the bitmap information. *\/\n \tif (!(info = bmp_getinfo(in))) {\n \t\tjas_eprintf(\"cannot get info\\n\");\n-\t\t\/\/return 0;\n \t\tgoto error;\n \t}\n \tJAS_DBGLOG(1,\n@@ -154,11 +204,21 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \t\tgoto error;\n \t}\n \n+\tif (!jas_safe_size_mul3(info->width, info->height, info->numplanes,\n+\t  &num_samples)) {\n+\t\tjas_eprintf(\"image size too large\\n\");\n+\t\tgoto error;\n+\t}\n+\n+\tif (opts.max_samples > 0 && num_samples > opts.max_samples) {\n+\t\tjas_eprintf(\"maximum number of pixels exceeded (%zu)\\n\",\n+\t\t  opts.max_samples);\n+\t\tgoto error;\n+\t}\n+\n \t\/* Ensure that we support this type of BMP file. *\/\n \tif (!bmp_issupported(&hdr, info)) {\n \t\tjas_eprintf(\"error: unsupported BMP encoding\\n\");\n-\t\t\/\/bmp_info_destroy(info);\n-\t\t\/\/return 0;\n \t\tgoto error;\n \t}\n \n@@ -167,13 +227,10 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \tif ((n = hdr.off - (BMP_HDRLEN + BMP_INFOLEN + BMP_PALLEN(info))) < 0) {\n \t\tjas_eprintf(\"error: possibly bad bitmap offset?\\n\");\n \t\tgoto error;\n-\t\t\/\/return 0;\n \t}\n \tif (n > 0) {\n \t\tjas_eprintf(\"skipping unknown data in BMP file\\n\");\n \t\tif (bmp_gobble(in, n)) {\n-\t\t\t\/\/bmp_info_destroy(info);\n-\t\t\t\/\/return 0;\n \t\t\tgoto error;\n \t\t}\n \t}\n@@ -196,8 +253,6 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \t\/* Create image object. *\/\n \tif (!(image = jas_image_create(numcmpts, cmptparms,\n \t  JAS_CLRSPC_UNKNOWN))) {\n-\t\t\/\/bmp_info_destroy(info);\n-\t\t\/\/return 0;\n \t\tgoto error;\n \t}\n \n@@ -217,9 +272,6 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \n \t\/* Read the bitmap data. *\/\n \tif (bmp_getdata(in, info, image)) {\n-\t\t\/\/bmp_info_destroy(info);\n-\t\t\/\/jas_image_destroy(image);\n-\t\t\/\/return 0;\n \t\tgoto error;\n \t}\n \n@@ -241,7 +293,7 @@ int bmp_validate(jas_stream_t *in)\n {\n \tint n;\n \tint i;\n-\tuchar buf[2];\n+\tjas_uchar buf[2];\n \n \tassert(JAS_STREAM_MAXPUTBACK >= 2);\n \ndiff --git a\/src\/libjasper\/include\/jasper\/jas_cm.h b\/src\/libjasper\/include\/jasper\/jas_cm.h\nindex d5cd22e..af785f3 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_cm.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_cm.h\n@@ -68,7 +68,9 @@\n #ifndef JAS_CM_H\n #define JAS_CM_H\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n+\n #include <jasper\/jas_icc.h>\n \n #ifdef __cplusplus\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_config.h.in b\/src\/libjasper\/include\/jasper\/jas_config.h.in\nnew file mode 100644\nindex 0000000..0c0e86f\n--- \/dev\/null\n+++ b\/src\/libjasper\/include\/jasper\/jas_config.h.in\n@@ -0,0 +1,27 @@\n+#ifndef JAS_CONFIG_H\n+#define JAS_CONFIG_H\n+\n+\/* This preprocessor symbol identifies the version of JasPer. *\/\n+#define\tJAS_VERSION \"@JAS_VERSION@\"\n+\n+@JAS_HAVE_FCNTL_H@\n+@JAS_HAVE_IO_H@\n+@JAS_HAVE_UNISTD_H@\n+@JAS_HAVE_WINDOWS_H@\n+@JAS_HAVE_SYS_TIME_H@\n+@JAS_HAVE_SYS_TYPES_H@\n+\n+@JAS_HAVE_GETTIMEOFDAY@\n+@JAS_HAVE_GETRUSAGE@\n+\n+#if defined(__GNUC__) && !defined(__clang__)\n+#define JAS_ATTRIBUTE_DISABLE_USAN \\\n+  __attribute__((no_sanitize_undefined))\n+#elif defined(__clang__)\n+#define JAS_ATTRIBUTE_DISABLE_USAN \\\n+  __attribute__((no_sanitize(\"undefined\")))\n+#else\n+#define JAS_ATTRIBUTE_DISABLE_USAN\n+#endif\n+\n+#endif\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_config2.h b\/src\/libjasper\/include\/jasper\/jas_config2.h\nindex f139db0..2666b79 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_config2.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_config2.h\n@@ -70,23 +70,10 @@\n  * normally defined by configure.\n  *\/\n \n-#define\tuchar\t\tunsigned char\n-#define\tushort\t\tunsigned short\n-#define\tuint\t\tunsigned int\n-#define\tulong\t\tunsigned long\n-#undef longlong\n-#define\tlonglong\tlong long\n-#undef ulonglong\n-#define\tulonglong\tunsigned long long\n-\/*#define\tssize_t\t\tint*\/\n-\n #define\tHAVE_FCNTL_H\t\t1\n-#define\tHAVE_LIMITS_H\t\t1\n #define\tHAVE_IO_H\t\t1\n #define\tHAVE_WINDOWS_H\t\t1\n #define\tHAVE_SYS_TYPES_H\t1\n-#define\tHAVE_STDLIB_H\t\t1\n-#define\tHAVE_STDDEF_H\t\t1\n \n #ifndef __cplusplus\n #undef inline\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_debug.h b\/src\/libjasper\/include\/jasper\/jas_debug.h\nindex 6b78112..d820d36 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_debug.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_debug.h\n@@ -72,9 +72,11 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n+#include <jasper\/jas_config.h>\n+\n #include <stdio.h>\n \n-#include <jasper\/jas_config.h>\n #include <jasper\/jas_types.h>\n #include <jasper\/jas_debug.h>\n \ndiff --git a\/src\/libjasper\/include\/jasper\/jas_fix.h b\/src\/libjasper\/include\/jasper\/jas_fix.h\nindex e9164c7..f75d52a 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_fix.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_fix.h\n@@ -74,11 +74,13 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n+#include <jasper\/jas_config.h>\n+\n #include <stdio.h>\n #include <stdlib.h>\n #include <math.h>\n \n-#include <jasper\/jas_config.h>\n #include <jasper\/jas_types.h>\n #include <jasper\/jas_debug.h>\n \ndiff --git a\/src\/libjasper\/include\/jasper\/jas_getopt.h b\/src\/libjasper\/include\/jasper\/jas_getopt.h\nindex 3c7b205..1db2e0f 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_getopt.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_getopt.h\n@@ -74,6 +74,7 @@\n extern \"C\" {\n #endif\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n \/******************************************************************************\\\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_icc.h b\/src\/libjasper\/include\/jasper\/jas_icc.h\nindex 616a572..668f6f5 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_icc.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_icc.h\n@@ -62,7 +62,9 @@\n #ifndef JAS_ICC_H\n #define\tJAS_ICC_H\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n+\n #include <jasper\/jas_types.h>\n #include <jasper\/jas_stream.h>\n \n@@ -252,10 +254,10 @@ typedef struct {\n \tchar *ascdata; \/* ASCII invariant description *\/\n \tjas_iccuint32_t uclangcode; \/* Unicode language code *\/\n \tjas_iccuint32_t uclen; \/* Unicode localizable description count *\/\n-\tuchar *ucdata; \/* Unicode localizable description *\/\n+\tjas_uchar *ucdata; \/* Unicode localizable description *\/\n \tjas_iccuint16_t sccode; \/* ScriptCode code *\/\n \tjas_iccuint8_t maclen; \/* Localizable Macintosh description count *\/\n-\tuchar macdata[69]; \/* Localizable Macintosh description *\/\n+\tjas_uchar macdata[69]; \/* Localizable Macintosh description *\/\n } jas_icctxtdesc_t;\n \n \/* Text type. *\/\n@@ -393,11 +395,11 @@ jas_iccattrval_t *jas_iccattrval_create(jas_iccuint32_t type);\n \n void jas_iccattrtab_dump(jas_iccattrtab_t *attrtab, FILE *out);\n \n-extern uchar jas_iccprofdata_srgb[];\n+extern jas_uchar jas_iccprofdata_srgb[];\n extern int jas_iccprofdata_srgblen;\n-extern uchar jas_iccprofdata_sgray[];\n+extern jas_uchar jas_iccprofdata_sgray[];\n extern int jas_iccprofdata_sgraylen;\n-jas_iccprof_t *jas_iccprof_createfrombuf(uchar *buf, int len);\n+jas_iccprof_t *jas_iccprof_createfrombuf(jas_uchar *buf, int len);\n jas_iccprof_t *jas_iccprof_createfromclrspc(int clrspc);\n \n #ifdef __cplusplus\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_image.h b\/src\/libjasper\/include\/jasper\/jas_image.h\nindex 4dcfcc1..b0594c7 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_image.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_image.h\n@@ -74,7 +74,9 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n+\n #include <jasper\/jas_stream.h>\n #include <jasper\/jas_seq.h>\n #include <jasper\/jas_cm.h>\n@@ -217,7 +219,7 @@ typedef struct {\n \n \tjas_cmprof_t *cmprof_;\n \n-\tbool inmem_;\n+\/\/\tbool inmem_;\n \n } jas_image_t;\n \ndiff --git a\/src\/libjasper\/include\/jasper\/jas_init.h b\/src\/libjasper\/include\/jasper\/jas_init.h\nindex 10301e9..20121f5 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_init.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_init.h\n@@ -62,6 +62,7 @@\n #ifndef JAS_INIT_H\n #define JAS_INIT_H\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #ifdef __cplusplus\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_malloc.h b\/src\/libjasper\/include\/jasper\/jas_malloc.h\nindex f3f9047..7b03933 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_malloc.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_malloc.h\n@@ -74,6 +74,7 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #include <stdlib.h>\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_math.h b\/src\/libjasper\/include\/jasper\/jas_math.h\nindex 88f43ed..723b0fa 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_math.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_math.h\n@@ -74,7 +74,9 @@\n * Includes\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n+\n #include <jasper\/jas_types.h>\n \n #include <assert.h>\n@@ -91,6 +93,9 @@ extern \"C\" {\n * Macros\n \\******************************************************************************\/\n \n+#define JAS_KIBI\tJAS_CAST(size_t, 1024)\n+#define JAS_MEBI\t(JAS_KIBI * JAS_KIBI)\n+\n \/* Compute the absolute value. *\/\n #define\tJAS_ABS(x) \\\n \t(((x) >= 0) ? (x) : (-(x)))\n@@ -187,6 +192,20 @@ inline static bool jas_safe_size_mul(size_t x, size_t y, size_t *result)\n \treturn true;\n }\n \n+inline static bool jas_safe_size_mul3(size_t a, size_t b, size_t c,\n+  size_t *result)\n+{\n+\tsize_t tmp;\n+\tif (!jas_safe_size_mul(a, b, &tmp) ||\n+\t  !jas_safe_size_mul(tmp, c, &tmp)) {\n+\t\treturn false;\n+\t}\n+\tif (result) {\n+\t\t*result = tmp;\n+\t}\n+\treturn true;\n+}\n+\n \/* Compute the sum of two size_t integer with overflow checking. *\/\n inline static bool jas_safe_size_add(size_t x, size_t y, size_t *result)\n {\n@@ -211,6 +230,57 @@ inline static bool jas_safe_size_sub(size_t x, size_t y, size_t *result)\n \treturn true;\n }\n \n+\/* Compute the sum of two size_t integer with overflow checking. *\/\n+inline static bool jas_safe_intfast32_mul(int_fast32_t x, int_fast32_t y,\n+  int_fast32_t *result)\n+{\n+\tif (x > 0) {\n+\t\t\/* x is positive *\/\n+\t\tif (y > 0) {\n+\t\t\t\/* x and y are positive *\/\n+\t\t\tif (x > INT_FAST32_MAX \/ y) {\n+\t\t\t\treturn false;\n+\t\t\t}\n+\t\t} else {\n+\t\t\t\/* x positive, y nonpositive *\/\n+\t\t\tif (y < INT_FAST32_MIN \/ x) {\n+\t\t\t\treturn false;\n+\t\t\t}\n+\t\t}\n+\t} else {\n+\t\t\/* x is nonpositive *\/\n+\t\tif (y > 0) {\n+\t\t\t\/* x is nonpositive, y is positive *\/\n+\t\t\tif (x < INT_FAST32_MIN \/ y) {\n+\t\t\t\treturn false;\n+\t\t\t}\n+\t\t} else { \/* x and y are nonpositive *\/\n+\t\t\tif (x != 0 && y < INT_FAST32_MAX \/ x) {\n+\t\t\t\treturn false;\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\tif (result) {\n+\t\t*result = x * y;\n+\t}\n+\treturn true;\n+}\n+\n+inline static bool jas_safe_intfast32_mul3(int_fast32_t a, int_fast32_t b,\n+  int_fast32_t c, int_fast32_t *result)\n+{\n+\tint_fast32_t tmp;\n+\tif (!jas_safe_intfast32_mul(a, b, &tmp) ||\n+\t  !jas_safe_intfast32_mul(tmp, c, &tmp)) {\n+\t\treturn false;\n+\t}\n+\tif (result) {\n+\t\t*result = tmp;\n+\t}\n+\treturn true;\n+}\n+\n \/* Compute the sum of two size_t integer with overflow checking. *\/\n inline static bool jas_safe_intfast32_add(int_fast32_t x, int_fast32_t y,\n   int_fast32_t *result)\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_seq.h b\/src\/libjasper\/include\/jasper\/jas_seq.h\nindex 02fdebf..3cdc9e5 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_seq.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_seq.h\n@@ -74,6 +74,7 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #include <jasper\/jas_stream.h>\n@@ -102,6 +103,8 @@ typedef int_fast32_t jas_seqent_t;\n \/* An element in a matrix. *\/\n typedef int_fast32_t jas_matent_t;\n \n+typedef int_fast32_t jas_matind_t;\n+\n \/* Matrix. *\/\n \n typedef struct {\n@@ -110,22 +113,22 @@ typedef struct {\n \tint flags_;\n \n \t\/* The starting horizontal index. *\/\n-\tint_fast32_t xstart_;\n+\tjas_matind_t xstart_;\n \n \t\/* The starting vertical index. *\/\n-\tint_fast32_t ystart_;\n+\tjas_matind_t ystart_;\n \n \t\/* The ending horizontal index. *\/\n-\tint_fast32_t xend_;\n+\tjas_matind_t xend_;\n \n \t\/* The ending vertical index. *\/\n-\tint_fast32_t yend_;\n+\tjas_matind_t yend_;\n \n \t\/* The number of rows in the matrix. *\/\n-\tint_fast32_t numrows_;\n+\tjas_matind_t numrows_;\n \n \t\/* The number of columns in the matrix. *\/\n-\tint_fast32_t numcols_;\n+\tjas_matind_t numcols_;\n \n \t\/* Pointers to the start of each row. *\/\n \tjas_seqent_t **rows_;\n@@ -182,25 +185,26 @@ typedef jas_matrix_t jas_seq_t;\n \t(&(matrix)->rows_[i][j])\n \n #define\tjas_matrix_getvref(matrix, i) \\\n-\t(((matrix)->numrows_ > 1) ? jas_matrix_getref(matrix, i, 0) : jas_matrix_getref(matrix, 0, i))\n+\t(((matrix)->numrows_ > 1) ? jas_matrix_getref(matrix, i, 0) : \\\n+\t  jas_matrix_getref(matrix, 0, i))\n \n #define jas_matrix_length(matrix) \\\n \t(max((matrix)->numrows_, (matrix)->numcols_))\n \n \/* Create a matrix with the specified dimensions. *\/\n-jas_matrix_t *jas_matrix_create(int numrows, int numcols);\n+jas_matrix_t *jas_matrix_create(jas_matind_t numrows, jas_matind_t numcols);\n \n \/* Destroy a matrix. *\/\n void jas_matrix_destroy(jas_matrix_t *matrix);\n \n \/* Resize a matrix.  The previous contents of the matrix are lost. *\/\n-int jas_matrix_resize(jas_matrix_t *matrix, int numrows, int numcols);\n+int jas_matrix_resize(jas_matrix_t *matrix, jas_matind_t numrows, jas_matind_t numcols);\n \n int jas_matrix_output(jas_matrix_t *matrix, FILE *out);\n \n \/* Create a matrix that references part of another matrix. *\/\n-void jas_matrix_bindsub(jas_matrix_t *mat0, jas_matrix_t *mat1, int r0,\n-  int c0, int r1, int c1);\n+void jas_matrix_bindsub(jas_matrix_t *mat0, jas_matrix_t *mat1, jas_matind_t r0,\n+  jas_matind_t c0, jas_matind_t r1, jas_matind_t c1);\n \n \/* Create a matrix that is a reference to a row of another matrix. *\/\n #define jas_matrix_bindrow(mat0, mat1, r) \\\n@@ -250,7 +254,8 @@ jas_matrix_t *jas_matrix_input(FILE *);\n \n jas_seq2d_t *jas_seq2d_copy(jas_seq2d_t *x);\n \n-jas_matrix_t *jas_seq2d_create(int xstart, int ystart, int xend, int yend);\n+jas_matrix_t *jas_seq2d_create(jas_matind_t xstart, jas_matind_t ystart,\n+  jas_matind_t xend, jas_matind_t yend);\n \n #define\tjas_seq2d_destroy(s) \\\n \tjas_matrix_destroy(s)\n@@ -280,8 +285,8 @@ jas_matrix_t *jas_seq2d_create(int xstart, int ystart, int xend, int yend);\n #define jas_seq2d_size(s) \\\n \t(jas_seq2d_width(s) * jas_seq2d_height(s))\n \n-void jas_seq2d_bindsub(jas_matrix_t *s, jas_matrix_t *s1, int xstart,\n-  int ystart, int xend, int yend);\n+void jas_seq2d_bindsub(jas_matrix_t *s, jas_matrix_t *s1, jas_matind_t xstart,\n+  jas_matind_t ystart, jas_matind_t xend, jas_matind_t yend);\n \n \/******************************************************************************\\\n * Functions\/macros for 1-D sequence class.\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_stream.h b\/src\/libjasper\/include\/jasper\/jas_stream.h\nindex b9801d8..5badccd 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_stream.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_stream.h\n@@ -74,14 +74,15 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #include <stdio.h>\n-#if defined(HAVE_FCNTL_H)\n+#if defined(JAS_HAVE_FCNTL_H)\n #include <fcntl.h>\n #endif\n #include <string.h>\n-#if defined(HAVE_UNISTD_H)\n+#if defined(JAS_HAVE_UNISTD_H)\n #include <unistd.h>\n #endif\n #include <jasper\/jas_types.h>\n@@ -208,24 +209,24 @@ typedef struct {\n \tint flags_;\n \n \t\/* The start of the buffer area to use for reading\/writing. *\/\n-\tuchar *bufbase_;\n+\tjas_uchar *bufbase_;\n \n \t\/* The start of the buffer area excluding the extra initial space for\n \t  character putback. *\/\n-\tuchar *bufstart_;\n+\tjas_uchar *bufstart_;\n \n \t\/* The buffer size. *\/\n \tint bufsize_;\n \n \t\/* The current position in the buffer. *\/\n-\tuchar *ptr_;\n+\tjas_uchar *ptr_;\n \n \t\/* The number of characters that must be read\/written before\n \tthe buffer needs to be filled\/flushed. *\/\n \tint cnt_;\n \n \t\/* A trivial buffer to be used for unbuffered operation. *\/\n-\tuchar tinybuf_[JAS_STREAM_MAXPUTBACK + 1];\n+\tjas_uchar tinybuf_[JAS_STREAM_MAXPUTBACK + 1];\n \n \t\/* The operations for the underlying stream file object. *\/\n \tjas_stream_ops_t *ops_;\n@@ -264,7 +265,7 @@ typedef struct {\n typedef struct {\n \n \t\/* The data associated with this file. *\/\n-\tuchar *buf_;\n+\tjas_uchar *buf_;\n \n \t\/* The allocated size of the buffer for holding file data. *\/\n \tsize_t bufsize_;\n@@ -451,7 +452,7 @@ directly, you will die a horrible, miserable, and painful death! *\/\n \t  jas_stream_putc2(stream, c)) : EOF)\n #define jas_stream_putc2(stream, c) \\\n \t(((stream)->bufmode_ |= JAS_STREAM_WRBUF, --(stream)->cnt_ < 0) ? \\\n-\t  jas_stream_flushbuf((stream), (uchar)(c)) : \\\n+\t  jas_stream_flushbuf((stream), (jas_uchar)(c)) : \\\n \t  (++(stream)->rwcnt_, (int)(*(stream)->ptr_++ = (c))))\n \n \/* These prototypes need to be here for the sake of the stream_getc and\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_string.h b\/src\/libjasper\/include\/jasper\/jas_string.h\nindex f217da2..37fddf3 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_string.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_string.h\n@@ -74,7 +74,9 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n+\n #include <string.h>\n \n #ifdef __cplusplus\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_tmr.h b\/src\/libjasper\/include\/jasper\/jas_tmr.h\nindex 837f2bf..2f645e2 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_tmr.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_tmr.h\n@@ -62,9 +62,11 @@\n #ifndef JAS_TMR_H\n #define JAS_TMR_H\n \n-#include<time.h>\n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n-#if defined(HAVE_SYS_TIME_H)\n+\n+#include<time.h>\n+#if defined(JAS_HAVE_SYS_TIME_H)\n #include <sys\/time.h>\n #endif\n \n@@ -72,14 +74,14 @@\n extern \"C\" {\n #endif\n \n-#if defined(HAVE_GETTIMEOFDAY)\n+#if defined(JAS_HAVE_GETTIMEOFDAY)\n \n typedef struct {\n \tstruct timeval start;\n \tstruct timeval stop;\n } jas_tmr_t;\n \n-#elif defined(HAVE_GETRUSAGE)\n+#elif defined(JAS_HAVE_GETRUSAGE)\n \n typedef struct {\n \tstruct rusage start;\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_tvp.h b\/src\/libjasper\/include\/jasper\/jas_tvp.h\nindex ae4f933..e08402c 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_tvp.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_tvp.h\n@@ -72,6 +72,7 @@\n * Includes.\n \\******************************************************************************\/\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #ifdef __cplusplus\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_types.h b\/src\/libjasper\/include\/jasper\/jas_types.h\nindex 32c541c..bd83ca5 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_types.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_types.h\n@@ -70,11 +70,13 @@\n #ifndef JAS_TYPES_H\n #define JAS_TYPES_H\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #if !defined(JAS_CONFIGURE)\n \n-#if defined(WIN32) || defined(HAVE_WINDOWS_H)\n+#if defined(WIN32) || defined(JAS_HAVE_WINDOWS_H)\n+\/\/ THIS SHOULD NO LONGER BE NEEDED SINCE MSVC SUPPORTS LONG LONG.\n \/*\n    We are dealing with Microsoft Windows and most likely Microsoft\n    Visual C (MSVC).  (Heaven help us.)  Sadly, MSVC does not correctly\n@@ -84,10 +86,10 @@\n    and \"UINT64\" types that are defined in the header file \"windows.h\".\n  *\/\n #include <windows.h>\n-#undef longlong\n-#define\tlonglong\tINT64\n-#undef ulonglong\n-#define\tulonglong\tUINT64\n+\/\/#undef longlong\n+\/\/#define\tlonglong\tINT64\n+\/\/#undef ulonglong\n+\/\/#define\tulonglong\tUINT64\n #endif\n \n #endif\n@@ -98,29 +100,15 @@\n #include <stdbool.h>\n #include <stdint.h>\n \n-#if defined(HAVE_SYS_TYPES_H)\n+#if defined(JAS_HAVE_SYS_TYPES_H)\n #include <sys\/types.h>\n #endif\n \n-\/* Hopefully, these macro definitions will fix more problems than they cause. *\/\n-#if !defined(uchar)\n-#define uchar unsigned char\n-#endif\n-#if !defined(ushort)\n-#define ushort unsigned short\n-#endif\n-#if !defined(uint)\n-#define uint unsigned int\n-#endif\n-#if !defined(ulong)\n-#define ulong unsigned long\n-#endif\n-#if !defined(longlong)\n-#define longlong long long\n-#endif\n-#if !defined(ulonglong)\n-#define ulonglong unsigned long long\n-#endif\n+#define jas_uchar unsigned char\n+#define jas_uint unsigned int\n+#define jas_ulong unsigned long\n+#define jas_longlong long long\n+#define jas_ulonglong unsigned long long\n \n \/* The below macro is intended to be used for type casts.  By using this\n   macro, type casts can be easily located in the source code with\ndiff --git a\/src\/libjasper\/include\/jasper\/jas_version.h b\/src\/libjasper\/include\/jasper\/jas_version.h\nindex 14da7a0..ea37ed2 100644\n--- a\/src\/libjasper\/include\/jasper\/jas_version.h\n+++ b\/src\/libjasper\/include\/jasper\/jas_version.h\n@@ -68,6 +68,7 @@\n #ifndef JAS_VERSION_H\n #define JAS_VERSION_H\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n \n #ifdef __cplusplus\ndiff --git a\/src\/libjasper\/include\/jasper\/jasper.h b\/src\/libjasper\/include\/jasper\/jasper.h\nindex eb74ba0..fc544eb 100644\n--- a\/src\/libjasper\/include\/jasper\/jasper.h\n+++ b\/src\/libjasper\/include\/jasper\/jasper.h\n@@ -62,7 +62,9 @@\n #ifndef JAS_JASPER_H\n #define JAS_JASPER_H\n \n+\/* The configuration header file should be included first. *\/\n #include <jasper\/jas_config.h>\n+\n #include <jasper\/jas_types.h>\n #include <jasper\/jas_version.h>\n \ndiff --git a\/src\/libjasper\/jp2\/jp2_dec.c b\/src\/libjasper\/jp2\/jp2_dec.c\nindex 2996393..cb5f14f 100644\n--- a\/src\/libjasper\/jp2\/jp2_dec.c\n+++ b\/src\/libjasper\/jp2\/jp2_dec.c\n@@ -77,6 +77,7 @@\n #include \"jasper\/jas_debug.h\"\n #include \"jasper\/jas_malloc.h\"\n #include \"jasper\/jas_version.h\"\n+#include \"jasper\/jas_types.h\"\n \n #include \"jp2_cod.h\"\n #include \"jp2_dec.h\"\n@@ -225,7 +226,7 @@ jas_image_t *jp2_decode(jas_stream_t *in, char *optstr)\n \n \t\/* Does the number of components indicated in the IHDR box match\n \t  the value specified in the code stream? *\/\n-\tif (dec->ihdr->data.ihdr.numcmpts != JAS_CAST(uint,\n+\tif (dec->ihdr->data.ihdr.numcmpts != JAS_CAST(jas_uint,\n \t  jas_image_numcmpts(dec->image))) {\n \t\tjas_eprintf(\"warning: number of components mismatch\\n\");\n \t}\n@@ -239,7 +240,7 @@ jas_image_t *jp2_decode(jas_stream_t *in, char *optstr)\n \t\/* Determine if all components have the same data type. *\/\n \tsamedtype = true;\n \tdtype = jas_image_cmptdtype(dec->image, 0);\n-\tfor (i = 1; i < JAS_CAST(uint, jas_image_numcmpts(dec->image)); ++i) {\n+\tfor (i = 1; i < JAS_CAST(jas_uint, jas_image_numcmpts(dec->image)); ++i) {\n \t\tif (jas_image_cmptdtype(dec->image, i) != dtype) {\n \t\t\tsamedtype = false;\n \t\t\tbreak;\n@@ -262,14 +263,14 @@ jas_image_t *jp2_decode(jas_stream_t *in, char *optstr)\n \tif (dec->bpcc) {\n \t\t\/* Is the number of components indicated in the BPCC box\n \t\t  consistent with the code stream data? *\/\n-\t\tif (dec->bpcc->data.bpcc.numcmpts != JAS_CAST(uint, jas_image_numcmpts(\n+\t\tif (dec->bpcc->data.bpcc.numcmpts != JAS_CAST(jas_uint, jas_image_numcmpts(\n \t\t  dec->image))) {\n \t\t\tjas_eprintf(\"warning: number of components mismatch\\n\");\n \t\t}\n \t\t\/* Is the component data type information indicated in the BPCC\n \t\t  box consistent with the code stream data? *\/\n \t\tif (!samedtype) {\n-\t\t\tfor (i = 0; i < JAS_CAST(uint, jas_image_numcmpts(dec->image));\n+\t\t\tfor (i = 0; i < JAS_CAST(jas_uint, jas_image_numcmpts(dec->image));\n \t\t\t  ++i) {\n \t\t\t\tif (jas_image_cmptdtype(dec->image, i) !=\n \t\t\t\t  JP2_BPCTODTYPE(dec->bpcc->data.bpcc.bpcs[i])) {\n@@ -324,13 +325,13 @@ jas_image_t *jp2_decode(jas_stream_t *in, char *optstr)\n \t\/* Determine the number of channels (which is essentially the number\n \t  of components after any palette mappings have been applied). *\/\n \tdec->numchans = dec->cmap ? dec->cmap->data.cmap.numchans :\n-\t  JAS_CAST(uint, jas_image_numcmpts(dec->image));\n+\t  JAS_CAST(jas_uint, jas_image_numcmpts(dec->image));\n \n \t\/* Perform a basic sanity check on the CMAP box if present. *\/\n \tif (dec->cmap) {\n \t\tfor (i = 0; i < dec->numchans; ++i) {\n \t\t\t\/* Is the component number reasonable? *\/\n-\t\t\tif (dec->cmap->data.cmap.ents[i].cmptno >= JAS_CAST(uint,\n+\t\t\tif (dec->cmap->data.cmap.ents[i].cmptno >= JAS_CAST(jas_uint,\n \t\t\t  jas_image_numcmpts(dec->image))) {\n \t\t\t\tjas_eprintf(\"error: invalid component number in CMAP box\\n\");\n \t\t\t\tgoto error;\n@@ -391,7 +392,7 @@ jas_image_t *jp2_decode(jas_stream_t *in, char *optstr)\n \n \t\/* Mark all components as being of unknown type. *\/\n \n-\tfor (i = 0; i < JAS_CAST(uint, jas_image_numcmpts(dec->image)); ++i) {\n+\tfor (i = 0; i < JAS_CAST(jas_uint, jas_image_numcmpts(dec->image)); ++i) {\n \t\tjas_image_setcmpttype(dec->image, i, JAS_IMAGE_CT_UNKNOWN);\n \t}\n \ndiff --git a\/src\/libjasper\/jpc\/jpc_cs.c b\/src\/libjasper\/jpc\/jpc_cs.c\nindex e6a5503..cc66ddb 100644\n--- a\/src\/libjasper\/jpc\/jpc_cs.c\n+++ b\/src\/libjasper\/jpc\/jpc_cs.c\n@@ -289,7 +289,7 @@ jpc_ms_t *jpc_getms(jas_stream_t *in, jpc_cstate_t *cstate)\n \t\t\tjpc_ms_dump(ms, stderr);\n \t\t}\n \n-\t\tif (JAS_CAST(ulong, jas_stream_tell(tmpstream)) != ms->len) {\n+\t\tif (JAS_CAST(jas_ulong, jas_stream_tell(tmpstream)) != ms->len) {\n \t\t\tjas_eprintf(\n \t\t\t  \"warning: trailing garbage in marker segment (%ld bytes)\\n\",\n \t\t\t  ms->len - jas_stream_tell(tmpstream));\n@@ -1177,7 +1177,7 @@ static int jpc_ppm_getparms(jpc_ms_t *ms, jpc_cstate_t *cstate, jas_stream_t *in\n \t\tif (!(ppm->data = jas_malloc(ppm->len))) {\n \t\t\tgoto error;\n \t\t}\n-\t\tif (JAS_CAST(uint, jas_stream_read(in, ppm->data, ppm->len)) != ppm->len) {\n+\t\tif (JAS_CAST(jas_uint, jas_stream_read(in, ppm->data, ppm->len)) != ppm->len) {\n \t\t\tgoto error;\n \t\t}\n \t} else {\n@@ -1197,7 +1197,7 @@ static int jpc_ppm_putparms(jpc_ms_t *ms, jpc_cstate_t *cstate, jas_stream_t *ou\n \t\/* Eliminate compiler warning about unused variables. *\/\n \tcstate = 0;\n \n-\tif (JAS_CAST(uint, jas_stream_write(out, (char *) ppm->data, ppm->len)) != ppm->len) {\n+\tif (JAS_CAST(jas_uint, jas_stream_write(out, (char *) ppm->data, ppm->len)) != ppm->len) {\n \t\treturn -1;\n \t}\n \treturn 0;\ndiff --git a\/src\/libjasper\/jpc\/jpc_cs.h b\/src\/libjasper\/jpc\/jpc_cs.h\nindex 311986f..f2fbfee 100644\n--- a\/src\/libjasper\/jpc\/jpc_cs.h\n+++ b\/src\/libjasper\/jpc\/jpc_cs.h\n@@ -490,7 +490,7 @@ typedef struct {\n \tuint_fast16_t len;\n \n \t\/* The data. *\/\n-\tuchar *data;\n+\tjas_uchar *data;\n \n } jpc_ppm_t;\n \n@@ -529,7 +529,7 @@ typedef struct {\n \tuint_fast16_t len;\n \n \t\/* The data. *\/\n-\tuchar *data;\n+\tjas_uchar *data;\n \n } jpc_com_t;\n \n@@ -577,7 +577,7 @@ typedef struct {\n typedef struct {\n \n \t\/* The data. *\/\n-\tuchar *data;\n+\tjas_uchar *data;\n \n \t\/* The length. *\/\n \tuint_fast16_t len;\ndiff --git a\/src\/libjasper\/jpc\/jpc_dec.c b\/src\/libjasper\/jpc\/jpc_dec.c\nindex 28b29fe..58e101d 100644\n--- a\/src\/libjasper\/jpc\/jpc_dec.c\n+++ b\/src\/libjasper\/jpc\/jpc_dec.c\n@@ -2276,7 +2276,7 @@ int jpc_ppxstab_insert(jpc_ppxstab_t *tab, jpc_ppxstabent_t *ent)\n jpc_streamlist_t *jpc_ppmstabtostreams(jpc_ppxstab_t *tab)\n {\n \tjpc_streamlist_t *streams;\n-\tuchar *dataptr;\n+\tjas_uchar *dataptr;\n \tuint_fast32_t datacnt;\n \tuint_fast32_t tpcnt;\n \tjpc_ppxstabent_t *ent;\ndiff --git a\/src\/libjasper\/jpc\/jpc_dec.h b\/src\/libjasper\/jpc\/jpc_dec.h\nindex 2af98ca..81a1a50 100644\n--- a\/src\/libjasper\/jpc\/jpc_dec.h\n+++ b\/src\/libjasper\/jpc\/jpc_dec.h\n@@ -99,7 +99,7 @@ typedef struct {\n \tuint_fast32_t len;\n \n \t\/* The data. *\/\n-\tuchar *data;\n+\tjas_uchar *data;\n \n } jpc_ppxstabent_t;\n \ndiff --git a\/src\/libjasper\/jpc\/jpc_enc.c b\/src\/libjasper\/jpc\/jpc_enc.c\nindex 0a4c0ce..03a86ed 100644\n--- a\/src\/libjasper\/jpc\/jpc_enc.c\n+++ b\/src\/libjasper\/jpc\/jpc_enc.c\n@@ -961,7 +961,7 @@ startoff = jas_stream_getrwcount(enc->out);\n \tcom = &enc->mrk->parms.com;\n \tcom->len = JAS_CAST(uint_fast16_t, strlen(buf));\n \tcom->regid = JPC_COM_LATIN;\n-\tif (!(com->data = JAS_CAST(uchar *, jas_strdup(buf)))) {\n+\tif (!(com->data = JAS_CAST(jas_uchar *, jas_strdup(buf)))) {\n \t\tabort();\n \t}\n \tif (jpc_putms(enc->out, enc->cstate, enc->mrk)) {\ndiff --git a\/src\/libjasper\/jpc\/jpc_mqdec.h b\/src\/libjasper\/jpc\/jpc_mqdec.h\nindex 05bf735..2266769 100644\n--- a\/src\/libjasper\/jpc\/jpc_mqdec.h\n+++ b\/src\/libjasper\/jpc\/jpc_mqdec.h\n@@ -109,7 +109,7 @@ typedef struct {\n \tjas_stream_t *in;\n \n \t\/* The last character read. *\/\n-\tuchar inbuffer;\n+\tjas_uchar inbuffer;\n \n \t\/* The EOF indicator. *\/\n \tint eof;\ndiff --git a\/src\/libjasper\/jpg\/jpg_dec.c b\/src\/libjasper\/jpg\/jpg_dec.c\nindex 858f243..c4b3aa2 100644\n--- a\/src\/libjasper\/jpg\/jpg_dec.c\n+++ b\/src\/libjasper\/jpg\/jpg_dec.c\n@@ -80,6 +80,14 @@\n * Types.\n \\******************************************************************************\/\n \n+typedef struct {\n+\tsize_t max_samples;\n+} jpg_dec_importopts_t;\n+\n+typedef enum {\n+\tOPT_MAXSIZE,\n+} optid_t;\n+\n \/* JPEG decoder data sink type. *\/\n \n typedef struct jpg_dest_s {\n@@ -127,19 +135,11 @@ static int jpg_copystreamtofile(FILE *out, jas_stream_t *in);\n static jas_image_t *jpg_mkimage(j_decompress_ptr cinfo);\n \n \/******************************************************************************\\\n-*\n+* Option parsing.\n \\******************************************************************************\/\n \n-typedef struct {\n-\tsize_t max_size;\n-} jpg_dec_importopts_t;\n-\n-typedef enum {\n-\tOPT_MAXSIZE,\n-} optid_t;\n-\n static jas_taginfo_t decopts[] = {\n-\t{OPT_MAXSIZE, \"max_size\"},\n+\t{OPT_MAXSIZE, \"max_samples\"},\n \t{-1, 0}\n };\n \n@@ -147,7 +147,7 @@ static int jpg_dec_parseopts(char *optstr, jpg_dec_importopts_t *opts)\n {\n \tjas_tvparser_t *tvp;\n \n-\topts->max_size = 0;\n+\topts->max_samples = 64 * JAS_MEBI;\n \n \tif (!(tvp = jas_tvparser_create(optstr ? optstr : \"\"))) {\n \t\treturn -1;\n@@ -157,7 +157,7 @@ static int jpg_dec_parseopts(char *optstr, jpg_dec_importopts_t *opts)\n \t\tswitch (jas_taginfo_nonull(jas_taginfos_lookup(decopts,\n \t\t  jas_tvparser_gettag(tvp)))->id) {\n \t\tcase OPT_MAXSIZE:\n-\t\t\topts->max_size = atoi(jas_tvparser_getval(tvp));\n+\t\t\topts->max_samples = atoi(jas_tvparser_getval(tvp));\n \t\t\tbreak;\n \t\tdefault:\n \t\t\tjas_eprintf(\"warning: ignoring invalid option %s\\n\",\n@@ -188,7 +188,9 @@ jas_image_t *jpg_decode(jas_stream_t *in, char *optstr)\n \tjas_image_t *image;\n \tint ret;\n \tjpg_dec_importopts_t opts;\n-\tsize_t size;\n+\tsize_t num_samples;\n+\n+\tJAS_DBGLOG(100, (\"jpg_decode(%p, \\\"%s\\\")\\n\", in, optstr));\n \n \tif (jpg_dec_parseopts(optstr, &opts)) {\n \t\tgoto error;\n@@ -236,6 +238,18 @@ jas_image_t *jpg_decode(jas_stream_t *in, char *optstr)\n \t  cinfo.image_width, cinfo.image_height, cinfo.num_components)\n \t  );\n \n+\tif (opts.max_samples > 0) {\n+\t\tif (!jas_safe_size_mul3(cinfo.image_width, cinfo.image_height,\n+\t\t  cinfo.num_components, &num_samples)) {\n+\t\t\tgoto error;\n+\t\t}\n+\t\tif (num_samples > opts.max_samples) {\n+\t\t\tjas_eprintf(\"image is too large (%zu > %zu)\\n\", num_samples,\n+\t\t\t  opts.max_samples);\n+\t\t\tgoto error;\n+\t\t}\n+\t}\n+\n \t\/* Start the decompressor. *\/\n \tJAS_DBGLOG(10, (\"jpeg_start_decompress(%p)\\n\", &cinfo));\n \tret = jpeg_start_decompress(&cinfo);\n@@ -245,18 +259,6 @@ jas_image_t *jpg_decode(jas_stream_t *in, char *optstr)\n \t  cinfo.output_width, cinfo.output_height, cinfo.output_components)\n \t  );\n \n-\tif (opts.max_size) {\n-\t\tif (!jas_safe_size_mul(cinfo.output_width, cinfo.output_height,\n-\t\t  &size) ||\n-\t\t  !jas_safe_size_mul(size, cinfo.output_components, &size)) {\n-\t\t\tgoto error;\n-\t\t}\n-\t\tif (size > opts.max_size) {\n-\t\t\tjas_eprintf(\"image is too large\\n\");\n-\t\t\tgoto error;\n-\t\t}\n-\t}\n-\n \t\/* Create an image object to hold the decoded data. *\/\n \tif (!(image = jpg_mkimage(&cinfo))) {\n \t\tjas_eprintf(\"jpg_mkimage failed\\n\");\ndiff --git a\/src\/libjasper\/jpg\/jpg_val.c b\/src\/libjasper\/jpg\/jpg_val.c\nindex 338afaf..6222a69 100644\n--- a\/src\/libjasper\/jpg\/jpg_val.c\n+++ b\/src\/libjasper\/jpg\/jpg_val.c\n@@ -77,7 +77,7 @@\n \n int jpg_validate(jas_stream_t *in)\n {\n-\tuchar buf[JPG_MAGICLEN];\n+\tjas_uchar buf[JPG_MAGICLEN];\n \tint i;\n \tint n;\n \ndiff --git a\/src\/libjasper\/mif\/mif_cod.c b\/src\/libjasper\/mif\/mif_cod.c\nindex bfed68a..3303f59 100644\n--- a\/src\/libjasper\/mif\/mif_cod.c\n+++ b\/src\/libjasper\/mif\/mif_cod.c\n@@ -370,7 +370,7 @@ int mif_encode(jas_image_t *image, jas_stream_t *out, char *optstr)\n \n int mif_validate(jas_stream_t *in)\n {\n-\tuchar buf[MIF_MAGICLEN];\n+\tjas_uchar buf[MIF_MAGICLEN];\n \tuint_fast32_t magic;\n \tint i;\n \tint n;\n@@ -462,7 +462,7 @@ static int mif_hdr_growcmpts(mif_hdr_t *hdr, int maxcmpts)\n \n static mif_hdr_t *mif_hdr_get(jas_stream_t *in)\n {\n-\tuchar magicbuf[MIF_MAGICLEN];\n+\tjas_uchar magicbuf[MIF_MAGICLEN];\n \tchar buf[4096];\n \tmif_hdr_t *hdr;\n \tbool done;\ndiff --git a\/src\/libjasper\/pgx\/pgx_dec.c b\/src\/libjasper\/pgx\/pgx_dec.c\nindex 5a2e631..f6f8563 100644\n--- a\/src\/libjasper\/pgx\/pgx_dec.c\n+++ b\/src\/libjasper\/pgx\/pgx_dec.c\n@@ -151,7 +151,7 @@ jas_image_t *pgx_decode(jas_stream_t *in, char *optstr)\n \n int pgx_validate(jas_stream_t *in)\n {\n-\tuchar buf[PGX_MAGICLEN];\n+\tjas_uchar buf[PGX_MAGICLEN];\n \tuint_fast32_t magic;\n \tint i;\n \tint n;\n@@ -195,7 +195,7 @@ int pgx_validate(jas_stream_t *in)\n static int pgx_gethdr(jas_stream_t *in, pgx_hdr_t *hdr)\n {\n \tint c;\n-\tuchar buf[2];\n+\tjas_uchar buf[2];\n \n \tif ((c = jas_stream_getc(in)) == EOF) {\n \t\tgoto error;\ndiff --git a\/src\/libjasper\/pnm\/pnm_dec.c b\/src\/libjasper\/pnm\/pnm_dec.c\nindex 78e2b3a..526e10d 100644\n--- a\/src\/libjasper\/pnm\/pnm_dec.c\n+++ b\/src\/libjasper\/pnm\/pnm_dec.c\n@@ -180,7 +180,7 @@ jas_image_t *pnm_decode(jas_stream_t *in, char *opts)\n \n int pnm_validate(jas_stream_t *in)\n {\n-\tuchar buf[2];\n+\tjas_uchar buf[2];\n \tint i;\n \tint n;\n \ndiff --git a\/src\/libjasper\/ras\/ras_dec.c b\/src\/libjasper\/ras\/ras_dec.c\nindex 927883f..8200406 100644\n--- a\/src\/libjasper\/ras\/ras_dec.c\n+++ b\/src\/libjasper\/ras\/ras_dec.c\n@@ -185,7 +185,7 @@ jas_image_t *ras_decode(jas_stream_t *in, char *optstr)\n \n int ras_validate(jas_stream_t *in)\n {\n-\tuchar buf[RAS_MAGICLEN];\n+\tjas_uchar buf[RAS_MAGICLEN];\n \tint i;\n \tint n;\n \tuint_fast32_t magic;\ndiff --git a\/test\/bin\/run_test_1 b\/test\/bin\/run_test_1\nindex 7cc1663..6f38e08 100755\n--- a\/test\/bin\/run_test_1\n+++ b\/test\/bin\/run_test_1\n@@ -54,23 +54,29 @@ for in_file in \"${bad_list[@]}\"; do\n \tname=$(basename \"$in_file\")\n \techo \"############################################################\"\n \tcase \"$name\" in\n-\t2_crashes.bmp|jasper-doublefree-mem_close.jpg)\n+\t2_crashes.bmp)\n+\t\t#jasper-doublefree-mem_close.jpg\n \t\t# The file jasper-doublefree-mem_close.jpg must be skipped\n \t\t# since this test could pass or fail depending on the version of\n \t\t# the JPEG library used (and if it passes it will be VERY SLOW).\n+\t\t# Thie file 2_crashes.bmp must be skipped since it will try\n+\t\t# to allocate a huge palette which can cause an ASAN failure.\n \t\techo \"Skipping $in_file\"\n \t\tcontinue\n \t\t;;\n \tesac\n \n \techo \"Input file: $in_file\"\n+\timginfo_opts=()\n+\timginfo_opts+=(--max-samples 100000000)\n \tspecial_asan_options=()\n \tspecial_asan_options+=(exitcode=10)\n \tspecial_asan_options+=(allocator_may_return_null=true)\n \tspecial_asan_options+=(detect_leaks=false)\n \t#special_asan_options+=(soft_rss_limit_mb=1024)\n \texpected_status=1\n-\tASAN_OPTIONS=\"${special_asan_options[*]}\" \"$imginfo\" < \"$in_file\"\n+\tASAN_OPTIONS=\"${special_asan_options[*]}\" \\\n+\t  \"$imginfo\" \"${imginfo_opts[@]}\" < \"$in_file\"\n \tstatus=$?\n \techo \"actual exit status: $status\"\n \techo \"expected exit status: $expected_status\"\n","owner":"mdadams","repo":"jasper","source":"cve"},{"CVE_ID":"CVE-2016-5096","CWE_ID":"190","category":"security","commit_id":"abd159cce48f3e34f08e4751c568e09677d5ec9c","commit_message":"From abd159cce48f3e34f08e4751c568e09677d5ec9c Mon Sep 17 00:00:00 2001\nFrom: Stanislav Malyshev <stas@php.net>\nDate: Mon, 9 May 2016 21:55:29 -0700\nSubject: [PATCH] Fix bug #72114 - int\/size_t confusion in fread\n\n---\n ext\/standard\/file.c                   |  6 ++++++\n ext\/standard\/tests\/file\/bug72114.phpt | 12 ++++++++++++\n 2 files changed, 18 insertions(+)\n create mode 100644 ext\/standard\/tests\/file\/bug72114.phpt\n\n","diff_code":"diff --git a\/ext\/standard\/file.c b\/ext\/standard\/file.c\nindex 0abc022ca6b1..e39c84f1cd41 100644\n--- a\/ext\/standard\/file.c\n+++ b\/ext\/standard\/file.c\n@@ -1758,6 +1758,12 @@ PHPAPI PHP_FUNCTION(fread)\n \t\tRETURN_FALSE;\n \t}\n \n+\tif (len > INT_MAX) {\n+\t\t\/* string length is int in 5.x so we can not read more than int *\/\n+\t\tphp_error_docref(NULL TSRMLS_CC, E_WARNING, \"Length parameter must be no more than %d\", INT_MAX);\n+\t\tRETURN_FALSE;\n+\t}\n+\n \tZ_STRVAL_P(return_value) = emalloc(len + 1);\n \tZ_STRLEN_P(return_value) = php_stream_read(stream, Z_STRVAL_P(return_value), len);\n \ndiff --git a\/ext\/standard\/tests\/file\/bug72114.phpt b\/ext\/standard\/tests\/file\/bug72114.phpt\nnew file mode 100644\nindex 000000000000..5e591ee478e8\n--- \/dev\/null\n+++ b\/ext\/standard\/tests\/file\/bug72114.phpt\n@@ -0,0 +1,12 @@\n+--TEST--\n+Bug #72114 (Integer underflow \/ arbitrary null write in fread\/gzread)\n+--FILE--\n+<?php\n+ini_set('memory_limit', \"2500M\");\n+$fp = fopen(\"\/dev\/zero\", \"r\");\n+fread($fp, 2147483648);\n+?>\n+Done\n+--EXPECTF--\n+Warning: fread(): Length parameter must be no more than 2147483647 in %s\/bug72114.php on line %d\n+Done\n","owner":"php","repo":"php-src","source":"cve"},{"CVE_ID":"CVE-2018-8791","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2017-12177","CWE_ID":"190","category":"security","commit_id":"4ca68b878e851e2136c234f40a25008297d8d831","commit_message":"From 4ca68b878e851e2136c234f40a25008297d8d831 Mon Sep 17 00:00:00 2001\nFrom: Nathan Kidd <nkidd@opentext.com>\nDate: Fri, 9 Jan 2015 10:09:14 -0500\nSubject: dbe: Unvalidated variable-length request in ProcDbeGetVisualInfo\n (CVE-2017-12177)\n\nv2: Protect against integer overflow (Alan Coopersmith)\n\nReviewed-by: Alan Coopersmith <alan.coopersmith@oracle.com>\nReviewed-by: Jeremy Huddleston Sequoia <jeremyhu@apple.com>\nReviewed-by: Julien Cristau <jcristau@debian.org>\nSigned-off-by: Nathan Kidd <nkidd@opentext.com>\nSigned-off-by: Julien Cristau <jcristau@debian.org>\n---\n dbe\/dbe.c | 5 ++++-\n 1 file changed, 4 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/dbe\/dbe.c b\/dbe\/dbe.c\nindex 9a0c7a7..292a223 100644\n--- a\/dbe\/dbe.c\n+++ b\/dbe\/dbe.c\n@@ -574,6 +574,9 @@ ProcDbeGetVisualInfo(ClientPtr client)\n     XdbeScreenVisualInfo *pScrVisInfo;\n \n     REQUEST_AT_LEAST_SIZE(xDbeGetVisualInfoReq);\n+    if (stuff->n > UINT32_MAX \/ sizeof(CARD32))\n+        return BadLength;\n+    REQUEST_FIXED_SIZE(xDbeGetVisualInfoReq, stuff->n * sizeof(CARD32));\n \n     if (stuff->n > UINT32_MAX \/ sizeof(DrawablePtr))\n         return BadAlloc;\n@@ -924,7 +927,7 @@ SProcDbeSwapBuffers(ClientPtr client)\n \n     swapl(&stuff->n);\n     if (stuff->n > UINT32_MAX \/ sizeof(DbeSwapInfoRec))\n-        return BadAlloc;\n+        return BadLength;\n     REQUEST_FIXED_SIZE(xDbeSwapBuffersReq, stuff->n * sizeof(xDbeSwapInfo));\n \n     if (stuff->n != 0) {\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-5844","CWE_ID":"190","category":"security","commit_id":"3ad08e01b4d253c66ae56414886089684155af22","commit_message":"From 3ad08e01b4d253c66ae56414886089684155af22 Mon Sep 17 00:00:00 2001\nFrom: Tim Kientzle <kientzle@acm.org>\nDate: Sun, 19 Jun 2016 14:34:37 -0700\nSubject: [PATCH] Issue 717:  Fix integer overflow when computing location of\n volume descriptor\n\nThe multiplication here defaulted to 'int' but calculations\nof file positions should always use int64_t.  A simple cast\nsuffices to fix this since the base location is always 32 bits\nfor ISO, so multiplying by the sector size will never overflow\na 64-bit integer.\n---\n libarchive\/archive_read_support_format_iso9660.c | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/libarchive\/archive_read_support_format_iso9660.c b\/libarchive\/archive_read_support_format_iso9660.c\nindex 6934ceefe..f41ba3865 100644\n--- a\/libarchive\/archive_read_support_format_iso9660.c\n+++ b\/libarchive\/archive_read_support_format_iso9660.c\n@@ -1091,7 +1091,7 @@ choose_volume(struct archive_read *a, struct iso9660 *iso9660)\n \t\t\/* This condition is unlikely; by way of caution. *\/\n \t\tvd = &(iso9660->joliet);\n \n-\tskipsize = LOGICAL_BLOCK_SIZE * vd->location;\n+\tskipsize = LOGICAL_BLOCK_SIZE * (int64_t)vd->location;\n \tskipsize = __archive_read_consume(a, skipsize);\n \tif (skipsize < 0)\n \t\treturn ((int)skipsize);\n@@ -1129,7 +1129,7 @@ choose_volume(struct archive_read *a, struct iso9660 *iso9660)\n \t    && iso9660->seenJoliet) {\n \t\t\/* Switch reading data from primary to joliet. *\/\n \t\tvd = &(iso9660->joliet);\n-\t\tskipsize = LOGICAL_BLOCK_SIZE * vd->location;\n+\t\tskipsize = LOGICAL_BLOCK_SIZE * (int64_t)vd->location;\n \t\tskipsize -= iso9660->current_position;\n \t\tskipsize = __archive_read_consume(a, skipsize);\n \t\tif (skipsize < 0)\n","owner":"libarchive","repo":"libarchive","source":"cve"},{"CVE_ID":"CVE-2016-9083","CWE_ID":"190","category":"security","commit_id":"05692d7005a364add85c6e25a6c4447ce08f913a","commit_message":"From 05692d7005a364add85c6e25a6c4447ce08f913a Mon Sep 17 00:00:00 2001\nFrom: Vlad Tsyrklevich <vlad@tsyrklevich.net>\nDate: Wed, 12 Oct 2016 18:51:24 +0200\nSubject: [PATCH] vfio\/pci: Fix integer overflows, bitmask check\n\nThe VFIO_DEVICE_SET_IRQS ioctl did not sufficiently sanitize\nuser-supplied integers, potentially allowing memory corruption. This\npatch adds appropriate integer overflow checks, checks the range bounds\nfor VFIO_IRQ_SET_DATA_NONE, and also verifies that only single element\nin the VFIO_IRQ_SET_DATA_TYPE_MASK bitmask is set.\nVFIO_IRQ_SET_ACTION_TYPE_MASK is already correctly checked later in\nvfio_pci_set_irqs_ioctl().\n\nFurthermore, a kzalloc is changed to a kcalloc because the use of a\nkzalloc with an integer multiplication allowed an integer overflow\ncondition to be reached without this patch. kcalloc checks for overflow\nand should prevent a similar occurrence.\n\nSigned-off-by: Vlad Tsyrklevich <vlad@tsyrklevich.net>\nSigned-off-by: Alex Williamson <alex.williamson@redhat.com>\n---\n drivers\/vfio\/pci\/vfio_pci.c       | 33 ++++++++++++++++++++-----------\n drivers\/vfio\/pci\/vfio_pci_intrs.c |  2 +-\n 2 files changed, 22 insertions(+), 13 deletions(-)\n\n","diff_code":"diff --git a\/drivers\/vfio\/pci\/vfio_pci.c b\/drivers\/vfio\/pci\/vfio_pci.c\nindex d624a527777f6..031bc08d000d4 100644\n--- a\/drivers\/vfio\/pci\/vfio_pci.c\n+++ b\/drivers\/vfio\/pci\/vfio_pci.c\n@@ -829,8 +829,9 @@ static long vfio_pci_ioctl(void *device_data,\n \n \t} else if (cmd == VFIO_DEVICE_SET_IRQS) {\n \t\tstruct vfio_irq_set hdr;\n+\t\tsize_t size;\n \t\tu8 *data = NULL;\n-\t\tint ret = 0;\n+\t\tint max, ret = 0;\n \n \t\tminsz = offsetofend(struct vfio_irq_set, count);\n \n@@ -838,23 +839,31 @@ static long vfio_pci_ioctl(void *device_data,\n \t\t\treturn -EFAULT;\n \n \t\tif (hdr.argsz < minsz || hdr.index >= VFIO_PCI_NUM_IRQS ||\n+\t\t    hdr.count >= (U32_MAX - hdr.start) ||\n \t\t    hdr.flags & ~(VFIO_IRQ_SET_DATA_TYPE_MASK |\n \t\t\t\t  VFIO_IRQ_SET_ACTION_TYPE_MASK))\n \t\t\treturn -EINVAL;\n \n-\t\tif (!(hdr.flags & VFIO_IRQ_SET_DATA_NONE)) {\n-\t\t\tsize_t size;\n-\t\t\tint max = vfio_pci_get_irq_count(vdev, hdr.index);\n+\t\tmax = vfio_pci_get_irq_count(vdev, hdr.index);\n+\t\tif (hdr.start >= max || hdr.start + hdr.count > max)\n+\t\t\treturn -EINVAL;\n \n-\t\t\tif (hdr.flags & VFIO_IRQ_SET_DATA_BOOL)\n-\t\t\t\tsize = sizeof(uint8_t);\n-\t\t\telse if (hdr.flags & VFIO_IRQ_SET_DATA_EVENTFD)\n-\t\t\t\tsize = sizeof(int32_t);\n-\t\t\telse\n-\t\t\t\treturn -EINVAL;\n+\t\tswitch (hdr.flags & VFIO_IRQ_SET_DATA_TYPE_MASK) {\n+\t\tcase VFIO_IRQ_SET_DATA_NONE:\n+\t\t\tsize = 0;\n+\t\t\tbreak;\n+\t\tcase VFIO_IRQ_SET_DATA_BOOL:\n+\t\t\tsize = sizeof(uint8_t);\n+\t\t\tbreak;\n+\t\tcase VFIO_IRQ_SET_DATA_EVENTFD:\n+\t\t\tsize = sizeof(int32_t);\n+\t\t\tbreak;\n+\t\tdefault:\n+\t\t\treturn -EINVAL;\n+\t\t}\n \n-\t\t\tif (hdr.argsz - minsz < hdr.count * size ||\n-\t\t\t    hdr.start >= max || hdr.start + hdr.count > max)\n+\t\tif (size) {\n+\t\t\tif (hdr.argsz - minsz < hdr.count * size)\n \t\t\t\treturn -EINVAL;\n \n \t\t\tdata = memdup_user((void __user *)(arg + minsz),\ndiff --git a\/drivers\/vfio\/pci\/vfio_pci_intrs.c b\/drivers\/vfio\/pci\/vfio_pci_intrs.c\nindex c2e60893cd09a..1c46045b0e7fc 100644\n--- a\/drivers\/vfio\/pci\/vfio_pci_intrs.c\n+++ b\/drivers\/vfio\/pci\/vfio_pci_intrs.c\n@@ -256,7 +256,7 @@ static int vfio_msi_enable(struct vfio_pci_device *vdev, int nvec, bool msix)\n \tif (!is_irq_none(vdev))\n \t\treturn -EINVAL;\n \n-\tvdev->ctx = kzalloc(nvec * sizeof(struct vfio_pci_irq_ctx), GFP_KERNEL);\n+\tvdev->ctx = kcalloc(nvec, sizeof(struct vfio_pci_irq_ctx), GFP_KERNEL);\n \tif (!vdev->ctx)\n \t\treturn -ENOMEM;\n \n","owner":"torvalds","repo":"linux","source":"cve"},{"CVE_ID":"CVE-2016-6871","CWE_ID":"190","category":"security","commit_id":"c00fc9d3003eb06226b58b6a48555f1456ee2475","commit_message":"From c00fc9d3003eb06226b58b6a48555f1456ee2475 Mon Sep 17 00:00:00 2001\nFrom: \"mwilliams@fb.com\" <mwilliams@fb.com>\nDate: Mon, 1 Aug 2016 15:13:10 -0700\nSubject: [PATCH] Fix buffer overrun due to integer overflow in bcmath\n\nSummary: scale gets passed around as an int inside the library.\n\nReviewed By: mxw\n\nDifferential Revision: D3624520\n\nfbshipit-source-id: d39927413cec24fda2e475a296ad5d9019ccef0a\n---\n hphp\/runtime\/ext\/bcmath\/ext_bcmath.cpp        | 25 +++++++++++++------\n hphp\/test\/slow\/ext_bcmath\/bccomp_overflow.php |  7 ++++++\n ...\/ext_bcmath\/bccomp_overflow.php.expect     |  1 +\n 3 files changed, 25 insertions(+), 8 deletions(-)\n create mode 100644 hphp\/test\/slow\/ext_bcmath\/bccomp_overflow.php\n create mode 100644 hphp\/test\/slow\/ext_bcmath\/bccomp_overflow.php.expect\n\n","diff_code":"diff --git a\/hphp\/runtime\/ext\/bcmath\/ext_bcmath.cpp b\/hphp\/runtime\/ext\/bcmath\/ext_bcmath.cpp\nindex e9b3c9d2680..e5b037a6060 100644\n--- a\/hphp\/runtime\/ext\/bcmath\/ext_bcmath.cpp\n+++ b\/hphp\/runtime\/ext\/bcmath\/ext_bcmath.cpp\n@@ -39,6 +39,15 @@ static IMPLEMENT_THREAD_LOCAL(bcmath_data, s_globals);\n \n \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n \n+static int64_t adjust_scale(int64_t scale) {\n+  if (scale < 0) {\n+    scale = BCG(bc_precision);\n+    if (scale < 0) scale = 0;\n+  }\n+  if ((uint64_t)scale > StringData::MaxSize) return StringData::MaxSize;\n+  return scale;\n+}\n+\n static void php_str2num(bc_num *num, const char *str) {\n   const char *p;\n   if (!(p = strchr(str, '.'))) {\n@@ -55,7 +64,7 @@ static bool HHVM_FUNCTION(bcscale, int64_t scale) {\n \n static String HHVM_FUNCTION(bcadd, const String& left, const String& right,\n                             int64_t scale \/* = -1 *\/) {\n-  if (scale < 0) scale = BCG(bc_precision);\n+  scale = adjust_scale(scale);\n   bc_num first, second, result;\n   bc_init_num(&first);\n   bc_init_num(&second);\n@@ -75,7 +84,7 @@ static String HHVM_FUNCTION(bcadd, const String& left, const String& right,\n \n static String HHVM_FUNCTION(bcsub, const String& left, const String& right,\n                             int64_t scale \/* = -1 *\/) {\n-  if (scale < 0) scale = BCG(bc_precision);\n+  scale = adjust_scale(scale);\n   bc_num first, second, result;\n   bc_init_num(&first);\n   bc_init_num(&second);\n@@ -95,7 +104,7 @@ static String HHVM_FUNCTION(bcsub, const String& left, const String& right,\n \n static int64_t HHVM_FUNCTION(bccomp, const String& left, const String& right,\n                              int64_t scale \/* = -1 *\/) {\n-  if (scale < 0) scale = BCG(bc_precision);\n+  scale = adjust_scale(scale);\n   bc_num first, second;\n   bc_init_num(&first);\n   bc_init_num(&second);\n@@ -109,7 +118,7 @@ static int64_t HHVM_FUNCTION(bccomp, const String& left, const String& right,\n \n static String HHVM_FUNCTION(bcmul, const String& left, const String& right,\n                             int64_t scale \/* = -1 *\/) {\n-  if (scale < 0) scale = BCG(bc_precision);\n+  scale = adjust_scale(scale);\n   bc_num first, second, result;\n   bc_init_num(&first);\n   bc_init_num(&second);\n@@ -129,7 +138,7 @@ static String HHVM_FUNCTION(bcmul, const String& left, const String& right,\n \n static Variant HHVM_FUNCTION(bcdiv, const String& left, const String& right,\n                int64_t scale \/* = -1 *\/) {\n-  if (scale < 0) scale = BCG(bc_precision);\n+  scale = adjust_scale(scale);\n   bc_num first, second, result;\n   bc_init_num(&first);\n   bc_init_num(&second);\n@@ -171,7 +180,7 @@ static Variant HHVM_FUNCTION(bcmod, const String& left, const String& right) {\n \n static String HHVM_FUNCTION(bcpow, const String& left, const String& right,\n                            int64_t scale \/* = -1 *\/) {\n-  if (scale < 0) scale = BCG(bc_precision);\n+  scale = adjust_scale(scale);\n   bc_num first, second, result;\n   bc_init_num(&first);\n   bc_init_num(&second);\n@@ -193,7 +202,7 @@ static String HHVM_FUNCTION(bcpow, const String& left, const String& right,\n \n static Variant HHVM_FUNCTION(bcpowmod, const String& left, const String& right,\n                              const String& modulus, int64_t scale \/* = -1 *\/) {\n-  if (scale < 0) scale = BCG(bc_precision);\n+  scale = adjust_scale(scale);\n   bc_num first, second, mod, result;\n   bc_init_num(&first);\n   bc_init_num(&second);\n@@ -220,7 +229,7 @@ static Variant HHVM_FUNCTION(bcpowmod, const String& left, const String& right,\n \n static Variant HHVM_FUNCTION(bcsqrt, const String& operand,\n                              int64_t scale \/* = -1 *\/) {\n-  if (scale < 0) scale = BCG(bc_precision);\n+  scale = adjust_scale(scale);\n   bc_num result;\n   bc_init_num(&result);\n   SCOPE_EXIT {\ndiff --git a\/hphp\/test\/slow\/ext_bcmath\/bccomp_overflow.php b\/hphp\/test\/slow\/ext_bcmath\/bccomp_overflow.php\nnew file mode 100644\nindex 00000000000..5c5c419a2a3\n--- \/dev\/null\n+++ b\/hphp\/test\/slow\/ext_bcmath\/bccomp_overflow.php\n@@ -0,0 +1,7 @@\n+<?php\n+\n+$intMaxPre = PHP_INT_MAX - 1;\n+$stringNormal = 'abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n+\n+$number_bccomp_10 = bccomp(\"2015.5\", $stringNormal, $intMaxPre);\n+var_dump($number_bccomp_10);\ndiff --git a\/hphp\/test\/slow\/ext_bcmath\/bccomp_overflow.php.expect b\/hphp\/test\/slow\/ext_bcmath\/bccomp_overflow.php.expect\nnew file mode 100644\nindex 00000000000..82693695945\n--- \/dev\/null\n+++ b\/hphp\/test\/slow\/ext_bcmath\/bccomp_overflow.php.expect\n@@ -0,0 +1 @@\n+int(1)\n","owner":"facebook","repo":"hhvm","source":"cve"},{"CVE_ID":"CVE-2014-0143","CWE_ID":"190","category":"security","commit_id":"8f4754ede56e3f9ea3fd7207f4a7c4453e59285b","commit_message":"From 8f4754ede56e3f9ea3fd7207f4a7c4453e59285b Mon Sep 17 00:00:00 2001\nFrom: Kevin Wolf <kwolf@redhat.com>\nDate: Wed, 26 Mar 2014 13:06:02 +0100\nSubject: [PATCH] block: Limit request size (CVE-2014-0143)\n\nLimiting the size of a single request to INT_MAX not only fixes a\ndirect integer overflow in bdrv_check_request() (which would only\ntrigger bad behaviour with ridiculously huge images, as in close to\n2^64 bytes), but can also prevent overflows in all block drivers.\n\nSigned-off-by: Kevin Wolf <kwolf@redhat.com>\nReviewed-by: Max Reitz <mreitz@redhat.com>\nSigned-off-by: Stefan Hajnoczi <stefanha@redhat.com>\n---\n block.c | 4 ++++\n 1 file changed, 4 insertions(+)\n\n","diff_code":"diff --git a\/block.c b\/block.c\nindex acb70fd..7a90a1b 100644\n--- a\/block.c\n+++ b\/block.c\n@@ -2588,6 +2588,10 @@ static int bdrv_check_byte_request(BlockDriverState *bs, int64_t offset,\n static int bdrv_check_request(BlockDriverState *bs, int64_t sector_num,\n                               int nb_sectors)\n {\n+    if (nb_sectors > INT_MAX \/ BDRV_SECTOR_SIZE) {\n+        return -EIO;\n+    }\n+\n     return bdrv_check_byte_request(bs, sector_num * BDRV_SECTOR_SIZE,\n                                    nb_sectors * BDRV_SECTOR_SIZE);\n }\n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-7568","CWE_ID":"190","category":"security","commit_id":"2806adfdc27a94d333199345394d7c302952b95f","commit_message":"From 2806adfdc27a94d333199345394d7c302952b95f Mon Sep 17 00:00:00 2001\nFrom: trylab <trylab@users.noreply.github.com>\nDate: Tue, 6 Sep 2016 18:35:32 +0800\nSubject: [PATCH] Fix integer overflow in gdImageWebpCtx\n\nInteger overflow can be happened in expression gdImageSX(im) * 4 *\ngdImageSY(im). It could lead to heap buffer overflow in the following\ncode. This issue has been reported to the PHP Bug Tracking System. The\nproof-of-concept file will be supplied some days later. This issue was\ndiscovered by Ke Liu of Tencent's Xuanwu LAB.\n---\n src\/gd_webp.c | 8 ++++++++\n 1 file changed, 8 insertions(+)\n\n","diff_code":"diff --git a\/src\/gd_webp.c b\/src\/gd_webp.c\nindex 8eb4deef..98863992 100644\n--- a\/src\/gd_webp.c\n+++ b\/src\/gd_webp.c\n@@ -199,6 +199,14 @@ BGD_DECLARE(void) gdImageWebpCtx (gdImagePtr im, gdIOCtx * outfile, int quality)\n \t\tquality = 80;\n \t}\n \n+\tif (overflow2(gdImageSX(im), 4)) {\n+\t\treturn;\n+\t}\n+\n+\tif (overflow2(gdImageSX(im) * 4, gdImageSY(im))) {\n+\t\treturn;\n+\t}\n+\n \targb = (uint8_t *)gdMalloc(gdImageSX(im) * 4 * gdImageSY(im));\n \tif (!argb) {\n \t\treturn;\n","owner":"libgd","repo":"libgd","source":"cve"},{"CVE_ID":"CVE-2014-0143","CWE_ID":"190","category":"security","commit_id":"cab60de930684c33f67d4e32c7509b567f8c445b","commit_message":"From cab60de930684c33f67d4e32c7509b567f8c445b Mon Sep 17 00:00:00 2001\nFrom: Kevin Wolf <kwolf@redhat.com>\nDate: Wed, 26 Mar 2014 13:05:53 +0100\nSubject: [PATCH] qcow2: Fix new L1 table size check (CVE-2014-0143)\n\nThe size in bytes is assigned to an int later, so check that instead of\nthe number of entries.\n\nSigned-off-by: Kevin Wolf <kwolf@redhat.com>\nReviewed-by: Max Reitz <mreitz@redhat.com>\nSigned-off-by: Stefan Hajnoczi <stefanha@redhat.com>\n---\n block\/qcow2-cluster.c | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/block\/qcow2-cluster.c b\/block\/qcow2-cluster.c\nindex 9499df9..242e1f8 100644\n--- a\/block\/qcow2-cluster.c\n+++ b\/block\/qcow2-cluster.c\n@@ -55,7 +55,7 @@ int qcow2_grow_l1_table(BlockDriverState *bs, uint64_t min_size,\n         }\n     }\n \n-    if (new_l1_size > INT_MAX) {\n+    if (new_l1_size > INT_MAX \/ sizeof(uint64_t)) {\n         return -EFBIG;\n     }\n \n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-18043","CWE_ID":"190","category":"security","commit_id":"2098b073f398cd628c09c5a78537a6854e85830d","commit_message":"From 2098b073f398cd628c09c5a78537a6854e85830d Mon Sep 17 00:00:00 2001\nFrom: Eric Blake <eblake@redhat.com>\nDate: Thu, 14 Sep 2017 08:49:23 -0500\nSubject: [PATCH] osdep: Fix ROUND_UP(64-bit, 32-bit)\n\nWhen using bit-wise operations that exploit the power-of-two\nnature of the second argument of ROUND_UP(), we still need to\nensure that the mask is as wide as the first argument (done\nby using a ternary to force proper arithmetic promotion).\nUnpatched, ROUND_UP(2ULL*1024*1024*1024*1024, 512U) produces 0,\ninstead of the intended 2TiB, because negation of an unsigned\n32-bit quantity followed by widening to 64-bits does not\nsign-extend the mask.\n\nBroken since its introduction in commit 292c8e50 (v1.5.0).\nCallers that passed the same width type to both macro parameters,\nor that had other code to ensure the first parameter's maximum\nruntime value did not exceed the second parameter's width, are\nunaffected, but I did not audit to see which (if any) existing\nclients of the macro could trigger incorrect behavior (I found\nthe bug while adding a new use of the macro).\n\nWhile preparing the patch, checkpatch complained about poor\nspacing, so I also fixed that here and in the nearby DIV_ROUND_UP.\n\nCC: qemu-trivial@nongnu.org\nCC: qemu-stable@nongnu.org\nSigned-off-by: Eric Blake <eblake@redhat.com>\nReviewed-by: Laszlo Ersek <lersek@redhat.com>\nReviewed-by: Richard Henderson <richard.henderson@linaro.org>\nSigned-off-by: Michael Tokarev <mjt@tls.msk.ru>\n---\n include\/qemu\/osdep.h | 6 +++---\n 1 file changed, 3 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/include\/qemu\/osdep.h b\/include\/qemu\/osdep.h\nindex 72b75bf..9dd318a 100644\n--- a\/include\/qemu\/osdep.h\n+++ b\/include\/qemu\/osdep.h\n@@ -205,13 +205,13 @@ extern int daemon(int, int);\n \n \/* Round number up to multiple. Requires that d be a power of 2 (see\n  * QEMU_ALIGN_UP for a safer but slower version on arbitrary\n- * numbers) *\/\n+ * numbers); works even if d is a smaller type than n.  *\/\n #ifndef ROUND_UP\n-#define ROUND_UP(n,d) (((n) + (d) - 1) & -(d))\n+#define ROUND_UP(n, d) (((n) + (d) - 1) & -(0 ? (n) : (d)))\n #endif\n \n #ifndef DIV_ROUND_UP\n-#define DIV_ROUND_UP(n,d) (((n) + (d) - 1) \/ (d))\n+#define DIV_ROUND_UP(n, d) (((n) + (d) - 1) \/ (d))\n #endif\n \n \/*\n-- \n1.8.3.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2017-18187","CWE_ID":"190","category":"security","commit_id":"83c9f495ffe70c7dd280b41fdfd4881485a3bc28","commit_message":"From 83c9f495ffe70c7dd280b41fdfd4881485a3bc28 Mon Sep 17 00:00:00 2001\nFrom: Hanno Becker <hanno.becker@arm.com>\nDate: Mon, 26 Jun 2017 13:52:14 +0100\nSubject: [PATCH] Prevent bounds check bypass through overflow in PSK identity\n parsing\n\nThe check `if( *p + n > end )` in `ssl_parse_client_psk_identity` is\nunsafe because `*p + n` might overflow, thus bypassing the check. As\n`n` is a user-specified value up to 65K, this is relevant if the\nlibrary happens to be located in the last 65K of virtual memory.\n\nThis commit replaces the check by a safe version.\n---\n library\/ssl_srv.c | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/library\/ssl_srv.c b\/library\/ssl_srv.c\nindex f137c3dce6..97d7a9e80b 100644\n--- a\/library\/ssl_srv.c\n+++ b\/library\/ssl_srv.c\n@@ -3436,7 +3436,7 @@ static int ssl_parse_client_psk_identity( mbedtls_ssl_context *ssl, unsigned cha\n     \/*\n      * Receive client pre-shared key identity name\n      *\/\n-    if( *p + 2 > end )\n+    if( end - *p < 2 )\n     {\n         MBEDTLS_SSL_DEBUG_MSG( 1, ( \"bad client key exchange message\" ) );\n         return( MBEDTLS_ERR_SSL_BAD_HS_CLIENT_KEY_EXCHANGE );\n@@ -3445,7 +3445,7 @@ static int ssl_parse_client_psk_identity( mbedtls_ssl_context *ssl, unsigned cha\n     n = ( (*p)[0] << 8 ) | (*p)[1];\n     *p += 2;\n \n-    if( n < 1 || n > 65535 || *p + n > end )\n+    if( n < 1 || n > 65535 || n > (size_t) ( end - *p ) )\n     {\n         MBEDTLS_SSL_DEBUG_MSG( 1, ( \"bad client key exchange message\" ) );\n         return( MBEDTLS_ERR_SSL_BAD_HS_CLIENT_KEY_EXCHANGE );\n","owner":"polarssl","repo":"polarssl","source":"cve"},{"CVE_ID":"CVE-2016-9580","CWE_ID":"190","category":"security","commit_id":"cadff5fb6e73398de26a92e96d3d7cac893af255","commit_message":"From cadff5fb6e73398de26a92e96d3d7cac893af255 Mon Sep 17 00:00:00 2001\nFrom: szukw000 <szukw000@arcor.de>\nDate: Fri, 9 Dec 2016 08:29:55 +0100\nSubject: [PATCH] These changes repair bugs of #871 and #872\n\n---\n src\/bin\/jp2\/converttif.c | 107 +++++++++++++++++++++++++--------------\n 1 file changed, 70 insertions(+), 37 deletions(-)\n\n","diff_code":"diff --git a\/src\/bin\/jp2\/converttif.c b\/src\/bin\/jp2\/converttif.c\nindex 143d3be6f..c690f8bfd 100644\n--- a\/src\/bin\/jp2\/converttif.c\n+++ b\/src\/bin\/jp2\/converttif.c\n@@ -553,20 +553,18 @@ static void tif_32sto16u(const OPJ_INT32* pSrc, OPJ_UINT16* pDst, OPJ_SIZE_T len\n \n int imagetotif(opj_image_t * image, const char *outfile)\n {\n-\tint width, height;\n-\tint bps,adjust, sgnd;\n-\tint tiPhoto;\n+\tuint32 width, height, bps, tiPhoto;\n+\tint adjust, sgnd;\n \tTIFF *tif;\n \ttdata_t buf;\n-\ttsize_t strip_size;\n+\ttmsize_t strip_size, rowStride;\n \tOPJ_UINT32 i, numcomps;\n-\tOPJ_SIZE_T rowStride;\n \tOPJ_INT32* buffer32s = NULL;\n \tOPJ_INT32 const* planes[4];\n \tconvert_32s_PXCX cvtPxToCx = NULL;\n \tconvert_32sXXx_C1R cvt32sToTif = NULL;\n \n-\tbps = (int)image->comps[0].prec;\n+\tbps = (uint32)image->comps[0].prec;\n \tplanes[0] = image->comps[0].data;\n \t\n \tnumcomps = image->numcomps;\n@@ -674,13 +672,13 @@ int imagetotif(opj_image_t * image, const char *outfile)\n \t\t\tbreak;\n \t}\n \tsgnd = (int)image->comps[0].sgnd;\n-\tadjust = sgnd ? 1 << (image->comps[0].prec - 1) : 0;\n-\twidth   = (int)image->comps[0].w;\n-\theight  = (int)image->comps[0].h;\n+\tadjust = sgnd ? (int)(1 << (image->comps[0].prec - 1)) : 0;\n+\twidth   = (uint32)image->comps[0].w;\n+\theight  = (uint32)image->comps[0].h;\n \t\n \tTIFFSetField(tif, TIFFTAG_IMAGEWIDTH, width);\n \tTIFFSetField(tif, TIFFTAG_IMAGELENGTH, height);\n-\tTIFFSetField(tif, TIFFTAG_SAMPLESPERPIXEL, numcomps);\n+\tTIFFSetField(tif, TIFFTAG_SAMPLESPERPIXEL, (uint32)numcomps);\n \tTIFFSetField(tif, TIFFTAG_BITSPERSAMPLE, bps);\n \tTIFFSetField(tif, TIFFTAG_ORIENTATION, ORIENTATION_TOPLEFT);\n \tTIFFSetField(tif, TIFFTAG_PLANARCONFIG, PLANARCONFIG_CONTIG);\n@@ -688,8 +686,8 @@ int imagetotif(opj_image_t * image, const char *outfile)\n \tTIFFSetField(tif, TIFFTAG_ROWSPERSTRIP, 1);\n \t\n \tstrip_size = TIFFStripSize(tif);\n-\trowStride = ((OPJ_SIZE_T)width * numcomps * (OPJ_SIZE_T)bps + 7U) \/ 8U;\n-\tif (rowStride != (OPJ_SIZE_T)strip_size) {\n+\trowStride = (width * numcomps * bps + 7U) \/ 8U;\n+\tif (rowStride != strip_size) {\n \t\tfprintf(stderr, \"Invalid TIFF strip size\\n\");\n \t\tTIFFClose(tif);\n \t\treturn 1;\n@@ -699,7 +697,7 @@ int imagetotif(opj_image_t * image, const char *outfile)\n \t\tTIFFClose(tif);\n \t\treturn 1;\n \t}\n-\tbuffer32s = (OPJ_INT32 *)malloc((OPJ_SIZE_T)width * numcomps * sizeof(OPJ_INT32));\n+\tbuffer32s = (OPJ_INT32 *)malloc((OPJ_SIZE_T)(width * numcomps * sizeof(OPJ_INT32)));\n \tif (buffer32s == NULL) {\n \t\t_TIFFfree(buf);\n \t\tTIFFClose(tif);\n@@ -1211,20 +1209,19 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \tTIFF *tif;\n \ttdata_t buf;\n \ttstrip_t strip;\n-\ttsize_t strip_size;\n+\ttmsize_t strip_size;\n \tint j, currentPlane, numcomps = 0, w, h;\n \tOPJ_COLOR_SPACE color_space = OPJ_CLRSPC_UNKNOWN;\n \topj_image_cmptparm_t cmptparm[4]; \/* RGBA *\/\n \topj_image_t *image = NULL;\n \tint has_alpha = 0;\n-\tunsigned short tiBps, tiPhoto, tiSf, tiSpp, tiPC;\n-\tunsigned int tiWidth, tiHeight;\n+\tuint32 tiBps, tiPhoto, tiSf, tiSpp, tiPC, tiWidth, tiHeight;\n \tOPJ_BOOL is_cinema = OPJ_IS_CINEMA(parameters->rsiz);\n \tconvert_XXx32s_C1R cvtTifTo32s = NULL;\n \tconvert_32s_CXPX cvtCxToPx = NULL;\n \tOPJ_INT32* buffer32s = NULL;\n \tOPJ_INT32* planes[4];\n-\tOPJ_SIZE_T rowStride;\n+\ttmsize_t rowStride;\n \t\n \ttif = TIFFOpen(filename, \"r\");\n \t\n@@ -1243,22 +1240,35 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \tTIFFGetField(tif, TIFFTAG_SAMPLESPERPIXEL, &tiSpp);\n \tTIFFGetField(tif, TIFFTAG_PHOTOMETRIC, &tiPhoto);\n \tTIFFGetField(tif, TIFFTAG_PLANARCONFIG, &tiPC);\n-\tw= (int)tiWidth;\n-\th= (int)tiHeight;\n-\t\n-\tif(tiBps > 16U) {\n-\t\tfprintf(stderr,\"tiftoimage: Bits=%d, Only 1 to 16 bits implemented\\n\",tiBps);\n-\t\tfprintf(stderr,\"\\tAborting\\n\");\n+\n+\tif(tiSpp == 0 || tiSpp > 4) { \/* should be 1 ... 4 *\/\n+\t\tfprintf(stderr,\"tiftoimage: Bad value for samples per pixel == %hu.\\n\"\n+\t\t \"\\tAborting.\\n\", tiSpp);\n+\t\tTIFFClose(tif);\n+\t\treturn NULL;\n+\t}\n+\tif(tiBps > 16U || tiBps == 0) {\n+\t\tfprintf(stderr,\"tiftoimage: Bad values for Bits == %d.\\n\"\n+\t\t \"\\tMax. 16 Bits are allowed here.\\n\\tAborting.\\n\",tiBps);\n \t\tTIFFClose(tif);\n \t\treturn NULL;\n \t}\n \tif(tiPhoto != PHOTOMETRIC_MINISBLACK && tiPhoto != PHOTOMETRIC_RGB) {\n-\t\tfprintf(stderr,\"tiftoimage: Bad color format %d.\\n\\tOnly RGB(A) and GRAY(A) has been implemented\\n\",(int) tiPhoto);\n+\t\tfprintf(stderr,\"tiftoimage: Bad color format %d.\\n\"\n+\t\t \"\\tOnly RGB(A) and GRAY(A) has been implemented\\n\",(int) tiPhoto);\n \t\tfprintf(stderr,\"\\tAborting\\n\");\n \t\tTIFFClose(tif);\n \t\treturn NULL;\n \t}\n-\t\n+\tif(tiWidth == 0 || tiHeight == 0) {\n+\t\tfprintf(stderr,\"tiftoimage: Bad values for width(%u) \"\n+\t\t \"and\/or height(%u)\\n\\tAborting.\\n\",tiWidth,tiHeight);\n+\t\tTIFFClose(tif);\n+\t\treturn NULL;\n+\t}\n+\tw= (int)tiWidth;\n+\th= (int)tiHeight;\n+\n \tswitch (tiBps) {\n \t\tcase 1:\n \t\tcase 2:\n@@ -1312,7 +1322,7 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \t\t\n \t\tTIFFGetFieldDefaulted(tif, TIFFTAG_EXTRASAMPLES,\n \t\t\t\t\t\t\t\t\t\t\t\t\t&extrasamples, &sampleinfo);\n-\t\t\n+\n \t\tif(extrasamples >= 1)\n \t\t{\n \t\t\tswitch(sampleinfo[0])\n@@ -1333,7 +1343,7 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \t\telse \/* extrasamples == 0 *\/\n \t\t\tif(tiSpp == 4 || tiSpp == 2) has_alpha = 1;\n \t}\n-\t\n+\n \t\/* initialize image components *\/\n \tmemset(&cmptparm[0], 0, 4 * sizeof(opj_image_cmptparm_t));\n \t\n@@ -1346,7 +1356,7 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \t} else {\n \t\tis_cinema = 0U;\n \t}\n-\t\n+\n \tif(tiPhoto == PHOTOMETRIC_RGB) \/* RGB(A) *\/\n \t{\n \t\tnumcomps = 3 + has_alpha;\n@@ -1384,10 +1394,24 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \timage->x0 = (OPJ_UINT32)parameters->image_offset_x0;\n \timage->y0 = (OPJ_UINT32)parameters->image_offset_y0;\n \timage->x1 =\t!image->x0 ? (OPJ_UINT32)(w - 1) * (OPJ_UINT32)subsampling_dx + 1 :\n-\timage->x0 + (OPJ_UINT32)(w - 1) * (OPJ_UINT32)subsampling_dx + 1;\n+\t image->x0 + (OPJ_UINT32)(w - 1) * (OPJ_UINT32)subsampling_dx + 1;\n+\tif(image->x1 <= image->x0) {\n+\t\tfprintf(stderr,\"tiftoimage: Bad value for image->x1(%d) vs. \"\n+\t\t \"image->x0(%d)\\n\\tAborting.\\n\",image->x1,image->x0);\n+\t\tTIFFClose(tif);\n+\t\topj_image_destroy(image);\n+\t\treturn NULL;\n+\t}\n \timage->y1 =\t!image->y0 ? (OPJ_UINT32)(h - 1) * (OPJ_UINT32)subsampling_dy + 1 :\n-\timage->y0 + (OPJ_UINT32)(h - 1) * (OPJ_UINT32)subsampling_dy + 1;\n-\n+\t image->y0 + (OPJ_UINT32)(h - 1) * (OPJ_UINT32)subsampling_dy + 1;\n+\tif(image->y1 <= image->y0) {\n+\t\tfprintf(stderr,\"tiftoimage: Bad value for image->y1(%d) vs. \"\n+\t\t \"image->y0(%d)\\n\\tAborting.\\n\",image->y1,image->y0);\n+\t\tTIFFClose(tif);\n+\t\topj_image_destroy(image);\n+\t\treturn NULL;\n+\t}\n+\t\n \tfor(j = 0; j < numcomps; j++)\n \t{\n \t\tplanes[j] = image->comps[j].data;\n@@ -1395,15 +1419,15 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \timage->comps[numcomps - 1].alpha = (OPJ_UINT16)(1 - (numcomps & 1));\n \t\t\n \tstrip_size = TIFFStripSize(tif);\n-\t\n+\n \tbuf = _TIFFmalloc(strip_size);\n \tif (buf == NULL) {\n \t\tTIFFClose(tif);\n \t\topj_image_destroy(image);\n \t\treturn NULL;\n \t}\n-\trowStride = ((OPJ_SIZE_T)w * tiSpp * tiBps + 7U) \/ 8U;\n-\tbuffer32s = (OPJ_INT32 *)malloc((OPJ_SIZE_T)w * tiSpp * sizeof(OPJ_INT32));\n+\trowStride = (w * tiSpp * tiBps + 7U) \/ 8U;\n+\tbuffer32s = (OPJ_INT32 *)malloc((OPJ_SIZE_T)(w * tiSpp * sizeof(OPJ_INT32)));\n \tif (buffer32s == NULL) {\n \t\t_TIFFfree(buf);\n \t\tTIFFClose(tif);\n@@ -1421,11 +1445,20 @@ opj_image_t* tiftoimage(const char *filename, opj_cparameters_t *parameters)\n \t\tfor(; (h > 0) && (strip < TIFFNumberOfStrips(tif)); strip++)\n \t\t{\n \t\t\t\tconst OPJ_UINT8 *dat8;\n-\t\t\t\tOPJ_SIZE_T ssize;\n+\t\t\t\ttmsize_t ssize;\n \t\t\t\t\n-\t\t\t\tssize = (OPJ_SIZE_T)TIFFReadEncodedStrip(tif, strip, buf, strip_size);\n+\t\t\t\tssize = TIFFReadEncodedStrip(tif, strip, buf, strip_size);\n+\t\t\t\tif(ssize < 1 || ssize > strip_size) {\n+\t\t\t\t\tfprintf(stderr,\"tiftoimage: Bad value for ssize(%ld) \"\n+                     \"vs. strip_size(%ld).\\n\\tAborting.\\n\",ssize,strip_size);\n+\t\t\t\t\t_TIFFfree(buf);\n+\t\t\t\t\t_TIFFfree(buffer32s);\n+\t\t\t\t\tTIFFClose(tif);\n+\t\t\t\t\topj_image_destroy(image);\n+\t\t\t\t\treturn NULL;\n+\t\t\t\t}\n \t\t\t\tdat8 = (const OPJ_UINT8*)buf;\n-\t\t\t\t\n+\n \t\t\t\twhile (ssize >= rowStride) {\n \t\t\t\t\tcvtTifTo32s(dat8, buffer32s, (OPJ_SIZE_T)w * tiSpp);\n \t\t\t\t\tcvtCxToPx(buffer32s, planes, (OPJ_SIZE_T)w);\n","owner":"szukw000","repo":"openjpeg","source":"cve"},{"CVE_ID":"CVE-2018-13785","CWE_ID":"190","category":"security","commit_id":"8a05766cb74af05c04c53e6c9d60c13fc4d59bf2","commit_message":"From 8a05766cb74af05c04c53e6c9d60c13fc4d59bf2 Mon Sep 17 00:00:00 2001\nFrom: Cosmin Truta <ctruta@gmail.com>\nDate: Sun, 17 Jun 2018 22:56:29 -0400\nSubject: [PATCH] [libpng16] Fix the calculation of row_factor in\n png_check_chunk_length\n\n(Bug report by Thuan Pham, SourceForge issue #278)\n---\n pngrutil.c | 9 ++++++---\n 1 file changed, 6 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/pngrutil.c b\/pngrutil.c\nindex 95571b517..5ba995abf 100644\n--- a\/pngrutil.c\n+++ b\/pngrutil.c\n@@ -3167,10 +3167,13 @@ png_check_chunk_length(png_const_structrp png_ptr, const png_uint_32 length)\n    {\n       png_alloc_size_t idat_limit = PNG_UINT_31_MAX;\n       size_t row_factor =\n-         (png_ptr->width * png_ptr->channels * (png_ptr->bit_depth > 8? 2: 1)\n-          + 1 + (png_ptr->interlaced? 6: 0));\n+         (size_t)png_ptr->width\n+         * (size_t)png_ptr->channels\n+         * (png_ptr->bit_depth > 8? 2: 1)\n+         + 1\n+         + (png_ptr->interlaced? 6: 0);\n       if (png_ptr->height > PNG_UINT_32_MAX\/row_factor)\n-         idat_limit=PNG_UINT_31_MAX;\n+         idat_limit = PNG_UINT_31_MAX;\n       else\n          idat_limit = png_ptr->height * row_factor;\n       row_factor = row_factor > 32566? 32566 : row_factor;\n","owner":"glennrp","repo":"libpng","source":"cve"},{"CVE_ID":"CVE-2017-18233","CWE_ID":"190","category":"security","commit_id":"65a8492832b7335ffabd01f5f64d89dec757c260","commit_message":"From 65a8492832b7335ffabd01f5f64d89dec757c260 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Hubert=20Figui=C3=A8re?= <hub@figuiere.net>\nDate: Mon, 14 Aug 2017 23:57:51 -0400\nSubject: Bug 102151 - RIFF: fix an infinite loop cause by an overflow\n\n---\n XMPFiles\/source\/FormatSupport\/RIFF.cpp | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\n","diff_code":"diff --git a\/XMPFiles\/source\/FormatSupport\/RIFF.cpp b\/XMPFiles\/source\/FormatSupport\/RIFF.cpp\nindex 4d9a0c1..93a318c 100644\n--- a\/XMPFiles\/source\/FormatSupport\/RIFF.cpp\n+++ b\/XMPFiles\/source\/FormatSupport\/RIFF.cpp\n@@ -167,7 +167,8 @@ Chunk::Chunk( ContainerChunk* parent, RIFF_MetaHandler* handler, bool skip, Chun\n \n \tthis->oldPos = file->Offset();\n \tthis->id = XIO::ReadUns32_LE( file );\n-\tthis->oldSize = XIO::ReadUns32_LE( file ) + 8;\n+\tthis->oldSize = XIO::ReadUns32_LE( file );\n+\tthis->oldSize += 8;\n \n \t\/\/ Make sure the size is within expected bounds.\n \tXMP_Int64 chunkEnd = this->oldPos + this->oldSize;\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-10168","CWE_ID":"190","category":"security","commit_id":"69d2fd2c597ffc0c217de1238b9bf4d4bceba8e6","commit_message":"From 69d2fd2c597ffc0c217de1238b9bf4d4bceba8e6 Mon Sep 17 00:00:00 2001\nFrom: \"Christoph M. Becker\" <cmbecker69@gmx.de>\nDate: Sat, 17 Dec 2016 17:06:58 +0100\nSubject: [PATCH] Fix #354: Signed Integer Overflow gd_io.c\n\nGD2 stores the number of horizontal and vertical chunks as words (i.e. 2\nbyte unsigned). These values are multiplied and assigned to an int when\nreading the image, what can cause integer overflows. We have to avoid\nthat, and also make sure that either chunk count is actually greater\nthan zero. If illegal chunk counts are detected, we bail out from\nreading the image.\n---\n src\/gd_gd2.c             |   4 ++++\n tests\/gd2\/.gitignore     |   1 +\n tests\/gd2\/CMakeLists.txt |   1 +\n tests\/gd2\/Makemodule.am  |   3 +++\n tests\/gd2\/bug00354.c     |  32 ++++++++++++++++++++++++++++++++\n tests\/gd2\/bug00354a.gd2  | Bin 0 -> 92 bytes\n tests\/gd2\/bug00354b.gd2  | Bin 0 -> 18 bytes\n 7 files changed, 41 insertions(+)\n create mode 100644 tests\/gd2\/bug00354.c\n create mode 100644 tests\/gd2\/bug00354a.gd2\n create mode 100644 tests\/gd2\/bug00354b.gd2\n\n","diff_code":"diff --git a\/src\/gd_gd2.c b\/src\/gd_gd2.c\nindex d07828c7..c2904caf 100644\n--- a\/src\/gd_gd2.c\n+++ b\/src\/gd_gd2.c\n@@ -209,6 +209,10 @@ _gd2GetHeader (gdIOCtxPtr in, int *sx, int *sy,\n \tGD2_DBG (printf (\"%d Chunks vertically\\n\", *ncy));\n \n \tif (gd2_compressed (*fmt)) {\n+\t\tif (*ncx <= 0 || *ncy <= 0 || *ncx > INT_MAX \/ *ncy) {\n+\t\t\tGD2_DBG(printf (\"Illegal chunk counts: %d * %d\\n\", *ncx, *ncy));\n+\t\t\tgoto fail1;\n+\t\t}\n \t\tnc = (*ncx) * (*ncy);\n \n \t\tGD2_DBG (printf (\"Reading %d chunk index entries\\n\", nc));\ndiff --git a\/tests\/gd2\/.gitignore b\/tests\/gd2\/.gitignore\nindex 39d8bf4e..8d3ee850 100644\n--- a\/tests\/gd2\/.gitignore\n+++ b\/tests\/gd2\/.gitignore\n@@ -1,5 +1,6 @@\n \/bug_289\n \/bug00309\n+\/bug00354\n \/gd2_empty_file\n \/gd2_im2im\n \/gd2_null\ndiff --git a\/tests\/gd2\/CMakeLists.txt b\/tests\/gd2\/CMakeLists.txt\nindex 5a61d113..36de5737 100644\n--- a\/tests\/gd2\/CMakeLists.txt\n+++ b\/tests\/gd2\/CMakeLists.txt\n@@ -1,6 +1,7 @@\n LIST(APPEND TESTS_FILES\n \tbug_289\n \tbug00309\n+\tbug00354\n \tgd2_empty_file\n \tgd2_im2im\n \tgd2_null\ndiff --git a\/tests\/gd2\/Makemodule.am b\/tests\/gd2\/Makemodule.am\nindex c1fbf440..0322bd02 100644\n--- a\/tests\/gd2\/Makemodule.am\n+++ b\/tests\/gd2\/Makemodule.am\n@@ -1,6 +1,7 @@\n libgd_test_programs += \\\n \tgd2\/bug_289 \\\n \tgd2\/bug00309 \\\n+\tgd2\/bug00354 \\\n \tgd2\/gd2_empty_file \\\n \tgd2\/php_bug_72339 \\\n \tgd2\/gd2_read_corrupt \\\n@@ -19,6 +20,8 @@ endif\n \n EXTRA_DIST += \\\n \tgd2\/CMakeLists.txt \\\n+\tgd2\/bug00354a.gd2 \\\n+\tgd2\/bug00354b.gd2 \\\n \tgd2\/conv_gd2_exp.gd2 \\\n \tgd2\/conv_test.gd2 \\\n \tgd2\/conv_test_exp.png \\\ndiff --git a\/tests\/gd2\/bug00354.c b\/tests\/gd2\/bug00354.c\nnew file mode 100644\nindex 00000000..cc64254d\n--- \/dev\/null\n+++ b\/tests\/gd2\/bug00354.c\n@@ -0,0 +1,32 @@\n+\/**\n+ * We're testing GD2 image files which report illegal chunk counts. These should\n+ * not cause integer overflows or other issues, but instead simply fail to be\n+ * loaded.\n+ *\n+ * See also <https:\/\/github.com\/libgd\/libgd\/issues\/354>.\n+ *\/\n+\n+\n+#include \"gd.h\"\n+#include \"gdtest.h\"\n+\n+\n+int main()\n+{\n+    gdImagePtr im;\n+    FILE *fp;\n+\n+    fp = gdTestFileOpen2(\"gd2\", \"bug00354a.gd2\");\n+    gdTestAssert(fp != NULL);\n+    im = gdImageCreateFromGd2(fp);\n+    gdTestAssert(im == NULL);\n+    fclose(fp);\n+\n+    fp = gdTestFileOpen2(\"gd2\", \"bug00354b.gd2\");\n+    gdTestAssert(fp != NULL);\n+    im = gdImageCreateFromGd2(fp);\n+    gdTestAssert(im == NULL);\n+    fclose(fp);\n+\n+    return gdNumFailures();\n+}\ndiff --git a\/tests\/gd2\/bug00354a.gd2 b\/tests\/gd2\/bug00354a.gd2\nnew file mode 100644\nindex 0000000000000000000000000000000000000000..5060bfde3aad5687c0a962a8eddf86c0a83dded9\nGIT binary patch\nliteral 92\nzcmYdKF=Aj~Vn_kP1_qY@zyAMbU|^63Vq3=lKu|H~?Lk9EAotLMul{dSxfcMLM1ThA\nIISver0HbRYrvLx|\n\nliteral 0\nHcmV?d00001\n\ndiff --git a\/tests\/gd2\/bug00354b.gd2 b\/tests\/gd2\/bug00354b.gd2\nnew file mode 100644\nindex 0000000000000000000000000000000000000000..8600126becb28c0962812c00fc6f2919b9f2ba80\nGIT binary patch\nliteral 18\nVcmYdKF=Aj~G5`XG1`y4_001560-^u_\n\nliteral 0\nHcmV?d00001\n\n","owner":"libgd","repo":"libgd","source":"cve"},{"CVE_ID":"CVE-2019-11477","CWE_ID":"190","category":"security","commit_id":"3b4929f65b0d8249f19a50245cd88ed1a2f78cff","commit_message":"From 3b4929f65b0d8249f19a50245cd88ed1a2f78cff Mon Sep 17 00:00:00 2001\nFrom: Eric Dumazet <edumazet@google.com>\nDate: Fri, 17 May 2019 17:17:22 -0700\nSubject: tcp: limit payload size of sacked skbs\n\nJonathan Looney reported that TCP can trigger the following crash\nin tcp_shifted_skb() :\n\n\tBUG_ON(tcp_skb_pcount(skb) < pcount);\n\nThis can happen if the remote peer has advertized the smallest\nMSS that linux TCP accepts : 48\n\nAn skb can hold 17 fragments, and each fragment can hold 32KB\non x86, or 64KB on PowerPC.\n\nThis means that the 16bit witdh of TCP_SKB_CB(skb)->tcp_gso_segs\ncan overflow.\n\nNote that tcp_sendmsg() builds skbs with less than 64KB\nof payload, so this problem needs SACK to be enabled.\nSACK blocks allow TCP to coalesce multiple skbs in the retransmit\nqueue, thus filling the 17 fragments to maximal capacity.\n\nCVE-2019-11477 -- u16 overflow of TCP_SKB_CB(skb)->tcp_gso_segs\n\nFixes: 832d11c5cd07 (\"tcp: Try to restore large SKBs while SACK processing\")\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nReported-by: Jonathan Looney <jtl@netflix.com>\nAcked-by: Neal Cardwell <ncardwell@google.com>\nReviewed-by: Tyler Hicks <tyhicks@canonical.com>\nCc: Yuchung Cheng <ycheng@google.com>\nCc: Bruce Curtis <brucec@netflix.com>\nCc: Jonathan Lemon <jonathan.lemon@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n---\n include\/linux\/tcp.h   |  4 ++++\n include\/net\/tcp.h     |  2 ++\n net\/ipv4\/tcp.c        |  1 +\n net\/ipv4\/tcp_input.c  | 26 ++++++++++++++++++++------\n net\/ipv4\/tcp_output.c |  6 +++---\n 5 files changed, 30 insertions(+), 9 deletions(-)\n\n","diff_code":"diff --git a\/include\/linux\/tcp.h b\/include\/linux\/tcp.h\nindex 711361af9ce0..9a478a0cd3a2 100644\n--- a\/include\/linux\/tcp.h\n+++ b\/include\/linux\/tcp.h\n@@ -484,4 +484,8 @@ static inline u16 tcp_mss_clamp(const struct tcp_sock *tp, u16 mss)\n \n \treturn (user_mss && user_mss < mss) ? user_mss : mss;\n }\n+\n+int tcp_skb_shift(struct sk_buff *to, struct sk_buff *from, int pcount,\n+\t\t  int shiftlen);\n+\n #endif\t\/* _LINUX_TCP_H *\/\ndiff --git a\/include\/net\/tcp.h b\/include\/net\/tcp.h\nindex ac2f53fbfa6b..582c0caa9811 100644\n--- a\/include\/net\/tcp.h\n+++ b\/include\/net\/tcp.h\n@@ -51,6 +51,8 @@ void tcp_time_wait(struct sock *sk, int state, int timeo);\n \n #define MAX_TCP_HEADER\t(128 + MAX_HEADER)\n #define MAX_TCP_OPTION_SPACE 40\n+#define TCP_MIN_SND_MSS\t\t48\n+#define TCP_MIN_GSO_SIZE\t(TCP_MIN_SND_MSS - MAX_TCP_OPTION_SPACE)\n \n \/*\n  * Never offer a window over 32767 without using window scaling. Some\ndiff --git a\/net\/ipv4\/tcp.c b\/net\/ipv4\/tcp.c\nindex f12d500ec85c..79666ef8c2e2 100644\n--- a\/net\/ipv4\/tcp.c\n+++ b\/net\/ipv4\/tcp.c\n@@ -3868,6 +3868,7 @@ void __init tcp_init(void)\n \tunsigned long limit;\n \tunsigned int i;\n \n+\tBUILD_BUG_ON(TCP_MIN_SND_MSS <= MAX_TCP_OPTION_SPACE);\n \tBUILD_BUG_ON(sizeof(struct tcp_skb_cb) >\n \t\t     FIELD_SIZEOF(struct sk_buff, cb));\n \ndiff --git a\/net\/ipv4\/tcp_input.c b\/net\/ipv4\/tcp_input.c\nindex 38dfc308c0fb..d95ee40df6c2 100644\n--- a\/net\/ipv4\/tcp_input.c\n+++ b\/net\/ipv4\/tcp_input.c\n@@ -1302,7 +1302,7 @@ static bool tcp_shifted_skb(struct sock *sk, struct sk_buff *prev,\n \tTCP_SKB_CB(skb)->seq += shifted;\n \n \ttcp_skb_pcount_add(prev, pcount);\n-\tBUG_ON(tcp_skb_pcount(skb) < pcount);\n+\tWARN_ON_ONCE(tcp_skb_pcount(skb) < pcount);\n \ttcp_skb_pcount_add(skb, -pcount);\n \n \t\/* When we're adding to gso_segs == 1, gso_size will be zero,\n@@ -1368,6 +1368,21 @@ static int skb_can_shift(const struct sk_buff *skb)\n \treturn !skb_headlen(skb) && skb_is_nonlinear(skb);\n }\n \n+int tcp_skb_shift(struct sk_buff *to, struct sk_buff *from,\n+\t\t  int pcount, int shiftlen)\n+{\n+\t\/* TCP min gso_size is 8 bytes (TCP_MIN_GSO_SIZE)\n+\t * Since TCP_SKB_CB(skb)->tcp_gso_segs is 16 bits, we need\n+\t * to make sure not storing more than 65535 * 8 bytes per skb,\n+\t * even if current MSS is bigger.\n+\t *\/\n+\tif (unlikely(to->len + shiftlen >= 65535 * TCP_MIN_GSO_SIZE))\n+\t\treturn 0;\n+\tif (unlikely(tcp_skb_pcount(to) + pcount > 65535))\n+\t\treturn 0;\n+\treturn skb_shift(to, from, shiftlen);\n+}\n+\n \/* Try collapsing SACK blocks spanning across multiple skbs to a single\n  * skb.\n  *\/\n@@ -1473,7 +1488,7 @@ static struct sk_buff *tcp_shift_skb_data(struct sock *sk, struct sk_buff *skb,\n \tif (!after(TCP_SKB_CB(skb)->seq + len, tp->snd_una))\n \t\tgoto fallback;\n \n-\tif (!skb_shift(prev, skb, len))\n+\tif (!tcp_skb_shift(prev, skb, pcount, len))\n \t\tgoto fallback;\n \tif (!tcp_shifted_skb(sk, prev, skb, state, pcount, len, mss, dup_sack))\n \t\tgoto out;\n@@ -1491,11 +1506,10 @@ static struct sk_buff *tcp_shift_skb_data(struct sock *sk, struct sk_buff *skb,\n \t\tgoto out;\n \n \tlen = skb->len;\n-\tif (skb_shift(prev, skb, len)) {\n-\t\tpcount += tcp_skb_pcount(skb);\n-\t\ttcp_shifted_skb(sk, prev, skb, state, tcp_skb_pcount(skb),\n+\tpcount = tcp_skb_pcount(skb);\n+\tif (tcp_skb_shift(prev, skb, pcount, len))\n+\t\ttcp_shifted_skb(sk, prev, skb, state, pcount,\n \t\t\t\tlen, mss, 0);\n-\t}\n \n out:\n \treturn prev;\ndiff --git a\/net\/ipv4\/tcp_output.c b\/net\/ipv4\/tcp_output.c\nindex f429e856e263..b8e3bbb85211 100644\n--- a\/net\/ipv4\/tcp_output.c\n+++ b\/net\/ipv4\/tcp_output.c\n@@ -1454,8 +1454,8 @@ static inline int __tcp_mtu_to_mss(struct sock *sk, int pmtu)\n \tmss_now -= icsk->icsk_ext_hdr_len;\n \n \t\/* Then reserve room for full set of TCP options and 8 bytes of data *\/\n-\tif (mss_now < 48)\n-\t\tmss_now = 48;\n+\tif (mss_now < TCP_MIN_SND_MSS)\n+\t\tmss_now = TCP_MIN_SND_MSS;\n \treturn mss_now;\n }\n \n@@ -2747,7 +2747,7 @@ static bool tcp_collapse_retrans(struct sock *sk, struct sk_buff *skb)\n \t\tif (next_skb_size <= skb_availroom(skb))\n \t\t\tskb_copy_bits(next_skb, 0, skb_put(skb, next_skb_size),\n \t\t\t\t      next_skb_size);\n-\t\telse if (!skb_shift(skb, next_skb, next_skb_size))\n+\t\telse if (!tcp_skb_shift(skb, next_skb, 1, next_skb_size))\n \t\t\treturn false;\n \t}\n \ttcp_highest_sack_replace(sk, next_skb, skb);\n-- \ncgit 1.2-0.3.lf.el7\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2016-10251","CWE_ID":"190","category":"security","commit_id":"1f0dfe5a42911b6880a1445f13f6d615ddb55387","commit_message":"From 1f0dfe5a42911b6880a1445f13f6d615ddb55387 Mon Sep 17 00:00:00 2001\nFrom: Michael Adams <mdadams@ece.uvic.ca>\nDate: Fri, 4 Nov 2016 07:20:23 -0700\nSubject: [PATCH] Fixed an integer overflow problem in the JPC codec that later\n resulted in the use of uninitialized data.\n\n---\n src\/libjasper\/jpc\/jpc_t2cod.c | 20 ++++++++++----------\n src\/libjasper\/jpc\/jpc_t2cod.h | 20 ++++++++++----------\n 2 files changed, 20 insertions(+), 20 deletions(-)\n\n","diff_code":"diff --git a\/src\/libjasper\/jpc\/jpc_t2cod.c b\/src\/libjasper\/jpc\/jpc_t2cod.c\nindex 08315dd..174442a 100644\n--- a\/src\/libjasper\/jpc\/jpc_t2cod.c\n+++ b\/src\/libjasper\/jpc\/jpc_t2cod.c\n@@ -432,18 +432,18 @@ static int jpc_pi_nextcprl(register jpc_pi_t *pi)\n \t  &pi->picomps[pi->compno]; pi->compno < JAS_CAST(int, pchg->compnoend) && pi->compno < pi->numcomps; ++pi->compno,\n \t  ++pi->picomp) {\n \t\tpirlvl = pi->picomp->pirlvls;\n-\t\tpi->xstep = pi->picomp->hsamp * (1 << (pirlvl->prcwidthexpn +\n-\t\t  pi->picomp->numrlvls - 1));\n-\t\tpi->ystep = pi->picomp->vsamp * (1 << (pirlvl->prcheightexpn +\n-\t\t  pi->picomp->numrlvls - 1));\n+\t\tpi->xstep = pi->picomp->hsamp * (JAS_CAST(uint_fast32_t, 1) <<\n+\t\t  (pirlvl->prcwidthexpn + pi->picomp->numrlvls - 1));\n+\t\tpi->ystep = pi->picomp->vsamp * (JAS_CAST(uint_fast32_t, 1) <<\n+\t\t  (pirlvl->prcheightexpn + pi->picomp->numrlvls - 1));\n \t\tfor (rlvlno = 1, pirlvl = &pi->picomp->pirlvls[1];\n \t\t  rlvlno < pi->picomp->numrlvls; ++rlvlno, ++pirlvl) {\n-\t\t\tpi->xstep = JAS_MIN(pi->xstep, pi->picomp->hsamp * (1 <<\n-\t\t\t  (pirlvl->prcwidthexpn + pi->picomp->numrlvls -\n-\t\t\t  rlvlno - 1)));\n-\t\t\tpi->ystep = JAS_MIN(pi->ystep, pi->picomp->vsamp * (1 <<\n-\t\t\t  (pirlvl->prcheightexpn + pi->picomp->numrlvls -\n-\t\t\t  rlvlno - 1)));\n+\t\t\tpi->xstep = JAS_MIN(pi->xstep, pi->picomp->hsamp *\n+\t\t\t  (JAS_CAST(uint_fast32_t, 1) << (pirlvl->prcwidthexpn +\n+\t\t\t  pi->picomp->numrlvls - rlvlno - 1)));\n+\t\t\tpi->ystep = JAS_MIN(pi->ystep, pi->picomp->vsamp *\n+\t\t\t  (JAS_CAST(uint_fast32_t, 1) << (pirlvl->prcheightexpn +\n+\t\t\t  pi->picomp->numrlvls - rlvlno - 1)));\n \t\t}\n \t\tfor (pi->y = pi->ystart; pi->y < pi->yend;\n \t\t  pi->y += pi->ystep - (pi->y % pi->ystep)) {\ndiff --git a\/src\/libjasper\/jpc\/jpc_t2cod.h b\/src\/libjasper\/jpc\/jpc_t2cod.h\nindex 0a176c9..690e031 100644\n--- a\/src\/libjasper\/jpc\/jpc_t2cod.h\n+++ b\/src\/libjasper\/jpc\/jpc_t2cod.h\n@@ -129,10 +129,10 @@ typedef struct {\n \tjpc_pirlvl_t *pirlvls;\n \n \t\/* The horizontal sampling period. *\/\n-\tint hsamp;\n+\tuint_fast32_t hsamp;\n \n \t\/* The vertical sampling period. *\/\n-\tint vsamp;\n+\tuint_fast32_t vsamp;\n \n } jpc_picomp_t;\n \n@@ -171,32 +171,32 @@ typedef struct {\n \tint lyrno;\n \n \t\/* The x-coordinate of the current position. *\/\n-\tint x;\n+\tuint_fast32_t x;\n \n \t\/* The y-coordinate of the current position. *\/\n-\tint y;\n+\tuint_fast32_t y;\n \n \t\/* The horizontal step size. *\/\n-\tint xstep;\n+\tuint_fast32_t xstep;\n \n \t\/* The vertical step size. *\/\n-\tint ystep;\n+\tuint_fast32_t ystep;\n \n \t\/* The x-coordinate of the top-left corner of the tile on the reference\n \t  grid. *\/\n-\tint xstart;\n+\tuint_fast32_t xstart;\n \n \t\/* The y-coordinate of the top-left corner of the tile on the reference\n \t  grid. *\/\n-\tint ystart;\n+\tuint_fast32_t ystart;\n \n \t\/* The x-coordinate of the bottom-right corner of the tile on the\n \t  reference grid (plus one). *\/\n-\tint xend;\n+\tuint_fast32_t xend;\n \n \t\/* The y-coordinate of the bottom-right corner of the tile on the\n \t  reference grid (plus one). *\/\n-\tint yend;\n+\tuint_fast32_t yend;\n \n \t\/* The current progression change. *\/\n \tjpc_pchg_t *pchg;\n","owner":"mdadams","repo":"jasper","source":"cve"},{"CVE_ID":"CVE-2017-12179","CWE_ID":"190","category":"security","commit_id":"d088e3c1286b548a58e62afdc70bb40981cdb9e8","commit_message":"From d088e3c1286b548a58e62afdc70bb40981cdb9e8 Mon Sep 17 00:00:00 2001\nFrom: Nathan Kidd <nkidd@opentext.com>\nDate: Fri, 9 Jan 2015 10:04:41 -0500\nSubject: Xi: integer overflow and unvalidated length in\n (S)ProcXIBarrierReleasePointer\n\n[jcristau: originally this patch fixed the same issue as commit\n 211e05ac85 \"Xi: Test exact size of XIBarrierReleasePointer\", with the\n addition of these checks]\n\nThis addresses CVE-2017-12179\n\nReviewed-by: Alan Coopersmith <alan.coopersmith@oracle.com>\nReviewed-by: Jeremy Huddleston Sequoia <jeremyhu@apple.com>\nReviewed-by: Julien Cristau <jcristau@debian.org>\nSigned-off-by: Jeremy Huddleston Sequoia <jeremyhu@apple.com>\nSigned-off-by: Nathan Kidd <nkidd@opentext.com>\nSigned-off-by: Julien Cristau <jcristau@debian.org>\n---\n Xi\/xibarriers.c | 5 +++++\n 1 file changed, 5 insertions(+)\n\n","diff_code":"diff --git a\/Xi\/xibarriers.c b\/Xi\/xibarriers.c\nindex d82ecb6..d0be701 100644\n--- a\/Xi\/xibarriers.c\n+++ b\/Xi\/xibarriers.c\n@@ -834,6 +834,8 @@ SProcXIBarrierReleasePointer(ClientPtr client)\n     REQUEST_AT_LEAST_SIZE(xXIBarrierReleasePointerReq);\n \n     swapl(&stuff->num_barriers);\n+    if (stuff->num_barriers > UINT32_MAX \/ sizeof(xXIBarrierReleasePointerInfo))\n+        return BadLength;\n     REQUEST_FIXED_SIZE(xXIBarrierReleasePointerReq, stuff->num_barriers * sizeof(xXIBarrierReleasePointerInfo));\n \n     info = (xXIBarrierReleasePointerInfo*) &stuff[1];\n@@ -856,6 +858,9 @@ ProcXIBarrierReleasePointer(ClientPtr client)\n     xXIBarrierReleasePointerInfo *info;\n \n     REQUEST(xXIBarrierReleasePointerReq);\n+    REQUEST_AT_LEAST_SIZE(xXIBarrierReleasePointerReq);\n+    if (stuff->num_barriers > UINT32_MAX \/ sizeof(xXIBarrierReleasePointerInfo))\n+        return BadLength;\n     REQUEST_FIXED_SIZE(xXIBarrierReleasePointerReq, stuff->num_barriers * sizeof(xXIBarrierReleasePointerInfo));\n \n     info = (xXIBarrierReleasePointerInfo*) &stuff[1];\n-- \ncgit v1.1\n\n","owner":"NA","repo":"NA","source":"cve"},{"CVE_ID":"CVE-2019-13136","CWE_ID":"190","category":"security","commit_id":"fe5f4b85e6b1b54d3b4588a77133c06ade46d891","commit_message":"From fe5f4b85e6b1b54d3b4588a77133c06ade46d891 Mon Sep 17 00:00:00 2001\nFrom: Cristy <urban-warrior@imagemagick.org>\nDate: Tue, 18 Jun 2019 11:57:54 -0400\nSubject: [PATCH] https:\/\/github.com\/ImageMagick\/ImageMagick\/issues\/1602\n\n---\n coders\/tiff.c | 6 ++++++\n 1 file changed, 6 insertions(+)\n\n","diff_code":"diff --git a\/coders\/tiff.c b\/coders\/tiff.c\nindex 7efbb970b5..97402f2cb3 100644\n--- a\/coders\/tiff.c\n+++ b\/coders\/tiff.c\n@@ -258,6 +258,12 @@ static MagickOffsetType TIFFSeekCustomStream(const MagickOffsetType offset,\n     }\n     case SEEK_CUR:\n     {\n+      if (((offset > 0) && (profile->offset > (SSIZE_MAX-offset))) ||\n+          ((offset < 0) && (profile->offset < (-SSIZE_MAX-offset))))\n+        {\n+          errno=EOVERFLOW;\n+          return(-1);\n+        }\n       if ((profile->offset+offset) < 0)\n         return(-1);\n       profile->offset+=offset;\n","owner":"ImageMagick","repo":"ImageMagick","source":"cve"},{"CVE_ID":"CVE-2018-11219","CWE_ID":"190","category":"security","commit_id":"e89086e09a38cc6713bcd4b9c29abf92cf393936","commit_message":"From e89086e09a38cc6713bcd4b9c29abf92cf393936 Mon Sep 17 00:00:00 2001\nFrom: antirez <antirez@gmail.com>\nDate: Tue, 15 May 2018 13:13:49 +0200\nSubject: [PATCH] Security: fix Lua struct package offset handling.\n\nAfter the first fix to the struct package I found another similar\nproblem, which is fixed by this patch. It could be reproduced easily by\nrunning the following script:\n\n    return struct.unpack('f', \"xxxxxxxxxxxxx\",-3)\n\nThe above will access bytes before the 'data' pointer.\n---\n deps\/lua\/src\/lua_struct.c | 8 ++++++--\n 1 file changed, 6 insertions(+), 2 deletions(-)\n\n","diff_code":"diff --git a\/deps\/lua\/src\/lua_struct.c b\/deps\/lua\/src\/lua_struct.c\nindex b03a002dade..4d5f027b85c 100644\n--- a\/deps\/lua\/src\/lua_struct.c\n+++ b\/deps\/lua\/src\/lua_struct.c\n@@ -293,14 +293,18 @@ static int b_unpack (lua_State *L) {\n   const char *fmt = luaL_checkstring(L, 1);\n   size_t ld;\n   const char *data = luaL_checklstring(L, 2, &ld);\n-  size_t pos = luaL_optinteger(L, 3, 1) - 1;\n+  size_t pos = luaL_optinteger(L, 3, 1);\n+  luaL_argcheck(L, pos > 0, 3, \"offset must be 1 or greater\");\n+  pos--; \/* Lua indexes are 1-based, but here we want 0-based for C\n+          * pointer math. *\/\n   int n = 0;  \/* number of results *\/\n   defaultoptions(&h);\n   while (*fmt) {\n     int opt = *fmt++;\n     size_t size = optsize(L, opt, &fmt);\n     pos += gettoalign(pos, &h, opt, size);\n-    luaL_argcheck(L, pos+size <= ld, 2, \"data string too short\");\n+    luaL_argcheck(L, size <= ld && pos <= ld - size,\n+                   2, \"data string too short\");\n     \/* stack space for item + next position *\/\n     luaL_checkstack(L, 2, \"too many results\");\n     switch (opt) {\n","owner":"antirez","repo":"redis","source":"cve"},{"CVE_ID":"CVE-2018-8796","CWE_ID":"190","category":"security","commit_id":"4dca546d04321a610c1835010b5dad85163b65e1","commit_message":"From 4dca546d04321a610c1835010b5dad85163b65e1 Mon Sep 17 00:00:00 2001\nFrom: Henrik Andersson <hean01@cendio.com>\nDate: Wed, 16 Jan 2019 10:45:33 +0100\nSubject: [PATCH] Malicious RDP server security fixes\n\nThis commit includes fixes for a set of 21 vulnerabilities in\nrdesktop when a malicious RDP server is used.\n\nAll vulnerabilities was identified and reported by Eyal Itkin.\n\n * Add rdp_protocol_error function that is used in several fixes\n * Refactor of process_bitmap_updates\n * Fix possible integer overflow in s_check_rem() on 32bit arch\n * Fix memory corruption in process_bitmap_data - CVE-2018-8794\n * Fix remote code execution in process_bitmap_data - CVE-2018-8795\n * Fix remote code execution in process_plane - CVE-2018-8797\n * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175\n * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175\n * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176\n * Fix Denial of Service in sec_recv - CVE-2018-20176\n * Fix minor information leak in rdpdr_process - CVE-2018-8791\n * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792\n * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793\n * Fix Denial of Service in process_bitmap_data - CVE-2018-8796\n * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798\n * Fix Denial of Service in process_secondary_order - CVE-2018-8799\n * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800\n * Fix major information leak in ui_clip_handle_data - CVE-2018-20174\n * Fix memory corruption in rdp_in_unistr - CVE-2018-20177\n * Fix Denial of Service in process_demand_active - CVE-2018-20178\n * Fix remote code execution in lspci_process - CVE-2018-20179\n * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180\n * Fix remote code execution in seamless_process - CVE-2018-20181\n * Fix remote code execution in seamless_process_line - CVE-2018-20182\n---\n asn.c       |   2 +-\n bitmap.c    |   8 +--\n cliprdr.c   |   6 ++\n constants.h |   3 +\n cssp.c      |  17 ++++-\n lspci.c     |   9 ++-\n mcs.c       |  20 +++++-\n orders.c    |   6 ++\n proto.h     |   3 +-\n rdp.c       | 192 ++++++++++++++++++++++++++++++++++++----------------\n rdpdr.c     |  11 +++\n rdpsnd.c    |  11 +++\n seamless.c  |  12 ++++\n secure.c    |  17 +++++\n stream.h    |   2 +-\n types.h     |   2 +\n 16 files changed, 250 insertions(+), 71 deletions(-)\n\n","diff_code":"diff --git a\/asn.c b\/asn.c\nindex 26b0e9b4..1b9fea4c 100644\n--- a\/asn.c\n+++ b\/asn.c\n@@ -22,7 +22,7 @@\n \n \/* Parse an ASN.1 BER header *\/\n RD_BOOL\n-ber_parse_header(STREAM s, int tagval, int *length)\n+ber_parse_header(STREAM s, int tagval, uint32 *length)\n {\n \tint tag, len;\n \ndiff --git a\/bitmap.c b\/bitmap.c\nindex 775622cc..55c768c1 100644\n--- a\/bitmap.c\n+++ b\/bitmap.c\n@@ -794,7 +794,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tcolor = CVAL(in);\n \t\t\t\t\t*out = color;\n@@ -802,7 +802,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\t*out = color;\n \t\t\t\t\tout += 4;\n@@ -824,7 +824,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\treplen = revcode;\n \t\t\t\t\tcollen = 0;\n \t\t\t\t}\n-\t\t\t\twhile (collen > 0)\n+\t\t\t\twhile (indexw < width && collen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = CVAL(in);\n \t\t\t\t\tif (x & 1)\n@@ -844,7 +844,7 @@ process_plane(uint8 * in, int width, int height, uint8 * out, int size)\n \t\t\t\t\tindexw++;\n \t\t\t\t\tcollen--;\n \t\t\t\t}\n-\t\t\t\twhile (replen > 0)\n+\t\t\t\twhile (indexw < width && replen > 0)\n \t\t\t\t{\n \t\t\t\t\tx = last_line[indexw * 4] + color;\n \t\t\t\t\t*out = x;\ndiff --git a\/cliprdr.c b\/cliprdr.c\nindex 3f68213b..76eb98d0 100644\n--- a\/cliprdr.c\n+++ b\/cliprdr.c\n@@ -118,6 +118,7 @@ cliprdr_process(STREAM s)\n \tuint16 type, status;\n \tuint32 length, format;\n \tuint8 *data;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, type);\n \tin_uint16_le(s, status);\n@@ -127,6 +128,11 @@ cliprdr_process(STREAM s)\n \tlogger(Clipboard, Debug, \"cliprdr_process(), type=%d, status=%d, length=%d\", type, status,\n \t       length);\n \n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"cliprdr_process(), consume of packet from stream would overrun\", &packet);\n+\t}\n+\n \tif (status == CLIPRDR_ERROR)\n \t{\n \t\tswitch (type)\ndiff --git a\/constants.h b\/constants.h\nindex 7dfc2e3d..63015029 100644\n--- a\/constants.h\n+++ b\/constants.h\n@@ -751,6 +751,9 @@ enum RDP_DESKTOP_ORIENTATION\n #define ENC_SALTED_CHECKSUM\t\t0x0010\n #define NO_BITMAP_COMPRESSION_HDR\t0x0400\n \n+\/* [MS-RDPBCGR], TS_BITMAP_DATA, flags *\/\n+#define BITMAP_COMPRESSION              0x0001\n+\n \/* orderFlags, [MS-RDPBCGR] 2.2.7.1.3 *\/\n #define NEGOTIATEORDERSUPPORT\t0x0002\n #define ZEROBOUNDSDELTASSUPPORT 0x0008\ndiff --git a\/cssp.c b\/cssp.c\nindex 33544c3b..6b2d0f70 100644\n--- a\/cssp.c\n+++ b\/cssp.c\n@@ -595,6 +595,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tSTREAM s;\n \tint length;\n \tint tagval;\n+\tstruct stream packet;\n \n \ts = tcp_recv(NULL, 4);\n \n@@ -622,6 +623,7 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \n \t\/\/ receive the remainings of message\n \ts = tcp_recv(s, length);\n+\tpacket = *s;\n \n \t\/\/ parse the response and into nego token\n \tif (!ber_in_header(s, &tagval, &length) ||\n@@ -632,6 +634,12 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \tif (!ber_in_header(s, &tagval, &length) ||\n \t    tagval != (BER_TAG_CTXT_SPECIFIC | BER_TAG_CONSTRUCTED | 0))\n \t\treturn False;\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\t rdp_protocol_error(\"cssp_read_tsrequest(), consume of version from stream would overrun\",\n+\t\t\t\t    &packet);\n+\t}\n \tin_uint8s(s, length);\n \n \t\/\/ negoToken [1]\n@@ -653,7 +661,14 @@ cssp_read_tsrequest(STREAM token, STREAM pubkey)\n \t\tif (!ber_in_header(s, &tagval, &length) || tagval != BER_TAG_OCTET_STRING)\n \t\t\treturn False;\n \n-\t\ttoken->end = token->p = token->data;\n+\t\tif (!s_check_rem(s, length))\n+\t\t{\n+\t\t\trdp_protocol_error(\"cssp_read_tsrequest(), consume of token from stream would overrun\",\n+\t\t\t\t\t   &packet);\n+\t\t}\n+\n+\t\ts_realloc(token, length);\n+\t\ts_reset(token);\n \t\tout_uint8p(token, s->p, length);\n \t\ts_mark_end(token);\n \t}\ndiff --git a\/lspci.c b\/lspci.c\nindex c4c8ce63..2d17161c 100644\n--- a\/lspci.c\n+++ b\/lspci.c\n@@ -1,7 +1,8 @@\n \/*  -*- c-basic-offset: 8 -*-\n    rdesktop: A Remote Desktop Protocol client.\n    Support for the Matrox \"lspci\" channel\n-   Copyright (C) 2005 Matrox Graphics Inc. \n+   Copyright (C) 2005 Matrox Graphics Inc.\n+   Copyright 2018 Henrik Andersson <hean01@cendio.se> for Cendio AB\n \n    This program is free software: you can redistribute it and\/or modify\n    it under the terms of the GNU General Public License as published by\n@@ -134,6 +135,12 @@ lspci_process(STREAM s)\n \tunsigned int pkglen;\n \tstatic char *rest = NULL;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"lspci_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/mcs.c b\/mcs.c\nindex 10b73a14..0f2360e8 100644\n--- a\/mcs.c\n+++ b\/mcs.c\n@@ -45,9 +45,16 @@ mcs_out_domain_params(STREAM s, int max_channels, int max_users, int max_tokens,\n static RD_BOOL\n mcs_parse_domain_params(STREAM s)\n {\n-\tint length;\n+\tuint32 length;\n+\tstruct stream packet = *s;\n \n \tber_parse_header(s, MCS_TAG_DOMAIN_PARAMS, &length);\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_parse_domain_params(), consume domain params from stream would overrun\", &packet);\n+\t}\n+\n \tin_uint8s(s, length);\n \n \treturn s_check(s);\n@@ -89,8 +96,9 @@ mcs_recv_connect_response(STREAM mcs_data)\n {\n \tUNUSED(mcs_data);\n \tuint8 result;\n-\tint length;\n+\tuint32 length;\n \tSTREAM s;\n+\tstruct stream packet;\n \tRD_BOOL is_fastpath;\n \tuint8 fastpath_hdr;\n \n@@ -99,6 +107,8 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tif (s == NULL)\n \t\treturn False;\n+\t\n+\tpacket = *s;\n \n \tber_parse_header(s, MCS_CONNECT_RESPONSE, &length);\n \n@@ -112,6 +122,12 @@ mcs_recv_connect_response(STREAM mcs_data)\n \n \tber_parse_header(s, BER_TAG_INTEGER, &length);\n \tin_uint8s(s, length);\t\/* connect id *\/\n+\n+\tif (!s_check_rem(s, length))\n+\t{\n+\t\trdp_protocol_error(\"mcs_recv_connect_response(), consume connect id from stream would overrun\", &packet);\n+\t}\n+\n \tmcs_parse_domain_params(s);\n \n \tber_parse_header(s, BER_TAG_OCTET_STRING, &length);\ndiff --git a\/orders.c b\/orders.c\nindex ba9cfa1a..5e34770b 100644\n--- a\/orders.c\n+++ b\/orders.c\n@@ -1259,11 +1259,17 @@ process_secondary_order(STREAM s)\n \tuint16 flags;\n \tuint8 type;\n \tuint8 *next_order;\n+\tstruct stream packet = *s;\n \n \tin_uint16_le(s, length);\n \tin_uint16_le(s, flags);\t\/* used by bmpcache2 *\/\n \tin_uint8(s, type);\n \n+\tif (!s_check_rem(s, length + 7))\n+\t{\n+\t\trdp_protocol_error(\"process_secondary_order(), next order pointer would overrun stream\", &packet);\n+\t}\n+\n \tnext_order = s->p + (sint16) length + 7;\n \n \tswitch (type)\ndiff --git a\/proto.h b\/proto.h\nindex 73449dde..0d6a6c98 100644\n--- a\/proto.h\n+++ b\/proto.h\n@@ -164,6 +164,7 @@ RD_BOOL rdp_connect(char *server, uint32 flags, char *domain, char *password, ch\n \t\t    char *directory, RD_BOOL reconnect);\n void rdp_reset_state(void);\n void rdp_disconnect(void);\n+void rdp_protocol_error(const char *message, STREAM s);\n \/* rdpdr.c *\/\n int get_device_index(RD_NTHANDLE handle);\n void convert_to_unix_filename(char *filename);\n@@ -224,7 +225,7 @@ void tcp_run_ui(RD_BOOL run);\n \/* asn.c *\/\n RD_BOOL ber_in_header(STREAM s, int *tagval, int *length);\n void ber_out_header(STREAM s, int tagval, int length);\n-RD_BOOL ber_parse_header(STREAM s, int tagval, int *length);\n+RD_BOOL ber_parse_header(STREAM s, int tagval, uint32 *length);\n void ber_out_integer(STREAM s, int value);\n void ber_out_sequence(STREAM s, STREAM contents);\n \ndiff --git a\/rdp.c b\/rdp.c\nindex f98f49cb..1654e581 100644\n--- a\/rdp.c\n+++ b\/rdp.c\n@@ -285,6 +285,19 @@ rdp_in_unistr(STREAM s, int in_len, char **string, uint32 * str_size)\n \tsize_t ibl, obl;\n \tchar *pin, *pout;\n \n+\tstruct stream packet = *s;\n+\n+\tif ((in_len < 0) || ((uint32)in_len >= (RD_UINT32_MAX \/ 2)))\n+\t{\n+\t\tlogger(Protocol, Error, \"rdp_in_unistr(), length of unicode data is out of bounds.\");\n+\t\tabort();\n+\t}\n+\n+\tif (!s_check_rem(s, in_len))\n+\t{\n+\t\trdp_protocol_error(\"rdp_in_unistr(), consume of unicode data from stream would overrun\", &packet);\n+\t}\n+\n \t\/\/ if not already open\n \tif (!icv_utf16_to_local)\n \t{\n@@ -1211,6 +1224,7 @@ process_demand_active(STREAM s)\n {\n \tuint8 type;\n \tuint16 len_src_descriptor, len_combined_caps;\n+\tstruct stream packet = *s;\n \n \t\/* at this point we need to ensure that we have ui created *\/\n \trd_create_ui();\n@@ -1218,6 +1232,11 @@ process_demand_active(STREAM s)\n \tin_uint32_le(s, g_rdp_shareid);\n \tin_uint16_le(s, len_src_descriptor);\n \tin_uint16_le(s, len_combined_caps);\n+\n+\tif (!s_check_rem(s, len_src_descriptor))\n+\t{\n+\t\trdp_protocol_error(\"rdp_demand_active(), consume of source descriptor from stream would overrun\", &packet);\n+\t}\n \tin_uint8s(s, len_src_descriptor);\n \n \tlogger(Protocol, Debug, \"process_demand_active(), shareid=0x%x\", g_rdp_shareid);\n@@ -1390,78 +1409,113 @@ process_pointer_pdu(STREAM s)\n \t}\n }\n \n-\/* Process bitmap updates *\/\n-void\n-process_bitmap_updates(STREAM s)\n+\/* Process TS_BITMAP_DATA *\/\n+static void\n+process_bitmap_data(STREAM s)\n {\n-\tuint16 num_updates;\n \tuint16 left, top, right, bottom, width, height;\n-\tuint16 cx, cy, bpp, Bpp, compress, bufsize, size;\n+\tuint16 cx, cy, bpp, Bpp, flags, bufsize, size;\n \tuint8 *data, *bmpdata;\n-\tint i;\n-\n+\t\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \n-\tin_uint16_le(s, num_updates);\n+\tstruct stream packet = *s;\n \n-\tfor (i = 0; i < num_updates; i++)\n-\t{\n-\t\tin_uint16_le(s, left);\n-\t\tin_uint16_le(s, top);\n-\t\tin_uint16_le(s, right);\n-\t\tin_uint16_le(s, bottom);\n-\t\tin_uint16_le(s, width);\n-\t\tin_uint16_le(s, height);\n-\t\tin_uint16_le(s, bpp);\n-\t\tBpp = (bpp + 7) \/ 8;\n-\t\tin_uint16_le(s, compress);\n-\t\tin_uint16_le(s, bufsize);\n-\n-\t\tcx = right - left + 1;\n-\t\tcy = bottom - top + 1;\n-\n-\t\tlogger(Graphics, Debug,\n-\t\t       \"process_bitmap_updates(), [%d,%d,%d,%d], [%d,%d], bpp=%d, compression=%d\",\n-\t\t       left, top, right, bottom, width, height, Bpp, compress);\n-\n-\t\tif (!compress)\n-\t\t{\n-\t\t\tint y;\n-\t\t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\t\tfor (y = 0; y < height; y++)\n-\t\t\t{\n-\t\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)],\n-\t\t\t\t\t  width * Bpp);\n-\t\t\t}\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n-\t\t\txfree(bmpdata);\n-\t\t\tcontinue;\n-\t\t}\n+\tin_uint16_le(s, left); \/* destLeft *\/\n+\tin_uint16_le(s, top); \/* destTop *\/\n+\tin_uint16_le(s, right); \/* destRight *\/\n+\tin_uint16_le(s, bottom); \/* destBottom *\/\n+\tin_uint16_le(s, width); \/* width *\/\n+\tin_uint16_le(s, height); \/* height *\/\n+\tin_uint16_le(s, bpp); \/*bitsPerPixel *\/\n+\tBpp = (bpp + 7) \/ 8;\n+\tin_uint16_le(s, flags); \/* flags *\/\n+\tin_uint16_le(s, bufsize); \/* bitmapLength *\/\n \n+\tcx = right - left + 1;\n+\tcy = bottom - top + 1;\n \n-\t\tif (compress & 0x400)\n-\t\t{\n-\t\t\tsize = bufsize;\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\tin_uint8s(s, 2);\t\/* pad *\/\n-\t\t\tin_uint16_le(s, size);\n-\t\t\tin_uint8s(s, 4);\t\/* line_size, final_size *\/\n-\t\t}\n-\t\tin_uint8p(s, data, size);\n+\t\/* FIXME: There are a assumtion that we do not consider in\n+\t\tthis code. The value of bpp is not passed to\n+\t\tui_paint_bitmap() which relies on g_server_bpp for drawing\n+\t\tthe bitmap data.\n+\n+\t\tDoes this means that we can sanity check bpp with g_server_bpp ?\n+\t*\/\n+\n+\tif (Bpp == 0 || width == 0 || height == 0)\n+\t{\n+        logger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+\n+\tif ((RD_UINT32_MAX \/ Bpp) <= (width * height))\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), [%d,%d,%d,%d], [%d,%d], bpp=%d, flags=%x\", __func__,\n+\t\t\t\tleft, top, right, bottom, width, height, bpp, flags);\n+\t\trdp_protocol_error(\"TS_BITMAP_DATA, unsafe size of bitmap data received from server\", &packet);\n+\t}\n+ \n+\tif (flags == 0)\n+\t{\n+\t\t\/* read uncompressed bitmap data *\/\n+\t\tint y;\n \t\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n-\t\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t\tfor (y = 0; y < height; y++)\n \t\t{\n-\t\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t\t\tin_uint8a(s, &bmpdata[(height - y - 1) * (width * Bpp)], width * Bpp);\n \t\t}\n-\t\telse\n-\t\t{\n-\t\t\tlogger(Graphics, Warning,\n-\t\t\t       \"process_bitmap_updates(), failed to decompress bitmap\");\n-\t\t}\n-\n+\t\t\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n \t\txfree(bmpdata);\n+\t\treturn;\n+\t}\n+\n+\tif (flags & NO_BITMAP_COMPRESSION_HDR)\n+\t{\n+\t\tsize = bufsize;\n+\t}\n+\telse\n+\t{\n+\t\t\/* Read TS_CD_HEADER *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbCompFirstRowSize (must be 0x0000) *\/\n+\t\tin_uint16_le(s, size);  \/* cbCompMainBodySize *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbScanWidth *\/\n+\t\tin_uint8s(s, 2);        \/* skip cbUncompressedSize *\/\n+\t}\n+\n+\t\/* read compressed bitmap data *\/\n+\tif (!s_check_rem(s, size))\n+\t{\n+\t\trdp_protocol_error(\"process_bitmap_data(), consume of bitmap data from stream would overrun\", &packet);\n+\t}\n+\tin_uint8p(s, data, size);\n+\tbmpdata = (uint8 *) xmalloc(width * height * Bpp);\n+\tif (bitmap_decompress(bmpdata, width, height, data, size, Bpp))\n+\t{\n+\t\tui_paint_bitmap(left, top, cx, cy, width, height, bmpdata);\n+\t}\n+\telse\n+\t{\n+\t\tlogger(Protocol, Warning, \"%s(), failed to decompress bitmap\", __func__);\n+\t}\n+\n+\txfree(bmpdata);\n+}\n+\n+\/* Process TS_UPDATE_BITMAP_DATA *\/\n+void\n+process_bitmap_updates(STREAM s)\n+{\n+\tint i;\n+\tuint16 num_updates;\n+\t\n+\tin_uint16_le(s, num_updates);   \/* rectangles *\/\n+\n+\tfor (i = 0; i < num_updates; i++)\n+\t{\n+\t\tprocess_bitmap_data(s);\n \t}\n }\n \n@@ -2013,3 +2067,21 @@ rdp_disconnect(void)\n \tlogger(Protocol, Debug, \"%s()\", __func__);\n \tsec_disconnect();\n }\n+\n+\/* Abort rdesktop upon protocol error\n+\n+   A protocol error is defined as:\n+\n+    - A value is outside specified range for example;\n+      bpp for a bitmap is not allowed to be greater than the\n+      value 32 but is represented by a byte in protocol.\n+\n+*\/\n+void\n+rdp_protocol_error(const char *message, STREAM s)\n+{\n+\tlogger(Protocol, Error, \"%s(), %s\", __func__, message);\n+\tif (s)\n+\t\thexdump(s->p, s_length(s));\n+\texit(0);\n+}\ndiff --git a\/rdpdr.c b\/rdpdr.c\nindex e8f54316..0abcacd8 100644\n--- a\/rdpdr.c\n+++ b\/rdpdr.c\n@@ -854,6 +854,7 @@ rdpdr_process(STREAM s)\n \tuint16 vmin;\n \tuint16 component;\n \tuint16 pakid;\n+\tstruct stream packet = *s;\n \n \tlogger(Protocol, Debug, \"rdpdr_process()\");\n \t\/* hexdump(s->p, s->end - s->p); *\/\n@@ -873,8 +874,18 @@ rdpdr_process(STREAM s)\n \t\t\t\t\/* DR_CORE_SERVER_ANNOUNCE_REQ *\/\n \t\t\t\tin_uint8s(s, 2);\t\/* skip versionMajor *\/\n \t\t\t\tin_uint16_le(s, vmin);\t\/* VersionMinor *\/\n+\n \t\t\t\tin_uint32_le(s, g_client_id);\t\/* ClientID *\/\n \n+\t\t\t\t\/* g_client_id is sent back to server,\n+\t\t\t\t   so lets check that we actually got\n+\t\t\t\t   valid data from stream to prevent\n+\t\t\t\t   that we leak back data to server *\/\n+\t\t\t\tif (!s_check(s))\n+\t\t\t\t{\n+\t\t\t\t\trdp_protocol_error(\"rdpdr_process(), consume of g_client_id from stream did overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\t\/* The RDP client is responsibility to provide a random client id\n \t\t\t\t   if server version is < 12 *\/\n \t\t\t\tif (vmin < 0x000c)\ndiff --git a\/rdpsnd.c b\/rdpsnd.c\nindex 71a3bf25..40881b76 100644\n--- a\/rdpsnd.c\n+++ b\/rdpsnd.c\n@@ -269,6 +269,12 @@ rdpsnd_process_training(STREAM in)\n \tuint16 tick;\n \tuint16 packsize;\n \tSTREAM out;\n+\tstruct stream packet = *in;\n+\n+\tif (!s_check_rem(in, 4))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnd_process_training(), consume of training data from stream would overrun\", &packet);\n+\t}\n \n \tin_uint16_le(in, tick);\n \tin_uint16_le(in, packsize);\n@@ -445,6 +451,11 @@ rdpsnddbg_process(STREAM s)\n \tstatic char *rest = NULL;\n \tchar *buf;\n \n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"rdpsnddbg_process(), stream is in unstable state\", s);\n+\t}\n+\n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\n \tbuf = (char *) xmalloc(pkglen + 1);\ndiff --git a\/seamless.c b\/seamless.c\nindex 8fde8ddd..1935074f 100644\n--- a\/seamless.c\n+++ b\/seamless.c\n@@ -168,6 +168,12 @@ seamless_process_line(const char *line, void *data)\n \n \t\t\ticon_buf[len] = strtol(byte, NULL, 16);\n \t\t\tlen++;\n+\n+\t\t\tif ((size_t)len >= sizeof(icon_buf))\n+\t\t\t{\n+\t\t\t\tlogger(Protocol, Warning, \"seamless_process_line(), icon data would overrun icon_buf\");\n+\t\t\t\tbreak;\n+\t\t\t}\n \t\t}\n \n \t\tui_seamless_seticon(id, tok5, width, height, chunk, icon_buf, len);\n@@ -370,6 +376,12 @@ seamless_process(STREAM s)\n {\n \tunsigned int pkglen;\n \tchar *buf;\n+\tstruct stream packet = *s;\n+\n+\tif (!s_check(s))\n+\t{\n+\t\trdp_protocol_error(\"seamless_process(), stream is in unstable state\", &packet);\n+\t}\n \n \tpkglen = s->end - s->p;\n \t\/* str_handle_lines requires null terminated strings *\/\ndiff --git a\/secure.c b\/secure.c\nindex 48d9d010..f548a4ff 100644\n--- a\/secure.c\n+++ b\/secure.c\n@@ -296,6 +296,9 @@ sec_encrypt(uint8 * data, int length)\n void\n sec_decrypt(uint8 * data, int length)\n {\n+\tif (length <= 0)\n+\t\treturn;\n+\n \tif (g_sec_decrypt_use_count == 4096)\n \t{\n \t\tsec_update(g_sec_decrypt_key, g_sec_decrypt_update_key);\n@@ -848,9 +851,11 @@ sec_recv(RD_BOOL * is_fastpath)\n \tuint16 sec_flags;\n \tuint16 channel;\n \tSTREAM s;\n+\tstruct stream packet;\n \n \twhile ((s = mcs_recv(&channel, is_fastpath, &fastpath_hdr)) != NULL)\n \t{\n+\t\tpacket = *s;\n \t\tif (*is_fastpath == True)\n \t\t{\n \t\t\t\/* If fastpath packet is encrypted, read data\n@@ -859,6 +864,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\tfastpath_flags = (fastpath_hdr & 0xC0) >> 6;\n \t\t\tif (fastpath_flags & FASTPATH_OUTPUT_ENCRYPTED)\n \t\t\t{\n+\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume fastpath signature from stream would overrun\", &packet);\n+\t\t\t\t}\n+\n \t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t}\n@@ -875,6 +884,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t{\n \t\t\t\tif (sec_flags & SEC_ENCRYPT)\n \t\t\t\t{\n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume encrypt signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \t\t\t\t}\n@@ -889,6 +902,10 @@ sec_recv(RD_BOOL * is_fastpath)\n \t\t\t\t{\n \t\t\t\t\tuint8 swapbyte;\n \n+\t\t\t\t\tif (!s_check_rem(s, 8)) {\n+\t\t\t\t\t\trdp_protocol_error(\"sec_recv(), consume redirect signature from stream would overrun\", &packet);\n+\t\t\t\t\t}\n+\n \t\t\t\t\tin_uint8s(s, 8);\t\/* signature *\/\n \t\t\t\t\tsec_decrypt(s->p, s->end - s->p);\n \ndiff --git a\/stream.h b\/stream.h\nindex ccc125db..a9196e5f 100644\n--- a\/stream.h\n+++ b\/stream.h\n@@ -54,7 +54,7 @@ size_t in_ansi_string(STREAM s, char *string, size_t len);\n #define s_pop_layer(s,h)\t(s)->p = (s)->h;\n #define s_mark_end(s)\t\t(s)->end = (s)->p;\n #define s_check(s)\t\t((s)->p <= (s)->end)\n-#define s_check_rem(s,n)\t((s)->p + n <= (s)->end)\n+#define s_check_rem(s,n) (s_check(s) && (n <= (s)->end - (s)->p))\n #define s_check_end(s)\t\t((s)->p == (s)->end)\n #define s_length(s)\t\t((s)->end - (s)->data)\n #define s_left(s)               ((s)->size - ((s)->p - (s)->data))\ndiff --git a\/types.h b\/types.h\nindex b139b863..4556ab48 100644\n--- a\/types.h\n+++ b\/types.h\n@@ -43,6 +43,8 @@ typedef signed short sint16;\n typedef unsigned int uint32;\n typedef signed int sint32;\n \n+#define RD_UINT32_MAX (uint32)(-1)\n+\n typedef void *RD_HBITMAP;\n typedef void *RD_HGLYPH;\n typedef void *RD_HCOLOURMAP;\n","owner":"rdesktop","repo":"rdesktop","source":"cve"},{"CVE_ID":"CVE-2016-6888","CWE_ID":"190","category":"security","commit_id":"47882fa4975bf0b58dd74474329fdd7154e8f04c","commit_message":"From 47882fa4975bf0b58dd74474329fdd7154e8f04c Mon Sep 17 00:00:00 2001\nFrom: Li Qiang <liqiang6-s@360.cn>\nDate: Tue, 16 Aug 2016 16:58:01 +0530\nSubject: [PATCH] net: vmxnet: use g_new for pkt initialisation\n\nWhen network transport abstraction layer initialises pkt, the maximum\nfragmentation count is not checked. This could lead to an integer\noverflow causing a NULL pointer dereference. Replace g_malloc() with\ng_new() to catch the multiplication overflow.\n\nReported-by: Li Qiang <liqiang6-s@360.cn>\nSigned-off-by: Prasad J Pandit <pjp@fedoraproject.org>\nAcked-by: Dmitry Fleytman <dmitry@daynix.com>\nSigned-off-by: Jason Wang <jasowang@redhat.com>\n---\n hw\/net\/net_tx_pkt.c | 5 ++---\n 1 file changed, 2 insertions(+), 3 deletions(-)\n\n","diff_code":"diff --git a\/hw\/net\/net_tx_pkt.c b\/hw\/net\/net_tx_pkt.c\nindex 53dfaa2..20b2549 100644\n--- a\/hw\/net\/net_tx_pkt.c\n+++ b\/hw\/net\/net_tx_pkt.c\n@@ -65,10 +65,9 @@ void net_tx_pkt_init(struct NetTxPkt **pkt, PCIDevice *pci_dev,\n \n     p->pci_dev = pci_dev;\n \n-    p->vec = g_malloc((sizeof *p->vec) *\n-        (max_frags + NET_TX_PKT_PL_START_FRAG));\n+    p->vec = g_new(struct iovec, max_frags + NET_TX_PKT_PL_START_FRAG);\n \n-    p->raw = g_malloc((sizeof *p->raw) * max_frags);\n+    p->raw = g_new(struct iovec, max_frags);\n \n     p->max_payload_frags = max_frags;\n     p->max_raw_frags = max_frags;\n-- \n1.8.3.1\n\n","owner":"qemu","repo":"qemu","source":"cve"},{"CVE_ID":"CVE-2016-5735","CWE_ID":"190","category":"security","commit_id":"b7c217680cda02dddced245d237ebe8c383be285","commit_message":"From b7c217680cda02dddced245d237ebe8c383be285 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Kornel=20Lesi=C5=84ski?= <kornel@geekhood.net>\nDate: Thu, 23 Jun 2016 16:10:57 +0100\nSubject: [PATCH] Fix integer overflow in rwpng.h (CVE-2016-5735)\n\nReported by Choi Jaeseung\nFound with Sparrow (http:\/\/ropas.snu.ac.kr\/sparrow)\n---\n rwpng.c | 12 ++++++------\n 1 file changed, 6 insertions(+), 6 deletions(-)\n\n","diff_code":"diff --git a\/rwpng.c b\/rwpng.c\nindex aeb4696a..e3f59d11 100644\n--- a\/rwpng.c\n+++ b\/rwpng.c\n@@ -244,12 +244,6 @@ static pngquant_error rwpng_read_image24_libpng(FILE *infile, png24_image *mainp\n     png_get_IHDR(png_ptr, info_ptr, &mainprog_ptr->width, &mainprog_ptr->height,\n                  &bit_depth, &color_type, NULL, NULL, NULL);\n \n-    \/\/ For overflow safety reject images that won't fit in 32-bit\n-    if (mainprog_ptr->width > INT_MAX\/mainprog_ptr->height) {\n-        png_destroy_read_struct(&png_ptr, &info_ptr, NULL);\n-        return PNG_OUT_OF_MEMORY_ERROR;  \/* not quite true, but whatever *\/\n-    }\n-\n     \/* expand palette images to RGB, low-bit-depth grayscale images to 8 bits,\n      * transparency chunks to full alpha channel; strip 16-bit-per-sample\n      * images to 8 bits per sample; and convert grayscale to RGB[A] *\/\n@@ -304,6 +298,12 @@ static pngquant_error rwpng_read_image24_libpng(FILE *infile, png24_image *mainp\n \n     rowbytes = png_get_rowbytes(png_ptr, info_ptr);\n \n+    \/\/ For overflow safety reject images that won't fit in 32-bit\n+    if (rowbytes > INT_MAX\/mainprog_ptr->height) {\n+        png_destroy_read_struct(&png_ptr, &info_ptr, NULL);\n+        return PNG_OUT_OF_MEMORY_ERROR;\n+    }\n+\n     if ((mainprog_ptr->rgba_data = malloc(rowbytes * mainprog_ptr->height)) == NULL) {\n         fprintf(stderr, \"pngquant readpng:  unable to allocate image data\\n\");\n         png_destroy_read_struct(&png_ptr, &info_ptr, NULL);\n","owner":"pornel","repo":"pngquant","source":"cve"}]